cscope 15 /mnt/f/BaiduNetdiskDownload/TLSR825XËµÑÊñô/Zigbee/Zigbee_SDK/tl_zigbee_sdk -q 0000019612 0002268653
	@apps/bootLoader/app_cfg.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

34 
	~"vîsi⁄_cfg.h
"

40 
	#UART_PRINTF_MODE
 0

	)

41 
	#USB_PRINTF_MODE
 0

	)

44 
	#BOARD_826x_EVK
 0

	)

45 
	#BOARD_826x_DONGLE
 1

	)

46 
	#BOARD_826x_DONGLE_PA
 2

	)

47 
	#BOARD_8258_EVK
 3

	)

48 
	#BOARD_8258_EVK_V1P2
 4

49 
	#BOARD_8258_DONGLE
 5

	)

50 
	#BOARD_8278_EVK
 6

	)

51 
	#BOARD_8278_DONGLE
 7

	)

52 
	#BOARD_9518_EVK
 8

	)

53 
	#BOARD_9518_DONGLE
 9

	)

56 #i‡
deföed
(
MCU_CORE_826x
)

57 
	#BOARD
 
BOARD_826x_DONGLE


	)

58 
	#CLOCK_SYS_CLOCK_HZ
 32000000

	)

59 #ñi‡
deföed
(
MCU_CORE_8258
)

60 #i‡(
CHIP_TYPE
 =
TLSR_8258_1M
)

61 
	#FLASH_CAP_SIZE_1M
 1

	)

63 
	#BOARD
 
BOARD_8258_DONGLE


	)

64 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

65 #ñi‡
deföed
(
MCU_CORE_8278
)

66 
	#FLASH_CAP_SIZE_1M
 1

	)

67 
	#BOARD
 
BOARD_8278_DONGLE


68 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

69 #ñi‡
deföed
(
MCU_CORE_B91
)

70 
	#FLASH_CAP_SIZE_1M
 1

	)

71 
	#BOARD
 
BOARD_9518_DONGLE


72 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

78 #i‡(
BOARD
 =
BOARD_826x_EVK
)

79 
	~"bﬂrd_826x_evk.h
"

80 #ñi‡(
BOARD
 =
BOARD_826x_DONGLE
)

81 
	~"bﬂrd_826x_d⁄gÀ.h
"

82 #ñi‡(
BOARD
 =
BOARD_8258_DONGLE
)

83 
	~"bﬂrd_8258_d⁄gÀ.h
"

84 #ñi‡(
BOARD
 =
BOARD_8258_EVK
)

85 
	~"bﬂrd_8258_evk.h
"

86 #ñi‡(
BOARD
 =
BOARD_8258_EVK_V1P2
)

87 
	~"bﬂrd_8258_evk_v1p2.h
"

88 #ñi‡(
BOARD
 =
BOARD_8278_EVK
)

89 
	~"bﬂrd_8278_evk.h
"

90 #ñi‡(
BOARD
 =
BOARD_8278_DONGLE
)

91 
	~"bﬂrd_8278_d⁄gÀ.h
"

92 #ñi‡(
BOARD
 =
BOARD_9518_EVK
)

93 
	~"bﬂrd_9518_evk.h
"

94 #ñi‡(
BOARD
 =
BOARD_9518_DONGLE
)

95 
	~"bﬂrd_9518_d⁄gÀ.h
"

104 
	#VOLTAGE_DETECT_ENABLE
 0

	)

110 
EV_POLL_ED_DETECT
,

111 
EV_POLL_FACTORY_RST
,

112 
EV_POLL_HCI
,

113 
EV_POLL_IDLE
,

114 
EV_POLL_MAX
,

115 }
	tev_pﬁl_e
;

118 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_8258_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#DONGLE_8258_32
 0

	)

33 
	#DONGLE_8258_48
 1

	)

35 #i‡
deföed
 
DONGLE_8258_32
 && (DONGLE_8258_32 == 1)

40 
	#BUTTON1
 
GPIO_PD7


	)

41 
	#PD7_FUNC
 
AS_GPIO


	)

42 
	#PD7_OUTPUT_ENABLE
 0

	)

43 
	#PD7_INPUT_ENABLE
 1

	)

44 
	#PULL_WAKEUP_SRC_PD7
 
PM_PIN_PULLUP_10K


	)

46 
	#BUTTON2
 
GPIO_PA1


	)

47 
	#PA1_FUNC
 
AS_GPIO


	)

48 
	#PA1_OUTPUT_ENABLE
 0

	)

49 
	#PA1_INPUT_ENABLE
 1

	)

50 
	#PULL_WAKEUP_SRC_PA1
 
PM_PIN_PULLUP_10K


	)

53 
	#LED_G
 
GPIO_PA0


	)

54 
	#PA0_FUNC
 
AS_GPIO


	)

55 
	#PA0_OUTPUT_ENABLE
 1

	)

56 
	#PA0_INPUT_ENABLE
 0

	)

58 
	#LED_R
 
GPIO_PD4


	)

59 
	#PD4_FUNC
 
AS_GPIO


	)

60 
	#PD4_OUTPUT_ENABLE
 1

	)

61 
	#PD4_INPUT_ENABLE
 0

	)

63 
	#LED_POWER
 
LED_R


	)

64 
	#LED_PERMIT
 
LED_G


	)

67 #i‡
ZBHCI_UART


68 
	#UART_TX_PIN
 
UART_TX_PB1


	)

69 
	#UART_RX_PIN
 
UART_RX_PB7


	)

71 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

73 

	)

75 #i‡
UART_PRINTF_MODE


76 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC4


78 

	)

81 #ñi‡
deföed
 
DONGLE_8258_48
 && (DONGLE_8258_48 == 1)

86 
	#BUTTON1
 
GPIO_PD6


	)

87 
	#PD6_FUNC
 
AS_GPIO


	)

88 
	#PD6_OUTPUT_ENABLE
 0

	)

89 
	#PD6_INPUT_ENABLE
 1

	)

90 
	#PULL_WAKEUP_SRC_PD6
 
PM_PIN_PULLUP_10K


	)

92 
	#BUTTON2
 
GPIO_PD5


	)

93 
	#PD5_FUNC
 
AS_GPIO


	)

94 
	#PD5_OUTPUT_ENABLE
 0

	)

95 
	#PD5_INPUT_ENABLE
 1

	)

96 
	#PULL_WAKEUP_SRC_PD5
 
PM_PIN_PULLUP_10K


	)

99 
	#LED_G
 
GPIO_PA2


	)

100 
	#PA2_FUNC
 
AS_GPIO


	)

101 
	#PA2_OUTPUT_ENABLE
 1

	)

102 
	#PA2_INPUT_ENABLE
 0

	)

104 
	#LED_R
 
GPIO_PA3


	)

105 
	#PA3_FUNC
 
AS_GPIO


	)

106 
	#PA3_OUTPUT_ENABLE
 1

	)

107 
	#PA3_INPUT_ENABLE
 0

	)

109 
	#LED_POWER
 
LED_R


	)

110 
	#LED_PERMIT
 
LED_G


	)

113 #i‡
ZBHCI_UART


114 
	#UART_TX_PIN
 
UART_TX_PD7


	)

115 
	#UART_RX_PIN
 
UART_RX_PA0


	)

117 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

119 

	)

121 #i‡
UART_PRINTF_MODE


122 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC6


124 

	)

132 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


133 
	#HW_USB_CFG
() do{ \

134 
	`usb_£t_pö_í
(); \

135 }0)

	)

140 
VK_SW1
 = 0x01,

141 
VK_SW2
 = 0x02

144 
	#KB_MAP_NORMAL
 {\

145 {
VK_SW1
,}, \

146 {
VK_SW2
,}, }

	)

148 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

149 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

151 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

152 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

156 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_8258_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PD1


	)

33 
	#PD1_FUNC
 
AS_GPIO


	)

34 
	#PD1_OUTPUT_ENABLE
 0

	)

35 
	#PD1_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PD1
 
PM_PIN_PULLUP_10K


	)

38 
	#BUTTON2
 
GPIO_PD2


	)

39 
	#PD2_FUNC
 
AS_GPIO


	)

40 
	#PD2_OUTPUT_ENABLE
 0

	)

41 
	#PD2_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

45 
	#LED_G
 
GPIO_PD4


	)

46 
	#PD4_FUNC
 
AS_GPIO


	)

47 
	#PD4_OUTPUT_ENABLE
 1

	)

48 
	#PD4_INPUT_ENABLE
 0

	)

50 
	#LED_R
 
GPIO_PD0


	)

51 
	#PD0_FUNC
 
AS_GPIO


	)

52 
	#PD0_OUTPUT_ENABLE
 1

	)

53 
	#PD0_INPUT_ENABLE
 0

	)

55 
	#LED_POWER
 
LED_R


	)

56 
	#LED_PERMIT
 
LED_G


	)

59 #i‡
ZBHCI_UART


60 
	#UART_TX_PIN
 
UART_TX_PB1


	)

61 
	#UART_RX_PIN
 
UART_RX_PB0


	)

63 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

65 

	)

67 #i‡
UART_PRINTF_MODE


68 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC7


70 

	)

72 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


73 
	#HW_USB_CFG
() do{ \

74 
	`usb_£t_pö_í
(); \

75 }0)

	)

80 
VK_SW1
 = 0x01,

81 
VK_SW2
 = 0x02

84 
	#KB_MAP_NORMAL
 {\

85 {
VK_SW1
,}, \

86 {
VK_SW2
,}, }

	)

88 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

89 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

91 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

92 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

96 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_8258_evk_v1p2.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PB2


	)

33 
	#PB2_FUNC
 
AS_GPIO


	)

34 
	#PB2_OUTPUT_ENABLE
 0

	)

35 
	#PB2_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PB2
 
PM_PIN_PULLDOWN_100K


	)

38 
	#BUTTON2
 
GPIO_PB3


	)

39 
	#PB3_FUNC
 
AS_GPIO


	)

40 
	#PB3_OUTPUT_ENABLE
 0

	)

41 
	#PB3_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PB3
 
PM_PIN_PULLDOWN_100K


	)

44 
	#BUTTON3
 
GPIO_PB4


	)

45 
	#PB4_FUNC
 
AS_GPIO


	)

46 
	#PB4_OUTPUT_ENABLE
 0

	)

47 
	#PB4_INPUT_ENABLE
 1

	)

48 
	#PULL_WAKEUP_SRC_PB4
 
PM_PIN_PULLUP_10K


	)

50 
	#BUTTON4
 
GPIO_PB5


	)

51 
	#PB5_FUNC
 
AS_GPIO


	)

52 
	#PB5_OUTPUT_ENABLE
 0

	)

53 
	#PB5_INPUT_ENABLE
 1

	)

54 
	#PULL_WAKEUP_SRC_PB5
 
PM_PIN_PULLUP_10K


	)

57 
	#LED_R
 
GPIO_PD5


	)

58 
	#PD5_FUNC
 
AS_GPIO


	)

59 
	#PD5_OUTPUT_ENABLE
 1

	)

60 
	#PD5_INPUT_ENABLE
 0

	)

62 
	#LED_G
 
GPIO_PD3


	)

63 
	#PD3_FUNC
 
AS_GPIO


	)

64 
	#PD3_OUTPUT_ENABLE
 1

	)

65 
	#PD3_INPUT_ENABLE
 0

	)

67 
	#LED_POWER
 
LED_R


	)

68 
	#LED_PERMIT
 
LED_G


	)

71 #i‡
ZBHCI_UART


72 
	#UART_TX_PIN
 
UART_TX_PB1


	)

73 
	#UART_RX_PIN
 
UART_RX_PB0


	)

75 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

77 

	)

79 #i‡
UART_PRINTF_MODE


80 
	#DEBUG_INFO_TX_PIN
 
GPIO_PD0


82 

	)

84 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


85 
	#HW_USB_CFG
() do{ \

86 
	`usb_£t_pö_í
(); \

87 }0)

	)

92 
VK_SW1
 = 0x01,

93 
VK_SW2
 = 0x02,

94 
VK_SW3
 = 0x03,

95 
VK_SW4
 = 0x04

98 
	#KB_MAP_NORMAL
 {\

99 {
VK_SW1
, 
VK_SW3
}, \

100 {
VK_SW2
, 
VK_SW4
}, }

	)

102 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

103 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

105 
	#KB_DRIVE_PINS
 {
GPIO_PB2
, 
GPIO_PB3
}

	)

106 
	#KB_SCAN_PINS
 {
GPIO_PB4
, 
GPIO_PB5
}

	)

109 
	#KB_LINE_MODE
 0

	)

110 
	#KB_LINE_HIGH_VALID
 0

	)

114 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_826x_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PD2


	)

33 
	#PD2_FUNC
 
AS_GPIO


	)

34 
	#PD2_OUTPUT_ENABLE
 0

	)

35 
	#PD2_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

38 
	#BUTTON2
 
GPIO_PC5


	)

39 
	#PC5_FUNC
 
AS_GPIO


	)

40 
	#PC5_OUTPUT_ENABLE
 0

	)

41 
	#PC5_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PC5
 
PM_PIN_PULLUP_10K


	)

45 
	#LED_B
 
GPIO_PB6


	)

46 
	#PB6_FUNC
 
AS_GPIO


	)

47 
	#PB6_OUTPUT_ENABLE
 1

	)

48 
	#PB6_INPUT_ENABLE
 0

	)

50 
	#LED_W
 
GPIO_PB4


	)

51 
	#PB4_FUNC
 
AS_GPIO


	)

52 
	#PB4_OUTPUT_ENABLE
 1

	)

53 
	#PB4_INPUT_ENABLE
 0

	)

55 
	#LED_POWER
 
LED_W


	)

56 
	#LED_PERMIT
 
LED_B


	)

59 #if 
ZBHCI_UART


60 
	#UART_TX_PIN
 
GPIO_PC2


	)

61 
	#PC2_FUNC
 
AS_UART


	)

62 
	#PC2_INPUT_ENABLE
 0

	)

63 
	#PC2_OUTPUT_ENABLE
 1

	)

64 
	#PC2_DATA_STRENGTH
 0

	)

66 
	#UART_RX_PIN
 
GPIO_PC3


	)

67 
	#PC3_FUNC
 
AS_UART


	)

68 
	#PC3_INPUT_ENABLE
 1

	)

69 
	#PC3_OUTPUT_ENABLE
 0

	)

70 
	#PC3_DATA_STRENGTH
 0

	)

71 
	#PULL_WAKEUP_SRC_PC3
 
PM_PIN_PULLUP_10K


	)

73 
	#UART_PIN_CFG
(Ë
	`UART_GPIO_CFG_PC2_PC3
()

	)

77 #i‡
UART_PRINTF_MODE


78 
	#DEBUG_INFO_TX_PIN
 
GPIO_PB5


80 

	)

82 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


83 
	#HW_USB_CFG
() do{ \

84 
	`usb_£t_pö_í
(); \

85 }0)

	)

90 
VK_SW1
 = 0x01,

91 
VK_SW2
 = 0x02

94 
	#KB_MAP_NORMAL
 {\

95 {
VK_SW1
,}, \

96 {
VK_SW2
,}, }

	)

98 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

99 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

101 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

102 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

106 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_826x_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PD2


	)

33 
	#PD2_FUNC
 
AS_GPIO


	)

34 
	#PD2_OUTPUT_ENABLE
 0

	)

35 
	#PD2_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

38 
	#BUTTON2
 
GPIO_PC7


	)

39 
	#PC7_FUNC
 
AS_GPIO


	)

40 
	#PC7_OUTPUT_ENABLE
 0

	)

41 
	#PC7_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PC7
 
PM_PIN_PULLUP_10K


	)

45 
	#LED_B
 
GPIO_PB4


	)

46 
	#PB4_FUNC
 
AS_GPIO


	)

47 
	#PB4_OUTPUT_ENABLE
 1

	)

48 
	#PB4_INPUT_ENABLE
 0

	)

50 
	#LED2
 
GPIO_PD6


	)

51 
	#PD6_FUNC
 
AS_GPIO


	)

52 
	#PD6_OUTPUT_ENABLE
 1

	)

53 
	#PD6_INPUT_ENABLE
 0

	)

55 
	#LED_W
 
GPIO_PD7


	)

56 
	#PD7_FUNC
 
AS_GPIO


	)

57 
	#PD7_OUTPUT_ENABLE
 1

	)

58 
	#PD7_INPUT_ENABLE
 0

	)

60 
	#LED4
 
GPIO_PD5


	)

61 
	#PD5_FUNC
 
AS_GPIO


	)

62 
	#PD5_OUTPUT_ENABLE
 1

	)

63 
	#PD5_INPUT_ENABLE
 0

	)

65 
	#LED_POWER
 
LED_W


	)

66 
	#LED_PERMIT
 
LED_B


	)

69 #if 
ZBHCI_UART


70 
	#UART_TX_PIN
 
GPIO_PC2


	)

71 
	#PC2_FUNC
 
AS_UART


	)

72 
	#PC2_INPUT_ENABLE
 0

	)

73 
	#PC2_OUTPUT_ENABLE
 1

	)

74 
	#PC2_DATA_STRENGTH
 0

	)

76 
	#UART_RX_PIN
 
GPIO_PC3


	)

77 
	#PC3_FUNC
 
AS_UART


	)

78 
	#PC3_INPUT_ENABLE
 1

	)

79 
	#PC3_OUTPUT_ENABLE
 0

	)

80 
	#PC3_DATA_STRENGTH
 0

	)

81 
	#PULL_WAKEUP_SRC_PC3
 
PM_PIN_PULLUP_10K


	)

83 
	#UART_PIN_CFG
(Ë
	`UART_GPIO_CFG_PC2_PC3
()

	)

87 #i‡
UART_PRINTF_MODE


88 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC5


90 

	)

92 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


93 
	#HW_USB_CFG
() do{ \

94 
	`usb_£t_pö_í
(); \

95 }0)

	)

100 
VK_SW1
 = 0x01,

101 
VK_SW2
 = 0x02

104 
	#KB_MAP_NORMAL
 {\

105 {
VK_SW1
,}, \

106 {
VK_SW2
,}, }

	)

108 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

109 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

111 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

112 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

115 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_8278_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

36 
	#BUTTON1
 
GPIO_PD6


	)

37 
	#PD6_FUNC
 
AS_GPIO


	)

38 
	#PD6_OUTPUT_ENABLE
 0

	)

39 
	#PD6_INPUT_ENABLE
 1

	)

40 
	#PULL_WAKEUP_SRC_PD6
 
PM_PIN_PULLUP_10K


	)

42 
	#BUTTON2
 
GPIO_PD5


	)

43 
	#PD5_FUNC
 
AS_GPIO


	)

44 
	#PD5_OUTPUT_ENABLE
 0

	)

45 
	#PD5_INPUT_ENABLE
 1

	)

46 
	#PULL_WAKEUP_SRC_PD5
 
PM_PIN_PULLUP_10K


	)

49 
	#LED_G
 
GPIO_PA2


	)

50 
	#PA2_FUNC
 
AS_GPIO


	)

51 
	#PA2_OUTPUT_ENABLE
 1

	)

52 
	#PA2_INPUT_ENABLE
 0

	)

54 
	#LED_R
 
GPIO_PA3


	)

55 
	#PA3_FUNC
 
AS_GPIO


	)

56 
	#PA3_OUTPUT_ENABLE
 1

	)

57 
	#PA3_INPUT_ENABLE
 0

	)

59 
	#LED_POWER
 
LED_R


	)

60 
	#LED_PERMIT
 
LED_G


	)

63 #i‡
ZBHCI_UART


64 
	#UART_TX_PIN
 
UART_TX_PD7


	)

65 
	#UART_RX_PIN
 
UART_RX_PA0


	)

67 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

69 

	)

71 #i‡
UART_PRINTF_MODE


72 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC6


74 

	)

76 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


77 
	#HW_USB_CFG
(Ëdo{ \

	)

78 
usb_£t_pö_í
(); \

84 
VK_SW1
 = 0x01,

85 
VK_SW2
 = 0x02

88 
	#KB_MAP_NORMAL
 {\

	)

89 {
VK_SW1
,}, \

90 {
VK_SW2
,}, }

92 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

93 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

95 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

96 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

100 #i‡
	`deföed
(
__˝lu•lus
)

101 
	}
}

	@apps/bootLoader/board_8278_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PB2


	)

34 
	#PB2_FUNC
 
AS_GPIO


	)

35 
	#PB2_OUTPUT_ENABLE
 0

	)

36 
	#PB2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PB2
 
PM_PIN_PULLUP_10K


	)

39 
	#BUTTON2
 
GPIO_PB3


	)

40 
	#PB3_FUNC
 
AS_GPIO


	)

41 
	#PB3_OUTPUT_ENABLE
 0

	)

42 
	#PB3_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PB3
 
PM_PIN_PULLUP_10K


	)

47 
	#LED_G
 
GPIO_PD3


	)

48 
	#PD3_FUNC
 
AS_GPIO


	)

49 
	#PD3_OUTPUT_ENABLE
 1

	)

50 
	#PD3_INPUT_ENABLE
 0

	)

52 
	#LED_R
 
GPIO_PD5


	)

53 
	#PD5_FUNC
 
AS_GPIO


	)

54 
	#PD5_OUTPUT_ENABLE
 1

	)

55 
	#PD5_INPUT_ENABLE
 0

	)

57 
	#LED_POWER
 
LED_R


	)

58 
	#LED_PERMIT
 
LED_G


	)

61 #i‡
ZBHCI_UART


62 
	#UART_TX_PIN
 
UART_TX_PD0


	)

63 
	#UART_RX_PIN
 
UART_RX_PD6


	)

65 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

67 

	)

69 #i‡
UART_PRINTF_MODE


70 
	#DEBUG_INFO_TX_PIN
 
GPIO_PA2


72 

	)

74 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


75 
	#HW_USB_CFG
(Ëdo{ \

	)

76 
usb_£t_pö_í
(); \

82 
VK_SW1
 = 0x01,

83 
VK_SW2
 = 0x02

86 
	#KB_MAP_NORMAL
 {\

	)

87 {
VK_SW1
,}, \

88 {
VK_SW2
,}, }

90 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

91 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

93 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

94 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

97 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_9518_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PB2


34 
	#PB2_FUNC
 
AS_GPIO


	)

35 
	#PB2_OUTPUT_ENABLE
 0

	)

36 
	#PB2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PB2
 
GPIO_PIN_PULLUP_10K


	)

39 
	#BUTTON2
 
GPIO_PB3


40 
	#PB3_FUNC
 
AS_GPIO


	)

41 
	#PB3_OUTPUT_ENABLE
 0

	)

42 
	#PB3_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PB3
 
GPIO_PIN_PULLUP_10K


	)

46 
	#LED_Y
 
GPIO_PB5


47 
	#PB5_FUNC
 
AS_GPIO


	)

48 
	#PB5_OUTPUT_ENABLE
 1

	)

49 
	#PB5_INPUT_ENABLE
 0

	)

51 
	#LED_R
 
GPIO_PB4


52 
	#PB4_FUNC
 
AS_GPIO


	)

53 
	#PB4_OUTPUT_ENABLE
 1

	)

54 
	#PB4_INPUT_ENABLE
 0

	)

56 
	#LED_G
 
GPIO_PB0


57 
	#PB0_FUNC
 
AS_GPIO


	)

58 
	#PB0_OUTPUT_ENABLE
 1

	)

59 
	#PB0_INPUT_ENABLE
 0

	)

61 
	#LED_B
 
GPIO_PB7


62 
	#PB7_FUNC
 
AS_GPIO


	)

63 
	#PB7_OUTPUT_ENABLE
 1

	)

64 
	#PB7_INPUT_ENABLE
 0

	)

66 
	#LED_B2
 
GPIO_PB1


67 
	#PB1_FUNC
 
AS_GPIO


	)

68 
	#PB1_OUTPUT_ENABLE
 1

	)

69 
	#PB1_INPUT_ENABLE
 0

	)

71 
	#LED_B3
 
GPIO_PE3


72 
	#PE3_FUNC
 
AS_GPIO


	)

73 
	#PE3_OUTPUT_ENABLE
 1

	)

74 
	#PE3_INPUT_ENABLE
 0

	)

76 
	#LED_POWER
 
LED_R


	)

77 
	#LED_PERMIT
 
LED_G


	)

80 #i‡
ZBHCI_UART


81 
	#UART_TX_PIN
 
UART0_TX_PA3


	)

82 
	#UART_RX_PIN
 
UART0_RX_PA4


	)

84 
	#UART_PIN_CFG
(Ë
	`u¨t_£t_pö
(
UART_TX_PIN
, 
UART_RX_PIN
);

86 

	)

88 #i‡
UART_PRINTF_MODE


89 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC1


91 

	)

93 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


94 
	#HW_USB_CFG
(Ëdo{ \

	)

95 
usb_£t_pö_í
(); \

96 
usb_edp_í
(); \

102 
VK_SW1
 = 0x01,

103 
VK_SW2
 = 0x02,

106 
	#KB_MAP_NORMAL
 {\

	)

107 {
VK_SW1
,}, \

108 {
VK_SW2
,}, }

110 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

111 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

113 
	#KB_DRIVE_PINS
 {
NULL
}

	)

114 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

119 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/board_9518_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PC2


	)

34 
	#PC2_FUNC
 
AS_GPIO


	)

35 
	#PC2_OUTPUT_ENABLE
 0

	)

36 
	#PC2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PC2
 
GPIO_PIN_PULLDOWN_100K


	)

39 
	#BUTTON2
 
GPIO_PC0


	)

40 
	#PC0_FUNC
 
AS_GPIO


	)

41 
	#PC0_OUTPUT_ENABLE
 0

	)

42 
	#PC0_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PC0
 
GPIO_PIN_PULLDOWN_100K


	)

45 
	#BUTTON3
 
GPIO_PC3


	)

46 
	#PC3_FUNC
 
AS_GPIO


	)

47 
	#PC3_OUTPUT_ENABLE
 0

	)

48 
	#PC3_INPUT_ENABLE
 1

	)

49 
	#PULL_WAKEUP_SRC_PC3
 
GPIO_PIN_PULLUP_10K


	)

51 
	#BUTTON4
 
GPIO_PC1


	)

52 
	#PC1_FUNC
 
AS_GPIO


	)

53 
	#PC1_OUTPUT_ENABLE
 0

	)

54 
	#PC1_INPUT_ENABLE
 1

	)

55 
	#PULL_WAKEUP_SRC_PC1
 
GPIO_PIN_PULLUP_10K


	)

58 
	#LED_R
 
GPIO_PB7


	)

59 
	#PB7_FUNC
 
AS_GPIO


	)

60 
	#PB7_OUTPUT_ENABLE
 1

	)

61 
	#PB7_INPUT_ENABLE
 0

	)

63 
	#LED_W
 
GPIO_PB6


	)

64 
	#PB6_FUNC
 
AS_GPIO


	)

65 
	#PB6_OUTPUT_ENABLE
 1

	)

66 
	#PB6_INPUT_ENABLE
 0

	)

68 
	#LED_G
 
GPIO_PB5


	)

69 
	#PB5_FUNC
 
AS_GPIO


	)

70 
	#PB5_OUTPUT_ENABLE
 1

	)

71 
	#PB5_INPUT_ENABLE
 0

	)

73 
	#LED_B
 
GPIO_PB4


	)

74 
	#PB4_FUNC
 
AS_GPIO


	)

75 
	#PB4_OUTPUT_ENABLE
 1

	)

76 
	#PB4_INPUT_ENABLE
 0

	)

78 
	#LED_POWER
 
LED_R


	)

79 
	#LED_PERMIT
 
LED_G


	)

82 #i‡
ZBHCI_UART


83 
	#UART_TX_PIN
 
UART0_TX_PB2


	)

84 
	#UART_RX_PIN
 
UART0_RX_PB3


	)

86 
	#UART_PIN_CFG
(Ë
	`u¨t_£t_pö
(
UART_TX_PIN
, 
UART_RX_PIN
);

88 

	)

90 #i‡
UART_PRINTF_MODE


91 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC7


93 

	)

95 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


96 
	#HW_USB_CFG
(Ëdo{ \

	)

97 
usb_£t_pö_í
(); \

98 
usb_edp_í
(); \

104 
VK_SW1
 = 0x01,

105 
VK_SW2
 = 0x02,

106 
VK_SW3
 = 0x03,

107 
VK_SW4
 = 0x04

110 
	#KB_MAP_NORMAL
 {\

	)

111 {
VK_SW1
, 
VK_SW3
}, \

112 {
VK_SW2
, 
VK_SW4
}, }

114 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

115 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

117 
	#KB_DRIVE_PINS
 {
GPIO_PC2
, 
GPIO_PC0
}

	)

118 
	#KB_SCAN_PINS
 {
GPIO_PC3
, 
GPIO_PC1
}

	)

120 
	#KB_LINE_MODE
 0

	)

121 
	#KB_LINE_HIGH_VALID
 0

	)

124 #i‡
deföed
(
__˝lu•lus
)

	@apps/bootLoader/bootloader.c

24 #i‡(
__PROJECT_TL_BOOT_LOADER__
)

26 
	~"é_comm⁄.h
"

27 
	~"boŸlﬂdî.h
"

32 
	#APP_RUNNING_ADDR
 
APP_IMAGE_ADDR


	)

33 
	#APP_NEW_IMAGE_ADDR
 
FLASH_ADDR_OF_OTA_IMAGE


	)

36 #i‡
deföed
(
MCU_CORE_826x
)

37 
	#MCU_RAM_START_ADDR
 0x808000

	)

38 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

39 
	#MCU_RAM_START_ADDR
 0x840000

	)

40 #ñi‡
deföed
(
MCU_CORE_B91
)

41 
	#MCU_RAM_START_ADDR
 0x0000

	)

44 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

45 
	#REBOOT
(Ë
	`WRITE_REG8
(0x602, 0x88)

	)

46 #ñi‡
deföed
(
MCU_CORE_B91
)

47 
	#REBOOT
(Ë(((*)())(
FLASH_R_BASE_ADDR
 + 
APP_IMAGE_ADDR
))()

	)

50 
	#FW_START_UP_FLAG
 0x4B

	)

51 
	#FW_RAMCODE_SIZE_MAX
 
RESV_FOR_APP_RAM_CODE_SIZE


	)

55 
boﬁ
 
	$is_vÆid_fw_boŸlﬂdî
(
u32
 
addr_fw
){

56 
u8
 
°¨tup_Êag
 = 0;

57 
	`Êash_ªad
(
addr_fw
 + 
FLASH_TLNK_FLAG_OFFSET
, 1, &
°¨tup_Êag
);

59  ((
°¨tup_Êag
 =
FW_START_UP_FLAG
Ë? 
TRUE
 : 
FALSE
);

60 
	}
}

62 
	$boŸlﬂdî_wôh_Ÿa_check
(
u32
 
addr_lﬂd
, u32 
√w_image_addr
){

63 if(
√w_image_addr
 !
addr_lﬂd
){

64 if(
	`is_vÆid_fw_boŸlﬂdî
(
√w_image_addr
)){

65 
u8
 
buf
[256];

67 
	`Êash_ªad
(
√w_image_addr
, 256, 
buf
);

68 
u32
 
fw_size
 = *(u32 *)(
buf
 + 0x18);

70 if(
fw_size
 <
FLASH_OTA_IMAGE_MAX_SIZE
){

71 
i
 = 0; i < 
fw_size
; i += 256){

72 if((
i
 & 0xfff) == 0){

73 
	`Êash_îa£
(
addr_lﬂd
 + 
i
);

76 
	`Êash_ªad
(
√w_image_addr
 + 
i
, 256, 
buf
);

77 
	`Êash_wrôe
(
addr_lﬂd
 + 
i
, 256, 
buf
);

81 
buf
[0] = 0;

82 
	`Êash_wrôe
(
√w_image_addr
 + 
FLASH_TLNK_FLAG_OFFSET
, 1, 
buf
);

85 
i
 = 0; i < ((
fw_size
 + 4095)/4096); i++) {

86 
	`Êash_îa£
(
√w_image_addr
 + 
i
*4096);

91 if(
	`is_vÆid_fw_boŸlﬂdî
(
addr_lﬂd
)){

92 #i‡!
	`deföed
(
MCU_CORE_B91
)

93 
u32
 
ømcode_size
 = 0;

94 
	`Êash_ªad
(
addr_lﬂd
 + 0x0c, 2, (
u8
 *)&
ømcode_size
);

95 
ømcode_size
 *= 16;

97 if(
ømcode_size
 > 
FW_RAMCODE_SIZE_MAX
){

98 
ømcode_size
 = 
FW_RAMCODE_SIZE_MAX
;

100 
	`Êash_ªad
(
addr_lﬂd
, 
ømcode_size
, (
u8
 *)
MCU_RAM_START_ADDR
);

102 
	`REBOOT
();

104 
	}
}

106 
	$boŸlﬂdî_öô
(){

107 
	`boŸlﬂdî_wôh_Ÿa_check
(
APP_RUNNING_ADDR
, 
APP_NEW_IMAGE_ADDR
);

108 
	}
}

	@apps/bootLoader/bootloader.h

24 #i‚de‡
_BOOTLOADER_H_


25 
	#_BOOTLOADER_H_


	)

28 
boŸlﬂdî_öô
();

	@apps/bootLoader/main.c

24 
	~"é_comm⁄.h
"

25 
	~"boŸlﬂdî.h
"

28 
	$maö
(){

29 
u8
 
isRëíti⁄
 = 
	`drv_∂©f‹m_öô
();

31 #i‡
VOLTAGE_DETECT_ENABLE


32 if(!
isRëíti⁄
){

33 
	`vﬁège_dëe˘
();

37 
	`boŸlﬂdî_öô
();

39 #i‡
VOLTAGE_DETECT_ENABLE


40 
u32
 
tick
 = 
	`˛ock_time
();

44 #i‡
VOLTAGE_DETECT_ENABLE


45 if(
	`˛ock_time_ex˚ed
(
tick
, 200 * 1000)){

46 
	`vﬁège_dëe˘
();

47 
tick
 = 
	`˛ock_time
();

51 
	`gpio_toggÀ
(
LED_POWER
);

52 
	`WaôMs
(100);

56 
	}
}

	@apps/bootLoader/version_cfg.h

24 #¥agm®
⁄˚


26 
	~"../comm⁄/comm_cfg.h
"

28 #i‡
deföed
(
MCU_CORE_826x
)

29 #i‡(
CHIP_8269
)

30 
	#CHIP_TYPE
 
TLSR_8269


	)

32 
	#CHIP_TYPE
 
TLSR_8267


	)

34 #ñi‡
deföed
(
MCU_CORE_8258
)

35 
	#CHIP_TYPE
 
TLSR_8258_512K


36 #ñi‡
	`deföed
(
MCU_CORE_8278
)

	)

37 
	#CHIP_TYPE
 
TLSR_8278


	)

38 #ñi‡
deföed
(
MCU_CORE_B91
)

39 
	#CHIP_TYPE
 
TLSR_9518


	)

42 
	#APP_RELEASE
 0x10

43 
	#APP_BUILD
 0x01

44 
	#STACK_RELEASE
 0x30

45 
	#STACK_BUILD
 0x01

46 

	)

51 
	#MANUFACTURER_CODE_TELINK
 0x1141

52 
	#IMAGE_TYPE
 ((
CHIP_TYPE
 << 8Ë| 
IMAGE_TYPE_BOOTLOADER
)

	)

53 
	#FILE_VERSION
 ((
APP_RELEASE
 << 24Ë| (
APP_BUILD
 << 16Ë| (
STACK_RELEASE
 << 8Ë| 
STACK_BUILD
)

	)

56 
	#IS_BOOT_LOADER_IMAGE
 1

	)

57 
	#RESV_FOR_APP_RAM_CODE_SIZE
 0x4000

	)

58 
	#IMAGE_OFFSET
 
BOOT_LOADER_IMAGE_ADDR


	)

60 #i‡!
deföed
(
BOOT_LOADER_MODE
) || (BOOT_LOADER_MODE == 0)

	@apps/common/comm_cfg.h

24 #¥agm®
⁄˚


48 
	#BOOT_LOADER_MODE
 0

	)

53 
	#BOOT_LOADER_IMAGE_ADDR
 0x0

	)

56 #i‡(
BOOT_LOADER_MODE
)

57 
	#APP_IMAGE_ADDR
 0x8000

	)

59 
	#APP_IMAGE_ADDR
 0x0

	)

64 
	#TLSR_8267
 0x00

	)

65 
	#TLSR_8269
 0x01

	)

66 
	#TLSR_8258_512K
 0x02

	)

67 
	#TLSR_8258_1M
 0x03

	)

68 
	#TLSR_8278
 0x04

	)

69 
	#TLSR_9518
 0x05

	)

72 #i‡(
BOOT_LOADER_MODE
)

73 
	#IMAGE_TYPE_BOOT_FLAG
 1

	)

75 
	#IMAGE_TYPE_BOOT_FLAG
 0

	)

77 
	#IMAGE_TYPE_BOOTLOADER
 (0xFF)

	)

78 
	#IMAGE_TYPE_GW
 (0x00 | (
IMAGE_TYPE_BOOT_FLAG
 << 7))

	)

79 
	#IMAGE_TYPE_LIGHT
 (0x01 | (
IMAGE_TYPE_BOOT_FLAG
 << 7))

	)

80 
	#IMAGE_TYPE_SWITCH
 (0x02 | (
IMAGE_TYPE_BOOT_FLAG
 << 7))

	)

81 
	#IMAGE_TYPE_CONTACT_SENSOR
 (0x03 | (
IMAGE_TYPE_BOOT_FLAG
 << 7))

	)

	@apps/common/factory_reset.c

24 
	~"é_comm⁄.h
"

25 
	~"Á˘‹y_ª£t.h
"

26 
	~"zb_≠i.h
"

28 
	#FACTORY_RESET_POWER_CNT_THRESHOLD
 10

29 
	#FACTORY_RESET_TIMEOUT
 2

30 

	)

31 
ev_timî_evít_t
 *
	gÁ˘‹yR°_timîEvt
 = 
NULL
;

32 
u8
 
	gÁ˘‹yR°_powîC¡
 = 0;

33 
boﬁ
 
	gÁ˘‹yR°_exi°
 = 
FALSE
;

35 
nv_°s_t
 
	$Á˘‹yR°_powîC¡Save
()

37 
nv_°s_t
 
°
 = 
NV_SUCC
;

38 #i‡
NV_ENABLE


39 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_APP
, 
NV_ITEM_APP_POWER_CNT
, 1, &
Á˘‹yR°_powîC¡
);

41 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

43  
°
;

44 
	}
}

46 
nv_°s_t
 
	$Á˘‹yR°_powîC¡Re°‹e
()

48 
nv_°s_t
 
°
 = 
NV_SUCC
;

49 #i‡
NV_ENABLE


50 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_APP
, 
NV_ITEM_APP_POWER_CNT
, 1, &
Á˘‹yR°_powîC¡
);

52 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

54  
°
;

55 
	}
}

57 
s32
 
	$Á˘‹yR°_timîCb
(*
¨g
)

59 i‡(
Á˘‹yR°_powîC¡
 >
FACTORY_RESET_POWER_CNT_THRESHOLD
)

62 
Á˘‹yR°_exi°
 = 
TRUE
;

65 
Á˘‹yR°_powîC¡
 = 0;

66 
	`Á˘‹yR°_powîC¡Save
();

68 
Á˘‹yR°_timîEvt
 = 
NULL
;

70 
	}
}

72 
	$Á˘royR°_h™dÀr
()

74 i‡(
Á˘‹yR°_exi°
)

76 
Á˘‹yR°_exi°
 = 
FALSE
;

77 
	`zb_Á˘‹yRe£t
();

79 
	}
}

81 
	$Á˘royR°_öô
()

83 
	`Á˘‹yR°_powîC¡Re°‹e
();

84 
Á˘‹yR°_powîC¡
++;

85 
	`Á˘‹yR°_powîC¡Save
();

87 i‡(
Á˘‹yR°_timîEvt
)

89 
	`TL_ZB_TIMER_CANCEL
(&
Á˘‹yR°_timîEvt
);

91 
Á˘‹yR°_timîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
Á˘‹yR°_timîCb
, 
NULL
, 
FACTORY_RESET_TIMEOUT
 * 1000);

92 
	}
}

	@apps/common/factory_reset.h

24 #i‚de‡
FACTORY_RESET_H


25 
	#FACTORY_RESET_H


	)

27 
Á˘royR°_öô
();

28 
Á˘royR°_h™dÀr
();

	@apps/common/firmwareEncryptChk.c

24 
	~"é_comm⁄.h
"

25 #i‡
UID_ENABLE


26 
	~"fúmw¨e_í¸y±.h
"

28 
	~"fúmw¨eEn¸y±Chk.h
"

34 
u8
 
	$fúmw¨eCheckWôhUID
()

36 #i‡
UID_ENABLE


37 
u32
 
Êash_mid
 = 0;

38 
u8
 
Êash_uid
[16] = {0};

39 
Êag
 = 
	`Êash_ªad_mid_uid_wôh_check
(&
Êash_mid
, 
Êash_uid
);

40 if(
Êag
 == 0){

43 
u8
 
cùhîãxt
[16] = {0};

44 
	`fúmw¨e_í¸y±_ba£d_⁄_uid
(
Êash_uid
, 
cùhîãxt
);

46 
u8
 
code
[16] = {0};

47 
	`Êash_ªad
(
CFG_FIRMWARE_ENCRYPTION
, 16, 
code
);

49 if(
	`memcmp
(
cùhîãxt
, 
code
, 16)){

55 
	}
}

	@apps/common/firmwareEncryptChk.h

24 #i‚de‡
_FIRMWARE_ENCRYPT_CHECK_H_


25 
	#_FIRMWARE_ENCRYPT_CHECK_H_


	)

27 
u8
 
fúmw¨eCheckWôhUID
();

	@apps/common/main.c

24 
	~"zb_comm⁄.h
"

26 
u£r_öô
(
boﬁ
 
isRëíti⁄
);

32 
	$maö
(){

33 
u8
 
isRëíti⁄
 = 
	`drv_∂©f‹m_öô
();

35 #i‡
VOLTAGE_DETECT_ENABLE


36 if(!
isRëíti⁄
){

37 
	`vﬁège_dëe˘
();

41 
	`os_öô
(
isRëíti⁄
);

44 
	`moduÀTe°_°¨t
();

45 
	`moduÀTe°_°¨t
();

48 
	`u£r_öô
(
isRëíti⁄
);

50 
	`drv_íabÀ_úq
();

52 #i‡(
MODULE_WATCHDOG_ENABLE
)

53 
	`drv_wd_£tI¡îvÆ
(600);

54 
	`drv_wd_°¨t
();

57 #i‡
VOLTAGE_DETECT_ENABLE


58 
u32
 
tick
 = 
	`˛ock_time
();

62 #i‡
VOLTAGE_DETECT_ENABLE


63 if(
	`˛ock_time_ex˚ed
(
tick
, 200 * 1000)){

64 
	`vﬁège_dëe˘
();

65 
tick
 = 
	`˛ock_time
();

69 
	`ev_maö
();

71 #i‡(
MODULE_WATCHDOG_ENABLE
)

72 
	`drv_wd_˛ór
();

75 
	`é_zbTaskPro˚duª
();

77 #if (
MODULE_WATCHDOG_ENABLE
)

78 
	`drv_wd_˛ór
();

83 
	}
}

	@apps/common/module_test.c

24 
	~"zb_comm⁄.h
"

26 
	#MODULE_TEST_UART
 0

	)

28 #i‡
MODULE_TEST_UART


30 
	#TEST_826x
 0

	)

31 
	#TEST_8258
 1

	)

32 
	#TEST_8278
 2

	)

33 
	#TEST_9518
 3

	)

35 
	#TEST_MODULE
 
TEST_8258


	)

37 #i‡(
TEST_MODULE
 =
TEST_826x
)

38 
	#UART_TX_PIN
 
GPIO_PC2


	)

39 
	#UART_RX_PIN
 
GPIO_PC3


	)

40 #ñi‡(
TEST_MODULE
 =
TEST_8258
)

41 
	#UART_TX_PIN
 
GPIO_PD7


	)

42 
	#UART_RX_PIN
 
GPIO_PA0


	)

43 #ñi‡(
TEST_MODULE
 =
TEST_8278
)

44 
	#UART_TX_PIN
 
GPIO_PD7


	)

45 
	#UART_RX_PIN
 
GPIO_PA0


	)

46 #ñi‡(
TEST_MODULE
 =
TEST_9518
)

47 
	#UART_TX_PIN
 
GPIO_PB2


	)

48 
	#UART_RX_PIN
 
GPIO_PB3


	)

53 #i‡(
TEST_MODULE
 =
TEST_826x
)

54 
	#UART_PIN_INIT
(Ë\

	)

57 
drv_u¨t_pö_£t
(
UART_TX_PIN
, 
UART_RX_PIN
); \

58 
UART_GPIO_CFG_PC2_PC3
(); \

61 
	#UART_PIN_INIT
(Ë\

	)

64 
	`drv_u¨t_pö_£t
(
UART_TX_PIN
, 
UART_RX_PIN
); \

65 
	}
} 0)

70 
u32
 
d©aLí
;

71 
u8
 
d©aPaylﬂd
[1];

72 } 
	tu¨t_rxD©a_t
;

74 
	`__©åibuã__
((
	$Æig√d
(4))Ë
u8
 
moduÀTe°_u¨tTxBuf
[4] = {0
	}
};

75 
__©åibuã__
((
	$Æig√d
(4))Ë
u8
 
moduÀTe°_u¨tRxBuf
[32] = {0
	}
};

76 vﬁ©ûê
u8
 
	gT_u¨tPktSítSeqNo
 = 0;

77 vﬁ©ûê
u32
 
	gT_u¨tPktRecvSeqNo
 = 0;

78 vﬁ©ûê
u32
 
	gT_u¨tPktRecvLí
 = 0;

79 vﬁ©ûê
u32
 
	gT_u¨tPktSítEx˚±
 = 0;

81 
	$moduÀ_ã°_u¨tRcvH™dÀr
()

87 
u¨t_rxD©a_t
 *
rxD©a
 = (u¨t_rxD©a_à*)
moduÀTe°_u¨tRxBuf
;

88 
T_u¨tPktRecvLí
 = 
rxD©a
->
d©aLí
;

89 
T_u¨tPktRecvSeqNo
 = 
rxD©a
->
d©aPaylﬂd
[0];

91 i‡(
T_u¨tPktRecvSeqNo
 == 0)

93 
	`drv_u¨t_tx_°¨t
(
rxD©a
->
d©aPaylﬂd
, 
T_u¨tPktRecvLí
);

96 #i‡(
TEST_MODULE
 =
TEST_826x
Ë|| (TEST_MODULE =
TEST_8258
Ë|| (TEST_MODULE =
TEST_8278
Ë|| (TEST_MODULE =
TEST_9518
)

97 i‡(
T_u¨tPktRecvSeqNo
 == 0xBB)

99 
	`drv_adc_íabÀ
(1);

103 
	`drv_adc_íabÀ
(0);

106 
	}
}

108 
	$moduÀTe°_f‹U¨t
()

110 
	`UART_PIN_INIT
();

112 
	`drv_u¨t_öô
(115200, 
moduÀTe°_u¨tRxBuf
, (moduÀTe°_u¨tRxBufË/ (
u8
), 
moduÀ_ã°_u¨tRcvH™dÀr
);

114 
	`drv_adc_öô
();

116 #i‡(
TEST_MODULE
 =
TEST_826x
)

117 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
NOINPUT
);

118 #ñi‡(
TEST_MODULE
 =
TEST_8258
)

119 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
GPIO_PC5
);

120 #ñi‡(
TEST_MODULE
 =
TEST_8278
)

122 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
GPIO_PB3
);

123 #ñi‡(
TEST_MODULE
 =
TEST_9518
)

124 
	`drv_adc_mode_pö_£t
(
DRV_ADC_BASE_MODE
, 
ADC_GPIO_PB0
);

127 
	`drv_íabÀ_úq
();

129 
i
 = 0; i < (
moduÀTe°_u¨tTxBuf
Ë/ (
u8
); i++)

131 
moduÀTe°_u¨tTxBuf
[
i
] = i;

136 i‡(
T_u¨tPktRecvSeqNo
 == 0xAA)

138 
moduÀTe°_u¨tTxBuf
[0] = 
T_u¨tPktSítSeqNo
++;

139 i‡(
	`drv_u¨t_tx_°¨t
(
moduÀTe°_u¨tTxBuf
, (moduÀTe°_u¨tTxBufË/ (
u8
)) == 1)

141 
	`WaôMs
(1000);

145 
T_u¨tPktSítEx˚±
++;

150 i‡(
T_u¨tPktRecvSeqNo
 == 0xBB)

152 
u16
 
vB©
 = 
	`drv_gë_adc_d©a
();

154 
moduÀTe°_u¨tTxBuf
[0] = 
	`HI_UINT16
(
vB©
);

155 
moduÀTe°_u¨tTxBuf
[1] = 
	`LO_UINT16
(
vB©
);

157 i‡(
	`drv_u¨t_tx_°¨t
(
moduÀTe°_u¨tTxBuf
, 2) == 1)

159 
	`WaôMs
(1000);

163 
T_u¨tPktSítEx˚±
++;

168 i‡(
T_u¨tPktRecvSeqNo
 == 0xCC)

170 
u16
 
øndom
 = 
	`zb_øndom
();

172 
moduÀTe°_u¨tTxBuf
[0] = 
	`HI_UINT16
(
øndom
);

173 
moduÀTe°_u¨tTxBuf
[1] = 
	`LO_UINT16
(
øndom
);

175 i‡(
	`drv_u¨t_tx_°¨t
(
moduÀTe°_u¨tTxBuf
, 2) == 1)

177 
	`WaôMs
(1000);

181 
T_u¨tPktSítEx˚±
++;

187 
	}
}

191 
	#MODULE_TEST_NV
 0

	)

193 #i‡
MODULE_TEST_NV


194 vﬁ©ûê
u8
 
	gT_nwkFrmC¡Eº‹
 = 0;

195 vﬁ©ûê
u8
 
	gT_nwkFrmC¡RódEº
 = 0;

196 vﬁ©ûê
u32
 
	gT_‰ameC¡
 = 0;

197 vﬁ©ûê
u32
 
	gT_ªadFrm
 = 0;

198 vﬁ©ûê
u8
 
	gT_bufCheck
[256] = {0};

199 
	$moduÀTe°_NV
()

201 
u8
 *
pD©a
 = (u8 *)&
g_zbInfo
;

205 
T_ªadFrm
 = 0;

206 
	`nv_nwkFømeCou¡SaveToFœsh
(
T_‰ameC¡
);

207 
T_nwkFrmC¡RódEº
 = 
	`nv_nwkFømeCou¡FromFœsh
((
u32
 *)&
T_ªadFrm
);

209 i‡(
T_ªadFrm
 !
T_‰ameC¡
)

211 
T_nwkFrmC¡Eº‹
 = 1;

215 
T_‰ameC¡
 += 1;

220 
pD©a
 = (
u8
 *)&
g_zbInfo
;

221 
s32
 
i
 = 0; i < (
zb_öfo_t
); i++)

223 
pD©a
[
i
] = (ò+ 
T_‰ameC¡
);

226 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZB_INFO
, 
NV_ITEM_ZB_INFO
, (
zb_öfo_t
), (
u8
 *)&
g_zbInfo
);

227 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZB_INFO
, 
NV_ITEM_ZB_INFO
, (
zb_öfo_t
), (
u8
 *)&
T_bufCheck
);

228 
s32
 
i
 = 0; i < (
zb_öfo_t
); i++)

230 i‡(
pD©a
[
i
] !
T_bufCheck
[i])

237 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZB_INFO
, 2, (
nwk_nib_t
), (
u8
 *)&
g_zbInfo
.
nwkNib
);

238 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZB_INFO
, 2, (
nwk_nib_t
), (
u8
 *)&
T_bufCheck
);

239 
pD©a
 = (
u8
 *)&
g_zbInfo
.
nwkNib
;

240 
s32
 
i
 = 0; i < (
nwk_nib_t
); i++)

242 i‡(
pD©a
[
i
] !
T_bufCheck
[i])

248 
T_‰ameC¡
 += 1;

250 
	}
}

253 
	#MODULE_TEST_PM
 0

	)

255 #i‡
MODULE_TEST_PM


257 #i‡(
__PROJECT_TL_SWITCH__
)

258 
	#PAD_WAKUPUP_TEST
 1

	)

259 
	#TIMER_WAKUPUP_TEST
 1

	)

261 
drv_pm_pöCfg_t
 
g_swôchPmCfg
[];

262 
light_⁄
();

263 
light_off
();

265 
	gtxPktF‹Pm
[48] 
__©åibuã__
((
Æig√d
(4))) = {0x09, 0x00, 0x00, 0x00, 0x0a, 0x03, 0x08, 0xd0, 0xff, 0xff, 0xff, 0xff, 0x07};

267 
	$moduÀTe°_PM
()

269 
drv_pm_wakeup_§c_e
 
wakeupSrc
 = 0;

270 
drv_pm_¶ìp_mode_e
 
mode
 = 0;

272 
	`PM_CLOCK_INIT
();

274 
	`ZB_RADIO_TX_POWER_SET
(0);

275 
	`ZB_RADIO_TRX_CFG
(144);

277 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_TX
, 50);

279 
	`ZB_RADIO_DMA_HDR_BUILD
(
txPktF‹Pm
, 8);

281 #i‡
PAD_WAKUPUP_TEST


282 
	`drv_pm_wakeupPöC⁄fig
(
g_swôchPmCfg
, 2);

284 
wakeupSrc
 |
PM_WAKEUP_SRC_PAD
;

287 
u32
 
öãrvÆ
 = 0;

288 #i‡
TIMER_WAKUPUP_TEST


289 
öãrvÆ
 = 1000;

290 
wakeupSrc
 |
PM_WAKEUP_SRC_TIMER
;

293 #i‡
	`deföed
(
MCU_CORE_826x
)

294 
mode
 = 
PM_SLEEP_MODE_SUSPEND
;

295 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

296 
mode
 = 
PM_SLEEP_MODE_DEEP_WITH_RETENTION
;

299 i‡(
wakeupSrc
 =(
PM_WAKEUP_SRC_PAD
 | 
PM_WAKEUP_SRC_TIMER
))

301 
öãrvÆ
 = 10000;

304 
	`drv_íabÀ_úq
();

306 
	`WaôUs
(1000 * 1000);

310 
	`ZB_RADIO_TX_START
(
txPktF‹Pm
);

312 
u32
 
i
 = 0; i < 2; i++)

314 
	`light_⁄
();

315 
	`WaôUs
(100 * 1000);

316 
	`light_off
();

317 
	`WaôUs
(100 * 1000);

320 
	`drv_pm_¶ìp
(
mode
, 
wakeupSrc
, 
öãrvÆ
);

322 
	}
}

324 #îr‹ 
∂ó£
 
compûe
 
the
 
¥oje˘
 
of
 "sampleSwith"

328 
	#MODULE_TEST_RF
 0

	)

330 #i‡
MODULE_TEST_RF


332 
	#TX
 1

	)

334 
	grx_∑ckë
[128] 
__©åibuã__
((
Æig√d
(4)));

336 
	gtx_∑ckë
[48] 
__©åibuã__
((
Æig√d
(4))) = {0x09, 0x00, 0x00, 0x00, 0x0a, 0x03, 0x08, 0xd0, 0xff, 0xff, 0xff, 0xff, 0x07};

338 
	$moduÀTe°_RF
()

340 
	`ZB_RADIO_TX_POWER_SET
(0);

341 
	`ZB_RADIO_TRX_CFG
(144);

343 
	`ZB_RADIO_RX_BUF_SET
(
rx_∑ckë
);

345 
	`drv_íabÀ_úq
();

347 #i‡
TX


348 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_TX
, 50);

350 
	`ZB_RADIO_DMA_HDR_BUILD
(
tx_∑ckë
, 8);

354 
	`WaôMs
(100);

355 
	`ZB_RADIO_TX_START
(
tx_∑ckë
);

358 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_RX
, 50);

362 
	}
}

365 
	#MODULE_TEST_MMOHASH
 0

	)

366 #i‡
MODULE_TEST_MMOHASH


367 
u8
 
	gT_DBG_ö°ÆlCode
[18] = {0x83, 0xfe, 0xd3, 0x40, 0x7a, 0x93, 0x97, 0x23, 0xa5, 0xc6, 0x39, 0xb2, 0x69, 0x16, 0xd5, 0x05};

368 
u16
 
	gT_DBG_ösCodeCRC
;

372 
u8
 
	gT_DBG_hashOut
[16] = {0};

374 
	$moudÀTe°_hash
()

376 
T_DBG_ösCodeCRC
 = 
	`é_bdbIn°ÆlCodeCRC16
(
T_DBG_ö°ÆlCode
, 16);

377 
T_DBG_ö°ÆlCode
[16] = (
u8
)(
T_DBG_ösCodeCRC
 & 0xff);

378 
T_DBG_ö°ÆlCode
[17] = (
u8
)(
T_DBG_ösCodeCRC
 >> 8);

379 
	`ss_mmoHash
(
T_DBG_ö°ÆlCode
, 18, 
T_DBG_hashOut
);

382 
	}
}

385 
	#MODULE_TEST_CCM
 0

	)

386 #i‡
MODULE_TEST_CCM


389 
u8
 
	gkey
[] = {0xC0, 0xC1 , 0xC2 , 0xC3 , 0xC4 , 0xC5 , 0xC6 , 0xC7 , 0xC8 , 0xC9 , 0xCa, 0xCb , 0xCc , 0xCd , 0xCe , 0xCf};

390 
u8
 
	gn⁄˚
[] = {0x21, 0x43, 0x65, 0x87, 0x21, 0x43, 0x65, 0x87, 0x02, 0x00, 0x00, 0x00, 0x05};

391 
u8
 
	ga°rög
[] = {0x8c, 0x10, 0x21, 0x43, 0x65, 0x87, 0x02, 0x00, 0x00, 0x00, 0x20};

392 
u8
 
	ga°rLí
 = 11;

393 
u8
 
	gm°rög
[] = {0x83};

394 
u8
 
	gm°rLí
 = 0;

395 
u8
 
	gmic
[] = {0xCF, 0x78, 0x7E, 0x72};

397 
u8
 
	gkey
[] = {0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7, 0xC8, 0xC9, 0xCa, 0xCb, 0xCc, 0xCd, 0xCe, 0xCf};

398 
u8
 
	gn⁄˚
[] = {0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x99, 0x00, 0x00, 0x00, 0x05};

399 
u8
 
	ga°rög
[] = {0x8c, 0x12, 0x01, 0x00, 0x00, 0x00, 0x22};

400 
u8
 
	ga°rLí
 = 7;

401 
u8
 
	gm°rög
[] = {0x67};

402 
u8
 
	gm°rLí
 = 0;

403 
u8
 
	gmic
[] = {0x51, 0x3B, 0x81, 0x3F};

406 
	$moduÀTe°_ccm
()

413 
	`´s_ccmDecTøn
(4, 
key
, 
n⁄˚
, 
m°rög
, 
m°rLí
, 
a°rög
, 
a°rLí
, 
mic
);

415 
u8
 
ªt
 = 
	`´s_ccmDecAuthTøn
(4, 
key
, 
n⁄˚
, 
m°rög
, 
m°rLí
, 
a°rög
, 
a°rLí
, 
mic
);

419 
	}
}

422 
	#MODULE_TEST_ADC
 0

	)

424 #i‡
MODULE_TEST_ADC


426 vﬁ©ûê
u16
 
	gCvﬁège_vÆue
 = 0;

428 
	$moduÀTe°_adc
()

430 
	`drv_adc_öô
();

432 #i‡
	`deföed
(
MCU_CORE_826x
)

433 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
NOINPUT
);

434 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

435 
	`drv_adc_mode_pö_£t
(
DRV_ADC_BASE_MODE
, 
GPIO_PB3
);

438 
	`drv_adc_íabÀ
(1);

442 
Cvﬁège_vÆue
 = 
	`drv_gë_adc_d©a
();

443 
	`WaôMs
(2000);

445 
	}
}

448 
	#MODULE_TEST_TIMER
 0

	)

450 #i‡
MODULE_TEST_TIMER


452 
	#TEST_826x
 0

	)

453 
	#TEST_8258
 1

	)

454 
	#TEST_8278
 2

	)

455 
	#TEST_9518
 3

	)

457 
	#TEST_MODULE
 
TEST_8258


	)

459 #i‡(
TEST_MODULE
 =
TEST_826x
)

460 
	#TEST_GPIO_0
 
GPIO_PB6


	)

461 
	#TEST_GPIO_1
 
GPIO_PB4


	)

462 #ñi‡(
TEST_MODULE
 =
TEST_8258
)

463 
	#TEST_GPIO_0
 
GPIO_PA3


	)

464 
	#TEST_GPIO_1
 
GPIO_PA2


	)

465 #ñi‡(
TEST_MODULE
 =
TEST_8278
)

466 
	#TEST_GPIO_0
 
GPIO_PA3


	)

467 
	#TEST_GPIO_1
 
GPIO_PA2


	)

468 #ñi‡(
TEST_MODULE
 =
TEST_9518
)

469 
	#TEST_GPIO_0
 
GPIO_PB7


	)

470 
	#TEST_GPIO_1
 
GPIO_PB6


	)

475 vﬁ©ûê
u8
 
	gmoduÀTe°TimîFlg
 = 0;

476 
s32
 
	$moduÀTe°Timî0Cb
(*
¨g
)

478 
u8
 
˙t
 = 0;

480 
	`gpio_toggÀ
(
TEST_GPIO_0
);

482 i‡(++
˙t
 >= 10)

484 
˙t
 = 0;

485 
moduÀTe°TimîFlg
 = 1;

491 
	}
}

493 
s32
 
	$moduÀTe°Timî1Cb
(*
¨g
)

495 
	`gpio_toggÀ
(
TEST_GPIO_1
);

497 i‡(
moduÀTe°TimîFlg
)

503 
	}
}

505 
	$moduÀTe°_timî
()

507 
	`drv_gpio_func_£t
(
TEST_GPIO_0
);

508 
	`drv_gpio_ouçut_í
(
TEST_GPIO_0
, 1);

509 
	`drv_gpio_öput_í
(
TEST_GPIO_0
, 0);

510 
	`drv_gpio_wrôe
(
TEST_GPIO_0
, 1);

512 
	`drv_gpio_func_£t
(
TEST_GPIO_1
);

513 
	`drv_gpio_ouçut_í
(
TEST_GPIO_1
, 1);

514 
	`drv_gpio_öput_í
(
TEST_GPIO_1
, 0);

515 
	`drv_gpio_wrôe
(
TEST_GPIO_1
, 1);

517 
	`drv_hwTmr_öô
(
TIMER_IDX_0
, 
TIMER_MODE_SCLK
);

518 
	`drv_hwTmr_£t
(
TIMER_IDX_0
, 500 * 1000, 
moduÀTe°Timî0Cb
, 
NULL
);

520 
	`drv_hwTmr_öô
(
TIMER_IDX_1
, 
TIMER_MODE_SCLK
);

521 
	`drv_hwTmr_£t
(
TIMER_IDX_1
, 100 * 1000, 
moduÀTe°Timî1Cb
, 
NULL
);

523 
	`drv_íabÀ_úq
();

528 
	}
}

531 
	#MODULE_TEST_PWM
 0

	)

532 #i‡
MODULE_TEST_PWM


534 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

535 
	$moduÀTe°_pwm
()

537 
	`PWM_W_CHANNEL_SET
();

538 
	`drv_pwm_öô
();

540 
u8
 
duty
 = 5;

541 
u8
 
fuŒDuty
 = 100;

542 
u32
 
max_tick
 = 
PWM_CLOCK_SOURCE
 / 1000;

543 
u32
 
cmp_tick
 = (
duty
 * 
max_tick
Ë/ 
fuŒDuty
;

545 
	`drv_pwm_cfg
(
PWM_W_CHANNEL
, (
u16
)
cmp_tick
, (u16)
max_tick
);

546 
	`drv_pwm_°¨t
(
PWM_W_CHANNEL
);

550 i‡(
cmp_tick
 <
max_tick
)

552 
	`drv_pwm_cfg
(
PWM_W_CHANNEL
, (
u16
)
cmp_tick
, (u16)
max_tick
);

553 
cmp_tick
 += 2400;

554 
	`WaôMs
(500);

558 
cmp_tick
 = 0;

561 
	}
}

563 #îr‹ 
∂ó£
 
compûe
 
the
 
¥oje˘
 
of
 "sampleLight"

567 
	#MODULE_TEST_SPI
 0

	)

569 #i‡
MODULE_TEST_SPI


591 #i‡
deföed
(
MCU_CORE_826x
)

592 
	#TEST_SPI_PIN_GROUP
 
SPI_PIN_GPIOA


	)

593 
	#TEST_SPI_PIN_CS
 
GPIO_PA5


	)

594 #ñi‡
deföed
(
MCU_CORE_8258
)

595 
	#TEST_SPI_PIN_GROUP
 
SPI_GPIO_GROUP_A2A3A4D6


	)

596 
	#TEST_SPI_PIN_CS
 
GPIO_PD6


	)

597 #ñi‡
deföed
(
MCU_CORE_8278
)

598 
	#TEST_SPI_PIN_SDO
 
GPIO_PA2


	)

599 
	#TEST_SPI_PIN_SDI
 
GPIO_PA3


	)

600 
	#TEST_SPI_PIN_SCL
 
GPIO_PA4


	)

601 
	#TEST_SPI_PIN_CS
 
GPIO_PD6


	)

602 #ñi‡
deföed
(
MCU_CORE_B91
)

603 
	#TEST_SPI_PIN_MOSI
 
GPIO_PC7


	)

604 
	#TEST_SPI_PIN_MISO
 
GPIO_PC6


	)

605 
	#TEST_SPI_PIN_SCL
 
GPIO_PC5


	)

606 
	#TEST_SPI_PIN_CS
 
GPIO_PC4


	)

611 
	#SPI_MASTER_MODE
 0

	)

612 
	#SPI_SLAVE_MODE
 1

	)

615 
	#SPI_MODE
 
SPI_MASTER_MODE


	)

618 
	#SPI_CLOCK
 400000

619 

	)

621 
	#SPI_SLAVE_ADDR
 0x48000

622 
	#SPI_SLAVE_ADDR_LEN
 3

623 

	)

625 
	#SPI_READ_CMD
 0x80

	)

626 
	#SPI_WRITE_CMD
 0x00

	)

628 
	#CMD_BUF_LEN
 6

	)

629 
	#DBG_DATA_LEN
 16

	)

631 
u8
 
	gcmd_buf
[
CMD_BUF_LEN
] = {0};

633 
u8
 
	g•i_ma°î_tx_buff
[
DBG_DATA_LEN
] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};

635 
u8
 
	g•i_ma°î_rx_buff
[
DBG_DATA_LEN
] = {0x00};

637 
	$•i_ma°î_ã°_öô
()

639 
	`drv_•i_ma°î_öô
(
SPI_CLOCK
, 
SPI_MODE_0
);

641 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

642 
	`drv_•i_ma°î_pö_£À˘
(
TEST_SPI_PIN_GROUP
);

643 #ñi‡
	`deföed
(
MCU_CORE_8278
)

644 
	`drv_•i_ma°î_pö_£À˘
(
TEST_SPI_PIN_SCL
, 
TEST_SPI_PIN_CS
, 
TEST_SPI_PIN_SDO
, 
TEST_SPI_PIN_SDI
);

645 #ñi‡
	`deföed
(
MCU_CORE_B91
)

646 
	`drv_•i_ma°î_pö_£À˘
(
TEST_SPI_PIN_SCL
, 
TEST_SPI_PIN_CS
, 
TEST_SPI_PIN_MOSI
, 
TEST_SPI_PIN_MISO
);

648 
	}
}

650 
	$•i_¶ave_ã°_öô
()

652 
	`drv_•i_¶ave_öô
(
SPI_MODE_0
);

654 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

655 
	`drv_•i_¶ave_pö_£À˘
(
TEST_SPI_PIN_GROUP
);

656 #ñi‡
	`deföed
(
MCU_CORE_8278
)

657 
	`drv_•i_¶ave_pö_£À˘
(
TEST_SPI_PIN_SCL
, 
TEST_SPI_PIN_CS
, 
TEST_SPI_PIN_SDO
, 
TEST_SPI_PIN_SDI
);

658 #ñi‡
	`deföed
(
MCU_CORE_B91
)

659 
	`drv_•i_¶ave_pö_£À˘
(
TEST_SPI_PIN_SCL
, 
TEST_SPI_PIN_CS
, 
TEST_SPI_PIN_MOSI
, 
TEST_SPI_PIN_MISO
);

661 
	}
}

663 
	$•i_ma°î_ã°
()

665 
	`WaôMs
(1000);

667 
•i_ma°î_tx_buff
[0] += 1;

668 
•i_ma°î_tx_buff
[0] &= 0xff;

670 
u8
 
idx
 = 0;

671 
u8
 
i
 = 0; i < 
SPI_SLAVE_ADDR_LEN
; i++)

673 
cmd_buf
[
idx
++] = (
SPI_SLAVE_ADDR
 >> ((
SPI_SLAVE_ADDR_LEN
 - 1 - 
i
) << 3));

676 
cmd_buf
[
idx
] = 
SPI_WRITE_CMD
;

677 
	`drv_•i_wrôe
(
cmd_buf
, 
idx
 + 1, 
•i_ma°î_tx_buff
, 
DBG_DATA_LEN
, 
TEST_SPI_PIN_CS
);

679 
	`WaôMs
(1000);

681 
cmd_buf
[
idx
] = 
SPI_READ_CMD
;

682 
	`drv_•i_ªad
(
cmd_buf
, 
idx
 + 1, 
•i_ma°î_rx_buff
, 
DBG_DATA_LEN
, 
TEST_SPI_PIN_CS
);

683 
	}
}

685 
	$maö_lo›
()

687 #i‡(
SPI_MODE
 =
SPI_MASTER_MODE
)

688 
	`•i_ma°î_ã°
();

690 
	`WaôMs
(50);

692 
	}
}

694 
	$moduÀTe°_•i
()

696 
	`WaôMs
(2000);

698 #i‡(
SPI_MODE
 =
SPI_MASTER_MODE
)

699 
	`•i_ma°î_ã°_öô
();

701 
	`•i_¶ave_ã°_öô
();

706 
	`maö_lo›
();

708 
	}
}

711 
	#MODULE_TEST_I2C
 0

	)

713 #i‡
MODULE_TEST_I2C


715 #i‡
deföed
(
MCU_CORE_826x
)

716 
	#TEST_I2C_PIN_GROUP
 
I2C_PIN_GPIOA


	)

717 #ñi‡
deföed
(
MCU_CORE_8258
)

718 
	#TEST_I2C_PIN_GROUP
 
I2C_GPIO_GROUP_A3A4


	)

719 #ñi‡
deföed
(
MCU_CORE_8278
)

720 
	#TEST_I2C_PIN_SDA
 
I2C_GPIO_SDA_A3


	)

721 
	#TEST_I2C_PIN_SCL
 
I2C_GPIO_SCL_A4


	)

722 #ñi‡
deföed
(
MCU_CORE_B91
)

723 
	#TEST_I2C_PIN_SDA
 
I2C_GPIO_SDA_B3


	)

724 
	#TEST_I2C_PIN_SCL
 
I2C_GPIO_SCL_B2


	)

728 
	#I2C_CLOCK
 200000

729 

	)

731 
	#I2C_SLAVE_ID
 0x5A

	)

732 
	#I2C_SLAVE_ADDR
 0x48000

733 
	#I2C_SLAVE_ADDR_LEN
 3

734 

	)

735 
	#DBG_DATA_LEN
 16

	)

737 
u8
 
	gi2c_ma°î_tx_buff
[
DBG_DATA_LEN
] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};

739 
u8
 
	gi2c_ma°î_rx_buff
[
DBG_DATA_LEN
] = {0x00};

741 
	$i2c_ma°î_ã°_öô
()

743 
	`drv_i2c_ma°î_öô
(
I2C_CLOCK
);

745 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

746 
	`drv_i2c_gpio_£t
(
TEST_I2C_PIN_GROUP
);

747 #ñi‡
	`deföed
(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

748 
	`drv_i2c_gpio_£t
(
TEST_I2C_PIN_SDA
, 
TEST_I2C_PIN_SCL
);

750 
	}
}

752 
	$i2c_ma°î_ã°
()

754 
	`WaôMs
(1000);

756 
	`gpio_toggÀ
(
GPIO_PB7
);

758 
i2c_ma°î_tx_buff
[0] += 1;

759 
i2c_ma°î_tx_buff
[0] &= 0xff;

761 
	`drv_i2c_wrôe_£rõs
(
I2C_SLAVE_ID
, 
I2C_SLAVE_ADDR
, 
I2C_SLAVE_ADDR_LEN
, 
i2c_ma°î_tx_buff
, 
DBG_DATA_LEN
);

763 
	`WaôMs
(1000);

765 
	`drv_i2c_ªad_£rõs
(
I2C_SLAVE_ID
, 
I2C_SLAVE_ADDR
, 
I2C_SLAVE_ADDR_LEN
, 
i2c_ma°î_rx_buff
, 
DBG_DATA_LEN
);

766 
	}
}

768 
	$moduÀTe°_i2c
()

770 
	`WaôMs
(2000);

772 
	`drv_gpio_func_£t
(
GPIO_PB7
);

773 
	`drv_gpio_ouçut_í
(
GPIO_PB7
, 1);

774 
	`drv_gpio_öput_í
(
GPIO_PB7
, 0);

775 
	`drv_gpio_wrôe
(
GPIO_PB7
, 1);

777 
	`i2c_ma°î_ã°_öô
();

781 
	`i2c_ma°î_ã°
();

783 
	}
}

786 
	#MODULE_TEST_GPIO_IRQ
 0

	)

788 #i‡
MODULE_TEST_GPIO_IRQ


790 
	#TEST_826x
 0

	)

791 
	#TEST_8258
 1

	)

792 
	#TEST_8278
 2

	)

793 
	#TEST_9518
 3

	)

795 
	#TEST_MODULE
 
TEST_8258


	)

797 #i‡(
TEST_MODULE
 =
TEST_826x
)

798 
	#TEST_LED1
 
GPIO_PC2


	)

799 
	#TEST_LED2
 
GPIO_PC3


	)

800 
	#TEST_SW1
 
GPIO_PD2


	)

801 
	#TEST_SW2
 
GPIO_PC5


	)

802 
	#TEST_GPIO
 
GPIO_PD3


	)

803 #ñi‡(
TEST_MODULE
 =
TEST_8258
)

804 
	#TEST_LED1
 
GPIO_PA4


	)

805 
	#TEST_LED2
 
GPIO_PB1


	)

806 
	#TEST_SW1
 
GPIO_PD5


	)

807 
	#TEST_SW2
 
GPIO_PD6


	)

808 
	#TEST_GPIO
 
GPIO_PB2


	)

809 #ñi‡(
TEST_MODULE
 =
TEST_8278
)

810 
	#TEST_LED1
 
GPIO_PA2


	)

811 
	#TEST_LED2
 
GPIO_PA3


	)

812 
	#TEST_SW1
 
GPIO_PD6


	)

813 
	#TEST_SW2
 
GPIO_PD5


	)

814 
	#TEST_GPIO
 
GPIO_PB2


	)

815 #ñi‡(
TEST_MODULE
 =
TEST_9518
)

816 
	#TEST_LED1
 
GPIO_PB7


	)

817 
	#TEST_LED2
 
GPIO_PB6


	)

818 
	#TEST_SW1
 
GPIO_PC4


	)

819 
	#TEST_SW2
 
GPIO_PC5


	)

820 
	#TEST_GPIO
 
GPIO_PA0


	)

825 vﬁ©ûê
u8
 
	gT_DBG_gpioIrqCb1
 = 0;

826 
	$moduÀTe°_gpioIrqCb1
()

828 
T_DBG_gpioIrqCb1
++;

829 
	`gpio_toggÀ
(
TEST_LED1
);

830 
	}
}

832 vﬁ©ûê
u8
 
	gT_DBG_gpioIrqCb2
 = 0;

833 
	$moduÀTe°_gpioIrqCb2
()

835 
T_DBG_gpioIrqCb2
++;

836 
	`gpio_toggÀ
(
TEST_LED2
);

837 
	}
}

839 vﬁ©ûê
u8
 
	gT_DBG_gpioIrqCb3
 = 0;

840 
	$moduÀTe°_gpioIrqCb3
()

842 
T_DBG_gpioIrqCb3
++;

843 
	`gpio_toggÀ
(
TEST_LED1
);

845 i‡(
	`gpio_ªad
(
TEST_GPIO
))

847 
	`drv_gpio_up_down_ªsi°‹
(
TEST_GPIO
, 
PM_PIN_PULLUP_10K
);

848 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
TEST_GPIO
, 
FALLING_EDGE
, 
moduÀTe°_gpioIrqCb3
);

852 
	`drv_gpio_up_down_ªsi°‹
(
TEST_GPIO
, 
PM_PIN_PULLDOWN_100K
);

853 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
TEST_GPIO
, 
RISING_EDGE
, 
moduÀTe°_gpioIrqCb3
);

855 
	}
}

857 vﬁ©ûê
u8
 
	gT_DBG_maöC¡
 = 0;

858 
	$moduÀTe°_gpioIrq
()

861 
	`drv_gpio_func_£t
(
TEST_LED1
);

862 
	`drv_gpio_ouçut_í
(
TEST_LED1
, 1);

863 
	`drv_gpio_öput_í
(
TEST_LED1
, 0);

866 
	`drv_gpio_func_£t
(
TEST_LED2
);

867 
	`drv_gpio_ouçut_í
(
TEST_LED2
, 1);

868 
	`drv_gpio_öput_í
(
TEST_LED2
, 0);

869 
	`drv_gpio_wrôe
(
TEST_LED2
, 1);

872 
	`drv_gpio_func_£t
(
TEST_SW1
);

873 
	`drv_gpio_ouçut_í
(
TEST_SW1
, 0);

874 
	`drv_gpio_öput_í
(
TEST_SW1
, 1);

875 
	`drv_gpio_up_down_ªsi°‹
(
TEST_SW1
, 
PM_PIN_PULLUP_10K
);

876 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
TEST_SW1
, 
FALLING_EDGE
, 
moduÀTe°_gpioIrqCb1
);

877 
	`drv_gpio_úq_í
(
TEST_SW1
);

881 
	`drv_gpio_func_£t
(
TEST_SW2
);

882 
	`drv_gpio_ouçut_í
(
TEST_SW2
, 0);

883 
	`drv_gpio_öput_í
(
TEST_SW2
, 1);

884 
	`drv_gpio_up_down_ªsi°‹
(
TEST_SW2
, 
PM_PIN_PULLUP_10K
);

885 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_RISC0_MODE
, 
TEST_SW2
, 
FALLING_EDGE
, 
moduÀTe°_gpioIrqCb2
);

886 
	`drv_gpio_úq_risc0_í
(
TEST_SW2
);

889 
	`drv_gpio_func_£t
(
TEST_GPIO
);

890 
	`drv_gpio_ouçut_í
(
TEST_GPIO
, 0);

891 
	`drv_gpio_öput_í
(
TEST_GPIO
, 1);

892 i‡(
	`gpio_ªad
(
TEST_GPIO
))

894 
	`drv_gpio_up_down_ªsi°‹
(
TEST_GPIO
, 
PM_PIN_PULLUP_10K
);

895 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
TEST_GPIO
, 
FALLING_EDGE
, 
moduÀTe°_gpioIrqCb3
);

896 
	`drv_gpio_wrôe
(
TEST_LED1
, 1);

900 
	`drv_gpio_up_down_ªsi°‹
(
TEST_GPIO
, 
PM_PIN_PULLDOWN_100K
);

901 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
TEST_GPIO
, 
RISING_EDGE
, 
moduÀTe°_gpioIrqCb3
);

902 
	`drv_gpio_wrôe
(
TEST_LED1
, 0);

904 
	`drv_gpio_úq_í
(
TEST_GPIO
);

906 
	`drv_íabÀ_úq
();

910 
T_DBG_maöC¡
++;

911 
	`gpio_toggÀ
(
TEST_LED2
);

912 
	`WaôMs
(500);

914 
	}
}

917 
	$moduÀTe°_°¨t
()

919 #i‡
MODULE_TEST_MMOHASH


920 
	`moudÀTe°_hash
();

923 #i‡
MODULE_TEST_CCM


924 
	`moduÀTe°_ccm
();

927 #i‡
MODULE_TEST_PM


928 
	`moduÀTe°_PM
();

931 #i‡
MODULE_TEST_UART


932 
	`moduÀTe°_f‹U¨t
();

935 #i‡
MODULE_TEST_RF


936 
	`moduÀTe°_RF
();

939 #i‡
MODULE_TEST_ADC


940 
	`moduÀTe°_adc
();

943 #i‡
MODULE_TEST_TIMER


944 
	`moduÀTe°_timî
();

947 #i‡
MODULE_TEST_PWM


948 
	`moduÀTe°_pwm
();

951 #i‡
MODULE_TEST_SPI


952 
	`moduÀTe°_•i
();

955 #i‡
MODULE_TEST_I2C


956 
	`moduÀTe°_i2c
();

959 #i‡
MODULE_TEST_NV


960 
	`moduÀTe°_NV
();

963 #i‡
MODULE_TEST_GPIO_IRQ


964 
	`moduÀTe°_gpioIrq
();

966 
	}
}

	@apps/sampleLight/app_cfg.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

35 
	~"vîsi⁄_cfg.h
"

41 
	#UART_PRINTF_MODE
 1

42 
	#USB_PRINTF_MODE
 0

	)

45 
	#ZBHCI_UART
 0

	)

48 
	#COLOR_RGB_SUPPORT
 1

	)

49 
	#COLOR_CCT_SUPPORT
 0

	)

52 
	#TOUCHLINK_SUPPORT
 1

	)

53 
	#FIND_AND_BIND_SUPPORT
 0

	)

56 
	#BOARD_826x_EVK
 0

	)

57 
	#BOARD_826x_DONGLE
 1

	)

58 
	#BOARD_8258_EVK
 2

	)

59 
	#BOARD_8258_DONGLE
 3

	)

60 
	#BOARD_8278_EVK
 4

	)

61 
	#BOARD_8278_DONGLE
 5

	)

62 
	#BOARD_9518_EVK
 6

	)

63 
	#BOARD_9518_DONGLE
 7

	)

66 #i‡
deföed
(
MCU_CORE_826x
)

67 
	#BOARD
 
BOARD_826x_DONGLE


	)

68 
	#CLOCK_SYS_CLOCK_HZ
 32000000

	)

69 #ñi‡
deföed
(
MCU_CORE_8258
)

70 #i‡(
CHIP_TYPE
 =
TLSR_8258_1M
)

71 
	#FLASH_CAP_SIZE_1M
 1

	)

73 
	#BOARD
 
BOARD_8258_DONGLE


74 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

75 #ñi‡
deföed
(
MCU_CORE_8278
)

76 
	#FLASH_CAP_SIZE_1M
 1

	)

77 
	#BOARD
 
BOARD_8278_DONGLE


78 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

79 #ñi‡
deföed
(
MCU_CORE_B91
)

80 
	#FLASH_CAP_SIZE_1M
 1

	)

81 
	#BOARD
 
BOARD_9518_DONGLE


82 
	#CLOCK_SYS_CLOCK_HZ
 48000000

	)

88 #i‡(
BOARD
 =
BOARD_826x_EVK
)

89 
	~"bﬂrd_826x_evk.h
"

90 #ñif(
BOARD
 =
BOARD_826x_DONGLE
)

91 
	~"bﬂrd_826x_d⁄gÀ.h
"

92 #ñif(
BOARD
 =
BOARD_8258_DONGLE
)

93 
	~"bﬂrd_8258_d⁄gÀ.h
"

94 #ñif(
BOARD
 =
BOARD_8258_EVK
)

95 
	~"bﬂrd_8258_evk.h
"

96 #ñif(
BOARD
 =
BOARD_8278_EVK
)

97 
	~"bﬂrd_8278_evk.h
"

98 #ñif(
BOARD
 =
BOARD_8278_DONGLE
)

99 
	~"bﬂrd_8278_d⁄gÀ.h
"

100 #ñi‡(
BOARD
 =
BOARD_9518_EVK
)

101 
	~"bﬂrd_9518_evk.h
"

102 #ñi‡(
BOARD
 =
BOARD_9518_DONGLE
)

103 
	~"bﬂrd_9518_d⁄gÀ.h
"

112 
	#VOLTAGE_DETECT_ENABLE
 0

	)

115 
	#MODULE_WATCHDOG_ENABLE
 0

	)

118 #i‡
ZBHCI_UART


119 
	#MODULE_UART_ENABLE
 1

	)

122 #i‡(
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID
 || 
ZBHCI_UART
)

123 
	#ZBHCI_EN
 1

	)

130 
	#ZCL_ON_OFF_SUPPORT
 1

	)

131 
	#ZCL_LEVEL_CTRL_SUPPORT
 1

	)

132 #i‡(
COLOR_RGB_SUPPORT
 || 
COLOR_CCT_SUPPORT
)

133 
	#ZCL_LIGHT_COLOR_CONTROL_SUPPORT
 1

	)

136 
	#ZCL_GROUP_SUPPORT
 1

	)

137 
	#ZCL_SCENE_SUPPORT
 1

	)

138 
	#ZCL_OTA_SUPPORT
 1

	)

139 
	#ZCL_WWAH_SUPPORT
 0

	)

140 #i‡
TOUCHLINK_SUPPORT


141 
	#ZCL_ZLL_COMMISSIONING_SUPPORT
 1

	)

144 
	#AF_TEST_ENABLE
 0

	)

150 
	~"°ack_cfg.h
"

157 
EV_POLL_ED_DETECT
,

158 
EV_POLL_HCI
,

159 
EV_POLL_IDLE
,

160 
EV_POLL_MAX
,

161 }
	tev_pﬁl_e
;

164 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/app_ui.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"ßm∂eLight.h
"

33 
	~"≠p_ui.h
"

53 
	$Àd_⁄
(
u32
 
pö
){

54 
	`drv_gpio_wrôe
(
pö
, 
LED_ON
);

55 
	}
}

57 
	$Àd_off
(
u32
 
pö
){

58 
	`drv_gpio_wrôe
(
pö
, 
LED_OFF
);

59 
	}
}

61 
	$Àd_öô
(){

62 
	`Àd_off
(
LED_POWER
);

63 
	`Àd_off
(
LED_PERMIT
);

64 
	}
}

66 
	$loˇlPîmôJoöSèã
(){

67 
boﬁ
 
assocPîmô
 = 0;

68 if(
assocPîmô
 !
	`zb_gëMacAssocPîmô
()){

69 
assocPîmô
 = 
	`zb_gëMacAssocPîmô
();

70 if(
assocPîmô
){

71 
	`Àd_⁄
(
LED_PERMIT
);

73 
	`Àd_off
(
LED_PERMIT
);

76 
	}
}

78 
	$buâ⁄KìpPªs£d
(
u8
 
btNum
){

79 if(
btNum
 =
VK_SW1
){

80 
gLightCtx
.
°©e
 = 
APP_FACTORY_NEW_DOING
;

81 
	`zb_Á˘‹yRe£t
();

82 }if(
btNum
 =
VK_SW2
){

85 
	}
}

87 
	$buâ⁄Sh‹tPªs£d
(
u8
 
btNum
){

88 if(
btNum
 =
VK_SW1
){

89 if(
	`zb_isDevi˚JoöedNwk
()){

90 
gLightCtx
.
°a
 = !gLightCtx.sta;

91 if(
gLightCtx
.
°a
){

92 
	`ßm∂eLight_⁄off
(
ZCL_ONOFF_STATUS_ON
);

94 
	`ßm∂eLight_⁄off
(
ZCL_ONOFF_STATUS_OFF
);

97 }if(
btNum
 =
VK_SW2
){

99 
u8
 
duøti⁄
 = 0;

100 
duøti⁄
 = duration ? 0 : 0xff;

101 
	`zb_∆mePîmôJoöögReque°
(
duøti⁄
);

103 
	}
}

105 
	$keySˇn_keyPªs£dCB
(
kb_d©a_t
 *
kbEvt
){

107 
u8
 
keyCode
 = 
kbEvt
->
keycode
[0];

110 
	`buâ⁄Sh‹tPªs£d
(
keyCode
);

112 if(
keyCode
 =
VK_SW1
){

113 
gLightCtx
.
keyPªs£dTime
 = 
	`˛ock_time
();

114 
gLightCtx
.
°©e
 = 
APP_FACTORY_NEW_SET_CHECK
;

116 
	}
}

119 
	$keySˇn_keyRñó£dCB
(
u8
 
keyCode
){

120 
gLightCtx
.
°©e
 = 
APP_STATE_NORMAL
;

121 
	}
}

123 vﬁ©ûê
u8
 
	gT_keyPªs£dNum
 = 0;

124 
	$≠p_key_h™dÀr
(){

125 
u8
 
vÆid_keyCode
 = 0xff;

127 if(
gLightCtx
.
°©e
 =
APP_FACTORY_NEW_SET_CHECK
){

128 if(
	`˛ock_time_ex˚ed
(
gLightCtx
.
keyPªs£dTime
, 5*1000*1000)){

129 
	`buâ⁄KìpPªs£d
(
VK_SW1
);

133 if(
	`kb_sˇn_key
(0 , 1)){

134 
T_keyPªs£dNum
++;

135 if(
kb_evít
.
˙t
){

136 
	`keySˇn_keyPªs£dCB
(&
kb_evít
);

137 if(
kb_evít
.
˙t
 == 1){

138 
vÆid_keyCode
 = 
kb_evít
.
keycode
[0];

141 
	`keySˇn_keyRñó£dCB
(
vÆid_keyCode
);

142 
vÆid_keyCode
 = 0xff;

145 
	}
}

	@apps/sampleLight/app_ui.h

24 #i‚de‡
_APP_UI_H_


25 
	#_APP_UI_H_


	)

30 
	#LED_ON
 1

	)

31 
	#LED_OFF
 0

	)

38 
	mAPP_STATE_NORMAL
,

39 
	mAPP_FACTORY_NEW_SET_CHECK
,

40 
	mAPP_FACTORY_NEW_DOING
,

47 
Àd_öô
();

48 
Àd_⁄
(
u32
 
pö
);

49 
Àd_off
(
u32
 
pö
);

50 
loˇlPîmôJoöSèã
();

51 
≠p_key_h™dÀr
();

	@apps/sampleLight/board_8258_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#DONGLE_8258_32
 0

	)

33 
	#DONGLE_8258_48
 1

	)

35 #i‡
deföed
 
DONGLE_8258_32
 && (DONGLE_8258_32 == 1)

40 
	#BUTTON1
 
GPIO_PD7


	)

41 
	#PD7_FUNC
 
AS_GPIO


	)

42 
	#PD7_OUTPUT_ENABLE
 0

	)

43 
	#PD7_INPUT_ENABLE
 1

	)

44 
	#PULL_WAKEUP_SRC_PD7
 
PM_PIN_PULLUP_10K


	)

46 
	#BUTTON2
 
GPIO_PA1


	)

47 
	#PA1_FUNC
 
AS_GPIO


	)

48 
	#PA1_OUTPUT_ENABLE
 0

	)

49 
	#PA1_INPUT_ENABLE
 1

	)

50 
	#PULL_WAKEUP_SRC_PA1
 
PM_PIN_PULLUP_10K


	)

59 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

61 
	#LED_R
 
GPIO_PD4


62 
	#LED_G
 
GPIO_PA0


63 
	#LED_B
 
GPIO_PD3


64 

	)

65 
	#PWM_R_CHANNEL
 2

66 
	#PWM_R_CHANNEL_SET
(Ëdo{ \

	)

67 
gpio_£t_func
(
LED_R
, 
AS_PWM2_N
); \

68 
drv_pwm_n_övît
(
PWM_R_CHANNEL
); \

71 
	#PWM_G_CHANNEL
 0

72 
	#PWM_G_CHANNEL_SET
(Ëdo{ \

	)

73 
gpio_£t_func
(
LED_G
, 
AS_PWM0_N
); \

74 
drv_pwm_n_övît
(
PWM_G_CHANNEL
); \

77 
	#PWM_B_CHANNEL
 1

78 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

79 
gpio_£t_func
(
LED_B
, 
AS_PWM1_N
); \

80 
drv_pwm_n_övît
(
PWM_B_CHANNEL
); \

83 
	#R_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

84 
	#G_LIGHT_PWM_CHANNEL
 
PWM_G_CHANNEL


	)

85 
	#B_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

86 
	#R_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

87 
	#G_LIGHT_PWM_SET
(Ë
	`PWM_G_CHANNEL_SET
()

	)

88 
	#B_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

90 
	#LED_W
 
GPIO_PD2


	)

92 
	#PD2_FUNC
 
AS_GPIO


	)

93 
	#PD2_OUTPUT_ENABLE
 1

	)

94 
	#PD2_INPUT_ENABLE
 0

	)

96 
	#LED_POWER
 
NULL


	)

97 
	#LED_PERMIT
 
LED_W


	)

107 
	#LED_B
 
GPIO_PD3


108 
	#LED_W
 
GPIO_PD2


109 

	)

110 
	#PWM_B_CHANNEL
 1

111 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

112 
gpio_£t_func
(
LED_B
, 
AS_PWM1_N
); \

113 
drv_pwm_n_övît
(
PWM_B_CHANNEL
); \

116 
	#PWM_W_CHANNEL
 3

117 
	#PWM_W_CHANNEL_SET
(Ëdo{ \

	)

118 
gpio_£t_func
(
LED_W
, 
AS_PWM3
); \

121 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

122 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

123 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

124 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

127 
	#LED_R
 
GPIO_PD4


	)

128 
	#LED_G
 
GPIO_PA0


	)

130 
	#PD4_FUNC
 
AS_GPIO


	)

131 
	#PD4_OUTPUT_ENABLE
 1

	)

132 
	#PD4_INPUT_ENABLE
 0

	)

134 
	#PA0_FUNC
 
AS_GPIO


	)

135 
	#PA0_OUTPUT_ENABLE
 1

	)

136 
	#PA0_INPUT_ENABLE
 0

	)

138 
	#LED_POWER
 
LED_R


	)

139 
	#LED_PERMIT
 
LED_G


	)

144 #i‡
ZBHCI_UART


145 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

149 #i‡
UART_PRINTF_MODE


150 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC4


152 

	)

155 #ñi‡
deföed
 
DONGLE_8258_48
 && (DONGLE_8258_48 == 1)

160 
	#BUTTON1
 
GPIO_PD6


	)

161 
	#PD6_FUNC
 
AS_GPIO


	)

162 
	#PD6_OUTPUT_ENABLE
 0

	)

163 
	#PD6_INPUT_ENABLE
 1

	)

164 
	#PULL_WAKEUP_SRC_PD6
 
PM_PIN_PULLUP_10K


	)

166 
	#BUTTON2
 
GPIO_PD5


	)

167 
	#PD5_FUNC
 
AS_GPIO


	)

168 
	#PD5_OUTPUT_ENABLE
 0

	)

169 
	#PD5_INPUT_ENABLE
 1

	)

170 
	#PULL_WAKEUP_SRC_PD5
 
PM_PIN_PULLUP_10K


	)

180 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

182 
	#LED_R
 
GPIO_PA3


183 
	#LED_G
 
GPIO_PA2


184 
	#LED_B
 
GPIO_PB0


185 

	)

186 
	#PWM_R_CHANNEL
 1

187 
	#PWM_R_CHANNEL_SET
(Ëdo{ \

	)

188 
gpio_£t_func
(
LED_R
, 
AS_PWM1
); \

191 
	#PWM_G_CHANNEL
 0

192 
	#PWM_G_CHANNEL_SET
(Ëdo{ \

	)

193 
gpio_£t_func
(
LED_G
, 
AS_PWM0
); \

196 
	#PWM_B_CHANNEL
 3

197 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

198 
gpio_£t_func
(
LED_B
, 
AS_PWM3
); \

201 
	#R_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

202 
	#G_LIGHT_PWM_CHANNEL
 
PWM_G_CHANNEL


	)

203 
	#B_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

204 
	#R_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

205 
	#G_LIGHT_PWM_SET
(Ë
	`PWM_G_CHANNEL_SET
()

	)

206 
	#B_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

209 
	#LED_Y
 
GPIO_PA4


	)

210 
	#LED_W
 
GPIO_PB1


	)

212 
	#PA4_FUNC
 
AS_GPIO


	)

213 
	#PA4_OUTPUT_ENABLE
 1

	)

214 
	#PA4_INPUT_ENABLE
 0

	)

216 
	#PB1_FUNC
 
AS_GPIO


	)

217 
	#PB1_OUTPUT_ENABLE
 1

	)

218 
	#PB1_INPUT_ENABLE
 0

	)

220 
	#LED_POWER
 
LED_W


	)

221 
	#LED_PERMIT
 
LED_Y


	)

226 
	#LED_Y
 
GPIO_PA4


227 
	#LED_W
 
GPIO_PB1


228 

	)

229 
	#PWM_Y_CHANNEL
 2

230 
	#PWM_Y_CHANNEL_SET
(Ëdo{ \

	)

231 
gpio_£t_func
(
LED_Y
, 
AS_PWM2
); \

234 
	#PWM_W_CHANNEL
 4

235 
	#PWM_W_CHANNEL_SET
(Ëdo{ \

	)

236 
gpio_£t_func
(
LED_W
, 
AS_PWM4
); \

239 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_Y_CHANNEL


	)

240 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

241 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_Y_CHANNEL_SET
()

	)

242 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

245 
	#LED_R
 
GPIO_PA3


	)

246 
	#LED_G
 
GPIO_PA2


	)

248 
	#PA3_FUNC
 
AS_GPIO


	)

249 
	#PA3_OUTPUT_ENABLE
 1

	)

250 
	#PA3_INPUT_ENABLE
 0

	)

252 
	#PA2_FUNC
 
AS_GPIO


	)

253 
	#PA2_OUTPUT_ENABLE
 1

	)

254 
	#PA2_INPUT_ENABLE
 0

	)

256 
	#LED_POWER
 
LED_R


	)

257 
	#LED_PERMIT
 
LED_G


	)

262 #i‡
ZBHCI_UART


263 
	#UART_TX_PIN
 
UART_TX_PD7


	)

264 
	#UART_RX_PIN
 
UART_RX_PA0


	)

266 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

268 

	)

270 #i‡
UART_PRINTF_MODE


271 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC6


273 

	)

282 
VK_SW1
 = 0x01,

283 
VK_SW2
 = 0x02

286 
	#KB_MAP_NORMAL
 {\

	)

287 {
VK_SW1
,}, \

288 {
VK_SW2
,}, }

290 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

291 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

293 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

294 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

298 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_8258_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PD1


	)

34 
	#PD1_FUNC
 
AS_GPIO


	)

35 
	#PD1_OUTPUT_ENABLE
 0

	)

36 
	#PD1_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PD1
 
PM_PIN_PULLUP_10K


	)

39 
	#BUTTON2
 
GPIO_PD2


	)

40 
	#PD2_FUNC
 
AS_GPIO


	)

41 
	#PD2_OUTPUT_ENABLE
 0

	)

42 
	#PD2_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

52 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

57 
	#LED_B
 
GPIO_PD5


58 
	#LED_W
 
GPIO_PD3


59 

	)

60 
	#PWM_W_CHANNEL
 1

61 
	#PWM_W_CHANNEL_SET
(Ëdo{ \

	)

62 
gpio_£t_func
(
LED_W
, 
AS_PWM1_N
); \

63 
drv_pwm_n_övît
(
PWM_W_CHANNEL
); \

66 
	#PWM_B_CHANNEL
 0

67 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

68 
gpio_£t_func
(
LED_B
, 
AS_PWM0
); \

71 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

72 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

73 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

74 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

77 
	#LED_R
 
GPIO_PD0


	)

78 
	#LED_G
 
GPIO_PD4


	)

80 
	#PD4_FUNC
 
AS_GPIO


	)

81 
	#PD4_OUTPUT_ENABLE
 1

	)

82 
	#PD4_INPUT_ENABLE
 0

	)

84 
	#PD0_FUNC
 
AS_GPIO


	)

85 
	#PD0_OUTPUT_ENABLE
 1

	)

86 
	#PD0_INPUT_ENABLE
 0

	)

88 
	#LED_POWER
 
LED_R


	)

89 
	#LED_PERMIT
 
LED_G


	)

94 #i‡
ZBHCI_UART


95 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

99 #i‡
UART_PRINTF_MODE


100 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC7


102 

	)

105 
VK_SW1
 = 0x01,

106 
VK_SW2
 = 0x02

109 
	#KB_MAP_NORMAL
 {\

	)

110 {
VK_SW1
,}, \

111 {
VK_SW2
,}, }

113 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

114 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

116 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

117 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

121 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_826x_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PD2


	)

33 
	#PD2_FUNC
 
AS_GPIO


	)

34 
	#PD2_OUTPUT_ENABLE
 0

	)

35 
	#PD2_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

38 
	#BUTTON2
 
GPIO_PC5


	)

39 
	#PC5_FUNC
 
AS_GPIO


	)

40 
	#PC5_OUTPUT_ENABLE
 0

	)

41 
	#PC5_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PC5
 
PM_PIN_PULLUP_10K


	)

51 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

53 
	#PC2_FUNC
 
AS_PWM


	)

54 
	#PC2_OUTPUT_ENABLE
 1

	)

55 
	#PC2_INPUT_ENABLE
 0

	)

57 
	#PC3_FUNC
 
AS_PWM


	)

58 
	#PC3_OUTPUT_ENABLE
 1

	)

59 
	#PC3_INPUT_ENABLE
 0

	)

61 
	#PB6_FUNC
 
AS_PWM


	)

62 
	#PB6_OUTPUT_ENABLE
 1

	)

63 
	#PB6_INPUT_ENABLE
 0

	)

65 
	#PWM_R_CHANNEL_SET
(Ë
	`PWM2_CFG_GPIO_C2
()

	)

66 
	#PWM_R_CHANNEL
 2

67 

	)

68 
	#PWM_G_CHANNEL_SET
(Ë
	`PWM3_CFG_GPIO_C3
()

	)

69 
	#PWM_G_CHANNEL
 3

70 

	)

71 
	#PWM_B_CHANNEL_SET
(Ë
	`PWM5_CFG_GPIO_B6
()

	)

72 
	#PWM_B_CHANNEL
 5

73 

	)

74 
	#R_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

75 
	#G_LIGHT_PWM_CHANNEL
 
PWM_G_CHANNEL


	)

76 
	#B_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

77 
	#R_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

78 
	#G_LIGHT_PWM_SET
(Ë
	`PWM_G_CHANNEL_SET
()

	)

79 
	#B_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

81 
	#LED_W
 
GPIO_PB4


	)

83 
	#PB4_FUNC
 
AS_GPIO


	)

84 
	#PB4_OUTPUT_ENABLE
 1

	)

85 
	#PB4_INPUT_ENABLE
 0

	)

87 
	#LED_POWER
 
NULL


	)

88 
	#LED_PERMIT
 
LED_W


	)

93 
	#PB6_FUNC
 
AS_PWM


	)

94 
	#PB6_OUTPUT_ENABLE
 1

	)

95 
	#PB6_INPUT_ENABLE
 0

	)

97 
	#PB4_FUNC
 
AS_PWM


	)

98 
	#PB4_OUTPUT_ENABLE
 1

	)

99 
	#PB4_INPUT_ENABLE
 0

	)

101 
	#PWM_B_CHANNEL_SET
(Ë
	`PWM5_CFG_GPIO_B6
()

	)

102 
	#PWM_B_CHANNEL
 5

103 

	)

104 
	#PWM_W_CHANNEL_SET
(Ë
	`PWM4_CFG_GPIO_B4
()

	)

105 
	#PWM_W_CHANNEL
 4

106 

	)

107 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

108 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

109 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

110 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

112 
	#LED_R
 
GPIO_PC2


	)

113 
	#LED_G
 
GPIO_PC3


	)

115 
	#PC2_FUNC
 
AS_GPIO


	)

116 
	#PC2_OUTPUT_ENABLE
 1

	)

117 
	#PC2_INPUT_ENABLE
 0

	)

119 
	#PC3_FUNC
 
AS_GPIO


	)

120 
	#PC3_OUTPUT_ENABLE
 1

	)

121 
	#PC3_INPUT_ENABLE
 0

	)

123 
	#LED_POWER
 
LED_R


	)

124 
	#LED_PERMIT
 
LED_G


	)

129 #if 
ZBHCI_UART


130 
PC2
 & 
PC3
 
¨e
 
c⁄figuªd
 
as
 
LED
 
pös


134 #i‡
UART_PRINTF_MODE


135 
	#DEBUG_INFO_TX_PIN
 
GPIO_PB5


137 

	)

140 
VK_SW1
 = 0x01,

141 
VK_SW2
 = 0x02

144 
	#KB_MAP_NORMAL
 {\

	)

145 {
VK_SW1
,}, \

146 {
VK_SW2
,}, }

148 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

149 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

151 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

152 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

156 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_826x_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
	#BUTTON1
 
GPIO_PD2


	)

33 
	#PD2_FUNC
 
AS_GPIO


	)

34 
	#PD2_OUTPUT_ENABLE
 0

	)

35 
	#PD2_INPUT_ENABLE
 1

	)

36 
	#PULL_WAKEUP_SRC_PD2
 
PM_PIN_PULLUP_10K


	)

38 
	#BUTTON2
 
GPIO_PC7


	)

39 
	#PC7_FUNC
 
AS_GPIO


	)

40 
	#PC7_OUTPUT_ENABLE
 0

	)

41 
	#PC7_INPUT_ENABLE
 1

	)

42 
	#PULL_WAKEUP_SRC_PC7
 
PM_PIN_PULLUP_10K


	)

51 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

53 
	#PD5_FUNC
 
AS_PWM


	)

54 
	#PD5_OUTPUT_ENABLE
 1

	)

55 
	#PD5_INPUT_ENABLE
 0

	)

57 
	#PD6_FUNC
 
AS_PWM


	)

58 
	#PD6_OUTPUT_ENABLE
 1

	)

59 
	#PD6_INPUT_ENABLE
 0

	)

61 
	#PB4_FUNC
 
AS_PWM


	)

62 
	#PB4_OUTPUT_ENABLE
 1

	)

63 
	#PB4_INPUT_ENABLE
 0

	)

65 
	#PWM_R_CHANNEL_SET
(Ë
	`PWM0_CFG_GPIO_D5
()

	)

66 
	#PWM_R_CHANNEL
 0

67 

	)

68 
	#PWM_G_CHANNEL_SET
(Ë
	`PWM1_CFG_GPIO_D6
()

	)

69 
	#PWM_G_CHANNEL
 1

70 

	)

71 
	#PWM_B_CHANNEL_SET
(Ë
	`PWM4_CFG_GPIO_B4
()

	)

72 
	#PWM_B_CHANNEL
 4

73 

	)

74 
	#R_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

75 
	#G_LIGHT_PWM_CHANNEL
 
PWM_G_CHANNEL


	)

76 
	#B_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

77 
	#R_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

78 
	#G_LIGHT_PWM_SET
(Ë
	`PWM_G_CHANNEL_SET
()

	)

79 
	#B_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

81 
	#LED_W
 
GPIO_PD7


	)

83 
	#PD7_FUNC
 
AS_GPIO


	)

84 
	#PD7_OUTPUT_ENABLE
 1

	)

85 
	#PD7_INPUT_ENABLE
 0

	)

87 
	#LED_POWER
 
NULL


	)

88 
	#LED_PERMIT
 
LED_W


	)

93 
	#PB4_FUNC
 
AS_PWM


	)

94 
	#PB4_OUTPUT_ENABLE
 1

	)

95 
	#PB4_INPUT_ENABLE
 0

	)

97 
	#PD7_FUNC
 
AS_PWM


	)

98 
	#PD7_OUTPUT_ENABLE
 1

	)

99 
	#PD7_INPUT_ENABLE
 0

	)

101 
	#PWM_B_CHANNEL_SET
(Ë
	`PWM4_CFG_GPIO_B4
()

	)

102 
	#PWM_B_CHANNEL
 4

103 

	)

104 
	#PWM_W_CHANNEL_SET
(Ë
	`PWM2_CFG_GPIO_D7
()

	)

105 
	#PWM_W_CHANNEL
 2

106 

	)

107 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

108 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

109 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

110 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

112 
	#LED_R
 
GPIO_PD5


	)

113 
	#LED_G
 
GPIO_PD6


	)

115 
	#PD5_FUNC
 
AS_GPIO


	)

116 
	#PD5_OUTPUT_ENABLE
 1

	)

117 
	#PD5_INPUT_ENABLE
 0

	)

119 
	#PD6_FUNC
 
AS_GPIO


	)

120 
	#PD6_OUTPUT_ENABLE
 1

	)

121 
	#PD6_INPUT_ENABLE
 0

	)

123 
	#LED_POWER
 
LED_R


	)

124 
	#LED_PERMIT
 
LED_G


	)

129 #i‡
ZBHCI_UART


130 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

134 #i‡
UART_PRINTF_MODE


135 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC5


137 

	)

140 
VK_SW1
 = 0x01,

141 
VK_SW2
 = 0x02

144 
	#KB_MAP_NORMAL
 {\

	)

145 {
VK_SW1
,}, \

146 {
VK_SW2
,}, }

148 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

149 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

151 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

152 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

156 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_8278_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

36 
	#BUTTON1
 
GPIO_PD6


	)

37 
	#PD6_FUNC
 
AS_GPIO


	)

38 
	#PD6_OUTPUT_ENABLE
 0

	)

39 
	#PD6_INPUT_ENABLE
 1

	)

40 
	#PULL_WAKEUP_SRC_PD6
 
PM_PIN_PULLUP_10K


	)

42 
	#BUTTON2
 
GPIO_PD5


	)

43 
	#PD5_FUNC
 
AS_GPIO


	)

44 
	#PD5_OUTPUT_ENABLE
 0

	)

45 
	#PD5_INPUT_ENABLE
 1

	)

46 
	#PULL_WAKEUP_SRC_PD5
 
PM_PIN_PULLUP_10K


	)

56 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

58 
	#LED_R
 
GPIO_PA3


59 
	#LED_G
 
GPIO_PA2


60 
	#LED_B
 
GPIO_PB0


61 

	)

62 
	#PWM_R_CHANNEL
 1

63 
	#PWM_R_CHANNEL_SET
(Ëdo{ \

	)

64 
gpio_£t_func
(
LED_R
, 
AS_PWM1
); \

67 
	#PWM_G_CHANNEL
 0

68 
	#PWM_G_CHANNEL_SET
(Ëdo{ \

	)

69 
	`gpio_£t_func
(
LED_G
, 
AS_PWM0
); \

70 
	}

	$}whûe
(0)

72 
	#PWM_B_CHANNEL
 3

73 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

74 
	`gpio_£t_func
(
LED_B
, 
AS_PWM3
); \

75 
	}

	$}whûe
(0)

77 
	#R_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

78 
	#G_LIGHT_PWM_CHANNEL
 
PWM_G_CHANNEL


	)

79 
	#B_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

80 
	#R_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

81 
	#G_LIGHT_PWM_SET
(Ë
	`PWM_G_CHANNEL_SET
()

	)

82 
	#B_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

85 
	#LED_Y
 
GPIO_PA4


	)

86 
	#LED_W
 
GPIO_PB1


	)

88 
	#PA4_FUNC
 
AS_GPIO


	)

89 
	#PA4_OUTPUT_ENABLE
 1

	)

90 
	#PA4_INPUT_ENABLE
 0

	)

92 
	#PB1_FUNC
 
AS_GPIO


	)

93 
	#PB1_OUTPUT_ENABLE
 1

	)

94 
	#PB1_INPUT_ENABLE
 0

	)

96 
	#LED_POWER
 
LED_W


	)

97 
	#LED_PERMIT
 
LED_Y


	)

102 
	#LED_Y
 
GPIO_PA4


103 
	#LED_W
 
GPIO_PB1


104 

	)

105 
	#PWM_Y_CHANNEL
 2

106 
	#PWM_Y_CHANNEL_SET
(Ëdo{ \

	)

107 
	`gpio_£t_func
(
LED_Y
, 
AS_PWM2
); \

108 
	}

	$}whûe
(0)

110 
	#PWM_W_CHANNEL
 4

111 
	#PWM_W_CHANNEL_SET
(Ëdo{ \

	)

112 
	`gpio_£t_func
(
LED_W
, 
AS_PWM4
); \

113 
	}

	$}whûe
(0)

115 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_Y_CHANNEL


	)

116 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

117 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_Y_CHANNEL_SET
()

	)

118 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

121 
	#LED_R
 
GPIO_PA3


	)

122 
	#LED_G
 
GPIO_PA2


	)

124 
	#PA3_FUNC
 
AS_GPIO


	)

125 
	#PA3_OUTPUT_ENABLE
 1

	)

126 
	#PA3_INPUT_ENABLE
 0

	)

128 
	#PA2_FUNC
 
AS_GPIO


	)

129 
	#PA2_OUTPUT_ENABLE
 1

	)

130 
	#PA2_INPUT_ENABLE
 0

	)

132 
	#LED_POWER
 
LED_R


	)

133 
	#LED_PERMIT
 
LED_G


	)

138 #i‡
ZBHCI_UART


139 
	#UART_TX_PIN
 
UART_TX_PD7


	)

140 
	#UART_RX_PIN
 
UART_RX_PA0


	)

142 
	#UART_PIN_CFG
(Ë
	`u¨t_gpio_£t
(
UART_TX_PIN
, 
UART_RX_PIN
);

144 

	)

146 #i‡
UART_PRINTF_MODE


147 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC6


149 

	)

152 
VK_SW1
 = 0x01,

153 
VK_SW2
 = 0x02

156 
	#KB_MAP_NORMAL
 {\

	)

157 {
VK_SW1
,}, \

158 {
VK_SW2
,}, }

160 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

161 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

163 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

164 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

168 #i‡
	`deföed
(
__˝lu•lus
)

169 
	}
}

	@apps/sampleLight/board_8278_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PB2


	)

34 
	#PB2_FUNC
 
AS_GPIO


	)

35 
	#PB2_OUTPUT_ENABLE
 0

	)

36 
	#PB2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PB2
 
PM_PIN_PULLUP_10K


	)

39 
	#BUTTON2
 
GPIO_PB3


	)

40 
	#PB3_FUNC
 
AS_GPIO


	)

41 
	#PB3_OUTPUT_ENABLE
 0

	)

42 
	#PB3_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PB3
 
PM_PIN_PULLUP_10K


	)

52 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

59 
	#LED_B
 
GPIO_PD2


60 
	#LED_W
 
GPIO_PD4


61 

	)

62 
	#PWM_W_CHANNEL
 2

63 
	#PWM_W_CHANNEL_SET
(Ëdo{ \

	)

64 
gpio_£t_func
(
LED_W
, 
AS_PWM2_N
); \

65 
drv_pwm_n_övît
(
PWM_W_CHANNEL
); \

68 
	#PWM_B_CHANNEL
 3

69 
	#PWM_B_CHANNEL_SET
(Ëdo{ \

	)

70 
gpio_£t_func
(
LED_B
, 
AS_PWM3
); \

73 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

74 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_W_CHANNEL


	)

75 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

76 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_W_CHANNEL_SET
()

	)

79 
	#LED_R
 
GPIO_PD5


	)

80 
	#LED_G
 
GPIO_PD3


	)

82 
	#PD3_FUNC
 
AS_GPIO


	)

83 
	#PD3_OUTPUT_ENABLE
 1

	)

84 
	#PD3_INPUT_ENABLE
 0

	)

86 
	#PD5_FUNC
 
AS_GPIO


	)

87 
	#PD5_OUTPUT_ENABLE
 1

	)

88 
	#PD5_INPUT_ENABLE
 0

	)

90 
	#LED_POWER
 
LED_R


	)

91 
	#LED_PERMIT
 
LED_G


	)

96 #i‡
ZBHCI_UART


97 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

101 #i‡
UART_PRINTF_MODE


102 
	#DEBUG_INFO_TX_PIN
 
GPIO_PA2


104 

	)

107 
VK_SW1
 = 0x01,

108 
VK_SW2
 = 0x02

111 
	#KB_MAP_NORMAL
 {\

	)

112 {
VK_SW1
,}, \

113 {
VK_SW2
,}, }

115 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

116 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

118 
	#KB_DRIVE_PINS
 {
NULL
 }

	)

119 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

122 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_9518_dongle.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PB2


34 
	#PB2_FUNC
 
AS_GPIO


	)

35 
	#PB2_OUTPUT_ENABLE
 0

	)

36 
	#PB2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PB2
 
GPIO_PIN_PULLUP_10K


	)

39 
	#BUTTON2
 
GPIO_PB3


40 
	#PB3_FUNC
 
AS_GPIO


	)

41 
	#PB3_OUTPUT_ENABLE
 0

	)

42 
	#PB3_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PB3
 
GPIO_PIN_PULLUP_10K


	)

55 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

59 
	#LED_R
 
GPIO_PB4


	)

60 
	#LED_B
 
GPIO_PB7


	)

62 
	#PWM_R_CHANNEL
 0

63 
	#PWM_R_CHANNEL_SET
(Ëdo{\

	)

64 
pwm_£t_pö
(
LED_R
); \

67 
	#PWM_B_CHANNEL
 2

68 
	#PWM_B_CHANNEL_SET
(Ëdo{\

	)

69 
pwm_£t_pö
(
LED_B
); \

72 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

73 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

74 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

75 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

78 
	#LED_Y
 
GPIO_PB5


	)

79 
	#LED_G
 
GPIO_PB0


	)

80 
	#LED_B2
 
GPIO_PB1


	)

81 
	#LED_B3
 
GPIO_PE3


	)

83 
	#PB5_FUNC
 
AS_GPIO


	)

84 
	#PB5_OUTPUT_ENABLE
 1

	)

85 
	#PB5_INPUT_ENABLE
 0

	)

87 
	#PB0_FUNC
 
AS_GPIO


	)

88 
	#PB0_OUTPUT_ENABLE
 1

	)

89 
	#PB0_INPUT_ENABLE
 0

	)

91 
	#PB1_FUNC
 
AS_GPIO


	)

92 
	#PB1_OUTPUT_ENABLE
 1

	)

93 
	#PB1_INPUT_ENABLE
 0

	)

95 
	#PE3_FUNC
 
AS_GPIO


	)

96 
	#PE3_OUTPUT_ENABLE
 1

	)

97 
	#PE3_INPUT_ENABLE
 0

	)

99 
	#LED_POWER
 
LED_Y


	)

100 
	#LED_PERMIT
 
LED_G


	)

104 #i‡
ZBHCI_UART


105 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

109 #i‡
UART_PRINTF_MODE


110 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC1


112 

	)

115 
VK_SW1
 = 0x01,

116 
VK_SW2
 = 0x02,

119 
	#KB_MAP_NORMAL
 {\

	)

120 {
VK_SW1
,}, \

121 {
VK_SW2
,}, }

123 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

124 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

126 
	#KB_DRIVE_PINS
 {
NULL
}

	)

127 
	#KB_SCAN_PINS
 {
BUTTON1
, 
BUTTON2
}

	)

132 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/board_9518_evk.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

33 
	#BUTTON1
 
GPIO_PC2


	)

34 
	#PC2_FUNC
 
AS_GPIO


	)

35 
	#PC2_OUTPUT_ENABLE
 0

	)

36 
	#PC2_INPUT_ENABLE
 1

	)

37 
	#PULL_WAKEUP_SRC_PC2
 
GPIO_PIN_PULLDOWN_100K


	)

39 
	#BUTTON2
 
GPIO_PC0


	)

40 
	#PC0_FUNC
 
AS_GPIO


	)

41 
	#PC0_OUTPUT_ENABLE
 0

	)

42 
	#PC0_INPUT_ENABLE
 1

	)

43 
	#PULL_WAKEUP_SRC_PC0
 
GPIO_PIN_PULLDOWN_100K


	)

45 
	#BUTTON3
 
GPIO_PC3


	)

46 
	#PC3_FUNC
 
AS_GPIO


	)

47 
	#PC3_OUTPUT_ENABLE
 0

	)

48 
	#PC3_INPUT_ENABLE
 1

	)

49 
	#PULL_WAKEUP_SRC_PC3
 
GPIO_PIN_PULLUP_10K


	)

51 
	#BUTTON4
 
GPIO_PC1


	)

52 
	#PC1_FUNC
 
AS_GPIO


	)

53 
	#PC1_OUTPUT_ENABLE
 0

	)

54 
	#PC1_INPUT_ENABLE
 1

	)

55 
	#PULL_WAKEUP_SRC_PC1
 
GPIO_PIN_PULLUP_10K


	)

64 #i‡
deföed
 
COLOR_RGB_SUPPORT
 && (COLOR_RGB_SUPPORT == 1)

68 
	#LED_R
 
GPIO_PB7


	)

69 
	#LED_B
 
GPIO_PB4


	)

71 
	#PWM_R_CHANNEL
 2

72 
	#PWM_R_CHANNEL_SET
(Ëdo{\

	)

73 
pwm_£t_pö
(
LED_R
); \

76 
	#PWM_B_CHANNEL
 0

77 
	#PWM_B_CHANNEL_SET
(Ëdo{\

	)

78 
pwm_£t_pö
(
LED_B
); \

81 
	#WARM_LIGHT_PWM_CHANNEL
 
PWM_R_CHANNEL


	)

82 
	#COOL_LIGHT_PWM_CHANNEL
 
PWM_B_CHANNEL


	)

83 
	#WARM_LIGHT_PWM_SET
(Ë
	`PWM_R_CHANNEL_SET
()

	)

84 
	#COOL_LIGHT_PWM_SET
(Ë
	`PWM_B_CHANNEL_SET
()

	)

87 
	#LED_W
 
GPIO_PB6


	)

88 
	#LED_G
 
GPIO_PB5


	)

90 
	#PB6_FUNC
 
AS_GPIO


	)

91 
	#PB6_OUTPUT_ENABLE
 1

	)

92 
	#PB6_INPUT_ENABLE
 0

	)

94 
	#PB5_FUNC
 
AS_GPIO


	)

95 
	#PB5_OUTPUT_ENABLE
 1

	)

96 
	#PB5_INPUT_ENABLE
 0

	)

98 
	#LED_POWER
 
LED_W


	)

99 
	#LED_PERMIT
 
LED_G


	)

103 #i‡
ZBHCI_UART


104 #îr‹ 
∂ó£
 
c⁄figuøã
 
u¨t
 
PIN
!!!!!!

108 #i‡
UART_PRINTF_MODE


109 
	#DEBUG_INFO_TX_PIN
 
GPIO_PC7


111 

	)

114 
VK_SW1
 = 0x01,

115 
VK_SW2
 = 0x02,

116 
VK_SW3
 = 0x03,

117 
VK_SW4
 = 0x04

120 
	#KB_MAP_NORMAL
 {\

	)

121 {
VK_SW1
, 
VK_SW3
}, \

122 {
VK_SW2
, 
VK_SW4
}, }

124 
	#KB_MAP_NUM
 
KB_MAP_NORMAL


	)

125 
	#KB_MAP_FN
 
KB_MAP_NORMAL


	)

127 
	#KB_DRIVE_PINS
 {
GPIO_PC2
, 
GPIO_PC0
}

	)

128 
	#KB_SCAN_PINS
 {
GPIO_PC3
, 
GPIO_PC1
}

	)

130 
	#KB_LINE_MODE
 0

	)

131 
	#KB_LINE_HIGH_VALID
 0

	)

134 #i‡
deföed
(
__˝lu•lus
)

	@apps/sampleLight/sampleLight.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"bdb.h
"

33 
	~"Ÿa.h
"

34 
	~"gp.h
"

35 
	~"ßm∂eLight.h
"

36 
	~"ßm∂eLightCål.h
"

37 
	~"≠p_ui.h
"

38 
	~"Á˘‹y_ª£t.h
"

39 #i‡
ZBHCI_EN


40 
	~"zbhci.h
"

42 #i‡
ZCL_WWAH_SUPPORT


43 
	~"wwah.h
"

59 
≠p_˘x_t
 
	ggLightCtx
;

62 #ifde‡
ZCL_OTA


63 
Ÿa_ˇŒBack_t
 
ßm∂eLight_ŸaCb
;

66 
Ÿa_¥ómbÀ_t
 
	gßm∂eLight_ŸaInfo
 = {

67 .
fûeVî
 = 
FILE_VERSION
,

68 .
	gimageTy≥
 = 
IMAGE_TYPE
,

69 .
	gm™uÁ˘uªrCode
 = 
MANUFACTURER_CODE_TELINK
,

75 c⁄° 
zdo_≠pIndCb_t
 
	g≠pCbL°
 = {

76 
bdb_zdoSèπDevCnf
,

77 
NULL
,

78 
NULL
,

79 
ßm∂eLight_ÀaveIndH™dÀr
,

80 
ßm∂eLight_ÀaveCnfH™dÀr
,

81 
ßm∂eLight_nwkUpd©eIndiˇãH™dÀr
,

82 
NULL
,

83 
NULL
,

84 
NULL
,

85 
NULL
,

92 
bdb_commissi⁄Sëtög_t
 
	gg_bdbCommissi⁄Sëtög
 = {

93 .
lökKey
.
tcLökKey
.
keyTy≥
 = 
SS_GLOBAL_LINK_KEY
,

94 .
	glökKey
.
	gtcLökKey
.
	gkey
 = (
u8
 *)
tcLökKeyCíåÆDeÁu…
,

96 .
	glökKey
.
	gdi°ribuãLökKey
.
	gkeyTy≥
 = 
MASTER_KEY
,

97 .
	glökKey
.
	gdi°ribuãLökKey
.
	gkey
 = (
u8
 *)
lökKeyDi°ribuãdMa°î
,

99 .
	glökKey
.
	gtouchLökKey
.
	gkeyTy≥
 = 
MASTER_KEY
,

100 .
	glökKey
.
	gtouchLökKey
.
	gkey
 = (
u8
 *)
touchLökKeyMa°î
,

102 #i‡
TOUCHLINK_SUPPORT


103 .
	gtouchlökE«bÀ
 = 1,

105 .
	gtouchlökE«bÀ
 = 0,

107 .
	gtouchlökCh™√l
 = 
DEFAULT_CHANNEL
,

108 .
	gtouchlökLqiThªshﬁd
 = 0xA0,

114 
ev_timî_evít_t
 *
	gßm∂eLightAârsSt‹eTimîEvt
 = 
NULL
;

131 
	$°ack_öô
()

134 
	`zb_öô
();

137 
	`zb_zdoCbRegi°î
((
zdo_≠pIndCb_t
 *)&
≠pCbL°
);

138 
	}
}

149 
	$u£r_≠p_öô
()

151 
	`af_nodeDescM™uCodeUpd©e
(
MANUFACTURER_CODE_TELINK
);

155 
	`z˛_öô
(
ßm∂eLight_z˛Pro˚ssIncomögMsg
);

158 
	`af_ídpoötRegi°î
(
SAMPLE_LIGHT_ENDPOINT
, (
af_sim∂e_des¸ùt‹_t
 *)&
ßm∂eLight_sim∂eDesc
, 
z˛_rx_h™dÀr
, 
NULL
);

159 #i‡
AF_TEST_ENABLE


161 
	`af_ídpoötRegi°î
(
SAMPLE_TEST_ENDPOINT
, (
af_sim∂e_des¸ùt‹_t
 *)&
ßm∂eTe°Desc
, 
afTe°_rx_h™dÀr
, 
afTe°_d©aSídC⁄fúm
);

165 
	`z˛_ßm∂eLightAârsInô
();

166 
	`z˛_ªp‹tögTabInô
();

169 
	`z˛_ªgi°î
(
SAMPLE_LIGHT_ENDPOINT
, 
SAMPLELIGHT_CB_CLUSTER_NUM
, (
z˛_•ecClu°îInfo_t
 *)
g_ßm∂eLightClu°îLi°
);

171 #ifde‡
ZCL_GREEN_POWER


173 
	`gp_öô
();

176 #ifde‡
ZCL_OTA


178 
	`Ÿa_öô
(
OTA_TYPE_CLIENT
, (
af_sim∂e_des¸ùt‹_t
 *)&
ßm∂eLight_sim∂eDesc
, &
ßm∂eLight_ŸaInfo
, &
ßm∂eLight_ŸaCb
);

181 #ifde‡
ZCL_WWAH


183 
	`wwah_öô
(
WWAH_TYPE_SERVER
, (
af_sim∂e_des¸ùt‹_t
 *)&
ßm∂eLight_sim∂eDesc
);

185 
	}
}

189 
s32
 
	$ßm∂eLightAârsSt‹eTimîCb
(*
¨g
)

191 
	`z˛_⁄OffAâr_ßve
();

192 
	`z˛_ÀvñAâr_ßve
();

193 
	`z˛_cﬁ‹CålAâr_ßve
();

195 
ßm∂eLightAârsSt‹eTimîEvt
 = 
NULL
;

197 
	}
}

199 
	$ßm∂eLightAârsSt‹eTimîSèπ
()

201 if(
ßm∂eLightAârsSt‹eTimîEvt
){

202 
	`TL_ZB_TIMER_CANCEL
(&
ßm∂eLightAârsSt‹eTimîEvt
);

204 
ßm∂eLightAârsSt‹eTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLightAârsSt‹eTimîCb
, 
NULL
, 200);

205 
	}
}

207 
	$ßm∂eLightAârsChk
()

209 if(
gLightCtx
.
lightAârsCh™ged
){

210 
gLightCtx
.
lightAârsCh™ged
 = 
FALSE
;

211 if(
	`zb_isDevi˚JoöedNwk
()){

212 
	`ßm∂eLightAârsSt‹eTimîSèπ
();

215 
	}
}

217 
	$ªp‹t_h™dÀr
()

219 if(
	`zb_isDevi˚JoöedNwk
()){

220 if(
	`z˛_ªp‹tögE¡ryA˘iveNumGë
()){

221 
u16
 
£c⁄d
 = 1;

223 
	`ªp‹tNoMöLimô
();

226 
	`ªp‹tAârTimîSèπ
(
£c⁄d
);

229 
	`ªp‹tAârTimîSt›
();

232 
	}
}

234 
	$≠p_èsk
()

236 
	`≠p_key_h™dÀr
();

237 
	`loˇlPîmôJoöSèã
();

238 if(
	`BDB_STATE_GET
(Ë=
BDB_STATE_IDLE
){

241 
	`ªp‹t_h™dÀr
();

244 
	`ßm∂eLightAârsChk
();

247 
	}
}

249 
	$ßm∂eLightSysEx˚±i⁄
()

251 
	`z˛_⁄OffAâr_ßve
();

252 
	`z˛_ÀvñAâr_ßve
();

253 
	`z˛_cﬁ‹CålAâr_ßve
();

255 
	`SYSTEM_RESET
();

258 
	}
}

269 
	$u£r_öô
(
boﬁ
 
isRëíti⁄
)

271 ()
isRëíti⁄
;

274 
	`Àd_öô
();

275 
	`hwLight_öô
();

280 
	`°ack_öô
();

283 
	`u£r_≠p_öô
();

286 
	`sys_ex˚±H™dÀrRegi°î
(
ßm∂eLightSysEx˚±i⁄
);

289 
	`light_adju°
();

292 #i‡
ZBHCI_EN


293 
	`zbhciInô
();

294 
	`ev_⁄_pﬁl
(
EV_POLL_HCI
, 
zbhciTask
);

296 
	`ev_⁄_pﬁl
(
EV_POLL_IDLE
, 
≠p_èsk
);

299 if(
	`bdb_¥eIn°ÆlCodeLﬂd
(&
gLightCtx
.
tcLökKey
.
keyTy≥
, gLightCtx.tcLökKey.
key
Ë=
RET_OK
){

300 
g_bdbCommissi⁄Sëtög
.
lökKey
.
tcLökKey
.
keyTy≥
 = 
gLightCtx
.tcLinkKey.keyType;

301 
g_bdbCommissi⁄Sëtög
.
lökKey
.
tcLökKey
.
key
 = 
gLightCtx
.tcLinkKey.key;

305 
u8
 
ªp‹èbÀCh™ge
 = 0x00;

306 
	`bdb_deÁu…Rï‹tögCfg
(
SAMPLE_LIGHT_ENDPOINT
, 
HA_PROFILE_ID
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_ATTRID_ONOFF
,

307 0x0000, 0x003c, (
u8
 *)&
ªp‹èbÀCh™ge
);

310 
	`bdb_öô
((
af_sim∂e_des¸ùt‹_t
 *)&
ßm∂eLight_sim∂eDesc
, &
g_bdbCommissi⁄Sëtög
, &
g_zbDemoBdbCb
, 1);

311 
	`¥ötf
("init success start MCU\r\n");

312 
	}
}

	@apps/sampleLight/sampleLight.h

24 #i‚de‡
_SAMPLE_LIGHT_H_


25 
	#_SAMPLE_LIGHT_H_


	)

32 
	#SAMPLE_LIGHT_ENDPOINT
 0x01

	)

33 
	#SAMPLE_TEST_ENDPOINT
 0x02

	)

39 
u8
 
	mkeyTy≥
;

41 
u8
 
	mkey
[16];

42 }
	t≠p_lökKey_öfo_t
;

45 
ev_timî_evít_t
 *
	mtimîLedEvt
;

46 
u32
 
	mkeyPªs£dTime
;

48 
u16
 
	mÀdOnTime
;

49 
u16
 
	mÀdOffTime
;

50 
u8
 
	m‹iSè
;

51 
u8
 
	m°a
;

52 
u8
 
	mtimes
;

53 
u8
 
	m°©e
;

55 
boﬁ
 
	mbdbFödBödFlg
;

56 
boﬁ
 
	mlightAârsCh™ged
;

58 
≠p_lökKey_öfo_t
 
	mtcLökKey
;

59 }
	t≠p_˘x_t
;

65 
u8
 
	mz˛Vîsi⁄
;

66 
u8
 
	m≠pVîsi⁄
;

67 
u8
 
	m°ackVîsi⁄
;

68 
u8
 
	mhwVîsi⁄
;

69 
u8
 
	mm™uName
[
ZCL_BASIC_MAX_LENGTH
];

70 
u8
 
	mmodñId
[
ZCL_BASIC_MAX_LENGTH
];

71 
u8
 
	mswBuûdId
[
ZCL_BASIC_MAX_LENGTH
];

72 
u8
 
	mpowîSour˚
;

73 
u8
 
	mdevi˚E«bÀ
;

74 }
	tz˛_basicAâr_t
;

80 
u16
 
	midítifyTime
;

81 }
	tz˛_idítifyAâr_t
;

87 
u8
 
	m«meSuµ‹t
;

88 }
	tz˛_groupAâr_t
;

94 
u8
 
	ms˚√Cou¡
;

95 
u8
 
	mcuºítS˚√
;

96 
u8
 
	m«meSuµ‹t
;

97 
boﬁ
 
	ms˚√VÆid
;

98 
u16
 
	mcuºítGroup
;

99 }
	tz˛_s˚√Aâr_t
;

105 
u16
 
	m⁄Time
;

106 
u16
 
	moffWaôTime
;

107 
u8
 
	m°¨tUpOnOff
;

108 
boﬁ
 
	m⁄Off
;

109 
boﬁ
 
	mglobÆS˚√C⁄åﬁ
;

110 }
	tz˛_⁄OffAâr_t
;

116 
u16
 
	mªmaöögTime
;

117 
u8
 
	mcurLevñ
;

118 
u8
 
	m°¨tUpCuºítLevñ
;

119 }
	tz˛_ÀvñAâr_t
;

125 
u8
 
	mcﬁ‹Mode
;

126 
u8
 
	m›ti⁄s
;

127 
u8
 
	míh™˚dCﬁ‹Mode
;

128 
u8
 
	mnumOfPrim¨õs
;

129 
u16
 
	mcﬁ‹C≠abûôõs
;

130 #i‡
COLOR_RGB_SUPPORT


131 
u8
 
	mcuºítHue
;

132 
u8
 
	mcuºítS©uøti⁄
;

133 
u8
 
	mcﬁ‹Lo›A˘ive
;

134 
u8
 
	mcﬁ‹Lo›Dúe˘i⁄
;

135 
u16
 
	mcﬁ‹Lo›Time
;

136 
u16
 
	mcﬁ‹Lo›SèπEnh™˚dHue
;

137 
u16
 
	mcﬁ‹Lo›St‹edEnh™˚dHue
;

138 #ñi‡
COLOR_CCT_SUPPORT


139 
u16
 
	mcﬁ‹Tem≥øtuªMúeds
;

140 
u16
 
	mcﬁ‹TempPhysiˇlMöMúeds
;

141 
u16
 
	mcﬁ‹TempPhysiˇlMaxMúeds
;

142 
u16
 
	m°¨tUpCﬁ‹Tem≥øtuªMúeds
;

144 }
	tz˛_lightCﬁ‹CålAâr_t
;

150 
u8
 
	m⁄Off
;

151 
u8
 
	m°¨tUpOnOff
;

152 }
	tz˛_nv_⁄Off_t
;

158 
u8
 
	mcurLevñ
;

159 
u8
 
	m°¨tUpCurLevñ
;

160 }
	tz˛_nv_Àvñ_t
;

166 #i‡
COLOR_RGB_SUPPORT


167 
u8
 
	mcuºítHue
;

168 
u8
 
	mcuºítS©uøti⁄
;

169 #ñi‡
COLOR_CCT_SUPPORT


170 
u16
 
	mcﬁ‹Tem≥øtuªMúeds
;

171 
u16
 
	m°¨tUpCﬁ‹Tem≥øtuªMúeds
;

173 }
	tz˛_nv_cﬁ‹Cål_t
;

178 
≠p_˘x_t
 
gLightCtx
;

179 
bdb_commissi⁄Sëtög_t
 
g_bdbCommissi⁄Sëtög
;

180 
bdb_≠pCb_t
 
g_zbDemoBdbCb
;

183 
u8
 
SAMPLELIGHT_CB_CLUSTER_NUM
;

184 c⁄° 
z˛_•ecClu°îInfo_t
 
g_ßm∂eLightClu°îLi°
[];

185 c⁄° 
af_sim∂e_des¸ùt‹_t
 
ßm∂eLight_sim∂eDesc
;

186 #i‡
AF_TEST_ENABLE


187 c⁄° 
af_sim∂e_des¸ùt‹_t
 
ßm∂eTe°Desc
;

191 
z˛_basicAâr_t
 
g_z˛_basicAârs
;

192 
z˛_idítifyAâr_t
 
g_z˛_idítifyAârs
;

193 
z˛_groupAâr_t
 
g_z˛_groupAârs
;

194 
z˛_s˚√Aâr_t
 
g_z˛_s˚√Aârs
;

195 
z˛_⁄OffAâr_t
 
g_z˛_⁄OffAârs
;

196 
z˛_ÀvñAâr_t
 
g_z˛_ÀvñAârs
;

197 
z˛_lightCﬁ‹CålAâr_t
 
g_z˛_cﬁ‹CålAârs
;

199 
	#z˛_s˚√AârGë
(Ë&
g_z˛_s˚√Aârs


	)

200 
	#z˛_⁄offAârGë
(Ë&
g_z˛_⁄OffAârs


	)

201 
	#z˛_ÀvñAârGë
(Ë&
g_z˛_ÀvñAârs


	)

202 
	#z˛_cﬁ‹AârGë
(Ë&
g_z˛_cﬁ‹CålAârs


	)

207 
ßm∂eLight_z˛Pro˚ssIncomögMsg
(
z˛Incomög_t
 *
pInHdÃMsg
);

209 
°©us_t
 
ßm∂eLight_basicCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

210 
°©us_t
 
ßm∂eLight_idítifyCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

211 
°©us_t
 
ßm∂eLight_s˚√Cb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

212 
°©us_t
 
ßm∂eLight_⁄OffCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

213 
°©us_t
 
ßm∂eLight_ÀvñCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

214 
°©us_t
 
ßm∂eLight_cﬁ‹CålCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

216 
ßm∂eLight_ÀaveCnfH™dÀr
(
∆me_Àave_˙f_t
 *
pLóveCnf
);

217 
ßm∂eLight_ÀaveIndH™dÀr
(
∆me_Àave_öd_t
 *
pLóveInd
);

218 
ßm∂eLight_ŸaPro˚ssMsgH™dÀr
(
u8
 
evt
, u8 
°©us
);

219 
u8
 
ßm∂eLight_nwkUpd©eIndiˇãH™dÀr
(
nwkCmd_nwkUpd©e_t
 *
pNwkUpd©e
);

221 
ßm∂eLight_⁄off
(
u8
 
cmd
);

223 
z˛_ßm∂eLightAârsInô
();

224 
nv_°s_t
 
z˛_⁄OffAâr_ßve
();

225 
nv_°s_t
 
z˛_ÀvñAâr_ßve
();

226 
nv_°s_t
 
z˛_cﬁ‹CålAâr_ßve
();

228 #i‡
AF_TEST_ENABLE


229 
afTe°_rx_h™dÀr
(*
¨g
);

230 
afTe°_d©aSídC⁄fúm
(*
¨g
);

	@apps/sampleLight/sampleLightCtrl.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"z˛_ö˛ude.h
"

31 
	~"ßm∂eLight.h
"

32 
	~"ßm∂eLightCål.h
"

38 
	#PWM_FREQUENCY
 1000

39 
	#PWM_FULL_DUTYCYCLE
 100

	)

40 
	#PMW_MAX_TICK
 (
PWM_CLOCK_SOURCE
 / 
PWM_FREQUENCY
)

	)

56 
ßm∂eLight_upd©eOnOff
();

57 
ßm∂eLight_upd©eLevñ
();

58 
ßm∂eLight_upd©eCﬁ‹
();

60 
ßm∂eLight_⁄OffInô
();

61 
ßm∂eLight_ÀvñInô
();

62 
ßm∂eLight_cﬁ‹Inô
();

74 
	$pwmSëDuty
(
u8
 
ch
, 
u16
 
dutycy˛e
)

76 #ifde‡
ZCL_LEVEL_CTRL


77 
u32
 
cmp_tick
 = ((u32)
dutycy˛e
 * 
PMW_MAX_TICK
Ë/ (
ZCL_LEVEL_ATTR_MAX_LEVEL
 * 
PWM_FULL_DUTYCYCLE
);

78 
	`¥ötf
("[%s:%d] cmp_tick:%d,PMW_MAX_TICK:%d\r\n", 
__FUNCTION__
, 
__LINE__
, 
cmp_tick
,
PMW_MAX_TICK
);

79 
	`drv_pwm_cfg
(
ch
, (
u16
)
cmp_tick
, 
PMW_MAX_TICK
);

81 
	}
}

93 
	$pwmInô
(
u8
 
ch
, 
u16
 
dutycy˛e
)

95 
	`pwmSëDuty
(
ch
, 
dutycy˛e
);

96 
	}
}

107 
	$hwLight_öô
()

109 
	`drv_pwm_öô
();

111 #i‡
COLOR_RGB_SUPPORT


112 
	`R_LIGHT_PWM_SET
();

113 
	`G_LIGHT_PWM_SET
();

114 
	`B_LIGHT_PWM_SET
();

115 
	`pwmInô
(
R_LIGHT_PWM_CHANNEL
, 0);

116 
	`pwmInô
(
G_LIGHT_PWM_CHANNEL
, 0);

117 
	`pwmInô
(
B_LIGHT_PWM_CHANNEL
, 0);

119 
	`COOL_LIGHT_PWM_SET
();

120 
	`pwmInô
(
COOL_LIGHT_PWM_CHANNEL
, 0);

121 #i‡
COLOR_CCT_SUPPORT


122 
	`WARM_LIGHT_PWM_SET
();

123 
	`pwmInô
(
WARM_LIGHT_PWM_CHANNEL
, 0);

126 
	}
}

137 
	$hwLight_⁄OffUpd©e
(
u8
 
⁄Off
)

139 if(
⁄Off
){

140 #i‡
COLOR_RGB_SUPPORT


141 
	`drv_pwm_°¨t
(
R_LIGHT_PWM_CHANNEL
);

142 
	`drv_pwm_°¨t
(
G_LIGHT_PWM_CHANNEL
);

143 
	`drv_pwm_°¨t
(
B_LIGHT_PWM_CHANNEL
);

145 #i‡
COLOR_CCT_SUPPORT


146 
	`drv_pwm_°¨t
(
WARM_LIGHT_PWM_CHANNEL
);

148 
	`drv_pwm_°¨t
(
COOL_LIGHT_PWM_CHANNEL
);

151 #i‡
COLOR_RGB_SUPPORT


152 
	`drv_pwm_°›
(
R_LIGHT_PWM_CHANNEL
);

153 
	`drv_pwm_°›
(
G_LIGHT_PWM_CHANNEL
);

154 
	`drv_pwm_°›
(
B_LIGHT_PWM_CHANNEL
);

156 #i‡
COLOR_CCT_SUPPORT


157 
	`drv_pwm_°›
(
WARM_LIGHT_PWM_CHANNEL
);

159 
	`drv_pwm_°›
(
COOL_LIGHT_PWM_CHANNEL
);

162 
	}
}

173 
	$hwLight_ÀvñUpd©e
(
u8
 
Àvñ
)

175 #i‡!
deföed
 
COLOR_RGB_SUPPORT
 || (COLOR_RGB_SUPPORT == 0)

176 
Àvñ
 = (level < 0x10) ? 0x10 :Üevel;

178 
u16
 
gammaC‹ª˘Levñ
 = ((u16)
Àvñ
 *ÜevñË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

180 
	`pwmSëDuty
(
COOL_LIGHT_PWM_CHANNEL
, 
gammaC‹ª˘Levñ
 * 
PWM_FULL_DUTYCYCLE
);

182 
	}
}

196 
	$ãm≥øtuªToCW
(
u16
 
ãm≥øtuªMúeds
, 
u8
 
Àvñ
, u8 *
C
, u8 *
W
)

198 #i‡
COLOR_CCT_SUPPORT


199 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

201 *
W
 = (
u8
)(((
ãm≥øtuªMúeds
 - 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
Ë* 
Àvñ
Ë/ (pCﬁ‹->
cﬁ‹TempPhysiˇlMaxMúeds
 -ÖColor->colorTempPhysicalMinMireds));

202 *
C
 = 
Àvñ
 - (*
W
);

204 
	}
}

216 
	$hwLight_cﬁ‹Upd©e_cﬁ‹Tem≥øtuª
(
u16
 
cﬁ‹Tem≥øtuªMúeds
, 
u8
 
Àvñ
)

218 #i‡
COLOR_CCT_SUPPORT


219 
u8
 
C
 = 0;

220 
u8
 
W
 = 0;

222 
Àvñ
 = (level < 0x10) ? 0x10 :Üevel;

224 
	`ãm≥øtuªToCW
(
cﬁ‹Tem≥øtuªMúeds
, 
Àvñ
, &
C
, &
W
);

226 
u16
 
gammaC‹ª˘C
 = ((u16)
C
 * CË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

227 
u16
 
gammaC‹ª˘W
 = ((u16)
W
 * WË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

229 
	`pwmSëDuty
(
COOL_LIGHT_PWM_CHANNEL
, 
gammaC‹ª˘C
 * 
PWM_FULL_DUTYCYCLE
);

230 
	`pwmSëDuty
(
WARM_LIGHT_PWM_CHANNEL
, 
gammaC‹ª˘W
 * 
PWM_FULL_DUTYCYCLE
);

232 
	}
}

248 
	$hsvToRGB
(
u8
 
hue
, u8 
ßtuøti⁄
, u8 
Àvñ
, u8 *
R
, u8 *
G
, u8 *
B
)

250 #i‡
COLOR_RGB_SUPPORT


251 
u8
 
ªgi⁄
;

252 
u8
 
ªmaödî
;

253 
u8
 
p
, 
q
, 
t
;

255 
u16
 
rHue
 = (u16)
hue
 * 360 / 
ZCL_COLOR_ATTR_HUE_MAX
;

256 
u8
 
rS
 = 
ßtuøti⁄
;

257 
u8
 
rV
 = 
Àvñ
;

259 if(
ßtuøti⁄
 == 0){

260 *
R
 = 
rV
;

261 *
G
 = 
rV
;

262 *
B
 = 
rV
;

266 if(
rHue
 < 360){

267 
ªgi⁄
 = 
rHue
 / 60;

269 
ªgi⁄
 = 0;

272 
ªmaödî
 = (
rHue
 - (
ªgi⁄
 * 60)) * 4;

274 
p
 = (
rV
 * (255 - 
rS
)) >> 8;

275 
q
 = (
rV
 * (255 - ((
rS
 * 
ªmaödî
) >> 8))) >> 8;

276 
t
 = (
rV
 * (255 - ((
rS
 * (255 - 
ªmaödî
)) >> 8))) >> 8;

278 i‡(
ªgi⁄
 == 0) {

279 *
R
 = 
rV
;

280 *
G
 = 
t
;

281 *
B
 = 
p
;

282 } i‡(
ªgi⁄
 == 1) {

283 *
R
 = 
q
;

284 *
G
 = 
rV
;

285 *
B
 = 
p
;

286 } i‡(
ªgi⁄
 == 2) {

287 *
R
 = 
p
;

288 *
G
 = 
rV
;

289 *
B
 = 
t
;

290 } i‡(
ªgi⁄
 == 3) {

291 *
R
 = 
p
;

292 *
G
 = 
q
;

293 *
B
 = 
rV
;

294 } i‡(
ªgi⁄
 == 4) {

295 *
R
 = 
t
;

296 *
G
 = 
p
;

297 *
B
 = 
rV
;

299 *
R
 = 
rV
;

300 *
G
 = 
p
;

301 *
B
 = 
q
;

304 
	}
}

317 
	$hwLight_cﬁ‹Upd©e_HSV2RGB
(
u8
 
hue
, u8 
ßtuøti⁄
, u8 
Àvñ
)

319 #i‡
COLOR_RGB_SUPPORT


320 
u8
 
R
 = 0;

321 
u8
 
G
 = 0;

322 
u8
 
B
 = 0;

324 
Àvñ
 = (level < 0x10) ? 0x10 :Üevel;

326 
	`hsvToRGB
(
hue
, 
ßtuøti⁄
, 
Àvñ
, &
R
, &
G
, &
B
);

328 
	`LOG
("Àvñ=%d,R=%d,G=%d,B=%d\r\n",
Àvñ
, 
R
, 
G
, 
B
);

330 
Àvñ
 = 10;

331 
Àvñ
 = (level < 0x10) ? 0x10 :Üevel;

332 
	`hsvToRGB
(
hue
, 
ßtuøti⁄
, 
Àvñ
, &
R
, &
G
, &
B
);

333 
	`LOG
("Àvñ=%d,R=%d,G=%d,B=%d\r\n",
Àvñ
, 
R
, 
G
, 
B
);

335 
u16
 
gammaC‹ª˘R
 = ((u16)
R
 * RË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

336 
u16
 
gammaC‹ª˘G
 = ((u16)
G
 * GË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

337 
u16
 
gammaC‹ª˘B
 = ((u16)
B
 * BË/ 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

339 
	`pwmSëDuty
(
PWM_R_CHANNEL
, 
gammaC‹ª˘R
 * 
PWM_FULL_DUTYCYCLE
);

340 
	`pwmSëDuty
(
PWM_G_CHANNEL
, 
gammaC‹ª˘G
 * 
PWM_FULL_DUTYCYCLE
);

341 
	`pwmSëDuty
(
PWM_B_CHANNEL
, 
gammaC‹ª˘B
 * 
PWM_FULL_DUTYCYCLE
);

343 
	}
}

354 
	$light_adju°
()

356 
	`¥ötf
("[%s:%d]Üight_adju° sèπ\r\n", 
__FUNCTION__
, 
__LINE__
);

357 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


358 
	`ßm∂eLight_cﬁ‹Inô
();

360 #ifde‡
ZCL_LEVEL_CTRL


361 
	`ßm∂eLight_ÀvñInô
();

364 
	`ßm∂eLight_⁄OffInô
();

365 
	`¥ötf
("[%s:%d]Üight_adju°Énd\r\n", 
__FUNCTION__
, 
__LINE__
);

366 
	}
}

377 
	$light_‰esh
()

379 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


380 
	`ßm∂eLight_upd©eCﬁ‹
();

382 #ifde‡
ZCL_LEVEL_CTRL


383 
	`ßm∂eLight_upd©eLevñ
();

385 
	`pwmSëDuty
(
COOL_LIGHT_PWM_CHANNEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
 * 
PWM_FULL_DUTYCYCLE
);

388 
	`ßm∂eLight_upd©eOnOff
();

390 
gLightCtx
.
lightAârsCh™ged
 = 
TRUE
;

391 
	}
}

402 
	$light_≠∂yUpd©e
(
u8
 *
curLevñ
, 
u16
 *
curLevñ256
, 
s32
 *
°ïLevñ256
, u16 *
ªmaöögTime
, u8 
möLevñ
, u8 
maxLevñ
, 
boﬁ
 
wøp
)

404 if((*
°ïLevñ256
 > 0Ë&& ((((
s32
)*
curLevñ256
 + *°ïLevñ256Ë/ 256Ë> 
maxLevñ
)){

405 *
curLevñ256
 = (
wøp
Ë? ((
u16
)
möLevñ
 * 256 + ((*curLevñ256 + *
°ïLevñ256
Ë- (u16)
maxLevñ
 * 256) - 256)

406 : ((
u16
)
maxLevñ
 * 256);

407 }if((*
°ïLevñ256
 < 0Ë&& ((((
s32
)*
curLevñ256
 + *°ïLevñ256Ë/ 256Ë< 
möLevñ
)){

408 *
curLevñ256
 = (
wøp
Ë? ((
u16
)
maxLevñ
 * 256 - ((u16)
möLevñ
 * 256 - ((
s32
)*curLevñ256 + *
°ïLevñ256
)) + 256)

409 : ((
u16
)
möLevñ
 * 256);

411 *
curLevñ256
 +*
°ïLevñ256
;

414 if(*
°ïLevñ256
 > 0){

415 *
curLevñ
 = (*
curLevñ256
 + 127) / 256;

417 *
curLevñ
 = *
curLevñ256
 / 256;

420 if(*
ªmaöögTime
 == 0){

421 *
curLevñ256
 = ((
u16
)*
curLevñ
) * 256;

422 *
°ïLevñ256
 = 0;

423 }if(*
ªmaöögTime
 != 0xFFFF){

424 *
ªmaöögTime
 = *remainingTime -1;

427 
	`light_‰esh
();

428 
	}
}

439 
	$light_≠∂yUpd©e_16
(
u16
 *
curLevñ
, 
u32
 *
curLevñ256
, 
s32
 *
°ïLevñ256
, u16 *
ªmaöögTime
, u16 
möLevñ
, u16 
maxLevñ
, 
boﬁ
 
wøp
)

441 if((*
°ïLevñ256
 > 0Ë&& ((((
s32
)*
curLevñ256
 + *°ïLevñ256Ë/ 256Ë> 
maxLevñ
)){

442 *
curLevñ256
 = (
wøp
Ë? ((
u32
)
möLevñ
 * 256 + ((*curLevñ256 + *
°ïLevñ256
Ë- (u32)
maxLevñ
 * 256) - 256)

443 : ((
u32
)
maxLevñ
 * 256);

444 }if((*
°ïLevñ256
 < 0Ë&& ((((
s32
)*
curLevñ256
 + *°ïLevñ256Ë/ 256Ë< 
möLevñ
)){

445 *
curLevñ256
 = (
wøp
Ë? ((
u32
)
maxLevñ
 * 256 - ((u32)
möLevñ
 * 256 - ((
s32
)*curLevñ256 + *
°ïLevñ256
)) + 256)

446 : ((
u32
)
möLevñ
 * 256);

448 *
curLevñ256
 +*
°ïLevñ256
;

451 if(*
°ïLevñ256
 > 0){

452 *
curLevñ
 = (*
curLevñ256
 + 127) / 256;

454 *
curLevñ
 = *
curLevñ256
 / 256;

457 if(*
ªmaöögTime
 == 0){

458 *
curLevñ256
 = ((
u32
)*
curLevñ
) * 256;

459 *
°ïLevñ256
 = 0;

460 }if(*
ªmaöögTime
 != 0xFFFF){

461 *
ªmaöögTime
 = *remainingTime -1;

464 
	`light_‰esh
();

465 
	}
}

476 
s32
 
	$light_blök_TimîEvtCb
(*
¨g
)

478 
u32
 
öãrvÆ
 = 0;

480 if(
gLightCtx
.
°a
 =gLightCtx.
‹iSè
){

481 if(
gLightCtx
.
times
){

482 
gLightCtx
.
times
--;

483 if(
gLightCtx
.
times
 <= 0){

484 if(
gLightCtx
.
‹iSè
){

485 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_ON
);

487 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_OFF
);

490 
gLightCtx
.
timîLedEvt
 = 
NULL
;

496 
gLightCtx
.
°a
 = !gLightCtx.sta;

497 if(
gLightCtx
.
°a
){

498 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_ON
);

499 
öãrvÆ
 = 
gLightCtx
.
ÀdOnTime
;

501 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_OFF
);

502 
öãrvÆ
 = 
gLightCtx
.
ÀdOffTime
;

505  
öãrvÆ
;

506 
	}
}

519 
	$light_blök_°¨t
(
u8
 
times
, 
u16
 
ÀdOnTime
, u16 
ÀdOffTime
)

521 
u32
 
öãrvÆ
 = 0;

522 
z˛_⁄OffAâr_t
 *
pOnoff
 = 
	`z˛_⁄offAârGë
();

524 
gLightCtx
.
‹iSè
 = 
pOnoff
->
⁄Off
;

525 
gLightCtx
.
times
 =Åimes;

527 if(!
gLightCtx
.
timîLedEvt
){

528 if(
gLightCtx
.
‹iSè
){

529 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_OFF
);

530 
gLightCtx
.
°a
 = 0;

531 
öãrvÆ
 = 
ÀdOffTime
;

533 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_ON
);

534 
gLightCtx
.
°a
 = 1;

535 
öãrvÆ
 = 
ÀdOnTime
;

537 
gLightCtx
.
ÀdOnTime
 =ÜedOnTime;

538 
gLightCtx
.
ÀdOffTime
 =ÜedOffTime;

540 
gLightCtx
.
timîLedEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
light_blök_TimîEvtCb
, 
NULL
, 
öãrvÆ
);

542 
	}
}

553 
	$light_blök_°›
()

555 if(
gLightCtx
.
timîLedEvt
){

556 
	`TL_ZB_TIMER_CANCEL
(&
gLightCtx
.
timîLedEvt
);

558 
gLightCtx
.
times
 = 0;

559 if(
gLightCtx
.
‹iSè
){

560 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_ON
);

562 
	`hwLight_⁄OffUpd©e
(
ZCL_CMD_ONOFF_OFF
);

565 
	}
}

	@apps/sampleLight/sampleLightCtrl.h

24 #i‚de‡
_SAMPLE_LIGHT_CTRL_H_


25 
	#_SAMPLE_LIGHT_CTRL_H_


	)

36 
hwLight_öô
();

37 
hwLight_⁄OffUpd©e
(
u8
 
⁄Off
);

38 
hwLight_ÀvñUpd©e
(
u8
 
Àvñ
);

39 
hwLight_cﬁ‹Upd©e_cﬁ‹Tem≥øtuª
(
u16
 
cﬁ‹Tem≥øtuªMúeds
, 
u8
 
Àvñ
);

40 
hwLight_cﬁ‹Upd©e_HSV2RGB
(
u8
 
hue
, u8 
ßtuøti⁄
, u8 
Àvñ
);

42 
light_adju°
();

43 
light_‰esh
();

44 
light_≠∂yUpd©e
(
u8
 *
curLevñ
, 
u16
 *
curLevñ256
, 
s32
 *
°ïLevñ256
, u16 *
ªmaöögTime
, u8 
möLevñ
, u8 
maxLevñ
, 
boﬁ
 
wøp
);

45 
light_≠∂yUpd©e_16
(
u16
 *
curLevñ
, 
u32
 *
curLevñ256
, 
s32
 *
°ïLevñ256
, u16 *
ªmaöögTime
, u16 
möLevñ
, u16 
maxLevñ
, 
boﬁ
 
wøp
);

47 
light_blök_°¨t
(
u8
 
times
, 
u16
 
ÀdOnTime
, u16 
ÀdOffTime
);

48 
light_blök_°›
();

	@apps/sampleLight/sampleLightEpCfg.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"z˛_ö˛ude.h
"

31 
	~"ßm∂eLight.h
"

36 #i‚de‡
ZCL_BASIC_MFG_NAME


37 
	#ZCL_BASIC_MFG_NAME
 \

	)

42 #i‚de‡
ZCL_BASIC_MODEL_ID


43 
	#ZCL_BASIC_MODEL_ID
 \

	)

48 #i‚de‡
ZCL_BASIC_SW_BUILD_ID


49 
	#ZCL_BASIC_SW_BUILD_ID
 \

	)

55 #i‡
COLOR_CCT_SUPPORT


56 
	#COLOR_TEMPERATURE_PHYSICAL_MIN
 0x00FA

57 
	#COLOR_TEMPERATURE_PHYSICAL_MAX
 0x01C6

59 

	)

70 c⁄° 
u16
 
	gßm∂eLight_öClu°îLi°
[] =

72 
ZCL_CLUSTER_GEN_BASIC
,

73 
ZCL_CLUSTER_GEN_IDENTIFY
,

74 #ifde‡
ZCL_GROUP


75 
ZCL_CLUSTER_GEN_GROUPS
,

77 #ifde‡
ZCL_SCENE


78 
ZCL_CLUSTER_GEN_SCENES
,

80 #ifde‡
ZCL_ON_OFF


81 
ZCL_CLUSTER_GEN_ON_OFF
,

83 #ifde‡
ZCL_LEVEL_CTRL


84 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
,

86 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


87 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
,

89 #ifde‡
ZCL_ZLL_COMMISSIONING


90 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
,

92 #ifde‡
ZCL_WWAH


93 
ZCL_CLUSTER_WWAH
,

100 c⁄° 
u16
 
	gßm∂eLight_outClu°îLi°
[] =

102 #ifde‡
ZCL_OTA


103 
ZCL_CLUSTER_OTA
,

110 
	#SAMPLELIGHT_IN_CLUSTER_NUM
 ((
ßm∂eLight_öClu°îLi°
Ë/ (ßm∂eLight_öClu°îLi°[0]))

	)

111 
	#SAMPLELIGHT_OUT_CLUSTER_NUM
 ((
ßm∂eLight_outClu°îLi°
Ë/ (ßm∂eLight_outClu°îLi°[0]))

	)

116 c⁄° 
af_sim∂e_des¸ùt‹_t
 
	gßm∂eLight_sim∂eDesc
 =

118 
HA_PROFILE_ID
,

119 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


120 
HA_DEV_COLOR_DIMMABLE_LIGHT
,

122 #ifde‡
ZCL_LEVEL_CTRL


123 
HA_DEV_DIMMABLE_LIGHT
,

125 
HA_DEV_ONOFF_LIGHT
,

128 
SAMPLE_LIGHT_ENDPOINT
,

131 
SAMPLELIGHT_IN_CLUSTER_NUM
,

132 
SAMPLELIGHT_OUT_CLUSTER_NUM
,

133 (
u16
 *)
ßm∂eLight_öClu°îLi°
,

134 (
u16
 *)
ßm∂eLight_outClu°îLi°
,

137 #i‡
AF_TEST_ENABLE


141 c⁄° 
u16
 
	gßm∂eTe°_öClu°îLi°
[] =

143 
ZCL_CLUSTER_TELINK_SDK_TEST_REQ
,

144 
ZCL_CLUSTER_TELINK_SDK_TEST_RSP
,

145 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_REQ
,

146 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_RSP
,

152 c⁄° 
u16
 
	gßm∂eTe°_outClu°îLi°
[] =

154 
ZCL_CLUSTER_TELINK_SDK_TEST_REQ
,

155 
ZCL_CLUSTER_TELINK_SDK_TEST_RSP
,

156 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_REQ
,

157 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_RSP
,

163 
	#SAMPLE_TEST_IN_CLUSTER_NUM
 ((
ßm∂eTe°_öClu°îLi°
Ë/ (ßm∂eTe°_öClu°îLi°[0]))

	)

164 
	#SAMPLE_TEST_OUT_CLUSTER_NUM
 ((
ßm∂eTe°_outClu°îLi°
Ë/ (ßm∂eTe°_outClu°îLi°[0]))

	)

169 c⁄° 
af_sim∂e_des¸ùt‹_t
 
	gßm∂eTe°Desc
 =

171 
HA_PROFILE_ID
,

172 
HA_DEV_DIMMABLE_LIGHT
,

173 
SAMPLE_TEST_ENDPOINT
,

176 
SAMPLE_TEST_IN_CLUSTER_NUM
,

177 
SAMPLE_TEST_OUT_CLUSTER_NUM
,

178 (
u16
 *)
ßm∂eTe°_öClu°îLi°
,

179 (
u16
 *)
ßm∂eTe°_outClu°îLi°
,

184 
z˛_basicAâr_t
 
	gg_z˛_basicAârs
 =

186 .
z˛Vîsi⁄
 = 0x03,

187 .
	g≠pVîsi⁄
 = 0x00,

188 .
	g°ackVîsi⁄
 = 0x02,

189 .
	ghwVîsi⁄
 = 0x00,

190 .
	gm™uName
 = 
ZCL_BASIC_MFG_NAME
,

191 .
	gmodñId
 = 
ZCL_BASIC_MODEL_ID
,

192 .
	gpowîSour˚
 = 
POWER_SOURCE_MAINS_1_PHASE
,

193 .
	gswBuûdId
 = 
ZCL_BASIC_SW_BUILD_ID
,

194 .
	gdevi˚E«bÀ
 = 
TRUE
,

197 c⁄° 
z˛AârInfo_t
 
	gbasic_©åTbl
[] =

199 {
ZCL_ATTRID_BASIC_ZCL_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
z˛Vîsi⁄
},

200 {
ZCL_ATTRID_BASIC_APP_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
≠pVîsi⁄
},

201 {
ZCL_ATTRID_BASIC_STACK_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
°ackVîsi⁄
},

202 {
ZCL_ATTRID_BASIC_HW_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
hwVîsi⁄
},

203 {
ZCL_ATTRID_BASIC_MFR_NAME
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
 *)
g_z˛_basicAârs
.
m™uName
},

204 {
ZCL_ATTRID_BASIC_MODEL_ID
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
 *)
g_z˛_basicAârs
.
modñId
},

205 {
ZCL_ATTRID_BASIC_POWER_SOURCE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
powîSour˚
},

206 {
ZCL_ATTRID_BASIC_DEV_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_basicAârs
.
devi˚E«bÀ
},

207 {
ZCL_ATTRID_BASIC_SW_BUILD_ID
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_basicAârs
.
swBuûdId
},

209 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

212 
	#ZCL_BASIC_ATTR_NUM
 (
basic_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

215 
z˛_idítifyAâr_t
 
	gg_z˛_idítifyAârs
 =

217 .
idítifyTime
 = 0x0000,

220 c⁄° 
z˛AârInfo_t
 
	gidítify_©åTbl
[] =

222 {
ZCL_ATTRID_IDENTIFY_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_idítifyAârs
.
idítifyTime
},

224 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

227 
	#ZCL_IDENTIFY_ATTR_NUM
 (
idítify_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

229 #ifde‡
ZCL_GROUP


231 
z˛_groupAâr_t
 
	gg_z˛_groupAârs
 =

233 .
«meSuµ‹t
 = 0,

236 c⁄° 
z˛AârInfo_t
 
	ggroup_©åTbl
[] =

238 {
ZCL_ATTRID_GROUP_NAME_SUPPORT
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_groupAârs
.
«meSuµ‹t
},

240 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

243 
	#ZCL_GROUP_ATTR_NUM
 (
group_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

246 #ifde‡
ZCL_SCENE


248 
z˛_s˚√Aâr_t
 
	gg_z˛_s˚√Aârs
 =

250 .
s˚√Cou¡
 = 0,

251 .
	gcuºítS˚√
 = 0,

252 .
	gcuºítGroup
 = 0x0000,

253 .
	gs˚√VÆid
 = 
FALSE
,

254 .
	g«meSuµ‹t
 = 0,

257 c⁄° 
z˛AârInfo_t
 
	gs˚√_©åTbl
[] =

259 {
ZCL_ATTRID_SCENE_SCENE_COUNT
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_s˚√Aârs
.
s˚√Cou¡
},

260 {
ZCL_ATTRID_SCENE_CURRENT_SCENE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_s˚√Aârs
.
cuºítS˚√
},

261 {
ZCL_ATTRID_SCENE_CURRENT_GROUP
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_s˚√Aârs
.
cuºítGroup
},

262 {
ZCL_ATTRID_SCENE_SCENE_VALID
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_s˚√Aârs
.
s˚√VÆid
},

263 {
ZCL_ATTRID_SCENE_NAME_SUPPORT
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_s˚√Aârs
.
«meSuµ‹t
},

265 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

268 
	#ZCL_SCENE_ATTR_NUM
 (
s˚√_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

271 #ifde‡
ZCL_ON_OFF


273 
z˛_⁄OffAâr_t
 
	gg_z˛_⁄OffAârs
 =

275 .
⁄Off
 = 0x00,

276 .
	gglobÆS˚√C⁄åﬁ
 = 1,

277 .
	g⁄Time
 = 0x0000,

278 .
	goffWaôTime
 = 0x0000,

279 .
	g°¨tUpOnOff
 = 
ZCL_START_UP_ONOFF_SET_ONOFF_TO_ON
,

282 c⁄° 
z˛AârInfo_t
 
	g⁄Off_©åTbl
[] =

284 {
ZCL_ATTRID_ONOFF
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_⁄OffAârs
.
⁄Off
},

285 {
ZCL_ATTRID_GLOBAL_SCENE_CONTROL
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_⁄OffAârs
.
globÆS˚√C⁄åﬁ
},

286 {
ZCL_ATTRID_ON_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_⁄OffAârs
.
⁄Time
},

287 {
ZCL_ATTRID_OFF_WAIT_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_⁄OffAârs
.
offWaôTime
},

288 {
ZCL_ATTRID_START_UP_ONOFF
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_⁄OffAârs
.
°¨tUpOnOff
},

290 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

293 
	#ZCL_ONOFF_ATTR_NUM
 (
⁄Off_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

296 #ifde‡
ZCL_LEVEL_CTRL


298 
z˛_ÀvñAâr_t
 
	gg_z˛_ÀvñAârs
 =

300 .
curLevñ
 = 0xFE,

301 .
	gªmaöögTime
 = 0,

302 .
	g°¨tUpCuºítLevñ
 = 
ZCL_START_UP_CURRENT_LEVEL_TO_PREVIOUS
,

305 c⁄° 
z˛AârInfo_t
 
	gÀvñ_©åTbl
[] =

307 {
ZCL_ATTRID_LEVEL_CURRENT_LEVEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_ÀvñAârs
.
curLevñ
},

308 {
ZCL_ATTRID_LEVEL_REMAINING_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_ÀvñAârs
.
ªmaöögTime
},

309 {
ZCL_ATTRID_LEVEL_START_UP_CURRENT_LEVEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_ÀvñAârs
.
°¨tUpCuºítLevñ
},

311 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

314 
	#ZCL_LEVEL_ATTR_NUM
 (
Àvñ_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

317 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


319 
z˛_lightCﬁ‹CålAâr_t
 
	gg_z˛_cﬁ‹CålAârs
 =

321 .
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
,

322 .
	g›ti⁄s
 = 0,

323 .
	gíh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
,

324 .
	gcﬁ‹C≠abûôõs
 = 
ZCL_COLOR_CAPABILITIES_BIT_COLOR_TEMPERATURE
,

325 .
	gnumOfPrim¨õs
 = 0,

326 #i‡
COLOR_RGB_SUPPORT


327 .
	gcuºítHue
 = 0x00,

328 .
	gcuºítS©uøti⁄
 = 0x00,

329 .
	gcﬁ‹Lo›A˘ive
 = 0x00,

330 .
	gcﬁ‹Lo›Dúe˘i⁄
 = 0x00,

331 .
	gcﬁ‹Lo›Time
 = 0x0019,

332 .
	gcﬁ‹Lo›SèπEnh™˚dHue
 = 0x2300,

333 .
	gcﬁ‹Lo›St‹edEnh™˚dHue
 = 0x0000,

334 #ñi‡
COLOR_CCT_SUPPORT


335 .
	gcﬁ‹Tem≥øtuªMúeds
 = 
COLOR_TEMPERATURE_PHYSICAL_MAX
,

336 .
	gcﬁ‹TempPhysiˇlMöMúeds
 = 
COLOR_TEMPERATURE_PHYSICAL_MIN
,

337 .
	gcﬁ‹TempPhysiˇlMaxMúeds
 = 
COLOR_TEMPERATURE_PHYSICAL_MAX
,

338 .
	g°¨tUpCﬁ‹Tem≥øtuªMúeds
 = 
ZCL_START_UP_COLOR_TEMPERATURE_MIREDS_TO_PREVIOUS
,

342 c⁄° 
z˛AârInfo_t
 
	glightCﬁ‹Cål_©åTbl
[] =

344 {
ZCL_ATTRID_COLOR_MODE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Mode
},

345 {
ZCL_ATTRID_COLOR_OPTIONS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
›ti⁄s
},

346 {
ZCL_ATTRID_ENHANCED_COLOR_MODE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
íh™˚dCﬁ‹Mode
},

347 {
ZCL_ATTRID_COLOR_CAPABILITIES
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹C≠abûôõs
},

348 {
ZCL_ATTRID_NUMBER_OF_PRIMARIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
numOfPrim¨õs
},

350 #i‡
COLOR_RGB_SUPPORT


351 {
ZCL_ATTRID_CURRENT_HUE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cuºítHue
},

352 {
ZCL_ATTRID_CURRENT_SATURATION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cuºítS©uøti⁄
},

353 {
ZCL_ATTRID_COLOR_LOOP_ACTIVE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Lo›A˘ive
},

354 {
ZCL_ATTRID_COLOR_LOOP_DIRECTION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Lo›Dúe˘i⁄
},

355 {
ZCL_ATTRID_COLOR_LOOP_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Lo›Time
},

356 {
ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Lo›SèπEnh™˚dHue
},

357 {
ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Lo›St‹edEnh™˚dHue
},

358 #ñi‡
COLOR_CCT_SUPPORT


359 {
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Tem≥øtuªMúeds
},

360 {
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹TempPhysiˇlMöMúeds
},

361 {
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
cﬁ‹TempPhysiˇlMaxMúeds
},

362 {
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
 *)&
g_z˛_cﬁ‹CålAârs
.
°¨tUpCﬁ‹Tem≥øtuªMúeds
},

365 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
 *)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

368 
	#ZCL_COLOR_ATTR_NUM
 (
lightCﬁ‹Cål_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

374 c⁄° 
z˛_•ecClu°îInfo_t
 
	gg_ßm∂eLightClu°îLi°
[] =

376 {
ZCL_CLUSTER_GEN_BASIC
, 
MANUFACTURER_CODE_NONE
, 
ZCL_BASIC_ATTR_NUM
, 
basic_©åTbl
, 
z˛_basic_ªgi°î
, 
ßm∂eLight_basicCb
},

377 {
ZCL_CLUSTER_GEN_IDENTIFY
, 
MANUFACTURER_CODE_NONE
, 
ZCL_IDENTIFY_ATTR_NUM
, 
idítify_©åTbl
, 
z˛_idítify_ªgi°î
, 
ßm∂eLight_idítifyCb
},

378 #ifde‡
ZCL_GROUP


379 {
ZCL_CLUSTER_GEN_GROUPS
, 
MANUFACTURER_CODE_NONE
, 
ZCL_GROUP_ATTR_NUM
, 
group_©åTbl
, 
z˛_group_ªgi°î
, 
NULL
},

381 #ifde‡
ZCL_SCENE


382 {
ZCL_CLUSTER_GEN_SCENES
, 
MANUFACTURER_CODE_NONE
, 
ZCL_SCENE_ATTR_NUM
, 
s˚√_©åTbl
, 
z˛_s˚√_ªgi°î
, 
ßm∂eLight_s˚√Cb
},

384 #ifde‡
ZCL_ON_OFF


385 {
ZCL_CLUSTER_GEN_ON_OFF
, 
MANUFACTURER_CODE_NONE
, 
ZCL_ONOFF_ATTR_NUM
, 
⁄Off_©åTbl
, 
z˛_⁄Off_ªgi°î
, 
ßm∂eLight_⁄OffCb
},

387 #ifde‡
ZCL_LEVEL_CTRL


388 {
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
MANUFACTURER_CODE_NONE
, 
ZCL_LEVEL_ATTR_NUM
, 
Àvñ_©åTbl
, 
z˛_Àvñ_ªgi°î
, 
ßm∂eLight_ÀvñCb
},

390 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


391 {
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
MANUFACTURER_CODE_NONE
, 
ZCL_COLOR_ATTR_NUM
, 
lightCﬁ‹Cål_©åTbl
, 
z˛_lightCﬁ‹Cål_ªgi°î
, 
ßm∂eLight_cﬁ‹CålCb
},

395 
u8
 
	gSAMPLELIGHT_CB_CLUSTER_NUM
 = ((
g_ßm∂eLightClu°îLi°
) / (g_sampleLightClusterList[0]));

410 
nv_°s_t
 
	$z˛_⁄OffAâr_ßve
()

412 
nv_°s_t
 
°
 = 
NV_SUCC
;

414 #ifde‡
ZCL_ON_OFF


415 #i‡
NV_ENABLE


416 
z˛_nv_⁄Off_t
 
z˛_nv_⁄Off
;

418 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_ON_OFF
, (
z˛_nv_⁄Off_t
), (
u8
 *)&
z˛_nv_⁄Off
);

420 i‡(
°
 =
NV_SUCC
)

422 i‡((
z˛_nv_⁄Off
.
⁄Off
 !
g_z˛_⁄OffAârs
.⁄OffË|| (z˛_nv_⁄Off.
°¨tUpOnOff
 != g_zcl_onOffAttrs.startUpOnOff))

424 
z˛_nv_⁄Off
.
⁄Off
 = 
g_z˛_⁄OffAârs
.onOff;

425 
z˛_nv_⁄Off
.
°¨tUpOnOff
 = 
g_z˛_⁄OffAârs
.startUpOnOff;

427 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_ON_OFF
, (
z˛_nv_⁄Off_t
), (
u8
 *)&
z˛_nv_⁄Off
);

430 i‡(
°
 =
NV_ITEM_NOT_FOUND
)

432 
z˛_nv_⁄Off
.
⁄Off
 = 
g_z˛_⁄OffAârs
.onOff;

433 
z˛_nv_⁄Off
.
°¨tUpOnOff
 = 
g_z˛_⁄OffAârs
.startUpOnOff;

435 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_ON_OFF
, (
z˛_nv_⁄Off_t
), (
u8
 *)&
z˛_nv_⁄Off
);

438 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

442  
°
;

443 
	}
}

454 
nv_°s_t
 
	$z˛_⁄OffAâr_ª°‹e
()

456 
nv_°s_t
 
°
 = 
NV_SUCC
;

458 #ifde‡
ZCL_ON_OFF


459 #i‡
NV_ENABLE


460 
z˛_nv_⁄Off_t
 
z˛_nv_⁄Off
;

462 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_ON_OFF
, (
z˛_nv_⁄Off_t
), (
u8
 *)&
z˛_nv_⁄Off
);

464 i‡(
°
 =
NV_SUCC
)

466 
g_z˛_⁄OffAârs
.
⁄Off
 = 
z˛_nv_⁄Off
.onOff;

467 
g_z˛_⁄OffAârs
.
°¨tUpOnOff
 = 
z˛_nv_⁄Off
.startUpOnOff;

470 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

474  
°
;

475 
	}
}

486 
nv_°s_t
 
	$z˛_ÀvñAâr_ßve
()

488 
nv_°s_t
 
°
 = 
NV_SUCC
;

490 #ifde‡
ZCL_LEVEL_CTRL


491 #i‡
NV_ENABLE


492 
z˛_nv_Àvñ_t
 
z˛_nv_Àvñ
;

494 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_LEVEL
, (
z˛_nv_Àvñ_t
), (
u8
 *)&
z˛_nv_Àvñ
);

496 i‡(
°
 =
NV_SUCC
)

498 i‡((
z˛_nv_Àvñ
.
curLevñ
 !
g_z˛_ÀvñAârs
.curLevñË|| (z˛_nv_Àvñ.
°¨tUpCurLevñ
 !g_z˛_ÀvñAârs.
°¨tUpCuºítLevñ
))

500 
z˛_nv_Àvñ
.
curLevñ
 = 
g_z˛_ÀvñAârs
.curLevel;

501 
z˛_nv_Àvñ
.
°¨tUpCurLevñ
 = 
g_z˛_ÀvñAârs
.
°¨tUpCuºítLevñ
;

503 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_LEVEL
, (
z˛_nv_Àvñ_t
), (
u8
 *)&
z˛_nv_Àvñ
);

506 i‡(
°
 =
NV_ITEM_NOT_FOUND
)

508 
z˛_nv_Àvñ
.
curLevñ
 = 
g_z˛_ÀvñAârs
.curLevel;

509 
z˛_nv_Àvñ
.
°¨tUpCurLevñ
 = 
g_z˛_ÀvñAârs
.
°¨tUpCuºítLevñ
;

511 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_LEVEL
, (
z˛_nv_Àvñ_t
), (
u8
 *)&
z˛_nv_Àvñ
);

514 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

518  
°
;

519 
	}
}

530 
nv_°s_t
 
	$z˛_ÀvñAâr_ª°‹e
()

532 
nv_°s_t
 
°
 = 
NV_SUCC
;

534 #ifde‡
ZCL_LEVEL_CTRL


535 #i‡
NV_ENABLE


536 
z˛_nv_Àvñ_t
 
z˛_nv_Àvñ
;

538 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_LEVEL
, (
z˛_nv_Àvñ_t
), (
u8
 *)&
z˛_nv_Àvñ
);

540 i‡(
°
 =
NV_SUCC
)

542 
g_z˛_ÀvñAârs
.
curLevñ
 = 
z˛_nv_Àvñ
.curLevel;

543 
g_z˛_ÀvñAârs
.
°¨tUpCuºítLevñ
 = 
z˛_nv_Àvñ
.
°¨tUpCurLevñ
;

546 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

550  
°
;

551 
	}
}

562 
nv_°s_t
 
	$z˛_cﬁ‹CålAâr_ßve
()

564 
nv_°s_t
 
°
 = 
NV_SUCC
;

566 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


567 #i‡
NV_ENABLE


568 
boﬁ
 
√edSave
 = 
FALSE
;

569 
z˛_nv_cﬁ‹Cål_t
 
z˛_nv_cﬁ‹Cål
;

571 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_COLOR_CTRL
, (
z˛_nv_cﬁ‹Cål_t
), (
u8
 *)&
z˛_nv_cﬁ‹Cål
);

573 #i‡
COLOR_RGB_SUPPORT


574 i‡(
°
 =
NV_SUCC
)

576 i‡((
z˛_nv_cﬁ‹Cål
.
cuºítHue
 !
g_z˛_cﬁ‹CålAârs
.cuºítHueË|| (z˛_nv_cﬁ‹Cål.
cuºítS©uøti⁄
 != g_zcl_colorCtrlAttrs.currentSaturation))

578 
z˛_nv_cﬁ‹Cål
.
cuºítHue
 = 
g_z˛_cﬁ‹CålAârs
.currentHue;

579 
z˛_nv_cﬁ‹Cål
.
cuºítS©uøti⁄
 = 
g_z˛_cﬁ‹CålAârs
.currentSaturation;

581 
√edSave
 = 
TRUE
;

584 i‡(
°
 =
NV_ITEM_NOT_FOUND
)

586 
z˛_nv_cﬁ‹Cål
.
cuºítHue
 = 
g_z˛_cﬁ‹CålAârs
.currentHue;

587 
z˛_nv_cﬁ‹Cål
.
cuºítS©uøti⁄
 = 
g_z˛_cﬁ‹CålAârs
.currentSaturation;

589 
√edSave
 = 
TRUE
;

591 #ñi‡
COLOR_CCT_SUPPORT


592 i‡(
°
 =
NV_SUCC
)

594 i‡((
z˛_nv_cﬁ‹Cål
.
cﬁ‹Tem≥øtuªMúeds
 !
g_z˛_cﬁ‹CålAârs
.cﬁ‹Tem≥øtuªMúedsË|| (z˛_nv_cﬁ‹Cål.
°¨tUpCﬁ‹Tem≥øtuªMúeds
 != g_zcl_colorCtrlAttrs.startUpColorTemperatureMireds))

596 
z˛_nv_cﬁ‹Cål
.
cﬁ‹Tem≥øtuªMúeds
 = 
g_z˛_cﬁ‹CålAârs
.colorTemperatureMireds;

597 
z˛_nv_cﬁ‹Cål
.
°¨tUpCﬁ‹Tem≥øtuªMúeds
 = 
g_z˛_cﬁ‹CålAârs
.startUpColorTemperatureMireds;

599 
√edSave
 = 
TRUE
;

602 i‡(
°
 =
NV_ITEM_NOT_FOUND
)

604 
z˛_nv_cﬁ‹Cål
.
cﬁ‹Tem≥øtuªMúeds
 = 
g_z˛_cﬁ‹CålAârs
.colorTemperatureMireds;

605 
z˛_nv_cﬁ‹Cål
.
°¨tUpCﬁ‹Tem≥øtuªMúeds
 = 
g_z˛_cﬁ‹CålAârs
.startUpColorTemperatureMireds;

607 
√edSave
 = 
TRUE
;

611 i‡(
√edSave
)

613 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_COLOR_CTRL
, (
z˛_nv_cﬁ‹Cål_t
), (
u8
 *)&
z˛_nv_cﬁ‹Cål
);

617 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

621  
°
;

622 
	}
}

633 
nv_°s_t
 
	$z˛_cﬁ‹CålAâr_ª°‹e
()

635 
nv_°s_t
 
°
 = 
NV_SUCC
;

637 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


638 #i‡
NV_ENABLE


639 
z˛_nv_cﬁ‹Cål_t
 
z˛_nv_cﬁ‹Cål
;

641 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_COLOR_CTRL
, (
z˛_nv_cﬁ‹Cål_t
), (
u8
 *)&
z˛_nv_cﬁ‹Cål
);

643 #i‡
COLOR_RGB_SUPPORT


644 i‡(
°
 =
NV_SUCC
)

646 
g_z˛_cﬁ‹CålAârs
.
cuºítHue
 = 
z˛_nv_cﬁ‹Cål
.currentHue;

647 
g_z˛_cﬁ‹CålAârs
.
cuºítS©uøti⁄
 = 
z˛_nv_cﬁ‹Cål
.currentSaturation;

649 #ñi‡
COLOR_CCT_SUPPORT


650 i‡(
°
 =
NV_SUCC
)

652 
g_z˛_cﬁ‹CålAârs
.
cﬁ‹Tem≥øtuªMúeds
 = 
z˛_nv_cﬁ‹Cål
.colorTemperatureMireds;

653 
g_z˛_cﬁ‹CålAârs
.
°¨tUpCﬁ‹Tem≥øtuªMúeds
 = 
z˛_nv_cﬁ‹Cål
.startUpColorTemperatureMireds;

658 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

662  
°
;

663 
	}
}

674 
	$z˛_ßm∂eLightAârsInô
()

676 
	`z˛_⁄OffAâr_ª°‹e
();

677 
	`z˛_ÀvñAâr_ª°‹e
();

678 
	`z˛_cﬁ‹CålAâr_ª°‹e
();

679 
	}
}

	@apps/sampleLight/stack_cfg.h

24 #¥agm®
⁄˚


31 
	#DEFAULT_CHANNEL
 20

	)

36 
	#NV_ENABLE
 1

	)

41 
	#SECURITY_ENABLE
 1

	)

51 
	#ZCL_CLUSTER_NUM_MAX
 11

	)

57 
	#ZCL_REPORTING_TABLE_NUM
 4

	)

63 
	#ZCL_SCENE_TABLE_NUM
 8

	)

70 
	#APS_GROUP_TABLE_NUM
 8

	)

75 
	#APS_BINDING_TABLE_NUM
 8

	)

85 #i‡(
COORDINATOR
)

86 
	#ZB_ROUTER_ROLE
 1

	)

87 
	#ZB_COORDINATOR_ROLE
 1

	)

88 #ñi‡(
ROUTER
)

89 
	#ZB_ROUTER_ROLE
 1

	)

90 #ñi‡(
END_DEVICE
)

91 
	#ZB_ED_ROLE
 1

	)

94 #i‡
ZB_ROUTER_ROLE


95 
	#GP_SUPPORT_ENABLE
 1

	)

	@apps/sampleLight/version_cfg.h

24 #¥agm®
⁄˚


26 
	~"../comm⁄/comm_cfg.h
"

28 #i‡
deföed
(
MCU_CORE_826x
)

29 #i‡(
CHIP_8269
)

30 
	#CHIP_TYPE
 
TLSR_8269


	)

32 
	#CHIP_TYPE
 
TLSR_8267


	)

34 #ñi‡
deföed
(
MCU_CORE_8258
)

35 
	#CHIP_TYPE
 
TLSR_8258_512K


36 #ñi‡
	`deföed
(
MCU_CORE_8278
)

	)

37 
	#CHIP_TYPE
 
TLSR_8278


	)

38 #ñi‡
deföed
(
MCU_CORE_B91
)

39 
	#CHIP_TYPE
 
TLSR_9518


	)

42 
	#APP_RELEASE
 0x10

43 
	#APP_BUILD
 0x01

44 
	#STACK_RELEASE
 0x30

45 
	#STACK_BUILD
 0x01

46 

	)

51 
	#MANUFACTURER_CODE_TELINK
 0x1141

52 
	#IMAGE_TYPE
 ((
CHIP_TYPE
 << 8Ë| 
IMAGE_TYPE_LIGHT
)

	)

53 
	#FILE_VERSION
 ((
APP_RELEASE
 << 24Ë| (
APP_BUILD
 << 16Ë| (
STACK_RELEASE
 << 8Ë| 
STACK_BUILD
)

	)

56 
	#IS_BOOT_LOADER_IMAGE
 0

	)

57 
	#RESV_FOR_APP_RAM_CODE_SIZE
 0

	)

58 
	#IMAGE_OFFSET
 
APP_IMAGE_ADDR


	)

	@apps/sampleLight/zb_afTestCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"ßm∂eLight.h
"

33 #i‡
ZBHCI_EN


34 
	~"zbhci.h
"

37 #i‡
AF_TEST_ENABLE


60 
u16
 
	gg_afTe°_rcvReqC¡
 = 0;

65 
	$afTe°_ã°ReqPrc
(
≠sdeD©aInd_t
 *
pApsdeInd
)

67 
ïInfo_t
 
d°Ep
;

68 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

70 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

71 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

72 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

73 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

75 
u8
 
d©aLí
 = 50;

76 
u8
 *
pBuf
 = (u8 *)
	`ev_buf_Æloˇã
(
d©aLí
);

77 if(
pBuf
){

78 
u8
 *
pD©a
 = 
pBuf
;

80 *
pD©a
++ = 
	`LO_UINT16
(
g_afTe°_rcvReqC¡
);

81 *
pD©a
++ = 
	`HI_UINT16
(
g_afTe°_rcvReqC¡
);

83 
u8
 
i
 = 0; i < 
d©aLí
 - 2; i++){

84 *
pD©a
++ = 
i
;

87 
u8
 
≠sC¡
 = 0;

88 #i‡
ZBHCI_EN


89 
	`zbhciTx
(
ZCL_CLUSTER_TELINK_SDK_TEST_RSP
, 
pApsdeInd
->
asduLí
, (
u8
 *ÌApsdeInd->
asdu
);

91 
	`af_d©aSíd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
ZCL_CLUSTER_TELINK_SDK_TEST_RSP
, 
d©aLí
, 
pBuf
, &
≠sC¡
);

94 
	`ev_buf_‰ì
(
pBuf
);

96 
	}
}

98 
	$afTe°_ã°CÀ¨ReqPrc
(
≠sdeD©aInd_t
 *
pApsdeInd
)

100 
ïInfo_t
 
d°Ep
;

101 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

103 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

104 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

105 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

106 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

108 
u8
 
°
 = 
SUCCESS
;

110 
u8
 
≠sC¡
 = 0;

111 
	`af_d©aSíd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_RSP
, 1, &
°
, &
≠sC¡
);

112 
	}
}

114 
	$afTe°_rx_h™dÀr
(*
¨g
)

116 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_à*)
¨g
;

118 
pApsdeInd
->
ödInfo
.
˛u°î_id
){

119 
ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_REQ
:

120 
g_afTe°_rcvReqC¡
 = 0;

121 
	`afTe°_ã°CÀ¨ReqPrc
(
pApsdeInd
);

123 
ZCL_CLUSTER_TELINK_SDK_TEST_REQ
:

124 
g_afTe°_rcvReqC¡
++;

125 
	`afTe°_ã°ReqPrc
(
pApsdeInd
);

127 
ZCL_CLUSTER_TELINK_SDK_TEST_RSP
:

135 
	`ev_buf_‰ì
((
u8
 *)
¨g
);

136 
	}
}

138 
	$afTe°_d©aSídC⁄fúm
(*
¨g
)

142 
	}
}

	@apps/sampleLight/zb_appCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"bdb.h
"

33 
	~"Ÿa.h
"

34 
	~"ßm∂eLight.h
"

35 
	~"ßm∂eLightCål.h
"

40 
	#DEBUG_HEART
 0

	)

49 
zbdemo_bdbInôCb
(
u8
 
°©us
, u8 
joöedNëw‹k
);

50 
zbdemo_bdbCommissi⁄ögCb
(
u8
 
°©us
, *
¨g
);

51 
zbdemo_bdbIdítifyCb
(
u8
 
ídpoöt
, 
u16
 
§cAddr
, u16 
idítifyTime
);

56 
bdb_≠pCb_t
 
	gg_zbDemoBdbCb
 = {
zbdemo_bdbInôCb
, 
zbdemo_bdbCommissi⁄ögCb
, 
zbdemo_bdbIdítifyCb
, 
NULL
};

58 #ifde‡
ZCL_OTA


59 
Ÿa_ˇŒBack_t
 
	gßm∂eLight_ŸaCb
 =

61 
ßm∂eLight_ŸaPro˚ssMsgH™dÀr
,

68 
u32
 
	ghóπI¡îvÆ
 = 0;

70 #i‡
DEBUG_HEART


71 
ev_timî_evít_t
 *
	ghóπTimîEvt
 = 
NULL
;

77 #i‡
DEBUG_HEART


78 
s32
 
	$hóπTimîCb
(*
¨g
)

80 i‡(
hóπI¡îvÆ
 == 0)

82 
hóπTimîEvt
 = 
NULL
;

86 
	`gpio_toggÀ
(
LED_POWER
);

88  
hóπI¡îvÆ
;

89 
	}
}

92 
s32
 
	$ßm∂eLight_bdbNëw‹kSãîSèπ
(*
¨g
)

94 
	`bdb_√tw‹kSãîSèπ
();

97 
	}
}

99 #i‡
FIND_AND_BIND_SUPPORT


100 
s32
 
	$ßm∂eLight_bdbFödAndBödSèπ
(*
¨g
)

102 
	`bdb_födAndBödSèπ
(
BDB_COMMISSIONING_ROLE_TARGET
);

105 
	}
}

119 
	$zbdemo_bdbInôCb
(
u8
 
°©us
, u8 
joöedNëw‹k
)

121 i‡(
°©us
 =
BDB_INIT_STATUS_SUCCESS
)

126 i‡(
joöedNëw‹k
)

128 
hóπI¡îvÆ
 = 1000;

130 #ifde‡
ZCL_OTA


131 
	`Ÿa_quîySèπ
(
OTA_PERIODIC_QUERY_INTERVAL
);

136 
hóπI¡îvÆ
 = 500;

138 #i‡(!
ZBHCI_EN
)

139 
u16
 
jôãr
 = 0;

142 
jôãr
 = 
	`zb_øndom
() % 0x0fff;

143 } 
jôãr
 == 0);

144 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_bdbNëw‹kSãîSèπ
, 
NULL
, 
jôãr
);

150 
hóπI¡îvÆ
 = 200;

153 #i‡
DEBUG_HEART


154 i‡(
hóπTimîEvt
)

156 
	`TL_ZB_TIMER_CANCEL
(&
hóπTimîEvt
);

158 
hóπTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
hóπTimîCb
, 
NULL
, 
hóπI¡îvÆ
);

160 
	}
}

173 
	$zbdemo_bdbCommissi⁄ögCb
(
u8
 
°©us
, *
¨g
)

175 i‡(
°©us
 =
BDB_COMMISSION_STA_SUCCESS
)

177 
hóπI¡îvÆ
 = 1000;

179 #i‡
FIND_AND_BIND_SUPPORT


180 i‡(!
gLightCtx
.
bdbFödBödFlg
)

182 
gLightCtx
.
bdbFödBödFlg
 = 
TRUE
;

185 
	`light_blök_°¨t
(2, 200, 200);

187 #ifde‡
ZCL_OTA


188 
	`Ÿa_quîySèπ
(
OTA_PERIODIC_QUERY_INTERVAL
);

191 #i‡
FIND_AND_BIND_SUPPORT


193 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_bdbFödAndBödSèπ
, 
NULL
, 1000);

197 i‡(
°©us
 =
BDB_COMMISSION_STA_IN_PROGRESS
)

200 i‡(
°©us
 =
BDB_COMMISSION_STA_NOT_AA_CAPABLE
)

203 i‡((
°©us
 =
BDB_COMMISSION_STA_NO_NETWORK
Ë|| (°©u†=
BDB_COMMISSION_STA_TCLK_EX_FAILURE
))

205 
u16
 
jôãr
 = 0;

208 
jôãr
 = 
	`zb_øndom
() % 0x0fff;

209 } 
jôãr
 == 0);

210 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_bdbNëw‹kSãîSèπ
, 
NULL
, 
jôãr
);

212 i‡(
°©us
 =
BDB_COMMISSION_STA_TARGET_FAILURE
)

215 i‡(
°©us
 =
BDB_COMMISSION_STA_FORMATION_FAILURE
)

218 i‡(
°©us
 =
BDB_COMMISSION_STA_NO_IDENTIFY_QUERY_RESPONSE
)

221 i‡(
°©us
 =
BDB_COMMISSION_STA_BINDING_TABLE_FULL
)

224 i‡(
°©us
 =
BDB_COMMISSION_STA_NO_SCAN_RESPONSE
)

227 i‡(
°©us
 =
BDB_COMMISSION_STA_NOT_PERMITTED
)

230 i‡(
°©us
 =
BDB_COMMISSION_STA_REJOIN_FAILURE
)

232 
	`zb_ªjoöReq
(
NLME_REJOIN_METHOD_REJOIN
, 
	`zb_≠sCh™√lMaskGë
());

234 i‡(
°©us
 =
BDB_COMMISSION_STA_FORMATION_DONE
)

236 #i‡
ZBHCI_EN


239 
	`é_zbMacCh™√lSë
(
DEFAULT_CHANNEL
);

244 
	`ßm∂eLight_z˛IdítifyCmdH™dÀr
(
u8
 
ídpoöt
, 
u16
 
§cAddr
, u16 
idítifyTime
);

245 
	`zbdemo_bdbIdítifyCb
(
u8
 
ídpoöt
, 
u16
 
§cAddr
, u16 
idítifyTime
)

247 #i‡
FIND_AND_BIND_SUPPORT


248 
	`ßm∂eLight_z˛IdítifyCmdH™dÀr
(
ídpoöt
, 
§cAddr
, 
idítifyTime
);

252 #ifde‡
ZCL_OTA


253 
	`ßm∂eLight_ŸaPro˚ssMsgH™dÀr
(
u8
 
evt
, u8 
°©us
)

255 i‡(
evt
 =
OTA_EVT_START
)

257 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

264 i‡(
evt
 =
OTA_EVT_COMPLETE
)

266 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

268 
	`Ÿa_mcuReboŸ
();

272 
	`Ÿa_quîySèπ
(
OTA_PERIODIC_QUERY_INTERVAL
);

278 
s32
 
	`ßm∂eLight_so·Re£t
(*
¨g
)

280 
	`SYSTEM_RESET
();

294 
	`ßm∂eLight_ÀaveCnfH™dÀr
(
∆me_Àave_˙f_t
 *
pLóveCnf
)

296 i‡(
pLóveCnf
->
°©us
 =
SUCCESS
)

298 
	`light_blök_°¨t
(3, 200, 200);

301 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_so·Re£t
, 
NULL
, 2 * 1000);

314 
	`ßm∂eLight_ÀaveIndH™dÀr
(
∆me_Àave_öd_t
 *
pLóveInd
)

318 
u8
 
	`ßm∂eLight_nwkUpd©eIndiˇãH™dÀr
(
nwkCmd_nwkUpd©e_t
 *
pNwkUpd©e
)

320  
FAILURE
;

	@apps/sampleLight/zcl_colorCtrlCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

28 
	~"é_comm⁄.h
"

29 
	~"zb_≠i.h
"

30 
	~"z˛_ö˛ude.h
"

31 
	~"ßm∂eLight.h
"

32 
	~"ßm∂eLightCål.h
"

34 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


39 
	#ZCL_COLOR_CHANGE_INTERVAL
 100

	)

46 #i‡
COLOR_RGB_SUPPORT


47 
s32
 
	m°ïHue256
;

48 
u16
 
	mcuºítHue256
;

49 
u16
 
	mhueRemaöögTime
;

51 
s32
 
	m°ïS©uøti⁄256
;

52 
u16
 
	mcuºítS©uøti⁄256
;

53 
u16
 
	mßtuøti⁄RemaöögTime
;

55 #ñi‡
COLOR_CCT_SUPPORT


56 
s32
 
	m°ïCﬁ‹Temp256
;

57 
u32
 
	mcuºítCﬁ‹Temp256
;

58 
u16
 
	mcﬁ‹TempRemaöögTime
;

59 
u16
 
	mcﬁ‹TempMöMúeds
;

60 
u16
 
	mcﬁ‹TempMaxMúeds
;

62 } 
	tz˛_cﬁ‹Info_t
;

67 
z˛_cﬁ‹Info_t
 
	gcﬁ‹Info
 = {

68 #i‡
COLOR_RGB_SUPPORT


69 .
°ïHue256
 = 0,

70 .
	gcuºítHue256
 = 0,

71 .
	ghueRemaöögTime
 = 0,

73 .
	g°ïS©uøti⁄256
 = 0,

74 .
	gcuºítS©uøti⁄256
 = 0,

75 .
	gßtuøti⁄RemaöögTime
 = 0,

77 #ñi‡
COLOR_CCT_SUPPORT


78 .
	g°ïCﬁ‹Temp256
 = 0,

79 .
	gcuºítCﬁ‹Temp256
 = 0,

80 .
	gcﬁ‹TempRemaöögTime
 = 0,

81 .
	gcﬁ‹TempMöMúeds
 = 0,

82 .
	gcﬁ‹TempMaxMúeds
 = 0,

86 
ev_timî_evít_t
 *
	gcﬁ‹TimîEvt
 = 
NULL
;

87 #i‡
COLOR_RGB_SUPPORT


88 
ev_timî_evít_t
 *
	gcﬁ‹Lo›TimîEvt
 = 
NULL
;

94 
ßm∂eLight_upd©eCﬁ‹Mode
(
u8
 
cﬁ‹Mode
);

105 
	$ßm∂eLight_cﬁ‹Inô
()

107 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

109 
	`¥ötf
("[%s:%d] sam∂eLight_cﬁ‹Inô sèπ\r\n", 
__FUNCTION__
, 
__LINE__
);

111 #i‡
COLOR_RGB_SUPPORT


112 
pCﬁ‹
->
cﬁ‹C≠abûôõs
 = 
ZCL_COLOR_CAPABILITIES_BIT_HUE_SATURATION
;

113 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

114 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

116 
cﬁ‹Info
.
cuºítHue256
 = (
u16
)(
pCﬁ‹
->
cuºítHue
) << 8;

117 
cﬁ‹Info
.
cuºítS©uøti⁄256
 = (
u16
)(
pCﬁ‹
->
cuºítS©uøti⁄
) << 8;

119 
cﬁ‹Info
.
hueRemaöögTime
 = 0;

120 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = 0;

122 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítHue
, &
cﬁ‹Info
.
cuºítHue256
, &cﬁ‹Info.
°ïHue256
, &cﬁ‹Info.
hueRemaöögTime
,

123 
ZCL_COLOR_ATTR_HUE_MIN
, 
ZCL_COLOR_ATTR_HUE_MAX
, 
TRUE
);

125 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítS©uøti⁄
, &
cﬁ‹Info
.
cuºítS©uøti⁄256
, &cﬁ‹Info.
°ïS©uøti⁄256
, &cﬁ‹Info.
ßtuøti⁄RemaöögTime
,

126 
ZCL_COLOR_ATTR_SATURATION_MIN
, 
ZCL_COLOR_ATTR_SATURATION_MAX
, 
FALSE
);

127 #ñi‡
COLOR_CCT_SUPPORT


128 
pCﬁ‹
->
cﬁ‹C≠abûôõs
 = 
ZCL_COLOR_CAPABILITIES_BIT_COLOR_TEMPERATURE
;

129 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

130 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

132 
cﬁ‹Info
.
cuºítCﬁ‹Temp256
 = (
u32
)(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
) << 8;

133 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = 0;

135 
	`light_≠∂yUpd©e_16
(&
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, &
cﬁ‹Info
.
cuºítCﬁ‹Temp256
, &cﬁ‹Info.
°ïCﬁ‹Temp256
, &cﬁ‹Info.
cﬁ‹TempRemaöögTime
,

136 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
,ÖCﬁ‹->
cﬁ‹TempPhysiˇlMaxMúeds
, 
FALSE
);

139 
	`¥ötf
("[%s:%d] sam∂eLight_cﬁ‹InôÉnd\r\n", 
__FUNCTION__
, 
__LINE__
);

140 
	}
}

154 
	$ßm∂eLight_upd©eCﬁ‹Mode
(
u8
 
cﬁ‹Mode
)

156 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

158 i‡(
cﬁ‹Mode
 !
pCﬁ‹
->colorMode)

160 i‡(
cﬁ‹Mode
 =
ZCL_COLOR_MODE_CURRENT_X_Y
)

163 i‡(
cﬁ‹Mode
 =
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
)

166 i‡(
cﬁ‹Mode
 =
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
)

170 
	}
}

181 
	$ßm∂eLight_upd©eCﬁ‹
()

183 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

184 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

186 #i‡
COLOR_RGB_SUPPORT


188 
	`LOG
("pCﬁ‹->cuºítHue=%d,pCﬁ‹->cuºítS©uøti⁄=%d,pLevñ->curLevñ=%d\r\n", 
pCﬁ‹
->
cuºítHue
,ÖCﬁ‹->
cuºítS©uøti⁄
, 
pLevñ
->
curLevñ
);

189 
	`hwLight_cﬁ‹Upd©e_HSV2RGB
(
pCﬁ‹
->
cuºítHue
,ÖCﬁ‹->
cuºítS©uøti⁄
, 
pLevñ
->
curLevñ
);

190 #ñi‡
COLOR_CCT_SUPPORT


191 
	`hwLight_cﬁ‹Upd©e_cﬁ‹Tem≥øtuª
(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, 
pLevñ
->
curLevñ
);

193 
	}
}

204 
s32
 
	$ßm∂eLight_cﬁ‹TimîEvtCb
(*
¨g
)

206 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

208 #i‡
COLOR_RGB_SUPPORT


209 i‡((
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 =
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
) ||

210 (
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 =
ZCL_ENHANCED_COLOR_MODE_CURRENT_HUE_SATURATION
))

212 i‡(
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
)

214 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítS©uøti⁄
, &
cﬁ‹Info
.
cuºítS©uøti⁄256
, &cﬁ‹Info.
°ïS©uøti⁄256
, &cﬁ‹Info.
ßtuøti⁄RemaöögTime
,

215 
ZCL_COLOR_ATTR_SATURATION_MIN
, 
ZCL_COLOR_ATTR_SATURATION_MAX
, 
FALSE
);

218 i‡(
cﬁ‹Info
.
hueRemaöögTime
)

220 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítHue
, &
cﬁ‹Info
.
cuºítHue256
, &cﬁ‹Info.
°ïHue256
, &cﬁ‹Info.
hueRemaöögTime
,

221 
ZCL_COLOR_ATTR_HUE_MIN
, 
ZCL_COLOR_ATTR_HUE_MAX
, 
TRUE
);

224 #ñi‡
COLOR_CCT_SUPPORT


225 i‡(
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 =
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
)

227 i‡(
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
)

229 
	`light_≠∂yUpd©e_16
(&
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, &
cﬁ‹Info
.
cuºítCﬁ‹Temp256
, &cﬁ‹Info.
°ïCﬁ‹Temp256
, &cﬁ‹Info.
cﬁ‹TempRemaöögTime
,

230 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
, cﬁ‹Info.
cﬁ‹TempMaxMúeds
, 
FALSE
);

235 #i‡
COLOR_RGB_SUPPORT


236 i‡(
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 || cﬁ‹Info.
hueRemaöögTime
)

238 #ñi‡
COLOR_CCT_SUPPORT


239 i‡(
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
)

246 
cﬁ‹TimîEvt
 = 
NULL
;

249 
	}
}

260 
	$ßm∂eLight_cﬁ‹TimîSt›
()

262 i‡(
cﬁ‹TimîEvt
)

264 
	`TL_ZB_TIMER_CANCEL
(&
cﬁ‹TimîEvt
);

266 
	}
}

268 #i‡
COLOR_RGB_SUPPORT


278 
s32
 
	$ßm∂eLight_cﬁ‹Lo›TimîEvtCb
(*
¨g
)

280 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

282 i‡(
pCﬁ‹
->
cﬁ‹Lo›A˘ive
)

287 
cﬁ‹Lo›TimîEvt
 = 
NULL
;

292 
	}
}

303 
	$ßm∂eLight_cﬁ‹Lo›TimîSt›
()

305 i‡(
cﬁ‹Lo›TimîEvt
)

307 
	`TL_ZB_TIMER_CANCEL
(&
cﬁ‹Lo›TimîEvt
);

309 
	}
}

320 
	$ßm∂eLight_moveToHuePro˚ss
(
z˛_cﬁ‹CålMoveToHueCmd_t
 *
cmd
)

322 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

324 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

326 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

327 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

329 
cﬁ‹Info
.
cuºítHue256
 = (
u16
)(
pCﬁ‹
->
cuºítHue
) << 8;

331 
s16
 
hueDiff
 = (s16)
cmd
->
hue
 - 
pCﬁ‹
->
cuºítHue
;

333 
cmd
->
dúe˘i⁄
)

335 
COLOR_CTRL_DIRECTION_SHORTEST_DISTANCE
:

336 i‡(
hueDiff
 > (
ZCL_COLOR_ATTR_HUE_MAX
 / 2))

338 
hueDiff
 -(
ZCL_COLOR_ATTR_HUE_MAX
 + 1);

340 i‡(
hueDiff
 < -
ZCL_COLOR_ATTR_HUE_MAX
 / 2)

342 
hueDiff
 +(
ZCL_COLOR_ATTR_HUE_MAX
 + 1);

345 
COLOR_CTRL_DIRECTION_LONGEST_DISTANCE
:

346 i‡((
hueDiff
 > 0Ë&& (hueDif‡< (
ZCL_COLOR_ATTR_HUE_MAX
 / 2)))

348 
hueDiff
 -(
ZCL_COLOR_ATTR_HUE_MAX
 + 1);

350 i‡((
hueDiff
 < 0Ë&& (hueDif‡> -
ZCL_COLOR_ATTR_HUE_MAX
 / 2))

352 
hueDiff
 +(
ZCL_COLOR_ATTR_HUE_MAX
 + 1);

355 
COLOR_CTRL_DIRECTION_UP
:

356 i‡(
hueDiff
 < 0)

358 
hueDiff
 +
ZCL_COLOR_ATTR_HUE_MAX
;

361 
COLOR_CTRL_DIRECTION_DOWN
:

362 i‡(
hueDiff
 > 0)

364 
hueDiff
 -
ZCL_COLOR_ATTR_HUE_MAX
;

371 
cﬁ‹Info
.
hueRemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

372 
cﬁ‹Info
.
°ïHue256
 = ((
s32
)
hueDiff
) << 8;

373 
cﬁ‹Info
.
°ïHue256
 /(
s32
)cﬁ‹Info.
hueRemaöögTime
;

375 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítHue
, &
cﬁ‹Info
.
cuºítHue256
, &cﬁ‹Info.
°ïHue256
, &cﬁ‹Info.
hueRemaöögTime
,

376 
ZCL_COLOR_ATTR_HUE_MIN
, 
ZCL_COLOR_ATTR_HUE_MAX
, 
TRUE
);

378 i‡(
cﬁ‹Info
.
hueRemaöögTime
)

380 
	`ßm∂eLight_cﬁ‹TimîSt›
();

381 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

385 
	`ßm∂eLight_cﬁ‹TimîSt›
();

387 
	}
}

398 
	$ßm∂eLight_moveHuePro˚ss
(
z˛_cﬁ‹CålMoveHueCmd_t
 *
cmd
)

400 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

402 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

404 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

405 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

407 
cﬁ‹Info
.
cuºítHue256
 = (
u16
)(
pCﬁ‹
->
cuºítHue
) << 8;

409 
cmd
->
moveMode
)

411 
COLOR_CTRL_MOVE_STOP
:

412 
cﬁ‹Info
.
°ïHue256
 = 0;

413 
cﬁ‹Info
.
hueRemaöögTime
 = 0;

415 
COLOR_CTRL_MOVE_UP
:

416 
cﬁ‹Info
.
°ïHue256
 = (((
s32
)
cmd
->
øã
) << 8) / 10;

417 
cﬁ‹Info
.
hueRemaöögTime
 = 0xFFFF;

419 
COLOR_CTRL_MOVE_DOWN
:

420 
cﬁ‹Info
.
°ïHue256
 = ((-(
s32
)
cmd
->
øã
) << 8) / 10;

421 
cﬁ‹Info
.
hueRemaöögTime
 = 0xFFFF;

427 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítHue
, &
cﬁ‹Info
.
cuºítHue256
, &cﬁ‹Info.
°ïHue256
, &cﬁ‹Info.
hueRemaöögTime
,

428 
ZCL_COLOR_ATTR_HUE_MIN
, 
ZCL_COLOR_ATTR_HUE_MAX
, 
TRUE
);

430 i‡(
cﬁ‹Info
.
hueRemaöögTime
)

432 
	`ßm∂eLight_cﬁ‹TimîSt›
();

433 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

437 
	`ßm∂eLight_cﬁ‹TimîSt›
();

439 
	}
}

450 
	$ßm∂eLight_°ïHuePro˚ss
(
z˛_cﬁ‹CålSãpHueCmd_t
 *
cmd
)

452 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

454 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

456 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

457 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

459 
cﬁ‹Info
.
cuºítHue256
 = (
u16
)(
pCﬁ‹
->
cuºítHue
) << 8;

461 
cﬁ‹Info
.
hueRemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

463 
cﬁ‹Info
.
°ïHue256
 = (((
s32
)
cmd
->
°ïSize
Ë<< 8Ë/ cﬁ‹Info.
hueRemaöögTime
;

465 
cmd
->
°ïMode
)

467 
COLOR_CTRL_STEP_MODE_UP
:

469 
COLOR_CTRL_STEP_MODE_DOWN
:

470 
cﬁ‹Info
.
°ïHue256
 = -colorInfo.stepHue256;

476 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítHue
, &
cﬁ‹Info
.
cuºítHue256
, &cﬁ‹Info.
°ïHue256
, &cﬁ‹Info.
hueRemaöögTime
,

477 
ZCL_COLOR_ATTR_HUE_MIN
, 
ZCL_COLOR_ATTR_HUE_MAX
, 
TRUE
);

479 i‡(
cﬁ‹Info
.
hueRemaöögTime
)

481 
	`ßm∂eLight_cﬁ‹TimîSt›
();

482 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

486 
	`ßm∂eLight_cﬁ‹TimîSt›
();

488 
	}
}

499 
	$ßm∂eLight_moveToS©uøti⁄Pro˚ss
(
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 *
cmd
)

501 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

503 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

505 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

506 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

508 
cﬁ‹Info
.
cuºítS©uøti⁄256
 = (
u16
)(
pCﬁ‹
->
cuºítS©uøti⁄
) << 8;

510 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

512 
cﬁ‹Info
.
°ïS©uøti⁄256
 = ((
s32
)(
cmd
->
ßtuøti⁄
 - 
pCﬁ‹
->
cuºítS©uøti⁄
)) << 8;

513 
cﬁ‹Info
.
°ïS©uøti⁄256
 /(
s32
)cﬁ‹Info.
ßtuøti⁄RemaöögTime
;

515 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítS©uøti⁄
, &
cﬁ‹Info
.
cuºítS©uøti⁄256
, &cﬁ‹Info.
°ïS©uøti⁄256
, &cﬁ‹Info.
ßtuøti⁄RemaöögTime
,

516 
ZCL_COLOR_ATTR_SATURATION_MIN
, 
ZCL_COLOR_ATTR_SATURATION_MAX
, 
FALSE
);

518 i‡(
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
)

520 
	`ßm∂eLight_cﬁ‹TimîSt›
();

521 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

525 
	`ßm∂eLight_cﬁ‹TimîSt›
();

527 
	}
}

538 
	$ßm∂eLight_moveS©uøti⁄Pro˚ss
(
z˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
 *
cmd
)

540 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

542 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

544 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

545 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

547 
cﬁ‹Info
.
cuºítS©uøti⁄256
 = (
u16
)(
pCﬁ‹
->
cuºítS©uøti⁄
) << 8;

549 
cmd
->
moveMode
)

551 
COLOR_CTRL_MOVE_STOP
:

552 
cﬁ‹Info
.
°ïS©uøti⁄256
 = 0;

553 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = 0;

555 
COLOR_CTRL_MOVE_UP
:

556 
cﬁ‹Info
.
°ïS©uøti⁄256
 = (((
s32
)
cmd
->
øã
) << 8) / 10;

557 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = 0xFFFF;

559 
COLOR_CTRL_MOVE_DOWN
:

560 
cﬁ‹Info
.
°ïS©uøti⁄256
 = ((-(
s32
)
cmd
->
øã
) << 8) / 10;

561 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = 0xFFFF;

567 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítS©uøti⁄
, &
cﬁ‹Info
.
cuºítS©uøti⁄256
, &cﬁ‹Info.
°ïS©uøti⁄256
, &cﬁ‹Info.
ßtuøti⁄RemaöögTime
,

568 
ZCL_COLOR_ATTR_SATURATION_MIN
, 
ZCL_COLOR_ATTR_SATURATION_MAX
, 
FALSE
);

570 i‡(
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
)

572 
	`ßm∂eLight_cﬁ‹TimîSt›
();

573 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

577 
	`ßm∂eLight_cﬁ‹TimîSt›
();

579 
	}
}

590 
	$ßm∂eLight_°ïS©uøti⁄Pro˚ss
(
z˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
 *
cmd
)

592 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

594 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

596 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

597 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

599 
cﬁ‹Info
.
cuºítS©uøti⁄256
 = (
u16
)(
pCﬁ‹
->
cuºítS©uøti⁄
) << 8;

601 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

603 
cﬁ‹Info
.
°ïS©uøti⁄256
 = (((
s32
)
cmd
->
°ïSize
Ë<< 8Ë/ cﬁ‹Info.
ßtuøti⁄RemaöögTime
;

605 
cmd
->
°ïMode
)

607 
COLOR_CTRL_STEP_MODE_UP
:

609 
COLOR_CTRL_STEP_MODE_DOWN
:

610 
cﬁ‹Info
.
°ïS©uøti⁄256
 = -colorInfo.stepSaturation256;

616 
	`light_≠∂yUpd©e
(&
pCﬁ‹
->
cuºítS©uøti⁄
, &
cﬁ‹Info
.
cuºítS©uøti⁄256
, &cﬁ‹Info.
°ïS©uøti⁄256
, &cﬁ‹Info.
ßtuøti⁄RemaöögTime
,

617 
ZCL_COLOR_ATTR_SATURATION_MIN
, 
ZCL_COLOR_ATTR_SATURATION_MAX
, 
FALSE
);

619 i‡(
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
)

621 
	`ßm∂eLight_cﬁ‹TimîSt›
();

622 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

626 
	`ßm∂eLight_cﬁ‹TimîSt›
();

628 
	}
}

639 
	$ßm∂eLight_moveToHueAndS©uøti⁄Pro˚ss
(
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 *
cmd
)

641 
z˛_cﬁ‹CålMoveToHueCmd_t
 
moveToHueCmd
;

642 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 
moveToS©uøti⁄Cmd
;

644 
moveToHueCmd
.
hue
 = 
cmd
->hue;

645 
moveToHueCmd
.
dúe˘i⁄
 = 
COLOR_CTRL_DIRECTION_SHORTEST_DISTANCE
;

646 
moveToHueCmd
.
å™sôi⁄Time
 = 
cmd
->transitionTime;

648 
moveToS©uøti⁄Cmd
.
ßtuøti⁄
 = 
cmd
->saturation;

649 
moveToS©uøti⁄Cmd
.
å™sôi⁄Time
 = 
cmd
->transitionTime;

651 
	`ßm∂eLight_moveToHuePro˚ss
(&
moveToHueCmd
);

652 
	`ßm∂eLight_moveToS©uøti⁄Pro˚ss
(&
moveToS©uøti⁄Cmd
);

653 
	}
}

664 
	$ßm∂eLight_moveToCﬁ‹Pro˚ss
(
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 *
cmd
)

666 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

668 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_X_Y
);

670 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

671 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

672 
	}
}

683 
	$ßm∂eLight_moveCﬁ‹Pro˚ss
(
z˛_cﬁ‹CålMoveCﬁ‹Cmd_t
 *
cmd
)

685 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

687 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_X_Y
);

689 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

690 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

691 
	}
}

702 
	$ßm∂eLight_°ïCﬁ‹Pro˚ss
(
z˛_cﬁ‹CålSãpCﬁ‹Cmd_t
 *
cmd
)

704 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

706 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_X_Y
);

708 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

709 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
;

710 
	}
}

721 
	$ßm∂eLight_íh™˚dMoveToHuePro˚ss
(
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 *
cmd
)

723 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

725 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

727 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

728 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_ENHANCED_COLOR_MODE_CURRENT_HUE_SATURATION
;

730 
cmd
->
dúe˘i⁄
)

732 
COLOR_CTRL_DIRECTION_SHORTEST_DISTANCE
:

734 
COLOR_CTRL_DIRECTION_LONGEST_DISTANCE
:

736 
COLOR_CTRL_DIRECTION_UP
:

738 
COLOR_CTRL_DIRECTION_DOWN
:

743 
	}
}

754 
	$ßm∂eLight_íh™˚dMoveHuePro˚ss
(
z˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
 *
cmd
)

756 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

758 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

760 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

761 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_ENHANCED_COLOR_MODE_CURRENT_HUE_SATURATION
;

763 
cmd
->
moveMode
)

765 
COLOR_CTRL_MOVE_STOP
:

767 
COLOR_CTRL_MOVE_UP
:

769 
COLOR_CTRL_MOVE_DOWN
:

774 
	}
}

785 
	$ßm∂eLight_íh™˚dSãpHuePro˚ss
(
z˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
 *
cmd
)

787 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

789 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
);

791 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
;

792 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_ENHANCED_COLOR_MODE_CURRENT_HUE_SATURATION
;

794 
cmd
->
°ïMode
)

796 
COLOR_CTRL_STEP_MODE_UP
:

798 
COLOR_CTRL_STEP_MODE_DOWN
:

803 
	}
}

814 
	$ßm∂eLight_íh™˚dMoveToHueAndS©uøti⁄Pro˚ss
(
z˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
 *
cmd
)

816 
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 
íh™˚dMoveToHueCmd
;

817 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 
moveToS©uøti⁄Cmd
;

819 
íh™˚dMoveToHueCmd
.
íh™˚dHue
 = 
cmd
->enhancedHue;

820 
íh™˚dMoveToHueCmd
.
dúe˘i⁄
 = 
COLOR_CTRL_DIRECTION_SHORTEST_DISTANCE
;

821 
íh™˚dMoveToHueCmd
.
å™sôi⁄Time
 = 
cmd
->transitionTime;

823 
moveToS©uøti⁄Cmd
.
ßtuøti⁄
 = 
cmd
->saturation;

824 
moveToS©uøti⁄Cmd
.
å™sôi⁄Time
 = 
cmd
->transitionTime;

826 
	`ßm∂eLight_íh™˚dMoveToHuePro˚ss
(&
íh™˚dMoveToHueCmd
);

827 
	`ßm∂eLight_moveToS©uøti⁄Pro˚ss
(&
moveToS©uøti⁄Cmd
);

828 
	}
}

839 
	$ßm∂eLight_cﬁ‹Lo›SëPro˚ss
(
z˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
 *
cmd
)

841 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

843 i‡(
cmd
->
upd©eFœgs
.
bôs
.
dúe˘i⁄
)

845 
pCﬁ‹
->
cﬁ‹Lo›Dúe˘i⁄
 = 
cmd
->
dúe˘i⁄
;

848 i‡(
cmd
->
upd©eFœgs
.
bôs
.
time
)

850 
pCﬁ‹
->
cﬁ‹Lo›Time
 = 
cmd
->
time
;

853 i‡(
cmd
->
upd©eFœgs
.
bôs
.
°¨tHue
)

855 
pCﬁ‹
->
cﬁ‹Lo›SèπEnh™˚dHue
 = 
cmd
->
°¨tHue
;

858 i‡(
cmd
->
upd©eFœgs
.
bôs
.
a˘i⁄
)

860 
cmd
->
a˘i⁄
)

862 
COLOR_LOOP_SET_DEACTION
:

864 
COLOR_LOOP_SET_ACTION_FROM_COLOR_LOOP_START_ENHANCED_HUE
:

866 
COLOR_LOOP_SET_ACTION_FROM_ENHANCED_CURRENT_HUE
:

872 
	}
}

874 #ñi‡
COLOR_CCT_SUPPORT


885 
	$ßm∂eLight_moveToCﬁ‹Tem≥øtuªPro˚ss
(
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 *
cmd
)

887 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

889 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
);

891 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

892 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

894 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
;

895 
cﬁ‹Info
.
cﬁ‹TempMaxMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMaxMúeds
;

897 
cﬁ‹Info
.
cuºítCﬁ‹Temp256
 = (
u32
)(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
) << 8;

899 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

901 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = ((
s32
)(
cmd
->
cﬁ‹Tem≥øtuª
 - 
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
)) << 8;

902 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 /(
s32
)cﬁ‹Info.
cﬁ‹TempRemaöögTime
;

904 
	`light_≠∂yUpd©e_16
(&
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, &
cﬁ‹Info
.
cuºítCﬁ‹Temp256
, &cﬁ‹Info.
°ïCﬁ‹Temp256
, &cﬁ‹Info.
cﬁ‹TempRemaöögTime
,

905 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
, cﬁ‹Info.
cﬁ‹TempMaxMúeds
, 
FALSE
);

907 i‡(
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
)

909 
	`ßm∂eLight_cﬁ‹TimîSt›
();

910 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

914 
	`ßm∂eLight_cﬁ‹TimîSt›
();

916 
	}
}

927 
	$ßm∂eLight_moveCﬁ‹Tem≥øtuªPro˚ss
(
z˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
 *
cmd
)

929 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

931 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
);

933 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

934 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

936 i‡(
cmd
->
cﬁ‹TempMöMúeds
)

938 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
 = (
cmd
->cﬁ‹TempMöMúed†< 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
) ?ÖColor->colorTempPhysicalMinMireds

939 : 
cmd
->
cﬁ‹TempMöMúeds
;

943 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
;

946 i‡(
cmd
->
cﬁ‹TempMaxMúeds
)

948 
cﬁ‹Info
.
cﬁ‹TempMaxMúeds
 = (
cmd
->cﬁ‹TempMaxMúed†> 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMaxMúeds
) ?ÖColor->colorTempPhysicalMaxMireds

949 : 
cmd
->
cﬁ‹TempMaxMúeds
;

953 
cﬁ‹Info
.
cﬁ‹TempMaxMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMaxMúeds
;

956 
cﬁ‹Info
.
cuºítCﬁ‹Temp256
 = (
u32
)(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
) << 8;

958 
cmd
->
moveMode
)

960 
COLOR_CTRL_MOVE_STOP
:

961 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = 0;

962 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = 0;

964 
COLOR_CTRL_MOVE_UP
:

965 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = (((
s32
)
cmd
->
øã
) << 8) / 10;

966 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = 0xFFFF;

968 
COLOR_CTRL_MOVE_DOWN
:

969 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = ((-(
s32
)
cmd
->
øã
) << 8) / 10;

970 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = 0xFFFF;

976 
	`light_≠∂yUpd©e_16
(&
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, &
cﬁ‹Info
.
cuºítCﬁ‹Temp256
, &cﬁ‹Info.
°ïCﬁ‹Temp256
, &cﬁ‹Info.
cﬁ‹TempRemaöögTime
,

977 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
, cﬁ‹Info.
cﬁ‹TempMaxMúeds
, 
FALSE
);

979 i‡(
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
)

981 
	`ßm∂eLight_cﬁ‹TimîSt›
();

982 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

986 
	`ßm∂eLight_cﬁ‹TimîSt›
();

988 
	}
}

999 
	$ßm∂eLight_°ïCﬁ‹Tem≥øtuªPro˚ss
(
z˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
 *
cmd
)

1001 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

1003 
	`ßm∂eLight_upd©eCﬁ‹Mode
(
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
);

1005 
pCﬁ‹
->
cﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

1006 
pCﬁ‹
->
íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
;

1008 i‡(
cmd
->
cﬁ‹TempMöMúeds
)

1010 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
 = (
cmd
->cﬁ‹TempMöMúed†< 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
) ?ÖColor->colorTempPhysicalMinMireds

1011 : 
cmd
->
cﬁ‹TempMöMúeds
;

1015 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMöMúeds
;

1018 i‡(
cmd
->
cﬁ‹TempMaxMúeds
)

1020 
cﬁ‹Info
.
cﬁ‹TempMaxMúeds
 = (
cmd
->cﬁ‹TempMaxMúed†> 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMaxMúeds
) ?ÖColor->colorTempPhysicalMaxMireds

1021 : 
cmd
->
cﬁ‹TempMaxMúeds
;

1025 
cﬁ‹Info
.
cﬁ‹TempMaxMúeds
 = 
pCﬁ‹
->
cﬁ‹TempPhysiˇlMaxMúeds
;

1028 
cﬁ‹Info
.
cuºítCﬁ‹Temp256
 = (
u32
)(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
) << 8;

1030 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = (
cmd
->
å™sôi⁄Time
 == 0) ? 1 : cmd->transitionTime;

1032 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = (((
s32
)
cmd
->
°ïSize
Ë<< 8Ë/ cﬁ‹Info.
cﬁ‹TempRemaöögTime
;

1034 
cmd
->
°ïMode
)

1036 
COLOR_CTRL_STEP_MODE_UP
:

1038 
COLOR_CTRL_STEP_MODE_DOWN
:

1039 
cﬁ‹Info
.
°ïCﬁ‹Temp256
 = -colorInfo.stepColorTemp256;

1045 
	`light_≠∂yUpd©e_16
(&
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
, &
cﬁ‹Info
.
cuºítCﬁ‹Temp256
, &cﬁ‹Info.
°ïCﬁ‹Temp256
, &cﬁ‹Info.
cﬁ‹TempRemaöögTime
,

1046 
cﬁ‹Info
.
cﬁ‹TempMöMúeds
, cﬁ‹Info.
cﬁ‹TempMaxMúeds
, 
FALSE
);

1048 i‡(
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
)

1050 
	`ßm∂eLight_cﬁ‹TimîSt›
();

1051 
cﬁ‹TimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_cﬁ‹TimîEvtCb
, 
NULL
, 
ZCL_COLOR_CHANGE_INTERVAL
);

1055 
	`ßm∂eLight_cﬁ‹TimîSt›
();

1057 
	}
}

1070 
	$ßm∂eLight_°›MoveSãpPro˚ss
()

1074 #i‡
COLOR_RGB_SUPPORT


1075 
cﬁ‹Info
.
hueRemaöögTime
 = 0;

1076 
cﬁ‹Info
.
ßtuøti⁄RemaöögTime
 = 0;

1077 #ñi‡
COLOR_CCT_SUPPORT


1078 
cﬁ‹Info
.
cﬁ‹TempRemaöögTime
 = 0;

1081 
	`ßm∂eLight_cﬁ‹TimîSt›
();

1082 
	}
}

1095 
°©us_t
 
	$ßm∂eLight_cﬁ‹CålCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

1097 i‡(
pAddrInfo
->
d°Ep
 =
SAMPLE_LIGHT_ENDPOINT
)

1099 
cmdId
)

1101 #i‡
COLOR_RGB_SUPPORT


1102 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE
:

1103 
	`ßm∂eLight_moveToHuePro˚ss
((
z˛_cﬁ‹CålMoveToHueCmd_t
 *)
cmdPaylﬂd
);

1105 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_HUE
:

1106 
	`ßm∂eLight_moveHuePro˚ss
((
z˛_cﬁ‹CålMoveHueCmd_t
 *)
cmdPaylﬂd
);

1108 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_HUE
:

1109 
	`ßm∂eLight_°ïHuePro˚ss
((
z˛_cﬁ‹CålSãpHueCmd_t
 *)
cmdPaylﬂd
);

1111 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_SATURATION
:

1112 
	`ßm∂eLight_moveToS©uøti⁄Pro˚ss
((
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 *)
cmdPaylﬂd
);

1114 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_SATURATION
:

1115 
	`ßm∂eLight_moveS©uøti⁄Pro˚ss
((
z˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
 *)
cmdPaylﬂd
);

1117 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_SATURATION
:

1118 
	`ßm∂eLight_°ïS©uøti⁄Pro˚ss
((
z˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
 *)
cmdPaylﬂd
);

1120 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION
:

1121 
	`ßm∂eLight_moveToHueAndS©uøti⁄Pro˚ss
((
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 *)
cmdPaylﬂd
);

1123 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR
:

1124 
	`ßm∂eLight_moveToCﬁ‹Pro˚ss
((
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 *)
cmdPaylﬂd
);

1126 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR
:

1127 
	`ßm∂eLight_moveCﬁ‹Pro˚ss
((
z˛_cﬁ‹CålMoveCﬁ‹Cmd_t
 *)
cmdPaylﬂd
);

1129 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR
:

1130 
	`ßm∂eLight_°ïCﬁ‹Pro˚ss
((
z˛_cﬁ‹CålSãpCﬁ‹Cmd_t
 *)
cmdPaylﬂd
);

1132 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE
:

1133 
	`ßm∂eLight_íh™˚dMoveToHuePro˚ss
((
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 *)
cmdPaylﬂd
);

1135 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_HUE
:

1136 
	`ßm∂eLight_íh™˚dMoveHuePro˚ss
((
z˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
 *)
cmdPaylﬂd
);

1138 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_STEP_HUE
:

1139 
	`ßm∂eLight_íh™˚dSãpHuePro˚ss
((
z˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
 *)
cmdPaylﬂd
);

1141 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE_AND_SATURATION
:

1142 
	`ßm∂eLight_íh™˚dMoveToHueAndS©uøti⁄Pro˚ss
((
z˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
 *)
cmdPaylﬂd
);

1144 
ZCL_CMD_LIGHT_COLOR_CONTROL_COLOR_LOOP_SET
:

1145 
	`ßm∂eLight_cﬁ‹Lo›SëPro˚ss
((
z˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
 *)
cmdPaylﬂd
);

1147 #ñi‡
COLOR_CCT_SUPPORT


1148 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR_TEMPERATURE
:

1149 
	`ßm∂eLight_moveToCﬁ‹Tem≥øtuªPro˚ss
((
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 *)
cmdPaylﬂd
);

1151 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR_TEMPERATURE
:

1152 
	`ßm∂eLight_moveCﬁ‹Tem≥øtuªPro˚ss
((
z˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
 *)
cmdPaylﬂd
);

1154 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR_TEMPERATURE
:

1155 
	`ßm∂eLight_°ïCﬁ‹Tem≥øtuªPro˚ss
((
z˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
 *)
cmdPaylﬂd
);

1158 
ZCL_CMD_LIGHT_COLOR_CONTROL_STOP_MOVE_STEP
:

1159 
	`ßm∂eLight_°›MoveSãpPro˚ss
();

1166  
ZCL_STA_SUCCESS
;

1167 
	}
}

	@apps/sampleLight/zcl_levelCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

28 
	~"é_comm⁄.h
"

29 
	~"zb_≠i.h
"

30 
	~"z˛_ö˛ude.h
"

31 
	~"ßm∂eLight.h
"

32 
	~"ßm∂eLightCål.h
"

34 #ifde‡
ZCL_LEVEL_CTRL


39 
	#ZCL_LEVEL_CHANGE_INTERVAL
 100

	)

45 
s32
 
	m°ïLevñ256
;

46 
u16
 
	mcuºítLevñ256
;

47 
u8
 
	mwôhOnOff
;

48 }
	tz˛_ÀvñInfo_t
;

53 
z˛_ÀvñInfo_t
 
	gÀvñInfo
 = {

54 .
°ïLevñ256
 = 0,

55 .
	gcuºítLevñ256
 = 0,

56 .
	gwôhOnOff
 = 0,

59 
ev_timî_evít_t
 *
	gÀvñTimîEvt
 = 
NULL
;

74 
	$ßm∂eLight_ÀvñInô
()

76 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

78 
pLevñ
->
ªmaöögTime
 = 0;

80 
ÀvñInfo
.
cuºítLevñ256
 = (
u16
)(
pLevñ
->
curLevñ
) << 8;

82 
	`¥ötf
("[%s:%d]ÜevñInfo.°ïLevñ256=%d,ÀvñInfo.cuºítLevñ256=%d,ÀvñInfo.wôhOnOff=%d\r\n", 
__FUNCTION__
, 
__LINE__
, 
ÀvñInfo
.
cuºítLevñ256
,ÀvñInfo.cuºítLevñ256,ÀvñInfo.
wôhOnOff
);

84 
	`light_≠∂yUpd©e
(&
pLevñ
->
curLevñ
, &
ÀvñInfo
.
cuºítLevñ256
, &ÀvñInfo.
°ïLevñ256
, &pLevñ->
ªmaöögTime
,

85 
ZCL_LEVEL_ATTR_MIN_LEVEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
, 
FALSE
);

86 
	}
}

97 
	$ßm∂eLight_upd©eLevñ
()

99 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

101 
	`hwLight_ÀvñUpd©e
(
pLevñ
->
curLevñ
);

102 
	}
}

113 
s32
 
	$ßm∂eLight_ÀvñTimîEvtCb
(* 
¨g
)

115 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

117 if(
pLevñ
->
ªmaöögTime
){

118 
	`light_≠∂yUpd©e
(&
pLevñ
->
curLevñ
, &
ÀvñInfo
.
cuºítLevñ256
, &ÀvñInfo.
°ïLevñ256
, &pLevñ->
ªmaöögTime
,

119 
ZCL_LEVEL_ATTR_MIN_LEVEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
, 
FALSE
);

122 if(
ÀvñInfo
.
wôhOnOff
){

123 if(
pLevñ
->
curLevñ
 =
ZCL_LEVEL_ATTR_MIN_LEVEL
){

124 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

128 if(
pLevñ
->
ªmaöögTime
){

131 
ÀvñTimîEvt
 = 
NULL
;

134 
	}
}

145 
	$ßm∂eLight_LevñTimîSt›
()

147 if(
ÀvñTimîEvt
){

148 
	`TL_ZB_TIMER_CANCEL
(&
ÀvñTimîEvt
);

150 
	}
}

162 
	$ßm∂eLight_moveToLevñPro˚ss
(
u8
 
cmdId
, 
moveToLvl_t
 *
cmd
)

164 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

166 
pLevñ
->
ªmaöögTime
 = ((
cmd
->
å™sôi⁄Time
 == 0) || (cmd->transitionTime == 0xFFFF)) ? 1 : cmd->transitionTime;

168 
ÀvñInfo
.
wôhOnOff
 = (
cmdId
 =
ZCL_CMD_LEVEL_MOVE_TO_LEVEL_WITH_ON_OFF
Ë? 
TRUE
 : 
FALSE
;

169 
ÀvñInfo
.
cuºítLevñ256
 = (
u16
)(
pLevñ
->
curLevñ
) << 8;

170 
ÀvñInfo
.
°ïLevñ256
 = ((
s32
)(
cmd
->
Àvñ
 - 
pLevñ
->
curLevñ
)) << 8;

171 
ÀvñInfo
.
°ïLevñ256
 /(
s32
)
pLevñ
->
ªmaöögTime
;

173 
	`light_≠∂yUpd©e
(&
pLevñ
->
curLevñ
, &
ÀvñInfo
.
cuºítLevñ256
, &ÀvñInfo.
°ïLevñ256
, &pLevñ->
ªmaöögTime
,

174 
ZCL_LEVEL_ATTR_MIN_LEVEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
, 
FALSE
);

176 if(
ÀvñInfo
.
wôhOnOff
){

177 if(
ÀvñInfo
.
°ïLevñ256
 > 0){

178 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_ON
);

179 }if(
pLevñ
->
curLevñ
 =
ZCL_LEVEL_ATTR_MIN_LEVEL
){

180 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

184 if(
pLevñ
->
ªmaöögTime
){

185 
	`ßm∂eLight_LevñTimîSt›
();

186 
ÀvñTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_ÀvñTimîEvtCb
, 
NULL
, 
ZCL_LEVEL_CHANGE_INTERVAL
);

188 
	`ßm∂eLight_LevñTimîSt›
();

190 
	}
}

202 
	$ßm∂eLight_movePro˚ss
(
u8
 
cmdId
, 
move_t
 *
cmd
)

204 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

206 
ÀvñInfo
.
wôhOnOff
 = (
cmdId
 =
ZCL_CMD_LEVEL_MOVE_WITH_ON_OFF
Ë? 
TRUE
 : 
FALSE
;

207 
ÀvñInfo
.
cuºítLevñ256
 = (
u16
)(
pLevñ
->
curLevñ
) << 8;

209 
u32
 
øã
 = (u32)
cmd
->rate * 100;

210 
u8
 
√wLevñ
;

211 
u8
 
dñèLevñ
;

212 if(
cmd
->
moveMode
 =
LEVEL_MOVE_UP
){

213 
√wLevñ
 = 
ZCL_LEVEL_ATTR_MAX_LEVEL
;

214 
dñèLevñ
 = 
ZCL_LEVEL_ATTR_MAX_LEVEL
 - 
pLevñ
->
curLevñ
;

216 
√wLevñ
 = 
ZCL_LEVEL_ATTR_MIN_LEVEL
;

217 
dñèLevñ
 = 
pLevñ
->
curLevñ
 - 
ZCL_LEVEL_ATTR_MIN_LEVEL
;

219 
pLevñ
->
ªmaöögTime
 = ((
u32
)
dñèLevñ
 * 1000Ë/ 
øã
;

220 if(
pLevñ
->
ªmaöögTime
 == 0){

221 
pLevñ
->
ªmaöögTime
 = 1;

224 
ÀvñInfo
.
°ïLevñ256
 = ((
s32
)(
√wLevñ
 - 
pLevñ
->
curLevñ
)) << 8;

225 
ÀvñInfo
.
°ïLevñ256
 /(
s32
)
pLevñ
->
ªmaöögTime
;

227 if(
cmd
->
moveMode
 =
LEVEL_MOVE_UP
){

228 if(
ÀvñInfo
.
wôhOnOff
){

229 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_ON
);

233 
	`light_≠∂yUpd©e
(&
pLevñ
->
curLevñ
, &
ÀvñInfo
.
cuºítLevñ256
, &ÀvñInfo.
°ïLevñ256
, &pLevñ->
ªmaöögTime
,

234 
ZCL_LEVEL_ATTR_MIN_LEVEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
, 
FALSE
);

236 if(
ÀvñInfo
.
wôhOnOff
){

237 if(
pLevñ
->
curLevñ
 =
ZCL_LEVEL_ATTR_MIN_LEVEL
){

238 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

242 if(
pLevñ
->
ªmaöögTime
){

243 
	`ßm∂eLight_LevñTimîSt›
();

244 
ÀvñTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_ÀvñTimîEvtCb
, 
NULL
, 
ZCL_LEVEL_CHANGE_INTERVAL
);

246 
	`ßm∂eLight_LevñTimîSt›
();

248 
	}
}

260 
	$ßm∂eLight_°ïPro˚ss
(
u8
 
cmdId
, 
°ï_t
 *
cmd
)

262 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

264 
pLevñ
->
ªmaöögTime
 = ((
cmd
->
å™sôi⁄Time
 == 0) || (cmd->transitionTime == 0xFFFF)) ? 1 : cmd->transitionTime;

266 
ÀvñInfo
.
wôhOnOff
 = (
cmdId
 =
ZCL_CMD_LEVEL_STEP_WITH_ON_OFF
Ë? 
TRUE
 : 
FALSE
;

267 
ÀvñInfo
.
cuºítLevñ256
 = (
u16
)(
pLevñ
->
curLevñ
) << 8;

268 
ÀvñInfo
.
°ïLevñ256
 = (((
s32
)
cmd
->
°ïSize
Ë<< 8Ë/ 
pLevñ
->
ªmaöögTime
;

270 if(
cmd
->
°ïMode
 =
LEVEL_STEP_UP
){

271 if(
ÀvñInfo
.
wôhOnOff
){

272 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_ON
);

275 
ÀvñInfo
.
°ïLevñ256
 = -levelInfo.stepLevel256;

278 
	`light_≠∂yUpd©e
(&
pLevñ
->
curLevñ
, &
ÀvñInfo
.
cuºítLevñ256
, &ÀvñInfo.
°ïLevñ256
, &pLevñ->
ªmaöögTime
,

279 
ZCL_LEVEL_ATTR_MIN_LEVEL
, 
ZCL_LEVEL_ATTR_MAX_LEVEL
, 
FALSE
);

281 if(
ÀvñInfo
.
wôhOnOff
){

282 if(
pLevñ
->
curLevñ
 =
ZCL_LEVEL_ATTR_MIN_LEVEL
){

283 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

287 if(
pLevñ
->
ªmaöögTime
){

288 
	`ßm∂eLight_LevñTimîSt›
();

289 
ÀvñTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_ÀvñTimîEvtCb
, 
NULL
, 
ZCL_LEVEL_CHANGE_INTERVAL
);

291 
	`ßm∂eLight_LevñTimîSt›
();

293 
	}
}

305 
	$ßm∂eLight_°›Pro˚ss
(
u8
 
cmdId
, 
°›_t
 *
cmd
)

307 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

309 
	`ßm∂eLight_LevñTimîSt›
();

310 
pLevñ
->
ªmaöögTime
 = 0;

312 
ÀvñInfo
.
cuºítLevñ256
 = ((
s32
)
pLevñ
->
curLevñ
) << 8;

313 
	}
}

326 
°©us_t
 
	$ßm∂eLight_ÀvñCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

328 if(
pAddrInfo
->
d°Ep
 =
SAMPLE_LIGHT_ENDPOINT
){

329 
cmdId
){

330 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL
:

331 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL_WITH_ON_OFF
:

332 
	`ßm∂eLight_moveToLevñPro˚ss
(
cmdId
, (
moveToLvl_t
 *)
cmdPaylﬂd
);

334 
ZCL_CMD_LEVEL_MOVE
:

335 
ZCL_CMD_LEVEL_MOVE_WITH_ON_OFF
:

336 
	`ßm∂eLight_movePro˚ss
(
cmdId
, (
move_t
 *)
cmdPaylﬂd
);

338 
ZCL_CMD_LEVEL_STEP
:

339 
ZCL_CMD_LEVEL_STEP_WITH_ON_OFF
:

340 
	`ßm∂eLight_°ïPro˚ss
(
cmdId
, (
°ï_t
 *)
cmdPaylﬂd
);

342 
ZCL_CMD_LEVEL_STOP
:

343 
ZCL_CMD_LEVEL_STOP_WITH_ON_OFF
:

344 
	`ßm∂eLight_°›Pro˚ss
(
cmdId
, (
°›_t
 *)
cmdPaylﬂd
);

351  
ZCL_STA_SUCCESS
;

352 
	}
}

	@apps/sampleLight/zcl_onOffCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"ßm∂eLight.h
"

33 
	~"ßm∂eLightCål.h
"

38 
	#ZCL_ONOFF_TIMER_INTERVAL
 100

39 

	)

43 
ev_timî_evít_t
 *
	g⁄WôhTimedOffTimîEvt
 = 
NULL
;

58 
	$ßm∂eLight_⁄OffInô
()

60 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

62 
	`ßm∂eLight_⁄off
(
pOnOff
->
⁄Off
);

63 
	}
}

74 
	$ßm∂eLight_upd©eOnOff
()

76 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

78 
	`hwLight_⁄OffUpd©e
(
pOnOff
->
⁄Off
);

79 
	}
}

90 
	$ßm∂eLight_⁄off
(
u8
 
cmd
)

92 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

94 if(
cmd
 =
ZCL_CMD_ONOFF_ON
){

95 
pOnOff
->
globÆS˚√C⁄åﬁ
 = 
TRUE
;

97 
pOnOff
->
⁄Off
 = 
ZCL_ONOFF_STATUS_ON
;

98 if(
pOnOff
->
⁄Time
 == 0){

99 
pOnOff
->
offWaôTime
 = 0;

101 }if(
cmd
 =
ZCL_CMD_ONOFF_OFF
){

102 
pOnOff
->
⁄Off
 = 
ZCL_ONOFF_STATUS_OFF
;

103 
pOnOff
->
⁄Time
 = 0;

105 if(
pOnOff
->
⁄Off
 =
ZCL_ONOFF_STATUS_OFF
){

106 
pOnOff
->
globÆS˚√C⁄åﬁ
 = 
TRUE
;

108 
pOnOff
->
⁄Off
 = 
ZCL_ONOFF_STATUS_ON
;

109 if(
pOnOff
->
⁄Time
 == 0){

110 
pOnOff
->
offWaôTime
 = 0;

113 
pOnOff
->
⁄Off
 = 
ZCL_ONOFF_STATUS_OFF
;

114 
pOnOff
->
⁄Time
 = 0;

118 
	`light_‰esh
();

120 #ifde‡
ZCL_SCENE


121 
z˛_s˚√Aâr_t
 *
pS˚√
 = 
	`z˛_s˚√AârGë
();

122 
pS˚√
->
s˚√VÆid
 = 0;

124 
	}
}

135 
s32
 
	$ßm∂eLight_OnWôhTimedOffTimîCb
(*
¨g
)

137 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

139 if((
pOnOff
->
⁄Off
 =
ZCL_ONOFF_STATUS_ON
Ë&&ÖOnOff->
⁄Time
){

140 
pOnOff
->
⁄Time
--;

141 if(
pOnOff
->
⁄Time
 <= 0){

142 
pOnOff
->
offWaôTime
 = 0;

143 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

147 if((
pOnOff
->
⁄Off
 =
ZCL_ONOFF_STATUS_OFF
Ë&&ÖOnOff->
offWaôTime
){

148 
pOnOff
->
offWaôTime
--;

149 if(
pOnOff
->
offWaôTime
 <= 0){

150 
⁄WôhTimedOffTimîEvt
 = 
NULL
;

155 if(
pOnOff
->
⁄Time
 ||ÖOnOff->
offWaôTime
){

158 
⁄WôhTimedOffTimîEvt
 = 
NULL
;

161 
	}
}

172 
	$ßm∂eLight_OnWôhTimedOffTimîSt›
()

174 if(
⁄WôhTimedOffTimîEvt
){

175 
	`TL_ZB_TIMER_CANCEL
(&
⁄WôhTimedOffTimîEvt
);

177 
	}
}

188 
	$ßm∂eLight_⁄off_⁄WôhTimedOffPro˚ss
(
z˛_⁄off_⁄WôhTimeOffCmd_t
 *
cmd
)

190 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

192 if(
cmd
->
⁄OffCål
.
bôs
.
ac˚±O∆yWhíOn
 && (
pOnOff
->
⁄Off
 =
ZCL_ONOFF_STATUS_OFF
)){

196 if(
pOnOff
->
offWaôTime
 && (pOnOff->
⁄Off
 =
ZCL_ONOFF_STATUS_OFF
)){

197 
pOnOff
->
offWaôTime
 = 
	`mö2
’OnOff->offWaôTime, 
cmd
->offWaitTime);

199 
pOnOff
->
⁄Time
 = 
	`max2
’OnOff->⁄Time, 
cmd
->onTime);

200 
pOnOff
->
offWaôTime
 = 
cmd
->offWaitTime;

201 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_ON
);

204 if((
pOnOff
->
⁄Time
 < 0xFFFFË&& (pOnOff->
offWaôTime
 < 0xFFFF)){

205 if(
pOnOff
->
⁄Time
 ||ÖOnOff->
offWaôTime
){

206 
	`ßm∂eLight_OnWôhTimedOffTimîSt›
();

207 
⁄WôhTimedOffTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_OnWôhTimedOffTimîCb
, 
NULL
, 
ZCL_ONOFF_TIMER_INTERVAL
);

210 
	}
}

221 
	$ßm∂eLight_⁄off_offWôhEf„˘Pro˚ss
(
z˛_⁄off_offWôhEf„˘Cmd_t
 *
cmd
)

225 
	`ßm∂eLight_⁄off
(
ZCL_CMD_ONOFF_OFF
);

226 
	}
}

237 
	$ßm∂eLight_⁄off_⁄WôhReˇŒGlobÆS˚√Pro˚ss
()

240 
	}
}

253 
°©us_t
 
	$ßm∂eLight_⁄OffCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

255 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

257 if(
pAddrInfo
->
d°Ep
 =
SAMPLE_LIGHT_ENDPOINT
){

258 
cmdId
){

259 
ZCL_CMD_ONOFF_ON
:

260 
ZCL_CMD_ONOFF_OFF
:

261 
ZCL_CMD_ONOFF_TOGGLE
:

262 
	`ßm∂eLight_⁄off
(
cmdId
);

264 
ZCL_CMD_OFF_WITH_EFFECT
:

265 if(
pOnOff
->
globÆS˚√C⁄åﬁ
 =
TRUE
){

268 
pOnOff
->
globÆS˚√C⁄åﬁ
 = 
FALSE
;

270 
	`ßm∂eLight_⁄off_offWôhEf„˘Pro˚ss
((
z˛_⁄off_offWôhEf„˘Cmd_t
 *)
cmdPaylﬂd
);

272 
ZCL_CMD_ON_WITH_RECALL_GLOBAL_SCENE
:

273 if(
pOnOff
->
globÆS˚√C⁄åﬁ
 =
FALSE
){

274 
	`ßm∂eLight_⁄off_⁄WôhReˇŒGlobÆS˚√Pro˚ss
();

275 
pOnOff
->
globÆS˚√C⁄åﬁ
 = 
TRUE
;

278 
ZCL_CMD_ON_WITH_TIMED_OFF
:

279 
	`ßm∂eLight_⁄off_⁄WôhTimedOffPro˚ss
((
z˛_⁄off_⁄WôhTimeOffCmd_t
 *)
cmdPaylﬂd
);

286  
ZCL_STA_SUCCESS
;

287 
	}
}

	@apps/sampleLight/zcl_sampleLightCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

29 
	~"é_comm⁄.h
"

30 
	~"zb_≠i.h
"

31 
	~"z˛_ö˛ude.h
"

32 
	~"Ÿa.h
"

33 
	~"ßm∂eLight.h
"

34 
	~"ßm∂eLightCål.h
"

50 #ifde‡
ZCL_READ


51 
ßm∂eLight_z˛RódR•Cmd
(
z˛RódR•Cmd_t
 *
pRódR•Cmd
);

53 #ifde‡
ZCL_WRITE


54 
ßm∂eLight_z˛WrôeReqCmd
(
u16
 
˛u°îId
, 
z˛WrôeCmd_t
 *
pWrôeReqCmd
);

55 
ßm∂eLight_z˛WrôeR•Cmd
(
z˛WrôeR•Cmd_t
 *
pWrôeR•Cmd
);

57 #ifde‡
ZCL_REPORT


58 
ßm∂eLight_z˛CfgRï‹tCmd
(
z˛CfgRï‹tCmd_t
 *
pCfgRï‹tCmd
);

59 
ßm∂eLight_z˛CfgRï‹tR•Cmd
(
z˛CfgRï‹tR•Cmd_t
 *
pCfgRï‹tR•Cmd
);

60 
ßm∂eLight_z˛Rï‹tCmd
(
z˛Rï‹tCmd_t
 *
pRï‹tCmd
);

62 
ßm∂eLight_z˛DÊtR•Cmd
(
z˛DeÁu…R•Cmd_t
 *
pD·R•Cmd
);

73 #ifde‡
ZCL_IDENTIFY


74 
ev_timî_evít_t
 *
	gidítifyTimîEvt
 = 
NULL
;

91 
	$ßm∂eLight_z˛Pro˚ssIncomögMsg
(
z˛Incomög_t
 *
pInHdÃMsg
)

95 
pInHdÃMsg
->
hdr
.
cmd
)

97 #ifde‡
ZCL_READ


98 
ZCL_CMD_READ_RSP
:

99 
	`ßm∂eLight_z˛RódR•Cmd
(
pInHdÃMsg
->
©åCmd
);

102 #ifde‡
ZCL_WRITE


103 
ZCL_CMD_WRITE
:

104 
	`ßm∂eLight_z˛WrôeReqCmd
(
pInHdÃMsg
->
msg
->
ödInfo
.
˛u°î_id
,ÖInHdÃMsg->
©åCmd
);

106 
ZCL_CMD_WRITE_RSP
:

107 
	`ßm∂eLight_z˛WrôeR•Cmd
(
pInHdÃMsg
->
©åCmd
);

110 #ifde‡
ZCL_REPORT


111 
ZCL_CMD_CONFIG_REPORT
:

112 
	`ßm∂eLight_z˛CfgRï‹tCmd
(
pInHdÃMsg
->
©åCmd
);

114 
ZCL_CMD_CONFIG_REPORT_RSP
:

115 
	`ßm∂eLight_z˛CfgRï‹tR•Cmd
(
pInHdÃMsg
->
©åCmd
);

117 
ZCL_CMD_REPORT
:

118 
	`ßm∂eLight_z˛Rï‹tCmd
(
pInHdÃMsg
->
©åCmd
);

121 
ZCL_CMD_DEFAULT_RSP
:

122 
	`ßm∂eLight_z˛DÊtR•Cmd
(
pInHdÃMsg
->
©åCmd
);

127 
	}
}

129 #ifde‡
ZCL_READ


139 
	$ßm∂eLight_z˛RódR•Cmd
(
z˛RódR•Cmd_t
 *
pRódR•Cmd
)

143 
	}
}

146 #ifde‡
ZCL_WRITE


156 
	$ßm∂eLight_z˛WrôeReqCmd
(
u16
 
˛u°îId
, 
z˛WrôeCmd_t
 *
pWrôeReqCmd
)

158 
u8
 
numAâr
 = 
pWrôeReqCmd
->numAttr;

159 
z˛WrôeRec_t
 *
©å
 = 
pWrôeReqCmd
->
©åLi°
;

161 if(
˛u°îId
 =
ZCL_CLUSTER_GEN_ON_OFF
){

162 
u8
 
i
 = 0; i < 
numAâr
; i++){

163 if(
©å
[
i
].
©åID
 =
ZCL_ATTRID_START_UP_ONOFF
){

164 
	`z˛_⁄OffAâr_ßve
();

168 
	}
}

179 
	$ßm∂eLight_z˛WrôeR•Cmd
(
z˛WrôeR•Cmd_t
 *
pWrôeR•Cmd
)

183 
	}
}

196 
	$ßm∂eLight_z˛DÊtR•Cmd
(
z˛DeÁu…R•Cmd_t
 *
pD·R•Cmd
)

199 #ifde‡
ZCL_OTA


200 if–(
pD·R•Cmd
->
comm™dID
 =
ZCL_CMD_OTA_UPGRADE_END_REQ
) &&

201 (
pD·R•Cmd
->
°©usCode
 =
ZCL_STA_ABORT
) ){

202 if(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
){

203 
	`Ÿa_upgødeAb‹t
();

207 
	}
}

209 #ifde‡
ZCL_REPORT


219 
	$ßm∂eLight_z˛CfgRï‹tCmd
(
z˛CfgRï‹tCmd_t
 *
pCfgRï‹tCmd
)

223 
	}
}

234 
	$ßm∂eLight_z˛CfgRï‹tR•Cmd
(
z˛CfgRï‹tR•Cmd_t
 *
pCfgRï‹tR•Cmd
)

238 
	}
}

249 
	$ßm∂eLight_z˛Rï‹tCmd
(
z˛Rï‹tCmd_t
 *
pRï‹tCmd
)

253 
	}
}

256 #ifde‡
ZCL_BASIC


268 
°©us_t
 
	$ßm∂eLight_basicCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

270 if(
cmdId
 =
ZCL_CMD_BASIC_RESET_FAC_DEFAULT
){

275  
ZCL_STA_SUCCESS
;

276 
	}
}

279 #ifde‡
ZCL_IDENTIFY


280 
s32
 
	$ßm∂eLight_z˛IdítifyTimîCb
(*
¨g
)

282 if(
g_z˛_idítifyAârs
.
idítifyTime
 <= 0){

283 
	`light_blök_°›
();

285 
idítifyTimîEvt
 = 
NULL
;

288 
g_z˛_idítifyAârs
.
idítifyTime
--;

290 
	}
}

292 
	$ßm∂eLight_z˛IdítifyTimîSt›
()

294 if(
idítifyTimîEvt
){

295 
	`TL_ZB_TIMER_CANCEL
(&
idítifyTimîEvt
);

297 
	}
}

310 
	$ßm∂eLight_z˛IdítifyCmdH™dÀr
(
u8
 
ídpoöt
, 
u16
 
§cAddr
, u16 
idítifyTime
)

312 
g_z˛_idítifyAârs
.
idítifyTime
 = identifyTime;

314 if(
idítifyTime
 == 0){

315 
	`ßm∂eLight_z˛IdítifyTimîSt›
();

316 
	`light_blök_°›
();

318 if(!
idítifyTimîEvt
){

319 
	`light_blök_°¨t
(
idítifyTime
, 500, 500);

320 
idítifyTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ßm∂eLight_z˛IdítifyTimîCb
, 
NULL
, 1000);

323 
	}
}

334 
	$ßm∂eLight_z˛åiggîCmdH™dÀr
(
z˛_åiggîEf„˘_t
 *
pTriggîEf„˘
)

336 
u8
 
ef„˘Id
 = 
pTriggîEf„˘
->effectId;

339 
ef„˘Id
){

340 
IDENTIFY_EFFECT_BLINK
:

341 
	`light_blök_°¨t
(1, 500, 500);

343 
IDENTIFY_EFFECT_BREATHE
:

344 
	`light_blök_°¨t
(15, 300, 700);

346 
IDENTIFY_EFFECT_OKAY
:

347 
	`light_blök_°¨t
(2, 250, 250);

349 
IDENTIFY_EFFECT_CHANNEL_CHANGE
:

350 
	`light_blök_°¨t
(1, 500, 7500);

352 
IDENTIFY_EFFECT_FINISH_EFFECT
:

353 
	`light_blök_°¨t
(1, 300, 700);

355 
IDENTIFY_EFFECT_STOP_EFFECT
:

356 
	`light_blök_°›
();

361 
	}
}

374 
°©us_t
 
	$ßm∂eLight_idítifyCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

376 if(
pAddrInfo
->
d°Ep
 =
SAMPLE_LIGHT_ENDPOINT
){

377 if(
pAddrInfo
->
dúClu°î
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

378 
cmdId
){

379 
ZCL_CMD_IDENTIFY
:

380 
	`ßm∂eLight_z˛IdítifyCmdH™dÀr
(
pAddrInfo
->
d°Ep
,ÖAddrInfo->
§cAddr
, ((
z˛_idítifyCmd_t
 *)
cmdPaylﬂd
)->
idítifyTime
);

382 
ZCL_CMD_TRIGGER_EFFECT
:

383 
	`ßm∂eLight_z˛åiggîCmdH™dÀr
((
z˛_åiggîEf„˘_t
 *)
cmdPaylﬂd
);

391  
ZCL_STA_SUCCESS
;

392 
	}
}

	@apps/sampleLight/zcl_sceneCb.c

24 #i‡(
__PROJECT_TL_DIMMABLE_LIGHT__
)

30 
	~"é_comm⁄.h
"

31 
	~"zb_≠i.h
"

32 
	~"z˛_ö˛ude.h
"

33 
	~"ßm∂eLight.h
"

46 
	$ßm∂eLight_s˚√ReˇŒReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
z˛_s˚√E¡ry_t
 *
pS˚√
)

48 
u8
 
extLí
 = 0;

50 #ifde‡
ZCL_ON_OFF


51 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

53 
pOnOff
->
⁄Off
 = 
pS˚√
->
extFõld
[
extLí
+3];

54 
extLí
 += 4;

57 #ifde‡
ZCL_LEVEL_CTRL


58 
u8
 
Àvñ
 = 
pS˚√
->
extFõld
[
extLí
+3];

59 
extLí
 += 4;

62 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


63 #i‡
COLOR_RGB_SUPPORT


64 
u8
 
hue
 = 
pS˚√
->
extFõld
[
extLí
+3];

65 
u8
 
ßtuøti⁄
 = 
pS˚√
->
extFõld
[
extLí
+4];

66 
extLí
 += 5;

67 #ñi‡
COLOR_CCT_SUPPORT


68 
u16
 
cﬁ‹Tem≥øtuªMúeds
 = 
	`BUILD_U16
(
pS˚√
->
extFõld
[
extLí
+3],ÖScene->extField[extLen+4]);

69 
extLí
 += 5;

73 #ifde‡
ZCL_LEVEL_CTRL


74 
moveToLvl_t
 
moveToLevñ
;

75 
moveToLevñ
.
Àvñ
 =Üevel;

76 
moveToLevñ
.
å™sôi⁄Time
 = 
pS˚√
->
å™sTime
;

77 
moveToLevñ
.
›tPª£¡
 = 0;

79 
	`ßm∂eLight_ÀvñCb
(
pAddrInfo
, 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL
, &
moveToLevñ
);

82 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


83 #i‡
COLOR_RGB_SUPPORT


84 
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 
move2HueAndS©
;

85 
move2HueAndS©
.
hue
 = hue;

86 
move2HueAndS©
.
ßtuøti⁄
 = saturation;

87 
move2HueAndS©
.
å™sôi⁄Time
 = 
pS˚√
->
å™sTime
;

88 
move2HueAndS©
.
›tPª£¡
 = 0;

90 
	`ßm∂eLight_cﬁ‹CålCb
(
pAddrInfo
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION
, &
move2HueAndS©
);

91 #ñi‡
COLOR_CCT_SUPPORT


92 
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 
move2Cﬁ‹Temp
;

93 
move2Cﬁ‹Temp
.
cﬁ‹Tem≥øtuª
 = 
cﬁ‹Tem≥øtuªMúeds
;

94 
move2Cﬁ‹Temp
.
å™sôi⁄Time
 = 
pS˚√
->
å™sTime
;

95 
move2Cﬁ‹Temp
.
›tPª£¡
 = 0;

97 
	`ßm∂eLight_cﬁ‹CålCb
(
pAddrInfo
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR_TEMPERATURE
, &
move2Cﬁ‹Temp
);

100 
	}
}

112 
	$ßm∂eLight_s˚√St‹eReqH™dÀr
(
z˛_s˚√E¡ry_t
 *
pS˚√
)

115 
u8
 
extLí
 = 0;

117 #ifde‡
ZCL_ON_OFF


118 
z˛_⁄OffAâr_t
 *
pOnOff
 = 
	`z˛_⁄offAârGë
();

120 
pS˚√
->
extFõld
[
extLí
++] = 
	`LO_UINT16
(
ZCL_CLUSTER_GEN_ON_OFF
);

121 
pS˚√
->
extFõld
[
extLí
++] = 
	`HI_UINT16
(
ZCL_CLUSTER_GEN_ON_OFF
);

122 
pS˚√
->
extFõld
[
extLí
++] = 1;

123 
pS˚√
->
extFõld
[
extLí
++] = 
pOnOff
->
⁄Off
;

126 #ifde‡
ZCL_LEVEL_CTRL


127 
z˛_ÀvñAâr_t
 *
pLevñ
 = 
	`z˛_ÀvñAârGë
();

129 
pS˚√
->
extFõld
[
extLí
++] = 
	`LO_UINT16
(
ZCL_CLUSTER_GEN_LEVEL_CONTROL
);

130 
pS˚√
->
extFõld
[
extLí
++] = 
	`HI_UINT16
(
ZCL_CLUSTER_GEN_LEVEL_CONTROL
);

131 
pS˚√
->
extFõld
[
extLí
++] = 1;

132 
pS˚√
->
extFõld
[
extLí
++] = 
pLevñ
->
curLevñ
;

135 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


136 
z˛_lightCﬁ‹CålAâr_t
 *
pCﬁ‹
 = 
	`z˛_cﬁ‹AârGë
();

138 
pS˚√
->
extFõld
[
extLí
++] = 
	`LO_UINT16
(
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
);

139 
pS˚√
->
extFõld
[
extLí
++] = 
	`HI_UINT16
(
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
);

140 #i‡
COLOR_RGB_SUPPORT


141 
pS˚√
->
extFõld
[
extLí
++] = 2;

142 
pS˚√
->
extFõld
[
extLí
++] = 
pCﬁ‹
->
cuºítHue
;

143 
pS˚√
->
extFõld
[
extLí
++] = 
pCﬁ‹
->
cuºítS©uøti⁄
;

144 #ñi‡
COLOR_CCT_SUPPORT


145 
pS˚√
->
extFõld
[
extLí
++] = 2;

146 
pS˚√
->
extFõld
[
extLí
++] = 
	`LO_UINT16
(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
);

147 
pS˚√
->
extFõld
[
extLí
++] = 
	`HI_UINT16
(
pCﬁ‹
->
cﬁ‹Tem≥øtuªMúeds
);

151 
pS˚√
->
extFõldLí
 = 
extLí
;

152 
	}
}

163 
°©us_t
 
	$ßm∂eLight_s˚√Cb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

165 if(
pAddrInfo
->
d°Ep
 =
SAMPLE_LIGHT_ENDPOINT
){

166 if(
pAddrInfo
->
dúClu°î
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

167 
cmdId
){

168 
ZCL_CMD_SCENE_STORE_SCENE
:

169 
	`ßm∂eLight_s˚√St‹eReqH™dÀr
((
z˛_s˚√E¡ry_t
 *)
cmdPaylﬂd
);

171 
ZCL_CMD_SCENE_RECALL_SCENE
:

172 
	`ßm∂eLight_s˚√ReˇŒReqH™dÀr
(
pAddrInfo
, (
z˛_s˚√E¡ry_t
 *)
cmdPaylﬂd
);

180  
ZCL_STA_SUCCESS
;

181 
	}
}

	@platform/boot/8258/cstartup_8258.S

24 #ifde‡
MCU_STARTUP_8258


26 
	~"vîsi⁄_cfg.h
"

28 
	#MCU_RUN_SRAM_EN
 0

	)

30 #i‡
MCU_RUN_SRAM_EN


31 
	#FLL_STK_EN
 0

	)

32 
	#ZERO_IC_TAG_EN
 0

	)

34 #i‡
MCU_8258_A0


35 
	#DCDC_POWER_ON
 1

	)

37 
	#DCDC_POWER_ON
 0

	)

40 
	#IC_TAG_CACHE_ADDR_EQU_EN
 1

	)

41 
	#FLASH_WAKEUP_EN
 1

	)

42 
	#COPY_DATA_EN
 0

	)

43 
	#MULTI_ADDRESS_START
 1

	)

44 
	#MOVE_BIN_CODE_EN
 1

	)

47 
	#FLL_STK_EN
 1

	)

48 
	#ZERO_IC_TAG_EN
 1

	)

50 #i‡
MCU_8258_A0


51 
	#DCDC_POWER_ON
 1

	)

53 
	#DCDC_POWER_ON
 0

	)

56 
	#IC_TAG_CACEH_ADDR_EQU_EN
 0

	)

57 
	#FLASH_WAKEUP_EN
 1

	)

58 
	#COPY_DATA_EN
 1

	)

59 
	#MULTI_ADDRESS_START
 1

	)

60 
	#MOVE_BIN_CODE_EN
 0

	)

63 #i‚de‡
__LOAD_RAM_SIZE__


64 
	#__LOAD_RAM_SIZE__
 0xc

	)

67 #i‚de‡
__IRQ_STK_SIZE__


68 
	#__IRQ_STK_SIZE__
 0x180

	)

70 .
	gcode
 16

72 @ 
MACROS
 
AND
 
	gDEFINIITIONS


75 @ 
	gMode
, 
c‹ª•‹ds
 
to
 
	gbôs
 0-5 
ö
 
	gCPSR


76 .
equ
 
	gMODE_BITS
, 0x1F @ 
Bô
 
mask
 
mode
 
bôs
 
ö
 
	gCPSR


77 .
equ
 
	gIRQ_MODE
, 0x12 @ 
I¡îru±
 
Reque°
 
	gmode


78 .
equ
 
	gSVC_MODE
, 0x13 @ 
Su≥rvis‹
 
	gmode


79 .
equ
 
	gIRQ_STK_SIZE
, 
	g__IRQ_STK_SIZE__


80 .
equ
 
	g__LOAD_RAM
, 
	g__LOAD_RAM_SIZE__


83 @ 
TC32
 
EXCEPTION
 
	gVECTORS


86 .
	g£˘i⁄
 .
	gve˘‹s
,"ax"

87 .
globÆ
 
	g__ª£t


88 .
globÆ
 
	g__úq


89 .
globÆ
 
	g__°¨t


90 .
globÆ
 
__LOAD_RAM


92 
	g__°¨t
: @ 
MUST
, 
ª„ªn˚d
 
by
 
	gboŸ
.
	glök


94 .
úq_h™dÀr


96 .
_ømcode_size_div_16_


97 .
_ømcode_size_div_256_


98 .
_ømcode_size_div_16_Æign_256_


99 .
_ømcode_size_Æign_256_


100 .
_i˘ag_°¨t_


101 .
_i˘ag_íd_


102 .
é_mu…i_addr


104 .
FILE_VERSION


105 .
MANUFACTURER_CODE_TELINK


106 .
IMAGE_TYPE


108 .
‹g
 0x0

109 
tj
 
__ª£t


110 .
w‹d
 (
FILE_VERSION
)

111 .
‹g
 0x8

112 .
	$w‹d
 (0x544c4e4b)

113 #i‡
MOVE_BIN_CODE_EN


114 .
	`w‹d
 (0x00880000 + 
_bö_size_div_16
)

116 .
	`w‹d
 (0x00880000 + 
_ømcode_size_div_16_Æign_256_
)

119 .
‹g
 0x10

120 
tj
 
__úq


122 .
‹g
 0x12

123 .(
MANUFACTURER_CODE_TELINK
)

124 .(
IMAGE_TYPE
)

126 .
‹g
 0x18

127 .
	`w‹d
 (
_bö_size_
)

128 .
maö


130 .
‹g
 0x20

132 .
globÆ
 
°¨t_su•íd


133 .
thumb_func


134 .
ty≥
 
°¨t_su•íd
, %
fun˘i⁄


136 
°¨t_su•íd
: @ 
ö°ru˘i⁄
 
ˇche
 
addªss
 + 0x58: 0x3c16 * 4 = 0xf058

137 
çush
 {
r2
-
r3
}

139 
tmovs
 
r2
, #129 @0x81

140 
éﬂdr
 
r3
, 
__su•íd_d©a
 @0x80006f

141 
t°‹îb
 
r2
, [
r3
, #0] @*(volatile *)0x80006f = 0x81

143 
tmov
 
r8
,Ñ8

144 
tmov
 
r8
,Ñ8

145 
tmov
 
r8
,Ñ8

146 
tmov
 
r8
,Ñ8

147 
tmov
 
r8
,Ñ8

148 
tmov
 
r8
,Ñ8

149 
tmov
 
r8
,Ñ8

150 
tmov
 
r8
,Ñ8

151 
tmov
 
r8
,Ñ8

152 
tmov
 
r8
,Ñ8

153 
tmov
 
r8
,Ñ8

154 
tmov
 
r8
,Ñ8

155 
tmov
 
r8
,Ñ8

156 
tmov
 
r8
,Ñ8

157 
tmov
 
r8
,Ñ8

158 
tmov
 
r8
,Ñ8

159 
tmov
 
r8
,Ñ8

160 
tmov
 
r8
,Ñ8

161 
tmov
 
r8
,Ñ8

162 
tmov
 
r8
,Ñ8

163 
tmov
 
r8
,Ñ8

164 
tmov
 
r8
,Ñ8

165 
tmov
 
r8
,Ñ8

166 
tmov
 
r8
,Ñ8

167 
tmov
 
r8
,Ñ8

168 
tmov
 
r8
,Ñ8

169 
tmov
 
r8
,Ñ8

170 
tmov
 
r8
,Ñ8

171 
tmov
 
r8
,Ñ8

172 
tmov
 
r8
,Ñ8

173 
tmov
 
r8
,Ñ8

174 
tmov
 
r8
,Ñ8

175 
tmov
 
r8
,Ñ8

176 
tmov
 
r8
,Ñ8

177 
tmov
 
r8
,Ñ8

178 
tmov
 
r8
,Ñ8

179 
tmov
 
r8
,Ñ8

180 
tmov
 
r8
,Ñ8

181 
tmov
 
r8
,Ñ8

182 
tmov
 
r8
,Ñ8

183 
tmov
 
r8
,Ñ8

184 
tmov
 
r8
,Ñ8

185 
tmov
 
r8
,Ñ8

186 
tmov
 
r8
,Ñ8

187 
tmov
 
r8
,Ñ8

188 
tmov
 
r8
,Ñ8

189 
tmov
 
r8
,Ñ8

190 
tmov
 
r8
,Ñ8

191 
tmov
 
r8
,Ñ8

192 
tmov
 
r8
,Ñ8

193 
tmov
 
r8
,Ñ8

194 
tmov
 
r8
,Ñ8

195 
tmov
 
r8
,Ñ8

196 
tmov
 
r8
,Ñ8

197 
tmov
 
r8
,Ñ8

198 
tmov
 
r8
,Ñ8

199 
tmov
 
r8
,Ñ8

200 
tmov
 
r8
,Ñ8

201 
tmov
 
r8
,Ñ8

202 
tmov
 
r8
,Ñ8

203 
tmov
 
r8
,Ñ8

204 
tmov
 
r8
,Ñ8

205 
tmov
 
r8
,Ñ8

206 
tmov
 
r8
,Ñ8

208 
ç›
 {
r2
-
r3
}

209 
tjex
 
Ã


210 .
Æign
 4

211 
__su•íd_d©a
:

212 .
	$w‹d
 (0x80006f)

214 
__ª£t
:

217 @ 
FILL
 .
STK
 
WITH
 0xFF

219 #i‡
FLL_STK_EN


220 
éﬂdr
 
r0
, 
FLL_D
 @r0 = 0xffffffff

221 
éﬂdr
 
r1
, 
FLL_D
+4 @r1 = 
_íd_cu°om_bss_


222 
éﬂdr
 
r2
, 
FLL_D
+8 @r2 = 
_°ack_íd_


223 
FLL_STK
:

224 
tcmp
 
r1
, 
r2
 @

225 
tjge
 
FLL_STK_END
 @
r1
>=
r2
 
jump
 
to
 FLL_STK_END

226 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_d©a_
)=0xffffffff

227 
èdd
 
r1
, #4 @r1 =Ñ1+4

228 
tj
 
FLL_STK
 @
jump
 
to
 FLL_STK

229 
FLL_STK_END
:

232 @ 
UPDATE
 
SP
 
UNDER
 
IRQ
/
SVC
 
MODE


234 
éﬂdr
 
r0
, 
DAT0
 @r0 = 0x12 
IRQ


235 
tmc§
 
r0
 @
CPSR
=r0

236 
éﬂdr
 
r0
, 
DAT0
 + 8 @r0 = 
úq_°k
 + 
IRQ_STK_SIZE


237 
tmov
 
r13
, 
r0
 @r13/
SP
r0 
upd©e
 SP 
undî
 
IRQ
 
mode


239 
éﬂdr
 
r0
, 
DAT0
 + 4 @r0 = 0x13 
SVC


240 
tmc§
 
r0
 @
CPSR
=r0

241 
éﬂdr
 
r0
, 
DAT0
 + 12 @r0 = 
_°ack_íd_


242 
tmov
 
r13
, 
r0
 @r13r0 
upd©e
 
SP
 
undî
 
SVC
 
mode


244 @ 
IC
 
TAG
 
INITIALIZATION


246 #i‡
ZERO_IC_TAG_EN


247 
ZERO_TAG
:

248 
tmov
 
r0
, #0

249 
éﬂdr
 
r1
, 
DAT0
 + 28 @r1 = 
_i˘ag_°¨t_


250 
éﬂdr
 
r2
, 
DAT0
 + 32 @r2 = 
_i˘ag_íd_


251 
ZERO_TAG_BEGIN
:

252 
tcmp
 
r1
, 
r2


253 
tjge
 
ZERO_TAG_END
 @
r1
>=
r2
 
jump
 
to
 ZERO_TAG_END

254 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_i˘ag_°¨t_
)=r0=0

255 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

256 
tj
 
ZERO_TAG_BEGIN
 @
jump
 
to
 ZERO_TAG_BEGIN

257 
ZERO_TAG_END
:

260 @ 
IC
 
CACHE
 
INITIALIZATION


262 
SET_IC
:

263 
éﬂdr
 
r1
, 
DAT0
 + 24 @Ñ1 = 0x80060c

264 
éﬂdr
 
r0
, 
DAT0
 + 36 @Ñ0 = 
_ømcode_size_Æign_256_


265 
tsh·r
 
r0
,r0,#8 @Ñ0 = 
_ømcode_size_Æign_256_
/256

266 
t°‹îb
 
r0
, [
r1
, #0] @ *(*)(0x80060c) =Ñ0

267 #i‡
IC_TAG_CACHE_ADDR_EQU_EN


270 
èdd
 
r0
, #1 @Ñ0 =Ñ0 + 1

272 
t°‹îb
 
r0
, [
r1
, #1] @ *(*)(0x80060d) =Ñ0

273 
SET_IC_END
:

275 @ 
DCDC
 
INITIALIZATION
 
FOR
 
FLASH


278 
éﬂdr
 
r0
,
DATA_I
+32 @0x00800060

279 
éﬂdr
 
r1
,
DATA_I
+36 @0xff000000

280 
t°‹î
 
r1
,[
r0
,#0] @*(*)0x800060=0xff000000

281 
tsh·r
 
r1
,r1,#24 @0x000000ff

282 
t°‹îb
 
r1
,[
r0
,#4]

283 
t°‹îb
 
r1
,[
r0
,#5]

285 #i‡
DCDC_POWER_ON


286 
éﬂdrb
 
r0
,
DATA_I
+44 @
™a_ªg_adr
:0x0c

287 
éﬂdrb
 
r1
,
DATA_I
+48 @
™a_ªg_d©
:0xc4

288 
WANA_REG_BEGIN
:

289 
éﬂdr
 
r3
,
DATA_I
+28 @0x008000b8

290 
tmov
 
r4
,
r0
 @
™a_ªg_adr
:0x80=128

291 
t°‹îb
 
r4
,[
r3
,#0] @*(*)0x8000b8=0x80;

292 
tmov
 
r4
,
r1
 @
™a_ªg_d©
:0x22=34

293 
t°‹îb
 
r4
,[
r3
,#1] @*(*)0x8000b9=0x22;

294 
tmov
 
r4
,#96 @
™a_ªg_d©
:0x60=96

295 
t°‹îb
 
r4
,[
r3
,#2] @*(*)0x8000ba=0x60;

296 
WWAIT_REG_FINISH
:

297 
éﬂdrb
 
r4
,[
r3
,#2]

298 
tsh·l
 
r4
,r4,#31

299 
tsh·r
 
r4
,r4,#31

300 
tcmp
 
r4
,#1

301 
tjeq
 
WWAIT_REG_FINISH


302 
tmov
 
r4
,#0

303 
t°‹îb
 
r4
,[
r3
,#2]

304 
WANA_REG_END
:

307 #i‡
FLASH_WAKEUP_EN


308 
FLASH_WAKEUP_BEGIN
:

309 
éﬂdr
 
r0
,
DATA_I
+44

310 
tmov
 
r1
,#0

311 
t°‹îb
 
r1
,[
r0
,#1]

312 
tmov
 
r1
,#171 @
Fœsh
 
dìp
 
cmd
: 0xAB

313 
t°‹îb
 
r1
,[
r0
,#0]

314 
tmov
 
r2
,#0

315 
tmov
 
r3
,#6

316 
TNOP
:

317 
èdd
 
r2
,#1

318 
tcmp
 
r2
,
r3


319 
tjÀ
 
TNOP


320 
tmov
 
r1
,#1

321 
t°‹îb
 
r1
,[
r0
,#1]

322 
FLASH_WAKEUP_END
:

326 
éﬂdr
 
r0
,
DATA_I
+24 @0x7e

327 
RANA_REG_BEGIN
:

328 
éﬂdr
 
r1
,
DATA_I
+28 @0x008000b8

329 
tmov
 
r2
,
r0
 @
™a_ªg_adr
:0x7e

330 
t°‹îb
 
r2
,[
r1
,#0] @*(*)0x8000b8=0x7e;

331 
tmov
 
r2
,#64 @
™a_ªg_d©
:0x40=64

332 
t°‹îb
 
r2
,[
r1
,#2] @*(*)0x8000ba=0x40;

333 
RWAIT_REG_FINISH
:

334 
éﬂdrb
 
r2
,[
r1
,#2]

335 
tsh·l
 
r2
,r2,#31

336 
tsh·r
 
r2
,r2,#31

337 
tcmp
 
r2
,#1

338 
tjeq
 
RWAIT_REG_FINISH


339 
éﬂdrb
 
r2
,[
r1
,#1]

340 
RANA_REG_END
:

343 
éﬂdrb
 
r0
,
DATA_I
+40

344 
t°‹îb
 
r2
,[
r0
,#0]

346 
tmov
 
r0
,#0

347 
tcmp
 
r2
,
r0


349 #i‡
MULTI_ADDRESS_START


350 
tjeq
 
MULTI_ADDRESS_END


351 
MULTI_ADDRESS_BEGIN
:

352 
éﬂdr
 
r0
, 
MULTI_ADDRESS_DATA


353 
éﬂdr
 
r1
, 
MULTI_ADDRESS_DATA
+4

354 
éﬂdrb
 
r2
, [
r1
,#0]

355 
t°‹îb
 
r2
, [
r0
,#0]

356 
tj
 
ZERO_BSS_END
 @ 
dìp
 
wakeup
 
wôh
 
ªã¡i⁄


357 
MULTI_ADDRESS_END
:

360 @ 
DATA
 
INITIALIZATION


362 
COPY_DATA
:

363 
éﬂdr
 
r1
, 
DATA_I
+12 @Ñ1 = 
_d°‹ed_


364 
éﬂdr
 
r2
, 
DATA_I
+16 @Ñ2 = 
_°¨t_d©a_


365 
éﬂdr
 
r3
, 
DATA_I
+20 @Ñ3 = 
_íd_d©a_


366 
COPY_DATA_BEGIN
:

367 
tcmp
 
r2
, 
r3
 @

368 
tjge
 
COPY_DATA_END
 @ 
r2
>=
r3
 
jump
 
to
 COPY_DATA_END

369 
éﬂdr
 
r0
, [
r1
, #0] @Ñ0 = *(*)(
_d°‹ed_
)

370 
t°‹î
 
r0
, [
r2
, #0] @ *(*)(
_°¨t_d©a_
) =Ñ0

371 
èdd
 
r1
, #4 @Ñ1 =Ñ1 + 4

372 
èdd
 
r2
, #4 @Ñ2 =Ñ2 + 4

373 
tj
 
COPY_DATA_BEGIN
 @ 
jump
 
to
 COPY_DATA_BEGIN

374 
COPY_DATA_END
:

376 @ 
BSS
 
INITIALIZATION
 
FOR
 0

378 
BSS_CLEAR
:

379 
tmov
 
r0
, #0 @r0 = 0

380 
éﬂdr
 
r1
, 
DAT0
 + 16 @r1 = 
_°¨t_bss_


381 
éﬂdr
 
r2
, 
DAT0
 + 20 @r2 = 
_íd_bss_


382 
ZERO_BSS_BEGIN
:

383 
tcmp
 
r1
, 
r2


384 
tjge
 
ZERO_BSS_END
 @
r1
>=
r2
 
jump
 
to
 ZERO_BSS_END

385 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_bss_
)=r0=0

386 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

387 
tj
 
ZERO_BSS_BEGIN
 @
jump
 
to
 ZERO_BSS_BEGIN

388 
ZERO_BSS_END
:

390 @ 
CUSTOM
 
DATA
 
INITIALIZATION


392 
COPY_CUSTOM_DATA
:

393 
éﬂdr
 
r1
, 
DATA_I
+52 @Ñ1 = 
_cu°om_°‹ed_


394 
éﬂdr
 
r2
, 
DATA_I
+56 @Ñ2 = 
_°¨t_cu°om_d©a_


395 
éﬂdr
 
r3
, 
DATA_I
+60 @Ñ3 = 
_íd_cu°om_d©a_


396 
COPY_DATA_CUSTOM_BEGIN
:

397 
tcmp
 
r2
, 
r3
 @

398 
tjge
 
COPY_DATA_CUSTOM_END
 @ 
r2
>=
r3
 
jump
 
to
 
COPY_DATA_END


399 
éﬂdr
 
r0
, [
r1
, #0] @Ñ0 = *(*)(
_d°‹ed_
)

400 
t°‹î
 
r0
, [
r2
, #0] @ *(*)(
_°¨t_d©a_
) =Ñ0

401 
èdd
 
r1
, #4 @Ñ1 =Ñ1 + 4

402 
èdd
 
r2
, #4 @Ñ2 =Ñ2 + 4

403 
tj
 
COPY_DATA_CUSTOM_BEGIN
 @ 
jump
 
to
 
COPY_DATA_BEGIN


404 
COPY_DATA_CUSTOM_END
:

406 @ 
CUSTOM
 
BSS
 
INITIALIZATION
 
FOR
 0

408 
ZERO_CUSTOM_BSS
:

409 
tmov
 
r0
, #0

410 
éﬂdr
 
r1
, 
DAT0
 + 40 @r1 = 
_°¨t_cu°om_


411 
éﬂdr
 
r2
, 
DAT0
 + 44 @r2 = 
_íd_cu°om_


412 
ZERO_BSS_CUSTOM_BEGIN
:

413 
tcmp
 
r1
, 
r2


414 
tjge
 
ZERO_BSS_CUSTOM_END
 @
r1
>=
r2
 
jump
 
to
 
ZERO_BSS_END


415 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_bss_
)=r0=0

416 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

417 
tj
 
ZERO_BSS_CUSTOM_BEGIN
 @
jump
 
to
 
ZERO_BSS_BEGIN


418 
ZERO_BSS_CUSTOM_END
:

421 
ENTER_MAIN
:

422 
tjl
 
maö


423 
END
: 
tj
 END

425 .
bÆign
 4

426 
DAT0
:

427 .
w‹d
 0x12 @0 
IRQ


428 .
w‹d
 0x13 @4 
SVC


429 .
	`w‹d
 (
úq_°k
 + 
IRQ_STK_SIZE
) @8

430 .
	`w‹d
 (
_°ack_íd_
Ë@12 
°ack
 
íd


431 .
	`w‹d
 (
_°¨t_bss_
) @16

432 .
	`w‹d
 (
_íd_bss_
) @20

433 .
	`w‹d
 (0x80060c) @24

434 .
w‹d
 
_i˘ag_°¨t_
 @28 
IC
 
èg
 
°¨t


435 .
w‹d
 
_i˘ag_íd_
 @32 
IC
 
èg
 
íd


436 #i‡
IC_TAG_CACHE_ADDR_EQU_EN


437 .
	`w‹d
 (0x00f000) @36

439 .
w‹d
 
_ømcode_size_Æign_256_
 @36

440 .
w‹d
 
_°¨t_cu°om_bss_
 @40

441 .
w‹d
 
_íd_cu°om_bss_
 @44

443 
DATA_I
:

444 .
	`w‹d
 (
_r°‹ed_
) @0

445 .
	`w‹d
 (0x0000007e) @4

446 .
	`w‹d
 (0x0000007e) @8

447 .
w‹d
 
_d°‹ed_
 @12

448 .
w‹d
 
_°¨t_d©a_
 @16

449 .
w‹d
 
_íd_d©a_
 @20

450 .
	`w‹d
 (0x0000007e) @24

451 .
	`w‹d
 (0x008000b8) @28

452 .
	`w‹d
 (0x00800060) @32

453 .
	`w‹d
 (0xff000000) @36

454 .
	`w‹d
 (0x00800000) @40

455 .
	`w‹d
 (0x0080000c) @44

456 .
	`w‹d
 (0x000000c4) @48

457 .
w‹d
 
_cu°om_°‹ed_
 @52

458 .
w‹d
 
_°¨t_cu°om_d©a_
 @56

459 .
w‹d
 
_íd_cu°om_d©a_
 @60

460 
FLL_D
:

461 .
w‹d
 0xffffffff @0

462 .
	`w‹d
 (
_íd_cu°om_bss_
) @4

463 .
	`w‹d
 (
_°ack_íd_
) @8

464 .
w‹d
 
_ømcode_size_div_256_
 @12

465 
MULTI_ADDRESS_DATA
:

466 .
	`w‹d
 (0x0080063e) @0

467 .
w‹d
 
é_mu…i_addr
 @4

469 .
Æign
 4

470 
__úq
:

471 
çush
 {
r14
} @push R14/LR 

472 
çush
 {
r0
-
r7
} @
push
Ñ0~r7 
öto
 
°ack


473 
tmrss
 
r0
 @
ßve
 
˝§
 
to
Ñ0

475 
tmov
 
r1
, 
	gr8
 @r8~
r12
 
ˇ¬Ÿ
 
u£
 
the
 
way
 
	glike
 {
	gr0
~
	gr7
} 
to
 
push
 
öto
 
°ack


476 
tmov
 
	gr2
, 
	gr9
 @
mu°
 
move
 
	gr8
~
r12
 
öto
 
	gr1
~
r5
 
to
 
push


477 
tmov
 
	gr3
, 
r10


478 
tmov
 
	gr4
, 
r11


479 
tmov
 
	gr5
, 
r12


480 
	gçush
 {
	gr0
-
	gr5
}

482 
tjl
 
	gúq_h™dÀr
 @
jump
 
to
 
úq_h™dÀr


484 
	gç›
 {
	gr0
-
	gr5
} @
p›
 
	gr8
~
r12


485 
tmov
 
	gr8
, 
r1


486 
tmov
 
	gr9
, 
r2


487 
tmov
 
	gr10
,
r3


488 
tmov
 
	gr11
,
r4


489 
tmov
 
	gr12
,
r5


491 
tms§
 
	gr0
 @ 
r0
 
to
 
˝§


492 
	gç›
 {
	gr0
-
	gr7
} @
p›
Ñ0~
r7


493 
	gåëi
 {
	gr15
} @ 
to
 
pc


495 
	gASMEND
:

496 .
£˘i⁄
 .
bss


497 .
Æign
 4

498 .
lcomm
 
úq_°k
, 
	gIRQ_STK_SIZE


499 .
	gíd


	@platform/boot/826x/cstartup_826x.S

24 #ifde‡
MCU_CORE_826x


26 
	~"vîsi⁄_cfg.h
"

28 #i‚de‡
__LOAD_RAM_SIZE__


29 
	#__LOAD_RAM_SIZE__
 0xc

	)

32 #i‚de‡
__IRQ_STK_SIZE__


33 
	#__IRQ_STK_SIZE__
 0x180

	)

35 .
	gcode
 16

37 @ 
MACROS
 
AND
 
	gDEFINIITIONS


39 @ 
	gMode
, 
c‹ª•‹ds
 
to
 
	gbôs
 0-5 
ö
 
	gCPSR


40 .
equ
 
	gMODE_BITS
, 0x1F @ 
Bô
 
mask
 
mode
 
bôs
 
ö
 
	gCPSR


41 .
equ
 
	gIRQ_MODE
, 0x12 @ 
I¡îru±
 
Reque°
 
	gmode


42 .
equ
 
	gSVC_MODE
, 0x13 @ 
Su≥rvis‹
 
	gmode


44 .
equ
 
	gIRQ_STK_SIZE
, 
	g__IRQ_STK_SIZE__


45 .
equ
 
	g__LOAD_RAM
, 
	g__LOAD_RAM_SIZE__


47 #ifde‡
CHIP_8269


48 .
equ
 
	gRAM_ADDR_END
, 0x810000 @8269

50 .
equ
 
	gRAM_ADDR_END
, 0x80c000 @8267

53 @ 
TC32
 
EXCEPTION
 
	gVECTORS


56 .
	g£˘i⁄
 .
	gve˘‹s
,"ax"

57 .
globÆ
 
	g__ª£t


58 .
globÆ
 
	g__úq


59 .
globÆ
 
	g__°¨t


60 .
globÆ
 
__LOAD_RAM


62 
	g__°¨t
: @ 
MUST
, 
ª„ªn˚d
 
by
 
	gboŸ
.
	glök


64 .
úq_h™dÀr


67 .
_ømcode_size_div_16_


68 .
_ømcode_size_div_256_


69 .
_ømcode_size_div_16_Æign_256_


70 .
_i˘ag_°¨t_


71 .
_i˘ag_íd_


73 .
FILE_VERSION


74 .
MANUFACTURER_CODE_TELINK


75 .
IMAGE_TYPE


77 .
‹g
 0x0

78 
tj
 
__ª£t


79 .
w‹d
 (
FILE_VERSION
)

80 .
‹g
 0x8

81 .
w‹d
 (0x544c4e4b)

82 .
w‹d
 (0x00880000 + 
_ømcode_size_div_16_Æign_256_
)

84 .
‹g
 0x10

85 
tj
 
__úq


87 .
‹g
 0x12

88 .(
MANUFACTURER_CODE_TELINK
)

89 .(
IMAGE_TYPE
)

91 .
‹g
 0x18

92 .
w‹d
 (
_bö_size_
)

95 @ 
LOW
-
LEVEL
 
INITIALIZATION


97 .
maö


99 .
‹g
 0x20

100 
__ª£t
:

102 @
add
 
debug
, 
PC4
 
ouçut
 1

103 @ 
éﬂdr
 
r1
, 
GPIO_PC4
 @0x800592 
PC4
 
›í


104 @ 
tmov
 
r0
, #139 @0b11101111 = 0xef = #139

105 @ 
t°‹îb
 
r0
, [
r1
, #0]

106 @ 
tmov
 
r0
, #16 @0b00010000 = 0x10 = #16

107 @ 
t°‹îb
 
r0
, [
r1
, #1] @0x800593 
PC4
 
ouçut


109 
éﬂdr
 
r0
, 
FLL_D


110 
éﬂdr
 
r1
, 
FLL_D
+4

111 
éﬂdr
 
r2
, 
FLL_D
+8

113 
FLL_STK
:

114 
tcmp
 
r1
, 
r2


115 
tjge
 
FLL_STK_END


116 
t°‹î
 
r0
, [
r1
, #0]

117 
èdd
 
r1
, #4

118 
tj
 
FLL_STK


119 
FLL_STK_END
:

121 
éﬂdr
 
r0
, 
DAT0


122 
tmc§
 
r0


123 
éﬂdr
 
r0
, 
DAT0
 + 8

124 
tmov
 
r13
, 
r0


126 
éﬂdr
 
r0
, 
DAT0
 + 4

127 
tmc§
 
r0


128 
éﬂdr
 
r0
, 
DAT0
 + 12

129 
tmov
 
r13
, 
r0


131 
tmov
 
r0
, #0

132 
éﬂdr
 
r1
, 
DAT0
 + 16

133 
éﬂdr
 
r2
, 
DAT0
 + 20

135 
ZERO
:

136 
tcmp
 
r1
, 
r2


137 
tjge
 
ZERO_END


138 
t°‹î
 
r0
, [
r1
, #0]

139 
èdd
 
r1
, #4

140 
tj
 
ZERO


141 
ZERO_END
:

143 
éﬂdr
 
r1
, 
DAT0
 + 28

144 
éﬂdr
 
r2
, 
DAT0
 + 32

146 
ZERO_TAG
:

147 
tcmp
 
r1
, 
r2


148 
tjge
 
ZERO_TAG_END


149 
t°‹î
 
r0
, [
r1
, #0]

150 
èdd
 
r1
, #4

151 
tj
 
ZERO_TAG


152 
ZERO_TAG_END
:

154 
SETIC
:

155 
éﬂdr
 
r1
, 
DAT0
 + 24

156 
éﬂdr
 
r0
, 
DAT0
 + 36 @ 
IC
 
èg
 
°¨t


157 
t°‹îb
 
r0
, [
r1
, #0]

158 
èdd
 
r0
, #1 @ 
IC
 
èg
 
íd


159 
t°‹îb
 
r0
, [
r1
, #1]

160 @
tmov
 
r0
, #0;

161 @
t°‹îb
 
	gr0
, [
r1
, #2]

164 
éﬂdr
 
	gr1
, 
DATA_I


165 
éﬂdr
 
	gr2
, 
	gDATA_I
+4

166 
éﬂdr
 
	gr3
, 
	gDATA_I
+8

167 
	gCOPY_DATA
:

168 
tcmp
 
r2
, 
r3


169 
tjge
 
COPY_DATA_END


170 
éﬂdr
 
	gr0
, [
r1
, #0]

171 
t°‹î
 
	gr0
, [
r2
, #0]

172 
èdd
 
	gr1
, #4

173 
èdd
 
	gr2
, #4

174 
tj
 
COPY_DATA


175 
	gCOPY_DATA_END
:

177 
tjl
 
maö


178 
END
: 
tj
 END

180 .
bÆign
 4

181 
DAT0
:

182 .
w‹d
 0x12 @
IRQ
 @0

183 .
w‹d
 0x13 @
SVC
 @4

184 .
w‹d
 (
úq_°k
 + 
IRQ_STK_SIZE
)

185 .
w‹d
 (
RAM_ADDR_END
Ë@12 
°ack
 
íd


186 .
w‹d
 (
_°¨t_bss_
) @16

187 .
w‹d
 (
_íd_bss_
) @20

188 .
w‹d
 (0x80060c) @24

189 .
w‹d
 
_i˘ag_°¨t_
 @28 @ 
IC
 
èg
 
°¨t


190 .
w‹d
 
_i˘ag_íd_
 @32 @ 
IC
 
èg
 
íd


191 .
w‹d
 
_ømcode_size_div_256_
 @36

193 @ .
w‹d
 (0x80058cË@36 
gpio


194 @ .
w‹d
 (0x800620Ë@40 
w©chdog


195 @ .
w‹d
 (0x802c01Ë@44 
w©chdog


196 
DATA_I
:

197 .
w‹d
 
_d°‹ed_


198 .
w‹d
 
_°¨t_d©a_


199 .
w‹d
 
_íd_d©a_


200 .
w‹d
 
_r°‹ed_


202 @
GPIO_PC4
:

203 @ .
	$w‹d
 (0x800592)

205 
FLL_D
:

206 .
w‹d
 0xffffffff

207 .
	`w‹d
 (
_°¨t_d©a_
)

208 .
	`w‹d
 (
RAM_ADDR_END
)

210 .
Æign
 4

211 
__úq
:

212 
çush
 {
r14
}

213 
çush
 {
r0
-
r7
}

214 
tmrss
 
r0


216 
tmov
 
r1
, 
r8


217 
tmov
 
	gr2
, 
r9


218 
tmov
 
	gr3
, 
r10


219 
tmov
 
	gr4
, 
r11


220 
tmov
 
	gr5
, 
r12


221 
	gçush
 {
	gr0
-
	gr5
}

223 
tjl
 
úq_h™dÀr


225 
	gç›
 {
	gr0
-
	gr5
}

226 
tmov
 
	gr8
, 
r1


227 
tmov
 
	gr9
, 
r2


228 
tmov
 
	gr10
,
r3


229 
tmov
 
	gr11
,
r4


230 
tmov
 
	gr12
,
r5


232 
tms§
 
r0


233 
	gç›
 {
	gr0
-
	gr7
}

234 
	gåëi
 {
	gr15
}

236 
	gASMEND
:

238 .
£˘i⁄
 .
bss


239 .
Æign
 4

240 .
lcomm
 
úq_°k
, 
	gIRQ_STK_SIZE


241 .
	gíd


	@platform/boot/8278/cstartup_8278.S

24 #ifde‡
MCU_STARTUP_8278


26 
	~"vîsi⁄_cfg.h
"

28 
	#MCU_RUN_SRAM_EN
 0

	)

30 #i‡
MCU_RUN_SRAM_EN


31 
	#FLL_STK_EN
 0

	)

32 
	#ZERO_IC_TAG_EN
 0

	)

33 
	#IC_TAG_CACHE_ADDR_EQU_EN
 1

	)

34 
	#FLASH_WAKEUP_EN
 1

	)

35 
	#COPY_DATA_EN
 0

	)

36 
	#MULTI_ADDRESS_START
 1

	)

37 
	#MOVE_BIN_CODE_EN
 1

	)

40 
	#FLL_STK_EN
 1

	)

41 
	#ZERO_IC_TAG_EN
 1

	)

42 
	#IC_TAG_CACEH_ADDR_EQU_EN
 0

	)

43 
	#FLASH_WAKEUP_EN
 1

	)

44 
	#COPY_DATA_EN
 1

	)

45 
	#MULTI_ADDRESS_START
 1

	)

46 
	#MOVE_BIN_CODE_EN
 0

	)

49 #i‚de‡
__LOAD_RAM_SIZE__


50 
	#__LOAD_RAM_SIZE__
 0xc

	)

53 #i‚de‡
__IRQ_STK_SIZE__


54 
	#__IRQ_STK_SIZE__
 0x180

	)

56 .
	gcode
 16

58 @ 
MACROS
 
AND
 
	gDEFINIITIONS


61 @ 
	gMode
, 
c‹ª•‹ds
 
to
 
	gbôs
 0-5 
ö
 
	gCPSR


62 .
equ
 
	gMODE_BITS
, 0x1F @ 
Bô
 
mask
 
mode
 
bôs
 
ö
 
	gCPSR


63 .
equ
 
	gIRQ_MODE
, 0x12 @ 
I¡îru±
 
Reque°
 
	gmode


64 .
equ
 
	gSVC_MODE
, 0x13 @ 
Su≥rvis‹
 
	gmode


65 .
equ
 
	gIRQ_STK_SIZE
, 
	g__IRQ_STK_SIZE__


66 .
equ
 
	g__LOAD_RAM
, 
	g__LOAD_RAM_SIZE__


69 @ 
TC32
 
EXCEPTION
 
	gVECTORS


72 .
	g£˘i⁄
 .
	gve˘‹s
,"ax"

73 .
globÆ
 
	g__ª£t


74 .
globÆ
 
	g__úq


75 .
globÆ
 
	g__°¨t


76 .
globÆ
 
__LOAD_RAM


78 
	g__°¨t
: @ 
MUST
, 
ª„ªn˚d
 
by
 
	gboŸ
.
	glök


80 .
úq_h™dÀr


82 .
_ømcode_size_div_16_


83 .
_ømcode_size_div_256_


84 .
_ømcode_size_div_16_Æign_256_


85 .
_ømcode_size_Æign_256_


86 .
_i˘ag_°¨t_


87 .
_i˘ag_íd_


88 .
é_mu…i_addr_L


89 .
é_mu…i_addr_H


91 .
FILE_VERSION


92 .
MANUFACTURER_CODE_TELINK


93 .
IMAGE_TYPE


95 .
‹g
 0x0

96 
tj
 
__ª£t


97 .
w‹d
 (
FILE_VERSION
)

98 .
‹g
 0x8

99 .
	$w‹d
 (0x544c4e4b)

100 #i‡
MOVE_BIN_CODE_EN


101 .
	`w‹d
 (0x00880000 + 
_bö_size_div_16
)

103 .
	`w‹d
 (0x00880000 + 
_ømcode_size_div_16_Æign_256_
)

106 .
‹g
 0x10

107 
tj
 
__úq


109 .
‹g
 0x12

110 .(
MANUFACTURER_CODE_TELINK
)

111 .(
IMAGE_TYPE
)

113 .
‹g
 0x18

114 .
	`w‹d
 (
_bö_size_
)

115 .
maö


117 .
‹g
 0x20

119 
__ª£t
:

121 #i‡
FLASH_WAKEUP_EN


123 
FLASH_WAKEUP_BEGIN
:

124 
éﬂdr
 
r0
,
DATA_I
+44

125 
tmov
 
r1
,#0

126 
t°‹îb
 
r1
,[
r0
,#1]

127 
tmov
 
r1
,#171 @
Fœsh
 
dìp
 
cmd
: 0xAB

128 
t°‹îb
 
r1
,[
r0
,#0]

129 
tmov
 
r2
,#0

130 
tmov
 
r3
,#6

131 
TNOP
:

132 
èdd
 
r2
,#1

133 
tcmp
 
r2
,
r3


134 
tjÀ
 
TNOP


135 
tmov
 
r1
,#1

136 
t°‹îb
 
r1
,[
r0
,#1]

137 
FLASH_WAKEUP_END
:

141 @ 
efu£
 
lﬂd
 
√ed
 
dñay
 
about
 18u
s


142 
tmov
 
r2
,#0

143 
tmov
 
r3
,#110

144 
EFUSE_DELAY
:

145 
èdd
 
r2
,#1

146 
tcmp
 
r2
,
r3


147 
tjÀ
 
EFUSE_DELAY


148 
EFUSE_DELAY_END
:

151 @ 
FILL
 .
STK
 
WITH
 0xFF

153 #i‡
FLL_STK_EN


154 
éﬂdr
 
r0
, 
FLL_D
 @r0 = 0xffffffff

155 
éﬂdr
 
r1
, 
FLL_D
+4 @r1 = 
_íd_cu°om_bss_


156 
éﬂdr
 
r2
, 
FLL_D
+8 @r2 = 
_°ack_íd_


157 
FLL_STK
:

158 
tcmp
 
r1
, 
r2
 @

159 
tjge
 
FLL_STK_END
 @
r1
>=
r2
 
jump
 
to
 FLL_STK_END

160 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_d©a_
)=0xffffffff

161 
èdd
 
r1
, #4 @r1 =Ñ1+4

162 
tj
 
FLL_STK
 @
jump
 
to
 FLL_STK

163 
FLL_STK_END
:

166 @ 
UPDATE
 
SP
 
UNDER
 
IRQ
/
SVC
 
MODE


168 
éﬂdr
 
r0
, 
DAT0
 @r0 = 0x12 
IRQ


169 
tmc§
 
r0
 @
CPSR
=r0

170 
éﬂdr
 
r0
, 
DAT0
 + 8 @r0 = 
úq_°k
 + 
IRQ_STK_SIZE


171 
tmov
 
r13
, 
r0
 @r13/
SP
r0 
upd©e
 SP 
undî
 
IRQ
 
mode


173 
éﬂdr
 
r0
, 
DAT0
 + 4 @r0 = 0x13 
SVC


174 
tmc§
 
r0
 @
CPSR
=r0

175 
éﬂdr
 
r0
, 
DAT0
 + 12 @r0 = 
_°ack_íd_


176 
tmov
 
r13
, 
r0
 @r13r0 
upd©e
 
SP
 
undî
 
SVC
 
mode


178 @ 
IC
 
TAG
 
INITIALIZATION


180 #i‡
ZERO_IC_TAG_EN


181 
ZERO_TAG
:

182 
tmov
 
r0
, #0

183 
éﬂdr
 
r1
, 
DAT0
 + 28 @r1 = 
_i˘ag_°¨t_


184 
éﬂdr
 
r2
, 
DAT0
 + 32 @r2 = 
_i˘ag_íd_


185 
ZERO_TAG_BEGIN
:

186 
tcmp
 
r1
, 
r2


187 
tjge
 
ZERO_TAG_END
 @
r1
>=
r2
 
jump
 
to
 ZERO_TAG_END

188 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_i˘ag_°¨t_
)=r0=0

189 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

190 
tj
 
ZERO_TAG_BEGIN
 @
jump
 
to
 ZERO_TAG_BEGIN

191 
ZERO_TAG_END
:

194 @ 
IC
 
CACHE
 
INITIALIZATION


196 
SET_IC
:

197 
éﬂdr
 
r1
, 
DAT0
 + 24 @Ñ1 = 0x80060c

198 
éﬂdr
 
r0
, 
DAT0
 + 36 @Ñ0 = 
_ømcode_size_Æign_256_


199 
tsh·r
 
r0
,r0,#8 @Ñ0 = 
_ømcode_size_Æign_256_
/256

200 
t°‹îb
 
r0
, [
r1
, #0] @ *(*)(0x80060c) =Ñ0

201 #i‡
IC_TAG_CACHE_ADDR_EQU_EN


204 
èdd
 
r0
, #1 @Ñ0 =Ñ0 + 1

206 
t°‹îb
 
r0
, [
r1
, #1] @ *(*)(0x80060d) =Ñ0

207 
SET_IC_END
:

209 @ 
DCDC
 
INITIALIZATION
 
FOR
 
FLASH


212 
éﬂdr
 
r0
,
DATA_I
+32 @0x00800060

213 
éﬂdr
 
r1
,
DATA_I
+36 @0xff080000

214 
t°‹î
 
r1
,[
r0
,#0] @*(*)0x800060=0xff000000

215 
tsh·r
 
r1
,r1,#24 @0x000000ff

216 
t°‹îb
 
r1
,[
r0
,#4] @
dig_0x64
=0xff

217 
éﬂdr
 
r1
,
DATA_I
+40 @
dig_0x65
=0xf7

218 
t°‹îb
 
r1
,[
r0
,#5]

221 
éﬂdr
 
r0
,
DATA_I
+24 @0x7e

222 
RANA_REG_BEGIN
:

223 
éﬂdr
 
r1
,
DATA_I
+28 @0x008000b8

224 
tmov
 
r2
,
r0
 @
™a_ªg_adr
:0x7e

225 
t°‹îb
 
r2
,[
r1
,#0] @*(*)0x8000b8=0x7e;

226 
tmov
 
r2
,#64 @
™a_ªg_d©
:0x40=64

227 
t°‹îb
 
r2
,[
r1
,#2] @*(*)0x8000ba=0x40;

228 
RWAIT_REG_FINISH
:

229 
éﬂdrb
 
r2
,[
r1
,#2]

230 
tsh·l
 
r2
,r2,#31

231 
tsh·r
 
r2
,r2,#31

232 
tcmp
 
r2
,#1

233 
tjeq
 
RWAIT_REG_FINISH


234 
éﬂdrb
 
r2
,[
r1
,#1]

235 
RANA_REG_END
:

237 
tsh·l
 
r2
,r2,#31

238 
tsh·r
 
r2
,r2,#31

239 
tcmp
 
r2
,#0

241 #i‡
MULTI_ADDRESS_START


242 
tjeq
 
MULTI_ADDRESS_END


243 
MULTI_ADDRESS_BEGIN
:

244 
éﬂdr
 
r0
, 
MULTI_ADDRESS_DATA


245 
éﬂdr
 
r1
, 
MULTI_ADDRESS_DATA
+4

246 
éﬂdr
 
r3
, 
MULTI_ADDRESS_DATA
+8

247 
éﬂdrb
 
r2
, [
r1
,#0]

248 
t°‹îb
 
r2
, [
r0
,#0]

249 
éﬂdrb
 
r2
, [
r3
,#0]

250 
t°‹îb
 
r2
, [
r0
,#1]

251 
tj
 
ZERO_BSS_END
 @ 
dìp
 
wakeup
 
wôh
 
ªã¡i⁄


252 
MULTI_ADDRESS_END
:

255 @ 
DATA
 
INITIALIZATION


257 
COPY_DATA
:

258 
éﬂdr
 
r1
, 
DATA_I
+12 @Ñ1 = 
_d°‹ed_


259 
éﬂdr
 
r2
, 
DATA_I
+16 @Ñ2 = 
_°¨t_d©a_


260 
éﬂdr
 
r3
, 
DATA_I
+20 @Ñ3 = 
_íd_d©a_


261 
COPY_DATA_BEGIN
:

262 
tcmp
 
r2
, 
r3
 @

263 
tjge
 
COPY_DATA_END
 @ 
r2
>=
r3
 
jump
 
to
 COPY_DATA_END

264 
éﬂdr
 
r0
, [
r1
, #0] @Ñ0 = *(*)(
_d°‹ed_
)

265 
t°‹î
 
r0
, [
r2
, #0] @ *(*)(
_°¨t_d©a_
) =Ñ0

266 
èdd
 
r1
, #4 @Ñ1 =Ñ1 + 4

267 
èdd
 
r2
, #4 @Ñ2 =Ñ2 + 4

268 
tj
 
COPY_DATA_BEGIN
 @ 
jump
 
to
 COPY_DATA_BEGIN

269 
COPY_DATA_END
:

271 @ 
BSS
 
INITIALIZATION
 
FOR
 0

273 
BSS_CLEAR
:

274 
tmov
 
r0
, #0 @r0 = 0

275 
éﬂdr
 
r1
, 
DAT0
 + 16 @r1 = 
_°¨t_bss_


276 
éﬂdr
 
r2
, 
DAT0
 + 20 @r2 = 
_íd_bss_


277 
ZERO_BSS_BEGIN
:

278 
tcmp
 
r1
, 
r2


279 
tjge
 
ZERO_BSS_END
 @
r1
>=
r2
 
jump
 
to
 ZERO_BSS_END

280 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_bss_
)=r0=0

281 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

282 
tj
 
ZERO_BSS_BEGIN
 @
jump
 
to
 ZERO_BSS_BEGIN

283 
ZERO_BSS_END
:

285 @ 
CUSTOM
 
DATA
 
INITIALIZATION


287 
COPY_CUSTOM_DATA
:

288 
éﬂdr
 
r1
, 
DATA_I
+48 @Ñ1 = 
_cu°om_°‹ed_


289 
éﬂdr
 
r2
, 
DATA_I
+52 @Ñ2 = 
_°¨t_cu°om_d©a_


290 
éﬂdr
 
r3
, 
DATA_I
+56 @Ñ3 = 
_íd_cu°om_d©a_


291 
COPY_DATA_CUSTOM_BEGIN
:

292 
tcmp
 
r2
, 
r3
 @

293 
tjge
 
COPY_DATA_CUSTOM_END
 @ 
r2
>=
r3
 
jump
 
to
 
COPY_DATA_END


294 
éﬂdr
 
r0
, [
r1
, #0] @Ñ0 = *(*)(
_d°‹ed_
)

295 
t°‹î
 
r0
, [
r2
, #0] @ *(*)(
_°¨t_d©a_
) =Ñ0

296 
èdd
 
r1
, #4 @Ñ1 =Ñ1 + 4

297 
èdd
 
r2
, #4 @Ñ2 =Ñ2 + 4

298 
tj
 
COPY_DATA_CUSTOM_BEGIN
 @ 
jump
 
to
 
COPY_DATA_BEGIN


299 
COPY_DATA_CUSTOM_END
:

301 @ 
CUSTOM
 
BSS
 
INITIALIZATION
 
FOR
 0

303 
ZERO_CUSTOM_BSS
:

304 
tmov
 
r0
, #0

305 
éﬂdr
 
r1
, 
DAT0
 + 40 @r1 = 
_°¨t_cu°om_


306 
éﬂdr
 
r2
, 
DAT0
 + 44 @r2 = 
_íd_cu°om_


307 
ZERO_BSS_CUSTOM_BEGIN
:

308 
tcmp
 
r1
, 
r2


309 
tjge
 
ZERO_BSS_CUSTOM_END
 @
r1
>=
r2
 
jump
 
to
 
ZERO_BSS_END


310 
t°‹î
 
r0
, [
r1
, #0] @*(*)(
_°¨t_bss_
)=r0=0

311 
èdd
 
r1
, #4 @r1 =Ñ1 + 4

312 
tj
 
ZERO_BSS_CUSTOM_BEGIN
 @
jump
 
to
 
ZERO_BSS_BEGIN


313 
ZERO_BSS_CUSTOM_END
:

316 
ENTER_MAIN
:

317 
tjl
 
maö


318 
END
: 
tj
 END

320 .
bÆign
 4

321 
DAT0
:

322 .
w‹d
 0x12 @0 
IRQ


323 .
w‹d
 0x13 @4 
SVC


324 .
	`w‹d
 (
úq_°k
 + 
IRQ_STK_SIZE
) @8

325 .
	`w‹d
 (
_°ack_íd_
Ë@12 
°ack
 
íd


326 .
	`w‹d
 (
_°¨t_bss_
) @16

327 .
	`w‹d
 (
_íd_bss_
) @20

328 .
	`w‹d
 (0x80060c) @24

329 .
w‹d
 
_i˘ag_°¨t_
 @28 
IC
 
èg
 
°¨t


330 .
w‹d
 
_i˘ag_íd_
 @32 
IC
 
èg
 
íd


331 #i‡
IC_TAG_CACHE_ADDR_EQU_EN


332 .
	`w‹d
 (0x00f000) @36

334 .
w‹d
 
_ømcode_size_Æign_256_
 @36

335 .
w‹d
 
_°¨t_cu°om_bss_
 @40

336 .
w‹d
 
_íd_cu°om_bss_
 @44

338 
DATA_I
:

339 .
	`w‹d
 (
_r°‹ed_
) @0

340 .
	`w‹d
 (0x0000007e) @4

341 .
	`w‹d
 (0x0000007e) @8

342 .
w‹d
 
_d°‹ed_
 @12

343 .
w‹d
 
_°¨t_d©a_
 @16

344 .
w‹d
 
_íd_d©a_
 @20

345 .
	`w‹d
 (0x0000007e) @24

346 .
	`w‹d
 (0x008000b8) @28

347 .
	`w‹d
 (0x00800060) @32

348 .
	`w‹d
 (0xff080000) @36

349 .
	`w‹d
 (0x000000f7) @40

350 .
	`w‹d
 (0x0080000c) @44

351 .
w‹d
 
_cu°om_°‹ed_
 @48

352 .
w‹d
 
_°¨t_cu°om_d©a_
 @52

353 .
w‹d
 
_íd_cu°om_d©a_
 @56

355 
FLL_D
:

356 .
w‹d
 0xffffffff @0

357 .
	`w‹d
 (
_íd_cu°om_bss_
) @4

358 .
	`w‹d
 (
_°ack_íd_
) @8

359 .
w‹d
 
_ømcode_size_div_256_
 @12

360 
MULTI_ADDRESS_DATA
:

361 .
	`w‹d
 (0x0080063e) @0

362 .
w‹d
 
é_mu…i_addr_L
 @4

363 .
w‹d
 
é_mu…i_addr_H
 @8

365 .
Æign
 4

366 
__úq
:

367 
çush
 {
r14
} @push R14/LR 

368 
çush
 {
r0
-
r7
} @
push
Ñ0~r7 
öto
 
°ack


369 
tmrss
 
r0
 @
ßve
 
˝§
 
to
Ñ0

371 
tmov
 
r1
, 
	gr8
 @r8~
r12
 
ˇ¬Ÿ
 
u£
 
the
 
way
 
	glike
 {
	gr0
~
	gr7
} 
to
 
push
 
öto
 
°ack


372 
tmov
 
	gr2
, 
	gr9
 @
mu°
 
move
 
	gr8
~
r12
 
öto
 
	gr1
~
r5
 
to
 
push


373 
tmov
 
	gr3
, 
r10


374 
tmov
 
	gr4
, 
r11


375 
tmov
 
	gr5
, 
r12


376 
	gçush
 {
	gr0
-
	gr5
}

378 
tjl
 
	gúq_h™dÀr
 @
jump
 
to
 
úq_h™dÀr


380 
	gç›
 {
	gr0
-
	gr5
} @
p›
 
	gr8
~
r12


381 
tmov
 
	gr8
, 
r1


382 
tmov
 
	gr9
, 
r2


383 
tmov
 
	gr10
,
r3


384 
tmov
 
	gr11
,
r4


385 
tmov
 
	gr12
,
r5


387 
tms§
 
	gr0
 @ 
r0
 
to
 
˝§


388 
	gç›
 {
	gr0
-
	gr7
} @
p›
Ñ0~
r7


389 
	gåëi
 {
	gr15
} @ 
to
 
pc


391 
	gASMEND
:

392 .
£˘i⁄
 .
bss


393 .
Æign
 4

394 .
lcomm
 
úq_°k
, 
	gIRQ_STK_SIZE


395 .
	gíd


	@platform/boot/b91/cstartup_b91.S

24 #ifde‡
MCU_CORE_B91


26 
	~"vîsi⁄_cfg.h
"

28 .
	g£˘i⁄
 .
	gve˘‹s
, "ax"

33 .
›ti⁄
 
	gpush


34 .
›ti⁄
 
	gn‹ñax


35 .
	g‹g
 0x0

37 .
FILE_VERSION


38 .
MANUFACTURER_CODE_TELINK


39 .
IMAGE_TYPE


41 .
globÆ
 
_RESET_ENTRY


42 .
ty≥
 
_RESET_ENTRY
,@
fun˘i⁄


44 .
Æign
 2

45 
_RESET_ENTRY
:

46 
j
 
_START


48 .
w‹d
 (
FILE_VERSION
)

52 .
‹g
 0x12

53 .(
MANUFACTURER_CODE_TELINK
)

54 .(
IMAGE_TYPE
)

56 .
‹g
 0x18

57 .
w‹d
 (
BIN_SIZE
)

59 .
‹g
 0x20

60 .
w‹d
 ('T'<<24 | 'L'<<16 | 'N'<<8 | 'K')

62 .
‹g
 0x26

69 .
›ti⁄
 
p›


70 .
Æign
 2

72 
_START
:

76 
lui
 
t0
,0x80140

77 
li
 
t1
, 0xef

78 
li
 
t2
, 0x10

79 
sb
 
t1
 , 0x30a(
t0
)

80 
sb
 
t2
 , 0x30b(
t0
)

83 .
›ti⁄
 
push


84 .
›ti⁄
 
n‹ñax


85 
œ
 
gp
, 
__globÆ_poöãr$


86 .
›ti⁄
 
p›


89 
œ
 
t0
, 
_STACK_TOP


90 
mv
 
•
, 
t0


92 #ifde‡
__nds_execô


94 
œ
 
t0
, 
_ITB_BASE_


95 
c§w
 
uôb
, 
t0


98 #ifde‡
__riscv_Êí


100 
li
 
t0
, 0x00006000

101 
c§rs
 
t0
, 
m°©us
,Å0

103 
fsc§
 
zîo


107 
œ
 
t0
, 
__ve˘‹s


108 
c§w
 
mtvec
, 
t0


111 
c§si
 
mmisc_˘l
, 2

114 
lui
 
t0
, 0xe4000

115 
li
 
t1
, 0x02

116 
sw
 
t1
, 0x0(
t0
)

119 
c§r
 
t0
, 
mˇche_˘l


120 
‹i
 
t0
,Å0, 1 #/
I
-
Cache


121 
‹i
 
t0
,Å0, 2 #/
D
-
Cache


122 
c§w
 
mˇche_˘l
, 
t0


123 
„n˚
.
i


125 
_RETENTION_RESET_INIT
:

127 
œ
 
t1
, 
_RETENTION_RESET_LMA_START


128 
œ
 
t2
, 
_RETENTION_RESET_VMA_START


129 
œ
 
t3
, 
_RETENTION_RESET_VMA_END


130 
_RETENTION_RESET_BEGIN
:

131 
bÀu
 
t3
, 
t2
, 
_ZERO_AES


132 
lw
 
t0
, 0(
t1
)

133 
sw
 
t0
, 0(
t2
)

134 
addi
 
t1
,Å1, 4

135 
addi
 
t2
,Å2, 4

136 
j
 
_RETENTION_RESET_BEGIN


139 
_ZERO_AES
:

140 
lui
 
t0
, 0

141 
œ
 
t2
, 
_AES_VMA_START


142 
œ
 
t3
, 
_AES_VMA_END


143 
_ZERO_AES_BEGIN
:

144 
bÀu
 
t3
, 
t2
, 
_RAMCODE_INIT


145 
sw
 
t0
, 0(
t2
)

146 
addi
 
t2
,Å2, 4

147 
j
 
_ZERO_AES_BEGIN


151 
_RETENTION_DATA_INIT
:

153 
œ
 
t1
, 
_RETENTION_DATA_LMA_START


154 
œ
 
t2
, 
_RETENTION_DATA_VMA_START


155 
œ
 
t3
, 
_RETENTION_DATA_VMA_END


156 
_RETENTION_DATA_INIT_BEGIN
:

157 
bÀu
 
t3
, 
t2
, 
_RAMCODE_INIT


158 
lw
 
t0
, 0(
t1
)

159 
sw
 
t0
, 0(
t2
)

160 
addi
 
t1
,Å1, 4

161 
addi
 
t2
,Å2, 4

162 
j
 
_RETENTION_DATA_INIT_BEGIN


166 
_RAMCODE_INIT
:

168 
œ
 
t1
, 
_RAMCODE_LMA_START


169 
œ
 
t2
, 
_RAMCODE_VMA_START


170 
œ
 
t3
, 
_RAMCODE_VMA_END


171 
_RAMCODE_INIT_BEGIN
:

172 
bÀu
 
t3
, 
t2
, 
_DATA_INIT


173 
lw
 
t0
, 0(
t1
)

174 
sw
 
t0
, 0(
t2
)

175 
addi
 
t1
,Å1, 4

176 
addi
 
t2
,Å2, 4

177 
j
 
_RAMCODE_INIT_BEGIN


181 
_DATA_INIT
:

182 
œ
 
t1
, 
_DATA_LMA_START


183 
œ
 
t2
, 
_DATA_VMA_START


184 
œ
 
t3
, 
_DATA_VMA_END


185 
_DATA_INIT_BEGIN
:

186 
bÀu
 
t3
, 
t2
, 
_ZERO_BSS


187 
lw
 
t0
, 0(
t1
)

188 
sw
 
t0
, 0(
t2
)

189 
addi
 
t1
,Å1, 4

190 
addi
 
t2
,Å2, 4

191 
j
 
_DATA_INIT_BEGIN


194 
_ZERO_BSS
:

195 
lui
 
t0
, 0

196 
œ
 
t2
, 
_BSS_VMA_START


197 
œ
 
t3
, 
_BSS_VMA_END


198 
_ZERO_BSS_BEGIN
:

199 
bÀu
 
t3
, 
t2
, 
_FILL_STK


200 
sw
 
t0
, 0(
t2
)

201 
addi
 
t2
,Å2, 4

202 
j
 
_ZERO_BSS_BEGIN


205 
_FILL_STK
:

207 
lui
 
t0
, 0x55555

208 
addi
 
t0
,Å0, 0x555

209 
œ
 
t2
, 
_BSS_VMA_END


210 
œ
 
t3
, 
_STACK_TOP


211 
_FILL_STK_BEGIN
:

212 
bÀu
 
t3
, 
t2
, 
_MAIN_FUNC


213 
sw
 
t0
, 0(
t2
)

214 
addi
 
t2
,Å2, 4

215 
j
 
_FILL_STK_BEGIN


218 
_MAIN_FUNC
:

219 
n›


221 
œ
 
t0
, 
maö


222 
jÆr
 
t0


224 
n›


225 
n›


226 
n›


227 
n›


228 
n›


229 
_END
:

230 
j
 
_END


233 .
£˘i⁄
 .
ªã¡i⁄_ª£t
, "ax"

234 .
›ti⁄
 
push


235 .
›ti⁄
 
n‹ñax


236 .
globÆ
 
_IRESET_ENTRY


237 .
ty≥
 
_IRESET_ENTRY
,@
fun˘i⁄


239 .
Æign
 2

240 
_IRESET_ENTRY
:

242 
j
 
_ISTART


244 .
‹g
 0x22

245 
_ISTART
:

248 
lui
 
t0
,0x80140

249 
li
 
t1
, 0xef

250 
li
 
t2
, 0x10

251 
sb
 
t1
 , 0x30a(
t0
)

252 
sb
 
t2
 , 0x30b(
t0
)

256 
œ
 
gp
, 
__globÆ_poöãr$


257 .
›ti⁄
 
p›


260 
œ
 
t0
, 
_STACK_TOP


261 
mv
 
•
, 
t0


263 #ifde‡
__nds_execô


265 
œ
 
t0
, 
_ITB_BASE_


266 
c§w
 
uôb
, 
t0


269 #ifde‡
__riscv_Êí


271 
li
 
t0
, 0x00006000

272 
c§rs
 
t0
, 
m°©us
,Å0

274 
fsc§
 
zîo


278 
œ
 
t0
, 
__ve˘‹s


279 
c§w
 
mtvec
, 
t0


282 
c§si
 
mmisc_˘l
, 2

285 
lui
 
t0
, 0xe4000

286 
li
 
t1
, 0x02

287 
sw
 
t1
, 0x0(
t0
)

290 
c§r
 
t0
, 
mˇche_˘l


291 
‹i
 
t0
,Å0, 1 #/
I
-
Cache


292 
‹i
 
t0
,Å0, 2 #/
D
-
Cache


293 
c§w
 
mˇche_˘l
, 
t0


294 
„n˚
.
i


298 
_WAKEUP_FLASH
:

299 
lui
 
t0
 , 0x80140

300 
li
 
t1
 , 0xff

301 
li
 
t2
 , 0x0

302 
li
 
t3
 , 0xab

303 
sb
 
t1
 , 0x329(
t0
)

304 
sb
 
t2
 , 0x101(
t0
)

305 
sb
 
t3
 , 0x100(
t0
)

306 
_MSPI_WAIT
:

307 
lui
 
t0
 , 0x80140

308 
lb
 
t2
 , 0x102(
t0
)

309 
li
 
t3
 , 0x1

310 
li
 
t4
 , 0x10

311 
beq
 
t3
 , 
t2
 ,
_MSPI_WAIT


312 
sb
 
t4
 , 0x101(
t0
)

315 
lui
 
t0
,0x80140

316 
li
 
t1
, 0x00

317 
sb
 
t1
 , 0x30b(
t0
)

320 
li
 
t0
 , 0

321 
li
 
t1
 , 226

322 
_WAIT_EFUSE_LOAD_FINISH
:

323 
addi
 
t0
 ,Å0 , 1

324 
bgeu
 
t1
 , 
t0
 , 
_WAIT_EFUSE_LOAD_FINISH


328 
lui
 
t0
,0x80140

329 
li
 
t1
, 0x10

330 
sb
 
t1
 , 0x30b(
t0
)

332 
_MULTI_ADDRESS_BEGIN
:

333 
lui
 
t0
 , 0x80140

334 
œ
 
t1
 , 
g_pm_m•i_cfg


335 
lw
 
t2
 , 0(
t1
)

336 
sw
 
t2
 , 0x104(
t0
)

339 
_IZERO_AES
:

340 
lui
 
t0
, 0

341 
œ
 
t2
, 
_AES_VMA_START


342 
œ
 
t3
, 
_AES_VMA_END


343 
_IZERO_AES_BEGIN
:

344 
bÀu
 
t3
, 
t2
, 
_IDATA_INIT


345 
sw
 
t0
, 0(
t2
)

346 
addi
 
t2
,Å2, 4

347 
j
 
_IZERO_AES_BEGIN


351 
_IRAMCODE_INIT
:

353 
œ
 
t1
, 
_RAMCODE_LMA_START


354 
œ
 
t2
, 
_RAMCODE_VMA_START


355 
œ
 
t3
, 
_RAMCODE_VMA_END


356 
_IRAMCODE_INIT_BEGIN
:

357 
bÀu
 
t3
, 
t2
, 
_IDATA_INIT


358 
lw
 
t0
, 0(
t1
)

359 
sw
 
t0
, 0(
t2
)

360 
addi
 
t1
,Å1, 4

361 
addi
 
t2
,Å2, 4

362 
j
 
_IRAMCODE_INIT_BEGIN


366 
_IDATA_INIT
:

368 
œ
 
t1
, 
_DATA_LMA_START


369 
œ
 
t2
, 
_DATA_VMA_START


370 
œ
 
t3
, 
_DATA_VMA_END


371 
_IDATA_INIT_BEGIN
:

372 
bÀu
 
t3
, 
t2
, 
_IZERO_BSS


373 
lw
 
t0
, 0(
t1
)

374 
sw
 
t0
, 0(
t2
)

375 
addi
 
t1
,Å1, 4

376 
addi
 
t2
,Å2, 4

377 
j
 
_IDATA_INIT_BEGIN


380 
_IZERO_BSS
:

381 
lui
 
t0
, 0

382 
œ
 
t2
, 
_BSS_VMA_START


383 
œ
 
t3
, 
_BSS_VMA_END


384 
_IZERO_BSS_BEGIN
:

385 
bÀu
 
t3
, 
t2
, 
_IFILL_STK


386 
sw
 
t0
, 0(
t2
)

387 
addi
 
t2
,Å2, 4

388 
j
 
_IZERO_BSS_BEGIN


392 
_IFILL_STK
:

394 
lui
 
t0
, 0x55555

395 
addi
 
t0
,Å0, 0x555

396 
œ
 
t2
, 
_BSS_VMA_END


397 
œ
 
t3
, 
_STACK_TOP


398 
_IFILL_STK_BEGIN
:

399 
bÀu
 
t3
, 
t2
, 
_IMAIN_FUNC


400 
sw
 
t0
, 0(
t2
)

401 
addi
 
t2
,Å2, 4

402 
j
 
_IFILL_STK_BEGIN


405 
_IMAIN_FUNC
:

406 
n›


408 
œ
 
t0
, 
maö


409 
jÆr
 
t0


411 
n›


412 
n›


413 
n›


414 
n›


415 
n›


416 
_IEND
:

417 
j
 
_IEND


420 .
ãxt


421 .
globÆ
 
deÁu…_úq_íåy


422 .
Æign
 2

424 
deÁu…_úq_íåy
:

425 1: 
j
 1b

427 .
wók
 
å≠_h™dÀr


429 
å≠_h™dÀr
:

430 1: 
j
 1b

432 .
ma¸o
 
INTERRUPT
 
num


433 .
wók
 
íåy_úq
\
num


434 .
£t
 
íåy_úq
\
num
, 
deÁu…_úq_íåy


435 .
íåy_úq
\
num


436 .
ídm


438 
	#VECTOR_NUMINTRS
 63

	)

440 .
£˘i⁄
 .
øm_code
, "ax"

442 .
globÆ
 
__ve˘‹s


443 .
bÆign
 256

446 
__ve˘‹s
:

448 .
å≠_íåy


451 .
Ætma¸o


452 .
£t
 
úqno
, 1

453 .
ª±
 
VECTOR_NUMINTRS


454 
INTERRUPT
 %
úqno


455 .
£t
 
úqno
, irqno+1

456 .
ídr


	@platform/boot/link_cfg.S

24 
	~"vîsi⁄_cfg.h
"

26 
	gLINK_CFG
:

27 .
equ
 
__BOOT_LOADER_IMAGE
, 
	gIS_BOOT_LOADER_IMAGE


28 .
equ
 
	g__FW_RAMCODE_SIZE_MAX
, 
	gRESV_FOR_APP_RAM_CODE_SIZE


29 .
equ
 
	g__FW_OFFSET
, 
	gIMAGE_OFFSET


31 .
globÆ
 
	g__BOOT_LOADER_IMAGE


32 .
globÆ
 
	g__FW_OFFSET


33 .
globÆ
 
__FW_RAMCODE_SIZE_MAX


34 
	gLINK_CFG_END
:

	@platform/chip_8258/adc.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"™Æog.h
"

28 
	~"bô.h
"

29 
	~"gpio.h
"

36 
	mADC_SAMPLE_RATE_23K
,

37 
	mADC_SAMPLE_RATE_96K


38 }
	tADC_Sam∂eR©eTy≥Def
;

40 
	#ADC_SAMPLE_RATE_SELECT
 
ADC_SAMPLE_RATE_23K


	)

46 
	madc_vªf
;

47 
	madc_ˇlib_í
;

48 }
	tadc_vªf_˘r_t
;

50 
adc_vªf_˘r_t
 
adc_vªf_cfg
;

57 
	mADC_VREF_0P6V
,

58 
	mADC_VREF_0P9V
,

59 
	mADC_VREF_1P2V
,

60 
	mADC_VREF_VBAT_N
,

61 }
	tADC_RefVﬁTy≥Def
;

67 
	mADC_VBAT_DIVIDER_OFF
 = 0,

68 
	mADC_VBAT_DIVIDER_1F4
,

69 
	mADC_VBAT_DIVIDER_1F3
,

70 
	mADC_VBAT_DIVIDER_1F2


71 }
	tADC_Vb©DivTy≥Def
;

77 
	mNOINPUTN
,

78 
	mB0N
,

79 
	mB1N
,

80 
	mB2N
,

81 
	mB3N
,

82 
	mB4N
,

83 
	mB5N
,

84 
	mB6N
,

85 
	mB7N
,

86 
	mC4N
,

87 
	mC5N
,

88 
	mPGA0N
,

89 
	mPGA1N
,

90 
	mTEMSENSORN
,

91 
	mRSVD_N
,

92 
	mGND
,

93 }
	tADC_I≈utNchTy≥Def
;

99 
	mNOINPUTP
,

100 
	mB0P
,

101 
	mB1P
,

102 
	mB2P
,

103 
	mB3P
,

104 
	mB4P
,

105 
	mB5P
,

106 
	mB6P
,

107 
	mB7P
,

108 
	mC4P
,

109 
	mC5P
,

110 
	mPGA0P
,

111 
	mPGA1P
,

112 
	mTEMSENSORP
,

113 
	mRSVD_P
,

114 
	mVBAT
,

115 }
	tADC_I≈utPchTy≥Def
;

121 
	mRES8
,

122 
	mRES10
,

123 
	mRES12
,

124 
	mRES14


125 }
	tADC_ResTy≥Def
;

131 
	mSINGLE_ENDED_MODE
 = 0,

132 
	mDIFFERENTIAL_MODE
 = 1,

133 }
	tADC_I≈utModeTy≥Def
;

139 
	mSAMPLING_CYCLES_3
,

140 
	mSAMPLING_CYCLES_6
,

141 
	mSAMPLING_CYCLES_9
,

142 
	mSAMPLING_CYCLES_12
,

143 
	mSAMPLING_CYCLES_15
,

144 
	mSAMPLING_CYCLES_18
,

145 
	mSAMPLING_CYCLES_21
,

146 
	mSAMPLING_CYCLES_24
,

147 
	mSAMPLING_CYCLES_27
,

148 
	mSAMPLING_CYCLES_30
,

149 
	mSAMPLING_CYCLES_33
,

150 
	mSAMPLING_CYCLES_36
,

151 
	mSAMPLING_CYCLES_39
,

152 
	mSAMPLING_CYCLES_42
,

153 
	mSAMPLING_CYCLES_45
,

154 
	mSAMPLING_CYCLES_48
,

155 }
	tADC_SampCycTy≥Def
;

161 
	mADC_LEFT_CHN
 = 
BIT
(0),

162 
	mADC_RIGHT_CHN
 = 
BIT
(1),

163 
	mADC_MISC_CHN
 = 
BIT
(2),

164 
	mADC_RNS_CHN
 = 
BIT
(3),

165 }
	tADC_ChTy≥Def
;

171 
	mADC_PRESCALER_1
,

172 
	mADC_PRESCALER_1F2
,

173 
	mADC_PRESCALER_1F4
,

174 
	mADC_PRESCALER_1F8


175 }
	tADC_PªSˇlögTy≥Def
;

181 
	mADC_CUR_TRIM_PER75
,

182 
	mADC_CUR_TRIM_PER100
,

183 
	mADC_CUR_TRIM_PER125
,

184 
	mADC_CUR_TRIM_PER150


185 }
	tADC_Cur_TrimTy≥Def
;

189 
	mGAIN_STAGE_BIAS_PER75
 = 0,

190 
	mGAIN_STAGE_BIAS_PER100
,

191 
	mGAIN_STAGE_BIAS_PER125
,

192 
	mGAIN_STAGE_BIAS_PER150
,

193 }
	tADC_Gaö_BüsTy≥Def
;

199 
	mADC_NORMAL_MODE
 = 0,

200 
	mADC_RNS_MODE
 = 
BIT
(4),

201 }
	tADC_ModeTy≥Def
;

207 
	mSAR_ADC_RNG_MODE
 = 0,

208 
	mR_RNG_MODE_0
 = 2,

209 
	mR_RNG_MODE_1
 = 3,

210 
	mADC_DAT12_RNG_MODE
 = 4,

211 
	mADC_DAT5_RNG_MODE
 = 6,

212 }
	tRNG_SrcTy≥Def
;

216 
	mREAD_UPDATA
 = 
BIT
(3),

217 
	mCLOCLK_UPDATA
 = 
BIT
(4),

218 }
	tRNG_Upd©aTy≥Def
;

225 
ölöe
 
	$adc_ˇlib_vªf_íabÀ
(
í
)

227 
adc_vªf_cfg
.
adc_ˇlib_í
 = 
í
;

228 
	}
}

235 
ölöe
 
	$adc_ª£t_adc_moduÀ
()

237 
ªg_r°1
 = 
FLD_RST1_ADC
;

238 
ªg_r°1
 = 0;

239 
	}
}

246 
ölöe
 
	$adc_íabÀ_˛k_24m_to_ßr_adc
(
í
)

248 if(
í
)

250 
	`™Æog_wrôe
(
¨eg_˛k_£âög
, 
	`™Æog_ªad
◊ªg_˛k_£âögË| 
FLD_CLK_24M_TO_SAR_EN
);

254 
	`™Æog_wrôe
(
¨eg_˛k_£âög
, 
	`™Æog_ªad
◊ªg_˛k_£âögË& ~
FLD_CLK_24M_TO_SAR_EN
);

256 
	}
}

265 
	#¨eg_adc_ßm∂ög_˛k_div
 0xf4

	)

267 
	mFLD_ADC_SAMPLE_CLK_DIV
 = 
BIT_RNG
(0,2),

275 
ölöe
 
	$adc_£t_ßm∂e_˛k
(
div
)

278 
	`™Æog_wrôe
(
¨eg_adc_ßm∂ög_˛k_div
, 
div
 & 0x07 );

279 
	}
}

301 
	#¨eg_adc_vªf
 0xe7

	)

303 
	mFLD_ADC_VREF_CHN_L
 = 
BIT_RNG
(0,1),

304 
	mFLD_ADC_VREF_CHN_R
 = 
BIT_RNG
(2,3),

305 
	mFLD_ADC_VREF_CHN_M
 = 
BIT_RNG
(4,5),

315 
ölöe
 
	$adc_£t_vªf
(
ADC_RefVﬁTy≥Def
 
vRef_L
, ADC_RefVﬁTy≥De‡
vRef_R
, ADC_RefVﬁTy≥De‡
vRef_M
)

317 
	`™Æog_wrôe
(
¨eg_adc_vªf
, 
vRef_L
 | 
vRef_R
 << 2 | 
vRef_M
 << 4);

318 
	}
}

325 
ölöe
 
	$adc_£t_vªf_chn_À·
(
ADC_RefVﬁTy≥Def
 
v_ªf
)

327 
	`™Æog_wrôe
(
¨eg_adc_vªf
, ((
	`™Æog_ªad
◊ªg_adc_vªfË& (~
FLD_ADC_VREF_CHN_L
)Ë| (
v_ªf
)));

328 
	}
}

335 
ölöe
 
	$adc_£t_vªf_chn_right
(
ADC_RefVﬁTy≥Def
 
v_ªf
)

337 
	`™Æog_wrôe
(
¨eg_adc_vªf
, ((
	`™Æog_ªad
◊ªg_adc_vªfË& (~
FLD_ADC_VREF_CHN_R
)Ë| (
v_ªf
 << 2)));

338 
	}
}

345 
ölöe
 
	$adc_£t_vªf_chn_misc
(
ADC_RefVﬁTy≥Def
 
v_ªf
)

347 
	`™Æog_wrôe
(
¨eg_adc_vªf
, ((
	`™Æog_ªad
◊ªg_adc_vªfË& (~
FLD_ADC_VREF_CHN_M
)Ë| (
v_ªf
 << 4)));

348 
	}
}

356 
adc_£t_ªf_vﬁège
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_RefVﬁTy≥Def
 
v_ªf
);

360 
	#¨eg_adc_vªf_vb©_div
 0xf9

	)

362 
	mFLD_ADC_VREF_VBAT_DIV
 = 
BIT_RNG
(2,3),

369 
ölöe
 
	$adc_£t_vªf_vb©_dividî
(
ADC_Vb©DivTy≥Def
 
vb©_div
)

371 
	`™Æog_wrôe
(
¨eg_adc_vªf_vb©_div
, (
	`™Æog_ªad
◊ªg_adc_vªf_vb©_divË& (~
FLD_ADC_VREF_VBAT_DIV
)Ë| (
vb©_div
 << 2));

372 
	}
}

417 
	#¨eg_adc_aö_chn_misc
 0xe8

	)

418 
	#¨eg_adc_aö_chn_À·
 0xe9

	)

419 
	#¨eg_adc_aö_chn_right
 0xó

	)

421 
	mFLD_ADC_AIN_NEGATIVE
 = 
BIT_RNG
(0,3),

422 
	mFLD_ADC_AIN_POSITIVE
 = 
BIT_RNG
(4,7),

431 
ölöe
 
	$adc_£t_aö_chn_misc
(
ADC_I≈utPchTy≥Def
 
p_aö
, 
ADC_I≈utNchTy≥Def
 
n_aö
)

433 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, 
n_aö
 | 
p_aö
 << 4);

434 
	}
}

442 
ölöe
 
	$adc_£t_aö_chn_À·
(
ADC_I≈utPchTy≥Def
 
p_aö
, 
ADC_I≈utNchTy≥Def
 
n_aö
)

444 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_À·
, 
n_aö
 | 
p_aö
 << 4);

445 
	}
}

453 
ölöe
 
	$adc_£t_aö_chn_right
(
ADC_I≈utPchTy≥Def
 
p_aö
, 
ADC_I≈utNchTy≥Def
 
n_aö
)

455 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_right
, 
n_aö
 | 
p_aö
 << 4);

456 
	}
}

463 
ölöe
 
	$adc_£t_aö_√g©ive_chn_misc
(
ADC_I≈utNchTy≥Def
 
v_aö
)

465 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_miscË& (~
FLD_ADC_AIN_NEGATIVE
)Ë| (
v_aö
));

466 
	}
}

473 
ölöe
 
	$adc_£t_aö_posôive_chn_misc
(
ADC_I≈utPchTy≥Def
 
v_aö
)

475 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_miscË& (~
FLD_ADC_AIN_POSITIVE
)Ë| (
v_aö
 << 4));

476 
	}
}

483 
ölöe
 
	$adc_£t_aö_√g©ive_chn_À·
(
ADC_I≈utNchTy≥Def
 
v_aö
)

485 
	`™Æog_wrôe
 (
¨eg_adc_aö_chn_À·
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_À·Ë& (~
FLD_ADC_AIN_NEGATIVE
)Ë| (
v_aö
));

486 
	}
}

493 
ölöe
 
	$adc_£t_aö_posôive_chn_À·
(
ADC_I≈utPchTy≥Def
 
v_aö
)

495 
	`™Æog_wrôe
 (
¨eg_adc_aö_chn_À·
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_À·Ë& (~
FLD_ADC_AIN_POSITIVE
)Ë| (
v_aö
 << 4));

496 
	}
}

503 
ölöe
 
	$adc_£t_aö_√g©ive_chn_right
(
ADC_I≈utNchTy≥Def
 
v_aö
)

505 
	`™Æog_wrôe
 (
¨eg_adc_aö_chn_right
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_rightË& (~
FLD_ADC_AIN_NEGATIVE
)Ë| (
v_aö
));

506 
	}
}

513 
ölöe
 
	$adc_£t_aö_posôive_chn_right
(
ADC_I≈utPchTy≥Def
 
v_aö
)

515 
	`™Æog_wrôe
 (
¨eg_adc_aö_chn_right
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_rightË& (~
FLD_ADC_AIN_POSITIVE
)Ë| (
v_aö
 << 4));

516 
	}
}

538 
	#¨eg_adc_ªs_l_r
 0xeb

	)

540 
	mFLD_ADC_RES_L
 = 
BIT_RNG
(0,1),

541 
	mFLD_ADC_RES_R
 = 
BIT_RNG
(4,5),

549 
ölöe
 
	$adc_£t_ªsﬁuti⁄_chn_À·
(
ADC_ResTy≥Def
 
v_ªs
)

551 
	`™Æog_wrôe
(
¨eg_adc_ªs_l_r
, (
	`™Æog_ªad
◊ªg_adc_ªs_l_rË& (~
FLD_ADC_RES_L
)Ë| (
v_ªs
));

552 
	}
}

559 
ölöe
 
	$adc_£t_ªsﬁuti⁄_chn_right
(
ADC_ResTy≥Def
 
v_ªs
)

561 
	`™Æog_wrôe
(
¨eg_adc_ªs_l_r
, (
	`™Æog_ªad
◊ªg_adc_ªs_l_rË& (~
FLD_ADC_RES_R
)Ë| (
v_ªs
 << 4));

562 
	}
}

572 
adc_£t_ªsﬁuti⁄
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_ResTy≥Def
 
v_ªs
);

576 
	#™¨eg_adc_ªs_m
 0xec

	)

578 
	mFLD_ADC_RES_M
 = 
BIT_RNG
(0,1),

579 
	mFLD_ADC_EN_DIFF_CHN_L
 = 
BIT
(4),

580 
	mFLD_ADC_EN_DIFF_CHN_R
 = 
BIT
(5),

581 
	mFLD_ADC_EN_DIFF_CHN_M
 = 
BIT
(6),

588 
ölöe
 
	$adc_£t_ªsﬁuti⁄_chn_misc
(
ADC_ResTy≥Def
 
v_ªs
)

590 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, (
	`™Æog_ªad
◊«ªg_adc_ªs_mË& (~
FLD_ADC_RES_M
)Ë| (
v_ªs
));

591 
	}
}

598 
ölöe
 
	$adc_£t_öput_mode_chn_À·
(
ADC_I≈utModeTy≥Def
 
m_öput
)

600 if(
m_öput
){

601 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, (
	`™Æog_ªad
◊«ªg_adc_ªs_mË| 
FLD_ADC_EN_DIFF_CHN_L
 ));

604 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, (
	`™Æog_ªad
◊«ªg_adc_ªs_mË& (~
FLD_ADC_EN_DIFF_CHN_L
)));

606 
	}
}

613 
ölöe
 
	$adc_£t_öput_mode_chn_right
(
ADC_I≈utModeTy≥Def
 
m_öput
)

615 if(
m_öput
){

616 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, 
	`™Æog_ªad
◊«ªg_adc_ªs_mË| 
FLD_ADC_EN_DIFF_CHN_R
);

619 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, 
	`™Æog_ªad
◊«ªg_adc_ªs_mË& (~
FLD_ADC_EN_DIFF_CHN_R
));

621 
	}
}

628 
ölöe
 
	$adc_£t_öput_mode_chn_misc
(
ADC_I≈utModeTy≥Def
 
m_öput
)

630 if(
m_öput
){

631 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, 
	`™Æog_ªad
◊«ªg_adc_ªs_mË| 
FLD_ADC_EN_DIFF_CHN_M
);

634 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, 
	`™Æog_ªad
◊«ªg_adc_ªs_mË& (~
FLD_ADC_EN_DIFF_CHN_M
));

636 
	}
}

644 
adc_£t_öput_mode
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_I≈utModeTy≥Def
 
m_öput
);

647 
	#¨eg_adc_tsm≠À_m
 0xì

	)

649 
	mFLD_ADC_TSAMPLE_CYCLE_CHN_M
 = 
BIT_RNG
(0,3),

657 
ölöe
 
	$adc_£t_tßm∂e_cy˛e_chn_misc
(
ADC_SampCycTy≥Def
 
adcST
)

661 
	`™Æog_wrôe
(
¨eg_adc_tsm≠À_m
, 
adcST
);

662 
	}
}

679 
	#¨eg_adc_tsm≠À_l_r
 0xed

	)

681 
	mFLD_ADC_TSAMPLE_CYCLE_CHN_L
 = 
BIT_RNG
(0,3),

682 
	mFLD_ADC_TSAMPLE_CYCLE_CHN_R
 = 
BIT_RNG
(4,7),

690 
ölöe
 
	$adc_£t_tßm∂e_cy˛e_chn_À·
(
ADC_SampCycTy≥Def
 
adcST
)

692 
	`™Æog_wrôe
(
¨eg_adc_tsm≠À_l_r
, (
	`™Æog_ªad
◊ªg_adc_tsm≠À_l_rË& (~
FLD_ADC_TSAMPLE_CYCLE_CHN_L
)Ë| (
adcST
));

693 
	}
}

700 
ölöe
 
	$adc_£t_tßm∂e_cy˛e_chn_right
(
ADC_SampCycTy≥Def
 
adcST
)

702 
	`™Æog_wrôe
(
¨eg_adc_tsm≠À_l_r
, (
	`™Æog_ªad
◊ªg_adc_tsm≠À_l_rË& (~
FLD_ADC_TSAMPLE_CYCLE_CHN_R
)Ë| (
adcST
 << 4));

703 
	}
}

711 
adc_£t_tßm∂e_cy˛e
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_SampCycTy≥Def
 
adcST
);

727 
	#¨eg_r_max_mc
 0xef

	)

729 
	mFLD_R_MAX_MC0
 = 
BIT_RNG
(0,7),

731 
	#¨eg_r_max_c
 0xf0

	)

733 
	mFLD_R_MAX_C0
 = 
BIT_RNG
(0,7),

736 
	#¨eg_r_max_s
 0xf1

	)

738 
	mFLD_R_MAX_S
 = 
BIT_RNG
(0,3),

739 
	mFLD_R_MAX_C1
 = 
BIT_RNG
(4,5),

740 
	mFLD_R_MAX_MC1
 = 
BIT_RNG
(6,7),

748 
ölöe
 
	$adc_£t_Àngth_£t_°©e
(
r_max_s
)

750 
	`™Æog_wrôe
(
¨eg_r_max_s
, (
	`™Æog_ªad
◊ªg_r_max_sË& (~
FLD_R_MAX_S
)Ë| (
r_max_s
));

751 
	}
}

760 
ölöe
 
	$adc_£t_Àngth_ˇ±uª_°©e_f‹_chn_misc_∫s
(
r_max_mc
)

762 
	`™Æog_wrôe
(
¨eg_r_max_mc
, (
r_max_mc
 & 0x0ff));

763 
	`™Æog_wrôe
(
¨eg_r_max_s
, ((
	`™Æog_ªad
◊ªg_r_max_sË& (~
FLD_R_MAX_MC1
)Ë| ((
r_max_mc
&0x3ff) >> 8) << 6));

764 
	}
}

773 
ölöe
 
	$adc_£t_Àngth_ˇ±uª_°©e_f‹_chn_À·_right
(
r_max_c
)

775 
	`™Æog_wrôe
(
¨eg_r_max_c
, 
r_max_c
 & 0xff);

776 
	`™Æog_wrôe
(
¨eg_r_max_s
, (
	`™Æog_ªad
◊ªg_r_max_sË& (~
FLD_R_MAX_C1
)Ë| (((
r_max_c
&0x3ff) >> 8) << 4));

777 
	}
}

786 
ölöe
 
	$adc_£t_°©e_Àngth
(
R_max_mc
, 
R_max_c
,
R_max_s
)

788 
	`™Æog_wrôe
(
¨eg_r_max_mc
, 
R_max_mc
);

789 
	`™Æog_wrôe
(
¨eg_r_max_c
, 
R_max_c
);

790 
	`™Æog_wrôe
(
¨eg_r_max_s
, ((
R_max_mc
 >> 8Ë<< 6Ë| ((
R_max_c
 >> 8Ë<< 4Ë| (
R_max_s
 & 
FLD_R_MAX_S
));

791 
	}
}

801 
	#¨eg_adc_chn_í
 0xf2

	)

803 
	mFLD_ADC_CHN_EN_L
 = 
BIT
(0),

804 
	mFLD_ADC_CHN_EN_R
 = 
BIT
(1),

805 
	mFLD_ADC_CHN_EN_M
 = 
BIT
(2),

806 
	mFLD_ADC_CHN_EN_RNS
 = 
BIT
(3),

807 
	mFLD_ADC_MAX_SCNT
 = 
BIT_RNG
(4,6),

814 
ölöe
 
	$adc_£t_chn_íabÀ
(
ADC_ChTy≥Def
 
ad_ch
)

816 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, (
	`™Æog_ªad
◊ªg_adc_chn_íË& 0xf0Ë| 
ad_ch
);

817 
	}
}

825 
ölöe
 
	$adc_£t_chn_íabÀ_™d_max_°©e_˙t
(
ADC_ChTy≥Def
 
ad_ch
, 
s_˙t
)

827 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, 
ad_ch
 | ((
s_˙t
 & 0x07) << 4));

828 
	}
}

835 
ölöe
 
	$adc_£t_max_°©e_˙t
(
s_˙t
)

837 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, (
	`™Æog_ªad
◊ªg_adc_chn_íË& (~
FLD_ADC_MAX_SCNT
)Ë| ((
s_˙t
 & 0x07) << 4));

838 
	}
}

854 
	#¨eg_aö_sˇÀ
 0xÁ

	)

856 
	mFLD_ADC_ITRIM_PREAMP
 = 
BIT_RNG
(0,1),

857 
	mFLD_ADC_ITRIM_VREFBUF
 = 
BIT_RNG
(2,3),

858 
	mFLD_ADC_ITRIM_VCMBUF
 = 
BIT_RNG
(4,5),

859 
	mFLD_SEL_AIN_SCALE
 = 
BIT_RNG
(6,7),

867 
ölöe
 
	$adc_£t_ôrim_¥ómp
(
ADC_Cur_TrimTy≥Def
 
büs
)

869 
	`™Æog_wrôe
(
¨eg_aö_sˇÀ
, (
	`™Æog_ªad
◊ªg_aö_sˇÀË& (~
FLD_ADC_ITRIM_PREAMP
)Ë| (
büs
 << 0));

870 
	}
}

877 
ölöe
 
	$adc_£t_ôrim_vªfbuf
(
ADC_Cur_TrimTy≥Def
 
büs
)

879 
	`™Æog_wrôe
(
¨eg_aö_sˇÀ
, (
	`™Æog_ªad
◊ªg_aö_sˇÀË& (~
FLD_ADC_ITRIM_VREFBUF
)Ë| (
büs
 << 2));

880 
	}
}

887 
ölöe
 
	$adc_£t_ôrim_vcmbuf
(
ADC_Cur_TrimTy≥Def
 
büs
)

889 
	`™Æog_wrôe
(
¨eg_aö_sˇÀ
, (
	`™Æog_ªad
◊ªg_aö_sˇÀË& (~
FLD_ADC_ITRIM_VCMBUF
)Ë| (
büs
 << 4));

890 
	}
}

922 
	#¨eg_adc_pga_boo°
 0xfb

	)

924 
	mFLD_PGA_CAP_TRIM_EN_L
 = 
BIT
(0),

925 
	mFLD_PGA_CAP_TRIM_EN_R
 = 
BIT
(1),

926 
	mFLD_PGA_ITRIM_BOOST_L
 = 
BIT_RNG
(4,5),

927 
	mFLD_PGA_ITRIM_BOOST_R
 = 
BIT_RNG
(6,7),

935 
ölöe
 
	$adc_£t_À·_boo°_büs
(
ADC_Gaö_BüsTy≥Def
 
büs
)

937 
	`™Æog_wrôe
(
¨eg_adc_pga_boo°
, (
	`™Æog_ªad
◊ªg_adc_pga_boo°Ë& (~
FLD_PGA_ITRIM_BOOST_L
)Ë| (
büs
 << 4Ë| 
FLD_PGA_CAP_TRIM_EN_L
);

938 
	}
}

945 
ölöe
 
	$adc_£t_right_boo°_büs
(
ADC_Gaö_BüsTy≥Def
 
büs
)

947 
	`™Æog_wrôe
(
¨eg_adc_pga_boo°
, (
	`™Æog_ªad
◊ªg_adc_pga_boo°Ë& (~
FLD_PGA_ITRIM_BOOST_R
)Ë| (
büs
 << 6Ë| 
FLD_PGA_CAP_TRIM_EN_R
);

948 
	}
}

950 
	#¨eg_adc_pga_˘æ
 0xfc

	)

952 
	mFLD_PGA_ITRIM_GAIN_L
 = 
BIT_RNG
(0,1),

953 
	mFLD_PGA_ITRIM_GAIN_R
 = 
BIT_RNG
(2,3),

954 
	mFLD_ADC_MODE
 = 
BIT
(4),

955 
	mFLD_SAR_ADC_POWER_DOWN
 = 
BIT
(5),

956 
	mFLD_POWER_DOWN_PGA_CHN_L
 = 
BIT
(6),

957 
	mFLD_POWER_DOWN_PGA_CHN_R
 = 
BIT
(7),

966 
ölöe
 
	$adc_£t_À·_right_gaö_büs
(
ADC_Gaö_BüsTy≥Def
 
büs_L
, ADC_Gaö_BüsTy≥De‡
büs_R
)

968 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& 0xf0Ë| (
büs_L
 | 
büs_R
 << 2) );

969 
	}
}

976 
ölöe
 
	$adc_£t_À·_gaö_büs
(
ADC_Gaö_BüsTy≥Def
 
büs
)

978 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_PGA_ITRIM_GAIN_L
)Ë| (
büs
));

979 
	}
}

986 
ölöe
 
	$adc_£t_right_gaö_büs
(
ADC_Gaö_BüsTy≥Def
 
büs
)

988 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_PGA_ITRIM_GAIN_R
)Ë| (
büs
 << 2));

989 
	}
}

996 
ölöe
 
	$adc_£t_mode
(
ADC_ModeTy≥Def
 
adc_m
)

998 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_ADC_MODE
)Ë| 
adc_m
);

999 
	}
}

1007 
ölöe
 
	$adc_powî_⁄_ßr_adc
(
⁄_off
)

1009 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_SAR_ADC_POWER_DOWN
)Ë| (!
⁄_off
) << 5);

1010 
	}
}

1017 
ölöe
 
	$pga_À·_chn_powî_⁄
(
⁄_off
)

1019 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_POWER_DOWN_PGA_CHN_L
)Ë| (!
⁄_off
) << 6);

1020 
	}
}

1027 
ölöe
 
	$pga_right_chn_powî_⁄
(
⁄_off
)

1029 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_POWER_DOWN_PGA_CHN_R
)Ë| (!
⁄_off
) << 7);

1030 
	}
}

1032 
	#¨eg_„
 0xfe

1033 

	)

1040 
ölöe
 
	$RNG_Së
(
RNG_SrcTy≥Def
 
§c
,
RNG_Upd©aTy≥Def
 
upd©e_ty≥
)

1042 
	`WrôeA«logReg
(0x„, 
§c
 | 
upd©e_ty≥
);

1043 
	}
}

1054 
	#¨eg_adc_∫g_l
 0xf5

	)

1055 
	#¨eg_adc_∫g_h
 0xf6

	)

1056 
	#¨eg_adc_misc_l
 0xf7

	)

1057 
	#¨eg_adc_misc_h
 0xf8

	)

1059 
	mFLD_ADC_MISC_DATA
 = 
BIT_RNG
(0,6),

1060 
	mFLD_ADC_MISC_VLD
 = 
BIT
(7),

1068 
ölöe
 
	$RNG_Ród
()

1071  (
	`RódA«logReg
(
¨eg_adc_∫g_h
Ë<< 8 | RódA«logReg(
¨eg_adc_∫g_l
));

1073 
tmp1
,
tmp2
,
RngVÆue
;

1074 
tmp2
 = 
	`RódA«logReg
(0xf5);

1075 
tmp1
 = 
	`RódA«logReg
(0xf6);

1076 
RngVÆue
 = (
tmp1
<<8Ë+ 
tmp2
;

1077  
RngVÆue
;

1079 
	}
}

1087 
adc_£t_aö_ch™√l_sögÀ_íded_öput_mode
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_I≈utPchTy≥Def
 
InPCH
);

1096 
adc_£t_aö_ch™√l_dif„ª¡ül_mode
(
ADC_ChTy≥Def
 
ch_n
, 
ADC_I≈utPchTy≥Def
 
InPCH
,
ADC_I≈utNchTy≥Def
 
InNCH
);

1103 
adc_£t_aö_¥e_sˇÀr
(
ADC_PªSˇlögTy≥Def
 
v_s˛
);

1111 
adc_öô
();

1118 
adc_ba£_pö_öô
(
GPIO_PöTy≥Def
 
pö
);

1125 
adc_vb©_pö_öô
(
GPIO_PöTy≥Def
 
pö
);

1132 
adc_ba£_öô
(
GPIO_PöTy≥Def
 
pö
);

1141 
adc_vb©_öô
(
GPIO_PöTy≥Def
 
pö
);

1149 
adc_ßm∂e_™d_gë_ªsu…
();

	@platform/chip_8258/aes.h

24 #i‚de‡
AES_H_


25 
	#AES_H_


	)

36 
´s_í¸y±
(*
Key
, *
D©a
, *
Resu…
);

47 
´s_de¸y±
(*
Key
, *
D©a
, *
Resu…
);

	@platform/chip_8258/analog.h

24 #¥agm®
⁄˚


32 
™Æog_ªad
(
addr
);

40 
™Æog_wrôe
(
addr
, 
v
);

49 
™Æog_ªad_buff
(
addr
, *
buff
, 
Àn
);

58 
™Æog_wrôe_buff
(
addr
, *
buff
, 
Àn
);

61 
	#WrôeA«logReg
 
™Æog_wrôe


	)

62 
	#RódA«logReg
 
™Æog_ªad


	)

	@platform/chip_8258/audio.h

24 #i‚de‡
AUDIO_H


25 
	#AUDIO_H


	)

28 
	~"ªgi°î.h
"

29 
	~"i2c.h
"

31 
	#DMIC_INPUT_MODE_STEREO
 0

	)

32 
	#AUDIO_DBL_BUF_ENABLE
 0

	)

38 
	mAUDIO_AMIC_MONO_MODE
,

39 
	mAUDIO_AMIC_STEREO_MODE
,

40 }
	tAudio_Amic_mode
;

46 
	mAUDIO_SDM_SINGLE_OUTPUT
,

47 
	mAUDIO_SDM_DUAL_OUTPUT
,

48 }
	tAudio_SDM_ouçut_mode
;

54 
	mAUDIO_8K
,

55 
	mAUDIO_16K
,

56 
	mAUDIO_32K
,

57 
	mAUDIO_48K
,

58 
	mRATE_SIZE


59 }
	tAudioR©e_Ty≥def
;

65 
	mAMIC
,

66 
	mDMIC
,

67 
	mI2S_IN
,

68 
	mUSB_IN
,

69 
	mBUF_IN
,

70 }
	tAudioI≈ut_Ty≥def
;

76 
	mCODEC_MODE_MICPHONE_TO_HEADPHONE_LINEOUT_I2S
,

77 
	mCODEC_MODE_LINE_TO_HEADPHONE_LINEOUT_I2S
,

78 
	mCODEC_MODE_I2S_TO_HEADPHONE_LINEOUT
,

79 
	mCODEC_MODE_LINE_IN_TO_LINEOUT_I2S


80 }
	tCodecMode_Ty≥def
;

87 
audio_°›
();

94 
ölöe
 
	$audio_ª£t
()

96 
ªg_r°2
 = 
FLD_RST2_AUD
;

97 
ªg_r°2
 = 0;

98 
	}
}

106 
ölöe
 
	$audio_£t_dmic_˛k
(
°ï
,
mod
)

108 
ªg_dmic_°ï
 = 
°ï
|
FLD_DMIC_CLK_EN
;

109 
ªg_dmic_mod
 = 
mod
;

110 
	}
}

118 
ölöe
 
	$audio_£t_i2s_˛k
(
°ï
,
mod
)

120 
ªg_i2s_°ï
 = 
°ï
|
FLD_I2S_CLK_EN
;

121 
ªg_i2s_mod
 = 
mod
;

122 
	}
}

128 
ölöe
 
	$gë_mic_wr_±r
 ()

130  
ªg_audio_w±r
 >>1;

131 
	}
}

137 
audio_amic_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

143 
audio_dmic_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

150 
audio_usb_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

158 
audio_buff_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

165 
audio_i2s_öô
();

175 
audio_£t_sdm_ouçut
(
AudioI≈ut_Ty≥def
 
InTy≥
,
AudioR©e_Ty≥def
 
Audio_R©e
,
audio_out_í
);

182 
audio_£t_usb_ouçut
();

190 
audio_£t_i2s_ouçut
(
AudioI≈ut_Ty≥def
 
InTy≥
,
AudioR©e_Ty≥def
 
Audio_R©e
);

199 
audio_£t_codec
(
I2C_GPIO_GroupTy≥Def
 
i2c_pö_group
, 
CodecMode_Ty≥def
 
CodecMode
, 
sys˛k
);

209 
audio_rx_d©a_‰om_buff
(sig√d * 
buf
,
Àn
);

217 
audio_rx_d©a_‰om_ßm∂e_buff
(c⁄° *
buf
, 
Àn
);

225 
audio_rx_d©a_‰om_ßm∂e_buff
(c⁄° *
buf
, 
Àn
);

232 
audio_£t_amic_mode
(
Audio_Amic_mode
 
mode
);

239 
audio_£t_sdm_ouçut_mode
(
Audio_SDM_ouçut_mode
 
mode
);

	@platform/chip_8258/bsp.h

24 #i‚de‡
BSP_H_


25 
	#BSP_H_


	)

32 
	#REG_BASE_ADDR
 0x800000

	)

34 
	#REG_ADDR8
(
a
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (a)))

	)

35 
	#REG_ADDR16
(
a
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (a)))

	)

36 
	#REG_ADDR32
(
a
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (a)))

	)

38 
	#wrôe_ªg8
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

39 
	#wrôe_ªg16
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

40 
	#wrôe_ªg32
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë(v))

	)

42 
	#ªad_ªg8
(
addr
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)))

	)

43 
	#ªad_ªg16
(
addr
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)))

	)

44 
	#ªad_ªg32
(
addr
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)))

	)

46 
	#WRITE_REG8
 
wrôe_ªg8


	)

47 
	#WRITE_REG16
 
wrôe_ªg16


	)

48 
	#WRITE_REG32
 
wrôe_ªg32


	)

50 
	#READ_REG8
 
ªad_ªg8


	)

51 
	#READ_REG16
 
ªad_ªg16


	)

52 
	#READ_REG32
 
ªad_ªg32


	)

54 
	#TCMD_UNDER_BOTH
 0xc0

	)

55 
	#TCMD_UNDER_RD
 0x80

	)

56 
	#TCMD_UNDER_WR
 0x40

	)

58 
	#TCMD_MASK
 0x3f

	)

60 
	#TCMD_WRITE
 0x3

	)

61 
	#TCMD_WAIT
 0x7

	)

62 
	#TCMD_WAREG
 0x8

	)

67 
	sTBLCMDSET
 {

68 
	madr
;

69 
	md©
;

70 
	mcmd
;

71 } 
	tTBLCMDSET
;

81 
LﬂdTblCmdSë
(c⁄° 
TBLCMDSET
 * 
±
, 
size
);

92 
sub_wr_™a
(
addr
, 
vÆue
, 
e
, 
s
);

102 
sub_wr
(
addr
, 
vÆue
, 
e
, 
s
);

108 
ölöe
 
	$mcu_ª£t
()

110 
	`wrôe_ªg8
(0x06f,0x20);

111 
	}
}

113 
n‹mÆSpGë
();

	@platform/chip_8258/clock.h

24 #¥agm®
⁄˚


27 
	#_ASM_NOP_
 
	`asm
("ä›")

	)

32 
	#CLOCK_DLY_1_CYC
 
_ASM_NOP_


	)

33 
	#CLOCK_DLY_2_CYC
 
_ASM_NOP_
;
	)
_ASM_NOP_

34 
	#CLOCK_DLY_3_CYC
 
_ASM_NOP_
;_ASM_NOP_;
	)
_ASM_NOP_

35 
	#CLOCK_DLY_4_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

36 
	#CLOCK_DLY_5_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

37 
	#CLOCK_DLY_6_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

38 
	#CLOCK_DLY_7_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

39 
	#CLOCK_DLY_8_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

40 
	#CLOCK_DLY_9_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

41 
	#CLOCK_DLY_10_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

46 #i‚de‡
SYSCLK_RC_CLOCK_EN


47 
	#SYSCLK_RC_CLOCK_EN
 0

	)

50 
sy°em_˛k_ty≥
;

51 
sy°em_˛k_mHz
;

57 
	mSYS_CLK_12M_Cry°Æ
 = 0x44,

58 
	mSYS_CLK_16M_Cry°Æ
 = 0x43,

59 
	mSYS_CLK_24M_Cry°Æ
 = 0x42,

60 
	mSYS_CLK_32M_Cry°Æ
 = 0x60,

61 
	mSYS_CLK_48M_Cry°Æ
 = 0x20,

63 
	mSYS_CLK_RC_THRES
 = 0x10,

65 
	mSYS_CLK_24M_RC
 = 0x00,

66 
	mSYS_CLK_32M_RC
 = 0x01,

67 
	mSYS_CLK_48M_RC
 = 0x02,

68 }
	tSYS_CLK_Ty≥Def
;

75 
	mCLK_32K_RC
 =0,

76 
	mCLK_32K_XTAL
 =1,

77 }
	tCLK_32K_Ty≥Def
;

84 
˛ock_öô
(
SYS_CLK_Ty≥Def
 
SYS_CLK
);

92 
ölöe
 
	$˛ock_gë_sy°em_˛k
()

94  
sy°em_˛k_ty≥
;

95 
	}
}

102 
˛ock_32k_öô
(
CLK_32K_Ty≥Def
 
§c
);

109 
rc_24m_ˇl
();

116 
rc_48m_ˇl
();

123 
rc_32k_ˇl
();

130 
doubÀr_ˇlibøti⁄
();

137 
dmic_¥ob_24M_rc
();

144 
pwm_kick_32k_∑d_times
(
times
);

	@platform/chip_8258/dfifo.h

24 #i‚de‡ 
DFIFO_H


25 
	#DFIFO_H


	)

27 
	~"ªgi°î.h
"

35 
ölöe
 
	$dfifo_íabÀ_dfifo2
()

37 
ªg_dfifo_mode
 |
FLD_AUD_DFIFO2_IN
;

38 
	}
}

45 
ölöe
 
	$dfifo_dißbÀ_dfifo2
()

47 
ªg_dfifo_mode
 &~
FLD_AUD_DFIFO2_IN
;

48 
	}
}

56 
ölöe
 
	$dfifo_£t_dfifo0
(* 
pbuff
,
size_buff
)

58 
ªg_dfifo0_addr
 = ()(()
pbuff
);

59 
ªg_dfifo0_size
 = (
size_buff
>>4)-1;

60 
	}
}

68 
ölöe
 
	$dfifo_£t_dfifo1
(* 
pbuff
,
size_buff
)

70 
ªg_dfifo1_addr
 = ()(()
pbuff
);

71 
ªg_dfifo1_size
 = (
size_buff
>>4)-1;

72 
	}
}

80 
ölöe
 
	$dfifo_£t_dfifo2
(* 
pbuff
,
size_buff
)

82 
ªg_dfifo2_addr
 = ()(()
pbuff
);

83 
ªg_dfifo2_size
 = (
size_buff
>>4)-1;

84 
	}
}

92 
ölöe
 
	$adc_c⁄fig_misc_ch™√l_buf
(* 
pbuff
,
size_buff
)

94 
ªg_dfifo_misc_chn_addr
 = ()(()
pbuff
);

95 
ªg_dfifo_misc_chn_size
 = (
size_buff
>>4)-1;

97 
ªg_dfifo2_w±r
 = 0;

98 
	}
}

106 
ölöe
 
	$audio_c⁄fig_mic_buf
(* 
pbuff
,
size_buff
)

108 
ªg_dfifo_audio_addr
 = ()(()
pbuff
);

109 
ªg_dfifo_audio_size
 = (
size_buff
>>4)-1;

110 
	}
}

	@platform/chip_8258/dma.h

24 #i‚de‡
DMA_H_


25 
	#DMA_H_


	)

27 
	~"ªgi°î.h
"

30 
	#DMA_RFRX_LEN_HW_INFO
 0

31 
	#DMA_RFRX_OFFSET_HEADER
 4

32 
	#DMA_RFRX_OFFSET_RFLEN
 5

33 
	#DMA_RFRX_OFFSET_DATA
 6

34 

	)

36 
	#DMA_RFRX_OFFSET_CRC24
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+6)

37 
	#DMA_RFRX_OFFSET_TIME_STAMP
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+9)

38 
	#DMA_RFRX_OFFSET_FREQ_OFFSET
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+13)

39 
	#DMA_RFRX_OFFSET_RSSI
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+15)

40 

	)

43 
	#RFDMA_RX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_CHN_RF_RX
))

	)

44 
	#RFDMA_RX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_CHN_RF_RX
))

	)

46 
	#RFDMA_TX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_CHN_RF_TX
))

	)

47 
	#RFDMA_TX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_CHN_RF_TX
))

	)

51 
	mDMA0_UART_RX
,

52 
	mDMA1_UART_TX
,

53 
	mDMA2_RF_RX
,

54 
	mDMA3_RF_TX
,

55 
	mDMA4_AES_DECO
,

56 
	mDMA5_AES_CODE
,

57 
	mDMA6
,

58 
	mDMA7_PWM
,

59 }
	tDMA_chn_Typdef
;

66 
ölöe
 
	$dma_ª£t
()

68 
ªg_r°1
 |
FLD_RST1_DMA
;

69 
ªg_r°1
 &(~
FLD_RST1_DMA
);

70 
	}
}

76 
ölöe
 
	$dma_úq_íabÀ
(
msk
)

78 
ªg_dma_chn_úq_msk
 |
msk
;

79 
	}
}

86 
ölöe
 
	$dma_úq_dißbÀ
(
msk
)

88 
ªg_dma_chn_úq_msk
 &~
msk
;

89 
	}
}

97 
ölöe
 
	$dma_chn_íabÀ
(
chn
, 
í
)

99 if(
í
){

100 
ªg_dma_chn_í
 |
chn
;

103 
ªg_dma_chn_í
 &~
chn
;

105 
	}
}

114 
ölöe
 
	$dma_chn_úq_íabÀ
(
chn
, 
í
)

116 
ªg_dma_úq_°©us
 = 
chn
;

118 if(
í
){

119 
ªg_dma_chn_í
 |
chn
;

120 
ªg_dma_chn_úq_msk
 |
chn
;

123 
ªg_dma_chn_í
 &~
chn
;

124 
ªg_dma_chn_úq_msk
 &~
chn
;

126 
	}
}

133 
ölöe
 
	$dma_chn_úq_°©us_˛r
(
úq_°©us
)

135 
ªg_dma_úq_°©us
 = 
úq_°©us
;

136 
	}
}

144 
ölöe
 
	$dma_chn_úq_°©us_gë
()

146  
ªg_dma_úq_°©us
;

147 
	}
}

154 
ölöe
 
	$dma_£t_buff_size
(
DMA_chn_Typdef
 
chn
,
size
)

156 
	`ªg_dma_size
(
chn
Ë()(
size
/16);

157 
	}
}

	@platform/chip_8258/driver_8258.h

24 #¥agm®
⁄˚


26 
	~"b•.h
"

27 
	~"ªgi°î.h
"

28 
	~"™Æog.h
"

29 
	~"´s.h
"

30 
	~"˛ock.h
"

31 
	~"timî.h
"

32 
	~"dfifo.h
"

33 
	~"úq.h
"

34 
	~"w©chdog.h
"

35 
	~"dma.h
"

36 
	~"gpio.h
"

37 
	~"adc.h
"

38 
	~"øndom.h
"

39 
	~"audio.h
"

40 
	~"pwm.h
"

41 
	~"i2c.h
"

42 
	~"•i.h
"

43 
	~"u¨t.h
"

44 
	~"usbhw.h
"

45 
	~"Êash.h
"

46 
	~"rf_drv.h
"

47 
	~"emi.h
"

48 
	~"pm.h
"

	@platform/chip_8258/emi.h

24 #i‚de‡
EMI_H_


25 
	#EMI_H_


	)

27 
	~"rf_drv.h
"

35 
rf_£t_powî_Àvñ_ödex_sögÀt⁄e
 (
RF_PowîTy≥Def
 
Àvñ
);

43 
rf_emi_sögÀ_t⁄e
(
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
);

50 
rf_emi_°›
();

58 
rf_emi_rx
(
RF_ModeTy≥Def
 
mode
,sig√d 
rf_chn
);

65 
rf_emi_rx_lo›
();

72 
rf_emi_gë_rxpkt_˙t
();

79 
rf_emi_gë_rssi_avg
();

86 *
rf_emi_gë_rxpkt
();

93 
rf_c⁄töue_mode_run
();

106 
rf_emi_tx_c⁄töue_£tup
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

119 
rf_emi_tx_bur°_£tup
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

132 
rf_emi_tx_bru°_£tup_ømp
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

143 
rf_emi_tx_bur°_lo›_ømp
(
RF_ModeTy≥Def
 
rf_mode
,
pkt_ty≥
);

154 
rf_emi_tx_bur°_lo›
(
RF_ModeTy≥Def
 
rf_mode
,
pkt_ty≥
);

161 
rf_£t_ch™√l_sögÀt⁄e
 (sig√d 
chn
);

	@platform/chip_8258/flash.c

24 
	~"Êash.h
"

25 
	~"•i_i.h
"

26 
	~"úq.h
"

27 
	~"timî.h
"

28 
	~"°rög.h
"

29 
	~"™Æog.h
"

40 
_©åibuã_øm_code_£c_
 
ölöe
 
	$Êash_is_busy
(){

41  
	`m•i_ªad
() & 0x01;

42 
	}
}

49 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_cmd
(
cmd
){

50 
	`m•i_high
();

51 
	`¶ìp_us
(1);

52 
	`m•i_low
();

53 
	`m•i_wrôe
(
cmd
);

54 
	`m•i_waô
();

55 
	}
}

62 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_addr
(
addr
){

63 
	`m•i_wrôe
(()(
addr
>>16));

64 
	`m•i_waô
();

65 
	`m•i_wrôe
(()(
addr
>>8));

66 
	`m•i_waô
();

67 
	`m•i_wrôe
(()(
addr
));

68 
	`m•i_waô
();

69 
	}
}

75 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_waô_d⁄e
()

77 
	`¶ìp_us
(100);

78 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_CMD_LOWBYTE
);

80 
i
;

81 
i
 = 0; i < 10000000; ++i){

82 if(!
	`Êash_is_busy
()){

86 
	`m•i_high
();

87 
	}
}

99 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_ªad_øm
(
cmd
, 
addr
, 
addr_í
, 
dummy_˙t
, *
d©a
, 
d©a_Àn
)

101 
r
 = 
	`úq_dißbÀ
();

103 
	`Êash_£nd_cmd
(
cmd
);

104 if(
addr_í
)

106 
	`Êash_£nd_addr
(
addr
);

108 
i
 = 0; i < 
dummy_˙t
; ++i)

110 
	`m•i_wrôe
(0x00);

111 
	`m•i_waô
();

113 
	`m•i_wrôe
(0x00);

114 
	`m•i_waô
();

115 
	`m•i_˘æ_wrôe
(0x0a);

116 
	`m•i_waô
();

117 
i
 = 0; i < 
d©a_Àn
; ++i)

119 *
d©a
++ = 
	`m•i_gë
();

120 
	`m•i_waô
();

122 
	`m•i_high
();

124 
	`úq_ª°‹e
(
r
);

125 
	}
}

137 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_wrôe_øm
(
cmd
, 
addr
, 
addr_í
, *
d©a
, 
d©a_Àn
)

139 
r
 = 
	`úq_dißbÀ
();

141 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

142 
	`Êash_£nd_cmd
(
cmd
);

143 if(
addr_í
)

145 
	`Êash_£nd_addr
(
addr
);

147 
i
 = 0; i < 
d©a_Àn
; ++i)

149 
	`m•i_wrôe
(
d©a
[
i
]);

150 
	`m•i_waô
();

152 
	`m•i_high
();

153 
	`Êash_waô_d⁄e
();

155 
	`úq_ª°‹e
(
r
);

156 
	}
}

172 
	$Êash_îa£_£˘‹
(
addr
)

174 
	`Êash_m•i_wrôe_øm
(
FLASH_SECT_ERASE_CMD
, 
addr
, 1, 
NULL
, 0);

175 
	}
}

193 
	$Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
)

195 
	`Êash_m•i_ªad_øm
(
FLASH_READ_CMD
, 
addr
, 1, 0, 
buf
, 
Àn
);

196 
	}
}

216 
	$Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
)

218 
ns
 = 
PAGE_SIZE
 - (
addr
&(PAGE_SIZE - 1));

219 
nw
 = 0;

222 
nw
 = 
Àn
 > 
ns
 ?Çs :len;

223 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_CMD
, 
addr
, 1, 
buf
, 
nw
);

224 
ns
 = 
PAGE_SIZE
;

225 
addr
 +
nw
;

226 
buf
 +
nw
;

227 
Àn
 -
nw
;

228 }
Àn
 > 0);

229 
	}
}

245 
	$Êash_ªad_°©us
(
cmd
)

247 
°©us
 = 0;

248 
	`Êash_m•i_ªad_øm
(
cmd
, 0, 0, 0, &
°©us
, 1);

249  
°©us
;

250 
	}
}

267 
	$Êash_wrôe_°©us
(
Êash_°©us_ty≥def_e
 
ty≥
 , 
d©a
)

269 
buf
[2];

271 
buf
[0] = 
d©a
;

272 
buf
[1] = 
d©a
>>8;

273 if(
ty≥
 =
FLASH_TYPE_8BIT_STATUS
){

274 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 1);

275 }if(
ty≥
 =
FLASH_TYPE_16BIT_STATUS_ONE_CMD
){

276 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 2);

278 
	}
}

297 
	$Êash_ªad_Ÿp
(
addr
, 
Àn
, * 
buf
)

299 
	`Êash_m•i_ªad_øm
(
FLASH_READ_SECURITY_REGISTERS_CMD
, 
addr
, 1, 1, 
buf
, 
Àn
);

300 
	}
}

318 
	$Êash_wrôe_Ÿp
(
addr
, 
Àn
, *
buf
)

320 
ns
 = 
PAGE_SIZE_OTP
 - (
addr
 & (PAGE_SIZE_OTP - 1));

321 
nw
 = 0;

324 
nw
 = 
Àn
 > 
ns
 ?Çs :len;

325 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_SECURITY_REGISTERS_CMD
, 
addr
, 1, 
buf
, 
nw
);

326 
ns
 = 
PAGE_SIZE_OTP
;

327 
addr
 +
nw
;

328 
buf
 +
nw
;

329 
Àn
 -
nw
;

330 }
Àn
 > 0);

331 
	}
}

348 
	$Êash_îa£_Ÿp
(
addr
)

350 
	`Êash_m•i_wrôe_øm
(
FLASH_ERASE_SECURITY_REGISTERS_CMD
, 
addr
, 1, 
NULL
, 0);

351 
	}
}

367 
	$Êash_ªad_øw_mid
()

369 
Êash_mid
 = 0;

370 
	`Êash_m•i_ªad_øm
(
FLASH_GET_JEDEC_ID
, 0, 0, 0, (*)(&
Êash_mid
), 3);

371  
Êash_mid
;

372 
	}
}

389 
	$Êash_ªad_mid
()

391 
Êash_mid
 = 0;

392 
	`Êash_m•i_ªad_øm
(
FLASH_GET_JEDEC_ID
, 0, 0, 0, (*)(&
Êash_mid
), 3);

400 if(
Êash_mid
 == 0x1460c8)

402 
buf
[4]={0};

403 
	`Êash_m•i_ªad_øm
(0x5a, 0x00, 1, 1, 
buf
, 4);

404 if((
buf
[0] == 0x53)&&(buf[1] == 0x46)&&(buf[2] == 0x44)&&(buf[3] == 0x50))

406 
Êash_mid
 = 0x011460c8;

409  
Êash_mid
;

410 
	}
}

428 
	$Êash_ªad_uid
(
idcmd
, *
buf
)

430 if(
idcmd
 =
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
)

432 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x00, 1, 1, 
buf
, 16);

434 i‡(
idcmd
 =
FLASH_XTX_READ_UID_CMD
)

436 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x80, 1, 1, 
buf
, 16);

438 
	}
}

459 
	$Êash_ªad_mid_uid_wôh_check
(*
Êash_mid
, *
Êash_uid
)

461 
no_uid
[16]={0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01};

462 
i
,
f_˙t
=0;

463 *
Êash_mid
 = 
	`Êash_ªad_mid
();

483 if((*
Êash_mid
 == 0x1460C8)||(*flash_mid == 0x011460C8)||(*flash_mid == 0x1060C8)||(*flash_mid == 0x134051)||(*flash_mid == 0x136085)||(*flash_mid == 0x1360C8)||(*flash_mid == 0x1360EB)||(*flash_mid == 0x13325E)||(*flash_mid == 0x14325E)){

484 
	`Êash_ªad_uid
(
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
, (*)
Êash_uid
);

489 
i
=0;i<16;i++){

490 if(
Êash_uid
[
i
] =
no_uid
[i]){

491 
f_˙t
++;

495 if(
f_˙t
 == 16){

500 
	}
}

507 
	$Êash_is_zb
()

509 
Êash_mid
 = 
	`Êash_ªad_mid
();

510 if((
Êash_mid
 == 0x13325E)||(flash_mid == 0x14325E))

515 
	}
}

523 
	$Êash_vdd_f_ˇlib
()

525 
ˇlib_vÆue
 = 
	`Êash_gë_vdd_f_ˇlib_vÆue
();

526 if((0xf‡=
ˇlib_vÆue
) || (0 != (calib_value & 0xf8)))

528 if(
	`Êash_is_zb
())

530 
	`™Æog_wrôe
(0x0c, ((
	`™Æog_ªad
(0x0cË& 0xf8Ë| 
FLASH_VOLTAGE_1V95
));

535 
	`™Æog_wrôe
(0x0c, ((
	`™Æog_ªad
(0x0cË& 0xf8Ë| 
ˇlib_vÆue
));

537 
	}
}

	@platform/chip_8258/flash.h

24 #¥agm®
⁄˚


26 
	~"compûî.h
"

29 
	#PAGE_SIZE
 256

	)

30 
	#PAGE_SIZE_OTP
 256

	)

37 
	mFLASH_WRITE_CMD
 = 0x02,

38 
	mFLASH_READ_CMD
 = 0x03,

39 
	mFLASH_WRITE_SECURITY_REGISTERS_CMD
 = 0x42,

40 
	mFLASH_READ_SECURITY_REGISTERS_CMD
 = 0x48,

42 
	mFLASH_SECT_ERASE_CMD
 = 0x20,

43 
	mFLASH_ERASE_SECURITY_REGISTERS_CMD
 = 0x44,

45 
	mFLASH_READ_UID_CMD_GD_PUYA_ZB_UT
 = 0x4B,

46 
	mFLASH_READ_UID_CMD_XTX
 = 0x5A,

48 
	mFLASH_GET_JEDEC_ID
 = 0x9F,

51 
	mFLASH_WRITE_STATUS_CMD_LOWBYTE
 = 0x01,

52 
	mFLASH_WRITE_STATUS_CMD_HIGHBYTE
 = 0x31,

54 
	mFLASH_READ_STATUS_CMD_LOWBYTE
 = 0x05,

55 
	mFLASH_READ_STATUS_CMD_HIGHBYTE
 = 0x35,

57 
	mFLASH_WRITE_DISABLE_CMD
 = 0x04,

58 
	mFLASH_WRITE_ENABLE_CMD
 = 0x06,

66 
	mFLASH_TYPE_8BIT_STATUS
 = 0,

67 
	mFLASH_TYPE_16BIT_STATUS_ONE_CMD
 = 1,

68 
	mFLASH_TYPE_16BIT_STATUS_TWO_CMD
 = 2,

69 }
	tÊash_°©us_ty≥def_e
;

75 
	mFLASH_UID_CMD_GD_PUYA
 = 0x4b,

76 
	mFLASH_XTX_READ_UID_CMD
 = 0x5A,

77 }
	tÊash_uid_cmddef_e
;

87 
	mFLASH_SIZE_64K
 = 0x10,

88 
	mFLASH_SIZE_128K
 = 0x11,

89 
	mFLASH_SIZE_256K
 = 0x12,

90 
	mFLASH_SIZE_512K
 = 0x13,

91 
	mFLASH_SIZE_1M
 = 0x14,

92 
	mFLASH_SIZE_2M
 = 0x15,

93 
	mFLASH_SIZE_4M
 = 0x16,

94 
	mFLASH_SIZE_8M
 = 0x17,

95 } 
	tFœsh_C≠acôyDef
;

101 
	mFLASH_VOLTAGE_1V95
 = 0x07,

102 
	mFLASH_VOLTAGE_1V9
 = 0x06,

103 
	mFLASH_VOLTAGE_1V85
 = 0x05,

104 
	mFLASH_VOLTAGE_1V8
 = 0x04,

105 
	mFLASH_VOLTAGE_1V75
 = 0x03,

106 
	mFLASH_VOLTAGE_1V7
 = 0x02,

107 
	mFLASH_VOLTAGE_1V65
 = 0x01,

108 
	mFLASH_VOLTAGE_1V6
 = 0x00,

109 } 
	tFœsh_VﬁègeDef
;

129 
Êash_îa£_£˘‹
(
addr
);

147 
Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
);

167 
Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
);

182 
Êash_ªad_øw_mid
();

199 
Êash_ªad_mid
();

217 
Êash_ªad_uid
(
idcmd
, *
buf
);

238 
Êash_ªad_mid_uid_wôh_check
–*
Êash_mid
, *
Êash_uid
);

245 
Êash_is_zb
();

253 
Êash_vdd_f_ˇlib
();

260 
ölöe
 
	$Êash_gë_vdd_f_ˇlib_vÆue
()

262 
mid
 = 
	`Êash_ªad_mid
();

263 
dcdc_Êash_vﬁ©age
 = 0;

264 (
mid
 & 0xff0000) >> 16)

266 (
FLASH_SIZE_64K
):

267 
	`Êash_ªad_∑ge
(0xe1c0, 1, &
dcdc_Êash_vﬁ©age
);

269 (
FLASH_SIZE_128K
):

270 
	`Êash_ªad_∑ge
(0x1e1c0, 1, &
dcdc_Êash_vﬁ©age
);

272 (
FLASH_SIZE_512K
):

273 
	`Êash_ªad_∑ge
(0x771c0, 1, &
dcdc_Êash_vﬁ©age
);

275 (
FLASH_SIZE_1M
):

276 
	`Êash_ªad_∑ge
(0x„1c0, 1, &
dcdc_Êash_vﬁ©age
);

278 (
FLASH_SIZE_2M
):

279 
	`Êash_ªad_∑ge
(0x1„1c0, 1, &
dcdc_Êash_vﬁ©age
);

282 
dcdc_Êash_vﬁ©age
 = 0xff;

285  
dcdc_Êash_vﬁ©age
;

286 
	}
}

	@platform/chip_8258/gpio.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"bô.h
"

28 
	~"b•.h
"

36 
	mGPIO_GROUPA
 = 0x000,

37 
	mGPIO_GROUPB
 = 0x100,

38 
	mGPIO_GROUPC
 = 0x200,

39 
	mGPIO_GROUPD
 = 0x300,

40 
	mGPIO_GROUPE
 = 0x400,

42 
	mGPIO_PA0
 = 
GPIO_GROUPA
 | 
BIT
(0),

43 
	mGPIO_PA1
 = 
GPIO_GROUPA
 | 
BIT
(1),

44 
	mGPIO_PA2
 = 
GPIO_GROUPA
 | 
BIT
(2),

45 
	mGPIO_PA3
 = 
GPIO_GROUPA
 | 
BIT
(3),

46 
	mGPIO_PA4
 = 
GPIO_GROUPA
 | 
BIT
(4),

47 
	mGPIO_PA5
 = 
GPIO_GROUPA
 | 
BIT
(5), 
	mGPIO_DM
=
GPIO_PA5
,

48 
	mGPIO_PA6
 = 
GPIO_GROUPA
 | 
BIT
(6), 
	mGPIO_DP
=
GPIO_PA6
,

49 
	mGPIO_PA7
 = 
GPIO_GROUPA
 | 
BIT
(7), 
	mGPIO_SWS
=
GPIO_PA7
,

50 
	mGPIOA_ALL
 = 
GPIO_GROUPA
 | 0x00ff,

52 
	mGPIO_PB0
 = 
GPIO_GROUPB
 | 
BIT
(0),

53 
	mGPIO_PB1
 = 
GPIO_GROUPB
 | 
BIT
(1),

54 
	mGPIO_PB2
 = 
GPIO_GROUPB
 | 
BIT
(2),

55 
	mGPIO_PB3
 = 
GPIO_GROUPB
 | 
BIT
(3),

56 
	mGPIO_PB4
 = 
GPIO_GROUPB
 | 
BIT
(4),

57 
	mGPIO_PB5
 = 
GPIO_GROUPB
 | 
BIT
(5),

58 
	mGPIO_PB6
 = 
GPIO_GROUPB
 | 
BIT
(6),

59 
	mGPIO_PB7
 = 
GPIO_GROUPB
 | 
BIT
(7),

61 
	mGPIO_PC0
 = 
GPIO_GROUPC
 | 
BIT
(0),

62 
	mGPIO_PC1
 = 
GPIO_GROUPC
 | 
BIT
(1),

63 
	mGPIO_PC2
 = 
GPIO_GROUPC
 | 
BIT
(2),

64 
	mGPIO_PC3
 = 
GPIO_GROUPC
 | 
BIT
(3),

65 
	mGPIO_PC4
 = 
GPIO_GROUPC
 | 
BIT
(4),

66 
	mGPIO_PC5
 = 
GPIO_GROUPC
 | 
BIT
(5),

67 
	mGPIO_PC6
 = 
GPIO_GROUPC
 | 
BIT
(6),

68 
	mGPIO_PC7
 = 
GPIO_GROUPC
 | 
BIT
(7),

70 
	mGPIO_PD0
 = 
GPIO_GROUPD
 | 
BIT
(0),

71 
	mGPIO_PD1
 = 
GPIO_GROUPD
 | 
BIT
(1),

72 
	mGPIO_PD2
 = 
GPIO_GROUPD
 | 
BIT
(2),

73 
	mGPIO_PD3
 = 
GPIO_GROUPD
 | 
BIT
(3),

74 
	mGPIO_PD4
 = 
GPIO_GROUPD
 | 
BIT
(4),

75 
	mGPIO_PD5
 = 
GPIO_GROUPD
 | 
BIT
(5),

76 
	mGPIO_PD6
 = 
GPIO_GROUPD
 | 
BIT
(6),

77 
	mGPIO_PD7
 = 
GPIO_GROUPD
 | 
BIT
(7),

79 
	mGPIO_PE0
 = 
GPIO_GROUPE
 | 
BIT
(0), 
	mGPIO_MSDO
=
GPIO_PE0
,

80 
	mGPIO_PE1
 = 
GPIO_GROUPE
 | 
BIT
(1), 
	mGPIO_MCLK
=
GPIO_PE1
,

81 
	mGPIO_PE2
 = 
GPIO_GROUPE
 | 
BIT
(2), 
	mGPIO_MSCN
=
GPIO_PE2
,

82 
	mGPIO_PE3
 = 
GPIO_GROUPE
 | 
BIT
(3), 
	mGPIO_MSDI
=
GPIO_PE3
,

84 
	mGPIO_ALL
 = 0x500,

85 }
	tGPIO_PöTy≥Def
;

92 
	mAS_GPIO
 = 0,

93 
	mAS_MSPI
 = 1,

94 
	mAS_SWIRE
 = 2,

95 
	mAS_UART
 = 3,

96 
	mAS_I2C
 = 4,

97 
	mAS_SPI
 = 5,

98 
	mAS_I2S
 = 6,

99 
	mAS_AMIC
 = 7,

100 
	mAS_DMIC
 = 8,

101 
	mAS_SDM
 = 9,

102 
	mAS_USB
 = 10,

103 
	mAS_ADC
 = 11,

104 
	mAS_CMP
 = 12,

105 
	mAS_ATS
 = 13,

107 
	mAS_PWM0
 = 20,

108 
	mAS_PWM1
 = 21,

109 
	mAS_PWM2
 = 22,

110 
	mAS_PWM3
 = 23,

111 
	mAS_PWM4
 = 24,

112 
	mAS_PWM5
 = 25,

113 
	mAS_PWM0_N
 = 26,

114 
	mAS_PWM1_N
 = 27,

115 
	mAS_PWM2_N
 = 28,

116 
	mAS_PWM3_N
 = 29,

117 
	mAS_PWM4_N
 = 30,

118 
	mAS_PWM5_N
 = 31,

119 }
	tGPIO_FuncTy≥Def
;

123 
	mLevñ_Low
=0,

124 
	mLevñ_High
 =1,

125 }
	tGPIO_LevñTy≥Def
;

133 
	mPOL_RISING
 = 0, 
	mpﬁ_risög
 = 0,

134 
	mPOL_FALLING
 = 1, 
	mpﬁ_ÁŒög
 = 1,

135 }
	tGPIO_PﬁTy≥Def
;

141 
	mPM_PIN_UP_DOWN_FLOAT
 = 0,

142 
	mPM_PIN_PULLUP_1M
 = 1,

143 
	mPM_PIN_PULLDOWN_100K
 = 2,

144 
	mPM_PIN_PULLUP_10K
 = 3,

145 }
	tGPIO_PuŒTy≥Def
;

154 
gpio_£t_func
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_FuncTy≥Def
 
func
);

162 
ölöe
 
	$gpio_£t_ouçut_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
)

164 
bô
 = 
pö
 & 0xff;

165 if(!
vÆue
){

166 
	`BM_SET
(
	`ªg_gpio_€n
(
pö
), 
bô
);

168 
	`BM_CLR
(
	`ªg_gpio_€n
(
pö
), 
bô
);

170 
	}
}

178 
gpio_£t_öput_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
);

186 
ölöe
 
	$gpio_is_ouçut_í
(
GPIO_PöTy≥Def
 
pö
)

188  !
	`BM_IS_SET
(
	`ªg_gpio_€n
(
pö
),Öin & 0xff);

189 
	}
}

197 
ölöe
 
	$gpio_is_öput_í
(
GPIO_PöTy≥Def
 
pö
)

199  
	`BM_IS_SET
(
	`ªg_gpio_õ
(
pö
),Öin & 0xff);

200 
	}
}

208 
ölöe
 
	$gpio_wrôe
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
)

210 
bô
 = 
pö
 & 0xff;

211 if(
vÆue
){

212 
	`BM_SET
(
	`ªg_gpio_out
(
pö
), 
bô
);

214 
	`BM_CLR
(
	`ªg_gpio_out
(
pö
), 
bô
);

216 
	}
}

223 
ölöe
 
	$gpio_ªad
(
GPIO_PöTy≥Def
 
pö
)

225  
	`BM_IS_SET
(
	`ªg_gpio_ö
(
pö
),Öin & 0xff);

226 
	}
}

233 
ölöe
 
	$gpio_ªad_Æl
(*
p
)

235 
p
[0] = 
	`REG_ADDR8
(0x580);

236 
p
[1] = 
	`REG_ADDR8
(0x588);

237 
p
[2] = 
	`REG_ADDR8
(0x590);

238 
p
[3] = 
	`REG_ADDR8
(0x598);

239 
	}
}

246 
ölöe
 
	$gpio_toggÀ
(
GPIO_PöTy≥Def
 
pö
)

248 
	`ªg_gpio_out
(
pö
) ^= (pin & 0xFF);

249 
	}
}

257 
gpio_£t_d©a_°ªngth
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
);

265 
gpio_£tup_up_down_ªsi°‹
(
GPIO_PöTy≥Def
 
gpio
, 
GPIO_PuŒTy≥Def
 
up_down
);

272 
gpio_shutdown
(
GPIO_PöTy≥Def
 
pö
);

280 
ölöe
 
	$gpio_£t_öãºu±_pﬁ
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

282 
bô
 = 
pö
 & 0xff;

283 if(
ÁŒög
){

284 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

286 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

288 
	}
}

296 
ölöe
 
	$gpio_£t_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

298 
bô
 = 
pö
 & 0xff;

300 
ªg_gpio_wakeup_úq
 |
FLD_GPIO_CORE_INTERRUPT_EN
;

301 if(
ÁŒög
){

302 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

304 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

308 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_EN
;

309 
ªg_úq_mask
 |
FLD_IRQ_GPIO_EN
;

310 
	}
}

318 
ölöe
 
	$gpio_í_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
í
)

320 
bô
 = 
pö
 & 0xff;

321 if(
í
){

322 
	`BM_SET
(
	`ªg_gpio_úq_wakeup_í
(
pö
), 
bô
);

325 
	`BM_CLR
(
	`ªg_gpio_úq_wakeup_í
(
pö
), 
bô
);

327 
	}
}

335 
ölöe
 
	$gpio_£t_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
){

336 
bô
 = 
pö
 & 0xff;

338 if(
ÁŒög
){

339 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

341 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

346 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC0_EN
;

347 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC0_EN
;

348 
	}
}

356 
ölöe
 
	$gpio_í_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
í
)

358 
bô
 = 
pö
 & 0xff;

359 if(
í
){

360 
	`BM_SET
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

363 
	`BM_CLR
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

365 
	}
}

374 
ölöe
 
	$gpio_£t_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

376 
bô
 = 
pö
 & 0xff;

378 if(
ÁŒög
){

379 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

381 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

385 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC1_EN
;

386 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC1_EN
;

387 
	}
}

395 
ölöe
 
	$gpio_í_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
í
)

397 
bô
 = 
pö
 & 0xff;

398 if(
í
){

399 
	`BM_SET
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

402 
	`BM_CLR
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

404 
	}
}

	@platform/chip_8258/gpio_default.h

24 #¥agm®
⁄˚


26 
	~"gpio.h
"

29 #i‚de‡
PA0_INPUT_ENABLE


30 
	#PA0_INPUT_ENABLE
 0

	)

32 #i‚de‡
PA1_INPUT_ENABLE


33 
	#PA1_INPUT_ENABLE
 0

	)

35 #i‚de‡
PA2_INPUT_ENABLE


36 
	#PA2_INPUT_ENABLE
 0

	)

38 #i‚de‡
PA3_INPUT_ENABLE


39 
	#PA3_INPUT_ENABLE
 0

	)

41 #i‚de‡
PA4_INPUT_ENABLE


42 
	#PA4_INPUT_ENABLE
 0

	)

44 #i‚de‡
PA5_INPUT_ENABLE


45 
	#PA5_INPUT_ENABLE
 0

47 #i‚de‡
PA6_INPUT_ENABLE


	)

48 
	#PA6_INPUT_ENABLE
 0

50 #i‚de‡
PA7_INPUT_ENABLE


	)

51 
	#PA7_INPUT_ENABLE
 1

53 #i‚de‡
PA0_OUTPUT_ENABLE


	)

54 
	#PA0_OUTPUT_ENABLE
 0

	)

56 #i‚de‡
PA1_OUTPUT_ENABLE


57 
	#PA1_OUTPUT_ENABLE
 0

	)

59 #i‚de‡
PA2_OUTPUT_ENABLE


60 
	#PA2_OUTPUT_ENABLE
 0

	)

62 #i‚de‡
PA3_OUTPUT_ENABLE


63 
	#PA3_OUTPUT_ENABLE
 0

	)

65 #i‚de‡
PA4_OUTPUT_ENABLE


66 
	#PA4_OUTPUT_ENABLE
 0

	)

68 #i‚de‡
PA5_OUTPUT_ENABLE


69 
	#PA5_OUTPUT_ENABLE
 0

	)

71 #i‚de‡
PA6_OUTPUT_ENABLE


72 
	#PA6_OUTPUT_ENABLE
 0

	)

74 #i‚de‡
PA7_OUTPUT_ENABLE


75 
	#PA7_OUTPUT_ENABLE
 0

	)

77 #i‚de‡
PA0_DATA_STRENGTH


78 
	#PA0_DATA_STRENGTH
 1

	)

80 #i‚de‡
PA1_DATA_STRENGTH


81 
	#PA1_DATA_STRENGTH
 1

	)

83 #i‚de‡
PA2_DATA_STRENGTH


84 
	#PA2_DATA_STRENGTH
 1

	)

86 #i‚de‡
PA3_DATA_STRENGTH


87 
	#PA3_DATA_STRENGTH
 1

	)

89 #i‚de‡
PA4_DATA_STRENGTH


90 
	#PA4_DATA_STRENGTH
 1

	)

92 #i‚de‡
PA5_DATA_STRENGTH


93 
	#PA5_DATA_STRENGTH
 1

	)

95 #i‚de‡
PA6_DATA_STRENGTH


96 
	#PA6_DATA_STRENGTH
 1

	)

98 #i‚de‡
PA7_DATA_STRENGTH


99 
	#PA7_DATA_STRENGTH
 1

	)

101 #i‚de‡
PA0_DATA_OUT


102 
	#PA0_DATA_OUT
 0

	)

104 #i‚de‡
PA1_DATA_OUT


105 
	#PA1_DATA_OUT
 0

	)

107 #i‚de‡
PA2_DATA_OUT


108 
	#PA2_DATA_OUT
 0

	)

110 #i‚de‡
PA3_DATA_OUT


111 
	#PA3_DATA_OUT
 0

	)

113 #i‚de‡
PA4_DATA_OUT


114 
	#PA4_DATA_OUT
 0

	)

116 #i‚de‡
PA5_DATA_OUT


117 
	#PA5_DATA_OUT
 0

	)

119 #i‚de‡
PA6_DATA_OUT


120 
	#PA6_DATA_OUT
 0

	)

122 #i‚de‡
PA7_DATA_OUT


123 
	#PA7_DATA_OUT
 0

	)

125 #i‚de‡
PA0_FUNC


126 
	#PA0_FUNC
 
AS_GPIO


	)

128 #i‚de‡
PA1_FUNC


129 
	#PA1_FUNC
 
AS_GPIO


	)

131 #i‚de‡
PA2_FUNC


132 
	#PA2_FUNC
 
AS_GPIO


	)

134 #i‚de‡
PA3_FUNC


135 
	#PA3_FUNC
 
AS_GPIO


	)

137 #i‚de‡
PA4_FUNC


138 
	#PA4_FUNC
 
AS_GPIO


	)

140 #i‚de‡
PA5_FUNC


141 
	#PA5_FUNC
 
AS_GPIO


	)

143 #i‚de‡
PA6_FUNC


144 
	#PA6_FUNC
 
AS_GPIO


	)

146 #i‚de‡
PA7_FUNC


147 
	#PA7_FUNC
 
AS_SWIRE


	)

149 #i‚de‡
PULL_WAKEUP_SRC_PA0


150 
	#PULL_WAKEUP_SRC_PA0
 0

	)

152 #i‚de‡
PULL_WAKEUP_SRC_PA1


153 
	#PULL_WAKEUP_SRC_PA1
 0

	)

155 #i‚de‡
PULL_WAKEUP_SRC_PA2


156 
	#PULL_WAKEUP_SRC_PA2
 0

	)

158 #i‚de‡
PULL_WAKEUP_SRC_PA3


159 
	#PULL_WAKEUP_SRC_PA3
 0

	)

161 #i‚de‡
PULL_WAKEUP_SRC_PA4


162 
	#PULL_WAKEUP_SRC_PA4
 0

	)

164 #i‚de‡
PULL_WAKEUP_SRC_PA5


165 
	#PULL_WAKEUP_SRC_PA5
 0

	)

167 #i‚de‡
PULL_WAKEUP_SRC_PA6


168 
	#PULL_WAKEUP_SRC_PA6
 0

	)

170 #i‚de‡
PULL_WAKEUP_SRC_PA7


171 
	#PULL_WAKEUP_SRC_PA7
 
PM_PIN_PULLUP_1M


173 

	)

175 #i‚de‡
PB0_INPUT_ENABLE


176 
	#PB0_INPUT_ENABLE
 0

	)

178 #i‚de‡
PB1_INPUT_ENABLE


179 
	#PB1_INPUT_ENABLE
 0

	)

181 #i‚de‡
PB2_INPUT_ENABLE


182 
	#PB2_INPUT_ENABLE
 0

	)

184 #i‚de‡
PB3_INPUT_ENABLE


185 
	#PB3_INPUT_ENABLE
 0

	)

187 #i‚de‡
PB4_INPUT_ENABLE


188 
	#PB4_INPUT_ENABLE
 0

	)

190 #i‚de‡
PB5_INPUT_ENABLE


191 
	#PB5_INPUT_ENABLE
 0

	)

193 #i‚de‡
PB6_INPUT_ENABLE


194 
	#PB6_INPUT_ENABLE
 0

	)

196 #i‚de‡
PB7_INPUT_ENABLE


197 
	#PB7_INPUT_ENABLE
 0

	)

199 #i‚de‡
PB0_OUTPUT_ENABLE


200 
	#PB0_OUTPUT_ENABLE
 0

	)

202 #i‚de‡
PB1_OUTPUT_ENABLE


203 
	#PB1_OUTPUT_ENABLE
 0

	)

205 #i‚de‡
PB2_OUTPUT_ENABLE


206 
	#PB2_OUTPUT_ENABLE
 0

	)

208 #i‚de‡
PB3_OUTPUT_ENABLE


209 
	#PB3_OUTPUT_ENABLE
 0

	)

211 #i‚de‡
PB4_OUTPUT_ENABLE


212 
	#PB4_OUTPUT_ENABLE
 0

	)

214 #i‚de‡
PB5_OUTPUT_ENABLE


215 
	#PB5_OUTPUT_ENABLE
 0

	)

217 #i‚de‡
PB6_OUTPUT_ENABLE


218 
	#PB6_OUTPUT_ENABLE
 0

	)

220 #i‚de‡
PB7_OUTPUT_ENABLE


221 
	#PB7_OUTPUT_ENABLE
 0

	)

223 #i‚de‡
PB0_DATA_STRENGTH


224 
	#PB0_DATA_STRENGTH
 1

	)

226 #i‚de‡
PB1_DATA_STRENGTH


227 
	#PB1_DATA_STRENGTH
 1

	)

229 #i‚de‡
PB2_DATA_STRENGTH


230 
	#PB2_DATA_STRENGTH
 1

	)

232 #i‚de‡
PB3_DATA_STRENGTH


233 
	#PB3_DATA_STRENGTH
 1

	)

235 #i‚de‡
PB4_DATA_STRENGTH


236 
	#PB4_DATA_STRENGTH
 1

	)

238 #i‚de‡
PB5_DATA_STRENGTH


239 
	#PB5_DATA_STRENGTH
 1

	)

241 #i‚de‡
PB6_DATA_STRENGTH


242 
	#PB6_DATA_STRENGTH
 1

	)

244 #i‚de‡
PB7_DATA_STRENGTH


245 
	#PB7_DATA_STRENGTH
 1

	)

247 #i‚de‡
PB0_DATA_OUT


248 
	#PB0_DATA_OUT
 0

	)

250 #i‚de‡
PB1_DATA_OUT


251 
	#PB1_DATA_OUT
 0

	)

253 #i‚de‡
PB2_DATA_OUT


254 
	#PB2_DATA_OUT
 0

	)

256 #i‚de‡
PB3_DATA_OUT


257 
	#PB3_DATA_OUT
 0

	)

259 #i‚de‡
PB4_DATA_OUT


260 
	#PB4_DATA_OUT
 0

	)

262 #i‚de‡
PB5_DATA_OUT


263 
	#PB5_DATA_OUT
 0

	)

265 #i‚de‡
PB6_DATA_OUT


266 
	#PB6_DATA_OUT
 0

	)

268 #i‚de‡
PB7_DATA_OUT


269 
	#PB7_DATA_OUT
 0

	)

271 #i‚de‡
PB0_FUNC


272 
	#PB0_FUNC
 
AS_GPIO


	)

274 #i‚de‡
PB1_FUNC


275 
	#PB1_FUNC
 
AS_GPIO


	)

277 #i‚de‡
PB2_FUNC


278 
	#PB2_FUNC
 
AS_GPIO


	)

280 #i‚de‡
PB3_FUNC


281 
	#PB3_FUNC
 
AS_GPIO


	)

283 #i‚de‡
PB4_FUNC


284 
	#PB4_FUNC
 
AS_GPIO


	)

286 #i‚de‡
PB5_FUNC


287 
	#PB5_FUNC
 
AS_GPIO


	)

289 #i‚de‡
PB6_FUNC


290 
	#PB6_FUNC
 
AS_GPIO


	)

292 #i‚de‡
PB7_FUNC


293 
	#PB7_FUNC
 
AS_GPIO


	)

295 #i‚de‡
PULL_WAKEUP_SRC_PB0


296 
	#PULL_WAKEUP_SRC_PB0
 0

	)

298 #i‚de‡
PULL_WAKEUP_SRC_PB1


299 
	#PULL_WAKEUP_SRC_PB1
 0

	)

301 #i‚de‡
PULL_WAKEUP_SRC_PB2


302 
	#PULL_WAKEUP_SRC_PB2
 0

	)

304 #i‚de‡
PULL_WAKEUP_SRC_PB3


305 
	#PULL_WAKEUP_SRC_PB3
 0

	)

307 #i‚de‡
PULL_WAKEUP_SRC_PB4


308 
	#PULL_WAKEUP_SRC_PB4
 0

	)

310 #i‚de‡
PULL_WAKEUP_SRC_PB5


311 
	#PULL_WAKEUP_SRC_PB5
 0

	)

313 #i‚de‡
PULL_WAKEUP_SRC_PB6


314 
	#PULL_WAKEUP_SRC_PB6
 0

	)

316 #i‚de‡
PULL_WAKEUP_SRC_PB7


317 
	#PULL_WAKEUP_SRC_PB7
 0

	)

321 #i‚de‡
PC0_INPUT_ENABLE


322 
	#PC0_INPUT_ENABLE
 0

	)

324 #i‚de‡
PC1_INPUT_ENABLE


325 
	#PC1_INPUT_ENABLE
 0

	)

327 #i‚de‡
PC2_INPUT_ENABLE


328 
	#PC2_INPUT_ENABLE
 0

	)

330 #i‚de‡
PC3_INPUT_ENABLE


331 
	#PC3_INPUT_ENABLE
 0

	)

333 #i‚de‡
PC4_INPUT_ENABLE


334 
	#PC4_INPUT_ENABLE
 0

	)

336 #i‚de‡
PC5_INPUT_ENABLE


337 
	#PC5_INPUT_ENABLE
 0

	)

339 #i‚de‡
PC6_INPUT_ENABLE


340 
	#PC6_INPUT_ENABLE
 0

	)

342 #i‚de‡
PC7_INPUT_ENABLE


343 
	#PC7_INPUT_ENABLE
 0

	)

345 #i‚de‡
PC0_OUTPUT_ENABLE


346 
	#PC0_OUTPUT_ENABLE
 0

	)

348 #i‚de‡
PC1_OUTPUT_ENABLE


349 
	#PC1_OUTPUT_ENABLE
 0

	)

351 #i‚de‡
PC2_OUTPUT_ENABLE


352 
	#PC2_OUTPUT_ENABLE
 0

	)

354 #i‚de‡
PC3_OUTPUT_ENABLE


355 
	#PC3_OUTPUT_ENABLE
 0

	)

357 #i‚de‡
PC4_OUTPUT_ENABLE


358 
	#PC4_OUTPUT_ENABLE
 0

	)

360 #i‚de‡
PC5_OUTPUT_ENABLE


361 
	#PC5_OUTPUT_ENABLE
 0

	)

363 #i‚de‡
PC6_OUTPUT_ENABLE


364 
	#PC6_OUTPUT_ENABLE
 0

	)

366 #i‚de‡
PC7_OUTPUT_ENABLE


367 
	#PC7_OUTPUT_ENABLE
 0

	)

369 #i‚de‡
PC0_DATA_STRENGTH


370 
	#PC0_DATA_STRENGTH
 1

	)

372 #i‚de‡
PC1_DATA_STRENGTH


373 
	#PC1_DATA_STRENGTH
 1

	)

375 #i‚de‡
PC2_DATA_STRENGTH


376 
	#PC2_DATA_STRENGTH
 1

	)

378 #i‚de‡
PC3_DATA_STRENGTH


379 
	#PC3_DATA_STRENGTH
 1

	)

381 #i‚de‡
PC4_DATA_STRENGTH


382 
	#PC4_DATA_STRENGTH
 1

	)

384 #i‚de‡
PC5_DATA_STRENGTH


385 
	#PC5_DATA_STRENGTH
 1

	)

387 #i‚de‡
PC6_DATA_STRENGTH


388 
	#PC6_DATA_STRENGTH
 1

	)

390 #i‚de‡
PC7_DATA_STRENGTH


391 
	#PC7_DATA_STRENGTH
 1

	)

393 #i‚de‡
PC0_DATA_OUT


394 
	#PC0_DATA_OUT
 0

	)

396 #i‚de‡
PC1_DATA_OUT


397 
	#PC1_DATA_OUT
 0

	)

399 #i‚de‡
PC2_DATA_OUT


400 
	#PC2_DATA_OUT
 0

	)

402 #i‚de‡
PC3_DATA_OUT


403 
	#PC3_DATA_OUT
 0

	)

405 #i‚de‡
PC4_DATA_OUT


406 
	#PC4_DATA_OUT
 0

	)

408 #i‚de‡
PC5_DATA_OUT


409 
	#PC5_DATA_OUT
 0

	)

411 #i‚de‡
PC6_DATA_OUT


412 
	#PC6_DATA_OUT
 0

	)

414 #i‚de‡
PC7_DATA_OUT


415 
	#PC7_DATA_OUT
 0

	)

417 #i‚de‡
PC0_FUNC


418 
	#PC0_FUNC
 
AS_GPIO


	)

420 #i‚de‡
PC1_FUNC


421 
	#PC1_FUNC
 
AS_GPIO


	)

423 #i‚de‡
PC2_FUNC


424 
	#PC2_FUNC
 
AS_GPIO


	)

426 #i‚de‡
PC3_FUNC


427 
	#PC3_FUNC
 
AS_GPIO


	)

429 #i‚de‡
PC4_FUNC


430 
	#PC4_FUNC
 
AS_GPIO


	)

432 #i‚de‡
PC5_FUNC


433 
	#PC5_FUNC
 
AS_GPIO


	)

435 #i‚de‡
PC6_FUNC


436 
	#PC6_FUNC
 
AS_GPIO


	)

438 #i‚de‡
PC7_FUNC


439 
	#PC7_FUNC
 
AS_GPIO


	)

441 #i‚de‡
PULL_WAKEUP_SRC_PC0


442 
	#PULL_WAKEUP_SRC_PC0
 0

	)

444 #i‚de‡
PULL_WAKEUP_SRC_PC1


445 
	#PULL_WAKEUP_SRC_PC1
 0

	)

447 #i‚de‡
PULL_WAKEUP_SRC_PC2


448 
	#PULL_WAKEUP_SRC_PC2
 0

	)

450 #i‚de‡
PULL_WAKEUP_SRC_PC3


451 
	#PULL_WAKEUP_SRC_PC3
 0

	)

453 #i‚de‡
PULL_WAKEUP_SRC_PC4


454 
	#PULL_WAKEUP_SRC_PC4
 0

	)

456 #i‚de‡
PULL_WAKEUP_SRC_PC5


457 
	#PULL_WAKEUP_SRC_PC5
 0

	)

459 #i‚de‡
PULL_WAKEUP_SRC_PC6


460 
	#PULL_WAKEUP_SRC_PC6
 0

	)

462 #i‚de‡
PULL_WAKEUP_SRC_PC7


463 
	#PULL_WAKEUP_SRC_PC7
 0

	)

467 #i‚de‡
PD0_INPUT_ENABLE


468 
	#PD0_INPUT_ENABLE
 0

	)

470 #i‚de‡
PD1_INPUT_ENABLE


471 
	#PD1_INPUT_ENABLE
 0

	)

473 #i‚de‡
PD2_INPUT_ENABLE


474 
	#PD2_INPUT_ENABLE
 0

	)

476 #i‚de‡
PD3_INPUT_ENABLE


477 
	#PD3_INPUT_ENABLE
 0

	)

479 #i‚de‡
PD4_INPUT_ENABLE


480 
	#PD4_INPUT_ENABLE
 0

	)

482 #i‚de‡
PD5_INPUT_ENABLE


483 
	#PD5_INPUT_ENABLE
 0

	)

485 #i‚de‡
PD6_INPUT_ENABLE


486 
	#PD6_INPUT_ENABLE
 0

	)

488 #i‚de‡
PD7_INPUT_ENABLE


489 
	#PD7_INPUT_ENABLE
 0

	)

491 #i‚de‡
PD0_OUTPUT_ENABLE


492 
	#PD0_OUTPUT_ENABLE
 0

	)

494 #i‚de‡
PD1_OUTPUT_ENABLE


495 
	#PD1_OUTPUT_ENABLE
 0

	)

497 #i‚de‡
PD2_OUTPUT_ENABLE


498 
	#PD2_OUTPUT_ENABLE
 0

	)

500 #i‚de‡
PD3_OUTPUT_ENABLE


501 
	#PD3_OUTPUT_ENABLE
 0

	)

503 #i‚de‡
PD4_OUTPUT_ENABLE


504 
	#PD4_OUTPUT_ENABLE
 0

	)

506 #i‚de‡
PD5_OUTPUT_ENABLE


507 
	#PD5_OUTPUT_ENABLE
 0

	)

509 #i‚de‡
PD6_OUTPUT_ENABLE


510 
	#PD6_OUTPUT_ENABLE
 0

	)

512 #i‚de‡
PD7_OUTPUT_ENABLE


513 
	#PD7_OUTPUT_ENABLE
 0

	)

515 #i‚de‡
PD0_DATA_STRENGTH


516 
	#PD0_DATA_STRENGTH
 1

	)

518 #i‚de‡
PD1_DATA_STRENGTH


519 
	#PD1_DATA_STRENGTH
 1

	)

521 #i‚de‡
PD2_DATA_STRENGTH


522 
	#PD2_DATA_STRENGTH
 1

	)

524 #i‚de‡
PD3_DATA_STRENGTH


525 
	#PD3_DATA_STRENGTH
 1

	)

527 #i‚de‡
PD4_DATA_STRENGTH


528 
	#PD4_DATA_STRENGTH
 1

	)

530 #i‚de‡
PD5_DATA_STRENGTH


531 
	#PD5_DATA_STRENGTH
 1

	)

533 #i‚de‡
PD6_DATA_STRENGTH


534 
	#PD6_DATA_STRENGTH
 1

	)

536 #i‚de‡
PD7_DATA_STRENGTH


537 
	#PD7_DATA_STRENGTH
 1

	)

539 #i‚de‡
PD0_DATA_OUT


540 
	#PD0_DATA_OUT
 0

	)

542 #i‚de‡
PD1_DATA_OUT


543 
	#PD1_DATA_OUT
 0

	)

545 #i‚de‡
PD2_DATA_OUT


546 
	#PD2_DATA_OUT
 0

	)

548 #i‚de‡
PD3_DATA_OUT


549 
	#PD3_DATA_OUT
 0

	)

551 #i‚de‡
PD4_DATA_OUT


552 
	#PD4_DATA_OUT
 0

	)

554 #i‚de‡
PD5_DATA_OUT


555 
	#PD5_DATA_OUT
 0

	)

557 #i‚de‡
PD6_DATA_OUT


558 
	#PD6_DATA_OUT
 0

	)

560 #i‚de‡
PD7_DATA_OUT


561 
	#PD7_DATA_OUT
 0

	)

563 #i‚de‡
PD0_FUNC


564 
	#PD0_FUNC
 
AS_GPIO


	)

566 #i‚de‡
PD1_FUNC


567 
	#PD1_FUNC
 
AS_GPIO


	)

569 #i‚de‡
PD2_FUNC


570 
	#PD2_FUNC
 
AS_GPIO


	)

572 #i‚de‡
PD3_FUNC


573 
	#PD3_FUNC
 
AS_GPIO


	)

575 #i‚de‡
PD4_FUNC


576 
	#PD4_FUNC
 
AS_GPIO


	)

578 #i‚de‡
PD5_FUNC


579 
	#PD5_FUNC
 
AS_GPIO


	)

581 #i‚de‡
PD6_FUNC


582 
	#PD6_FUNC
 
AS_GPIO


	)

584 #i‚de‡
PD7_FUNC


585 
	#PD7_FUNC
 
AS_GPIO


	)

587 #i‚de‡
PULL_WAKEUP_SRC_PD0


588 
	#PULL_WAKEUP_SRC_PD0
 0

	)

590 #i‚de‡
PULL_WAKEUP_SRC_PD1


591 
	#PULL_WAKEUP_SRC_PD1
 0

	)

593 #i‚de‡
PULL_WAKEUP_SRC_PD2


594 
	#PULL_WAKEUP_SRC_PD2
 0

	)

596 #i‚de‡
PULL_WAKEUP_SRC_PD3


597 
	#PULL_WAKEUP_SRC_PD3
 0

	)

599 #i‚de‡
PULL_WAKEUP_SRC_PD4


600 
	#PULL_WAKEUP_SRC_PD4
 0

	)

602 #i‚de‡
PULL_WAKEUP_SRC_PD5


603 
	#PULL_WAKEUP_SRC_PD5
 0

	)

605 #i‚de‡
PULL_WAKEUP_SRC_PD6


606 
	#PULL_WAKEUP_SRC_PD6
 0

	)

608 #i‚de‡
PULL_WAKEUP_SRC_PD7


609 
	#PULL_WAKEUP_SRC_PD7
 0

	)

613 #i‚de‡
PE0_INPUT_ENABLE


614 
	#PE0_INPUT_ENABLE
 1

616 #i‚de‡
PE1_INPUT_ENABLE


	)

617 
	#PE1_INPUT_ENABLE
 1

619 #i‚de‡
PE2_INPUT_ENABLE


	)

620 
	#PE2_INPUT_ENABLE
 1

622 #i‚de‡
PE3_INPUT_ENABLE


	)

623 
	#PE3_INPUT_ENABLE
 1

625 #i‚de‡
PE0_OUTPUT_ENABLE


	)

626 
	#PE0_OUTPUT_ENABLE
 0

	)

628 #i‚de‡
PE1_OUTPUT_ENABLE


629 
	#PE1_OUTPUT_ENABLE
 0

	)

631 #i‚de‡
PE2_OUTPUT_ENABLE


632 
	#PE2_OUTPUT_ENABLE
 0

	)

634 #i‚de‡
PE3_OUTPUT_ENABLE


635 
	#PE3_OUTPUT_ENABLE
 0

	)

638 #i‚de‡
PE0_DATA_STRENGTH


639 
	#PE0_DATA_STRENGTH
 1

	)

641 #i‚de‡
PE1_DATA_STRENGTH


642 
	#PE1_DATA_STRENGTH
 1

	)

644 #i‚de‡
PE2_DATA_STRENGTH


645 
	#PE2_DATA_STRENGTH
 1

	)

647 #i‚de‡
PE3_DATA_STRENGTH


648 
	#PE3_DATA_STRENGTH
 1

	)

651 #i‚de‡
PE0_DATA_OUT


652 
	#PE0_DATA_OUT
 0

	)

654 #i‚de‡
PE1_DATA_OUT


655 
	#PE1_DATA_OUT
 0

	)

657 #i‚de‡
PE2_DATA_OUT


658 
	#PE2_DATA_OUT
 0

	)

660 #i‚de‡
PE3_DATA_OUT


661 
	#PE3_DATA_OUT
 0

	)

664 #i‚de‡
PE0_FUNC


665 
	#PE0_FUNC
 
AS_MSPI


	)

667 #i‚de‡
PE1_FUNC


668 
	#PE1_FUNC
 
AS_MSPI


	)

670 #i‚de‡
PE2_FUNC


671 
	#PE2_FUNC
 
AS_MSPI


	)

673 #i‚de‡
PE3_FUNC


674 
	#PE3_FUNC
 
AS_MSPI


	)

682 
ölöe
 
	$gpio_™Æog_ªsi°™˚_öô
()

684 
	`™Æog_wrôe
 (0x0e, 
PULL_WAKEUP_SRC_PA0
 |

685 (
PULL_WAKEUP_SRC_PA1
<<2) |

686 (
PULL_WAKEUP_SRC_PA2
<<4) |

687 (
PULL_WAKEUP_SRC_PA3
<<6));

689 
	`™Æog_wrôe
 (0x0f, 
PULL_WAKEUP_SRC_PA4
 |

690 (
PULL_WAKEUP_SRC_PA5
<<2) |

691 (
PULL_WAKEUP_SRC_PA6
<<4) |

692 (
PULL_WAKEUP_SRC_PA7
<<6));

695 
	`™Æog_wrôe
 (0x10, 
PULL_WAKEUP_SRC_PB0
 |

696 (
PULL_WAKEUP_SRC_PB1
<<2) |

697 (
PULL_WAKEUP_SRC_PB2
<<4) |

698 (
PULL_WAKEUP_SRC_PB3
<<6));

700 
	`™Æog_wrôe
 (0x11, 
PULL_WAKEUP_SRC_PB4
 |

701 (
PULL_WAKEUP_SRC_PB5
<<2) |

702 (
PULL_WAKEUP_SRC_PB6
<<4) |

703 (
PULL_WAKEUP_SRC_PB7
<<6));

706 
	`™Æog_wrôe
 (0x12, 
PULL_WAKEUP_SRC_PC0
 |

707 (
PULL_WAKEUP_SRC_PC1
<<2) |

708 (
PULL_WAKEUP_SRC_PC2
<<4) |

709 (
PULL_WAKEUP_SRC_PC3
<<6));

711 
	`™Æog_wrôe
 (0x13, 
PULL_WAKEUP_SRC_PC4
 |

712 (
PULL_WAKEUP_SRC_PC5
<<2) |

713 (
PULL_WAKEUP_SRC_PC6
<<4) |

714 (
PULL_WAKEUP_SRC_PC7
<<6));

717 
	`™Æog_wrôe
 (0x14, 
PULL_WAKEUP_SRC_PD0
 |

718 (
PULL_WAKEUP_SRC_PD1
<<2) |

719 (
PULL_WAKEUP_SRC_PD2
<<4) |

720 (
PULL_WAKEUP_SRC_PD3
<<6));

722 
	`™Æog_wrôe
 (0x15, 
PULL_WAKEUP_SRC_PD4
 |

723 (
PULL_WAKEUP_SRC_PD5
<<2) |

724 (
PULL_WAKEUP_SRC_PD6
<<4) |

725 (
PULL_WAKEUP_SRC_PD7
<<6));

726 
	}
}

741 
ölöe
 
	$gpio_öô
(
™aRes_öô_í
)

743 
ªg_gpio_∑_£âög1
 =

744 (
PA0_INPUT_ENABLE
<<8Ë| (
PA1_INPUT_ENABLE
<<9Ë| (
PA2_INPUT_ENABLE
<<10Ë| (
PA3_INPUT_ENABLE
<<11) |

745 (
PA4_INPUT_ENABLE
<<12Ë| (
PA5_INPUT_ENABLE
<<13Ë| (
PA6_INPUT_ENABLE
<<14Ë| (
PA7_INPUT_ENABLE
<<15) |

746 ((
PA0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PA1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PA2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PA3_OUTPUT_ENABLE
?0:1)<<19) |

747 ((
PA4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PA5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PA6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PA7_OUTPUT_ENABLE
?0:1)<<23) |

748 (
PA0_DATA_OUT
<<24Ë| (
PA1_DATA_OUT
<<25Ë| (
PA2_DATA_OUT
<<26Ë| (
PA3_DATA_OUT
<<27) |

749 (
PA4_DATA_OUT
<<28Ë| (
PA5_DATA_OUT
<<29Ë| (
PA6_DATA_OUT
<<30Ë| (
PA7_DATA_OUT
<<31) ;

750 
ªg_gpio_∑_£âög2
 =

751 (
PA0_DATA_STRENGTH
<<8Ë| (
PA1_DATA_STRENGTH
<<9)| (
PA2_DATA_STRENGTH
<<10Ë| (
PA3_DATA_STRENGTH
<<11) |

752 (
PA4_DATA_STRENGTH
<<12Ë| (
PA5_DATA_STRENGTH
<<13Ë| (
PA6_DATA_STRENGTH
<<14Ë| (
PA7_DATA_STRENGTH
<<15) |

753 (
PA0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PA1_FUNC
==AS_GPIO ? BIT(17):0)| (
PA2_FUNC
==AS_GPIO ? BIT(18):0)| (
PA3_FUNC
==AS_GPIO ? BIT(19):0) |

754 (
PA4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PA5_FUNC
==AS_GPIO ? BIT(21):0)| (
PA6_FUNC
==AS_GPIO ? BIT(22):0)| (
PA7_FUNC
==AS_GPIO ? BIT(23):0);

758 
	`™Æog_wrôe
(
¨eg_gpio_pb_õ
, (
PB0_INPUT_ENABLE
<<0Ë| (
PB1_INPUT_ENABLE
<<1Ë| (
PB2_INPUT_ENABLE
<<2Ë| (
PB3_INPUT_ENABLE
<<3) |

759 (
PB4_INPUT_ENABLE
<<4Ë| (
PB5_INPUT_ENABLE
<<5Ë| (
PB6_INPUT_ENABLE
<<6Ë| (
PB7_INPUT_ENABLE
<<7) );

761 
ªg_gpio_pb_€n
 =

762 ((
PB0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PB1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PB2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PB3_OUTPUT_ENABLE
?0:1)<<3) |

763 ((
PB4_OUTPUT_ENABLE
?0:1)<<4Ë| ((
PB5_OUTPUT_ENABLE
?0:1)<<5Ë| ((
PB6_OUTPUT_ENABLE
?0:1)<<6Ë| ((
PB7_OUTPUT_ENABLE
?0:1)<<7);

765 
ªg_gpio_pb_out
 =

766 (
PB0_DATA_OUT
<<0Ë| (
PB1_DATA_OUT
<<1Ë| (
PB2_DATA_OUT
<<2Ë| (
PB3_DATA_OUT
<<3) |

767 (
PB4_DATA_OUT
<<4Ë| (
PB5_DATA_OUT
<<5Ë| (
PB6_DATA_OUT
<<6Ë| (
PB7_DATA_OUT
<<7) ;

770 
	`™Æog_wrôe
(
¨eg_gpio_pb_ds
, (
PB0_DATA_STRENGTH
<<0Ë| (
PB1_DATA_STRENGTH
<<1Ë| (
PB2_DATA_STRENGTH
<<2Ë| (
PB3_DATA_STRENGTH
<<3) |

771 (
PB4_DATA_STRENGTH
<<4Ë| (
PB5_DATA_STRENGTH
<<5Ë| (
PB6_DATA_STRENGTH
<<6Ë| (
PB7_DATA_STRENGTH
<<7) );

773 
ªg_gpio_pb_gpio
 =

774 (
PB0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PB1_FUNC
==AS_GPIO ? BIT(1):0)| (
PB2_FUNC
==AS_GPIO ? BIT(2):0)| (
PB3_FUNC
==AS_GPIO ? BIT(3):0) |

775 (
PB4_FUNC
==
AS_GPIO
 ? 
	`BIT
(4):0Ë| (
PB5_FUNC
==AS_GPIO ? BIT(5):0)| (
PB6_FUNC
==AS_GPIO ? BIT(6):0)| (
PB7_FUNC
==AS_GPIO ? BIT(7):0);

779 
	`™Æog_wrôe
(
¨eg_gpio_pc_õ
, (
PC0_INPUT_ENABLE
<<0Ë| (
PC1_INPUT_ENABLE
<<1Ë| (
PC2_INPUT_ENABLE
<<2Ë| (
PC3_INPUT_ENABLE
<<3) |

780 (
PC4_INPUT_ENABLE
<<4Ë| (
PC5_INPUT_ENABLE
<<5Ë| (
PC6_INPUT_ENABLE
<<6Ë| (
PC7_INPUT_ENABLE
<<7) );

783 
ªg_gpio_pc_€n
 =

784 ((
PC0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PC1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PC2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PC3_OUTPUT_ENABLE
?0:1)<<3) |

785 ((
PC4_OUTPUT_ENABLE
?0:1)<<4Ë| ((
PC5_OUTPUT_ENABLE
?0:1)<<5Ë| ((
PC6_OUTPUT_ENABLE
?0:1)<<6Ë| ((
PC7_OUTPUT_ENABLE
?0:1)<<7);

787 
ªg_gpio_pc_out
 =

788 (
PC0_DATA_OUT
<<0Ë| (
PC1_DATA_OUT
<<1Ë| (
PC2_DATA_OUT
<<2Ë| (
PC3_DATA_OUT
<<3) |

789 (
PC4_DATA_OUT
<<4Ë| (
PC5_DATA_OUT
<<5Ë| (
PC6_DATA_OUT
<<6Ë| (
PC7_DATA_OUT
<<7) ;

792 
	`™Æog_wrôe
(
¨eg_gpio_pc_ds
, (
PC0_DATA_STRENGTH
<<0Ë| (
PC1_DATA_STRENGTH
<<1Ë| (
PC2_DATA_STRENGTH
<<2Ë| (
PC3_DATA_STRENGTH
<<3) |

793 (
PC4_DATA_STRENGTH
<<4Ë| (
PC5_DATA_STRENGTH
<<5Ë| (
PC6_DATA_STRENGTH
<<6Ë| (
PC7_DATA_STRENGTH
<<7) );

795 
ªg_gpio_pc_gpio
 =

796 (
PC0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PC1_FUNC
==AS_GPIO ? BIT(1):0)| (
PC2_FUNC
==AS_GPIO ? BIT(2):0)| (
PC3_FUNC
==AS_GPIO ? BIT(3):0) |

797 (
PC4_FUNC
==
AS_GPIO
 ? 
	`BIT
(4):0Ë| (
PC5_FUNC
==AS_GPIO ? BIT(5):0)| (
PC6_FUNC
==AS_GPIO ? BIT(6):0)| (
PC7_FUNC
==AS_GPIO ? BIT(7):0);

800 
ªg_gpio_pd_£âög1
 =

801 (
PD0_INPUT_ENABLE
<<8Ë| (
PD1_INPUT_ENABLE
<<9Ë| (
PD2_INPUT_ENABLE
<<10Ë| (
PD3_INPUT_ENABLE
<<11) |

802 (
PD4_INPUT_ENABLE
<<12Ë| (
PD5_INPUT_ENABLE
<<13)| (
PD6_INPUT_ENABLE
<<14Ë| (
PD7_INPUT_ENABLE
<<15) |

803 ((
PD0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PD1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PD2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PD3_OUTPUT_ENABLE
?0:1)<<19) |

804 ((
PD4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PD5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PD6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PD7_OUTPUT_ENABLE
?0:1)<<23) |

805 (
PD0_DATA_OUT
<<24Ë| (
PD1_DATA_OUT
<<25Ë| (
PD2_DATA_OUT
<<26Ë| (
PD3_DATA_OUT
<<27) |

806 (
PD4_DATA_OUT
<<28Ë| (
PD5_DATA_OUT
<<29Ë| (
PD6_DATA_OUT
<<30Ë| (
PD7_DATA_OUT
<<31) ;

807 
ªg_gpio_pd_£âög2
 =

808 (
PD0_DATA_STRENGTH
<<8Ë| (
PD1_DATA_STRENGTH
<<9Ë| (
PD2_DATA_STRENGTH
<<10Ë| (
PD3_DATA_STRENGTH
<<11) |

809 (
PD4_DATA_STRENGTH
<<12Ë| (
PD5_DATA_STRENGTH
<<13Ë| (
PD6_DATA_STRENGTH
<<14Ë| (
PD7_DATA_STRENGTH
<<15) |

810 (
PD0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PD1_FUNC
==AS_GPIO ? BIT(17):0)| (
PD2_FUNC
==AS_GPIO ? BIT(18):0)| (
PD3_FUNC
==AS_GPIO ? BIT(19):0) |

811 (
PD4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PD5_FUNC
==AS_GPIO ? BIT(21):0)| (
PD6_FUNC
==AS_GPIO ? BIT(22):0)| (
PD7_FUNC
==AS_GPIO ? BIT(23):0);

815 
ªg_gpio_≥_õ
 = (
PE0_INPUT_ENABLE
<<0Ë| (
PE1_INPUT_ENABLE
<<1)| (
PE2_INPUT_ENABLE
<<2Ë| (
PE3_INPUT_ENABLE
<<3);

816 
ªg_gpio_≥_€n
 = ((
PE0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PE1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PE2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PE3_OUTPUT_ENABLE
?0:1)<<3);

817 
ªg_gpio_≥_out
 = (
PE0_DATA_OUT
<<0Ë| (
PE1_DATA_OUT
<<1Ë| (
PE2_DATA_OUT
<<2Ë| (
PE3_DATA_OUT
<<3);

818 
ªg_gpio_≥_ds
 = (
PE0_DATA_STRENGTH
<<0Ë| (
PE1_DATA_STRENGTH
<<1Ë| (
PE2_DATA_STRENGTH
<<2Ë| (
PE3_DATA_STRENGTH
<<3);

819 
ªg_gpio_≥_gpio
 = (
PE0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PE1_FUNC
==AS_GPIO ? BIT(1):0)| (
PE2_FUNC
==AS_GPIO ? BIT(2):0)| (
PE3_FUNC
==AS_GPIO ? BIT(3):0);

821 if(
™aRes_öô_í
)

823 
	`gpio_™Æog_ªsi°™˚_öô
();

825 
	}
}

	@platform/chip_8258/i2c.h

24 #i‚de‡
I2C_H


25 
	#I2C_H


	)

27 
	~"ªgi°î.h
"

34 
	mI2C_GPIO_GROUP_A3A4
,

35 
	mI2C_GPIO_GROUP_B6D7
,

36 
	mI2C_GPIO_GROUP_C0C1
,

37 
	mI2C_GPIO_GROUP_C2C3
,

38 }
	tI2C_GPIO_GroupTy≥Def
;

65 
	mI2C_SLAVE_DMA
 = 0,

66 
	mI2C_SLAVE_MAP
,

67 }
	tI2C_SœveMode
;

70 
	mHOST_CMD_IRQ
 = 
BIT
(0), 
	mSLAVE_SPI_IRQ
 = 
HOST_CMD_IRQ
,

71 
	mHOST_READ_IRQ
 = 
BIT
(1),

72 }
	ti2c_úq_e
;

79 
ölöe
 
	$ª£t_i2c_moudÀ
()

81 
ªg_r°0
 |
FLD_RST0_I2C
;

82 
ªg_r°0
 &(~
FLD_RST0_I2C
);

83 
	}
}

90 
ölöe
 
	$i2c_£t_id
(
SœveID
)

92 
ªg_i2c_id
 = 
SœveID
;

93 
	}
}

100 
ölöe
 
	$i2c_¶ave_m≠pög_mode_d©a_buf„r_c⁄fig
(* 
pM≠Buf
)

102 
ªg_i2c_¶ave_m≠_addæ
 = ()((()
pM≠Buf
 & 0xff));

103 
ªg_i2c_¶ave_m≠_addrm
 = ()((()
pM≠Buf
>>8)&0xff);

104 
ªg_i2c_¶ave_m≠_addrh
 = 0x04;

105 
	}
}

112 
i2c_gpio_£t
(
I2C_GPIO_GroupTy≥Def
 
i2c_pö_group
);

120 
i2c_ma°î_öô
(
DivClock
);

130 
i2c_¶ave_öô
(
devi˚_ID
,
I2C_SœveMode
 
mode
,* 
pM≠Buf
);

141 
i2c_wrôe_byã
(
Addr
, 
AddrLí
, 
D©a
);

150 
i2c_ªad_byã
(
Addr
, 
AddrLí
);

160 
i2c_wrôe_£rõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

170 
i2c_ªad_£rõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

177 
ölöe
 
	$i2c_˛ór_öãºu±_°©us
(
i2c_úq_e
 
úq_°©us
)

179 
ªg_i2c_¶ave_úq_°©us
 = 
úq_°©us
;

180 
	}
}

188 
ölöe
 
	$i2c_gë_öãºu±_°©us
(
i2c_úq_e
 
úq_°©us
){

189  
ªg_i2c_¶ave_úq_°©us
 & 
úq_°©us
;

190 
	}
}

	@platform/chip_8258/irq.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"bô.h
"

34 
ölöe
 
	$úq_íabÀ
(){

35 
r
 = 
ªg_úq_í
;

36 
ªg_úq_í
 = 1;

37  
r
;

38 
	}
}

45 
ölöe
 
	$úq_dißbÀ
(){

46 
r
 = 
ªg_úq_í
;

47 
ªg_úq_í
 = 0;

48  
r
;

49 
	}
}

56 
ölöe
 
	$úq_ª°‹e
(
í
){

57 
ªg_úq_í
 = 
í
;

58 
	}
}

65 
ölöe
 
	$úq_íabÀ_ty≥
(
msk
){

66 
	`BM_SET
(
ªg_úq_mask
, 
msk
);

67 
	}
}

74 
ölöe
 
	$úq_dißbÀ_ty≥
(
msk
){

75 
	`BM_CLR
(
ªg_úq_mask
, 
msk
);

76 
	}
}

83 
ölöe
 
	$úq_£t_mask
(
msk
){

84 
	`BM_SET
(
ªg_úq_mask
, 
msk
);

85 
	}
}

92 
ölöe
 
	$úq_˛r_mask
(
msk
){

93 
	`BM_CLR
(
ªg_úq_mask
, 
msk
);

94 
	}
}

101 
ölöe
 
	$úq_gë_mask
(){

102  
ªg_úq_mask
;

103 
	}
}

110 
ölöe
 
	$úq_gë_§c
(){

111  
ªg_úq_§c
;

112 
	}
}

119 
ölöe
 
	$úq_˛r_Æl_§c
(){

120 
ªg_úq_§c
 = 0xffffffff;

121 
	}
}

128 
ölöe
 
	$úq_˛r_§c
(
msk
){

129 
ªg_úq_§c
 = 
msk
;

130 
	}
}

137 
ölöe
 
	$rf_úq_íabÀ
(
msk
)

139 
ªg_rf_úq_mask
 |
msk
;

140 
	}
}

147 
ölöe
 
	$rf_úq_dißbÀ
(
msk
)

149 
ªg_rf_úq_mask
 &(~
msk
);

150 
	}
}

157 
ölöe
 
	$rf_úq_§c_gë
()

159  
ªg_rf_úq_°©us
;

160 
	}
}

167 
ölöe
 
	$rf_úq_˛r_§c
(
msk
)

169 
ªg_rf_úq_°©us
 = 
msk
;

170 
	}
}

	@platform/chip_8258/pga.h

24 #i‚def 
pga_H


25 
	#pga_H


	)

27 
	~"b•.h
"

28 
	~"™Æog.h
"

31 
	mPGA_AIN_C0
,

32 
	mPGA_AIN_C1
,

33 
	mPGA_AIN_C2
,

34 
	mPGA_AIN_C3
,

41 
	mPGA_PRE_GAIN_18DB
 = 0,

42 
	mPGA_PRE_GAIN_38DB
 = 1,

43 }
	tPGA_PªAm∂ifõrTy≥Def
;

48 
	mPGA_POST_GAIN_m10DB
 = 0,

49 
	mPGA_POST_GAIN_m9P5DB
,

50 
	mPGA_POST_GAIN_m9DB
,

51 
	mPGA_POST_GAIN_m8P5DB
,

52 
	mPGA_POST_GAIN_m8DB
,

53 
	mPGA_POST_GAIN_m7P5DB
,

54 
	mPGA_POST_GAIN_m7DB
,

55 
	mPGA_POST_GAIN_m6P5DB
,

56 
	mPGA_POST_GAIN_m6DB
,

57 
	mPGA_POST_GAIN_m5P5DB
,

58 
	mPGA_POST_GAIN_m5DB
,

59 
	mPGA_POST_GAIN_m4P5DB
,

60 
	mPGA_POST_GAIN_m4DB
,

61 
	mPGA_POST_GAIN_m3P5DB
,

62 
	mPGA_POST_GAIN_m3DB
,

63 
	mPGA_POST_GAIN_m2P5DB
,

64 
	mPGA_POST_GAIN_m2DB
,

65 
	mPGA_POST_GAIN_m1P5DB
,

66 
	mPGA_POST_GAIN_m1DB
,

67 
	mPGA_POST_GAIN_m0P5DB
,

68 
	mPGA_POST_GAIN_0DB
,

69 
	mPGA_POST_GAIN_0P5DB
,

70 
	mPGA_POST_GAIN_1DB
,

71 
	mPGA_POST_GAIN_1P5DB
,

72 
	mPGA_POST_GAIN_2DB
,

73 
	mPGA_POST_GAIN_2P5DB
,

74 
	mPGA_POST_GAIN_3DB
,

75 
	mPGA_POST_GAIN_3P5DB
,

76 
	mPGA_POST_GAIN_4DB
,

77 
	mPGA_POST_GAIN_4P5DB
,

78 
	mPGA_POST_GAIN_5DB
,

79 
	mPGA_POST_GAIN_5P5DB
,

80 
	mPGA_POST_GAIN_6DB
,

81 
	mPGA_POST_GAIN_6P5DB
,

82 
	mPGA_POST_GAIN_7DB
,

83 
	mPGA_POST_GAIN_7P5DB
,

84 
	mPGA_POST_GAIN_8DB
,

85 
	mPGA_POST_GAIN_8P5DB
,

86 
	mPGA_POST_GAIN_9DB
,

87 
	mPGA_POST_GAIN_9P5DB
,

88 
	mPGA_POST_GAIN_10DB
,

89 
	mPGA_POST_GAIN_10P5DB
,

90 
	mPGA_POST_GAIN_11DB
,

91 
	mPGA_POST_GAIN_11P5DB
,

92 
	mPGA_POST_GAIN_12DB
,

93 
	mPGA_POST_GAIN_12P5DB
,

94 
	mPGA_POST_GAIN_13DB
,

95 
	mPGA_POST_GAIN_13P5DB
,

96 
	mPGA_POST_GAIN_14DB
,

97 }
	tPGA_Po°Am∂ifõrTy≥Def
;

100 
	#SET_PGA_CHN_ON
(
v
Ëdo{\

	)

101 
	gvÆ
=
™Æog_ªad
(0x80+124);\

102 
	gvÆ
 &(~(
v
));\

103 
™Æog_wrôe
(0x80+124,
vÆ
);\

105 
	#SET_PGA_LEFT_P_AIN
(
v
Ëdo{\

	)

106 
vÆ
=
	`RódA«logReg
(0x80+125);\

107 
vÆ
 &= 0xfc;\

108 
vÆ
 |((()(
v
))&0x03);\

109 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

110 
	}

	$}whûe
(0)

112 
	#SET_PGA_LEFT_N_AIN
(
v
Ëdo{\

	)

113 
vÆ
=
	`RódA«logReg
(0x80+125);\

114 
vÆ
 &= 0xf3;\

115 
vÆ
 |((()(
v
)<<2)&0x0c);\

116 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

117 
	}

	$}whûe
(0)

119 
	#SET_PGA_RIGHT_P_AIN
(
v
Ëdo{\

	)

120 
vÆ
=
	`RódA«logReg
(0x80+125);\

121 
vÆ
 &= 0xcf;\

122 
vÆ
 |((()(
v
)<<4)&0x30);\

123 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

124 
	}

	$}whûe
(0)

126 
	#SET_PGA_RIGHT_N_AIN
(
v
Ëdo{\

	)

127 
vÆ
=
	`RódA«logReg
(0x80+125);\

128 
vÆ
 &= 0x3f;\

129 
vÆ
 |((()(
v
)<<6)&0xc0);\

130 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

131 
	}

	$}whûe
(0)

133 
	#SET_PGA_GAIN_FIX_VALUE
(
v
Ëdo{\

	)

134 
vÆ
=0;\

135 
vÆ
 |((()(
v
))&0x7f);\

136 
	`wrôe_ªg8
(0xb63,
vÆ
|0x80);\

137 
	}

	$}whûe
(0)

	@platform/chip_8258/pm.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"gpio.h
"

31 
	#PM_XTAL_DELAY_DURATION
 500

	)

32 
	#EARLYWAKEUP_TIME_US_DEEP
 1100

	)

33 
	#EARLYWAKEUP_TIME_US_SUSPEND
 1250

	)

34 
	#EMPTYRUN_TIME_US
 1500

	)

36 
	#PM_DCDC_DELAY_DURATION
 1000

	)

38 
	#EARLYWAKEUP_TIME_MS_DEEP
 2

	)

39 
	#tick_32k_tick_≥r_ms
 32

	)

40 
	#PM_EMPTYRUN_TIME_US
 2

	)

50 
	#DEEP_ANA_REG0
 0x3a

51 
	#DEEP_ANA_REG1
 0x3b

52 
	#DEEP_ANA_REG2
 0x3c

53 

	)

58 
	#DEEP_ANA_REG6
 0x35

59 
	#DEEP_ANA_REG7
 0x36

60 
	#DEEP_ANA_REG8
 0x37

61 
	#DEEP_ANA_REG9
 0x38

62 
	#DEEP_ANA_REG10
 0x39

63 

	)

65 
	#SYS_NEED_REINIT_EXT32K
 
	`BIT
(0)

	)

66 
	#SYS_DEEP_SLEEP_FLAG
 
	`BIT
(1)

	)

70 
	#SYS_DEEP_ANA_REG
 
DEEP_ANA_REG2


	)

72 
	#WAKEUP_STATUS_TIMER_CORE
 (
WAKEUP_STATUS_TIMER
 | 
WAKEUP_STATUS_CORE
)

	)

73 
	#WAKEUP_STATUS_TIMER_PAD
 (
WAKEUP_STATUS_TIMER
 | 
WAKEUP_STATUS_PAD
)

	)

80 
	mSUSPEND_MODE
 = 0,

82 
	mDEEPSLEEP_MODE
 = 0x80,

83 
	mDEEPSLEEP_MODE_RET_SRAM_LOW8K
 = 0x61,

84 
	mDEEPSLEEP_MODE_RET_SRAM_LOW16K
 = 0x43,

85 
	mDEEPSLEEP_MODE_RET_SRAM_LOW32K
 = 0x07,

87 
	mSHUTDOWN_MODE
 = 0xFF,

90 
	mDEEPSLEEP_RETENTION_FLAG
 = 0x7F,

91 }
	tSÀïMode_Ty≥Def
;

99 
	mPM_WAKEUP_PAD
 = 
BIT
(4),

100 
	mPM_WAKEUP_CORE
 = 
BIT
(5),

101 
	mPM_WAKEUP_TIMER
 = 
BIT
(6),

102 
	mPM_WAKEUP_COMPARATOR
 = 
BIT
(7),

103 }
	tSÀïWakeupSrc_Ty≥Def
;

109 
	mWAKEUP_STATUS_COMPARATOR
 = 
BIT
(0),

110 
	mWAKEUP_STATUS_TIMER
 = 
BIT
(1),

111 
	mWAKEUP_STATUS_CORE
 = 
BIT
(2),

112 
	mWAKEUP_STATUS_PAD
 = 
BIT
(3),

114 
	mWAKEUP_STATUS_WD
 = 
BIT
(6),

115 
	mSTATUS_GPIO_ERR_NO_ENTER_PM
 = 
BIT
(7),

117 
	mSTATUS_ENTER_SUSPEND
 = 
BIT
(30),

124 
	mMCU_STATUS_BOOT
,

125 
	mMCU_STATUS_DEEPRET_BACK
,

126 
	mMCU_STATUS_DEEP_BACK
,

127 }
	tpm_mcu_°©us
;

133 
	mis_∑d_wakeup
;

134 
	mwakeup_§c
;

135 
	mmcu_°©us
;

136 }
	tpm_∑ø_t
;

139 (*
	tsu•íd_h™dÀr_t
)();

140 (*
	tpm_tim_ªcovî_h™dÀr_t
)();

141 (*
	t˝u_pm_h™dÀr_t
)(
	tSÀïMode_Ty≥Def
 
	t¶ìp_mode
, 
	tSÀïWakeupSrc_Ty≥Def
 
	twakeup_§c
, 
	twakeup_tick
);

143 
su•íd_h™dÀr_t
 
func_bef‹e_su•íd
;

144 
pm_tim_ªcovî_h™dÀr_t
 
pm_tim_ªcovî
;

145 
˝u_pm_h™dÀr_t
 
˝u_¶ìp_wakeup
;

146 
pm_∑ø_t
 
pmP¨am
;

149 
	`bls_pm_ªgi°îFuncBef‹eSu•íd
(
su•íd_h™dÀr_t
 
func
);

160 
ölöe
 
	$pm_gë_mcu_°©us
()

162  
pmP¨am
.
mcu_°©us
;

163 
	}
}

170 
ölöe
 
	$pm_is_∑dWakeup
()

172  
pmP¨am
.
is_∑d_wakeup
;

173 
	}
}

180 
ölöe
 
	$pm_gë_wakeup_§c
()

182  
pmP¨am
.
wakeup_§c
;

183 
	}
}

190 
˝u_°Æl_wakeup_by_timî0
(
tick
);

197 
˝u_°Æl_wakeup_by_timî1
(
tick
);

204 
˝u_°Æl_wakeup_by_timî2
(
tick
);

213 
˝u_°Æl
(
WakeupSrc
, 
I¡îvÆUs
,
sys˛ktick
);

222 
˝u_£t_gpio_wakeup
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_LevñTy≥Def
 
pﬁ
, 
í
);

230 
pm_gë_32k_tick
();

237 
˝u_wakeup_öô
();

244 
pm_tim_ªcovî_32k_rc
(
now_tick_32k
);

251 
pm_tim_ªcovî_32k_xèl
(
now_tick_32k
);

260 
˝u_¶ìp_wakeup_32k_rc
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

269 
˝u_¶ìp_wakeup_32k_xèl
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

278 
pm_l⁄g_¶ìp_wakeup
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

285 
ölöe
 
	$pm_£À˘_öã∫Æ_32k_rc
()

287 
˝u_¶ìp_wakeup
 = 
˝u_¶ìp_wakeup_32k_rc
;

288 
pm_tim_ªcovî
 = 
pm_tim_ªcovî_32k_rc
;

289 
	}
}

296 
ölöe
 
	$pm_£À˘_exã∫Æ_32k_¸y°Æ
()

298 
˝u_¶ìp_wakeup
 = 
˝u_¶ìp_wakeup_32k_xèl
;

299 
pm_tim_ªcovî
 = 
pm_tim_ªcovî_32k_xèl
;

300 
	}
}

303 
é_mu…i_addr
;

304 
é_24mrc_ˇl
;

305 
tick_32k_ˇlib
;

306 
tick_cur
;

307 
tick_32k_cur
;

308 
pm_l⁄g_su•íd
;

310 
¶ìp_°¨t
();

312 
pm_gë_öfo0
();

314 
pm_gë_öfo1
();

316 
˝u_gë_32k_tick
();

318 
so·_ªboŸ_dly13ms_u£24mRC
();

	@platform/chip_8258/pwm.h

24 #i‚de‡
PWM_H_


25 
	#PWM_H_


	)

27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

29 
	~"timî.h
"

36 
	mPWM0_ID
 = 0,

37 
	mPWM1_ID
,

38 
	mPWM2_ID
,

39 
	mPWM3_ID
,

40 
	mPWM4_ID
,

41 
	mPWM5_ID
,

42 }
	tpwm_id
;

48 
	mPWM_NORMAL_MODE
 = 0x00,

49 
	mPWM_COUNT_MODE
 = 0x01,

50 
	mPWM_IR_MODE
 = 0x03,

51 
	mPWM_IR_FIFO_MODE
 = 0x07,

52 
	mPWM_IR_DMA_FIFO_MODE
 = 0x0F,

53 }
	tpwm_mode
;

59 
	mPWM_IRQ_PWM0_PNUM
 = 
BIT
(0),

60 
	mPWM_IRQ_PWM0_IR_DMA_FIFO_DONE
 = 
BIT
(1),

61 
	mPWM_IRQ_PWM0_FRAME
 = 
BIT
(2),

62 
	mPWM_IRQ_PWM1_FRAME
 = 
BIT
(3),

63 
	mPWM_IRQ_PWM2_FRAME
 = 
BIT
(4),

64 
	mPWM_IRQ_PWM3_FRAME
 = 
BIT
(5),

65 
	mPWM_IRQ_PWM4_FRAME
 = 
BIT
(6),

66 
	mPWM_IRQ_PWM5_FRAME
 = 
BIT
(7),

68 
	mPWM_IRQ_PWM0_IR_FIFO
 = 
BIT
(16)

69 }
	tPWM_IRQ
;

72 
	mPWM0_PULSE_NORMAL
 = 0,

73 
	mPWM0_PULSE_SHADOW
 = 
BIT
(14),

74 }
	tPwm0Pul£_Sñe˘Def
;

83 
ölöe
 
	$pwm_£t_mode
(
pwm_id
 
id
, 
pwm_mode
 
mode
){

84 if(
PWM0_ID
 =
id
){

85 
ªg_pwm0_mode
 = 
mode
;

87 
	}
}

96 
ölöe
 
	$pwm_£t_˛k
(
sy°em_˛ock_hz
, 
pwm_˛k
){

97 
ªg_pwm_˛k
 = ()
sy°em_˛ock_hz
 /
pwm_˛k
 - 1;

98 
	}
}

106 
ölöe
 
	$pwm_£t_cmp
(
pwm_id
 
id
, 
cmp_tick
)

108 
	`ªg_pwm_cmp
(
id
Ë
cmp_tick
;

109 
	}
}

117 
ölöe
 
	$pwm_£t_cy˛e
(
pwm_id
 
id
, 
cy˛e_tick
){

118 
	`ªg_pwm_max
(
id
Ë
cy˛e_tick
;

119 
	}
}

128 
ölöe
 
	$pwm_£t_cy˛e_™d_duty
(
pwm_id
 
id
, 
cy˛e_tick
, 
cmp_tick
){

129 
	`ªg_pwm_cy˛e
(
id
Ë
	`MASK_VAL
(
FLD_PWM_CMP
, 
cmp_tick
, 
FLD_PWM_MAX
, 
cy˛e_tick
);

130 
	}
}

139 
ölöe
 
	$pwm_£t_pwm0_shadow_cy˛e_™d_duty
(
cy˛e_tick
, 
cmp_tick
)

141 
ªg_pwm_tcmp0_shadow
 = 
cmp_tick
;

142 
ªg_pwm_tmax0_shadow
 = 
cy˛e_tick
;

143 
	}
}

152 
ölöe
 
	$pwm_£t_pha£
(
pwm_id
 
id
, 
pha£
){

154 
	}
}

162 
ölöe
 
	$pwm_£t_pul£_num
(
pwm_id
 
id
, 
pul£_num
){

163 if(
PWM0_ID
 =
id
){

164 
ªg_pwm0_pul£_num
 = 
pul£_num
;

167 
	}
}

174 
ölöe
 
	$pwm_°¨t
(
pwm_id
 
id
)

177 if(
PWM0_ID
 =
id
)

179 
	`BM_SET
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

182 
	`BM_SET
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

184 
	}
}

191 
ölöe
 
	$pwm_°›
(
pwm_id
 
id
)

193 if(
PWM0_ID
 =
id
)

195 
	`BM_CLR
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

198 
	`BM_CLR
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

200 
	}
}

207 
ölöe
 
	$pwm_ªvît
(
pwm_id
 
id
)

209 
ªg_pwm_övît
 |
	`BIT
(
id
);

210 
	}
}

217 
ölöe
 
	$pwm_n_ªvît
(
pwm_id
 
id
)

219 
ªg_pwm_n_övît
 |
	`BIT
(
id
);

220 
	}
}

228 
ölöe
 
	$pwm_pﬁo_íabÀ
(
pwm_id
 
id
, 
í
)

230 if(
í
){

231 
	`BM_SET
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

233 
	`BM_CLR
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

235 
	}
}

242 
ölöe
 
	$pwm_£t_öãºu±_íabÀ
(
PWM_IRQ
 
úq
){

243 if(
úq
 =
PWM_IRQ_PWM0_IR_FIFO
){

244 
	`BM_SET
(
ªg_pwm0_fifo_mode_úq_mask
,
	`BIT
(0));

246 
	`BM_SET
(
ªg_pwm_úq_mask
, 
úq
);

248 
	}
}

255 
ölöe
 
	$pwm_£t_öãºu±_dißbÀ
(
PWM_IRQ
 
úq
){

256 if(
úq
 =
PWM_IRQ_PWM0_IR_FIFO
){

257 
	`BM_CLR
(
ªg_pwm0_fifo_mode_úq_mask
,
	`BIT
(0));

259 
	`BM_CLR
(
ªg_pwm_úq_mask
, 
úq
);

261 
	}
}

269 
ölöe
 
	$pwm_˛ór_öãºu±_°©us
(
PWM_IRQ
 
°©us
)

271 if(
°©us
 =
PWM_IRQ_PWM0_IR_FIFO
){

272 
ªg_pwm0_fifo_mode_úq_°a
 = 
	`BIT
(0);

274 
ªg_pwm_úq_°a
 = 
°©us
;

276 
	}
}

283 
ölöe
 
	$pwm_ú_fifo_£t_úq_åig_Àvñ
(
åig_Àvñ
)

285 
ªg_pwm_ú_fifo_úq_åig_Àvñ
 = 
åig_Àvñ
;

286 
	}
}

294 
ölöe
 
	$pwm_ú_fifo_˛r_d©a
()

296 
ªg_pwm_ú_˛r_fifo_d©a
 |
FLD_PWM0_IR_FIFO_CLR_DATA
;

297 
	}
}

304 
ölöe
 
	$pwm_ú_fifo_gë_d©a_num
()

306  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_DATA_NUM
);

307 
	}
}

314 
ölöe
 
	$pwm_ú_fifo_is_em±y
()

316  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_EMPTY
);

317 
	}
}

324 
ölöe
 
	$pwm_ú_fifo_is_fuŒ
()

326  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_FULL
);

327 
	}
}

337 
ölöe
 
	$pwm_ú_fifo_£t_d©a_íåy
(
pul£_num
, 
u£_shadow
, 
ˇºõr_í
)

339 
ödex
=0;

340 
cfg_d©a
 = 
pul£_num
 + ((
u£_shadow
&
	`BIT
(0))<<14Ë+ ((
ˇºõr_í
&BIT(0))<<15);

341 
	`pwm_ú_fifo_is_fuŒ
());

342 
	`ªg_pwm_ú_fifo_d©
(
ödex
Ë
cfg_d©a
;

343 
ödex
++;

344 
ödex
&=0x01;

345 
	}
}

354 
ölöe
 
	$pwm_c⁄fig_dma_fifo_wavef‹m
(
ˇºõr_í
, 
Pwm0Pul£_Sñe˘Def
 
pul£_ty≥
, 
pul£_num
)

356  ( 
ˇºõr_í
<<15 | 
pul£_ty≥
 | (
pul£_num
 & 0x3fff) );

357 
	}
}

365 
ölöe
 
	$pwm_£t_dma_addªss
(* 
pd©
)

367 
ªg_dma_pwm_addr
 = ()(()
pd©
);

368 
ªg_dma7_addrHi
 = 0x04;

369 
ªg_dma_pwm_mode
 &~
FLD_DMA_WR_MEM
;

376 
ªg_dma7_size
 = 0xff;

377 
	}
}

384 
ölöe
 
	$pwm_°¨t_dma_ú_£ndög
()

386 
ªg_dma_chn_í
 |
FLD_DMA_CHN_PWM
;

387 
ªg_dma_tx_rdy0
 |
FLD_DMA_CHN_PWM
;

388 
	}
}

395 
ölöe
 
	$pwm_°›_dma_ú_£ndög
()

397 
ªg_r°0
 = 
FLD_RST0_PWM
;

398 
	`¶ìp_us
(20);

399 
ªg_r°0
 = 0;

400 
	}
}

407 
ölöe
 
	$pwm_gë_öãºu±_°©us
(
PWM_IRQ
 
°©us
){

409 if(
°©us
 =
PWM_IRQ_PWM0_IR_FIFO
){

410  (
ªg_pwm0_fifo_mode_úq_°a
 & 
	`BIT
(0));

412  (
ªg_pwm_úq_°a
 & 
°©us
);

415 
	}
}

	@platform/chip_8258/random.h

24 #¥agm®
⁄˚


32 
øndom_gíî©‹_öô
();

39 
ønd
();

	@platform/chip_8258/register.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"b•.h
"

36 
	#ªg_i2c_£t
 
	`REG_ADDR32
(0x00)

	)

37 
	#ªg_i2c_•ìd
 
	`REG_ADDR8
(0x00)

	)

38 
	#ªg_i2c_id
 
	`REG_ADDR8
(0x01)

	)

40 
	mFLD_I2C_WRITE_READ_BIT
 = 
BIT
(0),

41 
	mFLD_I2C_ID
 = 
BIT_RNG
(1,7),

44 
	#ªg_i2c_°©us
 
	`REG_ADDR8
(0x02)

	)

46 
	mFLD_I2C_CMD_BUSY
 = 
BIT
(0),

47 
	mFLD_I2C_BUS_BUSY
 = 
BIT
(1),

48 
	mFLD_I2C_NAK
 = 
BIT
(2),

51 
	#ªg_i2c_mode
 
	`REG_ADDR8
(0x03)

	)

53 
	mFLD_I2C_ADDR_AUTO_ADD
 = 
BIT
(0),

54 
	mFLD_I2C_MASTER_EN
 = 
BIT
(1),

55 
	mFLD_I2C_SLAVE_MAPPING
 = 
BIT
(2),

56 
	mFLD_I2C_HOLD_MASTER
 = 
BIT
(3),

59 
	#ªg_i2c_adr_d©
 
	`REG_ADDR16
(0x04)

	)

60 
	#ªg_i2c_d©_˘æ
 
	`REG_ADDR32
(0x04)

	)

61 
	#ªg_i2c_di_˘æ
 
	`REG_ADDR16
(0x06)

	)

62 
	#ªg_i2c_adr
 
	`REG_ADDR8
(0x04)

	)

63 
	#ªg_i2c_do
 
	`REG_ADDR8
(0x05)

	)

64 
	#ªg_i2c_di
 
	`REG_ADDR8
(0x06)

	)

65 
	#ªg_i2c_˘æ
 
	`REG_ADDR8
(0x07)

	)

67 
	mFLD_I2C_CMD_ID
 = 
BIT
(0),

68 
	mFLD_I2C_CMD_ADDR
 = 
BIT
(1),

69 
	mFLD_I2C_CMD_DO
 = 
BIT
(2),

70 
	mFLD_I2C_CMD_DI
 = 
BIT
(3),

71 
	mFLD_I2C_CMD_START
 = 
BIT
(4),

72 
	mFLD_I2C_CMD_STOP
 = 
BIT
(5),

73 
	mFLD_I2C_CMD_READ_ID
 = 
BIT
(6),

74 
	mFLD_I2C_CMD_ACK
 = 
BIT
(7),

77 
	#ªg_i2c_m≠_hadr
 
	`REG_ADDR8
(0xe0)

	)

79 
	#ªg_i2c_¶ave_m≠_addæ
 
	`REG_ADDR8
(0xe1)

	)

80 
	#ªg_i2c_¶ave_m≠_addrm
 
	`REG_ADDR8
(0xe2)

	)

81 
	#ªg_i2c_¶ave_m≠_addrh
 
	`REG_ADDR8
(0xe3)

	)

83 
	#ªg_i2c_¶ave_úq_°©us
 
	`REG_ADDR8
(0xe4)

	)

84 
	#ªg_•i_¶ave_úq_°©us
 
	`REG_ADDR8
(0xe4)

	)

85 
	#ªg_i2c_m≠_ho°_°©us
 
	`REG_ADDR8
(0xe4)

	)

87 
	mFLD_HOST_CMD_IRQ
 = 
BIT
(0), 
	mFLD_SLAVE_SPI_IRQ
 = 
FLD_HOST_CMD_IRQ
,

88 
	mFLD_HOST_READ_IRQ
 = 
BIT
(1),

91 
	#ªg_i2c_m≠_ªad0
 
	`REG_ADDR8
(0xe5)

	)

92 
	#ªg_i2c_m≠_ªad1
 
	`REG_ADDR8
(0xe6)

	)

93 
	#ªg_i2c_m≠_ªad2
 
	`REG_ADDR8
(0xe7)

	)

97 
	#ªg_•i_d©a
 
	`REG_ADDR8
(0x08)

	)

98 
	#ªg_•i_˘æ
 
	`REG_ADDR8
(0x09)

	)

100 
	mFLD_SPI_CS
 = 
BIT
(0),

101 
	mFLD_SPI_MASTER_MODE_EN
 = 
BIT
(1),

102 
	mFLD_SPI_DATA_OUT_DIS
 = 
BIT
(2),

103 
	mFLD_SPI_RD
 = 
BIT
(3),

104 
	mFLD_SPI_ADDR_AUTO_ADD
 = 
BIT
(4),

105 
	mFLD_SPI_SHARE_MODE
 = 
BIT
(5),

106 
	mFLD_SPI_BUSY
 = 
BIT
(6),

108 
	#ªg_•i_•
 
	`REG_ADDR8
(0x0a)

	)

110 
	mFLD_MSPI_CLK
 = 
BIT_RNG
(0,6),

111 
	mFLD_SPI_ENABLE
 = 
BIT
(7),

114 
	#ªg_•i_öv_˛k
 
	`REG_ADDR8
(0x0b)

115 íum {

	)

116 
	mFLD_SPI_MODE_WORK_MODE
 = 
BIT_RNG
(0,1),

121 
	#ªg_m•i_d©a
 
	`REG_ADDR8
(0x0c)

	)

122 
	#ªg_m•i_˘æ
 
	`REG_ADDR8
(0x0d)

	)

125 
	mFLD_MSPI_CS
 = 
BIT
(0),

126 
	mFLD_MSPI_SDO
 = 
BIT
(1),

127 
	mFLD_MSPI_CONT
 = 
BIT
(2),

128 
	mFLD_MSPI_RD
 = 
BIT
(3),

129 
	mFLD_MSPI_BUSY
 = 
BIT
(4),

132 
	#ªg_m•i_mode
 
	`REG_ADDR8
(0x0f)

	)

135 
	mFLD_MSPI_DUAL_DATA_MODE_EN
 = 
BIT
(0),

136 
	mFLD_MSPI_DUAL_ADDR_MODE_EN
 = 
BIT
(1),

137 
	mFLD_MSPI_CLK_DIV
 = 
BIT_RNG
(2,7),

142 
	#ªg_r°0
 
	`REG_ADDR8
(0x60)

	)

144 
	mFLD_RST0_SPI
 = 
BIT
(0),

145 
	mFLD_RST0_I2C
 = 
BIT
(1),

146 
	mFLD_RST0_UART
 = 
BIT
(2),

147 
	mFLD_RST0_USB
 = 
BIT
(3),

148 
	mFLD_RST0_PWM
 = 
BIT
(4),

149 
	mFLD_RST0_QDEC
 = 
BIT
(5),

150 
	mFLD_RST0_SWIRE
 = 
BIT
(7),

153 
	#ªg_r°1
 
	`REG_ADDR8
(0x61)

	)

155 
	mFLD_RST1_ZB
 = 
BIT
(0),

156 
	mFLD_RST1_SYS_TIMER
 = 
BIT
(1),

157 
	mFLD_RST1_DMA
 = 
BIT
(2),

158 
	mFLD_RST1_ALGM
 = 
BIT
(3),

159 
	mFLD_RST1_AES
 = 
BIT
(4),

160 
	mFLD_RST1_ADC
 = 
BIT
(5),

161 
	mFLD_RST1_ALG
 = 
BIT
(6),

164 
	#ªg_r°2
 
	`REG_ADDR8
(0x62)

	)

166 
	mFLD_RST2_AIF
 = 
BIT
(0),

167 
	mFLD_RST2_AUD
 = 
BIT
(1),

168 
	mFLD_RST2_DFIFO
 = 
BIT
(2),

169 
	mFLD_RST2_RISC
 = 
BIT
(4),

170 
	mFLD_RST2_MCIC
 = 
BIT
(5),

171 
	mFLD_RST2_RISC1
 = 
BIT
(6),

172 
	mFLD_RST2_MCIC1
 = 
BIT
(7),

176 
	#ªg_˛k_í0
 
	`REG_ADDR8
(0x63)

	)

178 
	mFLD_CLK0_SPI_EN
 = 
BIT
(0),

179 
	mFLD_CLK0_I2C_EN
 = 
BIT
(1),

180 
	mFLD_CLK0_UART_EN
 = 
BIT
(2),

181 
	mFLD_CLK0_USB_EN
 = 
BIT
(3),

182 
	mFLD_CLK0_PWM_EN
 = 
BIT
(4),

183 
	mFLD_CLK0_QDEC_EN
 = 
BIT
(5),

184 
	mFLD_CLK0_SWIRE_EN
 = 
BIT
(7),

187 
	#ªg_˛k_í1
 
	`REG_ADDR8
(0x64)

	)

189 
	mFLD_CLK1_ZB_EN
 = 
BIT
(0),

190 
	mFLD_CLK1_SYS_TIMER_EN
 = 
BIT
(1),

191 
	mFLD_CLK1_DMA_EN
 = 
BIT
(2),

192 
	mFLD_CLK1_ALGM_EN
 = 
BIT
(3),

193 
	mFLD_CLK1_AES_EN
 = 
BIT
(4),

198 
	#ªg_˛k_í2
 
	`REG_ADDR8
(0x65)

	)

200 
	mFLD_CLK2_AIF_EN
 = 
BIT
(0),

201 
	mFLD_CLK2_AUD_EN
 = 
BIT
(1),

202 
	mFLD_CLK2_DFIFO_EN
 = 
BIT
(2),

203 
	mFLD_CLK2_MC_EN
 = 
BIT
(4),

204 
	mFLD_CLK2_MCIC_EN
 = 
BIT
(5),

208 
	#ªg_˛k_£l
 
	`REG_ADDR8
(0x66)

	)

210 
	mFLD_SCLK_DIV
 = 
BIT_RNG
(0,4),

211 
	mFLD_SCLK_SEL
 = 
BIT_RNG
(5,6),

212 
	mFLD_SCLK_HS_SEL
 = 
BIT
(7),

215 
	#ªg_i2s_°ï
 
	`REG_ADDR8
(0x67)

	)

217 
	mFLD_I2S_STEP
 = 
BIT_RNG
(0,6),

218 
	mFLD_I2S_CLK_EN
 = 
BIT
(7),

221 
	#ªg_i2s_mod
 
	`REG_ADDR8
(0x68)

	)

224 
	#ªg_dmic_°ï
 
	`REG_ADDR8
(0x6c)

	)

226 
	mFLD_DMIC_STEP
 = 
BIT_RNG
(0,6),

227 
	mFLD_DMIC_CLK_EN
 = 
BIT
(7),

230 
	#ªg_dmic_mod
 
	`REG_ADDR8
(0x6d)

	)

233 
	#ªg_wakeup_í
 
	`REG_ADDR8
(0x6e)

	)

235 
	mFLD_WAKEUP_SRC_I2C
 = 
BIT
(0),

236 
	mFLD_WAKEUP_SRC_SPI
 = 
BIT
(1),

237 
	mFLD_WAKEUP_SRC_USB
 = 
BIT
(2),

238 
	mFLD_WAKEUP_SRC_GPIO
 = 
BIT
(3),

239 
	mFLD_WAKEUP_SRC_I2C_SYN
 = 
BIT
(4),

240 
	mFLD_WAKEUP_SRC_GPIO_RM
 = 
BIT
(5),

241 
	mFLD_WAKEUP_SRC_USB_RESM
 = 
BIT
(6),

242 
	mFLD_WAKEUP_SRC_RST_SYS
 = 
BIT
(7),

245 
	#ªg_pwdn_˘æ
 
	`REG_ADDR8
(0x6f)

	)

248 
	mFLD_PWDN_CTRL_REBOOT
 = 
BIT
(5),

249 
	mFLD_PWDN_CTRL_SLEEP
 = 
BIT
(7),

253 
	#ªg_mcu_wakeup_mask
 
	`REG_ADDR32
(0x78)

	)

257 
	#ªg_7816_˛k_div
 
	`REG_ADDR8
(0x7b)

	)

261 
	#ªg_u¨t_d©a_buf0
 
	`REG_ADDR8
(0x90)

	)

262 
	#ªg_u¨t_d©a_buf1
 
	`REG_ADDR8
(0x91)

	)

263 
	#ªg_u¨t_d©a_buf2
 
	`REG_ADDR8
(0x92)

	)

264 
	#ªg_u¨t_d©a_buf3
 
	`REG_ADDR8
(0x93)

	)

266 
	#ªg_u¨t_d©a_buf
(
i
Ë
	`REG_ADDR8
(0x90 + (i))

267 
	#ªg_u¨t_˛k_div
 
	`REG_ADDR16
(0x94)

	)

269 
	mFLD_UART_CLK_DIV
 = 
BIT_RNG
(0,14),

270 
	mFLD_UART_CLK_DIV_EN
 = 
BIT
(15)

273 
	#ªg_u¨t_˘æ0
 
	`REG_ADDR8
(0x96)

	)

275 
	mFLD_UART_BPWC
 = 
BIT_RNG
(0,3),

276 
	mFLD_UART_RX_DMA_EN
 = 
BIT
(4),

277 
	mFLD_UART_TX_DMA_EN
 = 
BIT
(5),

278 
	mFLD_UART_RX_IRQ_EN
 = 
BIT
(6),

279 
	mFLD_UART_TX_IRQ_EN
 = 
BIT
(7),

282 
	#ªg_u¨t_˘æ1
 
	`REG_ADDR8
(0x97)

	)

284 
	mFLD_UART_CTRL1_CTS_SELECT
 = 
BIT
(0),

285 
	mFLD_UART_CTRL1_CTS_EN
 = 
BIT
(1),

286 
	mFLD_UART_CTRL1_PARITY_EN
 = 
BIT
(2),

287 
	mFLD_UART_CTRL1_PARITY_POLARITY
 = 
BIT
(3),

288 
	mFLD_UART_CTRL1_STOP_BIT
 = 
BIT_RNG
(4,5),

289 
	mFLD_UART_CTRL1_TTL
 = 
BIT
(6),

290 
	mFLD_UART_CTRL1_LOOPBACK
 = 
BIT
(7),

293 
	#ªg_u¨t_˘æ2
 
	`REG_ADDR16
(0x98)

	)

295 
	mFLD_UART_CTRL2_RTS_TRIG_LVL
 = 
BIT_RNG
(0,3),

296 
	mFLD_UART_CTRL2_RTS_PARITY
 = 
BIT
(4),

297 
	mFLD_UART_CTRL2_RTS_MANUAL_VAL
 = 
BIT
(5),

298 
	mFLD_UART_CTRL2_RTS_MANUAL_EN
 = 
BIT
(6),

299 
	mFLD_UART_CTRL2_RTS_EN
 = 
BIT
(7),

300 
	mFLD_UART_CTRL3_RX_IRQ_TRIG_LEVEL
 = 
BIT_RNG
(8,11),

301 
	mFLD_UART_CTRL3_TX_IRQ_TRIG_LEVEL
 = 
BIT_RNG
(12,15),

305 
	#ªg_u¨t_˘æ3
 
	`REG_ADDR8
(0x99)

	)

307 
	mFLD_UART_RX_IRQ_TRIG_LEV
 = 
BIT_RNG
(0,3),

308 
	mFLD_UART_TX_IRQ_TRIG_LEV
 = 
BIT_RNG
(4,7),

311 
	#ªg_u¨t_rx_timeout0
 
	`REG_ADDR8
(0x9a)

	)

313 
	mFLD_UART_TIMEOUT_BW
 = 
BIT_RNG
(0,7),

316 
	#ªg_u¨t_rx_timeout1
 
	`REG_ADDR8
(0x9b)

	)

318 
	mFLD_UART_TIMEOUT_MUL
 = 
BIT_RNG
(0,1),

319 
	mFLD_UART_P7816_EN
 = 
BIT
(5),

320 
	mFLD_UART_MASK_TXDONE_IRQ
 = 
BIT
(6),

321 
	mFLD_UART_MASK_ERR_IRQ
 = 
BIT
(7),

325 
	#ªg_u¨t_buf_˙t
 
	`REG_ADDR8
(0x9c)

	)

328 
	mFLD_UART_RX_BUF_CNT
 = 
BIT_RNG
(0,3),

329 
	mFLD_UART_TX_BUF_CNT
 = 
BIT_RNG
(4,7),

332 
	#ªg_u¨t_°©us0
 
	`REG_ADDR8
(0x9d)

	)

334 
	mFLD_UART_RBCNT
 = 
BIT_RNG
(0,2),

335 
	mFLD_UART_IRQ_FLAG
 = 
BIT
(3),

336 
	mFLD_UART_WBCNT
 = 
BIT_RNG
(4,6),

337 
	mFLD_UART_CLEAR_RX_FLAG
 = 
BIT
(6),

338 
	mFLD_UART_RX_ERR_FLAG
 = 
BIT
(7),

341 
	#ªg_u¨t_°©us1
 
	`REG_ADDR8
(0x9e)

	)

343 
	mFLD_UART_TX_DONE
 = 
BIT
(0),

344 
	mFLD_UART_TX_BUF_IRQ
 = 
BIT
(1),

345 
	mFLD_UART_RX_DONE
 = 
BIT
(2),

346 
	mFLD_UART_RX_BUF_IRQ
 = 
BIT
(3),

350 
	#ªg_u¨t_°©e
 
	`REG_ADDR8
(0x9f)

	)

352 
	mFLD_UART_TSTATE_I
 = 
BIT_RNG
(0,2),

353 
	mFLD_UART_RSTATE_I
 = 
BIT_RNG
(4,7),

359 
	#ªg_swúe_d©a
 
	`REG_ADDR8
(0xb0)

	)

360 
	#ªg_swúe_˘æ1
 
	`REG_ADDR8
(0xb1)

	)

362 
	mFLD_SWIRE_WR
 = 
BIT
(0),

363 
	mFLD_SWIRE_RD
 = 
BIT
(1),

364 
	mFLD_SWIRE_CMD
 = 
BIT
(2),

365 
	mFLD_SWIRE_USB_DET
 = 
BIT
(6),

366 
	mFLD_SWIRE_USB_EN
 = 
BIT
(7),

369 
	#ªg_swúe_˛k_div
 
	`REG_ADDR8
(0xb2)

	)

373 
	mFLD_SWIRE_CLK_DIV
 = 
BIT_RNG
(0,6),

376 
	#ªg_swúe_id
 
	`REG_ADDR8
(0xb3)

	)

380 
	mFLD_SWIRE_ID_SLAVE_ID
 = 
BIT_RNG
(0,6),

381 
	mFLD_SWIRE_ID_SLAVE_FIFO_EN
 = 
BIT
(7),

386 
	#ªg_™a_˘æ32
 
	`REG_ADDR32
(0xb8)

	)

387 
	#ªg_™a_addr_d©a
 
	`REG_ADDR16
(0xb8)

	)

388 
	#ªg_™a_addr
 
	`REG_ADDR8
(0xb8)

	)

389 
	#ªg_™a_d©a
 
	`REG_ADDR8
(0xb9)

	)

390 
	#ªg_™a_˘æ
 
	`REG_ADDR8
(0xba)

	)

393 
	mFLD_ANA_BUSY
 = 
BIT
(0),

394 
	mFLD_ANA_LS_CON
 = 
BIT
(4),

395 
	mFLD_ANA_RW
 = 
BIT
(5),

396 
	mFLD_ANA_CYC0
 = 
BIT
(6),

402 
	#ªg_˘æ_ï_±r
 
	`REG_ADDR8
(0x100)

	)

403 
	#ªg_˘æ_ï_d©
 
	`REG_ADDR8
(0x101)

	)

404 
	#ªg_˘æ_ï_˘æ
 
	`REG_ADDR8
(0x102)

	)

407 
	mFLD_EP_DAT_ACK
 = 
BIT
(0),

408 
	mFLD_EP_DAT_STALL
 = 
BIT
(1),

409 
	mFLD_EP_STA_ACK
 = 
BIT
(2),

410 
	mFLD_EP_STA_STALL
 = 
BIT
(3),

413 
	#ªg_˘æ_ï_úq_°a
 
	`REG_ADDR8
(0x103)

	)

415 
	mFLD_CTRL_EP_IRQ_TRANS
 = 
BIT_RNG
(0,3),

416 
	mFLD_CTRL_EP_IRQ_SETUP
 = 
BIT
(4),

417 
	mFLD_CTRL_EP_IRQ_DATA
 = 
BIT
(5),

418 
	mFLD_CTRL_EP_IRQ_STA
 = 
BIT
(6),

419 
	mFLD_CTRL_EP_IRQ_INTF
 = 
BIT
(7),

422 
	#ªg_˘æ_ï_úq_mode
 
	`REG_ADDR8
(0x104)

	)

424 
	mFLD_CTRL_EP_AUTO_ADDR
 = 
BIT
(0),

425 
	mFLD_CTRL_EP_AUTO_CFG
 = 
BIT
(1),

426 
	mFLD_CTRL_EP_AUTO_INTF
 = 
BIT
(2),

427 
	mFLD_CTRL_EP_AUTO_STA
 = 
BIT
(3),

428 
	mFLD_CTRL_EP_AUTO_SYN
 = 
BIT
(4),

429 
	mFLD_CTRL_EP_AUTO_DESC
 = 
BIT
(5),

430 
	mFLD_CTRL_EP_AUTO_FEAT
 = 
BIT
(6),

431 
	mFLD_CTRL_EP_AUTO_STD
 = 
BIT
(7),

434 
	#ªg_usb_˘æ
 
	`REG_ADDR8
(0x105)

	)

436 
	mFLD_USB_CTRL_AUTO_CLK
 = 
BIT
(0),

437 
	mFLD_USB_CTRL_LOW_SPD
 = 
BIT
(1),

438 
	mFLD_USB_CTRL_LOW_JITT
 = 
BIT
(2),

439 
	mFLD_USB_CTRL_TST_MODE
 = 
BIT
(3),

442 
	#ªg_usb_cyc_ˇli
 
	`REG_ADDR16
(0x106)

	)

443 
	#ªg_usb_mdev
 
	`REG_ADDR8
(0x10a)

	)

444 
	#ªg_usb_ho°_c⁄n
 
	`REG_ADDR8
(0x10b)

	)

446 
	mFLD_USB_MDEV_SELF_PWR
 = 
BIT
(0),

447 
	mFLD_USB_MDEV_SUSP_STA
 = 
BIT
(1),

450 
	#ªg_usb_sups_cyc_ˇli
 
	`REG_ADDR8
(0x10c)

	)

451 
	#ªg_usb_ötf_Æt
 
	`REG_ADDR8
(0x10d)

	)

453 
	#ªg_usb_ï8123_±r
 
	`REG_ADDR32
(0x110)

	)

454 
	#ªg_usb_ï8_±r
 
	`REG_ADDR8
(0x110)

	)

455 
	#ªg_usb_ï1_±r
 
	`REG_ADDR8
(0x111)

	)

456 
	#ªg_usb_ï2_±r
 
	`REG_ADDR8
(0x112)

	)

457 
	#ªg_usb_ï3_±r
 
	`REG_ADDR8
(0x113)

	)

458 
	#ªg_usb_ï4567_±r
 
	`REG_ADDR32
(0x114)

	)

459 
	#ªg_usb_ï4_±r
 
	`REG_ADDR8
(0x114)

	)

460 
	#ªg_usb_ï5_±r
 
	`REG_ADDR8
(0x115)

	)

461 
	#ªg_usb_ï6_±r
 
	`REG_ADDR8
(0x116)

	)

462 
	#ªg_usb_ï7_±r
 
	`REG_ADDR8
(0x117)

	)

463 
	#ªg_usb_ï_±r
(
i
Ë
	`REG_ADDR8
(0x110+((iË& 0x07))

	)

465 
	#ªg_usb_ï8123_d©
 
	`REG_ADDR32
(0x118)

	)

466 
	#ªg_usb_ï8_d©
 
	`REG_ADDR8
(0x118)

	)

467 
	#ªg_usb_ï1_d©
 
	`REG_ADDR8
(0x119)

	)

468 
	#ªg_usb_ï2_d©
 
	`REG_ADDR8
(0x11a)

	)

469 
	#ªg_usb_ï3_d©
 
	`REG_ADDR8
(0x11b)

	)

470 
	#ªg_usb_ï4567_d©
 
	`REG_ADDR32
(0x11c)

	)

471 
	#ªg_usb_ï4_d©
 
	`REG_ADDR8
(0x11c)

	)

472 
	#ªg_usb_ï5_d©
 
	`REG_ADDR8
(0x11d)

	)

473 
	#ªg_usb_ï6_d©
 
	`REG_ADDR8
(0x11e)

	)

474 
	#ªg_usb_ï7_d©
 
	`REG_ADDR8
(0x11f)

	)

475 
	#ªg_usb_ï_d©
(
i
Ë
	`REG_ADDR8
(0x118+((iË& 0x07))

	)

476 
	#ªg_usb_mic_d©0
 
	`REG_ADDR16
(0x1800)

	)

477 
	#ªg_usb_mic_d©1
 
	`REG_ADDR16
(0x1802)

	)

479 
	#ªg_usb_ï8_˘æ
 
	`REG_ADDR8
(0x120)

	)

480 
	#ªg_usb_ï1_˘æ
 
	`REG_ADDR8
(0x121)

	)

481 
	#ªg_usb_ï2_˘æ
 
	`REG_ADDR8
(0x122)

	)

482 
	#ªg_usb_ï3_˘æ
 
	`REG_ADDR8
(0x123)

	)

483 
	#ªg_usb_ï4_˘æ
 
	`REG_ADDR8
(0x124)

	)

484 
	#ªg_usb_ï5_˘æ
 
	`REG_ADDR8
(0x125)

	)

485 
	#ªg_usb_ï6_˘æ
 
	`REG_ADDR8
(0x126)

	)

486 
	#ªg_usb_ï7_˘æ
 
	`REG_ADDR8
(0x127)

	)

487 
	#ªg_usb_ï_˘æ
(
i
Ë
	`REG_ADDR8
(0x120+((iË& 0x07))

	)

490 
	mFLD_USB_EP_BUSY
 = 
BIT
(0),

491 
	mFLD_USB_EP_STALL
 = 
BIT
(1),

492 
	mFLD_USB_EP_DAT0
 = 
BIT
(2),

493 
	mFLD_USB_EP_DAT1
 = 
BIT
(3),

494 
	mFLD_USB_EP_MONO
 = 
BIT
(6),

495 
	mFLD_USB_EP_EOF_ISO
 = 
BIT
(7),

498 
	#ªg_usb_ï8123_buf_addr
 
	`REG_ADDR32
(0x128)

	)

499 
	#ªg_usb_ï8_buf_addr
 
	`REG_ADDR8
(0x128)

	)

500 
	#ªg_usb_ï1_buf_addr
 
	`REG_ADDR8
(0x129)

	)

501 
	#ªg_usb_ï2_buf_addr
 
	`REG_ADDR8
(0x12a)

	)

502 
	#ªg_usb_ï3_buf_addr
 
	`REG_ADDR8
(0x12b)

	)

503 
	#ªg_usb_ï4567_buf_addr
 
	`REG_ADDR32
(0x12c)

	)

504 
	#ªg_usb_ï4_buf_addr
 
	`REG_ADDR8
(0x12c)

	)

505 
	#ªg_usb_ï5_buf_addr
 
	`REG_ADDR8
(0x12d)

	)

506 
	#ªg_usb_ï6_buf_addr
 
	`REG_ADDR8
(0x12e)

	)

507 
	#ªg_usb_ï7_buf_addr
 
	`REG_ADDR8
(0x12f)

	)

508 
	#ªg_usb_ï_buf_addr
(
i
Ë
	`REG_ADDR8
(0x128+((iË& 0x07))

	)

510 
	#ªg_usb_øm_˘æ
 
	`REG_ADDR8
(0x130)

	)

512 
	mFLD_USB_CEN_PWR_DN
 = 
BIT
(0),

513 
	mFLD_USB_CLK_PWR_DN
 = 
BIT
(1),

514 
	mFLD_USB_WEN_PWR_DN
 = 
BIT
(3),

515 
	mFLD_USB_CEN_FUNC
 = 
BIT
(4),

518 
	#ªg_usb_iso_mode
 
	`REG_ADDR8
(0x138)

	)

519 
	#ªg_usb_úq
 
	`REG_ADDR8
(0x139)

	)

520 
	#ªg_usb_mask
 
	`REG_ADDR8
(0x13a)

	)

522 
	mFLD_USB_EDP8_IRQ
 = 
BIT
(0),

523 
	mFLD_USB_EDP1_IRQ
 = 
BIT
(1),

524 
	mFLD_USB_EDP2_IRQ
 = 
BIT
(2),

525 
	mFLD_USB_EDP3_IRQ
 = 
BIT
(3),

526 
	mFLD_USB_EDP4_IRQ
 = 
BIT
(4),

527 
	mFLD_USB_EDP5_IRQ
 = 
BIT
(5),

528 
	mFLD_USB_EDP6_IRQ
 = 
BIT
(6),

529 
	mFLD_USB_EDP7_IRQ
 = 
BIT
(7),

531 
	#ªg_usb_ï8_£nd_max
 
	`REG_ADDR8
(0x13b)

	)

532 
	#ªg_usb_ï8_£nd_thª
 
	`REG_ADDR8
(0x13c)

	)

533 
	#ªg_usb_ï8_fifo_mode
 
	`REG_ADDR8
(0x13d)

	)

534 
	#ªg_usb_ï_max_size
 
	`REG_ADDR8
(0x13e)

	)

537 
	mFLD_USB_ENP8_FIFO_MODE
 = 
BIT
(0),

538 
	mFLD_USB_ENP8_FULL_FLAG
 = 
BIT
(1),

541 
	#ªg_rf_acc_Àn
 
	`REG_ADDR8
(0x405)

	)

543 
	mFLD_RF_ACC_LEN
 = 
BIT_RNG
(0,2),

544 
	mFLD_RF_LR_MAN_EN
 = 
BIT
(3),

545 
	mFLD_RF_LR_TX_SEL
 = 
BIT
(4),

546 
	mFLD_RF_BLE_LR
 = 
BIT
(5),

547 
	mFLD_RF_LR_ACC_TRIG
 = 
BIT
(7),

551 
	#ªg_rf_time°amp
 
	`REG_ADDR32
(0x450)

	)

556 
	#ªg_´s_˘æ
 
	`REG_ADDR8
(0x540)

	)

559 
	mFLD_AES_CTRL_CODEC_TRIG
 = 
BIT
(0),

560 
	mFLD_AES_CTRL_DATA_FEED
 = 
BIT
(1),

561 
	mFLD_AES_CTRL_CODEC_FINISHED
 = 
BIT
(2),

564 
	#ªg_´s_d©a
 
	`REG_ADDR32
(0x548)

	)

565 
	#ªg_´s_key
(
v
Ë
	`REG_ADDR8
(0x550+v)

	)

570 
	#ªg_audio_˘æ
 
	`REG_ADDR8
(0x560)

	)

572 
	mAUDIO_OUTPUT_OFF
 = 0,

573 
	mFLD_AUDIO_MONO_MODE
 = 
BIT
(0),

574 
	mFLD_AUDIO_I2S_PLAYER_EN
 = 
BIT
(1),

575 
	mFLD_AUDIO_SDM_PLAYER_EN
 = 
BIT
(2),

576 
	mFLD_AUDIO_ISO_PLAYER_EN
 = 
BIT
(3),

577 
	mFLD_AUDIO_I2S_RECORDER_EN
 = 
BIT
(4),

578 
	mFLD_AUDIO_I2S_INTERFACE_EN
 = 
BIT
(5),

579 
	mFLD_AUDIO_GRP_EN
 = 
BIT
(6),

580 
	mFLD_AUDIO_HPF_EN
 = 
BIT
(7),

583 
	#ªg_pwm_˘æ
 
	`REG_ADDR8
(0x563)

	)

585 
	mFLD_PWM_MULTIPLY2
 = 
BIT
(0),

586 
	mFLD_PWM_ENABLE
 = 
BIT
(1),

587 
	mFLD_LINER_INTERPOLATE_EN
 = 
BIT
(2),

588 
	mFLD_LEFT_SHAPING_EN
 = 
BIT
(5),

589 
	mFLD_RIGTH_SHAPING_EN
 = 
BIT
(6)

592 
	#ªg_as˛_tu√
 
	`REG_ADDR32
(0x564)

	)

594 
	#ªg_≤1_À·
 
	`REG_ADDR8
(0x568)

	)

596 
	mPN1_LEFT_CHN_BITS
 = 
BIT_RNG
(0,4),

597 
	mPN2_LEFT_CHN_EN
 = 
BIT
(5),

598 
	mPN1_LEFT_CHN_EN
 = 
BIT
(6),

601 
	#ªg_≤2_À·
 
	`REG_ADDR8
(0x569)

	)

603 
	mPN2_LEFT_CHN_BITS
 = 
BIT_RNG
(0,4),

604 
	mPN2_RIGHT_CHN_EN
 = 
BIT
(5),

605 
	mPN1_RIGHT_CHN_EN
 = 
BIT
(6),

608 
	#ªg_≤1_right
 
	`REG_ADDR8
(0x56a)

	)

610 
	mPN1_RIGHT_CHN_BITS
 = 
BIT_RNG
(0,4),

611 
	mCLK2A_AUDIO_CLK_EN
 = 
BIT
(5),

612 
	mEXCHANGE_SDM_DATA_EN

BIT
(6),

615 
	#ªg_≤2_right
 
	`REG_ADDR8
(0x56b)

	)

617 
	mPN2_RIGHT_CHN_BITS
 = 
BIT_RNG
(0,4),

618 
	mSDM_LEFT_CHN_CONST_EN
 = 
BIT
(5),

619 
	mSDM_RIGHT_CHN_CONST_EN
 = 
BIT
(6),

624 
	#ªg_gpio_∑_ö
 
	`REG_ADDR8
(0x580)

	)

625 
	#ªg_gpio_∑_õ
 
	`REG_ADDR8
(0x581)

	)

626 
	#ªg_gpio_∑_€n
 
	`REG_ADDR8
(0x582)

	)

627 
	#ªg_gpio_∑_out
 
	`REG_ADDR8
(0x583)

	)

628 
	#ªg_gpio_∑_pﬁ
 
	`REG_ADDR8
(0x584)

	)

629 
	#ªg_gpio_∑_ds
 
	`REG_ADDR8
(0x585)

	)

630 
	#ªg_gpio_∑_gpio
 
	`REG_ADDR8
(0x586)

	)

631 
	#ªg_gpio_∑_úq_í
 
	`REG_ADDR8
(0x587)

	)

633 
	#ªg_gpio_pb_ö
 
	`REG_ADDR8
(0x588)

	)

634 
	#¨eg_gpio_pb_õ
 0xbd

	)

635 
	#ªg_gpio_pb_€n
 
	`REG_ADDR8
(0x58a)

	)

636 
	#ªg_gpio_pb_out
 
	`REG_ADDR8
(0x58b)

	)

637 
	#ªg_gpio_pb_pﬁ
 
	`REG_ADDR8
(0x58c)

	)

638 
	#¨eg_gpio_pb_ds
 0xbf

	)

639 
	#ªg_gpio_pb_gpio
 
	`REG_ADDR8
(0x58e)

	)

640 
	#ªg_gpio_pb_úq_í
 
	`REG_ADDR8
(0x58f)

	)

642 
	#ªg_gpio_pc_ö
 
	`REG_ADDR8
(0x590)

	)

643 
	#¨eg_gpio_pc_õ
 0xc0

	)

644 
	#ªg_gpio_pc_€n
 
	`REG_ADDR8
(0x592)

	)

645 
	#ªg_gpio_pc_out
 
	`REG_ADDR8
(0x593)

	)

646 
	#ªg_gpio_pc_pﬁ
 
	`REG_ADDR8
(0x594)

	)

647 
	#¨eg_gpio_pc_ds
 0xc2

	)

648 
	#ªg_gpio_pc_gpio
 
	`REG_ADDR8
(0x596)

	)

649 
	#ªg_gpio_pc_úq_í
 
	`REG_ADDR8
(0x597)

	)

651 
	#ªg_gpio_pd_ö
 
	`REG_ADDR8
(0x598)

	)

652 
	#ªg_gpio_pd_õ
 
	`REG_ADDR8
(0x599)

	)

653 
	#ªg_gpio_pd_€n
 
	`REG_ADDR8
(0x59a)

	)

654 
	#ªg_gpio_pd_out
 
	`REG_ADDR8
(0x59b)

	)

655 
	#ªg_gpio_pd_pﬁ
 
	`REG_ADDR8
(0x59c)

	)

656 
	#ªg_gpio_pd_ds
 
	`REG_ADDR8
(0x59d)

	)

657 
	#ªg_gpio_pd_gpio
 
	`REG_ADDR8
(0x59e)

	)

658 
	#ªg_gpio_pd_úq_í
 
	`REG_ADDR8
(0x59f)

	)

660 
	#ªg_gpio_≥_ö
 
	`REG_ADDR8
(0x5a0)

	)

661 
	#ªg_gpio_≥_õ
 
	`REG_ADDR8
(0x5a1)

	)

662 
	#ªg_gpio_≥_€n
 
	`REG_ADDR8
(0x5a2)

	)

663 
	#ªg_gpio_≥_out
 
	`REG_ADDR8
(0x5a3)

	)

664 
	#ªg_gpio_≥_pﬁ
 
	`REG_ADDR8
(0x5a4)

	)

665 
	#ªg_gpio_≥_ds
 
	`REG_ADDR8
(0x5a5)

	)

666 
	#ªg_gpio_≥_gpio
 
	`REG_ADDR8
(0x5a6)

	)

667 
	#ªg_gpio_≥_úq_í
 
	`REG_ADDR8
(0x5a7)

	)

669 
	#ªg_gpio_∑_£âög1
 
	`REG_ADDR32
(0x580)

	)

670 
	#ªg_gpio_∑_£âög2
 
	`REG_ADDR32
(0x584)

	)

671 
	#ªg_gpio_pd_£âög1
 
	`REG_ADDR32
(0x598)

	)

672 
	#ªg_gpio_pd_£âög2
 
	`REG_ADDR32
(0x59c)

	)

674 
	#ªg_gpio_ö
(
i
Ë
	`REG_ADDR8
(0x580+((i>>8)<<3))

	)

675 
	#ªg_gpio_õ
(
i
Ë
	`REG_ADDR8
(0x581+((i>>8)<<3))

	)

676 
	#ªg_gpio_€n
(
i
Ë
	`REG_ADDR8
(0x582+((i>>8)<<3))

	)

677 
	#ªg_gpio_out
(
i
Ë
	`REG_ADDR8
(0x583+((i>>8)<<3))

	)

678 
	#ªg_gpio_pﬁ
(
i
Ë
	`REG_ADDR8
(0x584+((i>>8)<<3))

	)

679 
	#ªg_gpio_ds
(
i
Ë
	`REG_ADDR8
(0x585+((i>>8)<<3))

	)

682 
	#ªg_gpio_func
(
i
Ë
	`REG_ADDR8
(0x586+((i>>8)<<3))

	)

684 
	#ªg_gpio_úq_wakeup_í
(
i
Ë
	`REG_ADDR8
(0x587+((i>>8)<<3))

685 

	)

686 
	#ªg_gpio_úq_risc0_í
(
i
Ë
	`REG_ADDR8
(0x5b8 + (i >> 8))

687 
	#ªg_gpio_úq_risc1_í
(
i
Ë
	`REG_ADDR8
(0x5c0 + (i >> 8))

688 
	#ªg_gpio_úq_risc2_í
(
i
Ë
	`REG_ADDR8
(0x5c8 + (ò>> 8))

	)

690 
	#ªg_mux_func_a1
 
	`REG_ADDR8
(0x5a8)

	)

691 
	#ªg_mux_func_a2
 
	`REG_ADDR8
(0x5a9)

	)

692 
	#ªg_mux_func_b1
 
	`REG_ADDR8
(0x5Ø)

	)

693 
	#ªg_mux_func_b2
 
	`REG_ADDR8
(0x5ab)

	)

694 
	#ªg_mux_func_c1
 
	`REG_ADDR8
(0x5ac)

	)

695 
	#ªg_mux_func_c2
 
	`REG_ADDR8
(0x5ad)

	)

696 
	#ªg_mux_func_d1
 
	`REG_ADDR8
(0x5´)

	)

697 
	#ªg_mux_func_d2
 
	`REG_ADDR8
(0x5af)

	)

699 
	#ªg_gpio_wakeup_úq
 
	`REG_ADDR8
(0x5b5)

	)

701 
	mFLD_GPIO_CORE_WAKEUP_EN
 = 
BIT
(2),

702 
	mFLD_GPIO_CORE_INTERRUPT_EN
 = 
BIT
(3),

705 
	#ªg_pö_i2c_•i_out_í
 
	`REG_ADDR8
(0x5b6)

	)

707 
	mFLD_PIN_PAGROUP_SPI_EN
 = 
BIT_RNG
(4,5),

708 
	mFLD_PIN_PBGROUP_SPI_EN
 = 
BIT
(6),

709 
	mFLD_PIN_PDGROUP_SPI_EN
 = 
BIT
(7),

713 
	#ªg_pö_i2c_•i_í
 
	`REG_ADDR8
(0x5b7)

714 íum{

	)

715 
	mFLD_PIN_PA3_SPI_EN
 = 
BIT
(0),

716 
	mFLD_PIN_PA4_SPI_EN
 = 
BIT
(1),

717 
	mFLD_PIN_PB6_SPI_EN
 = 
BIT
(2),

718 
	mFLD_PIN_PD7_SPI_EN
 = 
BIT
(3),

719 
	mFLD_PIN_PA3_I2C_EN
 = 
BIT
(4),

720 
	mFLD_PIN_PA4_I2C_EN
 = 
BIT
(5),

721 
	mFLD_PIN_PB6_I2C_EN
 = 
BIT
(6),

722 
	mFLD_PIN_PD7_I2C_EN
 = 
BIT
(7),

728 
	#ªg_tmr_˘æ
 
	`REG_ADDR32
(0x620)

	)

729 
	#ªg_tmr_˘æ16
 
	`REG_ADDR16
(0x620)

	)

730 
	#ªg_tmr_˘æ8
 
	`REG_ADDR8
(0x620)

	)

732 
	mFLD_TMR0_EN
 = 
BIT
(0),

733 
	mFLD_TMR0_MODE
 = 
BIT_RNG
(1,2),

734 
	mFLD_TMR1_EN
 = 
BIT
(3),

735 
	mFLD_TMR1_MODE
 = 
BIT_RNG
(4,5),

736 
	mFLD_TMR2_EN
 = 
BIT
(6),

737 
	mFLD_TMR2_MODE
 = 
BIT_RNG
(7,8),

738 
	mFLD_TMR_WD_CAPT
 = 
BIT_RNG
(9,22),

739 
	mFLD_TMR_WD_EN
 = 
BIT
(23),

740 
	mFLD_TMR0_STA
 = 
BIT
(24),

741 
	mFLD_TMR1_STA
 = 
BIT
(25),

742 
	mFLD_TMR2_STA
 = 
BIT
(26),

743 
	mFLD_CLR_WD
 = 
BIT
(27),

746 
	#ªg_tmr_°a
 
	`REG_ADDR8
(0x623)

	)

748 
	mFLD_TMR_STA_TMR0
 = 
BIT
(0),

749 
	mFLD_TMR_STA_TMR1
 = 
BIT
(1),

750 
	mFLD_TMR_STA_TMR2
 = 
BIT
(2),

751 
	mFLD_TMR_STA_WD
 = 
BIT
(3),

754 
	#ªg_tmr0_ˇ±
 
	`REG_ADDR32
(0x624)

	)

755 
	#ªg_tmr1_ˇ±
 
	`REG_ADDR32
(0x628)

	)

756 
	#ªg_tmr2_ˇ±
 
	`REG_ADDR32
(0x62c)

	)

757 
	#ªg_tmr_ˇ±
(
i
Ë
	`REG_ADDR32
(0x624 + ((iË<< 2))

	)

758 
	#ªg_tmr0_tick
 
	`REG_ADDR32
(0x630)

	)

759 
	#ªg_tmr1_tick
 
	`REG_ADDR32
(0x634)

	)

760 
	#ªg_tmr2_tick
 
	`REG_ADDR32
(0x638)

	)

761 
	#ªg_tmr_tick
(
i
Ë
	`REG_ADDR32
(0x630 + ((iË<< 2))

	)

765 
	#ªg_úq_mask
 
	`REG_ADDR32
(0x640)

	)

766 
	#ªg_úq_¥i
 
	`REG_ADDR32
(0x644)

	)

767 
	#ªg_úq_§c
 
	`REG_ADDR32
(0x648)

	)

768 
	#ªg_úq_§c3
 
	`REG_ADDR8
(0x64a)

	)

770 
	mFLD_IRQ_TMR0_EN
 = 
BIT
(0),

771 
	mFLD_IRQ_TMR1_EN
 = 
BIT
(1),

772 
	mFLD_IRQ_TMR2_EN
 = 
BIT
(2),

773 
	mFLD_IRQ_USB_PWDN_EN
 = 
BIT
(3),

774 
	mFLD_IRQ_DMA_EN
 = 
BIT
(4),

775 
	mFLD_IRQ_DAM_FIFO_EN
 = 
BIT
(5),

776 
	mFLD_IRQ_UART_EN
 = 
BIT
(6),

777 
	mFLD_IRQ_MIX_CMD_EN
 = 
BIT
(7), 
	mFLD_IRQ_HOST_CMD_EN
 = BIT(7),

779 
	mFLD_IRQ_EP0_SETUP_EN
 = 
BIT
(8),

780 
	mFLD_IRQ_EP0_DAT_EN
 = 
BIT
(9),

781 
	mFLD_IRQ_EP0_STA_EN
 = 
BIT
(10),

782 
	mFLD_IRQ_SET_INTF_EN
 = 
BIT
(11),

783 
	mFLD_IRQ_EP_DATA_EN
 = 
BIT
(12), 
	mFLD_IRQ_IRQ4_EN
 = BIT(12),

784 
	mFLD_IRQ_ZB_RT_EN
 = 
BIT
(13),

785 
	mFLD_IRQ_SW_PWM_EN
 = 
BIT
(14),

788 
	mFLD_IRQ_USB_250US_EN
 = 
BIT
(16),

789 
	mFLD_IRQ_USB_RST_EN
 = 
BIT
(17),

790 
	mFLD_IRQ_GPIO_EN
 = 
BIT
(18),

791 
	mFLD_IRQ_PM_EN
 = 
BIT
(19),

792 
	mFLD_IRQ_SYSTEM_TIMER
 = 
BIT
(20),

793 
	mFLD_IRQ_GPIO_RISC0_EN
 = 
BIT
(21),

794 
	mFLD_IRQ_GPIO_RISC1_EN
 = 
BIT
(22),

797 
	mFLD_IRQ_EN
 = 
BIT_RNG
(24,31),

798 
	mFLD_IRQ_ALL
 = 0XFFFFFFFF,

800 
	#ªg_úq_í
 
	`REG_ADDR8
(0x643)

	)

807 
	#ªg_sy°em_tick
 
	`REG_ADDR32
(0x740)

	)

808 
	#ªg_sy°em_tick_úq
 
	`REG_ADDR32
(0x744)

	)

809 
	#ªg_sy°em_wakeup_tick
 
	`REG_ADDR32
(0x748)

	)

810 
	#ªg_sy°em_tick_mode
 
	`REG_ADDR8
(0x74c)

	)

811 
	#ªg_sy°em_tick_˘æ
 
	`REG_ADDR8
(0x74f)

	)

814 
	mFLD_SYSTEM_TICK_START
 = 
BIT
(0),

815 
	mFLD_SYSTEM_TICK_STOP
 = 
BIT
(1),

816 
	mFLD_SYSTEM_TICK_RUNNING
 = 
BIT
(1),

818 
	mFLD_SYSTEM_TICK_IRQ_EN
 = 
BIT
(1),

825 
	#ªg_pwm_íabÀ
 
	`REG_ADDR8
(0x780)

	)

826 
	#ªg_pwm0_íabÀ
 
	`REG_ADDR8
(0x781)

	)

827 
	#ªg_pwm_˛k
 
	`REG_ADDR8
(0x782)

	)

829 
	#ªg_pwm0_mode
 
	`REG_ADDR8
(0x783)

	)

832 
	#ªg_pwm_övît
 
	`REG_ADDR8
(0x784)

	)

833 
	#ªg_pwm_n_övît
 
	`REG_ADDR8
(0x785)

	)

834 
	#ªg_pwm_pﬁ
 
	`REG_ADDR8
(0x786)

	)

836 
	#ªg_pwm_cy˛e
(
i
Ë
	`REG_ADDR32
(0x794 + (i << 2))

837 
	#ªg_pwm_cmp
(
i
Ë
	`REG_ADDR16
(0x794 + (i << 2))

838 
	#ªg_pwm_max
(
i
Ë
	`REG_ADDR16
(0x796 + (i << 2))

839 íum{

	)

840 
	mFLD_PWM_CMP
 = 
BIT_RNG
(0,15),

841 
	mFLD_PWM_MAX
 = 
BIT_RNG
(16,31),

844 
	#ªg_pwm0_pul£_num
 
	`REG_ADDR16
(0x7ac)

	)

846 
	#ªg_pwm_úq_mask
 
	`REG_ADDR8
(0x7b0)

	)

847 
	#ªg_pwm_úq_°a
 
	`REG_ADDR8
(0x7b1)

	)

849 
	mFLD_IRQ_PWM0_PNUM
 = 
BIT
(0),

850 
	mFLD_IRQ_PWM0_IR_DMA_FIFO_DONE
 = 
BIT
(1),

851 
	mFLD_IRQ_PWM0_FRAME
 = 
BIT
(2),

852 
	mFLD_IRQ_PWM1_FRAME
 = 
BIT
(3),

853 
	mFLD_IRQ_PWM2_FRAME
 = 
BIT
(4),

854 
	mFLD_IRQ_PWM3_FRAME
 = 
BIT
(5),

855 
	mFLD_IRQ_PWM4_FRAME
 = 
BIT
(6),

856 
	mFLD_IRQ_PWM5_FRAME
 = 
BIT
(7),

861 
	#ªg_pwm0_fifo_mode_úq_mask
 
	`REG_ADDR8
(0x7b2)

	)

864 
	mFLD_PWM0_IRQ_IR_FIFO_EN
 = 
BIT
(0),

867 
	#ªg_pwm0_fifo_mode_úq_°a
 
	`REG_ADDR8
(0x7b3)

	)

870 
	mFLD_PWM0_IRQ_IR_FIFO_CNT
 = 
BIT
(0),

875 
	#ªg_pwm_tcmp0_shadow
 
	`REG_ADDR16
(0x7c4)

876 
	#ªg_pwm_tmax0_shadow
 
	`REG_ADDR16
(0x7c6)

877 

	)

878 
	#ªg_pwm_ú_fifo_d©
(
i
Ë
	`REG_ADDR16
(0x7c8+i*2)

	)

879 
	#ªg_pwm_ú_fifo_úq_åig_Àvñ
 
	`REG_ADDR8
(0x7cc)

	)

881 
	#ªg_pwm_ú_fifo_d©a_°©us
 
	`REG_ADDR8
(0x7cd)

	)

883 
	mFLD_PWM0_IR_FIFO_DATA_NUM
 = 
BIT_RNG
(0,3),

884 
	mFLD_PWM0_IR_FIFO_EMPTY
 = 
BIT
(4),

885 
	mFLD_PWM0_IR_FIFO_FULL
 = 
BIT
(5),

888 
	#ªg_pwm_ú_˛r_fifo_d©a
 
	`REG_ADDR8
(0x7˚)

	)

891 
	mFLD_PWM0_IR_FIFO_CLR_DATA
 = 
BIT
(0),

896 
	#ªg_fifo0_d©a
 
	`REG_ADDR32
(0x800)

	)

897 
	#ªg_fifo1_d©a
 
	`REG_ADDR32
(0x900)

	)

898 
	#ªg_fifo2_d©a
 
	`REG_ADDR32
(0xa00)

	)

902 
	#ªg_dfifo0_addr
 
	`REG_ADDR16
(0xb00)

	)

903 
	#ªg_dfifo0_size
 
	`REG_ADDR8
(0xb02)

	)

904 
	#ªg_dfifo0_addHi
 
	`REG_ADDR8
(0xb03)

905 

	)

906 
	#ªg_dfifo1_addr
 
	`REG_ADDR16
(0xb04)

	)

907 
	#ªg_dfifo1_size
 
	`REG_ADDR8
(0xb06)

	)

908 
	#ªg_dfifo1_addHi
 
	`REG_ADDR8
(0xb07)

909 

	)

911 
	#ªg_dfifo2_addr
 
	`REG_ADDR16
(0xb08)

	)

912 
	#ªg_dfifo2_size
 
	`REG_ADDR8
(0xb0a)

	)

913 
	#ªg_dfifo2_addHi
 
	`REG_ADDR8
(0xb0b)

914 

	)

915 
	#ªg_dfifo_audio_addr
 
ªg_dfifo0_addr


	)

916 
	#ªg_dfifo_audio_size
 
ªg_dfifo0_size


	)

918 
	#ªg_dfifo_misc_chn_addr
 
ªg_dfifo2_addr


	)

919 
	#ªg_dfifo_misc_chn_size
 
ªg_dfifo2_size


	)

922 
	#ªg_dfifo0_l_Àvñ
 
	`REG_ADDR8
(0xb0c)

923 
	#ªg_dfifo0_h_Àvñ
 
	`REG_ADDR8
(0xb0d)

924 
	#ªg_dfifo1_h_Àvñ
 
	`REG_ADDR8
(0xb0e)

925 
	#ªg_dfifo2_h_Àvñ
 
	`REG_ADDR8
(0xb0f)

926 

	)

928 
	#ªg_dfifo_mode
 
	`REG_ADDR8
(0xb10)

	)

930 
	mFLD_AUD_DFIFO0_IN
 = 
BIT
(0),

931 
	mFLD_AUD_DFIFO1_IN
 = 
BIT
(1),

932 
	mFLD_AUD_DFIFO2_IN
 = 
BIT
(2),

933 
	mFLD_AUD_DFIFO0_OUT
 = 
BIT
(3),

934 
	mFLD_AUD_DFIFO0_L_INT
 = 
BIT
(4),

935 
	mFLD_AUD_DFIFO0_H_INT
 = 
BIT
(5),

936 
	mFLD_AUD_DFIFO1_H_INT
 = 
BIT
(6),

937 
	mFLD_AUD_DFIFO2_H_INT
 = 
BIT
(7),

940 
	#ªg_dfifo_aö
 
	`REG_ADDR8
(0xb11)

	)

942 
	mFLD_AUD_DMIC0_DATA_IN_RISING_EDGE
 = 
BIT
(0),

943 
	mFLD_AUD_DMIC1_DATA_IN_RISING_EDGE
 = 
BIT
(1),

944 
	mFLD_AUD_INPUT_SELECT
 = 
BIT_RNG
(2,3),

945 
	mFLD_AUD_INPUT_MONO_MODE
 = 
BIT
(4),

946 
	mFLD_AUD_DECIMATION_FILTER_BYPASS
 = 
BIT
(5),

947 
	mFLD_AUD_DMIC_RISING_EDGE_BYPASS
 = 
BIT
(6),

948 
	mFLD_AUD_DMIC_FALLING_EDGE_BYPASS
 = 
BIT
(7),

953 
	mAUDIO_DMIC_DATA_IN_RISING_EDGE
 = 1,

954 
	mAUDIO_DMIC_DATA_IN_FALLING_EDGE
 = 0,

958 
	mAUDIO_INPUT_USB
 = 0x00,

959 
	mAUDIO_INPUT_I2S
 = 0x01,

960 
	mAUDIO_INPUT_AMIC
 = 0x02,

961 
	mAUDIO_INPUT_DMIC
 = 0x03,

966 
	#ªg_dfifo_dec_øtio
 
	`REG_ADDR8
(0xb12)

	)

968 
	#ªg_dfifo_úq_°©us
 
	`REG_ADDR8
(0xb13)

	)

970 
	mFLD_AUD_DFIFO0_L_IRQ
 = 
BIT
(4),

971 
	mFLD_AUD_DFIFO0_H_IRQ
 = 
BIT
(5),

972 
	mFLD_AUD_DFIFO1_L_IRQ
 = 
BIT
(6),

973 
	mFLD_AUD_DFIFO1_H_IRQ
 = 
BIT
(7),

975 
	#ªg_dfifo0_Ωå
 
	`REG_ADDR16
(0xb14)

	)

976 
	#ªg_dfifo0_w±r
 
	`REG_ADDR16
(0xb16)

	)

978 
	#ªg_dfifo1_Ωå
 
	`REG_ADDR16
(0xb18)

	)

979 
	#ªg_dfifo1_w±r
 
	`REG_ADDR16
(0xb1a)

	)

981 
	#ªg_dfifo2_Ωå
 
	`REG_ADDR16
(0xb1c)

	)

982 
	#ªg_dfifo2_w±r
 
	`REG_ADDR16
(0xb1e)

	)

985 
	#ªg_audio_w±r
 
ªg_dfifo0_w±r


	)

987 
	#ªg_dfifo0_num
 
	`REG_ADDR16
(0xb20)

	)

988 
	#ªg_dfifo1_num
 
	`REG_ADDR16
(0xb24)

	)

989 
	#ªg_dfifo2_num
 
	`REG_ADDR16
(0xb28)

	)

991 
	#ªg_dfifo0_m™uÆ
 
	`REG_ADDR8
(0xb2c)

	)

993 
	mFLD_DFIFO_MANUAL_MODE_EN
 = 
BIT
(0),

996 
	#ªg_dfifo0_m™_d©
 
	`REG_ADDR32
(0xb30)

	)

998 
	#ªg_Æc_s·
 
	`REG_ADDR8
(0xb34)

	)

1000 
	#ªg_audio_dec_mode
 
	`REG_ADDR8
(0xb35)

	)

1002 
	mFLD_AUD_LNR_VALID_SEL
 = 
BIT
(0),

1003 
	mFLD_AUD_CIC_MODE
 = 
BIT
(3)

1007 
	#ªg_adc_mul
 
	`REG_ADDR8
(0xb36)

	)

1008 
	#ªg_adc_büs
 
	`REG_ADDR8
(0xb37)

	)

1010 
	#ªg_aud_Æc_hpf_Õf_˘æ
 
	`REG_ADDR8
(0xb40)

	)

1012 
	mFLD_AUD_IN_HPF_SFT
 = 
BIT_RNG
(0,3),

1013 
	mFLD_AUD_IN_HPF_BYPASS
 = 
BIT
(4),

1014 
	mFLD_AUD_IN_ALC_BYPASS
 = 
BIT
(5),

1015 
	mFLD_AUD_IN_LPF_BYPASS
 = 
BIT
(6),

1016 
	mFLD_DOUBLE_DOWN_SAMPLING_ON
 = 
BIT
(7)

1021 
	#ªg_aud_Æc_vﬁ_l_chn
 
	`REG_ADDR8
(0xb41)

1022 
	#ªg_aud_Æc_vﬁ_r_chn
 
	`REG_ADDR8
(0xb42)

1023 íum{

	)

1024 
	mFLD_AUD_ALC_MIN_VOLUME_IN_DIGITAL_MODE
 = 
BIT_RNG
(0,5),

1025 
	mFLD_AUD_ALC_MIN_PGA_IN_ANALOG_MODE
 = 
BIT_RNG
(0,6),

1027 
	mFLD_AUD_ALC_DIGITAL_MODE_AUTO_REGULATE_EN
 = 
BIT
(7),

1031 
	#ªg_Æc_vﬁ_h
 
	`REG_ADDR8
(0xb43)

	)

1033 
	mFLD_AUD_ALC_MAX_VOLUME_IN_DIGITAL_MODE
 = 
BIT_RNG
(0,5),

1034 
	mFLD_AUD_ALC_MAX_PGA_IN_ANALOG_MODE
 = 
BIT_RNG
(0,6),

1038 
	#ªg_Æc_vﬁ_th_h
 
	`REG_ADDR16
(0xb44)

	)

1039 
	#ªg_Æc_vﬁ_th_l
 
	`REG_ADDR16
(0xb46)

	)

1040 
	#ªg_Æc_vﬁ_thn
 
	`REG_ADDR16
(0xb48)

	)

1041 
	#ªg_Æc_vad_thn
 
	`REG_ADDR16
(0xb4a)

	)

1043 
	#ªg_Æc_vﬁ_°ï
 
	`REG_ADDR8
(0xb4c)

	)

1045 
	#ªg_Æc_vﬁ_l
 
	`REG_ADDR8
(0xb4d)

	)

1046 
	#ªg_Æc_vﬁ_r
 
	`REG_ADDR8
(0xb4e)

	)

1048 
	#ªg_Æc_≥ak_tick
 
	`REG_ADDR16
(0xb50)

	)

1050 
	#ªg_Æc_dec_tick
 
	`REG_ADDR8
(0xb52)

	)

1051 
	#ªg_Æc_noi_tick
 
	`REG_ADDR8
(0xb53)

	)

1054 
	#ªg_aud_Æc_cfg
 
	`REG_ADDR8
(0xb54)

1055 íum{

	)

1056 
	mFLD_AUD_ALC_ANALOG_MODE_EN
 = 
BIT
(0),

1057 
	mFLD_AUD_ALC_NOISE_EN
 = 
BIT
(1),

1060 
	#ªg_Æc_c€f_iú
 
	`REG_ADDR8
(0xb55)

	)

1061 
	#ªg_Æc_d©_mask
 
	`REG_ADDR8
(0xb56)

	)

1062 
	#ªg_Æc_öc_•d
 
	`REG_ADDR8
(0xb57)

	)

1063 
	#ªg_Æc_öc_max
 
	`REG_ADDR8
(0xb58)

	)

1064 
	#ªg_Æc_dec_•d
 
	`REG_ADDR8
(0xb59)

	)

1065 
	#ªg_Æc_dec_max
 
	`REG_ADDR8
(0xb5a)

	)

1066 
	#ªg_Æc_noi_•d
 
	`REG_ADDR8
(0xb5b)

	)

1067 
	#ªg_Æc_noi_max
 
	`REG_ADDR8
(0xb5c)

	)

1069 
	#ªg_pga_gaö_öô
 
	`REG_ADDR8
(0xb5d)

	)

1070 
	#ªg_pga_gaö_l
 
	`REG_ADDR8
(0xb5e)

1071 
	#ªg_pga_gaö_r
 
	`REG_ADDR8
(0xb5f)

1072 
	#ªg_pga_m™_•ìd
 
	`REG_ADDR8
(0xb60)

	)

1074 
	#ªg_pga_m™_èrgë_l
 
	`REG_ADDR8
(0xb61)

	)

1075 
	#ªg_pga_vÆue_l
 
	`REG_ADDR8
(0xb62)

	)

1076 
	#ªg_pga_fix_vÆue
 
	`REG_ADDR8
(0xb63)

	)

1079 
	mFLD_PGA_POST_AMPLIFIER_GAIN
 = 
BIT_RNG
(0,5),

1080 
	mFLD_PGA_PRE_AMPLIFIER_GAIN
 = 
BIT
(6),

1081 
	mFLD_PGA_GAIN_FIX_EN
 = 
BIT
(7)

1084 
	#ªg_pga_r_l
 
	`REG_ADDR8
(0xb64)

	)

1085 
	#ªg_pga_m™_èrgë_r
 
	`REG_ADDR8
(0xb65)

	)

1086 
	#ªg_pga_vÆue_r
 
	`REG_ADDR8
(0xb66)

	)

1091 
	#ªg_dma0_addr
 
	`REG_ADDR16
(0xc00)

	)

1092 
	#ªg_dma0_size
 
	`REG_ADDR8
(0xc02)

	)

1093 
	#ªg_dma0_mode
 
	`REG_ADDR8
(0xc03)

	)

1095 
	mFLD_DMA_WR_MEM
 = 
BIT
(0),

1096 
	mFLD_DMA_PINGPONG_EN
 = 
BIT
(1),

1097 
	mFLD_DMA_FIFO_EN
 = 
BIT
(2),

1098 
	mFLD_DMA_AUTO_MODE
 = 
BIT
(3),

1099 
	mFLD_DMA_READ_MODE
 = 
BIT
(4),

1100 
	mFLD_DMA_BYTE_MODE
 = 
BIT
(5)

1105 
	#ªg_dma1_addr
 
	`REG_ADDR16
(0xc04)

	)

1106 
	#ªg_dma1_size
 
	`REG_ADDR8
(0xc06)

	)

1107 
	#ªg_dma1_mode
 
	`REG_ADDR8
(0xc07)

	)

1110 
	#ªg_dma2_addr
 
	`REG_ADDR16
(0xc08)

	)

1111 
	#ªg_dma2_size
 
	`REG_ADDR8
(0xc0a)

	)

1112 
	#ªg_dma2_mode
 
	`REG_ADDR8
(0xc0b)

	)

1115 
	#ªg_dma3_addr
 
	`REG_ADDR16
(0xc0c)

	)

1116 
	#ªg_dma3_size
 
	`REG_ADDR8
(0xc0e)

	)

1117 
	#ªg_dma3_mode
 
	`REG_ADDR8
(0xc0f)

	)

1119 
	#ªg_dma4_addr
 
	`REG_ADDR16
(0xc10)

	)

1120 
	#ªg_dma4_size
 
	`REG_ADDR8
(0xc12)

	)

1121 
	#ªg_dma4_mode
 
	`REG_ADDR8
(0xc13)

	)

1123 
	#ªg_dma5_addr
 
	`REG_ADDR16
(0xc14)

	)

1124 
	#ªg_dma5_size
 
	`REG_ADDR8
(0xc16)

	)

1125 
	#ªg_dma5_mode
 
	`REG_ADDR8
(0xc17)

	)

1128 
	#ªg_dma7_addr
 
	`REG_ADDR16
(0xc18)

	)

1129 
	#ªg_dma7_size
 
	`REG_ADDR8
(0xc1a)

	)

1130 
	#ªg_dma7_mode
 
	`REG_ADDR8
(0xc1b)

	)

1133 
	#ªg_dma_t_addr
 
	`REG_ADDR16
(0xc1c)

	)

1134 
	#ªg_dma_t_size
 
	`REG_ADDR8
(0xc1e)

	)

1136 
	#ªg_dma_size
(
v
Ë
	`REG_ADDR8
(0xc02+4*v)

	)

1139 
	#ªg_dma_u¨t_rx_addr
 
ªg_dma0_addr


	)

1140 
	#ªg_dma_u¨t_rx_size
 
ªg_dma0_size


	)

1141 
	#ªg_dma_u¨t_rx_mode
 
ªg_dma0_mode


	)

1143 
	#ªg_dma_u¨t_tx_addr
 
ªg_dma1_addr


	)

1144 
	#ªg_dma_u¨t_tx_size
 
ªg_dma1_size


	)

1145 
	#ªg_dma_u¨t_tx_mode
 
ªg_dma1_mode


	)

1147 
	#ªg_dma_rf_rx_addr
 
ªg_dma2_addr


	)

1148 
	#ªg_dma_rf_rx_size
 
ªg_dma2_size


	)

1149 
	#ªg_dma_rf_rx_mode
 
ªg_dma2_mode


	)

1151 
	#ªg_dma_rf_tx_addr
 
ªg_dma3_addr


	)

1152 
	#ªg_dma_rf_tx_size
 
ªg_dma3_size


	)

1153 
	#ªg_dma_rf_tx_mode
 
ªg_dma3_mode


	)

1155 
	#ªg_dma_pwm_addr
 
ªg_dma7_addr


	)

1156 
	#ªg_dma_pwm_size
 
ªg_dma7_size


	)

1157 
	#ªg_dma_pwm_mode
 
ªg_dma7_mode


	)

1161 
	#ªg_dma_chn_í
 
	`REG_ADDR8
(0xc20)

	)

1162 
	#ªg_dma_chn_úq_msk
 
	`REG_ADDR8
(0xc21)

	)

1163 
	#ªg_dma_tx_rdy0
 
	`REG_ADDR8
(0xc24)

	)

1164 
	#ªg_dma_tx_rdy1
 
	`REG_ADDR8
(0xc25)

	)

1165 
	#ªg_dma_rx_rdy0
 
	`REG_ADDR8
(0xc26)

	)

1166 
	#ªg_dma_rx_rdy1
 
	`REG_ADDR8
(0xc27)

	)

1168 
	#ªg_dma_úq_°©us
 
ªg_dma_rx_rdy0


	)

1171 
	mFLD_DMA_CHN0
 = 
BIT
(0), 
	mFLD_DMA_CHN_UART_RX
 = BIT(0),

1172 
	mFLD_DMA_CHN1
 = 
BIT
(1), 
	mFLD_DMA_CHN_UART_TX
 = BIT(1),

1173 
	mFLD_DMA_CHN2
 = 
BIT
(2), 
	mFLD_DMA_CHN_RF_RX
 = BIT(2),

1174 
	mFLD_DMA_CHN3
 = 
BIT
(3), 
	mFLD_DMA_CHN_RF_TX
 = BIT(3),

1175 
	mFLD_DMA_CHN4
 = 
BIT
(4), 
	mFLD_DMA_CHN_AES_OUT
 = BIT(4),

1176 
	mFLD_DMA_CHN5
 = 
BIT
(5), 
	mFLD_DMA_CHN_AES_IN
 = BIT(5),

1177 
	mFLD_DMA_CHN7
 = 
BIT
(7), 
	mFLD_DMA_CHN_PWM
 = BIT(7),

1181 
	mFLD_DMA_IRQ_UART_RX
 = 
BIT
(0),

1182 
	mFLD_DMA_IRQ_UART_TX
 = 
BIT
(1),

1183 
	mFLD_DMA_IRQ_RF_RX
 = 
BIT
(2),

1184 
	mFLD_DMA_IRQ_RF_TX
 = 
BIT
(3),

1185 
	mFLD_DMA_IRQ_AES_DECO
 = 
BIT
(4),

1186 
	mFLD_DMA_IRQ_AES_CODE
 = 
BIT
(5),

1187 
	mFLD_DMA_IRQ_PWM
 = 
BIT
(7),

1188 
	mFLD_DMA_IRQ_ALL
 = 0xff,

1189 } 
	tIRQ_DMAIrqTy≥Def
;

1192 
	#ªg_dma_rx_Ωå
 
	`REG_ADDR8
(0xc28)

	)

1193 
	#ªg_dma_rx_w±r
 
	`REG_ADDR8
(0xc29)

	)

1195 
	#ªg_dma_tx_Ωå
 
	`REG_ADDR8
(0xc2a)

	)

1196 
	#ªg_dma_tx_w±r
 
	`REG_ADDR8
(0xc2b)

	)

1197 
	#ªg_dma_tx_fifo
 
	`REG_ADDR16
(0xc2c)

	)

1199 
	mFLD_DMA_RPTR_CLR
 = 
BIT
(4),

1200 
	mFLD_DMA_RPTR_NEXT
 = 
BIT
(5),

1201 
	mFLD_DMA_RPTR_SET
 = 
BIT
(6),

1204 
	#ªg_dma0_addrHi
 
	`REG_ADDR8
(0xc40)

	)

1205 
	#ªg_dma1_addrHi
 
	`REG_ADDR8
(0xc41)

	)

1206 
	#ªg_dma2_addrHi
 
	`REG_ADDR8
(0xc42)

	)

1207 
	#ªg_dma3_addrHi
 
	`REG_ADDR8
(0xc43)

	)

1208 
	#ªg_dma4_addrHi
 
	`REG_ADDR8
(0xc44)

	)

1209 
	#ªg_dma5_addrHi
 
	`REG_ADDR8
(0xc45)

	)

1210 
	#ªg_dma_è_addrHi
 
	`REG_ADDR8
(0xc46)

	)

1211 
	#ªg_dma_a3_addrHi
 
	`REG_ADDR8
(0xc47)

	)

1212 
	#ªg_dma7_addrHi
 
	`REG_ADDR8
(0xc48)

	)

1216 
	#ªg_rf_Œ_˘æ_0
 
	`REG_ADDR8
(0xf02)

	)

1218 
	#ªg_rf_Œ_˘æ_1
 
	`REG_ADDR8
(0xf03)

	)

1220 
	mFLD_RF_FSM_TIMEOUT_EN
 = 
BIT
(0),

1221 
	mFLD_RF_RX_FIRST_TIMEOUT_EN
 = 
BIT
(1),

1222 
	mFLD_RF_RX_TIMEOUT_EN
 = 
BIT
(2),

1223 
	mFLD_RF_CRC_2_EN
 = 
BIT
(3),

1226 
	mFLD_RF_BRX_SN_INIT
 = 
BIT
(4),

1227 
	mFLD_RF_BRX_NESN_INIT
 = 
BIT
(5),

1228 
	mFLD_RF_BTX_SN_INIT
 = 
BIT
(6),

1229 
	mFLD_RF_BTX_NESN_INIT
 = 
BIT
(7),

1232 
	#FSM_TIMEOUT_ENABLE
 ( 
ªg_rf_Œ_˘æ_1
 |
FLD_RF_FSM_TIMEOUT_EN
 )

	)

1233 
	#FSM_TIMEOUT_DISABLE
 ( 
ªg_rf_Œ_˘æ_1
 &(~
FLD_RF_FSM_TIMEOUT_EN
Ë)

	)

1234 
	#FSM_RX_FIRST_TIMEOUT_ENABLE
 ( 
ªg_rf_Œ_˘æ_1
 |
FLD_RF_RX_FIRST_TIMEOUT_EN
 )

	)

1235 
	#FSM_RX_FIRST_TIMEOUT_DISABLE
 ( 
ªg_rf_Œ_˘æ_1
 &(~
FLD_RF_RX_FIRST_TIMEOUT_EN
Ë)

	)

1237 
	#ªg_rf_rx_timeout
 
	`REG_ADDR16
(0xf0a)

	)

1239 
	#ªg_rf_Œ_˘æ_2
 
	`REG_ADDR8
(0xf15)

	)

1241 
	#ªg_rf_Œ_˘æ_3
 
	`REG_ADDR8
(0xf16)

	)

1243 
	mFLD_RF_TX_EN_DLY_EN
 = 
BIT
(0),

1244 
	mFLD_RF_PLL_RST_EN
 = 
BIT
(1),

1245 
	mFLD_RF_CMD_SCHEDULE_EN
 = 
BIT
(2),

1246 
	mFLD_RF_R_TX_EN_DLY
 = 
BIT_RNG
(4,7),

1250 
	#ªg_rf_úq_mask
 
	`REG_ADDR16
(0xf1c)

	)

1251 
	#ªg_rf_úq_°©us
 
	`REG_ADDR16
(0xf20)

	)

1252 
	#ªg_rf_fsm_timeout
 
	`REG_ADDR32
(0xf2c)

	)

1254 
	#CLEAR_ALL_RFIRQ_STATUS
 ( 
ªg_rf_úq_°©us
 = 0xfff‡)

	)

1257 
	mFLD_RF_IRQ_RX
 = 
BIT
(0),

1258 
	mFLD_RF_IRQ_TX
 = 
BIT
(1),

1259 
	mFLD_RF_IRQ_RX_TIMEOUT
 = 
BIT
(2),

1260 
	mFLD_RF_IRQ_RX_CRC_2
 = 
BIT
(4),

1261 
	mFLD_RF_IRQ_CMD_DONE
 = 
BIT
(5),

1262 
	mFLD_RF_IRQ_FSM_TIMEOUT
 = 
BIT
(6),

1263 
	mFLD_RF_IRQ_RETRY_HIT
 = 
BIT
(7),

1264 
	mFLD_RF_IRQ_TX_DS
 = 
BIT
(8),

1265 
	mFLD_RF_IRQ_RX_DR
 = 
BIT
(9),

1266 
	mFLD_RF_IRQ_FIRST_TIMEOUT
 = 
BIT
(10),

1267 
	mFLD_RF_IRQ_INVALID_PID
 = 
BIT
(11),

1268 
	mFLD_RF_IRQ_STX_TIMEOUT
 = 
BIT
(12),

1269 
	mFLD_RF_IRQ_ALL
 = 0X1FFF,

1273 
	#REG_AURA_BASE
 0x1200

	)

1275 
	#ªg_mode_cfg_txrx_1
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x27)

	)

1279 
	mFLD_TX_PA_PWR_H
 = 
BIT_RNG
(0,4),

1280 
	mFLD_TX_MI_SEL
 = 
BIT
(5),

1281 
	mFLD_RX_MI_SEL
 = 
BIT
(6),

1296 
	#¨eg_06_∂l_bg
 0x06

	)

1298 
	mFLD_PLL_BG_POWER_DOWN
 = 
BIT
(4),

1301 
	#¨eg_0e_∑0_∑3_puŒ
 0x0E

	)

1302 
	#¨eg_0f_∑4_∑7_puŒ
 0x0F

	)

1303 
	#¨eg_10_pb0_pb3_puŒ
 0x10

	)

1304 
	#¨eg_11_pb4_pb7_puŒ
 0x11

	)

1305 
	#¨eg_12_pc0_pc3_puŒ
 0x12

	)

1306 
	#¨eg_13_pc4_pc7_puŒ
 0x13

	)

1307 
	#¨eg_14_pd0_pd3_puŒ
 0x14

	)

1308 
	#¨eg_15_pd4_pd7_puŒ
 0x15

	)

1311 
	#¨eg_˛k_£âög
 0x82

	)

1313 
	mFLD_DCCC_DOUBLER_POWER_DOWN
 = 
BIT
(3),

1314 
	mFLD_CLK_48M_TO_RX_EN
 = 
BIT
(4),

1315 
	mFLD_CLK_48M_TO_DIG_EN
 = 
BIT
(5),

1316 
	mFLD_CLK_24M_TO_SAR_EN
 = 
BIT
(6),

1317 
	mFLD_CLK_48M_TO_CAL_DIG_MAN_EN
 = 
BIT
(7),

1320 
	#¨eg_xo_£âög
 0x8a

	)

1322 
	mFLD_XO_CDAC_ANA
 = 
BIT_RNG
(0,5),

1323 
	mFLD_XO_MODE_ANA
 = 
BIT
(6),

1324 
	mFLD_XO_CAP_OFF_ANA
 = 
BIT
(7),

1327 #i‡
deföed
(
__˝lu•lus
)

	@platform/chip_8258/rf_drv.h

24 #i‚de‡
_RF_DRV_H_


25 
	#_RF_DRV_H_


	)

27 
	~"bô.h
"

28 
	~"b•.h
"

29 
	~"ªgi°î.h
"

30 
	~"Êash.h
"

31 
	~"™Æog.h
"

34 
	#RF_CHN_TABLE
 0x8000

	)

41 
	mRF_MODE_BLE_2M
 = 
BIT
(0),

42 
	mRF_MODE_BLE_1M
 = 
BIT
(1),

43 
	mRF_MODE_BLE_1M_NO_PN
 = 
BIT
(2),

44 
	mRF_MODE_ZIGBEE_250K
 = 
BIT
(3),

45 
	mRF_MODE_LR_S2_500K
 = 
BIT
(4),

46 
	mRF_MODE_LR_S8_125K
 = 
BIT
(5),

47 
	mRF_MODE_PRIVATE_250K
 = 
BIT
(6),

48 
	mRF_MODE_PRIVATE_500K
 = 
BIT
(7),

49 
	mRF_MODE_PRIVATE_1M
 = 
BIT
(8),

50 
	mRF_MODE_PRIVATE_2M
 = 
BIT
(9),

51 
	mRF_MODE_ANT
 = 
BIT
(10),

52 
	mRF_MODE_BLE_2M_NO_PN
 = 
BIT
(11),

53 } 
	tRF_ModeTy≥Def
;

60 
	mRF_MODE_TX
 = 0,

61 
	mRF_MODE_RX
 = 1,

62 
	mRF_MODE_AUTO
 = 2,

63 
	mRF_MODE_OFF
 = 3

64 } 
	tRF_SètusTy≥Def
;

71 
	mRF_POWER_P10p46dBm
 = 63,

72 
	mRF_POWER_P10p29dBm
 = 61,

73 
	mRF_POWER_P10p01dBm
 = 58,

74 
	mRF_POWER_P9p81dBm
 = 56,

75 
	mRF_POWER_P9p48dBm
 = 53,

76 
	mRF_POWER_P9p24dBm
 = 51,

77 
	mRF_POWER_P8p97dBm
 = 49,

78 
	mRF_POWER_P8p73dBm
 = 47,

79 
	mRF_POWER_P8p44dBm
 = 45,

80 
	mRF_POWER_P8p13dBm
 = 43,

81 
	mRF_POWER_P7p79dBm
 = 41,

82 
	mRF_POWER_P7p41dBm
 = 39,

83 
	mRF_POWER_P7p02dBm
 = 37,

84 
	mRF_POWER_P6p60dBm
 = 35,

85 
	mRF_POWER_P6p14dBm
 = 33,

86 
	mRF_POWER_P5p65dBm
 = 31,

87 
	mRF_POWER_P5p13dBm
 = 29,

88 
	mRF_POWER_P4p57dBm
 = 27,

89 
	mRF_POWER_P3p94dBm
 = 25,

90 
	mRF_POWER_P3p23dBm
 = 23,

92 
	mRF_POWER_P3p01dBm
 = 
BIT
(7) | 63,

93 
	mRF_POWER_P2p81dBm
 = 
BIT
(7) | 61,

94 
	mRF_POWER_P2p61dBm
 = 
BIT
(7) | 59,

95 
	mRF_POWER_P2p39dBm
 = 
BIT
(7) | 57,

96 
	mRF_POWER_P1p99dBm
 = 
BIT
(7) | 54,

97 
	mRF_POWER_P1p73dBm
 = 
BIT
(7) | 52,

98 
	mRF_POWER_P1p45dBm
 = 
BIT
(7) | 50,

99 
	mRF_POWER_P1p17dBm
 = 
BIT
(7) | 48,

100 
	mRF_POWER_P0p90dBm
 = 
BIT
(7) | 46,

101 
	mRF_POWER_P0p58dBm
 = 
BIT
(7) | 44,

102 
	mRF_POWER_P0p04dBm
 = 
BIT
(7) | 41,

103 
	mRF_POWER_N0p14dBm
 = 
BIT
(7) | 40,

104 
	mRF_POWER_N0p97dBm
 = 
BIT
(7) | 36,

105 
	mRF_POWER_N1p42dBm
 = 
BIT
(7) | 34,

106 
	mRF_POWER_N1p89dBm
 = 
BIT
(7) | 32,

107 
	mRF_POWER_N2p48dBm
 = 
BIT
(7) | 30,

108 
	mRF_POWER_N3p03dBm
 = 
BIT
(7) | 28,

109 
	mRF_POWER_N3p61dBm
 = 
BIT
(7) | 26,

110 
	mRF_POWER_N4p26dBm
 = 
BIT
(7) | 24,

111 
	mRF_POWER_N5p03dBm
 = 
BIT
(7) | 22,

112 
	mRF_POWER_N5p81dBm
 = 
BIT
(7) | 20,

113 
	mRF_POWER_N6p67dBm
 = 
BIT
(7) | 18,

114 
	mRF_POWER_N7p65dBm
 = 
BIT
(7) | 16,

115 
	mRF_POWER_N8p65dBm
 = 
BIT
(7) | 14,

116 
	mRF_POWER_N9p89dBm
 = 
BIT
(7) | 12,

117 
	mRF_POWER_N11p4dBm
 = 
BIT
(7) | 10,

118 
	mRF_POWER_N13p29dBm
 = 
BIT
(7) | 8,

119 
	mRF_POWER_N15p88dBm
 = 
BIT
(7) | 6,

120 
	mRF_POWER_N19p27dBm
 = 
BIT
(7) | 4,

121 
	mRF_POWER_N25p18dBm
 = 
BIT
(7) | 2,

123 
	mRF_POWER_N30dBm
 = 0xff,

124 
	mRF_POWER_N50dBm
 = 
BIT
(7) | 0,

126 } 
	tRF_PowîTy≥Def
;

128 c⁄° 
RF_PowîTy≥Def
 
rf_powî_Levñ_li°
[60];

134 
	mRF_POWER_INDEX_P10p46dBm
,

135 
	mRF_POWER_INDEX_P10p29dBm
,

136 
	mRF_POWER_INDEX_P10p01dBm
,

137 
	mRF_POWER_INDEX_P9p81dBm
,

138 
	mRF_POWER_INDEX_P9p48dBm
,

139 
	mRF_POWER_INDEX_P9p24dBm
,

140 
	mRF_POWER_INDEX_P8p97dBm
,

141 
	mRF_POWER_INDEX_P8p73dBm
,

142 
	mRF_POWER_INDEX_P8p44dBm
,

143 
	mRF_POWER_INDEX_P8p13dBm
,

144 
	mRF_POWER_INDEX_P7p79dBm
,

145 
	mRF_POWER_INDEX_P7p41dBm
,

146 
	mRF_POWER_INDEX_P7p02dBm
,

147 
	mRF_POWER_INDEX_P6p60dBm
,

148 
	mRF_POWER_INDEX_P6p14dBm
,

149 
	mRF_POWER_INDEX_P5p65dBm
,

150 
	mRF_POWER_INDEX_P5p13dBm
,

151 
	mRF_POWER_INDEX_P4p57dBm
,

152 
	mRF_POWER_INDEX_P3p94dBm
,

153 
	mRF_POWER_INDEX_P3p23dBm
,

155 
	mRF_POWER_INDEX_P3p01dBm
,

156 
	mRF_POWER_INDEX_P2p81dBm
,

157 
	mRF_POWER_INDEX_P2p61dBm
,

158 
	mRF_POWER_INDEX_P2p39dBm
,

159 
	mRF_POWER_INDEX_P1p99dBm
,

160 
	mRF_POWER_INDEX_P1p73dBm
,

161 
	mRF_POWER_INDEX_P1p45dBm
,

162 
	mRF_POWER_INDEX_P1p17dBm
,

163 
	mRF_POWER_INDEX_P0p90dBm
,

164 
	mRF_POWER_INDEX_P0p58dBm
,

165 
	mRF_POWER_INDEX_P0p04dBm
,

166 
	mRF_POWER_INDEX_N0p14dBm
,

167 
	mRF_POWER_INDEX_N0p97dBm
,

168 
	mRF_POWER_INDEX_N1p42dBm
,

169 
	mRF_POWER_INDEX_N1p89dBm
,

170 
	mRF_POWER_INDEX_N2p48dBm
,

171 
	mRF_POWER_INDEX_N3p03dBm
,

172 
	mRF_POWER_INDEX_N3p61dBm
,

173 
	mRF_POWER_INDEX_N4p26dBm
,

174 
	mRF_POWER_INDEX_N5p03dBm
,

175 
	mRF_POWER_INDEX_N5p81dBm
,

176 
	mRF_POWER_INDEX_N6p67dBm
,

177 
	mRF_POWER_INDEX_N7p65dBm
,

178 
	mRF_POWER_INDEX_N8p65dBm
,

179 
	mRF_POWER_INDEX_N9p89dBm
,

180 
	mRF_POWER_INDEX_N11p4dBm
,

181 
	mRF_POWER_INDEX_N13p29dBm
,

182 
	mRF_POWER_INDEX_N15p88dBm
,

183 
	mRF_POWER_INDEX_N19p27dBm
,

184 
	mRF_POWER_INDEX_N25p18dBm
,

185 } 
	tRF_PowîIndexTy≥Def
;

188 
	#RF_TRX_MODE
 0xe0

	)

189 
	#RF_TRX_OFF
 0x45

	)

191 
	#RF_PACKET_LENGTH_OK
(
p
Ë’[0] =p[12]+13)

	)

192 
	#RF_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x10)

	)

194 
	#RF_BLE_PACKET_LENGTH_OK
(
p
Ë’[0] =’[5]&0x3f)+13)

	)

195 
	#RF_BLE_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x01Ë=0)

	)

197 
	#RF_ZIGBEE_PACKET_LENGTH_OK
(
p
Ë’[0] =p[4]+9)

	)

198 
	#RF_ZIGBEE_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x10)

	)

199 
	#RF_ZIGBEE_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

200 
	#RF_ZIGBEE_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

201 
	#RF_ZIGBEE_PACKET_PAYLOAD_LENGTH_GET
(
p
Ë’[4])

	)

203 
	#RF_NRF_ESB_PACKET_LENGTH_OK
(
p
Ë’[0] =’[4] & 0x3fË+ 11)

	)

204 
	#RF_NRF_ESB_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x01Ë=0x00)

	)

205 
	#RF_NRF_ESB_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

206 
	#RF_NRF_SB_PACKET_PAYLOAD_LENGTH_GET
(
p
Ë’[0] - 10)

	)

207 
	#RF_NRF_SB_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x01Ë=0x00)

	)

208 
	#RF_NRF_SB_PACKET_CRC_GET
(
p
) ((p[p[0]-8]<<8) +Ö[p[0]-7])

209 
	#RF_NRF_SB_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

210 
	#RF_NRF_ESB_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

211 
	#RF_NRF_SB_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

222 
ölöe
 
	$ª£t_ba£b™d
()

224 
	`REG_ADDR8
(0x61Ë
	`BIT
(0);

225 
	`REG_ADDR8
(0x61) = 0;

226 
	}
}

233 
ölöe
 
	$ª£t_¢_√¢
()

235 
	`REG_ADDR8
(0xf01) = 0x01;

236 
	}
}

243 
ölöe
 
	$rf_ª£t_¢
()

245 
	`wrôe_ªg8
(0xf01, 0x3f);

246 
	`wrôe_ªg8
(0xf01, 0x00);

247 
	}
}

254 
ölöe
 
	$rf_£t_tx_rx_off
()

256 
	`wrôe_ªg8
(0xf16, 0x29);

257 
	`wrôe_ªg8
(0x428, 
RF_TRX_MODE
);

258 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
);

259 
	}
}

266 
ölöe
 
	$rf_£t_tx_rx_off_auto_mode
()

268 
	`wrôe_ªg8
(0xf00, 0x80);

269 
	}
}

276 
ölöe
 
	$rf_£t_txmode
()

278 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
 | 
	`BIT
(4));

279 
	}
}

286 
ölöe
 
	$rf_£t_rxmode
()

288 
	`wrôe_ªg8
(0x428, 
RF_TRX_MODE
 | 
	`BIT
(0));

289 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
 | 
	`BIT
(5));

290 
	}
}

298 
ölöe
 
	$rf_rx_buf„r_ªc⁄fig
(*
RF_RxAddr
)

300 
ªg_dma2_addr
 = ()(()
RF_RxAddr
);

301 
	}
}

308 
ölöe
 sig√d 
	$rf_rssi_gë_154
()

310  (((sig√d )(
	`ªad_ªg8
(0x441))) - 110);

311 
	}
}

318 
ölöe
 
	$rf_tx_föish
()

320  ((
	`ªad_ªg8
(0xf20Ë& 
	`BIT
(1)) == 0x02);

321 
	}
}

332 
ölöe
 
	$rf_tx_föish_˛ór_Êag
()

334 
	`wrôe_ªg8
(0xf20, 0x02);

335 
	}
}

342 
ölöe
 
	$rf_rx_föish
()

344  ((
	`ªad_ªg8
(0xf20Ë& 
	`BIT
(0)) == 0x01);

345 
	}
}

356 
ölöe
 
	$rf_rx_föish_˛ór_Êag
()

358 
	`wrôe_ªg8
(0xf20, 0x01);

359 
	}
}

366 
ölöe
 
	$rf_drv_ˇp
(
addr
)

368 
ˇp
 = 0xff;

369 
	`Êash_ªad_∑ge
(
addr
, 1, &
ˇp
);

370 if(
ˇp
 != 0xff){

371 
ˇp
 &= 0x3f;

372 
	`™Æog_wrôe
(0x8a, (
	`™Æog_ªad
(0x8aË& 0xc0Ë| 
ˇp
);

374 
	}
}

381 
ölöe
 
	$tx_£âÀ_adju°
(
tx°l_us
)

383 
	`REG_ADDR16
(0xf04Ë
tx°l_us
;

384 
	}
}

391 
ölöe
 
	$rf_£t_tx_pùe
(
pùe
)

393 
	`wrôe_ªg8
(0xf15, 0xf0 | 
pùe
);

394 
	}
}

402 
rf_drv_öô
(
RF_ModeTy≥Def
 
rf_mode
);

409 
rf_£t_powî_Àvñ
(
RF_PowîTy≥Def
 
Àvñ
);

416 
rf_£t_powî_Àvñ_ödex
(
RF_PowîIndexTy≥Def
 
Àvñ
);

424 
rf_£t_ch™√l
(sig√d 
chn
, 
£t
);

432 
rf_åx_°©e_£t
(
RF_SètusTy≥Def
 
rf_°©us
, sig√d 
rf_ch™√l
);

439 
RF_SètusTy≥Def
 
rf_åx_°©e_gë
();

447 
rf_°¨t_°x
(*
addr
, 
tick
);

454 
rf_°¨t_§x
(
tick
);

461 
rf_tx_pkt
(*
rf_txaddr
);

480 
rf_rx_buf„r_£t
(*
RF_RxAddr
, 
size
, 
Pögp⁄gEn
);

488 
rf_rx_cfg
(
size
, 
Pögp⁄gEn
);

494 
rf_≤_dißbÀ
();

	@platform/chip_8258/spi.h

24 #i‚de‡
SPI_H


25 
	#SPI_H


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

38 
	mSPI_GPIO_GROUP_A2A3A4D6
=0,

39 
	mSPI_GPIO_GROUP_B6B7D2D7
,

40 }
	tSPI_GPIO_GroupTy≥Def
;

47 
	mSPI_MODE0
 = 0,

48 
	mSPI_MODE2
,

49 
	mSPI_MODE1
,

50 
	mSPI_MODE3
,

51 } 
	tSPI_ModeTy≥Def
;

57 
	mSPI_CLK_200K
 = 0x3c,

58 
	mSPI_CLK_250K
 = 0x2e,

59 
	mSPI_CLK_500K
 = 0x17,

60 
	mSPI_CLK_1M
 = 0x0b,

61 
	mSPI_CLK_2M
 = 0x05,

62 
	mSPI_CLK_4M
 = 0x02,

63 } 
	tSPI_24M_ClkTy≥Def
;

71 
ölöe
 
	$ª£t_•i_moudÀ
()

73 
ªg_r°0
 |
FLD_RST0_SPI
;

74 
ªg_r°0
 &(~
FLD_RST0_SPI
);

75 
	}
}

92 
•i_ma°î_gpio_£t
(
SPI_GPIO_GroupTy≥Def
 
PöGΩ
);

111 
•i_¶ave_gpio_£t
(
SPI_GPIO_GroupTy≥Def
 
PöGΩ
);

119 
•i_ma°îCSpö_£À˘
(
GPIO_PöTy≥Def
 
CSPö
);

135 
•i_ma°î_öô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

143 
•i_¶ave_öô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

155 
•i_wrôe
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

168 
•i_ªad
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

175 
•i_£t_sh¨e_mode_í
();

	@platform/chip_8258/spi_i.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"compûî.h
"

34 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_waô
(){

35 
ªg_m•i_˘æ
 & 
FLD_MSPI_BUSY
)

37 
	}
}

44 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_high
(){

45 
ªg_m•i_˘æ
 = 
FLD_MSPI_CS
;

46 
	}
}

53 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_low
(){

54 
ªg_m•i_˘æ
 = 0;

55 
	}
}

62 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_gë
(){

63  
ªg_m•i_d©a
;

64 
	}
}

71 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_wrôe
(
c
){

72 
ªg_m•i_d©a
 = 
c
;

73 
	}
}

80 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_˘æ_wrôe
(
c
){

81 
ªg_m•i_˘æ
 = 
c
;

82 
	}
}

89 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_ªad
(){

90 
	`m•i_wrôe
(0);

91 
	`m•i_waô
();

92  
	`m•i_gë
();

93 
	}
}

	@platform/chip_8258/timer.h

24 #i‚de‡
TIMER_H_


25 
	#TIMER_H_


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

34 
	mTIMER0
 =0,

35 
	mTIMER1
 =1,

36 
	mTIMER2
 =2,

37 }
	tTIMER_Ty≥Def
;

43 
	mTIMER_MODE_SYSCLK
 =0,

44 
	mTIMER_MODE_GPIO_TRIGGER
 =1,

45 
	mTIMER_MODE_GPIO_WIDTH
 =2,

46 
	mTIMER_MODE_TICK
 =3,

47 }
	tTIMER_ModeTy≥Def
;

49 
	#sys_tick_≥r_us
 16

	)

50 
	#CLOCK_SYS_CLOCK_1250US
 (1250 * 
sys_tick_≥r_us
)

	)

56 
	mCLOCK_16M_SYS_TIMER_CLK_1S
 = 16*1000*1000,

57 
	mCLOCK_16M_SYS_TIMER_CLK_1MS
 = 16*1000,

58 
	mCLOCK_16M_SYS_TIMER_CLK_1US
 = 16,

66 
ölöe
 
	$˛ock_time
()

68  
ªg_sy°em_tick
;

69 
	}
}

77 
ölöe
 
	$˛ock_time_ex˚ed
(
ªf
, 
us
)

79  (()(
	`˛ock_time
(Ë- 
ªf
Ë> 
us
 * 16);

80 
	}
}

88 
ölöe
 
	$timî_£t_öô_tick
(
TIMER_Ty≥Def
 
ty≥
, 
öô_tick
)

90 
	`ªg_tmr_tick
(
ty≥
Ë
öô_tick
;

91 
	}
}

99 
ölöe
 
	$timî_£t_ˇp_tick
(
TIMER_Ty≥Def
 
ty≥
, 
ˇp_tick
)

101 
	`ªg_tmr_ˇ±
(
ty≥
Ë
ˇp_tick
;

102 
	}
}

109 
ölöe
 
	$timî_úq_íabÀ
(
TIMER_Ty≥Def
 
ty≥
)

111 
ªg_úq_mask
 |(1 << 
ty≥
);

112 
	}
}

119 
ölöe
 
	$°imî_úq_íabÀ
()

121 
ªg_sy°em_tick_mode
 |
FLD_SYSTEM_TICK_IRQ_EN
;

122 
	}
}

129 
ölöe
 
	$°imî_£t_úq_ˇ±uª
(
ˇp_tick
)

131 
ªg_sy°em_tick_úq
 = 
ˇp_tick
;

132 
	}
}

139 
ölöe
 
	$°imî_£t_úq_mask
()

141 
ªg_úq_mask
 |
FLD_IRQ_SYSTEM_TIMER
;

142 
	}
}

149 
ölöe
 
	$°imî_˛r_úq_mask
()

151 
ªg_úq_mask
 &~()
FLD_IRQ_SYSTEM_TIMER
;

152 
	}
}

160 
timî_£t_mode
(
TIMER_Ty≥Def
 
ty≥
, 
TIMER_ModeTy≥Def
 
mode
);

169 
timî_gpio_öô
(
TIMER_Ty≥Def
 
ty≥
, 
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
pﬁ
);

176 
timî_°¨t
(
TIMER_Ty≥Def
 
ty≥
);

183 
timî_°›
(
TIMER_Ty≥Def
 
ty≥
);

190 
¶ìp_us
(
us
);

192 
	#ClockTime
 
˛ock_time


	)

193 
	#WaôUs
 
¶ìp_us


	)

194 
	#WaôMs
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

195 
	#¶ìp_ms
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

	@platform/chip_8258/uart.h

24 #i‚de‡
UART_H


25 
	#UART_H


	)

27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

29 
	~"gpio.h
"

36 
	mUART_BW_MUL1
 = 0,

37 
	mUART_BW_MUL2
 = 1,

38 
	mUART_BW_MUL3
 = 2,

39 
	mUART_BW_MUL4
 = 3,

46 
	mPARITY_NONE
 = 0,

47 
	mPARITY_EVEN
,

48 
	mPARITY_ODD
,

49 } 
	tUART_P¨ôyTy≥Def
;

55 
	mSTOP_BIT_ONE
 = 0,

56 
	mSTOP_BIT_ONE_DOT_FIVE
 = 
BIT
(4),

57 
	mSTOP_BIT_TWO
 = 
BIT
(5),

58 } 
	tUART_St›BôTy≥Def
;

64 
	mUART_RTS_MODE_AUTO
 = 0,

65 
	mUART_RTS_MODE_MANUAL
,

66 } 
	tUART_RTSModeTy≥Def
;

73 
	mUART_TX_PA2
 = 
GPIO_PA2
,

74 
	mUART_TX_PB1
 = 
GPIO_PB1
,

75 
	mUART_TX_PC2
 = 
GPIO_PC2
,

76 
	mUART_TX_PD0
 = 
GPIO_PD0
,

77 
	mUART_TX_PD3
 = 
GPIO_PD3
,

78 
	mUART_TX_PD7
 = 
GPIO_PD7
,

79 }
	tUART_TxPöDef
;

85 
	mUART_RX_PA0
 = 
GPIO_PA0
,

86 
	mUART_RX_PB0
 = 
GPIO_PB0
,

87 
	mUART_RX_PB7
 = 
GPIO_PB7
,

88 
	mUART_RX_PC3
 = 
GPIO_PC3
,

89 
	mUART_RX_PC5
 = 
GPIO_PC5
,

90 
	mUART_RX_PD6
 = 
GPIO_PD6
,

91 }
	tUART_RxPöDef
;

97 
	mUART_CTS_PA3
 = 
GPIO_PA3
,

98 
	mUART_CTS_PB2
 = 
GPIO_PB2
,

99 
	mUART_CTS_PC4
 = 
GPIO_PC4
,

100 
	mUART_CTS_PD1
 = 
GPIO_PD1
,

101 }
	tUART_CtsPöDef
;

107 
	mUART_RTS_PA4
 = 
GPIO_PA4
,

108 
	mUART_RTS_PB3
 = 
GPIO_PB3
,

109 
	mUART_RTS_PB6
 = 
GPIO_PB6
,

110 
	mUART_RTS_PC0
 = 
GPIO_PC0
,

111 }
	tUART_RtsPöDef
;

114 
u¨t_TxIndex
;

122 
ölöe
 
	$u¨t_tx_is_busy
()

124  ( (
ªg_u¨t_°©us1
 & 
FLD_UART_TX_DONE
) ? 0 : 1) ;

125 
	}
}

133 
ölöe
 
	$u¨t_ndma_˛ór_tx_ödex
()

135 
u¨t_TxIndex
=0;

136 
	}
}

143 
ölöe
 
	$u¨t_ª£t
()

145 
ªg_r°0
 |
FLD_RST0_UART
;

146 
ªg_r°0
 &(~
FLD_RST0_UART
);

147 
	}
}

177 
u¨t_öô
(
g_u¨t_div
, 
g_bwpc
, 
UART_P¨ôyTy≥Def
 
P¨ôy
, 
UART_St›BôTy≥Def
 
St›Bô
);

187 
u¨t_öô_baudøã
(
Baudøã
,
Sy°em_˛ock
 , 
UART_P¨ôyTy≥Def
 
P¨ôy
, 
UART_St›BôTy≥Def
 
St›Bô
);

194 
u¨t_dma_íabÀ
(
rx_dma_í
, 
tx_dma_í
);

202 
u¨t_úq_íabÀ
(
rx_úq_í
, 
tx_úq_í
);

210 
u¨t_ndma_£nd_byã
(
u¨tD©a
);

222 
u¨t_ndma_úq_åigÀvñ
(
rx_Àvñ
, 
tx_Àvñ
);

230 
u¨t_ndmaúq_gë
();

239 
u¨t_dma_£nd
(* 
Addr
);

248 
u¨t_£nd_byã
(
byã
);

256 
u¨t_ªcbuff_öô
(*
RecvAddr
, 
RecvBufLí
);

264 
u¨t_is_∑rôy_îr‹
();

278 
u¨t_˛ór_∑rôy_îr‹
();

290 
u¨t_£t_πs
(
E«bÀ
, 
UART_RTSModeTy≥Def
 
Mode
, 
Thªsh
, 
Invît
, 
UART_RtsPöDef
 
pö
);

297 
u¨t_£t_πs_Àvñ
(
Pﬁ¨ôy
);

306 
u¨t_£t_˘s
(
E«bÀ
, 
Sñe˘
, 
UART_CtsPöDef
 
pö
);

314 
u¨t_gpio_£t
(
UART_TxPöDef
 
tx_pö
, 
UART_RxPöDef
 
rx_pö
);

321 
u¨t_mask_îr‹_úq_íabÀ
();

	@platform/chip_8258/usbhw.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"™Æog.h
"

28 
	~"usbhw_i.h
"

29 
	~"gpio.h
"

32 
	mUSB_EDP_PRINTER_IN
 = 8,

33 
	mUSB_EDP_MOUSE
 = 2,

34 
	mUSB_EDP_KEYBOARD_IN
 = 1,

35 
	mUSB_EDP_KEYBOARD_OUT
 = 3,

36 
	mUSB_EDP_AUDIO_IN
 = 4,

37 
	mUSB_EDP_PRINTER_OUT
 = 5,

38 
	mUSB_EDP_SPEAKER
 = 6,

39 
	mUSB_EDP_MIC
 = 7,

40 #if(
USB_GAMEPAD_ENABLE
)

41 
	mUSB_EDP_GAMEPAD_IN
 = 3,

42 
	mUSB_EDP_GAMEPAD_OUT
 = 5,

44 
	mUSB_EDP_MS_IN
 = 
USB_EDP_PRINTER_IN
,

45 
	mUSB_EDP_MS_OUT
 = 
USB_EDP_PRINTER_OUT
,

46 
	mUSB_EDP_SOMATIC_IN
 = 
USB_EDP_AUDIO_IN
,

47 
	mUSB_EDP_SOMATIC_OUT
 = 
USB_EDP_PRINTER_OUT
,

48 
	mUSB_EDP_CDC_IN
 = 4,

49 
	mUSB_EDP_CDC_OUT
 = 5,

54 
	mUSB_HID_AUDIO
 = 2,

55 
	mUSB_HID_MOUSE
 = 1,

56 
	mUSB_HID_KB_MEDIA
 = 3,

57 
	mUSB_HID_KB_SYS
 = 4,

58 #if(
USB_GAMEPAD_ENABLE
)

59 
	mUSB_HID_GAMEPAD
 = 5,

61 
	mUSB_HID_SOMATIC
 = 5,

70 
ölöe
 
	$usb_dp_puŒup_í
(
í
)

72 
d©
 = 
	`™Æog_ªad
(0x0b);

73 if(
í
){

74 
d©
 = d© | 
	`BIT
(7);

76 
d©
 = dat & 0x7f ;

79 
	`™Æog_wrôe
(0x0b, 
d©
);

80 
	}
}

87 
ölöe
 
	$usb_powî_⁄
(
í
)

89 if(
í
){

90 
	`™Æog_wrôe
(0x34, 
	`™Æog_ªad
(0x34) & 0xfd);

92 
	`™Æog_wrôe
(0x34, 
	`™Æog_ªad
(0x34) | 0x02);

94 
	}
}

101 
ölöe
 
	$usb_£t_pö_í
()

104 
	`gpio_£t_func
(
GPIO_PA6
, 
AS_GPIO
);

105 
	`gpio_£t_ouçut_í
(
GPIO_PA6
, 1);

106 
	`gpio_wrôe
(
GPIO_PA6
, 0);

108 
	`gpio_£t_func
(
GPIO_PA5
, 
AS_USB
);

109 
	`gpio_£t_func
(
GPIO_PA6
, 
AS_USB
);

110 
	`usb_dp_puŒup_í
(1);

111 
	}
}

119 
usbhw_dißbÀ_m™uÆ_öãºu±
(
m
);

126 
usbhw_íabÀ_m™uÆ_öãºu±
(
m
);

135 
usbhw_wrôe_ï
(
ï
, * 
d©a
, 
Àn
);

143 
usbhw_wrôe_˘æ_ï_u16
(
v
);

150 
usbhw_ªad_˘æ_ï_u16
();

	@platform/chip_8258/usbhw_i.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

33 
ölöe
 
	$usbhw_ª£t_˘æ_ï_±r
() {

34 
ªg_˘æ_ï_±r
 = 0;

35 
	}
}

42 
ölöe
 
	$usbhw_gë_˘æ_ï_úq
() {

43  
ªg_˘æ_ï_úq_°a
;

44 
	}
}

51 
ölöe
 
	$usbhw_˛r_˘æ_ï_úq
(
ï
) {

52 
ªg_˘æ_ï_úq_°a
 = 
ï
;

53 
	}
}

60 
ölöe
 
	$usbhw_wrôe_˘æ_ï_˘æ
(
d©a
) {

61 
ªg_˘æ_ï_˘æ
 = 
d©a
;

62 
	}
}

69 
ölöe
 
	$usbhw_ªad_˘æ_ï_d©a
() {

70  
ªg_˘æ_ï_d©
;

71 
	}
}

78 
ölöe
 
	$usbhw_wrôe_˘æ_ï_d©a
(
d©a
) {

79 
ªg_˘æ_ï_d©
 = 
d©a
;

80 
	}
}

87 
ölöe
 
	$usbhw_is_˘æ_ï_busy
() {

88  
ªg_˘æ_ï_úq_°a
 & 
FLD_USB_EP_BUSY
;

89 
	}
}

96 
ölöe
 
	$usbhw_ª£t_ï_±r
(
ï
) {

97 
	`ªg_usb_ï_±r
(
ï
 & 0x07) = 0;

98 
	}
}

104 
ölöe
 
	$usbhw_£t_ïs_úq_mask
(
mask
){

105 
ªg_usb_mask
|=
mask
;

106 
	}
}

112 
ölöe
 
	$usbhw_˛r_ïs_úq_mask
(
mask
){

113 
ªg_usb_mask
 &=(~
mask
);

114 
	}
}

121 
ölöe
 
	$usbhw_gë_ïs_úq
() {

122  
ªg_usb_úq
;

123 
	}
}

130 
ölöe
 
	$usbhw_˛r_ïs_úq
(
ï
) {

131 
ªg_usb_úq
 = 
ï
;

132 
	}
}

139 
ölöe
 
	$usbhw_ªad_ï_d©a
(
ï
) {

140  
	`ªg_usb_ï_d©
(
ï
 & 0x07);

141 
	}
}

148 
ölöe
 
	$usbhw_wrôe_ï_d©a
(
ï
, 
d©a
) {

149 
	`ªg_usb_ï_d©
(
ï
 & 0x07Ë
d©a
;

150 
	}
}

157 
ölöe
 
	$usbhw_is_ï_busy
(
ï
) {

158  
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë& 
FLD_USB_EP_BUSY
;

159 
	}
}

166 
ölöe
 
	$usbhw_d©a_ï_ack
(
ï
) {

167 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_BUSY
;

168 
	}
}

175 
ölöe
 
	$usbhw_d©a_ï_°Æl
(
ï
) {

176 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_STALL
;

177 
	}
}

184 
ölöe
 
	$usbhw_£t_¥öãr_thªshﬁd
(
th
) {

185 
ªg_usb_ï8_£nd_thª
 = 
th
;

186 
	}
}

192 
ölöe
 
	$usbhw_£t_ï8_fifo_mode
() {

193 
ªg_usb_ï8_fifo_mode
 |
FLD_USB_ENP8_FIFO_MODE
;

194 
	}
}

	@platform/chip_8258/watchdog.h

24 #¥agm®
⁄˚


27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

36 
ölöe
 
	$wd_£t_öãrvÆ_ms
(
≥riod_ms
)

38 
tmp_≥riod_ms
 = 0;

39 
tmp_≥riod_ms
 = (
≥riod_ms
*1000*
sy°em_˛k_mHz
>>18);

40 
ªg_tmr2_tick
 = 0x00000000;

41 
ªg_tmr_˘æ
 &(~
FLD_TMR_WD_CAPT
);

42 
ªg_tmr_˘æ
 |(
tmp_≥riod_ms
<<9);

43 
	}
}

50 
ölöe
 
	$wd_°¨t
(){

51 
	`BM_SET
(
ªg_tmr_˘æ
, 
FLD_TMR2_EN
);

52 
	`BM_SET
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

53 
	}
}

59 
ölöe
 
	$wd_°›
(){

60 
	`BM_CLR
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

61 
	}
}

68 
ölöe
 
	$wd_˛ór
()

70 
ªg_tmr_°a
 = 
FLD_TMR_STA_WD
;

71 
	}
}

	@platform/chip_826x/adc.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

31 
	~"bô.h
"

32 
	~"b•.h
"

35 
	#INTER_RESIS_ONE_THIRD_EN
 1

	)

38 
B©ãry_Chn_VCC
,

39 
B©ãry_Chn_B7
,

40 }
	tBATT_ChnTy≥Def
;

46 
RV_1P428
,

47 
RV_AVDD
,

48 
RV_1P224
,

49 }
	tADC_RefVﬁTy≥Def
;

55 
RES7
,

56 
RES9
,

57 
RES10
,

58 
RES11
,

59 
RES12
,

60 
RES13
,

61 
RES14
,

62 }
	tADC_ResTy≥Def
;

68 
S_3
,

69 
S_6
,

70 
S_9
,

71 
S_12
,

72 
S_18
,

73 
S_24
,

74 
S_48
,

75 
S_144
,

76 }
	tADC_SampCycTy≥Def
;

82 
NOINPUT
,

83 
C0
,

84 
C1
,

85 
C6
,

86 
C7
,

87 
B0
,

88 
B1
,

89 
B2
,

90 
B3
,

91 
B4
,

92 
B5
,

93 
B6
,

94 
B7
,

95 
PGAVOM
,

96 
PGAVOP
,

97 
TEMSENSORN
,

98 
TEMSENSORP
,

99 
AVSS
,

100 
OTVDD
,

101 }
	tADC_I≈utPTy≥Def
;

106 
SINGLEEND
,

107 
INVERTB_1
,

108 
INVERTB_3
,

109 
PGAVOPM
,

110 }
	tADC_I≈utMTy≥Def
;

115 
	#REG_ADC_CLK_STEP
 
	`READ_REG8
(0x69)

	)

117 
ADC_STEP_L
 = 
BIT_RNG
(0,7),

118 
ADC_CLK_STEP
 = 
BIT_RNG
(0,7),

120 
	#REG_ADC_CLK_MODE
 
	`READ_REG8
(0x6a)

	)

122 
ADC_MODE_L
 = 
BIT_RNG
(0,7),

123 
ADC_CLK_MODE
 = 
BIT_RNG
(0,7),

128 
	#ADC_STEP_MODE
 
	`READ_REG8
(0x6b)

	)

130 
ADC_CLK_EN
 = 
BIT
(7),

131 
ADC_STEP_H
 = 
BIT_RNG
(4,6),

132 
ADC_MODE_H
 = 
BIT_RNG
(0,3),

134 
	#EN_ADCCLK
 
ADC_STEP_MODE
 |(
ADC_CLK_EN
)

	)

135 
	#DIS_ADCCLK
 
ADC_STEP_MODE
 &(~
ADC_CLK_EN
)

	)

137 
	#SET_ADC_STEP
(
v
Ëdo{\

	)

138 
REG_ADC_CLK_STEP
 = ()(
v
);\

139 
ADC_STEP_MODE
 &(~
ADC_STEP_H
);\

140 
ADC_STEP_MODE
 |(((()((
v
)>>8))&0x07)<<4);\

143 
	#SET_ADC_MODE
(
v
Ëdo{\

	)

144 
REG_ADC_CLK_MODE
 = ()(
v
);\

145 
ADC_STEP_MODE
 &(~
ADC_MODE_H
);\

146 
ADC_STEP_MODE
 |((()((
v
)>>8))&0x0F);\

152 
	#ADC_REF_VOL
 
	`READ_REG8
(0x2b)

	)

154 
ADC_MISC_REF_V
 = 
BIT_RNG
(0,1),

155 
ADC_LEFT_REF_V
 = 
BIT_RNG
(2,3),

157 
	#SET_MISC_REF_VOL
(
v
Ëdo{\

	)

158 
ADC_REF_VOL
 &(~
ADC_MISC_REF_V
);\

159 
ADC_REF_VOL
 |()((
v
)&0x03);\

162 
	#SET_LEFT_REF_VOL
(
v
Ëdo{\

	)

163 
ADC_REF_VOL
 &(~
ADC_LEFT_REF_V
);\

164 
ADC_REF_VOL
 |((()((
v
)&0x03))<<2);\

169 
	#REG_ADC_MISC_INPUT
 
	`READ_REG8
(0x2c)

	)

171 
MISC_INPUT_P
 = 
BIT_RNG
(0,4),

172 
MISC_INPUT_M
 = 
BIT_RNG
(5,6),

173 
MISC_DATA_FORMAT

BIT
(7),

179 
	#REG_ADC_LEFT_INPUT
 
	`READ_REG8
(0x2d)

	)

181 
ADC_LEFT_INPUT_P
 = 
BIT_RNG
(0,4),

182 
ADC_LEFT_INPUT_M
 = 
BIT_RNG
(5,6),

183 
ADC_LEFT_DATA_FORMAT
 = 
BIT
(7),

185 
	#SET_LEFT_DATA_FORMAT
(
v
Ëdo{\

	)

186 
REG_ADC_LEFT_INPUT
 &(~
ADC_LEFT_DATA_FORMAT
);\

187 
REG_ADC_LEFT_INPUT
 |((
v
)<<7);\

190 
	#SET_LEFT_INPUT_P
(
v
Ëdo{\

	)

191 
REG_ADC_LEFT_INPUT
 &(~
ADC_LEFT_INPUT_P
);\

192 
REG_ADC_LEFT_INPUT
 |((
v
)&0x1F);\

195 
	#SET_LEFT_INPUT_M
(
v
Ëdo{\

	)

196 
REG_ADC_LEFT_INPUT
 &(~
ADC_LEFT_INPUT_M
);\

197 
REG_ADC_LEFT_INPUT
 |(((
v
)&0x03)<<5);\

202 
	#ADC_RESOLUTION_LEFT
 
	`READ_REG8
(0x2f)

	)

204 
ADC_MISC_RESOLUTION
 = 
BIT_RNG
(0,2),

206 
	#SET_LEFT_RES
(
v
Ëdo{\

	)

207 
ADC_RESOLUTION_LEFT
 &(~
ADC_MISC_RESOLUTION
);\

208 
ADC_RESOLUTION_LEFT
 |((
v
)&0x07);\

213 
	#REG_ADC_MISC_PERIOD
 
	`READ_REG16
(0x30)

	)

215 
MISC_PERIOD_LOW
 = 
BIT_RNG
(0,7),

216 
MISC_PERIOD_HIG
 = 
BIT_RNG
(8,15),

219 
	#SET_PFM
(
v
Ë
REG_ADC_MISC_PERIOD
 = ((v<<2)&0x0FFF)

220 

	)

224 
	#REG_ADC_LEFT_PERIOD
 
	`READ_REG16
(0x32)

	)

225 
	#SET_PFL
(
v
Ë
REG_ADC_LEFT_PERIOD
 = v

226 

	)

229 
	#ADC_CTRL_REG
 
	`READ_REG8
(0x33)

	)

231 
AUTO_MODE_LEFT_EN
 = 
BIT
(0),

232 
AUTO_MODE_RIGHT_EN
 = 
BIT
(1),

233 
AUDIO_OUTPUT_EN
 = 
BIT
(2),

234 
AUTO_MODE_MISC_EN
 = 
BIT
(3),

235 
AUDIO_MONO_STEREO_SEL
 = 
BIT_RNG
(4,5),

236 
ADC_DONE_EDGE_FLAG
 = 
BIT_RNG
(6,7),

239 
NO_AUDIO
 = 0,

240 
MONO_AUDIO
 = 
BIT
(4),

241 
STEREO_AUDIO
,

244 
ADC_DONE_RISING
 = 
BIT
(6),

245 
ADC_DONE_FALLING
 = 
BIT
(7),

250 
	#AREG_BATT_DET_CTRL
 0x02

	)

252 
BATT_DET_INPUT
 = 
BIT_RNG
(4,5),

257 
	#REG_ADC_MISC_RES_SAMPLE
 
	`READ_REG8
(0x3c)

	)

259 
MISC_SAMPLE
 = 
BIT_RNG
(0,2),

260 
MISC_RESOLUTION
 = 
BIT_RNG
(3,5),

266 
	#ADC_SAMPLE_CYCLE_LEFT
 
	`READ_REG8
(0x3d)

	)

268 
ADC_LEFT_SMPLE_CYCLE
 = 
BIT_RNG
(0,2),

270 
	#SET_SAMPLE_CYCLE_LEFT
(
v
Ëdo{\

	)

271 
ADC_SAMPLE_CYCLE_LEFT
 &(~
ADC_LEFT_SMPLE_CYCLE
);\

272 
ADC_SAMPLE_CYCLE_LEFT
 |((
v
)&0x07);\

278 
	#SET_P
(
v
Ë
	`wrôe_ªg16
(0x30,(v<<2)&0x0FFF)

	)

283 
	#REG_ADC_BUSY_FLAG
 
	`READ_REG8
(0x3a)

	)

285 
ADC_BUSY_FLAG
 = 
BIT
(0),

287 
	#CHECKADCSTATUS
 ((
REG_ADC_BUSY_FLAG
 & 
ADC_BUSY_FLAG
)?1:0)

	)

291 
	#ADC2AUDIO
(Ëdo{\

	)

292 
ADC_CTRL_REG
 &= 0x00;\

293 
ADC_CTRL_REG
 |(
AUTO_MODE_LEFT_EN
|
AUDIO_OUTPUT_EN
|
MONO_AUDIO
|
ADC_DONE_FALLING
);\

296 
	#AUDIO2ADC
(Ëdo{\

	)

297 
ADC_CTRL_REG
 &= 0x00;\

298 
ADC_CTRL_REG
 |(
ADC_DONE_FALLING
|
AUTO_MODE_MISC_EN
);\

305 
ADC_ResSë
(
ADC_ResTy≥Def
 
adcRes
);

312 
ADC_A«ChSë
–
ADC_I≈utPTy≥Def
 
adcInCha
);

319 
ADC_A«ModeSë
–
ADC_I≈utMTy≥Def
 
öM
);

326 
ADC_Sam∂eTimeSë
(
ADC_SampCycTy≥Def
 
adcST
);

333 
ADC_RefVﬁègeSë
(
ADC_RefVﬁTy≥Def
 
adcRF
);

342 
ADC_Inô
();

352 
ADC_P¨amSëtög
(
ADC_I≈utPTy≥Def
 
chn
,
ADC_I≈utMTy≥Def
 
mode
,
ADC_RefVﬁTy≥Def
 
ªf_vﬁ
,
ADC_ResTy≥Def
 
ªsﬁuti⁄
,
ADC_SampCycTy≥Def
 
ßm∂e_cy˛e
);

361 
ADC_B©ãryCheckInô
(
BATT_ChnTy≥Def
 
checkM
);

368 
ADC_B©ãryVÆueGë
();

375 
ADC_TemSís‹Inô
(
ADC_I≈utPTy≥Def
 
chn
);

382 
ADC_Sam∂eVÆueGë
();

387 #i‡
deföed
(
__˝lu•lus
)

	@platform/chip_826x/aes.h

24 #¥agm®
⁄˚


26 
´s_í¸y±
(*
key
, *
d©a
, *
ªsu…
);

27 
´s_de¸y±
(*
key
, *
d©a
, *
ªsu…
);

	@platform/chip_826x/bsp.h

24 #i‚de‡
BSP_H


25 
	#BSP_H


	)

31 
	#REG_BASE_ADDR
 0x800000

	)

33 
	#REG_ADDR8
(
a
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (a)))

	)

34 
	#REG_ADDR16
(
a
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (a)))

	)

35 
	#REG_ADDR32
(
a
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (a)))

	)

37 
	#WRITE_REG8
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

38 
	#WRITE_REG16
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

39 
	#WRITE_REG32
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)Ë(v))

	)

41 
	#READ_REG8
(
addr
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)))

	)

42 
	#READ_REG16
(
addr
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)))

	)

43 
	#READ_REG32
(
addr
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)))

	)

45 
	#wrôe_ªg8
 
WRITE_REG8


	)

46 
	#wrôe_ªg16
 
WRITE_REG16


	)

47 
	#wrôe_ªg32
 
WRITE_REG32


	)

49 
	#ªad_ªg8
 
READ_REG8


	)

50 
	#ªad_ªg16
 
READ_REG16


	)

51 
	#ªad_ªg32
 
READ_REG32


	)

54 
	#TCMD_UNDER_RD
 0x80

	)

55 
	#TCMD_UNDER_WR
 0x40

	)

56 
	#TCMD_UNDER_BOTH
 0xc0

	)

58 
	#TCMD_MASK
 0x3f

	)

60 
	#TCMD_WRITE
 0x3

	)

61 
	#TCMD_WAIT
 0x7

	)

62 
	#TCMD_WAREG
 0x8

	)

66 
	mr°0
;

67 
	mr°1
;

68 
	mr°2
;

69 
	m˛k0
;

70 
	m˛k1
;

71 
	m˛k2
;

72 
	m˛k˘l
;

73 } 
	tBSP_SysCéTy≥Def
;

77 
	mSYS_CLK_RC
 = 0,

78 
	mSYS_CLK_HS_DIV
 = 1,

79 } 
	tBSP_SysClkSñTy≥Def
;

82 
	sTBLCMDSET
 {

83 
	madr
;

84 
	md©
;

85 
	mcmd
;

86 } 
	tTBLCMDSET
;

90 
ölöe
 
	$mcu_ª£t
(){

91 
	`wrôe_ªg8
(0x06f, 0x20);

92 
	}
}

94 
LﬂdTblCmdSë
(c⁄° 
TBLCMDSET
 *
±
, 
size
);

96 
ønd
();

98 
™Æog_ªad
(
addr
);

99 
™Æog_wrôe
(
addr
, 
v
);

100 
™Æog_ªad_mu…i
(
addr
, *
v
, 
Àn
);

101 
™Æog_wrôe_mu…i
(
addr
, *
v
, 
Àn
);

103 
	#WrôeA«logReg
(
addr
,
v
Ë
	`™Æog_wrôe
◊ddr,v)

	)

104 
	#RódA«logReg
(
addr
Ë
	`™Æog_ªad
◊ddr)

	)

	@platform/chip_826x/clock.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

29 #ifde‡
__GNUC__


30 
	#_ASM_NOP_
 
	`asm
("ä›")

	)

32 
	#_ASM_NOP_


	)

38 
	mCLOCK_SEL_32M_RC
 = 0,

39 
	mCLOCK_SEL_HS_DIV
 = 1,

40 
	mCLOCK_SEL_16M_PAD
 = 2,

41 
	mCLOCK_SEL_32M_PAD
 = 3,

42 
	mCLOCK_SEL_SPI
 = 4,

43 
	mCLOCK_SEL_40M_INTERNAL
 = 5,

44 
	mCLOCK_SEL_32K_RC
 = 6,

48 
	mSYS_CLK_16M_PLL
,

49 
	mSYS_CLK_32M_PLL
,

50 
	mSYS_CLK_32M_RC
,

51 
	mSYS_CLK_16M_RC
,

52 
	mSYS_CLK_8M_RC
,

53 }
	tSYS_CLK_TYPEDEF
;

56 
CLOCK_SYS_CLOCK_1US
;

57 
tickPîUs
;

61 
ölöe
 
	$˛ock_time
(){

62  
ªg_sy°em_tick
;

63 
	}
}

66 
ölöe
 
	$˛ock_time_ex˚ed
(
ªf
, 
•™_us
){

67  (()(
	`˛ock_time
(Ë- 
ªf
Ë> 
•™_us
 * 
CLOCK_SYS_CLOCK_1US
);

68 
	}
}

71 
˛ock_öô
(
SYS_CLK_TYPEDEF
 
SYS_CLK
);

72 
rc_32k_ˇl
();

73 
¶ìp_us
(
us
);

75 
	#WaôUs
(
t
Ë
	`¶ìp_us
—)

	)

76 
	#WaôMs
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

77 
	#¶ìp_ms
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

	@platform/chip_826x/driver_826x.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"b•.h
"

28 
	~"˛ock.h
"

29 
	~"timî.h
"

30 
	~"úq.h
"

31 
	~"w©chdog.h
"

32 
	~"pm.h
"

33 
	~"rf_drv.h
"

34 
	~"adc.h
"

35 
	~"gpio.h
"

36 
	~"pwm.h
"

37 
	~"´s.h
"

38 
	~"u¨t.h
"

39 
	~"usbhw.h
"

40 
	~"Êash.h
"

41 
	~"i2c.h
"

42 
	~"•i.h
"

	@platform/chip_826x/flash.c

24 
	~"Êash.h
"

25 
	~"ªgi°î.h
"

26 
	~"˛ock.h
"

27 
	~"úq.h
"

28 
	~"°rög.h
"

30 
ölöe
 
	$m•i_waô
(){

31 
ªg_ma°î_•i_˘æ
 & 
FLD_MASTER_SPI_BUSY
);

32 
	}
}

34 
ölöe
 
	$m•i_high
(){

35 
ªg_ma°î_•i_˘æ
 = 
FLD_MASTER_SPI_CS
;

36 
	}
}

38 
ölöe
 
	$m•i_low
(){

39 
ªg_ma°î_•i_˘æ
 = 0;

40 
	}
}

42 
ölöe
 
	$m•i_gë
(){

43  
ªg_ma°î_•i_d©a
;

44 
	}
}

46 
ölöe
 
	$m•i_wrôe
(
c
){

47 
ªg_ma°î_•i_d©a
 = 
c
;

48 
	}
}

50 
ölöe
 
	$m•i_˘æ_wrôe
(
c
){

51 
ªg_ma°î_•i_˘æ
 = 
c
;

52 
	}
}

54 
ölöe
 
	$m•i_ªad
(){

55 
	`m•i_wrôe
(0);

56 
	`m•i_waô
();

57  
	`m•i_gë
();

58 
	}
}

60 
_©åibuã_øm_code_£c_
 
ölöe
 
	$Êash_is_busy
()

62  
	`m•i_ªad
() & 0x01;

63 
	}
}

65 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_cmd
(
cmd
)

67 
	`m•i_high
();

68 
	`¶ìp_us
(1);

69 
	`m•i_low
();

70 
	`m•i_wrôe
(
cmd
);

71 
	`m•i_waô
();

72 
	}
}

74 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_addr
(
addr
)

76 
	`m•i_wrôe
(()(
addr
>>16));

77 
	`m•i_waô
();

78 
	`m•i_wrôe
(()(
addr
>>8));

79 
	`m•i_waô
();

80 
	`m•i_wrôe
(()(
addr
));

81 
	`m•i_waô
();

82 
	}
}

85 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_waô_d⁄e
()

87 
	`¶ìp_us
(100);

88 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_CMD_LOWBYTE
);

90 
i
;

91 
i
 = 0; i < 10000000; ++i){

92 if(!
	`Êash_is_busy
()){

96 
	`m•i_high
();

97 
	}
}

99 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_ªad_øm
(
cmd
, 
addr
, 
addr_í
, 
dummy_˙t
, *
d©a
, 
d©a_Àn
)

101 
r
 = 
	`úq_dißbÀ
();

103 
	`Êash_£nd_cmd
(
cmd
);

104 if(
addr_í
)

106 
	`Êash_£nd_addr
(
addr
);

108 
i
 = 0; i < 
dummy_˙t
; ++i)

110 
	`m•i_wrôe
(0x00);

111 
	`m•i_waô
();

113 
	`m•i_wrôe
(0x00);

114 
	`m•i_waô
();

115 
	`m•i_˘æ_wrôe
(0x0a);

116 
	`m•i_waô
();

117 
i
 = 0; i < 
d©a_Àn
; ++i)

119 *
d©a
++ = 
	`m•i_gë
();

120 
	`m•i_waô
();

122 
	`m•i_high
();

124 
	`úq_ª°‹e
(
r
);

125 
	}
}

127 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_wrôe_øm
(
cmd
, 
addr
, 
addr_í
, *
d©a
, 
d©a_Àn
)

129 
r
 = 
	`úq_dißbÀ
();

131 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

132 
	`Êash_£nd_cmd
(
cmd
);

133 if(
addr_í
)

135 
	`Êash_£nd_addr
(
addr
);

137 
i
 = 0; i < 
d©a_Àn
; ++i)

139 
	`m•i_wrôe
(
d©a
[
i
]);

140 
	`m•i_waô
();

142 
	`m•i_high
();

143 
	`Êash_waô_d⁄e
();

145 
	`úq_ª°‹e
(
r
);

146 
	}
}

148 
	$Êash_îa£_£˘‹
(
addr
)

150 
	`Êash_m•i_wrôe_øm
(
FLASH_SECT_ERASE_CMD
, 
addr
, 1, 
NULL
, 0);

151 
	}
}

153 
	$Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
)

155 
	`Êash_m•i_ªad_øm
(
FLASH_READ_CMD
, 
addr
, 1, 0, 
buf
, 
Àn
);

156 
	}
}

158 
	$Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
)

160 
ns
 = 
PAGE_SIZE
 - (
addr
&(PAGE_SIZE - 1));

161 
nw
 = 0;

164 
nw
 = 
Àn
 > 
ns
 ?Çs :len;

165 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_CMD
, 
addr
, 1, 
buf
, 
nw
);

166 
ns
 = 
PAGE_SIZE
;

167 
addr
 +
nw
;

168 
buf
 +
nw
;

169 
Àn
 -
nw
;

170 }
Àn
 > 0);

171 
	}
}

173 
	$Êash_ªad_°©us
(
cmd
)

175 
°©us
 = 0;

176 
	`Êash_m•i_ªad_øm
(
cmd
, 0, 0, 0, &
°©us
, 1);

177  
°©us
;

178 
	}
}

180 
	$Êash_wrôe_°©us
(
Êash_°©us_ty≥def_e
 
ty≥
, 
d©a
)

182 
buf
[2];

184 
buf
[0] = 
d©a
;

185 
buf
[1] = 
d©a
>>8;

186 if(
ty≥
 =
FLASH_TYPE_8BIT_STATUS
){

187 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 1);

188 }if(
ty≥
 =
FLASH_TYPE_16BIT_STATUS_ONE_CMD
){

189 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 2);

191 
	}
}

193 
	$Êash_ªad_mid
()

195 
Êash_mid
 = 0;

196 
	`Êash_m•i_ªad_øm
(
FLASH_GET_JEDEC_ID
, 0, 0, 0, (*)(&
Êash_mid
), 3);

197  
Êash_mid
;

198 
	}
}

200 
	$Êash_ªad_uid
(
idcmd
, *
buf
)

202 if(
idcmd
 =
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
)

204 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x00, 1, 1, 
buf
, 16);

206 i‡(
idcmd
 =
FLASH_READ_UID_CMD_XTX
)

208 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x80, 1, 1, 
buf
, 16);

210 
	}
}

212 
	$Êash_ªad_mid_uid_wôh_check
(*
Êash_mid
, *
Êash_uid
)

214 
no_uid
[16]={0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01};

215 
i
,
f_˙t
=0;

216 *
Êash_mid
 = 
	`Êash_ªad_mid
();

228 if((*
Êash_mid
 == 0x134051)||(*flash_mid == 0x1140C8)||(*flash_mid == 0x13325E)){

229 
	`Êash_ªad_uid
(
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
, (*)
Êash_uid
);

234 
i
 = 0; i < 16; i++){

235 if(
Êash_uid
[
i
] =
no_uid
[i]){

236 
f_˙t
++;

240 if(
f_˙t
 == 16){

245 
	}
}

	@platform/chip_826x/flash.h

24 #¥agm®
⁄˚


26 
	~"compûî.h
"

29 
	#PAGE_SIZE
 256

	)

33 
	mFLASH_WRITE_CMD
 = 0x02,

34 
	mFLASH_READ_CMD
 = 0x03,

36 
	mFLASH_SECT_ERASE_CMD
 = 0x20,

38 
	mFLASH_READ_UID_CMD_GD_PUYA_ZB_UT
 = 0x4B,

39 
	mFLASH_READ_UID_CMD_XTX
 = 0x5A,

41 
	mFLASH_GET_JEDEC_ID
 = 0x9F,

43 
	mFLASH_WRITE_STATUS_CMD_LOWBYTE
 = 0x01,

44 
	mFLASH_WRITE_STATUS_CMD_HIGHBYTE
 = 0x31,

46 
	mFLASH_READ_STATUS_CMD_LOWBYTE
 = 0x05,

47 
	mFLASH_READ_STATUS_CMD_HIGHBYTE
 = 0x35,

49 
	mFLASH_WRITE_DISABLE_CMD
 = 0x04,

50 
	mFLASH_WRITE_ENABLE_CMD
 = 0x06,

54 
	mFLASH_TYPE_8BIT_STATUS
 = 0,

55 
	mFLASH_TYPE_16BIT_STATUS_ONE_CMD
 = 1,

56 
	mFLASH_TYPE_16BIT_STATUS_TWO_CMD
 = 2,

57 }
	tÊash_°©us_ty≥def_e
;

59 
Êash_îa£_£˘‹
(
addr
);

60 
Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
);

61 
Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
);

62 
Êash_ªad_mid
();

63 
Êash_ªad_uid
(
idcmd
, *
buf
);

64 
Êash_ªad_mid_uid_wôh_check
(*
Êash_mid
, *
Êash_uid
);

	@platform/chip_826x/gpio.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"bô.h
"

31 
	#AS_GPIO
 0

	)

32 
	#AS_MSPI
 1

	)

33 
	#AS_SWIRE
 2

	)

34 
	#AS_UART
 3

	)

35 
	#AS_PWM
 4

	)

36 
	#AS_I2C
 5

	)

37 
	#AS_SPI
 6

	)

38 
	#AS_ETH_MAC
 7

	)

39 
	#AS_I2S
 8

	)

40 
	#AS_SDM
 9

	)

41 
	#AS_DMIC
 10

	)

42 
	#AS_USB
 11

	)

43 
	#AS_SWS
 12

	)

44 
	#AS_SWM
 13

	)

45 
	#AS_TEST
 14

	)

48 
	mGPIO_PA0
 = 0x000 | 
BIT
(0), 
	mGPIO_PWM0A0
=
GPIO_PA0
, 
	mGPIO_DMIC_DI
=GPIO_PA0,

49 
	mGPIO_PA1
 = 0x000 | 
BIT
(1), 
	mGPIO_DMIC_CK
=
GPIO_PA1
,

50 
	mGPIO_PA2
 = 0x000 | 
BIT
(2), 
	mGPIO_PWM0NA2
=
GPIO_PA2
, 
	mGPIO_DO
=GPIO_PA2,

51 
	mGPIO_PA3
 = 0x000 | 
BIT
(3), 
	mGPIO_PWM1A3
=
GPIO_PA3
, 
	mGPIO_DI
=GPIO_PA3,

52 
	mGPIO_PA4
 = 0x000 | 
BIT
(4), 
	mGPIO_PWM1NA4
=
GPIO_PA4
, 
	mGPIO_CK
=GPIO_PA4,

53 
	mGPIO_PA5
 = 0x000 | 
BIT
(5), 
	mGPIO_PWM2NA5
=
GPIO_PA5
, 
	mGPIO_CN
=GPIO_PA5,

54 
	mGPIO_PA6
 = 0x000 | 
BIT
(6), 
	mGPIO_UTXA6
=
GPIO_PA6
,

55 
	mGPIO_PA7
 = 0x000 | 
BIT
(7), 
	mGPIO_URXA7
=
GPIO_PA7
, 
	mGPIO_SWM
=GPIO_PA7,

57 
	mGPIO_PB0
 = 0x100 | 
BIT
(0), 
	mGPIO_PWM2B0
=
GPIO_PB0
, 
	mGPIO_SWS
=GPIO_PB0,

58 
	mGPIO_PB1
 = 0x100 | 
BIT
(1), 
	mGPIO_PWM2NB0
=
GPIO_PB1
,

59 
	mGPIO_PB2
 = 0x100 | 
BIT
(2), 
	mGPIO_PWM3B2
=
GPIO_PB2
, 
	mGPIO_UTXB2
=GPIO_PB2,

60 
	mGPIO_PB3
 = 0x100 | 
BIT
(3), 
	mGPIO_PWM3NB3
=
GPIO_PB3
, 
	mGPIO_URXB3
=GPIO_PB3,

61 
	mGPIO_PB4
 = 0x100 | 
BIT
(4), 
	mGPIO_PWM4B4
=
GPIO_PB4
,

62 
	mGPIO_PB5
 = 0x100 | 
BIT
(5), 
	mGPIO_PWM4NB5
=
GPIO_PB5
,

63 
	mGPIO_PB6
 = 0x100 | 
BIT
(6), 
	mGPIO_PWM5B6
=
GPIO_PB6
,

64 
	mGPIO_PB7
 = 0x100 | 
BIT
(7), 
	mGPIO_PWM5NB7
=
GPIO_PB7
,

66 
	mGPIO_PC0
 = 0x200 | 
BIT
(0), 
	mGPIO_PWM0C0
=
GPIO_PC0
,

67 
	mGPIO_PC1
 = 0x200 | 
BIT
(1), 
	mGPIO_PWM1C1
=
GPIO_PC1
,

68 
	mGPIO_PC2
 = 0x200 | 
BIT
(2), 
	mGPIO_PWM2C2
=
GPIO_PC2
, 
	mGPIO_UTXC2
=GPIO_PC2,

69 
	mGPIO_PC3
 = 0x200 | 
BIT
(3), 
	mGPIO_PWM3C3
=
GPIO_PC3
, 
	mGPIO_URXC3
=GPIO_PC3,

70 
	mGPIO_PC4
 = 0x200 | 
BIT
(4), 
	mGPIO_PWM4C4
=
GPIO_PC4
, 
	mGPIO_URTSC4
=GPIO_PC4,

71 
	mGPIO_PC5
 = 0x200 | 
BIT
(5), 
	mGPIO_PWM4C5
=
GPIO_PC5
, 
	mGPIO_UCTSC5
=GPIO_PC5,

72 
	mGPIO_PC6
 = 0x200 | 
BIT
(6),

73 
	mGPIO_PC7
 = 0x200 | 
BIT
(7),

75 
	mGPIO_PD0
 = 0x300 | 
BIT
(0),

76 
	mGPIO_PD1
 = 0x300 | 
BIT
(1),

77 
	mGPIO_PD2
 = 0x300 | 
BIT
(2),

78 
	mGPIO_PD3
 = 0x300 | 
BIT
(3),

79 
	mGPIO_PD4
 = 0x300 | 
BIT
(4),

80 
	mGPIO_PD5
 = 0x300 | 
BIT
(5), 
	mGPIO_PWM0D5
=
GPIO_PD5
,

81 
	mGPIO_PD6
 = 0x300 | 
BIT
(6), 
	mGPIO_PWM1D6
=
GPIO_PD6
,

82 
	mGPIO_PD7
 = 0x300 | 
BIT
(7), 
	mGPIO_PWM2D7
=
GPIO_PD7
,

84 
	mGPIO_PE0
 = 0x400 | 
BIT
(0), 
	mGPIO_PWM0E0
=
GPIO_PE0
, 
	mGPIO_SDMP
=GPIO_PE0,

85 
	mGPIO_PE1
 = 0x400 | 
BIT
(1), 
	mGPIO_PWM1E1
=
GPIO_PE1
, 
	mGPIO_SDMN
=GPIO_PE1,

86 
	mGPIO_PE2
 = 0x400 | 
BIT
(2), 
	mGPIO_DM
=
GPIO_PE2
,

87 
	mGPIO_PE3
 = 0x400 | 
BIT
(3), 
	mGPIO_DP
=
GPIO_PE3
,

88 
	mGPIO_PE4
 = 0x400 | 
BIT
(4), 
	mGPIO_MSDO
=
GPIO_PE4
,

89 
	mGPIO_PE5
 = 0x400 | 
BIT
(5), 
	mGPIO_MCLK
=
GPIO_PE5
,

90 
	mGPIO_PE6
 = 0x400 | 
BIT
(6), 
	mGPIO_MSCN
=
GPIO_PE6
,

91 
	mGPIO_PE7
 = 0x400 | 
BIT
(7), 
	mGPIO_MSDI
=
GPIO_PE7
,

93 
	mGPIO_PF0
 = 0x500 | 
BIT
(0),

94 
	mGPIO_PF1
 = 0x500 | 
BIT
(1),

96 
	mGPIO_MAX_COUNT
 = 56,

97 }
	tGPIO_PöTy≥Def
;

103 
	mPM_PIN_UP_DOWN_FLOAT
 = 0,

104 
	mPM_PIN_PULLUP_1M
 = 1,

105 
	mPM_PIN_PULLUP_10K
 = 2,

106 
	mPM_PIN_PULLDOWN_100K
 = 3,

107 }
	tGPIO_PuŒTy≥Def
;

109 
	#ªg_gpio_ö
(
i
Ë
	`REG_ADDR8
(0x580+((i>>8)<<3))

	)

110 
	#ªg_gpio_õ
(
i
Ë
	`REG_ADDR8
(0x581+((i>>8)<<3))

	)

111 
	#ªg_gpio_€n
(
i
Ë
	`REG_ADDR8
(0x582+((i>>8)<<3))

	)

112 
	#ªg_gpio_out
(
i
Ë
	`REG_ADDR8
(0x583+((i>>8)<<3))

	)

113 
	#ªg_gpio_pﬁ
(
i
Ë
	`REG_ADDR8
(0x584+((i>>8)<<3))

	)

114 
	#ªg_gpio_ds
(
i
Ë
	`REG_ADDR8
(0x585+((i>>8)<<3))

	)

115 
	#ªg_gpio_gpio_func
(
i
Ë
	`REG_ADDR8
(0x586+((i>>8)<<3))

	)

116 
	#ªg_gpio_úq_í0
(
i
Ë
	`REG_ADDR8
(0x587+((i>>8)<<3))

117 
	#ªg_gpio_úq_í
(
i
Ë
	`REG_ADDR8
(0x5c8+(i>>8))

118 

	)

119 
	#ªg_gpio_úq_§c
(
i
Ë
	`REG_ADDR8
(0x5e0+(i>>8))

	)

121 
	#ªg_gpio_úq_risc0_í
(
i
Ë
	`REG_ADDR8
(0x5b8 + (i >> 8))

122 
	#ªg_gpio_úq_risc1_í
(
i
Ë
	`REG_ADDR8
(0x5c0 + (i >> 8))

123 
	#ªg_gpio_úq_risc2_í
(
i
Ë
	`REG_ADDR8
(0x5c8 + (i >> 8))

124 

	)

125 
	#ªg_gpio_wakeup_úq
 
	`REG_ADDR8
(0x5b5)

	)

127 
	mFLD_GPIO_CORE_WAKEUP_EN
 = 
BIT
(2),

128 
	mFLD_GPIO_CORE_INTERRUPT_EN
 = 
BIT
(3),

131 
ölöe
 
	$gpio_c‹e_wakeup_íabÀ_Æl
(
í
)

133 i‡(
í
) {

134 
	`BM_SET
(
ªg_gpio_wakeup_úq
, 
FLD_GPIO_CORE_WAKEUP_EN
);

137 
	`BM_CLR
(
ªg_gpio_wakeup_úq
, 
FLD_GPIO_CORE_WAKEUP_EN
);

139 
	}
}

142 
ölöe
 
	$gpio_is_≥_pö
(
GPIO_PöTy≥Def
 
pö
){

143  (
pö
 >> 8) == 0x04;

144 
	}
}

146 
ölöe
 
	$gpio_is_ouçut_í
(
GPIO_PöTy≥Def
 
pö
){

147  !
	`BM_IS_SET
(
	`ªg_gpio_€n
(
pö
),Öin & 0xff);

148 
	}
}

150 
ölöe
 
	$gpio_is_öput_í
(
GPIO_PöTy≥Def
 
pö
){

151  
	`BM_IS_SET
(
	`ªg_gpio_õ
(
pö
),Öin & 0xff);

152 
	}
}

154 
ölöe
 
	$gpio_£t_ouçut_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
){

155 
bô
 = 
pö
 & 0xff;

156 if(!
vÆue
){

157 
	`BM_SET
(
	`ªg_gpio_€n
(
pö
), 
bô
);

159 
	`BM_CLR
(
	`ªg_gpio_€n
(
pö
), 
bô
);

161 
	}
}

163 
ölöe
 
	$gpio_£t_öput_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
){

164 
bô
 = 
pö
 & 0xff;

165 if(
vÆue
){

166 
	`BM_SET
(
	`ªg_gpio_õ
(
pö
), 
bô
);

168 
	`BM_CLR
(
	`ªg_gpio_õ
(
pö
), 
bô
);

170 
	}
}

172 
ölöe
 
	$gpio_£t_d©a_°ªngth
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
){

173 
bô
 = 
pö
 & 0xff;

174 if(
vÆue
){

175 
	`BM_SET
(
	`ªg_gpio_ds
(
pö
), 
bô
);

177 
	`BM_CLR
(
	`ªg_gpio_ds
(
pö
), 
bô
);

179 
	}
}

181 
ölöe
 
	$gpio_í_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
í
){

182 
bô
 = 
pö
 & 0xff;

183 if(
í
){

184 
	`BM_SET
(
	`ªg_gpio_úq_í0
(
pö
), 
bô
);

187 
	`BM_CLR
(
	`ªg_gpio_úq_í0
(
pö
), 
bô
);

189 
	}
}

191 
ölöe
 
	$gpio_£t_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
ÁŒög
){

192 
bô
 = 
pö
 & 0xff;

193 
ªg_gpio_wakeup_úq
 |
FLD_GPIO_CORE_INTERRUPT_EN
;

194 if(
ÁŒög
){

195 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

197 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

200 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_EN
;

201 
ªg_úq_mask
 |
FLD_IRQ_GPIO_EN
;

202 
	}
}

204 
ölöe
 
	$gpio_í_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
í
){

205 
bô
 = 
pö
 & 0xff;

206 if(
í
){

207 
	`BM_SET
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

210 
	`BM_CLR
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

212 
	}
}

214 
ölöe
 
	$gpio_£t_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
ÁŒög
){

215 
bô
 = 
pö
 & 0xff;

216 if(
ÁŒög
){

217 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

219 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

222 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC0_EN
;

223 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC0_EN
;

224 
	}
}

226 
ölöe
 
	$gpio_í_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
í
){

227 
bô
 = 
pö
 & 0xff;

228 if(
í
){

229 
	`BM_SET
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

232 
	`BM_CLR
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

234 
	}
}

236 
ölöe
 
	$gpio_£t_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
ÁŒög
){

237 
bô
 = 
pö
 & 0xff;

238 if(
ÁŒög
){

239 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

241 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

244 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC1_EN
;

245 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC1_EN
;

246 
	}
}

248 
ölöe
 
	$gpio_£t_öãºu±_pﬁ
(
GPIO_PöTy≥Def
 
pö
, 
ÁŒög
){

249 
bô
 = 
pö
 & 0xff;

250 if(
ÁŒög
){

251 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

253 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

255 
	}
}

257 
ölöe
 
	$gpio_˛r_öãºu±
(
GPIO_PöTy≥Def
 
pö
){

258 
bô
 = 
pö
 & 0xff;

259 
	`BM_CLR
(
	`ªg_gpio_úq_í0
(
pö
), 
bô
);

260 
	}
}

262 
ölöe
 
	$gpio_wrôe
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
){

263 
bô
 = 
pö
 & 0xff;

264 if(
vÆue
){

265 
	`BM_SET
(
	`ªg_gpio_out
(
pö
), 
bô
);

267 
	`BM_CLR
(
	`ªg_gpio_out
(
pö
), 
bô
);

269 
	}
}

271 
ölöe
 
	$gpio_toggÀ
(
GPIO_PöTy≥Def
 
pö
) {

272 
	`ªg_gpio_out
(
pö
) ^= (pin & 0xFF);

273 
	}
}

275 
ölöe
 
	$gpio_úq_§c_ªad
(
GPIO_PöTy≥Def
 
pö
){

276  
	`BM_IS_SET
(
	`ªg_gpio_úq_§c
(
pö
),Öin & 0xff);

277 
	}
}

279 
ölöe
 
	$gpio_ªad
(
GPIO_PöTy≥Def
 
pö
){

280  
	`BM_IS_SET
(
	`ªg_gpio_ö
(
pö
),Öin & 0xff);

281 
	}
}

284 
ölöe
 
	$gpio_ªad_Æl
(*
p
){

285 
p
[0] = 
	`REG_ADDR8
(0x580);

286 
p
[1] = 
	`REG_ADDR8
(0x588);

287 
p
[2] = 
	`REG_ADDR8
(0x590);

288 
p
[3] = 
	`REG_ADDR8
(0x598);

289 
p
[4] = 
	`REG_ADDR8
(0x5a0);

290 
	}
}

292 
ölöe
 
	$gpio_íabÀ_wakeup_pö
(
GPIO_PöTy≥Def
 
pö
, 
í
){

294 
bô
 = 
pö
 & 0xff;

295 i‡(
í
) {

296 
	`BM_SET
(
	`ªg_gpio_úq_í0
(
pö
), 
bô
);

299 
	`BM_CLR
(
	`ªg_gpio_úq_í0
(
pö
), 
bô
);

301 
	}
}

304 
ölöe
 
	$gpio_£t_func
(
GPIO_PöTy≥Def
 
pö
, 
func
){

305 
bô
 = 
pö
 & 0xff;

306 if(
func
 =
AS_GPIO
){

307 
	`BM_SET
(
	`ªg_gpio_gpio_func
(
pö
), 
bô
);

310 
	`BM_CLR
(
	`ªg_gpio_gpio_func
(
pö
), 
bô
);

312 
	}
}

316 
gpio_£tup_up_down_ªsi°‹
(
GPIO_PöTy≥Def
 
gpio
, 
GPIO_PuŒTy≥Def
 
up_down
);

	@platform/chip_826x/gpio_default.h

24 #¥agm®
⁄˚


26 
	~"gpio.h
"

29 #i‚de‡
PA0_INPUT_ENABLE


30 
	#PA0_INPUT_ENABLE
 0

	)

32 #i‚de‡
PA1_INPUT_ENABLE


33 
	#PA1_INPUT_ENABLE
 0

	)

35 #i‚de‡
PA2_INPUT_ENABLE


36 
	#PA2_INPUT_ENABLE
 0

	)

38 #i‚de‡
PA3_INPUT_ENABLE


39 
	#PA3_INPUT_ENABLE
 0

	)

41 #i‚de‡
PA4_INPUT_ENABLE


42 
	#PA4_INPUT_ENABLE
 0

	)

44 #i‚de‡
PA5_INPUT_ENABLE


45 
	#PA5_INPUT_ENABLE
 0

	)

47 #i‚de‡
PA6_INPUT_ENABLE


48 
	#PA6_INPUT_ENABLE
 0

	)

50 #i‚de‡
PA7_INPUT_ENABLE


51 
	#PA7_INPUT_ENABLE
 0

	)

53 #i‚de‡
PA0_OUTPUT_ENABLE


54 
	#PA0_OUTPUT_ENABLE
 0

	)

56 #i‚de‡
PA1_OUTPUT_ENABLE


57 
	#PA1_OUTPUT_ENABLE
 0

	)

59 #i‚de‡
PA2_OUTPUT_ENABLE


60 
	#PA2_OUTPUT_ENABLE
 0

	)

62 #i‚de‡
PA3_OUTPUT_ENABLE


63 
	#PA3_OUTPUT_ENABLE
 0

	)

65 #i‚de‡
PA4_OUTPUT_ENABLE


66 
	#PA4_OUTPUT_ENABLE
 0

	)

68 #i‚de‡
PA5_OUTPUT_ENABLE


69 
	#PA5_OUTPUT_ENABLE
 0

	)

71 #i‚de‡
PA6_OUTPUT_ENABLE


72 
	#PA6_OUTPUT_ENABLE
 0

	)

74 #i‚de‡
PA7_OUTPUT_ENABLE


75 
	#PA7_OUTPUT_ENABLE
 0

	)

77 #i‚de‡
PA0_DATA_STRENGTH


78 
	#PA0_DATA_STRENGTH
 1

	)

80 #i‚de‡
PA1_DATA_STRENGTH


81 
	#PA1_DATA_STRENGTH
 1

	)

83 #i‚de‡
PA2_DATA_STRENGTH


84 
	#PA2_DATA_STRENGTH
 1

	)

86 #i‚de‡
PA3_DATA_STRENGTH


87 
	#PA3_DATA_STRENGTH
 1

	)

89 #i‚de‡
PA4_DATA_STRENGTH


90 
	#PA4_DATA_STRENGTH
 1

	)

92 #i‚de‡
PA5_DATA_STRENGTH


93 
	#PA5_DATA_STRENGTH
 1

	)

95 #i‚de‡
PA6_DATA_STRENGTH


96 
	#PA6_DATA_STRENGTH
 1

	)

98 #i‚de‡
PA7_DATA_STRENGTH


99 
	#PA7_DATA_STRENGTH
 1

	)

101 #i‚de‡
PA0_DATA_OUT


102 
	#PA0_DATA_OUT
 0

	)

104 #i‚de‡
PA1_DATA_OUT


105 
	#PA1_DATA_OUT
 0

	)

107 #i‚de‡
PA2_DATA_OUT


108 
	#PA2_DATA_OUT
 0

	)

110 #i‚de‡
PA3_DATA_OUT


111 
	#PA3_DATA_OUT
 0

	)

113 #i‚de‡
PA4_DATA_OUT


114 
	#PA4_DATA_OUT
 0

	)

116 #i‚de‡
PA5_DATA_OUT


117 
	#PA5_DATA_OUT
 0

	)

119 #i‚de‡
PA6_DATA_OUT


120 
	#PA6_DATA_OUT
 0

	)

122 #i‚de‡
PA7_DATA_OUT


123 
	#PA7_DATA_OUT
 0

	)

125 #i‚de‡
PA0_FUNC


126 
	#PA0_FUNC
 
AS_GPIO


	)

128 #i‚de‡
PA1_FUNC


129 
	#PA1_FUNC
 
AS_GPIO


	)

131 #i‚de‡
PA2_FUNC


132 
	#PA2_FUNC
 
AS_GPIO


	)

134 #i‚de‡
PA3_FUNC


135 
	#PA3_FUNC
 
AS_GPIO


	)

137 #i‚de‡
PA4_FUNC


138 
	#PA4_FUNC
 
AS_GPIO


	)

140 #i‚de‡
PA5_FUNC


141 
	#PA5_FUNC
 
AS_GPIO


	)

143 #i‚de‡
PA6_FUNC


144 
	#PA6_FUNC
 
AS_GPIO


	)

146 #i‚de‡
PA7_FUNC


147 
	#PA7_FUNC
 
AS_GPIO


	)

149 #i‚de‡
PULL_WAKEUP_SRC_PA0


150 
	#PULL_WAKEUP_SRC_PA0
 0

	)

152 #i‚de‡
PULL_WAKEUP_SRC_PA1


153 
	#PULL_WAKEUP_SRC_PA1
 0

	)

155 #i‚de‡
PULL_WAKEUP_SRC_PA2


156 
	#PULL_WAKEUP_SRC_PA2
 0

	)

158 #i‚de‡
PULL_WAKEUP_SRC_PA3


159 
	#PULL_WAKEUP_SRC_PA3
 0

	)

161 #i‚de‡
PULL_WAKEUP_SRC_PA4


162 
	#PULL_WAKEUP_SRC_PA4
 0

	)

164 #i‚de‡
PULL_WAKEUP_SRC_PA5


165 
	#PULL_WAKEUP_SRC_PA5
 0

	)

167 #i‚de‡
PULL_WAKEUP_SRC_PA6


168 
	#PULL_WAKEUP_SRC_PA6
 0

	)

170 #i‚de‡
PULL_WAKEUP_SRC_PA7


171 
	#PULL_WAKEUP_SRC_PA7
 0

	)

175 #i‚de‡
PB0_INPUT_ENABLE


176 
	#PB0_INPUT_ENABLE
 1

178 #i‚de‡
PB1_INPUT_ENABLE


	)

179 
	#PB1_INPUT_ENABLE
 0

	)

181 #i‚de‡
PB2_INPUT_ENABLE


182 
	#PB2_INPUT_ENABLE
 0

	)

184 #i‚de‡
PB3_INPUT_ENABLE


185 
	#PB3_INPUT_ENABLE
 0

	)

187 #i‚de‡
PB4_INPUT_ENABLE


188 
	#PB4_INPUT_ENABLE
 0

	)

190 #i‚de‡
PB5_INPUT_ENABLE


191 
	#PB5_INPUT_ENABLE
 0

	)

193 #i‚de‡
PB6_INPUT_ENABLE


194 
	#PB6_INPUT_ENABLE
 0

	)

196 #i‚de‡
PB7_INPUT_ENABLE


197 
	#PB7_INPUT_ENABLE
 0

	)

199 #i‚de‡
PB0_OUTPUT_ENABLE


200 
	#PB0_OUTPUT_ENABLE
 0

	)

202 #i‚de‡
PB1_OUTPUT_ENABLE


203 
	#PB1_OUTPUT_ENABLE
 0

	)

205 #i‚de‡
PB2_OUTPUT_ENABLE


206 
	#PB2_OUTPUT_ENABLE
 0

	)

208 #i‚de‡
PB3_OUTPUT_ENABLE


209 
	#PB3_OUTPUT_ENABLE
 0

	)

211 #i‚de‡
PB4_OUTPUT_ENABLE


212 
	#PB4_OUTPUT_ENABLE
 0

	)

214 #i‚de‡
PB5_OUTPUT_ENABLE


215 
	#PB5_OUTPUT_ENABLE
 0

	)

217 #i‚de‡
PB6_OUTPUT_ENABLE


218 
	#PB6_OUTPUT_ENABLE
 0

	)

220 #i‚de‡
PB7_OUTPUT_ENABLE


221 
	#PB7_OUTPUT_ENABLE
 0

	)

223 #i‚de‡
PB0_DATA_STRENGTH


224 
	#PB0_DATA_STRENGTH
 1

	)

226 #i‚de‡
PB1_DATA_STRENGTH


227 
	#PB1_DATA_STRENGTH
 1

	)

229 #i‚de‡
PB2_DATA_STRENGTH


230 
	#PB2_DATA_STRENGTH
 1

	)

232 #i‚de‡
PB3_DATA_STRENGTH


233 
	#PB3_DATA_STRENGTH
 1

	)

235 #i‚de‡
PB4_DATA_STRENGTH


236 
	#PB4_DATA_STRENGTH
 1

	)

238 #i‚de‡
PB5_DATA_STRENGTH


239 
	#PB5_DATA_STRENGTH
 1

	)

241 #i‚de‡
PB6_DATA_STRENGTH


242 
	#PB6_DATA_STRENGTH
 1

	)

244 #i‚de‡
PB7_DATA_STRENGTH


245 
	#PB7_DATA_STRENGTH
 1

	)

247 #i‚de‡
PB0_DATA_OUT


248 
	#PB0_DATA_OUT
 0

	)

250 #i‚de‡
PB1_DATA_OUT


251 
	#PB1_DATA_OUT
 0

	)

253 #i‚de‡
PB2_DATA_OUT


254 
	#PB2_DATA_OUT
 0

	)

256 #i‚de‡
PB3_DATA_OUT


257 
	#PB3_DATA_OUT
 0

	)

259 #i‚de‡
PB4_DATA_OUT


260 
	#PB4_DATA_OUT
 0

	)

262 #i‚de‡
PB5_DATA_OUT


263 
	#PB5_DATA_OUT
 0

	)

265 #i‚de‡
PB6_DATA_OUT


266 
	#PB6_DATA_OUT
 0

	)

268 #i‚de‡
PB7_DATA_OUT


269 
	#PB7_DATA_OUT
 0

	)

271 #i‚de‡
PB0_FUNC


272 
	#PB0_FUNC
 
AS_SWIRE


	)

274 #i‚de‡
PB1_FUNC


275 
	#PB1_FUNC
 
AS_GPIO


	)

277 #i‚de‡
PB2_FUNC


278 
	#PB2_FUNC
 
AS_GPIO


	)

280 #i‚de‡
PB3_FUNC


281 
	#PB3_FUNC
 
AS_GPIO


	)

283 #i‚de‡
PB4_FUNC


284 
	#PB4_FUNC
 
AS_GPIO


	)

286 #i‚de‡
PB5_FUNC


287 
	#PB5_FUNC
 
AS_GPIO


	)

289 #i‚de‡
PB6_FUNC


290 
	#PB6_FUNC
 
AS_GPIO


	)

292 #i‚de‡
PB7_FUNC


293 
	#PB7_FUNC
 
AS_GPIO


	)

295 #i‚de‡
PULL_WAKEUP_SRC_PB0


296 
	#PULL_WAKEUP_SRC_PB0
 
PM_PIN_PULLUP_1M


298 #i‚de‡
PULL_WAKEUP_SRC_PB1


	)

299 
	#PULL_WAKEUP_SRC_PB1
 0

	)

301 #i‚de‡
PULL_WAKEUP_SRC_PB2


302 
	#PULL_WAKEUP_SRC_PB2
 0

	)

304 #i‚de‡
PULL_WAKEUP_SRC_PB3


305 
	#PULL_WAKEUP_SRC_PB3
 0

	)

307 #i‚de‡
PULL_WAKEUP_SRC_PB4


308 
	#PULL_WAKEUP_SRC_PB4
 0

	)

310 #i‚de‡
PULL_WAKEUP_SRC_PB5


311 
	#PULL_WAKEUP_SRC_PB5
 0

	)

313 #i‚de‡
PULL_WAKEUP_SRC_PB6


314 
	#PULL_WAKEUP_SRC_PB6
 0

	)

316 #i‚de‡
PULL_WAKEUP_SRC_PB7


317 
	#PULL_WAKEUP_SRC_PB7
 0

	)

321 #i‚de‡
PC0_INPUT_ENABLE


322 
	#PC0_INPUT_ENABLE
 0

	)

324 #i‚de‡
PC1_INPUT_ENABLE


325 
	#PC1_INPUT_ENABLE
 0

	)

327 #i‚de‡
PC2_INPUT_ENABLE


328 
	#PC2_INPUT_ENABLE
 0

	)

330 #i‚de‡
PC3_INPUT_ENABLE


331 
	#PC3_INPUT_ENABLE
 0

	)

333 #i‚de‡
PC4_INPUT_ENABLE


334 
	#PC4_INPUT_ENABLE
 0

	)

336 #i‚de‡
PC5_INPUT_ENABLE


337 
	#PC5_INPUT_ENABLE
 0

	)

339 #i‚de‡
PC6_INPUT_ENABLE


340 
	#PC6_INPUT_ENABLE
 0

	)

342 #i‚de‡
PC7_INPUT_ENABLE


343 
	#PC7_INPUT_ENABLE
 0

	)

345 #i‚de‡
PC0_OUTPUT_ENABLE


346 
	#PC0_OUTPUT_ENABLE
 0

	)

348 #i‚de‡
PC1_OUTPUT_ENABLE


349 
	#PC1_OUTPUT_ENABLE
 0

	)

351 #i‚de‡
PC2_OUTPUT_ENABLE


352 
	#PC2_OUTPUT_ENABLE
 0

	)

354 #i‚de‡
PC3_OUTPUT_ENABLE


355 
	#PC3_OUTPUT_ENABLE
 0

	)

357 #i‚de‡
PC4_OUTPUT_ENABLE


358 
	#PC4_OUTPUT_ENABLE
 0

	)

360 #i‚de‡
PC5_OUTPUT_ENABLE


361 
	#PC5_OUTPUT_ENABLE
 0

	)

363 #i‚de‡
PC6_OUTPUT_ENABLE


364 
	#PC6_OUTPUT_ENABLE
 0

	)

366 #i‚de‡
PC7_OUTPUT_ENABLE


367 
	#PC7_OUTPUT_ENABLE
 0

	)

369 #i‚de‡
PC0_DATA_STRENGTH


370 
	#PC0_DATA_STRENGTH
 1

	)

372 #i‚de‡
PC1_DATA_STRENGTH


373 
	#PC1_DATA_STRENGTH
 1

	)

375 #i‚de‡
PC2_DATA_STRENGTH


376 
	#PC2_DATA_STRENGTH
 1

	)

378 #i‚de‡
PC3_DATA_STRENGTH


379 
	#PC3_DATA_STRENGTH
 1

	)

381 #i‚de‡
PC4_DATA_STRENGTH


382 
	#PC4_DATA_STRENGTH
 1

	)

384 #i‚de‡
PC5_DATA_STRENGTH


385 
	#PC5_DATA_STRENGTH
 1

	)

387 #i‚de‡
PC6_DATA_STRENGTH


388 
	#PC6_DATA_STRENGTH
 1

	)

390 #i‚de‡
PC7_DATA_STRENGTH


391 
	#PC7_DATA_STRENGTH
 1

	)

393 #i‚de‡
PC0_DATA_OUT


394 
	#PC0_DATA_OUT
 0

	)

396 #i‚de‡
PC1_DATA_OUT


397 
	#PC1_DATA_OUT
 0

	)

399 #i‚de‡
PC2_DATA_OUT


400 
	#PC2_DATA_OUT
 0

	)

402 #i‚de‡
PC3_DATA_OUT


403 
	#PC3_DATA_OUT
 0

	)

405 #i‚de‡
PC4_DATA_OUT


406 
	#PC4_DATA_OUT
 0

	)

408 #i‚de‡
PC5_DATA_OUT


409 
	#PC5_DATA_OUT
 0

	)

411 #i‚de‡
PC6_DATA_OUT


412 
	#PC6_DATA_OUT
 0

	)

414 #i‚de‡
PC7_DATA_OUT


415 
	#PC7_DATA_OUT
 0

	)

417 #i‚de‡
PC0_FUNC


418 
	#PC0_FUNC
 
AS_GPIO


	)

420 #i‚de‡
PC1_FUNC


421 
	#PC1_FUNC
 
AS_GPIO


	)

423 #i‚de‡
PC2_FUNC


424 
	#PC2_FUNC
 
AS_GPIO


	)

426 #i‚de‡
PC3_FUNC


427 
	#PC3_FUNC
 
AS_GPIO


	)

429 #i‚de‡
PC4_FUNC


430 
	#PC4_FUNC
 
AS_GPIO


	)

432 #i‚de‡
PC5_FUNC


433 
	#PC5_FUNC
 
AS_GPIO


	)

435 #i‚de‡
PC6_FUNC


436 
	#PC6_FUNC
 
AS_GPIO


	)

438 #i‚de‡
PC7_FUNC


439 
	#PC7_FUNC
 
AS_GPIO


	)

441 #i‚de‡
PULL_WAKEUP_SRC_PC0


442 
	#PULL_WAKEUP_SRC_PC0
 0

	)

444 #i‚de‡
PULL_WAKEUP_SRC_PC1


445 
	#PULL_WAKEUP_SRC_PC1
 0

	)

447 #i‚de‡
PULL_WAKEUP_SRC_PC2


448 
	#PULL_WAKEUP_SRC_PC2
 0

	)

450 #i‚de‡
PULL_WAKEUP_SRC_PC3


451 
	#PULL_WAKEUP_SRC_PC3
 0

	)

453 #i‚de‡
PULL_WAKEUP_SRC_PC4


454 
	#PULL_WAKEUP_SRC_PC4
 0

	)

456 #i‚de‡
PULL_WAKEUP_SRC_PC5


457 
	#PULL_WAKEUP_SRC_PC5
 0

	)

459 #i‚de‡
PULL_WAKEUP_SRC_PC6


460 
	#PULL_WAKEUP_SRC_PC6
 0

	)

462 #i‚de‡
PULL_WAKEUP_SRC_PC7


463 
	#PULL_WAKEUP_SRC_PC7
 0

	)

467 #i‚de‡
PD0_INPUT_ENABLE


468 
	#PD0_INPUT_ENABLE
 0

	)

470 #i‚de‡
PD1_INPUT_ENABLE


471 
	#PD1_INPUT_ENABLE
 0

	)

473 #i‚de‡
PD2_INPUT_ENABLE


474 
	#PD2_INPUT_ENABLE
 0

	)

476 #i‚de‡
PD3_INPUT_ENABLE


477 
	#PD3_INPUT_ENABLE
 0

	)

479 #i‚de‡
PD4_INPUT_ENABLE


480 
	#PD4_INPUT_ENABLE
 0

	)

482 #i‚de‡
PD5_INPUT_ENABLE


483 
	#PD5_INPUT_ENABLE
 0

	)

485 #i‚de‡
PD6_INPUT_ENABLE


486 
	#PD6_INPUT_ENABLE
 0

	)

488 #i‚de‡
PD7_INPUT_ENABLE


489 
	#PD7_INPUT_ENABLE
 0

	)

491 #i‚de‡
PD0_OUTPUT_ENABLE


492 
	#PD0_OUTPUT_ENABLE
 0

	)

494 #i‚de‡
PD1_OUTPUT_ENABLE


495 
	#PD1_OUTPUT_ENABLE
 0

	)

497 #i‚de‡
PD2_OUTPUT_ENABLE


498 
	#PD2_OUTPUT_ENABLE
 0

	)

500 #i‚de‡
PD3_OUTPUT_ENABLE


501 
	#PD3_OUTPUT_ENABLE
 0

	)

503 #i‚de‡
PD4_OUTPUT_ENABLE


504 
	#PD4_OUTPUT_ENABLE
 0

	)

506 #i‚de‡
PD5_OUTPUT_ENABLE


507 
	#PD5_OUTPUT_ENABLE
 0

	)

509 #i‚de‡
PD6_OUTPUT_ENABLE


510 
	#PD6_OUTPUT_ENABLE
 0

	)

512 #i‚de‡
PD7_OUTPUT_ENABLE


513 
	#PD7_OUTPUT_ENABLE
 0

	)

515 #i‚de‡
PD0_DATA_STRENGTH


516 
	#PD0_DATA_STRENGTH
 1

	)

518 #i‚de‡
PD1_DATA_STRENGTH


519 
	#PD1_DATA_STRENGTH
 1

	)

521 #i‚de‡
PD2_DATA_STRENGTH


522 
	#PD2_DATA_STRENGTH
 1

	)

524 #i‚de‡
PD3_DATA_STRENGTH


525 
	#PD3_DATA_STRENGTH
 1

	)

527 #i‚de‡
PD4_DATA_STRENGTH


528 
	#PD4_DATA_STRENGTH
 1

	)

530 #i‚de‡
PD5_DATA_STRENGTH


531 
	#PD5_DATA_STRENGTH
 1

	)

533 #i‚de‡
PD6_DATA_STRENGTH


534 
	#PD6_DATA_STRENGTH
 1

	)

536 #i‚de‡
PD7_DATA_STRENGTH


537 
	#PD7_DATA_STRENGTH
 1

	)

539 #i‚de‡
PD0_DATA_OUT


540 
	#PD0_DATA_OUT
 0

	)

542 #i‚de‡
PD1_DATA_OUT


543 
	#PD1_DATA_OUT
 0

	)

545 #i‚de‡
PD2_DATA_OUT


546 
	#PD2_DATA_OUT
 0

	)

548 #i‚de‡
PD3_DATA_OUT


549 
	#PD3_DATA_OUT
 0

	)

551 #i‚de‡
PD4_DATA_OUT


552 
	#PD4_DATA_OUT
 0

	)

554 #i‚de‡
PD5_DATA_OUT


555 
	#PD5_DATA_OUT
 0

	)

557 #i‚de‡
PD6_DATA_OUT


558 
	#PD6_DATA_OUT
 0

	)

560 #i‚de‡
PD7_DATA_OUT


561 
	#PD7_DATA_OUT
 0

	)

563 #i‚de‡
PD0_FUNC


564 
	#PD0_FUNC
 
AS_GPIO


	)

566 #i‚de‡
PD1_FUNC


567 
	#PD1_FUNC
 
AS_GPIO


	)

569 #i‚de‡
PD2_FUNC


570 
	#PD2_FUNC
 
AS_GPIO


	)

572 #i‚de‡
PD3_FUNC


573 
	#PD3_FUNC
 
AS_GPIO


	)

575 #i‚de‡
PD4_FUNC


576 
	#PD4_FUNC
 
AS_GPIO


	)

578 #i‚de‡
PD5_FUNC


579 
	#PD5_FUNC
 
AS_GPIO


	)

581 #i‚de‡
PD6_FUNC


582 
	#PD6_FUNC
 
AS_GPIO


	)

584 #i‚de‡
PD7_FUNC


585 
	#PD7_FUNC
 
AS_GPIO


	)

587 #i‚de‡
PULL_WAKEUP_SRC_PD0


588 
	#PULL_WAKEUP_SRC_PD0
 0

	)

590 #i‚de‡
PULL_WAKEUP_SRC_PD1


591 
	#PULL_WAKEUP_SRC_PD1
 0

	)

593 #i‚de‡
PULL_WAKEUP_SRC_PD2


594 
	#PULL_WAKEUP_SRC_PD2
 0

	)

596 #i‚de‡
PULL_WAKEUP_SRC_PD3


597 
	#PULL_WAKEUP_SRC_PD3
 0

	)

599 #i‚de‡
PULL_WAKEUP_SRC_PD4


600 
	#PULL_WAKEUP_SRC_PD4
 0

	)

602 #i‚de‡
PULL_WAKEUP_SRC_PD5


603 
	#PULL_WAKEUP_SRC_PD5
 0

	)

605 #i‚de‡
PULL_WAKEUP_SRC_PD6


606 
	#PULL_WAKEUP_SRC_PD6
 0

	)

608 #i‚de‡
PULL_WAKEUP_SRC_PD7


609 
	#PULL_WAKEUP_SRC_PD7
 0

	)

613 #i‚de‡
PE0_INPUT_ENABLE


614 
	#PE0_INPUT_ENABLE
 0

	)

616 #i‚de‡
PE1_INPUT_ENABLE


617 
	#PE1_INPUT_ENABLE
 0

	)

619 #i‚de‡
PE2_INPUT_ENABLE


620 
	#PE2_INPUT_ENABLE
 0

622 #i‚de‡
PE3_INPUT_ENABLE


	)

623 
	#PE3_INPUT_ENABLE
 0

625 #i‚de‡
PE4_INPUT_ENABLE


	)

626 
	#PE4_INPUT_ENABLE
 1

628 #i‚de‡
PE5_INPUT_ENABLE


	)

629 
	#PE5_INPUT_ENABLE
 1

631 #i‚de‡
PE6_INPUT_ENABLE


	)

632 
	#PE6_INPUT_ENABLE
 1

634 #i‚de‡
PE7_INPUT_ENABLE


	)

635 
	#PE7_INPUT_ENABLE
 1

637 #i‚de‡
PE0_OUTPUT_ENABLE


	)

638 
	#PE0_OUTPUT_ENABLE
 0

	)

640 #i‚de‡
PE1_OUTPUT_ENABLE


641 
	#PE1_OUTPUT_ENABLE
 0

	)

643 #i‚de‡
PE2_OUTPUT_ENABLE


644 
	#PE2_OUTPUT_ENABLE
 0

	)

646 #i‚de‡
PE3_OUTPUT_ENABLE


647 
	#PE3_OUTPUT_ENABLE
 0

	)

649 #i‚de‡
PE4_OUTPUT_ENABLE


650 
	#PE4_OUTPUT_ENABLE
 0

	)

652 #i‚de‡
PE5_OUTPUT_ENABLE


653 
	#PE5_OUTPUT_ENABLE
 0

	)

655 #i‚de‡
PE6_OUTPUT_ENABLE


656 
	#PE6_OUTPUT_ENABLE
 0

	)

658 #i‚de‡
PE7_OUTPUT_ENABLE


659 
	#PE7_OUTPUT_ENABLE
 0

	)

661 #i‚de‡
PE0_DATA_STRENGTH


662 
	#PE0_DATA_STRENGTH
 1

	)

664 #i‚de‡
PE1_DATA_STRENGTH


665 
	#PE1_DATA_STRENGTH
 1

	)

667 #i‚de‡
PE2_DATA_STRENGTH


668 
	#PE2_DATA_STRENGTH
 1

	)

670 #i‚de‡
PE3_DATA_STRENGTH


671 
	#PE3_DATA_STRENGTH
 1

	)

673 #i‚de‡
PE4_DATA_STRENGTH


674 
	#PE4_DATA_STRENGTH
 1

	)

676 #i‚de‡
PE5_DATA_STRENGTH


677 
	#PE5_DATA_STRENGTH
 1

	)

679 #i‚de‡
PE6_DATA_STRENGTH


680 
	#PE6_DATA_STRENGTH
 1

	)

682 #i‚de‡
PE7_DATA_STRENGTH


683 
	#PE7_DATA_STRENGTH
 1

	)

685 #i‚de‡
PE0_DATA_OUT


686 
	#PE0_DATA_OUT
 0

	)

688 #i‚de‡
PE1_DATA_OUT


689 
	#PE1_DATA_OUT
 0

	)

691 #i‚de‡
PE2_DATA_OUT


692 
	#PE2_DATA_OUT
 0

	)

694 #i‚de‡
PE3_DATA_OUT


695 
	#PE3_DATA_OUT
 0

	)

697 #i‚de‡
PE4_DATA_OUT


698 
	#PE4_DATA_OUT
 0

	)

700 #i‚de‡
PE5_DATA_OUT


701 
	#PE5_DATA_OUT
 0

	)

703 #i‚de‡
PE6_DATA_OUT


704 
	#PE6_DATA_OUT
 0

	)

706 #i‚de‡
PE7_DATA_OUT


707 
	#PE7_DATA_OUT
 0

	)

709 #i‚de‡
PE0_FUNC


710 
	#PE0_FUNC
 
AS_GPIO


	)

712 #i‚de‡
PE1_FUNC


713 
	#PE1_FUNC
 
AS_GPIO


	)

715 #i‚de‡
PE2_FUNC


716 
	#PE2_FUNC
 
AS_USB


	)

718 #i‚de‡
PE3_FUNC


719 
	#PE3_FUNC
 
AS_USB


	)

721 #i‚de‡
PE4_FUNC


722 
	#PE4_FUNC
 
AS_MSPI


724 #i‚de‡
PE5_FUNC


	)

725 
	#PE5_FUNC
 
AS_MSPI


727 #i‚de‡
PE6_FUNC


	)

728 
	#PE6_FUNC
 
AS_MSPI


730 #i‚de‡
PE7_FUNC


	)

731 
	#PE7_FUNC
 
AS_MSPI


733 #i‚de‡
PULL_WAKEUP_SRC_PE0


	)

734 
	#PULL_WAKEUP_SRC_PE0
 0

	)

736 #i‚de‡
PULL_WAKEUP_SRC_PE1


737 
	#PULL_WAKEUP_SRC_PE1
 0

	)

739 #i‚de‡
PULL_WAKEUP_SRC_PE2


740 
	#PULL_WAKEUP_SRC_PE2
 0

	)

742 #i‚de‡
PULL_WAKEUP_SRC_PE3


743 
	#PULL_WAKEUP_SRC_PE3
 0

	)

745 #i‚de‡
PULL_WAKEUP_SRC_PE4


746 
	#PULL_WAKEUP_SRC_PE4
 0

	)

748 #i‚de‡
PULL_WAKEUP_SRC_PE5


749 
	#PULL_WAKEUP_SRC_PE5
 0

	)

751 #i‚de‡
PULL_WAKEUP_SRC_PE6


752 
	#PULL_WAKEUP_SRC_PE6
 0

	)

754 #i‚de‡
PULL_WAKEUP_SRC_PE7


755 
	#PULL_WAKEUP_SRC_PE7
 0

	)

759 
ölöe
 
	$gpio_™Æog_ªsi°™˚_öô
()

761 
¨eg
 = 
	`™Æog_ªad
 (0x0a) & 0x0f;

763 
	`™Æog_wrôe
 (0x0a, 
¨eg
 | (
PULL_WAKEUP_SRC_PA0
<<4) |

764 (
PULL_WAKEUP_SRC_PA1
<<6));

766 
	`™Æog_wrôe
 (0x0b, 
PULL_WAKEUP_SRC_PA2
 |

767 (
PULL_WAKEUP_SRC_PA3
<<2) |

768 (
PULL_WAKEUP_SRC_PA4
<<4) |

769 (
PULL_WAKEUP_SRC_PA5
<<6));

771 
	`™Æog_wrôe
 (0x0c, 
PULL_WAKEUP_SRC_PA6
 |

772 (
PULL_WAKEUP_SRC_PA7
<<2) |

773 (
PULL_WAKEUP_SRC_PB0
<<4) |

774 (
PULL_WAKEUP_SRC_PB1
<<6));

776 
	`™Æog_wrôe
 (0x0d, 
PULL_WAKEUP_SRC_PB2
 |

777 (
PULL_WAKEUP_SRC_PB3
<<2) |

778 (
PULL_WAKEUP_SRC_PB4
<<4) |

779 (
PULL_WAKEUP_SRC_PB5
<<6));

781 
	`™Æog_wrôe
 (0x0e, 
PULL_WAKEUP_SRC_PB6
 |

782 (
PULL_WAKEUP_SRC_PB7
<<2) |

783 (
PULL_WAKEUP_SRC_PC0
<<4) |

784 (
PULL_WAKEUP_SRC_PC1
<<6));

786 
	`™Æog_wrôe
 (0x0f, 
PULL_WAKEUP_SRC_PC2
 |

787 (
PULL_WAKEUP_SRC_PC3
<<2) |

788 (
PULL_WAKEUP_SRC_PC4
<<4) |

789 (
PULL_WAKEUP_SRC_PC5
<<6));

791 
	`™Æog_wrôe
 (0x10, 
PULL_WAKEUP_SRC_PC6
 |

792 (
PULL_WAKEUP_SRC_PC7
<<2) |

793 (
PULL_WAKEUP_SRC_PD0
<<4) |

794 (
PULL_WAKEUP_SRC_PD1
<<6));

796 
	`™Æog_wrôe
 (0x11, 
PULL_WAKEUP_SRC_PD2
 |

797 (
PULL_WAKEUP_SRC_PD3
<<2) |

798 (
PULL_WAKEUP_SRC_PD4
<<4) |

799 (
PULL_WAKEUP_SRC_PD5
<<6));

801 
	`™Æog_wrôe
 (0x12, 
PULL_WAKEUP_SRC_PD6
 |

802 (
PULL_WAKEUP_SRC_PD7
<<2) |

803 (
PULL_WAKEUP_SRC_PE0
<<4) |

804 (
PULL_WAKEUP_SRC_PE1
<<6));

806 
¨eg
 = 
	`™Æog_ªad
 (0x08) & 0x0f;

807 
	`™Æog_wrôe
 (0x08, 
¨eg
 | 
PULL_WAKEUP_SRC_PE2
<<4 |

808 (
PULL_WAKEUP_SRC_PE3
<<6) );

809 
	}
}

811 
ölöe
 
	$gpio_öô
(
™aRes_öô_í
)

814 
ªg_gpio_∑_£âög1
 =

815 (
PA0_INPUT_ENABLE
<<8Ë| (
PA1_INPUT_ENABLE
<<9Ë| (
PA2_INPUT_ENABLE
<<10Ë| (
PA3_INPUT_ENABLE
<<11) |

816 (
PA4_INPUT_ENABLE
<<12Ë| (
PA5_INPUT_ENABLE
<<13Ë| (
PA6_INPUT_ENABLE
<<14Ë| (
PA7_INPUT_ENABLE
<<15) |

817 ((
PA0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PA1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PA2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PA3_OUTPUT_ENABLE
?0:1)<<19) |

818 ((
PA4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PA5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PA6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PA7_OUTPUT_ENABLE
?0:1)<<23) |

819 (
PA0_DATA_OUT
<<24Ë| (
PA1_DATA_OUT
<<25Ë| (
PA2_DATA_OUT
<<26Ë| (
PA3_DATA_OUT
<<27) |

820 (
PA4_DATA_OUT
<<28Ë| (
PA5_DATA_OUT
<<29Ë| (
PA6_DATA_OUT
<<30Ë| (
PA7_DATA_OUT
<<31) ;

821 
ªg_gpio_∑_£âög2
 =

822 (
PA0_DATA_STRENGTH
<<8Ë| (
PA1_DATA_STRENGTH
<<9)| (
PA2_DATA_STRENGTH
<<10Ë| (
PA3_DATA_STRENGTH
<<11) |

823 (
PA4_DATA_STRENGTH
<<12Ë| (
PA5_DATA_STRENGTH
<<13Ë| (
PA6_DATA_STRENGTH
<<14Ë| (
PA7_DATA_STRENGTH
<<15) |

824 (
PA0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PA1_FUNC
==AS_GPIO ? BIT(17):0)| (
PA2_FUNC
==AS_GPIO ? BIT(18):0)| (
PA3_FUNC
==AS_GPIO ? BIT(19):0) |

825 (
PA4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PA5_FUNC
==AS_GPIO ? BIT(21):0)| (
PA6_FUNC
==AS_GPIO ? BIT(22):0)| (
PA7_FUNC
==AS_GPIO ? BIT(23):0);

827 
ªg_gpio_pb_£âög1
 =

828 (
PB0_INPUT_ENABLE
<<8Ë| (
PB1_INPUT_ENABLE
<<9Ë| (
PB2_INPUT_ENABLE
<<10Ë| (
PB3_INPUT_ENABLE
<<11) |

829 (
PB4_INPUT_ENABLE
<<12Ë| (
PB5_INPUT_ENABLE
<<13)| (
PB6_INPUT_ENABLE
<<14Ë| (
PB7_INPUT_ENABLE
<<15) |

830 ((
PB0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PB1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PB2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PB3_OUTPUT_ENABLE
?0:1)<<19) |

831 ((
PB4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PB5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PB6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PB7_OUTPUT_ENABLE
?0:1)<<23) |

832 (
PB0_DATA_OUT
<<24Ë| (
PB1_DATA_OUT
<<25Ë| (
PB2_DATA_OUT
<<26Ë| (
PB3_DATA_OUT
<<27) |

833 (
PB4_DATA_OUT
<<28Ë| (
PB5_DATA_OUT
<<29Ë| (
PB6_DATA_OUT
<<30Ë| (
PB7_DATA_OUT
<<31) ;

834 
ªg_gpio_pb_£âög2
 =

835 (
PB0_DATA_STRENGTH
<<8Ë| (
PB1_DATA_STRENGTH
<<9Ë| (
PB2_DATA_STRENGTH
<<10Ë| (
PB3_DATA_STRENGTH
<<11) |

836 (
PB4_DATA_STRENGTH
<<12Ë| (
PB5_DATA_STRENGTH
<<13Ë| (
PB6_DATA_STRENGTH
<<14Ë| (
PB7_DATA_STRENGTH
<<15) |

837 (
PB0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PB1_FUNC
==AS_GPIO ? BIT(17):0)| (
PB2_FUNC
==AS_GPIO ? BIT(18):0)| (
PB3_FUNC
==AS_GPIO ? BIT(19):0) |

838 (
PB4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PB5_FUNC
==AS_GPIO ? BIT(21):0)| (
PB6_FUNC
==AS_GPIO ? BIT(22):0)| (
PB7_FUNC
==AS_GPIO ? BIT(23):0);

840 
ªg_gpio_pc_£âög1
 =

841 (
PC0_INPUT_ENABLE
<<8Ë| (
PC1_INPUT_ENABLE
<<9Ë| (
PC2_INPUT_ENABLE
<<10Ë| (
PC3_INPUT_ENABLE
<<11) |

842 (
PC4_INPUT_ENABLE
<<12Ë| (
PC5_INPUT_ENABLE
<<13)| (
PC6_INPUT_ENABLE
<<14Ë| (
PC7_INPUT_ENABLE
<<15) |

843 ((
PC0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PC1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PC2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PC3_OUTPUT_ENABLE
?0:1)<<19) |

844 ((
PC4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PC5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PC6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PC7_OUTPUT_ENABLE
?0:1)<<23) |

845 (
PC0_DATA_OUT
<<24Ë| (
PC1_DATA_OUT
<<25Ë| (
PC2_DATA_OUT
<<26Ë| (
PC3_DATA_OUT
<<27) |

846 (
PC4_DATA_OUT
<<28Ë| (
PC5_DATA_OUT
<<29Ë| (
PC6_DATA_OUT
<<30Ë| (
PC7_DATA_OUT
<<31) ;

847 
ªg_gpio_pc_£âög2
 =

848 (
PC0_DATA_STRENGTH
<<8Ë| (
PC1_DATA_STRENGTH
<<9Ë| (
PC2_DATA_STRENGTH
<<10Ë| (
PC3_DATA_STRENGTH
<<11) |

849 (
PC4_DATA_STRENGTH
<<12Ë| (
PC5_DATA_STRENGTH
<<13Ë| (
PC6_DATA_STRENGTH
<<14Ë| (
PC7_DATA_STRENGTH
<<15) |

850 (
PC0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PC1_FUNC
==AS_GPIO ? BIT(17):0)| (
PC2_FUNC
==AS_GPIO ? BIT(18):0)| (
PC3_FUNC
==AS_GPIO ? BIT(19):0) |

851 (
PC4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PC5_FUNC
==AS_GPIO ? BIT(21):0)| (
PC6_FUNC
==AS_GPIO ? BIT(22):0)| (
PC7_FUNC
==AS_GPIO ? BIT(23):0);

853 
ªg_gpio_pd_£âög1
 =

854 (
PD0_INPUT_ENABLE
<<8Ë| (
PD1_INPUT_ENABLE
<<9Ë| (
PD2_INPUT_ENABLE
<<10Ë| (
PD3_INPUT_ENABLE
<<11) |

855 (
PD4_INPUT_ENABLE
<<12Ë| (
PD5_INPUT_ENABLE
<<13)| (
PD6_INPUT_ENABLE
<<14Ë| (
PD7_INPUT_ENABLE
<<15) |

856 ((
PD0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PD1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PD2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PD3_OUTPUT_ENABLE
?0:1)<<19) |

857 ((
PD4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PD5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PD6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PD7_OUTPUT_ENABLE
?0:1)<<23) |

858 (
PD0_DATA_OUT
<<24Ë| (
PD1_DATA_OUT
<<25Ë| (
PD2_DATA_OUT
<<26Ë| (
PD3_DATA_OUT
<<27) |

859 (
PD4_DATA_OUT
<<28Ë| (
PD5_DATA_OUT
<<29Ë| (
PD6_DATA_OUT
<<30Ë| (
PD7_DATA_OUT
<<31) ;

860 
ªg_gpio_pd_£âög2
 =

861 (
PD0_DATA_STRENGTH
<<8Ë| (
PD1_DATA_STRENGTH
<<9Ë| (
PD2_DATA_STRENGTH
<<10Ë| (
PD3_DATA_STRENGTH
<<11) |

862 (
PD4_DATA_STRENGTH
<<12Ë| (
PD5_DATA_STRENGTH
<<13Ë| (
PD6_DATA_STRENGTH
<<14Ë| (
PD7_DATA_STRENGTH
<<15) |

863 (
PD0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PD1_FUNC
==AS_GPIO ? BIT(17):0)| (
PD2_FUNC
==AS_GPIO ? BIT(18):0)| (
PD3_FUNC
==AS_GPIO ? BIT(19):0) |

864 (
PD4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PD5_FUNC
==AS_GPIO ? BIT(21):0)| (
PD6_FUNC
==AS_GPIO ? BIT(22):0)| (
PD7_FUNC
==AS_GPIO ? BIT(23):0);

866 
ªg_gpio_≥_£âög1
 =

867 (
PE0_INPUT_ENABLE
<<8Ë| (
PE1_INPUT_ENABLE
<<9Ë| (
PE2_INPUT_ENABLE
<<10Ë| (
PE3_INPUT_ENABLE
<<11) |

868 (
PE4_INPUT_ENABLE
<<12Ë| (
PE5_INPUT_ENABLE
<<13)| (
PE6_INPUT_ENABLE
<<14Ë| (
PE7_INPUT_ENABLE
<<15) |

869 ((
PE0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PE1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PE2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PE3_OUTPUT_ENABLE
?0:1)<<19) |

870 ((
PE4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PE5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PE6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PE7_OUTPUT_ENABLE
?0:1)<<23) |

871 (
PE0_DATA_OUT
<<24Ë| (
PE1_DATA_OUT
<<25Ë| (
PE2_DATA_OUT
<<26Ë| (
PE3_DATA_OUT
<<27) |

872 (
PE4_DATA_OUT
<<28Ë| (
PE5_DATA_OUT
<<29Ë| (
PE6_DATA_OUT
<<30Ë| (
PE7_DATA_OUT
<<31);

873 
ªg_gpio_≥_£âög2
 =

874 (
PE0_DATA_STRENGTH
<<8Ë| (
PE1_DATA_STRENGTH
<<9Ë| (
PE2_DATA_STRENGTH
<<10Ë| (
PE3_DATA_STRENGTH
<<11) |

875 (
PE4_DATA_STRENGTH
<<12Ë| (
PE5_DATA_STRENGTH
<<13Ë| (
PE6_DATA_STRENGTH
<<14Ë| (
PE7_DATA_STRENGTH
<<15) |

876 (
PE0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PE1_FUNC
==AS_GPIO ? BIT(17):0)| (
PE2_FUNC
==AS_GPIO ? BIT(18):0)| (
PE3_FUNC
==AS_GPIO ? BIT(19):0) |

877 (
PE4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PE5_FUNC
==AS_GPIO ? BIT(21):0)| (
PE6_FUNC
==AS_GPIO ? BIT(22):0)| (
PE7_FUNC
==AS_GPIO ? BIT(23):0);

880 if(
™aRes_öô_í
){

881 
	`gpio_™Æog_ªsi°™˚_öô
();

883 
	}
}

	@platform/chip_826x/i2c.h

24 #i‚de‡
I2C_H


25 
	#I2C_H


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

34 
	mI2C_PIN_GPIOA
 = 0,

35 
	mI2C_PIN_GPIOB
,

36 
	mI2C_PIN_GPIOC
,

37 } 
	tI2C_GPIO_GroupTy≥Def
;

44 
	mI2C_SLAVE_DMA
 = 0,

45 
	mI2C_SLAVE_MAP
,

46 }
	tI2C_SœveMode
;

55 
I2C_PöSñe˘
(
I2C_GPIO_GroupTy≥Def
 
PöGΩ
);

62 
I2C_SëId
(
SœveID
);

70 
I2C_Ma°îInô
(
DivClock
);

80 
I2C_SœveInô
(
devi˚_ID
,
I2C_SœveMode
 
mode
,* 
pBuf
);

90 
I2C_WrôeByã
(
Addr
, 
AddrLí
, 
D©a
);

99 
I2C_RódByã
(
Addr
, 
AddrLí
);

109 
I2C_WrôeSîõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

119 
I2C_RódSîõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

127 
I2C_WrôeD©aSœveM≠pög
(* 
pbuf
,
bufLí
);

134 
I2C_RódD©aSœveM≠pög
(* 
pbuf
,
bufLí
);

	@platform/chip_826x/irq.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"bô.h
"

31 
ölöe
 
	$úq_íabÀ
(){

32 
r
 = 
ªg_úq_í
;

33 
ªg_úq_í
 = 1;

34  
r
;

35 
	}
}

37 
ölöe
 
	$úq_dißbÀ
(){

38 
r
 = 
ªg_úq_í
;

39 
ªg_úq_í
 = 0;

40  
r
;

41 
	}
}

43 
ölöe
 
	$úq_ª°‹e
(
í
){

44 
ªg_úq_í
 = 
í
;

45 
	}
}

47 
ölöe
 
	$úq_gë_mask
(){

48  
ªg_úq_mask
;

49 
	}
}

51 
ölöe
 
	$úq_£t_mask
(
msk
){

52 
	`SET_FLD
(
ªg_úq_mask
, 
msk
);

53 
	}
}

55 
ölöe
 
	$úq_˛r_mask
(
msk
){

56 
	`CLR_FLD
(
ªg_úq_mask
, 
msk
);

57 
	}
}

59 
ölöe
 
	$úq_gë_§c
(){

60  
ªg_úq_§c
;

61 
	}
}

63 
ölöe
 
	$úq_˛r_Æl_§c
(){

64 
ªg_úq_§c
 = 
ONES_32
;

65 
	}
}

67 
ölöe
 
	$úq_íabÀ_ty≥
(
msk
){

68 
	`úq_£t_mask
(
msk
);

69 
	}
}

71 
ölöe
 
	$úq_dißbÀ_ty≥
(
msk
){

72 
	`úq_˛r_mask
(
msk
);

73 
	}
}

75 
ölöe
 
	$úq_öô
(
úq_mask
){

76 
ªg_úq_mask
 = 
úq_mask
;

77 
	}
}

79 
ölöe
 
	$dma_öô
(
dma_mask
){

80 
ªg_dma_chn_úq_msk
 = 
dma_mask
;

81 
	}
}

83 
ölöe
 
	$dma_úq_˛ór
(){

84 
ªg_dma_chn_úq_msk
 = 0;

85 
	}
}

87 
ölöe
 
	$dma_úq_íabÀ
(
msk
)

89 
ªg_dma_chn_úq_msk
 |
msk
;

90 
	}
}

92 
ölöe
 
	$dma_úq_dißbÀ
(
msk
)

94 
ªg_dma_chn_úq_msk
 &~
msk
;

95 
	}
}

97 
ölöe
 
	$dma_ch™√l_íabÀ_Æl
(){

98 
ªg_dma_chn_í
 = 0xff;

99 
	}
}

101 
ölöe
 
	$dma_ch™√l_dißbÀ_Æl
(){

102 
ªg_dma_chn_í
 = 0;

103 
	}
}

110 
ölöe
 
	$rf_úq_§c_gë
(){

111  
ªg_rf_úq_°©us
;

112 
	}
}

114 
ölöe
 
	$rf_úq_˛r_§c
(
msk
)

116 
ªg_rf_úq_°©us
 = 
msk
;

117 
	}
}

124 
ölöe
 
	$dma_chn_úq_°©us_gë
(){

125  
ªg_dma_úq_§c
;

126 
	}
}

133 
ölöe
 
	$dma_chn_úq_°©us_˛r
(
úq_°©us
){

134 
ªg_dma_úq_§c
 = 
úq_°©us
;

135 
	}
}

	@platform/chip_826x/pm.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"gpio.h
"

31 
	#DEEP_ANA_REG0
 0x3A

32 
	#DEEP_ANA_REG1
 0x3B

33 

	)

35 
	#DEEP_ANA_REG4
 0x34

36 
	#DEEP_ANA_REG5
 0x35

37 
	#DEEP_ANA_REG6
 0x36

38 
	#DEEP_ANA_REG7
 0x37

39 
	#DEEP_ANA_REG8
 0x38

40 
	#DEEP_ANA_REG9
 0x39

41 

	)

43 
	#SYS_NEED_REINIT_EXT32K
 
	`BIT
(0)

	)

44 
	#SYS_DEEP_SLEEP_FLAG
 
	`BIT
(1)

	)

47 
	#SYS_DEEP_ANA_REG
 
DEEP_ANA_REG1


	)

52 
	mPM_WAKEUP_CORE
 = 
BIT
(5),

53 
	mPM_WAKEUP_TIMER
 = 
BIT
(6),

54 
	mPM_WAKEUP_COMP
 = 
BIT
(7),

55 
	mPM_WAKEUP_PAD
 = 
BIT
(8),

60 
	mWAKEUP_PC3_GRP0
 = 
BIT
(0),

61 
	mWAKEUP_PC4_GRP0
 = 
BIT
(1),

62 
	mWAKEUP_PC5_GRP0
 = 
BIT
(2),

63 
	mWAKEUP_PD0_GRP0
 = 
BIT
(3),

64 
	mWAKEUP_PD1_GRP1
 = 
BIT
(4),

65 
	mWAKEUP_PD2_GRP1
 = 
BIT
(5),

66 
	mWAKEUP_PD3_GRP1
 = 
BIT
(6),

67 
	mWAKEUP_PD4_GRP1
 = 
BIT
(7),

68 
	mWAKEUP_PD5_GRP2
 = 
BIT
(8),

69 
	mWAKEUP_PD6_GRP2
 = 
BIT
(9),

70 
	mWAKEUP_PD7_GRP2
 = 
BIT
(10),

71 
	mWAKEUP_PA0_GRP2
 = 
BIT
(11),

72 
	mWAKEUP_PA1_GRP3
 = 
BIT
(12),

73 
	mWAKEUP_PA2_GRP3
 = 
BIT
(13),

74 
	mWAKEUP_PA3_GRP3
 = 
BIT
(14),

75 
	mWAKEUP_PA4_GRP3
 = 
BIT
(15),

76 
	mWAKEUP_PA7_GRP4
 = 
BIT
(16),

77 
	mWAKEUP_PC6_GRP4
 = 
BIT
(17),

78 
	mWAKEUP_PC7_GRP4
 = 
BIT
(18),

79 
	mWAKEUP_PE0_GRP4
 = 
BIT
(19),

80 
	mWAKEUP_PE1_GRP5
 = 
BIT
(20),

81 
	mWAKEUP_PE2_GRP5
 = 
BIT
(21),

82 
	mWAKEUP_PA5_GRP5
 = 
BIT
(22),

83 
	mWAKEUP_PA6_GRP5
 = 
BIT
(23),

87 
	mWAKEUP_GRP0_POS_EDG
 = 0,

88 
	mWAKEUP_GRP1_POS_EDG
 = 0,

89 
	mWAKEUP_GRP2_POS_EDG
 = 0,

90 
	mWAKEUP_GRP3_POS_EDG
 = 0,

91 
	mWAKEUP_GRP4_POS_EDG
 = 0,

92 
	mWAKEUP_GRP5_POS_EDG
 = 0,

94 
	mWAKEUP_GRP0_NEG_EDG
 = 
BIT
(0),

95 
	mWAKEUP_GRP1_NEG_EDG
 = 
BIT
(1),

96 
	mWAKEUP_GRP2_NEG_EDG
 = 
BIT
(2),

97 
	mWAKEUP_GRP3_NEG_EDG
 = 
BIT
(3),

98 
	mWAKEUP_GRP4_NEG_EDG
 = 
BIT
(4),

99 
	mWAKEUP_GRP5_NEG_EDG
 = 
BIT
(5),

103 
	mWAKEUP_SRC_PAD
 = 
BIT
(4),

104 
	mWAKEUP_SRC_DIG_GPIO
 = 
BIT
(5) | 0x0800,

105 
	mWAKEUP_SRC_DIG_USB
 = 
BIT
(5) | 0x0400,

106 
	mWAKEUP_SRC_TIMER
 = 
BIT
(6),

107 
	mWAKEUP_SRC_COMP
 = 
BIT
(7),

108 }
	tWakeupSrc_Ty≥Def
;

111 
	mLOWPWR_SUSPEND
 = 0,

112 
	mLOWPWR_DEEPSLEEP
 = 1,

116 
	mSUSPEND_MODE
 = 0,

117 
	mDEEPSLEEP_MODE
 = 1,

121 
	mMCU_STATUS_BOOT
 = 0,

122 
	mMCU_STATUS_DEEP_BACK
 = 1,

125 
pm_mcu_°©us
;

127 
ölöe
 
	$pm_gë_mcu_°©us
()

129  
pm_mcu_°©us
;

130 
	}
}

132 
PM_PadSë
(
GPIO_PöTy≥Def
 
pö
, 
pﬁ
, 
í
);

133 
PM_GPIOSë
(
GPIO_PöTy≥Def
 
pö
, 
pﬁ
, 
í
);

134 
pm_¶ìp_wakeup
(
DìpSÀï
, 
WakeupSrc
, 
WakeupTick
);

135 
pm_l⁄g_¶ìp_wakeup
(
DìpSÀï
, 
WakeupSrc
, 
WakeupTick
);

136 
˝u_wakeup_öô
();

137 
¶ìp_°¨t
();

138 
su•íd_°¨t
();

139 
pm_gë_32k_tick
();

	@platform/chip_826x/pwm.h

24 #i‚de‡
PWM_H


25 
	#PWM_H


	)

28 
	#PWM0_CFG_GPIO_A0
(Ëdo{\

	)

32 
	#PWM0_CFG_GPIO_C0
(Ëdo{\

	)

35 
	}

	$}whûe
(0)

36 
	#PWM0_CFG_GPIO_D5
(Ëdo{\

	)

38 
	}

	$}whûe
(0)

39 
	#PWM0_CFG_GPIO_E0
(Ëdo{\

	)

42 
	}

	$}whûe
(0)

45 
	#PWM1_CFG_GPIO_A3
(Ëdo{\

	)

48 
	}

	$}whûe
(0)

49 
	#PWM1_CFG_GPIO_C1
(Ëdo{\

	)

52 
	}

	$}whûe
(0)

53 
	#PWM1_CFG_GPIO_D6
(Ëdo{\

	)

55 
	}

	$}whûe
(0)

56 
	#PWM1_CFG_GPIO_E1
(Ëdo{\

	)

59 
	}

	$}whûe
(0)

62 
	#PWM2_CFG_GPIO_B0
(Ëdo{\

	)

65 
	}

	$}whûe
(0)

66 
	#PWM2_CFG_GPIO_C2
(Ëdo{\

	)

69 
	}

	$}whûe
(0)

70 
	#PWM2_CFG_GPIO_D7
(Ëdo{\

	)

72 
	}

	$}whûe
(0)

75 
	#PWM3_CFG_GPIO_B2
(Ëdo{\

	)

78 
	}

	$}whûe
(0)

79 
	#PWM3_CFG_GPIO_C3
(Ëdo{\

	)

82 
	}

	$}whûe
(0)

85 
	#PWM4_CFG_GPIO_B4
(Ëdo{\

	)

88 
	}

	$}whûe
(0)

89 
	#PWM4_CFG_GPIO_C4
(Ëdo{\

	)

92 
	}

	$}whûe
(0)

95 
	#PWM5_CFG_GPIO_B6
(Ëdo{\

	)

98 
	}

	$}whûe
(0)

99 
	#PWM5_CFG_GPIO_C5
(Ëdo{\

	)

102 
	}

	$}whûe
(0)

105 
	#PWM0N_CFG_GPIO_A2
(Ëdo{\

	)

108 
	}

	$}whûe
(0)

111 
	#PWM1N_CFG_GPIO_A4
(Ëdo{\

	)

114 
	}

	$}whûe
(0)

117 
	#PWM2N_CFG_GPIO_A5
(Ëdo{\

	)

120 
	}

	$}whûe
(0)

121 
	#PWM2N_CFG_GPIO_B1
(Ëdo{\

	)

124 
	}

	$}whûe
(0)

127 
	#PWM3N_CFG_GPIO_B3
(Ëdo{\

	)

130 
	}

	$}whûe
(0)

133 
	#PWM4N_CFG_GPIO_B5
(Ëdo{\

	)

136 
	}

	$}whûe
(0)

139 
	#PWM5N_CFG_GPIO_B7
(Ëdo{\

	)

142 
	}

	$}whûe
(0)

146 
	#EN_PWM
(
v
Ë(*(vﬁ©ûê*)0x800780 |(1<<v))

	)

149 
	#DIS_PWM
(
v
Ë(*(vﬁ©ûê*)0x800780 &~(1<<v))

	)

155 
	ePWMN
{

156 
PWM0
 = 0,

157 
PWM1
,

158 
PWM2
,

159 
PWM3
,

160 
PWM4
,

161 
PWM5
,

169 
	ePWMWM
{

170 
NORMAL
,

171 
COUNT
,

172 
IR
 = 0x03,

188 
	ePWMIRQSOURCE
{

189 
NOIRQ
 = 0xff,

190 
PWM0PNUM
 = 0,

191 
PWM1PNUM
,

192 
PWM0CYCLEDONE
,

193 
PWM1CYCLEDONE
,

194 
PWM2CYCLEDONE
,

195 
PWM3CYCLEDONE
,

196 
PWM4CYCLEDONE
,

197 
PWM5CYCLEDONE
,

198 
PWMIRQSOURCENUM
,

210 
	`pwm_Inô
(
pwmCLKdiv
);

225 
	`pwm_O≥n
(
PWMN
 
pwmNumbî
, 
PWMWM
 
pwmW‹kM
, 
pha£Time
, 
cscVÆue
, 
cycVÆue
, 
sfVÆue
 );

236 
	`pwm_Clo£
(
PWMN
 
pwmNumbî
);

247 
	`pwm_Sèπ
(
PWMN
 
pwmNumbî
);

258 
	`pwm_St›
(
PWMN
 
pwmNumbî
);

271 
	`pwm_DutyCy˛eSë
(
PWMN
 
pwmNumbî
, 
csVÆue
,
cycVÆue
);

281 
	`pwm_I¡îru±E«bÀ
(
PWMIRQSOURCE
 
pwmIrqSrc
);

291 
	`pwm_I¡îru±DißbÀ
(
PWMIRQSOURCE
 
pwmIrqSrc
);

300 
PWMIRQSOURCE
 
	`pwm_I¡îru±Sour˚Gë
();

310 
	`pwm_I¡îru±SètusCÃ
(
PWMIRQSOURCE
 
úq_§c
);

320 
	`pwm_INVInvît
(
PWMN
 
pwmNumbî
);

330 
	`pwm_Invît
(
PWMN
 
pwmNumbî
);

	@platform/chip_826x/register.h

24 #¥agm®
⁄˚


26 #i‡
deföed
(
__˝lu•lus
)

30 
	~"bô.h
"

31 
	~"b•.h
"

36 
	#ªg_i2c_£t
 
	`REG_ADDR32
(0x00)

	)

37 
	#ªg_i2c_•ìd
 
	`REG_ADDR8
(0x00)

	)

38 
	#ªg_i2c_id
 
	`REG_ADDR8
(0x01)

	)

39 
	#ªg_i2c_°©us
 
	`REG_ADDR8
(0x02)

	)

41 
FLD_I2C_CMD_BUSY
 = 
BIT
(0),

42 
FLD_I2C_BUS_BUSY
 = 
BIT
(1),

43 
FLD_I2C_NAK
 = 
BIT
(2),

46 
	#ªg_i2c_mode
 
	`REG_ADDR8
(0x03)

	)

48 
FLD_I2C_ADDR_AUTO
 = 
BIT
(0),

49 
FLD_I2C_MODE_MASTER
 = 
BIT
(1),

50 
FLD_I2C_MEM_MAP
 = 
BIT
(2),

53 
	#ªg_i2c_adr_d©
 
	`REG_ADDR16
(0x04)

	)

54 
	#ªg_i2c_d©_˘æ
 
	`REG_ADDR32
(0x04)

	)

55 
	#ªg_i2c_di_˘æ
 
	`REG_ADDR16
(0x06)

	)

56 
	#ªg_i2c_adr
 
	`REG_ADDR8
(0x04)

	)

57 
	#ªg_i2c_do
 
	`REG_ADDR8
(0x05)

	)

58 
	#ªg_i2c_di
 
	`REG_ADDR8
(0x06)

	)

59 
	#ªg_i2c_˘æ
 
	`REG_ADDR8
(0x07)

	)

61 
FLD_I2C_CMD_ID
 = 
BIT
(0),

62 
FLD_I2C_CMD_ADR
 = 
BIT
(1),

63 
FLD_I2C_CMD_DO
 = 
BIT
(2),

64 
FLD_I2C_CMD_DI
 = 
BIT
(3),

65 
FLD_I2C_CMD_START
 = 
BIT
(4),

66 
FLD_I2C_CMD_STOP
 = 
BIT
(5),

67 
FLD_I2C_CMD_READ_ID
 = 
BIT
(6),

68 
FLD_I2C_CMD_NAK
 = 
BIT
(7),

74 
	#ªg_•i_d©a
 
	`REG_ADDR8
(0x08)

	)

75 
	#ªg_•i_˘æ
 
	`REG_ADDR8
(0x09)

	)

77 
FLD_SPI_CS
 = 
BIT
(0),

78 
FLD_SPI_MASTER_MODE_EN
 = 
BIT
(1),

79 
FLD_SPI_DATA_OUT_DIS
 = 
BIT
(2),

80 
FLD_SPI_RD
 = 
BIT
(3),

81 
FLD_SPI_ADDR_AUTO
 = 
BIT
(4),

82 
FLD_SPI_BUSY
 = 
BIT
(6),

84 
	#ªg_•i_•
 
	`REG_ADDR8
(0x0a)

	)

86 
FLD_MASTER_SPI_CLK
 = 
BIT_RNG
(0,6),

87 
FLD_SPI_ENABLE
 = 
BIT
(7),

88 
FLD_SPI_PAD_SEL
 = 
BIT
(7),

91 
	#ªg_•i_öv_˛k
 
	`REG_ADDR8
(0x0b)

	)

96 
	#ªg_ma°î_•i_d©a
 
	`REG_ADDR8
(0x0c)

	)

97 
	#ªg_ma°î_•i_˘æ
 
	`REG_ADDR8
(0x0d)

	)

100 
FLD_MASTER_SPI_CS
 = 
BIT
(0),

101 
FLD_MASTER_SPI_SDO
 = 
BIT
(1),

102 
FLD_MASTER_SPI_CONT
 = 
BIT
(2),

103 
FLD_MASTER_SPI_RD
 = 
BIT
(3),

104 
FLD_MASTER_SPI_BUSY
 = 
BIT
(4),

111 
	#ªg_Ÿp_addr_∑ø
 
	`REG_ADDR16
(0x10)

	)

113 
FLD_OTP_PARA_ADDR
 = 
BIT_RNG
(0,12),

114 
FLD_OTP_PARA_PTM
 = 
BIT_RNG
(13,15),

117 
	#ªg_Ÿp_˘æ
 
	`REG_ADDR8
(0x12)

	)

119 
FLD_OTP_CTRL_PCEN
 = 
BIT
(0),

120 
FLD_OTP_FAST_CLK
 = 
BIT
(1),

121 
FLD_OTP_OEN
 = 
BIT
(2),

122 
FLD_OTP_CLK
 = 
BIT
(3),

123 
FLD_OTP_PCEN_PWDN
 = 
BIT
(4),

124 
FLD_OTP_WEN_PWDN
 = 
BIT
(5),

125 
FLD_OTP_OEN_PWDN
 = 
BIT
(6),

126 
FLD_OTP_CLK_PWDN
 = 
BIT
(7),

129 
	#ªg_Ÿp_byã_d©
 
	`REG_ADDR8
(0x13)

	)

130 
	#ªg_Ÿp_d©
 
	`REG_ADDR32
(0x14)

	)

131 
	#ªg_Ÿp_blk_code
 
	`REG_ADDR8
(0x18)

	)

133 
	#ªg_i2c_úq_°©us
 
	`REG_ADDR8
(0x21)

	)

134 
	#ªg_i2c_˛r_°©us
 
	`REG_ADDR8
(0x22)

	)

136 
FLD_I2C_STATUS_WR
 = 
BIT
(1),

137 
FLD_I2C_STATUS_RD
 = 
BIT
(2),

145 
	#ªg_adc_pga_£l_m
 
	`REG_ADDR8
(0x28)

	)

146 
	#ªg_adc_pga_£l_l
 
	`REG_ADDR8
(0x29)

	)

147 
	#ªg_adc_pga_£l_r
 
	`REG_ADDR8
(0x2a)

	)

149 
	#ªg_adc_ªf
 
	`REG_ADDR8
(0x2b)

	)

151 
FLD_ADC_REF_M
 = 
BIT_RNG
(0,1),

152 
FLD_ADC_REF_L
 = 
BIT_RNG
(2,3),

153 
FLD_ADC_REF_R
 = 
BIT_RNG
(4,5),

157 
	#ªg_adc_chn_m_£l
 
	`REG_ADDR8
(0x2c)

	)

158 
	#ªg_adc_chn_l_£l
 
	`REG_ADDR8
(0x2d)

	)

159 
	#ªg_adc_chn_r_£l
 
	`REG_ADDR8
(0x2e)

	)

161 
FLD_ADC_CHN_SEL
 = 
BIT_RNG
(0,4),

162 
FLD_ADC_DIFF_CHN_SEL
 = 
BIT_RNG
(5,7),

166 
FLD_ADC_CHN_D0
 = 0x01,

167 
FLD_ADC_CHN_D1
 = 0x02,

168 
FLD_ADC_CHN_D2
 = 0x03,

169 
FLD_ADC_CHN_D3
 = 0x04,

170 
FLD_ADC_CHN_D4
 = 0x05,

171 
FLD_ADC_CHN_D5
 = 0x06,

172 
FLD_ADC_CHN_C2
 = 0x07,

173 
FLD_ADC_CHN_C3
 = 0x08,

174 
FLD_ADC_CHN_C4
 = 0x09,

175 
FLD_ADC_CHN_C5
 = 0x0a,

176 
FLD_ADC_CHN_C6
 = 0x0b,

177 
FLD_ADC_CHN_C7
 = 0x0c,

179 
FLD_ADC_CHN_PGA_R
 = 0x0d,

180 
FLD_ADC_CHN_PGA_L
 = 0x0e,

182 
FLD_ADC_CHN_TEMP_POS
 = 0x0f,

183 
FLD_ADC_CHN_TEMP_NEG
 = 0x10,

184 
FLD_ADC_CHN_VBUS
 = 0x11,

185 
FLD_ADC_CHN_GND
 = 0x12,

187 
FLD_ADC_SINGLE_IN
 = 0x00,

188 
FLD_ADC_D5_REF
 = 0x20,

189 
FLD_ADC_D7_REF
 = 0x40,

190 
FLD_ADC_PGA_L_REF
 = 0x60,

191 
FLD_ADC_DATA_SIGNED
 = 0x80,

193 
FLD_ADC_PGA_C01
 = 0x226d,

194 
FLD_ADC_PGA_C23
 = 0x116d,

195 
FLD_ADC_PGA_C45
 = 0x016d,

197 
FLD_ADC_PGA_R_C2
 = 0x110d,

198 
FLD_ADC_PGA_R_C0
 = 0x220d,

199 
FLD_ADC_PGA_L_C3
 = 0x110e,

200 
FLD_ADC_PGA_L_C1
 = 0x220e,

202 
FLD_ADC_PGA_OFF
 = 0x0000,

206 
	#ªg_adc_ªf
 
	`REG_ADDR8
(0x2b)

	)

208 
	#ªg_adc_ªs_Ã
 
	`REG_ADDR8
(0x2f)

	)

209 
	#ªg_adc_ªs_m
 
	`REG_ADDR8
(0x3c)

	)

210 
	#ªg_adc_tßmp_Ã
 
	`REG_ADDR8
(0x3d)

	)

213 
FLD_ADC_VREF_1P3V
 = 0x15,

214 
FLD_ADC_12BITS
 = 0x07,

215 
FLD_ADC_TSAMP_3CLOCK
 = 0x00,

219 
	#ªg_adc_≥riod_chn0
 
	`REG_ADDR16
(0x30)

	)

220 
	#ªg_adc_≥riod_chn12
 
	`REG_ADDR8
(0x32)

	)

222 
	#ªg_adc_˘æ
 
	`REG_ADDR8
(0x33)

	)

224 
FLD_ADC_CHNL_AUTO_EN
 = 
BIT
(0),

225 
FLD_ADC_CHNR_AUTO_EN
 = 
BIT
(1),

226 
FLD_ADC_AUD_DATAPATH_EN
 = 
BIT
(2),

227 
FLD_ADC_CHNM_AUTO_EN
 = 
BIT
(3),

228 
FLD_ADC_AUD_MODE
 = 
BITS
(4,5),

229 
FLD_ADC_DONE_SIGNAL
 = 
BITS
(6,7),

232 
	#ªg_adc_chn1_ouç
 
	`REG_ADDR16
(0x34)

	)

234 
FLD_ADC_OUTPUT_CHN_VAL
 = 
BIT_RNG
(0,14),

235 
FLD_ADC_CHN_MANU_START
 = 
BIT
(15),

237 
	#ªg_adc_chn2_ouç
 
	`REG_ADDR16
(0x36)

	)

238 
	#ªg_adc_d©_byp_ouç
 
	`REG_ADDR16
(0x38)

	)

240 
	#ªg_adc_chn0_öput
 
	`REG_ADDR16
(0x3a)

	)

242 
	#ªg_adc_ßmp_ªs
 
	`REG_ADDR16
(0x3c)

	)

244 
FLD_ADC_CHNM_SAMP_CYCLE
 = 
BIT_RNG
(0,2),

245 
FLD_ADC_CHNM_SAMP_RESOL
 = 
BIT_RNG
(3,5),

246 
FLD_ADC_CHNLR_SAMP_CYCLE
 = 
BIT_RNG
(8,10),

249 
	#ªg_i2c_mem_m≠
 
	`REG_ADDR16
(0x3e)

250 

	)

254 
	#ªg_r°0
 
	`REG_ADDR8
(0x60)

	)

255 
	#ªg_r°0_16
 
	`REG_ADDR16
(0x60)

	)

256 
	#ªg_r°1
 
	`REG_ADDR8
(0x61)

	)

257 
	#ªg_r°2
 
	`REG_ADDR8
(0x62)

	)

258 
	#ªg_r°_˛k0
 
	`REG_ADDR32
(0x60)

	)

260 
FLD_RST_SPI
 = 
BIT
(0),

261 
FLD_RST_I2C
 = 
BIT
(1),

262 
FLD_RST_USB
 = 
BIT
(2),

263 
FLD_RST_USB_PHY
 = 
BIT
(3),

264 
FLD_RST_MCU
 = 
BIT
(4),

265 
FLD_RST_MAC
 = 
BIT
(5),

266 
FLD_RST_AIF
 = 
BIT
(6),

267 
FLD_RST_BB
 = 
BIT
(7),

268 
FLD_RST_ZB
 = 
BIT
(7),

269 
FLD_RST_GPIO
 = 
BIT
(8),

270 
FLD_RST_ALGM
 = 
BIT
(9),

271 
FLD_RST_DMA
 = 
BIT
(10),

272 
FLD_RST_UART
 = 
BIT
(11),

273 
FLD_RST_PWM
 = 
BIT
(12),

274 
FLD_RST_AES
 = 
BIT
(13),

275 
FLD_RST_SWR_M
 = 
BIT
(14),

276 
FLD_RST_SWR_S
 = 
BIT
(15),

277 
FLD_RST_SBC
 = 
BIT
(16),

278 
FLD_RST_AUD
 = 
BIT
(17),

279 
FLD_RST_DFIFO
 = 
BIT
(18),

280 
FLD_RST_ADC
 = 
BIT
(19),

281 
FLD_RST_SOFT_MCU
 = 
BIT
(20),

282 
FLD_RST_MCIC
 = 
BIT
(21),

283 
FLD_RST_SOFT_MCIC
 = 
BIT
(22),

284 
FLD_RST_RSV
 = 
BIT
(23),

285 
FLD_CLK_SPI_EN
 = 
BIT
(24),

286 
FLD_CLK_I2C_EN
 = 
BIT
(25),

287 
FLD_CLK_USB_EN
 = 
BIT
(26),

288 
FLD_CLK_USB_PHY_EN
 = 
BIT
(27),

289 
FLD_CLK_MCU_EN
 = 
BIT
(28),

290 
FLD_CLK_MAC_EN
 = 
BIT
(29),

291 
FLD_CLK_ADC_EN
 = 
BIT
(30),

292 
FLD_CLK_ZB_EN
 = 
BIT
(31),

295 
	#ªg_˛k_í
 
	`REG_ADDR16
(0x64)

	)

296 
	#ªg_˛k_í1
 
	`REG_ADDR8
(0x64)

	)

298 
FLD_CLK_GPIO_EN
 = 
BIT
(0),

299 
FLD_CLK_ALGM_EN
 = 
BIT
(1),

300 
FLD_CLK_DMA_EN
 = 
BIT
(2),

301 
FLD_CLK_UART_EN
 = 
BIT
(3),

302 
FLD_CLK_PWM_EN
 = 
BIT
(4),

303 
FLD_CLK_AES_EN
 = 
BIT
(5),

304 
FLD_CLK_32K_TIMER_EN
 = 
BIT
(6),

305 
FLD_CLK_SWIRE_EN
 = 
BIT
(7),

306 
FLD_CLK_32K_QDEC_EN
 = 
BIT
(8),

307 
FLD_CLK_AUD_EN
 = 
BIT
(9),

308 
FLD_CLK_DIFIO_EN
 = 
BIT
(10),

309 
FLD_CLK_KEYSCAN_EN
 = 
BIT
(11),

310 
FLD_CLK_MCIC_EN
 = 
BIT
(12),

311 
FLD_CLK_QDEC_EN
 = 
BIT
(13),

313 
	#ªg_˛k_í2
 
	`REG_ADDR8
(0x65)

	)

315 
FLD_CLK2_SBC_EN
 = 
BIT
(0),

316 
FLD_CLK2_AUD_EN
 = 
BIT
(1),

317 
FLD_CLK2_DIFIO_EN
 = 
BIT
(2),

318 
FLD_CLK2_I2S
 = 
BIT_RNG
(3,4),

319 
FLD_CLK2_C32K
 = 
BIT_RNG
(5,7),

322 
	#ªg_˛k_£l
 
	`REG_ADDR8
(0x66)

	)

324 
FLD_CLK_SEL_DIV
 = 
BIT_RNG
(0,4),

325 
FLD_CLK_SEL_SRC
 = 
BIT_RNG
(5,7),

328 
	#ªg_i2s_°ï
 
	`REG_ADDR8
(0x67)

	)

330 
FLD_I2S_STEP
 = 
BIT_RNG
(0,6),

331 
FLD_I2S_CLK_EN
 = 
BIT
(7),

334 
	#ªg_i2s_mod
 
	`REG_ADDR8
(0x68)

	)

336 
ölöe
 
SET_SDM_CLOCK_MHZ
(
f_mhz
) {

337 
ªg_i2s_°ï
 = 
FLD_I2S_CLK_EN
 | 
f_mhz
;

338 
ªg_i2s_mod
 = 0xc0;

344 
	#ªg_adc_°ï_l
 
	`REG_ADDR8
(0x69)

	)

345 
	#ªg_adc_mod_l
 
	`REG_ADDR8
(0x6a)

	)

346 
	#ªg_adc_mod
 
	`REG_ADDR16
(0x6a)

	)

348 
FLD_ADC_MOD
 = 
BIT_RNG
(0,11),

349 
FLD_ADC_STEP_H
 = 
BIT_RNG
(12,14),

350 
FLD_ADC_CLK_EN
 = 
BIT
(15),

352 
	#ªg_adc_˛k_í
 
	`REG_ADDR8
(0x6b)

	)

353 
	#ªg_adc_mod_h
 
	`REG_ADDR8
(0x6b)

	)

355 
FLD_ADC_MOD_H
 = 
BIT_RNG
(0,3),

356 
FLD_ADC_MOD_H_STEP
 = 
BIT_RNG
(4,6),

357 
FLD_ADC_MOD_H_CLK
 = 
BIT
(7),

360 
	#ªg_dmic_°ï
 
	`REG_ADDR8
(0x6c)

	)

362 
FLD_DMIC_STEP
 = 
BIT_RNG
(0,6),

363 
FLD_DMIC_CLK_EN
 = 
BIT
(7),

365 
	#ªg_dmic_mod
 
	`REG_ADDR8
(0x6d)

	)

368 
	#ªg_wakeup_í
 
	`REG_ADDR8
(0x6e)

	)

370 
FLD_WAKEUP_SRC_I2C
 = 
BIT
(0),

371 
FLD_WAKEUP_SRC_SPI
 = 
BIT
(1),

372 
FLD_WAKEUP_SRC_USB
 = 
BIT
(2),

373 
FLD_WAKEUP_SRC_GPIO
 = 
BIT
(3),

374 
FLD_WAKEUP_SRC_I2C_SYN
 = 
BIT
(4),

375 
FLD_WAKEUP_SRC_GPIO_RM
 = 
BIT
(5),

376 
FLD_WAKEUP_SRC_USB_RESM
 = 
BIT
(6),

377 
FLD_WAKEUP_SRC_RST_SYS
 = 
BIT
(7),

380 
	#ªg_pwdn_˘æ
 
	`REG_ADDR8
(0x6f)

	)

382 
FLD_PWDN_CTRL_REBOOT
 = 
BIT
(5),

383 
FLD_PWDN_CTRL_SLEEP
 = 
BIT
(7),

386 
	#ªg_fhs_£l
 
	`REG_ADDR8
(0x70)

	)

388 
FLD_FHS_SELECT
 = 
BIT_RNG
(0,1),

391 
FHS_SEL_192M_PLL
 = 0,

393 
FHS_SEL_32M_OSC
 = 1,

400 
	#ªg_dcdc_˛k
 
	`REG_ADDR8
(0x71)

	)

405 
	#ªg_id_wr_í
 
	`REG_ADDR8
(0x74)

	)

406 
	#ªg_¥odu˘_id
 
	`REG_ADDR32
(0x7c)

	)

407 
	#ªg_func_id
 
	`REG_ADDR8
(0x7c)

	)

409 
FLD_ID_USB_SYS_CLOCK
 = 
BIT
(0),

410 
FLD_ID_MAC_CLOCK
 = 
BIT
(1),

411 
FLD_ID_SBC_CLOCK
 = 
BIT
(2),

412 
FLD_ID_RISC32_ENABLE
 = 
BIT
(3),

413 
FLD_ID_I2S_ENABLE
 = 
BIT
(4),

414 
FLD_ID_SDM_ENABLE
 = 
BIT
(5),

415 
FLD_ID_RF_ENABLE
 = 
BIT
(6),

416 
FLD_ID_ZB_ENABLE
 = 
BIT
(7),

419 
	#ªg_vî_id
 
	`REG_ADDR8
(0x7d)

	)

420 
	#ªg_¥od_id
 
	`REG_ADDR16
(0x7e)

	)

422 
	#ªg_mcu_wakeup_mask
 
	`REG_ADDR32
(0x78)

	)

427 
	#ªg_mac_˘æ
 
	`REG_ADDR8
(0x80)

	)

429 
FLD_MAC_CTRL_TX_EN
 = 
BIT
(0),

430 
FLD_MAC_CTRL_RX_EN
 = 
BIT
(1),

431 
FLD_MAC_CTRL_SPD_100M
 = 
BIT
(6),

432 
FLD_MAC_CTRL_PHY_RST
 = 
BIT
(7),

435 
	#ªg_mac_úq_°a
 
	`REG_ADDR8
(0x81)

	)

437 
FLD_MAC_STA_TX_DONE
 = 
BIT
(0),

438 
FLD_MAC_STA_RX_DONE
 = 
BIT
(1),

439 
FLD_MAC_STA_TX_ERR
 = 
BIT
(2),

440 
FLD_MAC_STA_RX_ERR
 = 
BIT
(3),

441 
FLD_MAC_STA_RX_CRC
 = 
BIT
(4),

444 
	#ªg_mii_tx_d©a
 
	`REG_ADDR16
(0x82)

	)

445 
	#ªg_mii_rx_d©a
 
	`REG_ADDR16
(0x84)

	)

446 
	#ªg_mii_˛k
 
	`REG_ADDR8
(0x86)

	)

448 
FLD_MII_PHY_ID
 = 
BIT_RNG
(0,4),

449 
FLD_MII_CLK_DIV
 = 
BIT_RNG
(5,7),

451 
	#ªg_mii_˘æ
 
	`REG_ADDR8
(0x87)

	)

453 
FLD_MII_INTERNAL_REG
 = 
BIT_RNG
(0,4),

454 
FLD_MII_BUSY
 = 
BIT
(5),

455 
FLD_MII_WR
 = 
BIT
(6),

456 
FLD_MII_PREAM_EN
 = 
BIT
(7),

460 
	#ªg_u¨t_˛k_div
 
	`REG_ADDR16
(0x94)

	)

462 
FLD_UART_CLK_DIV
 = 
BIT_RNG
(0,14),

463 
FLD_UART_CLK_DIV_EN
 = 
BIT
(15)

466 
	#ªg_u¨t_˘æ0
 
	`REG_ADDR16
(0x96)

	)

468 
FLD_UART_BPWC
 = 
BIT_RNG
(0,3),

469 
FLD_UART_RX_DMA_EN
 = 
BIT
(4),

470 
FLD_UART_TX_DMA_EN
 = 
BIT
(5),

471 
FLD_UART_RX_IRQ_EN
 = 
BIT
(6),

472 
FLD_UART_TX_IRQ_EN
 = 
BIT
(7),

473 
FLD_UART_CTS_I_SELECT
 = 
BIT
(8),

474 
FLD_UART_CTS_EN
 = 
BIT
(9),

475 
FLD_UART_PARITY_EN
 = 
BIT
(10),

477 
	#ªg_u¨t_˘æ1
 
	`REG_ADDR16
(0x98)

	)

479 
	#ªg_u¨t_rx_timeout
 
	`REG_ADDR16
(0x9a)

	)

481 
FLD_UART_TIMEOUT_BW
 = 
BIT_RNG
(0,7),

482 
FLD_UART_TIMEOUT_MUL
 = 
BIT_RNG
(8,15),

488 
	#ªg_swúe_d©a
 
	`REG_ADDR8
(0xb0)

	)

489 
	#ªg_swúe_˘æ1
 
	`REG_ADDR8
(0xb1)

	)

491 
FLD_SWIRE_WR
 = 
BIT
(0),

492 
FLD_SWIRE_RD
 = 
BIT
(1),

493 
FLD_SWIRE_CMD
 = 
BIT
(2),

494 
FLD_SWIRE_USB_DET
 = 
BIT
(6),

495 
FLD_SWIRE_USB_EN
 = 
BIT
(7),

498 
	#ªg_swúe_˛k_div
 
	`REG_ADDR8
(0xb2)

	)

501 
	#ªg_™a_˘æ32
 
	`REG_ADDR32
(0xb8)

502 
	#ªg_™a_addr_d©a
 
	`REG_ADDR16
(0xb8)

503 
	#ªg_™a_addr
 
	`REG_ADDR8
(0xb8)

	)

504 
	#ªg_™a_d©a
 
	`REG_ADDR8
(0xb9)

	)

505 
	#ªg_™a_˘æ
 
	`REG_ADDR8
(0xba)

	)

508 
FLD_ANA_BUSY
 = 
BIT
(0),

509 
FLD_ANA_RSV
 = 
BIT
(4),

510 
FLD_ANA_RW
 = 
BIT
(5),

511 
FLD_ANA_START
 = 
BIT
(6),

512 
FLD_ANA_CYC
 = 
BIT
(7),

517 
	#ªg_˘æ_ï_±r
 
	`REG_ADDR8
(0x100)

	)

518 
	#ªg_˘æ_ï_d©
 
	`REG_ADDR8
(0x101)

	)

519 
	#ªg_˘æ_ï_˘æ
 
	`REG_ADDR8
(0x102)

	)

523 
FLD_EP_DAT_ACK
 = 
BIT
(0),

524 
FLD_EP_DAT_STALL
 = 
BIT
(1),

525 
FLD_EP_STA_ACK
 = 
BIT
(2),

526 
FLD_EP_STA_STALL
 = 
BIT
(3),

529 
	#ªg_˘æ_ï_úq_°a
 
	`REG_ADDR8
(0x103)

	)

531 
FLD_CTRL_EP_IRQ_TRANS
 = 
BIT_RNG
(0,3),

532 
FLD_CTRL_EP_IRQ_SETUP
 = 
BIT
(4),

533 
FLD_CTRL_EP_IRQ_DATA
 = 
BIT
(5),

534 
FLD_CTRL_EP_IRQ_STA
 = 
BIT
(6),

535 
FLD_CTRL_EP_IRQ_INTF
 = 
BIT
(7),

538 
	#ªg_˘æ_ï_úq_mode
 
	`REG_ADDR8
(0x104)

	)

540 
FLD_CTRL_EP_AUTO_ADDR
 = 
BIT
(0),

541 
FLD_CTRL_EP_AUTO_CFG
 = 
BIT
(1),

542 
FLD_CTRL_EP_AUTO_INTF
 = 
BIT
(2),

543 
FLD_CTRL_EP_AUTO_STA
 = 
BIT
(3),

544 
FLD_CTRL_EP_AUTO_SYN
 = 
BIT
(4),

545 
FLD_CTRL_EP_AUTO_DESC
 = 
BIT
(5),

546 
FLD_CTRL_EP_AUTO_FEAT
 = 
BIT
(6),

547 
FLD_CTRL_EP_AUTO_STD
 = 
BIT
(7),

550 
	#ªg_usb_˘æ
 
	`REG_ADDR8
(0x105)

	)

552 
FLD_USB_CTRL_AUTO_CLK
 = 
BIT
(0),

553 
FLD_USB_CTRL_LOW_SPD
 = 
BIT
(1),

554 
FLD_USB_CTRL_LOW_JITT
 = 
BIT
(2),

555 
FLD_USB_CTRL_TST_MODE
 = 
BIT
(3),

558 
	#ªg_usb_cyc_ˇli
 
	`REG_ADDR16
(0x106)

	)

559 
	#ªg_usb_mdev
 
	`REG_ADDR8
(0x10a)

	)

560 
	#ªg_usb_ho°_c⁄n
 
	`REG_ADDR8
(0x10b)

	)

562 
FLD_USB_MDEV_SELF_PWR
 = 
BIT
(0),

563 
FLD_USB_MDEV_SUSP_STA
 = 
BIT
(1),

566 
	#ªg_usb_sups_cyc_ˇli
 
	`REG_ADDR8
(0x10c)

	)

567 
	#ªg_usb_ötf_Æt
 
	`REG_ADDR8
(0x10d)

	)

569 
	#ªg_usb_ï8123_±r
 
	`REG_ADDR32
(0x110)

	)

570 
	#ªg_usb_ï8_±r
 
	`REG_ADDR8
(0x110)

	)

571 
	#ªg_usb_ï1_±r
 
	`REG_ADDR8
(0x111)

	)

572 
	#ªg_usb_ï2_±r
 
	`REG_ADDR8
(0x112)

	)

573 
	#ªg_usb_ï3_±r
 
	`REG_ADDR8
(0x113)

	)

574 
	#ªg_usb_ï4567_±r
 
	`REG_ADDR32
(0x114)

	)

575 
	#ªg_usb_ï4_±r
 
	`REG_ADDR8
(0x114)

	)

576 
	#ªg_usb_ï5_±r
 
	`REG_ADDR8
(0x115)

	)

577 
	#ªg_usb_ï6_±r
 
	`REG_ADDR8
(0x116)

	)

578 
	#ªg_usb_ï7_±r
 
	`REG_ADDR8
(0x117)

	)

579 
	#ªg_usb_ï_±r
(
i
Ë
	`REG_ADDR8
(0x110+((iË& 0x07))

	)

581 
	#ªg_usb_ï8123_d©
 
	`REG_ADDR32
(0x118)

	)

582 
	#ªg_usb_ï8_d©
 
	`REG_ADDR8
(0x118)

	)

583 
	#ªg_usb_ï1_d©
 
	`REG_ADDR8
(0x119)

	)

584 
	#ªg_usb_ï2_d©
 
	`REG_ADDR8
(0x11a)

	)

585 
	#ªg_usb_ï3_d©
 
	`REG_ADDR8
(0x11b)

	)

586 
	#ªg_usb_ï4567_d©
 
	`REG_ADDR32
(0x11c)

	)

587 
	#ªg_usb_ï4_d©
 
	`REG_ADDR8
(0x11c)

	)

588 
	#ªg_usb_ï5_d©
 
	`REG_ADDR8
(0x11d)

	)

589 
	#ªg_usb_ï6_d©
 
	`REG_ADDR8
(0x11e)

	)

590 
	#ªg_usb_ï7_d©
 
	`REG_ADDR8
(0x11f)

	)

591 
	#ªg_usb_ï_d©
(
i
Ë
	`REG_ADDR8
(0x118+((iË& 0x07))

	)

593 
	#ªg_usb_ï8_˘æ
 
	`REG_ADDR8
(0x120)

	)

594 
	#ªg_usb_ï1_˘æ
 
	`REG_ADDR8
(0x121)

	)

595 
	#ªg_usb_ï2_˘æ
 
	`REG_ADDR8
(0x122)

	)

596 
	#ªg_usb_ï3_˘æ
 
	`REG_ADDR8
(0x123)

	)

597 
	#ªg_usb_ï4_˘æ
 
	`REG_ADDR8
(0x124)

	)

598 
	#ªg_usb_ï5_˘æ
 
	`REG_ADDR8
(0x125)

	)

599 
	#ªg_usb_ï6_˘æ
 
	`REG_ADDR8
(0x126)

	)

600 
	#ªg_usb_ï7_˘æ
 
	`REG_ADDR8
(0x127)

	)

601 
	#ªg_usb_ï_˘æ
(
i
Ë
	`REG_ADDR8
(0x120+((iË& 0x07))

	)

604 
FLD_USB_EP_BUSY
 = 
BIT
(0),

605 
FLD_USB_EP_STALL
 = 
BIT
(1),

606 
FLD_USB_EP_DAT0
 = 
BIT
(2),

607 
FLD_USB_EP_DAT1
 = 
BIT
(3),

608 
FLD_USB_EP_MONO
 = 
BIT
(6),

609 
FLD_USB_EP_EOF_ISO
 = 
BIT
(7),

612 
	#ªg_usb_ï8123_buf_addr
 
	`REG_ADDR32
(0x128)

	)

613 
	#ªg_usb_ï8_buf_addr
 
	`REG_ADDR8
(0x128)

	)

614 
	#ªg_usb_ï1_buf_addr
 
	`REG_ADDR8
(0x129)

	)

615 
	#ªg_usb_ï2_buf_addr
 
	`REG_ADDR8
(0x12a)

	)

616 
	#ªg_usb_ï3_buf_addr
 
	`REG_ADDR8
(0x12b)

	)

617 
	#ªg_usb_ï4567_buf_addr
 
	`REG_ADDR32
(0x12c)

	)

618 
	#ªg_usb_ï4_buf_addr
 
	`REG_ADDR8
(0x12c)

	)

619 
	#ªg_usb_ï5_buf_addr
 
	`REG_ADDR8
(0x12d)

	)

620 
	#ªg_usb_ï6_buf_addr
 
	`REG_ADDR8
(0x12e)

	)

621 
	#ªg_usb_ï7_buf_addr
 
	`REG_ADDR8
(0x12f)

	)

622 
	#ªg_usb_ï_buf_addr
(
i
Ë
	`REG_ADDR8
(0x128+((iË& 0x07))

	)

624 
	#ªg_usb_øm_˘æ
 
	`REG_ADDR8
(0x130)

	)

626 
FLD_USB_CEN_PWR_DN
 = 
BIT
(0),

627 
FLD_USB_CLK_PWR_DN
 = 
BIT
(1),

628 
FLD_USB_WEN_PWR_DN
 = 
BIT
(3),

629 
FLD_USB_CEN_FUNC
 = 
BIT
(4),

632 
	#ªg_usb_iso_mode
 
	`REG_ADDR8
(0x138)

	)

633 
	#ªg_usb_úq
 
	`REG_ADDR8
(0x139)

	)

634 
	#ªg_usb_mask
 
	`REG_ADDR8
(0x13a)

	)

635 
	#ªg_usb_ï8_£nd_max
 
	`REG_ADDR8
(0x13b)

	)

636 
	#ªg_usb_ï8_£nd_thª
 
	`REG_ADDR8
(0x13c)

	)

637 
	#ªg_usb_ï8_fifo_mode
 
	`REG_ADDR8
(0x13d)

	)

638 
	#ªg_usb_ï_max_size
 
	`REG_ADDR8
(0x13e)

	)

641 
FLD_USB_ENP8_FIFO_MODE
 = 
BIT
(0),

642 
FLD_USB_ENP8_FULL_FLAG
 = 
BIT
(1),

647 
	#ªg_rf_tx_mode1
 
	`REG_ADDR8
(0x400)

	)

648 
	#ªg_rf_tx_mode
 
	`REG_ADDR16
(0x400)

	)

650 
FLD_RF_TX_DMA_EN
 = 
BIT
(0),

651 
FLD_RF_TX_CRC_EN
 = 
BIT
(1),

652 
FLD_RF_TX_BANDWIDTH
 = 
BIT_RNG
(2,3),

653 
FLD_RF_TX_OUTPUT
 = 
BIT
(4),

654 
FLD_RF_TX_TST_OUT
 = 
BIT
(5),

655 
FLD_RF_TX_TST_EN
 = 
BIT
(6),

656 
FLD_RF_TX_TST_MODE
 = 
BIT
(7),

657 
FLD_RF_TX_ZB_PN_EN
 = 
BIT
(8),

658 
FLD_RF_TX_ZB_FEC_EN
 = 
BIT
(9),

659 
FLD_RF_TX_ZB_INTL_EN
 = 
BIT
(10),

660 
FLD_RF_TX_1M2M_PN_EN
 = 
BIT
(11),

661 
FLD_RF_TX_1M2M_FEC_EN
 = 
BIT
(12),

662 
FLD_RF_TX_1M2M_INTL_EN
 = 
BIT
(13),

664 
	#ªg_rf_tx_buf_°a
 
	`REG_ADDR32
(0x41c)

	)

666 
	#ªg_rf_rx_£n£_thr
 
	`REG_ADDR8
(0x422)

	)

667 
	#ªg_rf_rx_auto
 
	`REG_ADDR8
(0x426)

	)

669 
FLD_RF_RX_IRR_GAIN
 = 
BIT
(0),

670 
FLD_RF_RX_IRR_PHASE
 = 
BIT
(1),

671 
FLD_RF_RX_DAC_I
 = 
BIT
(2),

672 
FLD_RF_RX_DAC_Q
 = 
BIT
(3),

673 
FLD_RF_RX_LNA_GAIN
 = 
BIT
(4),

674 
FLD_RF_RX_MIX2_GAIN
 = 
BIT
(5),

675 
FLD_RF_RX_PGA_GAIN
 = 
BIT
(6),

676 
FLD_RF_RX_CAL_EN
 = 
BIT
(7),

678 
	#ªg_rf_rx_sync
 
	`REG_ADDR8
(0x427)

	)

680 
FLD_RF_FREQ_COMP_EN
 = 
BIT
(0),

681 
FLD_RF_ADC_SYNC
 = 
BIT
(1),

682 
FLD_RF_ADC_INP_SIGNED
 = 
BIT
(2),

683 
FLD_RF_SWAP_ADC_IQ
 = 
BIT
(3),

684 
FLD_RF_NOTCH_FREQ_SEL
 = 
BIT
(4),

685 
FLD_RF_NOTCH_BAND_SEL
 = 
BIT
(5),

686 
FLD_RF_NOTCH_EN
 = 
BIT
(6),

687 
FLD_RF_DN_CONV_FREQ_SEL
 = 
BIT
(7),

690 
	#ªg_rf_rx_mode
 
	`REG_ADDR8
(0x428)

	)

692 
FLD_RF_RX_EN
 = 
BIT
(0),

693 
FLD_RF_RX_MODE_1M
 = 
BIT
(1),

694 
FLD_RF_RX_MODE_2M
 = 
BIT
(2),

695 
FLD_RF_RX_LOW_IF
 = 
BIT
(3),

696 
FLD_RF_RX_BYPASS_DCOC
 = 
BIT
(4),

697 
FLD_RF_RX_MAN_FINE_TUNE
 = 
BIT
(5),

698 
FLD_RF_RX_SINGLE_CAL
 = 
BIT
(6),

699 
FLD_RF_RX_LOW_PASS_FILTER
 = 
BIT
(7),

702 
	#ªg_rf_rx_pûŸ
 
	`REG_ADDR8
(0x42b)

	)

704 
FLD_RF_PILOT_LEN
 = 
BIT_RNG
(0,3),

705 
FLD_RF_ZB_SFD_CHK
 = 
BIT
(4),

706 
FLD_RF_1M_SFD_CHK
 = 
BIT
(5),

707 
FLD_RF_2M_SFD_CHK
 = 
BIT
(6),

708 
FLD_RF_ZB_OR_AUTO
 = 
BIT
(7),

711 
	#ªg_rf_rx_chn_dc
 
	`REG_ADDR32
(0x42c)

	)

712 
	#ªg_rf_rx_q_chn_ˇl
 
	`REG_ADDR8
(0x42f)

	)

714 
FLD_RF_RX_DCQ_HIGH
 = 
BIT_RNG
(0,6),

715 
FLD_RF_RX_DCQ_CAL_START
 = 
BIT
(7),

717 
	#ªg_rf_rx_≥l
 
	`REG_ADDR16
(0x434)

	)

718 
	#ªg_rf_rx_≥l_gaö
 
	`REG_ADDR32
(0x434)

	)

719 
	#ªg_rf_rx_rssi_off£t
 
	`REG_ADDR8
(0x439)

	)

721 
	#ªg_rf_rx_hdx
 
	`REG_ADDR8
(0x43b)

	)

723 
FLD_RX_HEADER_LEN
 = 
BIT_RNG
(0,3),

724 
FLD_RT_TICK_LO_SEL
 = 
BIT
(4),

725 
FLD_RT_TICK_HI_SEL
 = 
BIT
(5),

726 
FLD_RT_TICK_FRAME
 = 
BIT
(6),

727 
FLD_PKT_LEN_OUTP_EN
 = 
BIT
(7),

730 
	#ªg_rf_rx_g˘l
 
	`REG_ADDR8
(0x43c)

	)

732 
FLD_RX_GCTL_CIC_SAT_LO_EN
 = 
BIT
(0),

733 
FLD_RX_GCTL_CIC_SAT_HI_EN
 = 
BIT
(1),

734 
FLD_RX_GCTL_AUTO_PWR
 = 
BIT
(2),

735 
FLD_RX_GCTL_ADC_RST_VAL
 = 
BIT
(4),

736 
FLD_RX_GCTL_ADC_RST_EN
 = 
BIT
(5),

737 
FLD_RX_GCTL_PWR_CHG_DET_S
 = 
BIT
(6),

738 
FLD_RX_GCTL_PWR_CHG_DET_N
 = 
BIT
(7),

740 
	#ªg_rf_rx_≥ak
 
	`REG_ADDR8
(0x43d)

	)

742 
FLD_RX_PEAK_DET_SRC_EN
 = 
BIT_RNG
(0,2),

743 
FLD_TX_PEAK_DET_EN
 = 
BIT
(3),

744 
FLD_PEAK_DET_NUM
 = 
BIT_RNG
(4,5),

745 
FLD_PEAK_MAX_CNT_PRD
 = 
BIT_RNG
(6,7),

748 
	#ªg_rf_rx_°©us
 
	`REG_ADDR8
(0x443)

	)

750 
FLD_RF_RX_STATE
 = 
BIT_RNG
(0,3),

751 
FLD_RF_RX_STA_RSV
 = 
BIT_RNG
(4,5),

752 
FLD_RF_RX_INTR
 = 
BIT
(6),

753 
FLD_RF_TX_INTR
 = 
BIT
(7),

756 
	#ªg_rf_úq_mask
 
	`REG_ADDR16
(0xf1c)

	)

757 
	#ªg_rf_úq_°©us
 
	`REG_ADDR16
(0xf20)

	)

760 
FLD_RF_IRQ_RX
 = 
BIT
(0),

761 
FLD_RF_IRQ_TX
 = 
BIT
(1),

762 
FLD_RF_IRQ_RX_TIMEOUT
 = 
BIT
(2),

763 
FLD_RF_IRQ_CRC
 = 
BIT
(4),

764 
FLD_RF_IRQ_CMD_DONE
 = 
BIT
(5),

765 
FLD_RF_IRQ_FSM_TIMEOUT
 = 
BIT
(6),

766 
FLD_RF_IRQ_RETRY_HIT
 = 
BIT
(7),

767 
FLD_RF_IRQ_FIRST_TIMEOUT
 = 
BIT
(10),

772 
RF_RX_STA_IDLE
 = 0,

773 
RF_RX_STA_SET_GAIN
 = 1,

774 
RF_RX_STA_CIC_SETTLE
 = 2,

775 
RF_RX_STA_LPF_SETTLE
 = 3,

776 
RF_RX_STA_PE
 = 4,

777 
RF_RX_STA_SYN_START
 = 5,

778 
RF_RX_STA_GLOB_SYN
 = 6,

779 
RF_RX_STA_GLOB_LOCK
 = 7,

780 
RF_RX_STA_LOCAL_SYN
 = 8,

781 
RF_RX_STA_LOCAL_LOCK
 = 9,

782 
RF_RX_STA_ALIGN
 = 10,

783 
RF_RX_STA_ADJUST
 = 11,

784 
RF_RX_STA_DEMOD
 = 12,

785 
RF_RX_STA_FOOTER
 = 13,

788 
	#ªg_rx_∫d_mode
 
	`REG_ADDR8
(0x447)

	)

790 
FLD_RX_RND_SRC
 = 
BIT
(0),

791 
FLD_RX_RND_MANU_MODE
 = 
BIT
(1),

792 
FLD_RX_RND_AUTO_RD
 = 
BIT
(2),

793 
FLD_RX_RND_FREE_MODE
 = 
BIT
(3),

794 
FLD_RX_RND_CLK_DIV
 = 
BIT_RNG
(4,7),

796 
	#ªg_∫d_numbî
 
	`REG_ADDR16
(0x448)

	)

798 
	#ªg_bb_max_tick
 
	`REG_ADDR16
(0x44c)

	)

799 
	#ªg_rf_πt
 
	`REG_ADDR32
(0x454)

	)

801 
FLD_RTT_CAL
 = 
BIT_RNG
(0,7),

802 
FLD_RTT_CYC1
 = 
BIT_RNG
(8,15),

803 
FLD_RTT_LOCK
 = 
BIT_RNG
(16,23),

804 
FLD_RT_SD_DLY_40M
 = 
BIT_RNG
(24,27),

805 
FLD_RT_SD_DLY_BYPASS
 = 
BIT
(28),

808 
	#ªg_rf_chn_rssi
 
	`REG_ADDR8
(0x458)

	)

810 
	#ªg_rf_rx_gaö_agc
(
i
Ë
	`REG_ADDR32
(0x480+((i)<<2))

	)

812 
	#ªg_rf_rx_dci
 
	`REG_ADDR8
(0x4cb)

813 
	#ªg_rf_rx_dcq
 
	`REG_ADDR8
(0x4cf)

814 

	)

815 
	#ªg_∂l_rx_cﬂr£_tu√
 
	`REG_ADDR16
(0x4d0)

	)

816 
	#ªg_∂l_rx_cﬂr£_div
 
	`REG_ADDR8
(0x4d2)

	)

817 
	#ªg_∂l_rx_föe_tu√
 
	`REG_ADDR16
(0x4d4)

	)

818 
	#ªg_∂l_rx_föe_div
 
	`REG_ADDR8
(0x4d6)

	)

819 
	#ªg_∂l_tx_cﬂr£_tu√
 
	`REG_ADDR16
(0x4d8)

	)

820 
	#ªg_∂l_tx_cﬂr£_div
 
	`REG_ADDR8
(0x4da)

	)

821 
	#ªg_∂l_tx_föe_tu√
 
	`REG_ADDR16
(0x4dc)

	)

822 
	#ªg_∂l_tx_föe_div
 
	`REG_ADDR8
(0x4de)

	)

824 
	#ªg_∂l_rx_‰ac
 
	`REG_ADDR32
(0x4e0)

	)

825 
	#ªg_∂l_tx_‰ac
 
	`REG_ADDR32
(0x4e4)

	)

827 
	#ªg_∂l_tx_˘æ
 
	`REG_ADDR8
(0x4e8)

	)

828 
	#ªg_∂l_˘æ16
 
	`REG_ADDR16
(0x4e8)

	)

829 
	#ªg_∂l_˘æ
 
	`REG_ADDR32
(0x4e8)

	)

831 
FLD_PLL_TX_CYC0
 = 
BIT
(0),

832 
FLD_PLL_TX_SOF
 = 
BIT
(1),

833 
FLD_PLL_TX_CYC1
 = 
BIT
(2),

834 
FLD_PLL_TX_PRE_EN
 = 
BIT
(3),

835 
FLD_PLL_TX_VCO_EN
 = 
BIT
(4),

836 
FLD_PLL_TX_PWDN_DIV
 = 
BIT
(5),

837 
FLD_PLL_TX_MOD_EN
 = 
BIT
(6),

838 
FLD_PLL_TX_MOD_TRAN_EN
 = 
BIT
(7),

839 
FLD_PLL_RX_CYC0
 = 
BIT
(8),

840 
FLD_PLL_RX_SOF
 = 
BIT
(9),

841 
FLD_PLL_RX_CYC1
 = 
BIT
(10),

842 
FLD_PLL_RX_PRES_EN
 = 
BIT
(11),

843 
FLD_PLL_RX_VCO_EN
 = 
BIT
(12),

844 
FLD_PLL_RX_PWDN_DIV
 = 
BIT
(13),

845 
FLD_PLL_RX_PEAK_EN
 = 
BIT
(14),

846 
FLD_PLL_RX_TP_CYC
 = 
BIT
(15),

847 
FLD_PLL_SD_RSTB
 = 
BIT
(16),

848 
FLD_PLL_SD_INTG_EN
 = 
BIT
(17),

849 
FLD_PLL_CP_TRI
 = 
BIT
(18),

850 
FLD_PLL_PWDN_INTG1
 = 
BIT
(19),

851 
FLD_PLL_PWDN_INTG2
 = 
BIT
(20),

852 
FLD_PLL_PWDN_INTG_DIV
 = 
BIT
(21),

853 
FLD_PLL_PEAK_DET_EN
 = 
BIT
(22),

854 
FLD_PLL_OPEN_LOOP_EN
 = 
BIT
(23),

855 
FLD_PLL_RX_TICK_EN
 = 
BIT
(24),

856 
FLD_PLL_TX_TICK_EN
 = 
BIT
(25),

857 
FLD_PLL_RX_ALWAYS_ON
 = 
BIT
(26),

858 
FLD_PLL_TX_ALWAYS_ON
 = 
BIT
(27),

859 
FLD_PLL_MANUAL_MODE_EN
 = 
BIT
(28),

860 
FLD_PLL_CAL_DONE_EN
 = 
BIT
(29),

861 
FLD_PLL_LOCK_EN
 = 
BIT
(30),

863 
	#ªg_∂l_rx_˘æ
 
	`REG_ADDR8
(0x4e9)

	)

865 
FLD_PLL_RX2_CYC0
 = 
BIT
(0),

866 
FLD_PLL_RX2_SOF
 = 
BIT
(1),

867 
FLD_PLL_RX2_CYC1
 = 
BIT
(2),

868 
FLD_PLL_RX2_PRES_EN
 = 
BIT
(3),

869 
FLD_PLL_RX2_VCO_EN
 = 
BIT
(4),

870 
FLD_PLL_RX2_PD_DIV
 = 
BIT
(5),

871 
FLD_PLL_RX2_PEAK_EN
 = 
BIT
(6),

872 
FLD_PLL_RX2_TP_CYC
 = 
BIT
(7),

875 
	#ªg_∂l_˘æ_a
 
	`REG_ADDR8
(0x4eb)

	)

877 
FLD_PLL_A_RX_TICK_EN
 = 
BIT
(0),

878 
FLD_PLL_A_TX_TICK_EN
 = 
BIT
(1),

879 
FLD_PLL_A_RX_ALWAYS_ON
 = 
BIT
(2),

880 
FLD_PLL_A_TX_ALWAYS_ON
 = 
BIT
(3),

881 
FLD_PLL_A_MANUAL_MODE_EN
 = 
BIT
(4),

882 
FLD_PLL_A_CAL_DONE_EN
 = 
BIT
(5),

883 
FLD_PLL_A_LOCK_EN
 = 
BIT
(6),

886 
	#ªg_∂l_pﬁ_˘æ
 
	`REG_ADDR16
(0x4ec)

	)

888 
FLD_PLL_POL_TX_PRE_EN
 = 
BIT
(0),

889 
FLD_PLL_POL_TX_VCO_EN
 = 
BIT
(1),

890 
FLD_PLL_POL_TX_PD_DIV
 = 
BIT
(2),

891 
FLD_PLL_POL_MOD_EN
 = 
BIT
(3),

892 
FLD_PLL_POL_MOD_TRAN_EN
 = 
BIT
(4),

893 
FLD_PLL_POL_RX_PRE_EN
 = 
BIT
(5),

894 
FLD_PLL_POL_RX_VCO_EN
 = 
BIT
(6),

895 
FLD_PLL_POL_RX_PD_DIV
 = 
BIT
(7),

896 
FLD_PLL_POL_SD_RSTB
 = 
BIT
(8),

897 
FLD_PLL_POL_SD_INTG_EN
 = 
BIT
(9),

898 
FLD_PLL_POL_CP_TRI
 = 
BIT
(10),

899 
FLD_PLL_POL_TX_SOF
 = 
BIT
(11),

900 
FLD_PLL_POL_RX_SOF
 = 
BIT
(12),

903 
	#ªg_rf_rx_ˇp
 
	`REG_ADDR16
(0x4f0)

	)

904 
	#ªg_rf_tx_ˇp
 
	`REG_ADDR16
(0x4f0)

	)

909 
	#ªg_dma0_addr
 
	`REG_ADDR16
(0x500)

	)

910 
	#ªg_dma0_˘æ
 
	`REG_ADDR16
(0x502)

	)

911 
	#ªg_dma1_addr
 
	`REG_ADDR16
(0x504)

	)

912 
	#ªg_dma1_˘æ
 
	`REG_ADDR16
(0x506)

	)

913 
	#ªg_dma2_addr
 
	`REG_ADDR16
(0x508)

	)

914 
	#ªg_dma2_˘æ
 
	`REG_ADDR16
(0x50a)

	)

915 
	#ªg_dma3_addr
 
	`REG_ADDR16
(0x50c)

	)

916 
	#ªg_dma3_˘æ
 
	`REG_ADDR16
(0x50e)

	)

917 
	#ªg_dma4_addr
 
	`REG_ADDR16
(0x510)

	)

918 
	#ªg_dma4_˘æ
 
	`REG_ADDR16
(0x512)

	)

919 
	#ªg_dma5_addr
 
	`REG_ADDR16
(0x514)

	)

920 
	#ªg_dma5_˘æ
 
	`REG_ADDR16
(0x516)

	)

922 
	#ªg_dma_rx_Ωå
 
	`REG_ADDR8
(0x528)

	)

923 
	#ªg_dma_rx_w±r
 
	`REG_ADDR8
(0x529)

	)

925 
	#ªg_dma_tx_Ωå
 
	`REG_ADDR8
(0x52a)

	)

926 
	#ªg_dma_tx_w±r
 
	`REG_ADDR8
(0x52b)

	)

927 
	#ªg_dma_tx_fifo
 
	`REG_ADDR16
(0x52c)

	)

929 
FLD_DMA_BUF_SIZE
 = 
BIT_RNG
(0,7),

930 
FLD_DMA_WR_MEM
 = 
BIT
(8),

931 
FLD_DMA_PINGPONG_EN
 = 
BIT
(9),

932 
FLD_DMA_FIFO_EN
 = 
BIT
(10),

933 
FLD_DMA_AUTO_MODE
 = 
BIT
(11),

934 
FLD_DMA_BYTE_MODE
 = 
BIT
(12),

935 
FLD_DMA_FIFO8
 = (
BIT
(15Ë| BIT(14Ë| 
FLD_DMA_WR_MEM
 | 
FLD_DMA_PINGPONG_EN
),

937 
FLD_DMA_RPTR_CLR
 = 
BIT
(4),

938 
FLD_DMA_RPTR_NEXT
 = 
BIT
(5),

939 
FLD_DMA_RPTR_SET
 = 
BIT
(6),

942 
	#ªg_dma_chn_í
 
	`REG_ADDR8
(0x520)

	)

943 
	#ªg_dma_chn_úq_msk
 
	`REG_ADDR8
(0x521)

	)

944 
	#ªg_dma_tx_rdy0
 
	`REG_ADDR8
(0x524)

	)

945 
	#ªg_dma_tx_rdy1
 
	`REG_ADDR8
(0x525)

	)

946 
	#ªg_dma_rx_rdy0
 
	`REG_ADDR8
(0x526)

	)

947 
	#ªg_dma_úq_§c
 
ªg_dma_rx_rdy0


	)

948 
	#ªg_dma_rx_rdy1
 
	`REG_ADDR8
(0x527)

	)

950 
FLD_DMA_UART_RX
 = 
BIT
(0),

951 
FLD_DMA_UART_TX
 = 
BIT
(1),

952 
FLD_DMA_RF_RX
 = 
BIT
(2),

953 
FLD_DMA_RF_TX
 = 
BIT
(3),

954 
FLD_DMA_CHN_UART_RX
 = 
BIT
(0),

955 
FLD_DMA_CHN_UART_TX
 = 
BIT
(1),

956 
FLD_DMA_CHN_RF_RX
 = 
BIT
(2),

957 
FLD_DMA_CHN_RF_TX
 = 
BIT
(3),

962 
	#ªg_dma_u¨t_rx_addr
 
ªg_dma0_addr


	)

963 
	#ªg_dma_u¨t_rx_˘æ
 
ªg_dma0_˘æ


	)

964 
	#ªg_dma_u¨t_tx_addr
 
ªg_dma1_addr


	)

965 
	#ªg_dma_u¨t_tx_˘æ
 
ªg_dma1_˘æ


	)

967 
	#ªg_dma_rf_rx_addr
 
ªg_dma2_addr


	)

968 
	#ªg_dma_rf_rx_˘æ
 
ªg_dma2_˘æ


	)

969 
	#ªg_dma_rf_tx_addr
 
ªg_dma3_addr


	)

970 
	#ªg_dma_rf_tx_˘æ
 
ªg_dma3_˘æ


	)

972 
	#ªg_´s_˘æ
 
	`REG_ADDR8
(0x540)

	)

973 
	#ªg_´s_d©a
 
	`REG_ADDR32
(0x548)

	)

974 
	#ªg_´s_key
(
key_id
Ë
ªg_´s_key
##
	)
key_id

975 
	#ªg_´s_key0
 
	`REG_ADDR8
(0x550)

	)

976 
	#ªg_´s_key1
 
	`REG_ADDR8
(0x551)

	)

977 
	#ªg_´s_key2
 
	`REG_ADDR8
(0x552)

	)

978 
	#ªg_´s_key3
 
	`REG_ADDR8
(0x553)

	)

979 
	#ªg_´s_key4
 
	`REG_ADDR8
(0x554)

	)

980 
	#ªg_´s_key5
 
	`REG_ADDR8
(0x555)

	)

981 
	#ªg_´s_key6
 
	`REG_ADDR8
(0x556)

	)

982 
	#ªg_´s_key7
 
	`REG_ADDR8
(0x557)

	)

983 
	#ªg_´s_key8
 
	`REG_ADDR8
(0x558)

	)

984 
	#ªg_´s_key9
 
	`REG_ADDR8
(0x559)

	)

985 
	#ªg_´s_key10
 
	`REG_ADDR8
(0x55a)

	)

986 
	#ªg_´s_key11
 
	`REG_ADDR8
(0x55b)

	)

987 
	#ªg_´s_key12
 
	`REG_ADDR8
(0x55c)

	)

988 
	#ªg_´s_key13
 
	`REG_ADDR8
(0x55d)

	)

989 
	#ªg_´s_key14
 
	`REG_ADDR8
(0x55e)

	)

990 
	#ªg_´s_key15
 
	`REG_ADDR8
(0x55f)

	)

994 
	#ªg_aud_˘æ
 
	`REG_ADDR8
(0x560)

	)

996 
FLD_AUD_ENABLE
 = 
BIT
(0),

997 
FLD_AUD_SDM_PLAY_EN
 = 
BIT
(1),

998 
FLD_AUD_SHAPPING_EN
 = 
BIT
(2),

1001 
	#ªg_aud_vﬁ_˘æ
 
	`REG_ADDR8
(0x561)

	)

1002 
	#ªg_aud_≤1
 
	`REG_ADDR8
(0x562)

	)

1003 
	#ªg_aud_≤2
 
	`REG_ADDR8
(0x563)

	)

1005 
	#ªg_as˛_°ï
 
	`REG_ADDR16
(0x564)

	)

1006 
	#ªg_aud_ba£_adr
 
	`REG_ADDR16
(0x568)

	)

1007 
	#ªg_aud_buff_size
 
	`REG_ADDR8
(0x56a)

	)

1008 
	#ªg_aud_Ωå
 
	`REG_ADDR16
(0x56c)

	)

1009 
	#ªg_sdm_±r
 
ªg_aud_Ωå


	)

1011 
	#AUD_SDM_STEP
(
i
,
o
Ë(0x8000*(i/100)/(o/100))

	)

1013 
ölöe
 
gë_sdm_rd_±r
 () {

1014  
ªg_aud_Ωå
 << 0;

1018 
FLD_AUD_PN_1BIT
 = 0x104050,

1019 
FLD_AUD_PN_4BITS
 = 0x0c404c,

1022 
	#ªg_aud_c⁄°
 
	`REG_ADDR32
(0x56)

	)

1025 
	#ªg_aud_fûãr
 
	`REG_ADDR16
(0xb80)

	)

1027 
FLD_AUD_FLT_IBFT
 = 
BIT
(0),

1028 
FLD_AUD_FLT_AUTO
 = 
BIT
(1),

1029 
FLD_AUD_FLT_FIFO0
 = 
BIT
(2),

1030 
FLD_AUD_FLT_FIFO1
 = 
BIT
(3),

1031 
FLD_AUD_FLT_BYPASS0
 = 
BIT
(5),

1032 
FLD_AUD_FLT_BYPASS1
 = 
BIT
(6),

1033 
FLD_AUD_FLT_BYPASS
 = 0x60,

1034 
FLD_AUD_FLT_I0
 = 0x47,

1035 
FLD_AUD_FLT_I1
 = 0x2b,

1036 
FLD_AUD_FLT_I0I1
 = 0x0f,

1037 
FLD_AUD_FLT_CFGHIGH
 = 0x1000,

1039 
	#ªg_aud_§am
 
	`REG_ADDR8
(0xb81)

	)

1047 
	#ªg_gpio_∑_ö
 
	`REG_ADDR8
(0x580)

	)

1048 
	#ªg_gpio_∑_õ
 
	`REG_ADDR8
(0x581)

	)

1049 
	#ªg_gpio_∑_€n
 
	`REG_ADDR8
(0x582)

	)

1050 
	#ªg_gpio_∑_out
 
	`REG_ADDR8
(0x583)

	)

1051 
	#ªg_gpio_∑_pﬁ
 
	`REG_ADDR8
(0x584)

	)

1052 
	#ªg_gpio_∑_ds
 
	`REG_ADDR8
(0x585)

	)

1053 
	#ªg_gpio_∑_gpio
 
	`REG_ADDR8
(0x586)

	)

1054 
	#ªg_gpio_∑_úq_í
 
	`REG_ADDR8
(0x587)

	)

1056 
	#ªg_gpio_pb_ö
 
	`REG_ADDR8
(0x588)

	)

1057 
	#ªg_gpio_pb_õ
 
	`REG_ADDR8
(0x589)

	)

1058 
	#ªg_gpio_pb_€n
 
	`REG_ADDR8
(0x58a)

	)

1059 
	#ªg_gpio_pb_out
 
	`REG_ADDR8
(0x58b)

	)

1060 
	#ªg_gpio_pb_pﬁ
 
	`REG_ADDR8
(0x58c)

	)

1061 
	#ªg_gpio_pb_ds
 
	`REG_ADDR8
(0x58d)

	)

1062 
	#ªg_gpio_pb_gpio
 
	`REG_ADDR8
(0x58e)

	)

1063 
	#ªg_gpio_pb_úq_í
 
	`REG_ADDR8
(0x58f)

	)

1065 
	#ªg_gpio_pc_ö
 
	`REG_ADDR8
(0x590)

	)

1066 
	#ªg_gpio_pc_õ
 
	`REG_ADDR8
(0x591)

	)

1067 
	#ªg_gpio_pc_€n
 
	`REG_ADDR8
(0x592)

	)

1068 
	#ªg_gpio_pc_out
 
	`REG_ADDR8
(0x593)

	)

1069 
	#ªg_gpio_pc_pﬁ
 
	`REG_ADDR8
(0x594)

	)

1070 
	#ªg_gpio_pc_ds
 
	`REG_ADDR8
(0x595)

	)

1071 
	#ªg_gpio_pc_gpio
 
	`REG_ADDR8
(0x596)

	)

1072 
	#ªg_gpio_pc_úq_í
 
	`REG_ADDR8
(0x597)

	)

1074 
	#ªg_gpio_pd_ö
 
	`REG_ADDR8
(0x598)

	)

1075 
	#ªg_gpio_pd_õ
 
	`REG_ADDR8
(0x599)

	)

1076 
	#ªg_gpio_pd_€n
 
	`REG_ADDR8
(0x59a)

	)

1077 
	#ªg_gpio_pd_out
 
	`REG_ADDR8
(0x59b)

	)

1078 
	#ªg_gpio_pd_pﬁ
 
	`REG_ADDR8
(0x59c)

	)

1079 
	#ªg_gpio_pd_ds
 
	`REG_ADDR8
(0x59d)

	)

1080 
	#ªg_gpio_pd_gpio
 
	`REG_ADDR8
(0x59e)

	)

1081 
	#ªg_gpio_pd_úq_í
 
	`REG_ADDR8
(0x59f)

	)

1083 
	#ªg_gpio_≥_ö
 
	`REG_ADDR8
(0x5a0)

	)

1084 
	#ªg_gpio_≥_õ
 
	`REG_ADDR8
(0x5a1)

	)

1085 
	#ªg_gpio_≥_€n
 
	`REG_ADDR8
(0x5a2)

	)

1086 
	#ªg_gpio_≥_out
 
	`REG_ADDR8
(0x5a3)

	)

1087 
	#ªg_gpio_≥_pﬁ
 
	`REG_ADDR8
(0x5a4)

	)

1088 
	#ªg_gpio_≥_ds
 
	`REG_ADDR8
(0x5a5)

	)

1089 
	#ªg_gpio_≥_gpio
 
	`REG_ADDR8
(0x5a6)

	)

1090 
	#ªg_gpio_≥_úq_í
 
	`REG_ADDR8
(0x5a7)

	)

1092 
	#ªg_gpio_pf_ö
 
	`REG_ADDR8
(0x5a8)

	)

1093 
	#ªg_gpio_pf_õ
 
	`REG_ADDR8
(0x5a9)

	)

1094 
	#ªg_gpio_pf_€n
 
	`REG_ADDR8
(0x5Ø)

	)

1095 
	#ªg_gpio_pf_out
 
	`REG_ADDR8
(0x5ab)

	)

1096 
	#ªg_gpio_pf_pﬁ
 
	`REG_ADDR8
(0x5ac)

	)

1097 
	#ªg_gpio_pf_ds
 
	`REG_ADDR8
(0x5ad)

	)

1098 
	#ªg_gpio_pf_gpio
 
	`REG_ADDR8
(0x5´)

	)

1099 
	#ªg_gpio_pf_úq_í
 
	`REG_ADDR8
(0x5af)

	)

1101 
	#ªg_gpio_∑_£âög1
 
	`REG_ADDR32
(0x580)

	)

1102 
	#ªg_gpio_∑_£âög2
 
	`REG_ADDR32
(0x584)

	)

1103 
	#ªg_gpio_pb_£âög1
 
	`REG_ADDR32
(0x588)

	)

1104 
	#ªg_gpio_pb_£âög2
 
	`REG_ADDR32
(0x58c)

	)

1105 
	#ªg_gpio_pc_£âög1
 
	`REG_ADDR32
(0x590)

	)

1106 
	#ªg_gpio_pc_£âög2
 
	`REG_ADDR32
(0x594)

	)

1107 
	#ªg_gpio_pd_£âög1
 
	`REG_ADDR32
(0x598)

	)

1108 
	#ªg_gpio_pd_£âög2
 
	`REG_ADDR32
(0x59c)

	)

1109 
	#ªg_gpio_≥_£âög1
 
	`REG_ADDR32
(0x5a0)

	)

1110 
	#ªg_gpio_≥_£âög2
 
	`REG_ADDR32
(0x5a4)

	)

1111 
	#ªg_gpio_pf_£âög1
 
	`REG_ADDR32
(0x5a8)

	)

1112 
	#ªg_gpio_pf_£âög2
 
	`REG_ADDR32
(0x5ac)

	)

1114 
	#ªg_gpio_˘æ
 
	`REG_ADDR32
(0x5a4)

	)

1116 
GPIO_WAKEUP_EN
 = 
BIT
(0),

1117 
GPIO_IRQ_EN
 = 
BIT
(1),

1118 
I2S_SLAVE_EN
 = 
BIT
(2),

1119 
RMII_REFCLK_OUTPUT_EN
 = 
BIT
(3),

1122 
	#ªg_gpio_c⁄fig_func
 
	`REG_ADDR32
(0x5b0)

	)

1123 
	#ªg_gpio_c⁄fig_func0
 
	`REG_ADDR8
(0x5b0)

	)

1125 
FLD_I2S_REFCLK_DMIC
 = 
BIT
(0),

1126 
FLD_I2S_BCK_BB_PEAK
 = 
BIT
(1),

1127 
FLD_I2S_BCK_PWM1
 = 
BIT
(2),

1128 
FLD_I2S_LCK_UART_RX
 = 
BIT
(3),

1129 
FLD_I2S_LCK_PWM2
 = 
BIT
(4),

1130 
FLD_I2S_DO_UART_TX
 = 
BIT
(5),

1131 
FLD_I2S_DO_PWM3
 = 
BIT
(6),

1132 
FLD_I2S_DI_DMIC
 = 
BIT
(7),

1134 
	#ªg_gpio_c⁄fig_func1
 
	`REG_ADDR8
(0x5b1)

	)

1136 
FLD_RP_TX_CYC1
 = 
BIT
(0),

1137 
FLD_RN_BB_RSSI
 = 
BIT
(1),

1138 
FLD_GP6_BB_SS2
 = 
BIT
(2),

1139 
FLD_GP7_RXADC_CLK
 = 
BIT
(3),

1140 
FLD_RP_T0
 = 
BIT
(4),

1141 
FLD_RN_T1
 = 
BIT
(5),

1142 
FLD_GP6_TE
 = 
BIT
(6),

1143 
FLD_GP7_MDC
 = 
BIT
(7),

1145 
	#ªg_gpio_c⁄fig_func2
 
	`REG_ADDR8
(0x5b2)

	)

1147 
FLD_GP8_RXADC_DAT
 = 
BIT
(0),

1148 
FLD_GP9_BB_SS1
 = 
BIT
(1),

1149 
FLD_GP10_BBSS0
 = 
BIT
(2),

1150 
FLD_SWS_BB_GAIN4
 = 
BIT
(3),

1151 
FLD_DMIC_CK_BBCLK_BB
 = 
BIT
(4),

1152 
FLD_DMIC_CK_REFCLK
 = 
BIT
(5),

1153 
FLD_UART_TX
 = 
BIT
(6),

1154 
FLD_UART_RX
 = 
BIT
(7),

1156 
	#ªg_gpio_c⁄fig_func3
 
	`REG_ADDR8
(0x5b3)

	)

1158 
FLD_CN_BB_GAIN3
 = 
BIT
(0),

1159 
FLD_CK_BB_GAIN2
 = 
BIT
(1),

1160 
FLD_DO_BB_GAIN1
 = 
BIT
(2),

1161 
FLD_DI_BB_GAIN0
 = 
BIT
(3),

1163 
FLD_I2S_DO_RXDV
 = 
BIT
(5),

1164 
FLD_I2S_DI_RXER
 = 
BIT
(6),

1165 
FLD_I2S_DI_TXSD
 = 
BIT
(7),

1167 
	#ªg_gpio_c⁄fig_func4
 
	`REG_ADDR8
(0x5b4)

	)

1169 
FLD_DMIC_CK_RX_CLK
 = 
BIT
(0),

1170 
FLD_I2S_DI_RX_DAT
 = 
BIT
(1),

1173 
	#ªg_gpio_wakeup_úq
 
	`REG_ADDR8
(0x5b5)

	)

1175 
FLD_GPIO_WAKEUP_EN
 = 
BIT
(2),

1176 
FLD_GPIO_INTERRUPT_EN
 = 
BIT
(3),

1181 
	#ªg_tmr_˘æ
 
	`REG_ADDR32
(0x620)

	)

1182 
	#ªg_tmr_˘æ16
 
	`REG_ADDR16
(0x620)

	)

1183 
	#ªg_tmr_˘æ8
 
	`REG_ADDR8
(0x620)

	)

1185 
FLD_TMR0_EN
 = 
BIT
(0),

1186 
FLD_TMR0_MODE
 = 
BIT_RNG
(1,2),

1187 
FLD_TMR1_EN
 = 
BIT
(3),

1188 
FLD_TMR1_MODE
 = 
BIT_RNG
(4,5),

1189 
FLD_TMR2_EN
 = 
BIT
(6),

1190 
FLD_TMR2_MODE
 = 
BIT_RNG
(7,8),

1191 
FLD_TMR_WD_CAPT
 = 
BIT_RNG
(9,22),

1192 
FLD_TMR_WD_EN
 = 
BIT
(23),

1193 
FLD_TMR0_STA
 = 
BIT
(24),

1194 
FLD_TMR1_STA
 = 
BIT
(25),

1195 
FLD_TMR2_STA
 = 
BIT
(26),

1196 
FLD_CLR_WD
 = 
BIT
(27),

1198 
	#WATCHDOG_TIMEOUT_COEFF
 18

1199 

	)

1200 
	#ªg_tmr_°a
 
	`REG_ADDR8
(0x623)

	)

1202 
FLD_TMR_STA_TMR0
 = 
BIT
(0),

1203 
FLD_TMR_STA_TMR1
 = 
BIT
(1),

1204 
FLD_TMR_STA_TMR2
 = 
BIT
(2),

1205 
FLD_TMR_STA_WD
 = 
BIT
(3),

1208 
	#ªg_tmr0_ˇ±
 
	`REG_ADDR32
(0x624)

	)

1209 
	#ªg_tmr1_ˇ±
 
	`REG_ADDR32
(0x628)

	)

1210 
	#ªg_tmr2_ˇ±
 
	`REG_ADDR32
(0x62c)

	)

1211 
	#ªg_tmr_ˇ±
(
i
Ë
	`REG_ADDR32
(0x624 + ((iË<< 2))

	)

1212 
	#ªg_tmr0_tick
 
	`REG_ADDR32
(0x630)

	)

1213 
	#ªg_tmr1_tick
 
	`REG_ADDR32
(0x634)

	)

1214 
	#ªg_tmr2_tick
 
	`REG_ADDR32
(0x638)

	)

1215 
	#ªg_tmr_tick
(
i
Ë
	`REG_ADDR32
(0x630 + ((iË<< 2))

	)

1220 
	#ªg_úq_mask
 
	`REG_ADDR32
(0x640)

	)

1221 
	#ªg_úq_¥i
 
	`REG_ADDR32
(0x644)

	)

1222 
	#ªg_úq_§c
 
	`REG_ADDR32
(0x648)

	)

1223 
	#ªg_úq_§c3
 
	`REG_ADDR8
(0x64a)

	)

1225 
FLD_IRQ_TMR0_EN
 = 
BIT
(0),

1226 
FLD_IRQ_TMR1_EN
 = 
BIT
(1),

1227 
FLD_IRQ_TMR2_EN
 = 
BIT
(2),

1228 
FLD_IRQ_USB_PWDN_EN
 = 
BIT
(3),

1229 
FLD_IRQ_DMA_EN
 = 
BIT
(4),

1230 
FLD_IRQ_DAM_FIFO_EN
 = 
BIT
(5),

1231 
FLD_IRQ_UART_EN
 = 
BIT
(6),

1232 
FLD_IRQ_HOST_CMD_EN
 = 
BIT
(7),

1234 
FLD_IRQ_EP0_SETUP_EN
 = 
BIT
(8),

1235 
FLD_IRQ_EP0_DAT_EN
 = 
BIT
(9),

1236 
FLD_IRQ_EP0_STA_EN
 = 
BIT
(10),

1237 
FLD_IRQ_SET_INTF_EN
 = 
BIT
(11),

1238 
FLD_IRQ_EP_DATA_EN
 = 
BIT
(12),

1239 
FLD_IRQ_IRQ4_EN
 = 
BIT
(12),

1240 
FLD_IRQ_ZB_RT_EN
 = 
BIT
(13),

1241 
FLD_IRQ_SW_EN
 = 
BIT
(14),

1242 
FLD_IRQ_AN_EN
 = 
BIT
(15),

1244 
FLD_IRQ_USB_250US_EN
 = 
BIT
(16),

1245 
FLD_IRQ_USB_RST_EN
 = 
BIT
(17),

1246 
FLD_IRQ_GPIO_EN
 = 
BIT
(18),

1247 
FLD_IRQ_PM_EN
 = 
BIT
(19),

1248 
FLD_IRQ_SYSTEM_TIMER
 = 
BIT
(20),

1249 
FLD_IRQ_GPIO_RISC0_EN
 = 
BIT
(21),

1250 
FLD_IRQ_GPIO_RISC1_EN
 = 
BIT
(22),

1251 
FLD_IRQ_GPIO_RISC2_EN
 = 
BIT
(23),

1253 
FLD_IRQ_EN
 = 
BIT_RNG
(24,31),

1255 
	#ªg_úq_í
 
	`REG_ADDR8
(0x643)

	)

1257 
	#ªg_sy°em_tick
 
	`REG_ADDR32
(0x740)

	)

1258 
	#ªg_sy°em_tick_úq
 
	`REG_ADDR32
(0x744)

	)

1259 
	#ªg_sy°em_wakeup_tick
 
	`REG_ADDR32
(0x748)

	)

1260 
	#ªg_sy°em_tick_mode
 
	`REG_ADDR8
(0x74c)

	)

1261 
	#ªg_sy°em_tick_˘æ
 
	`REG_ADDR8
(0x74f)

	)

1264 
FLD_SYSTEM_TICK_START
 = 
BIT
(0),

1265 
FLD_SYSTEM_TICK_STOP
 = 
BIT
(1),

1266 
FLD_SYSTEM_TICK_RUNNING
 = 
BIT
(1),

1268 
FLD_SYSTEM_TICK_IRQ_EN
 = 
BIT
(1),

1274 
	#ªg_pwm_íabÀ
 
	`REG_ADDR8
(0x780)

	)

1275 
	#ªg_pwm_˛k
 
	`REG_ADDR8
(0x781)

	)

1276 
	#ªg_pwm_mode
 
	`REG_ADDR8
(0x782)

	)

1277 
	#ªg_pwm_övît
 
	`REG_ADDR8
(0x783)

	)

1278 
	#ªg_pwm_n_övît
 
	`REG_ADDR8
(0x784)

	)

1279 
	#ªg_pwm_pﬁ
 
	`REG_ADDR8
(0x785)

	)

1281 
	#ªg_pwm_pha£
(
i
Ë
	`REG_ADDR16
(0x788 + (ò<< 1))

	)

1282 
	#ªg_pwm_cy˛e
(
i
Ë
	`REG_ADDR32
(0x794 + (ò<< 2))

	)

1283 
	#ªg_pwm_cmp
(
i
Ë
	`REG_ADDR16
(0x794 + (ò<< 2))

	)

1285 
FLD_PWM_CMP
 = 
BIT_RNG
(0,15),

1286 
FLD_PWM_MAX
 = 
BIT_RNG
(16,31),

1289 
	#ªg_pwm_pul£_num
(
i
Ë
	`REG_ADDR16
(0x7ac + (i << 1))

1290 
	#ªg_pwm_úq_mask
 
	`REG_ADDR8
(0x7b0)

	)

1291 
	#ªg_pwm_úq_°a
 
	`REG_ADDR8
(0x7b1)

	)

1293 
	#ªg_pwm_≤um0
 
	`REG_ADDR16
(0x80c)

	)

1294 
	#ªg_pwm_≤um1
 
	`REG_ADDR16
(0x80e)

	)

1300 
	#ªg_fifo0_d©a
 
	`REG_ADDR32
(0x800)

	)

1301 
	#ªg_fifo1_d©a
 
	`REG_ADDR32
(0x900)

	)

1302 
	#ªg_fifo2_d©a
 
	`REG_ADDR32
(0xa00)

	)

1307 
	#ªg_dfifo0_buf
 
	`REG_ADDR32
(0xb00)

	)

1308 
	#ªg_dfifo1_buf
 
	`REG_ADDR32
(0xb04)

	)

1309 
	#ªg_dfifo2_buf
 
	`REG_ADDR32
(0xb08)

	)

1311 
FLD_DFIFO_BUF_ADDR
 = 
BIT_RNG
(0,15),

1312 
FLD_DFIFO_BUF_SIZE
 = 
BIT_RNG
(16,23),

1315 
	#ªg_dfifo0_addr
 
	`REG_ADDR16
(0xb00)

	)

1316 
	#ªg_dfifo0_size
 
	`REG_ADDR8
(0xb02)

	)

1318 
	#ªg_dfifo_™a_ö
 
	`REG_ADDR8
(0xb03)

	)

1320 
FLD_DFIFO_MIC0_RISING_EDGE
 = 
BIT
(0),

1321 
FLD_DFIFO_MIC_ADC_IN
 = 
BIT
(1),

1323 
FLD_DFIFO_AUD_INPUT_MONO
 = 
BIT
(4) | BIT(5),

1327 
REG_AUD_INPUT_SEL_USB
 = 0,

1328 
REG_AUD_INPUT_SEL_I2S
 = 1,

1329 
REG_AUD_INPUT_SEL_ADC
 = 2,

1330 
REG_AUD_INPUT_SEL_DMIC
 = 3,

1333 
	#ªg_dfifo_sˇÀ
 
	`REG_ADDR8
(0xb04)

	)

1335 
FLD_DFIFO2_DEC_CIC
 = 
BIT_RNG
(0,3),

1336 
FLD_DFIFO0_DEC_SCALE
 = 
BIT_RNG
(4,7),

1339 
	#ªg_aud_hpf_Æc
 
	`REG_ADDR8
(0xb05)

	)

1341 
FLD_AUD_IN_HPF_SFT
 = 
BIT_RNG
(0,3),

1342 
FLD_AUD_IN_HPF_BYPASS
 = 
BIT
(4),

1343 
FLD_AUD_IN_ALC_BYPASS
 = 
BIT
(5),

1344 
FLD_AUD_IN_USB_SET
 = 0x3b,

1347 
	#ªg_aud_Æc_vﬁ
 
	`REG_ADDR8
(0xb06)

	)

1349 
	#ªg_audio_wr_±r
 
	`REG_ADDR16
(0xb10)

	)

1352 
ölöe
 
gë_mic_wr_±r
 () {

1353  
ªg_audio_wr_±r
 << 0;

1358 
	#ªga_xèl_˘æ
 0x01

	)

1360 
FLDA_XTAL_CS
 = 
BIT_RNG
(0,4),

1361 
FLDA_LDO_TRIM_3V
 = 
BIT_RNG
(5,6),

1362 
FLDA_XTAL_COM_REF
 = 
BIT
(7),

1366 
ANALOG_LDO_VOL_1P6
 = 0,

1367 
ANALOG_LDO_VOL_1P8
 = 2,

1370 
	#ªga_vﬁ_ldo_˘æ
 0x02

	)

1372 
FLDA_VOL_LDO_RESV
 = 
BIT_RNG
(0,2),

1373 
FLDA_VOL_LDO_OUTPUT
 = 
BIT_RNG
(3,4),

1374 
FLDA_VOL_BAND_GAP
 = 
BIT_RNG
(5,7),

1377 
	#ªga_pwdn_£âög1
 0x05

	)

1379 
FLDA_32K_RC_PWDN
 = 
BIT
(0),

1380 
FLDA_32K_XTAL_PWDN
 = 
BIT
(1),

1381 
FLDA_32M_RC_PWDN
 = 
BIT
(2),

1382 
FLDA_32M_XTAL_PWDN
 = 
BIT
(3),

1383 
FLDA_LDO_PWDN
 = 
BIT
(4),

1384 
FLDA_BGIREF_3V_PWDN
 = 
BIT
(5),

1385 
FLDA_COMP_PWDN
 = 
BIT
(6),

1386 
FLDA_TEMPSEN_PWDN
 = 
BIT
(7),

1389 
	#ªga_pwdn_ldo
 0x06

	)

1391 
FLDA_RX_LO_LDO_PWDN
 = 
BIT
(0),

1392 
FLDA_BG_I_EXT_PWDN
 = 
BIT
(1),

1393 
FLDA_RX_ANA_LDO_PWDN
 = 
BIT
(2),

1394 
FLDA_RX_RF_LDO_PWDN
 = 
BIT
(3),

1395 
FLDA_PLL_BG_PWDN
 = 
BIT
(4),

1396 
FLDA_PLL_DS_LDO_PWDN
 = 
BIT
(5),

1397 
FLDA_PLL_LDO_PWDN
 = 
BIT
(6),

1398 
FLDA_PLL_LDO2_PWDN
 = 
BIT
(7),

1401 
	#ªga_ldo_£âög1
 0x07

	)

1403 
FLDA_RX_ANA_LDO_O_CTRL
 = 
BIT_RNG
(0,1),

1404 
FLDA_RX_RF_LDO_O_CTRL
 = 
BIT_RNG
(2,3),

1405 
FLDA_PLL_LDO_B2
 = 
BIT_RNG
(4,5),

1406 
FLDA_PLL_LDO_DS
 = 
BIT_RNG
(6,7),

1409 
	#ªga_ldo_£âög2
 0x0c

	)

1411 
FLDA_RX_LOLDO_OUTCTRL
 = 
BIT_RNG
(0,1),

1412 
FLDA_LDO_ANA_LDOTRIM
 = 
BIT
(2),

1413 
FLDA_XTAL_LDO_TRIM
 = 
BIT
(3),

1414 
FLDA_PULLDN_LOLDO
 = 
BIT
(4),

1415 
FLDA_PULLDN_DIGLDO
 = 
BIT
(5),

1416 
FLDA_LDO_SETTING2_RSV
 = 
BIT_RNG
(6,7),

1419 
	#ªga_32k_tm_thª0
 0x10

	)

1420 
	#ªga_32k_tm_thª1
 0x11

	)

1421 
	#ªga_32k_tm_thª2
 0x12

	)

1422 
	#ªga_32k_tm_thª3
 0x13

	)

1424 
FLDA_32K_THR3_H
 = 
BIT_RNG
(0,1),

1425 
FLDA_32K_CONTINUE_MODE
 = 
BIT
(2),

1426 
FLDA_32K_TIMER_EN
 = 
BIT
(3),

1427 
FLDA_DELAY_AFTER_WAKEUP
 = 
BIT_RNG
(4,7),

1429 
	#ªga_dñay_a·î_wakeup
 0x14

	)

1431 
	#ªga_wakeup_pö_l
 0x15

	)

1432 
	#ªga_wakeup_pö_h
 0x16

	)

1433 
	#ªga_pm_˘æ
 0x17

	)

1435 
FLDA_PM_WAKEUP_FROM_DIG
 = 
BIT
(0),

1436 
FLDA_PM_WAKEUP_32K_SEL
 = 
BIT
(1),

1437 
FLDA_PM_RESV0
 = 
BIT_RNG
(2,3),

1438 
FLDA_PM_WAKEUP_POL
 = 
BIT
(4),

1439 
FLDA_PM_RESV1
 = 
BIT
(5),

1440 
FLDA_PM_PWDN_LDO
 = 
BIT
(6),

1441 
FLDA_PM_PWDN_EN
 = 
BIT
(7),

1444 
	#ªga_pwdn_£âög2
 0x18

	)

1446 
FLDA_PWDN_OSC_32K_EN
 = 
BIT
(0),

1447 #if(
MCU_CORE_TYPE
 =
MCU_CORE_5320
)

1448 
FLDA_PWDN_PAD_32K_EN
 = 
BIT
(1),

1450 
FLDA_RESET_32K_TIMER
 = 
BIT
(1),

1452 
FLDA_PWDN_TX
 = 
BIT
(2),

1453 
FLDA_PWDN_RX
 = 
BIT
(3),

1454 
FLDA_PWDN_SAR_ADC
 = 
BIT
(4),

1455 
FLDA_PWDN_LOW_LEAK_LDO
 = 
BIT
(5),

1456 
FLDA_PWDN_REG456_EN
 = 
BIT
(6),

1457 
FLDA_PWDN_ISO_EN
 = 
BIT
(7),

1460 
	#ªga_32k_tm_vÆ0
 0x20

	)

1461 
	#ªga_32k_tm_vÆ1
 0x21

	)

1462 
	#ªga_32k_tm_vÆ2
 0x22

	)

1463 
	#ªga_32k_tm_vÆ3
 0x23

	)

1465 
FLDA_32K_CNT_CONTINUOUS
 = 
BIT
(3),

1466 
FLDA_32K_RST_TIMER
 = 
BIT
(4),

1467 
FLDA_32K_TRIGGER_TIMER
 = 
BIT
(7),

1471 
FLDA_WKUP_POL_PAD0
 = 
BIT
(0),

1472 
FLDA_WKUP_POL_PAD1
 = 
BIT
(1),

1473 
FLDA_WKUP_POL_PAD2
 = 
BIT
(2),

1474 
FLDA_WKUP_POL_PAD3
 = 
BIT
(3),

1475 
FLDA_WKUP_POL_PAD4
 = 
BIT
(4),

1476 
FLDA_WKUP_POL_PAD5
 = 
BIT
(5),

1480 
	#ªga_pkt_£q_no
 0x2d

	)

1481 
	#ªga_dìp¶ìp_rf_chn
 0x2e

	)

1484 
	#ªga_xèl_c£l
 0x81

	)

1486 
FLDA_XTAL_FREQ_OFF
 = 
BIT_RNG
(0, 4),

1487 
FLDA_XTAL_PWDN
 = 
BIT
(5),

1488 
FLDA_XTAL_VOLT
 = 
BIT_RNG
(6,7),

1491 
	#ªga_bp_∂l
 0x84

	)

1493 
FLDA_BP_PLL_CP_PWDN
 = 
BIT
(0),

1494 
FLDA_BP_PLL_3ST_VCO_PWDN
 = 
BIT
(1),

1495 
FLDA_BP_PLL_4ST_VCO_PWDN
 = 
BIT
(2),

1496 
FLDA_BP_PLL_VCO_SEL
 = 
BIT
(3),

1497 
FLDA_BP_PLL_R_DIV
 = 
BIT_RNG
(6,7),

1500 
	#ªga_aud_˘æ
 0x86

	)

1502 
FLDA_AUD_PWDN_LEFT
 = 
BIT
(0),

1503 
FLDA_AUD_PWDN_RIGHT
 = 
BIT
(1),

1504 
FLDA_AUD_MUTE_RIGHT
 = 
BIT
(2),

1505 
FLDA_AUD_MUTE_LEFT
 = 
BIT
(3),

1506 
FLDA_AUD_PRE_GAIN_RIGHT
 = 
BIT_RNG
(4,5),

1507 
FLDA_AUD_PRE_GAIN_LEFT
 = 
BIT_RNG
(6,7),

1510 
	#ªga_aud_˘æ2
 0x87

	)

1512 
FLDA_AUD_PST_GAIN_RIGHT
 = 
BIT_RNG
(0,3),

1513 
FLDA_AUD_PST_GAIN_LEFT
 = 
BIT_RNG
(4,7),

1516 
	#ªga_dcdc_˘æ
 0x88

	)

1518 
FLDA_DCDC_RESV
 = 
BIT
(0),

1519 
FLDA_RNS_PWDN
 = 
BIT
(1),

1520 
FLDA_DCDC_RESETB
 = 
BIT
(2),

1521 
FLDA_DCDC_6P75_PWDN
 = 
BIT
(3),

1522 
FLDA_DCDC_IN_2P8_PS
 = 
BIT
(4),

1523 
FLDA_DCDC_OUT_2P8_SEL
 = 
BIT
(5),

1524 
FLDA_DCDC_OUT_6P6_SEL
 = 
BIT
(6),

1525 
FLDA_DCDC_2P8_PWDN
 = 
BIT
(7),

1528 
	#ªga_dig_ldo_£l_©b
 0x89

	)

1530 
FLDA_LDO_SEL_ATB
 = 
BIT_RNG
(0,2),

1531 
FLDA_PWDN_CLK_BB
 = 
BIT
(3),

1532 
FLDA_PWDN_CLK_RF
 = 
BIT
(4),

1533 
FLDA_PWDN_BUF_RCCAL
 = 
BIT
(5),

1534 
FLDA_PWDN_BUF_DIG
 = 
BIT
(6),

1536 
	#ªga_adc_£âög1
 0x8a

	)

1537 
	#ªga_adc_£âög2
 0x8b

	)

1539 
FLDA_RX_ADC_COMPLEX_EN
 = 
BIT
(0),

1540 
FLDA_RX_ADC_CTUNE
 = 
BIT_RNG
(1,4),

1541 
FLDA_RX_ADC_DLY_CTRL
 = 
BIT_RNG
(5,6),

1542 
FLDA_RX_ADC_PWDN
 = 
BIT
(7),

1545 
	#ªga_rx_ a
 0x91

	)

1547 
FLDA_RX_LNA_OUT_TUNE
 = 
BIT_RNG
(0,2),

1548 
FLDA_RX_LNA_BIAS
 = 
BIT_RNG
(3,5),

1549 
FLDA_RX_LNA_ON
 = 
BIT
(6),

1550 
FLDA_PA_TX_EXT_C1_EN
 = 
BIT
(7),

1553 
	#ªga_rx_pga
 0x94

	)

1555 
FLDA_RX_PGA_IQ_SWAP_EN
 = 
BIT
(0),

1556 
FLDA_RX_PGA_BW_TUNE
 = 
BIT
(1),

1557 
FLDA_RX_PGA_CAP_CTRL
 = 
BIT_RNG
(2,5),

1558 
FLDA_RX_PGA_COMP_EN
 = 
BIT
(6),

1559 
FLDA_RX_PGA_PWDN
 = 
BIT
(7),

1561 
	#ªga_rx_ã°
 0x99

	)

1563 
FLDA_RF_PEAK_DET_DLY1_EN
 = 
BIT
(0),

1564 
FLDA_RF_PEAK_DET_DLY2_EN
 = 
BIT
(1),

1565 
FLDA_RF_PEAK_DET_DLY3_EN
 = 
BIT
(2),

1566 
FLDA_TEST_PGA_OUT_EN
 = 
BIT
(3),

1567 
FLDA_TEST_PGA_IN_EN
 = 
BIT
(4),

1568 
FLDA_TEST_IQ_MIXER_EN
 = 
BIT
(5),

1569 
FLDA_RF_PEAK_DET1_EN
 = 
BIT
(6),

1570 
FLDA_RF_PEAK_DET2_EN
 = 
BIT
(7),

1573 
	#ªga_tx_∑_˘æ
 0x9e

	)

1575 
FLDA_PA_TX_BIAS
 = 
BIT_RNG
(0,4),

1576 
FLDA_PA_TX_UNIT
 = 
BIT_RNG
(3,5),

1578 
	#ªga_tx_∑_˘æ2
 0x9f

	)

1580 
	#ªga_pfd
 0xa5

	)

1582 
FLDA_PFD_MUX_L
 = 
BIT_RNG
(0,2),

1583 
FLDA_PFD_NP_INTG
 = 
BIT
(3),

1584 
FLDA_INTG_PFD_S0
 = 
BIT
(4),

1585 
FLDA_INTG_PFD_S1
 = 
BIT
(5),

1586 
FLDA_REFBUF_PWDN
 = 
BIT
(6),

1587 
FLDA_REG_DC_MOD0
 = 
BIT
(7),

1590 
	#ªga_ötg_n0
 0xa0

	)

1592 
FLDA_DPLL_EN
 = 
BIT
(0),

1593 
FLDA_IDIV2_UP_RX
 = 
BIT
(1),

1594 
FLDA_IDIV2_UP_TX
 = 
BIT
(2),

1595 
FLDA_RX_INTG_N0
 = 
BIT_RNG
(3,7),

1598 
	#ªga_ötg_n1
 0xa1

	)

1600 
FLDA_RX_INTG_N1
 = 
BIT_RNG
(0,4),

1601 
FLDA_RX_IB1
 = 
BIT_RNG
(5,6),

1602 
FLDA_LPF_PWDN
 = 
BIT
(7),

1605 
	#ªga_ötg_rdiv
 0xa2

	)

1607 
FLDA_INTG_RDIV
 = 
BIT_RNG
(0,5),

1608 
FLDA_MASH2_EN
 = 
BIT
(6),

1609 
FLDA_NDIV_EN
 = 
BIT
(7),

1612 
	#ªga_ªg_dc_mod1
 0xa6

	)

1613 
	#ªga_ªg_dc_mod2
 0xa7

	)

1614 
	#ªga_vco_ˇl_comp
 0xa8

	)

1616 
FLDA_RF_TEST_PWDN
 = 
BIT
(0),

1617 
FLDA_RX_IB
 = 
BIT_RNG
(1,2),

1618 
FLDA_VCO_CAL_COMP
 = 
BIT_RNG
(3,7),

1621 
	#ªga_vco_£âög
 0xa9

	)

1623 
FLDA_TX_IB
 = 
BIT_RNG
(0,1),

1624 
FLDA_VCO_RXI
 = 
BIT_RNG
(2,4),

1625 
FLDA_VCO_TXI
 = 
BIT_RNG
(5,7),

1628 
	#ªga_ötg_rxˇp
 0xØ

	)

1630 
FLDA_PWDN_INTG_PLL
 = 
BIT
(0),

1631 
FLDA_INTG_RXCAP
 = 
BIT_RNG
(1,7),

1634 
	#ªga_ötg_txˇp
 0xab

	)

1635 
	#ªga_∂l_d∂l
 0xac

	)

1636 
	#ªga_∂l_d∂l_£âög
 0xad

	)

1638 
FLDA_PLL_DPLL
 = 
BIT_RNG
(0,1),

1639 
FLDA_PLL_DPLL_ADJ
 = 
BIT_RNG
(2,4),

1640 
FLDA_PLL_DPLL_REF
 = 
BIT_RNG
(5,6),

1641 
FLDA_TXCALDIV2BUF_PWDN
 = 
BIT
(7),

1645 
	#ªga_∂l_d∂l_waô
 0x´

	)

1647 
FLDA_PLL_DPLL_WAIT
 = 
BIT_RNG
(0,5),

1648 
FLDA_RX_MAN_EN
 = 
BIT
(6),

1649 
FLDA_TX_MAN_EN
 = 
BIT
(7),

1653 
	#ªga_wakeup_í_vÆ0
 0x41

	)

1654 
	#ªga_wakeup_í_vÆ1
 0x42

	)

1655 
	#ªga_wakeup_í_vÆ2
 0x43

	)

1656 
	#øga_gpio_wkup_pﬁ
 0x44

	)

1658 
	#øga_pga_gaö0
 0x86

	)

1659 
	#øga_pga_gaö1
 0x87

	)

1664 #i‡
deföed
(
__˝lu•lus
)

	@platform/chip_826x/rf_drv.h

24 #i‚def 
RF_H


25 
	#RF_H


	)

27 
	~"ªgi°î.h
"

33 
	mRF_OSC_16M
 = 0,

34 
	mRF_OSC_12M
 = 1

35 } 
	tRF_OscSñTy≥Def
;

41 
	mRF_MODE_BLE_2M
 = 0,

42 
	mRF_MODE_BLE_1M
 = 1,

43 
	mRF_MODE_ZIGBEE_250K
 = 2,

44 
	mRF_MODE_PRIVATE_2M
 = 3,

45 
	mRF_MODE_STANDARD_BLE_1M
 = 4

46 } 
	tRF_ModeTy≥Def
;

52 
	mRF_MODE_TX
 = 0,

53 
	mRF_MODE_RX
 = 1,

54 
	mRF_MODE_AUTO
 = 2,

55 
	mRF_MODE_OFF
 = 3

56 } 
	tRF_SètusTy≥Def
;

62 
	mRF_POWER_7dBm
 = 0,

63 
	mRF_POWER_5dBm
 = 1,

64 
	mRF_POWER_m0P6dBm
 = 2,

65 
	mRF_POWER_m4P3dBm
 = 3,

66 
	mRF_POWER_m9P5dBm
 = 4,

67 
	mRF_POWER_m13P6dBm
 = 5,

68 
	mRF_POWER_m18P8dBm
 = 6,

69 
	mRF_POWER_m23P3dBm
 = 7,

70 
	mRF_POWER_m27P5dBm
 = 8,

71 
	mRF_POWER_m30dBm
 = 9,

72 
	mRF_POWER_m37dBm
 = 10,

73 
	mRF_POWER_OFF
 = 11,

74 } 
	tRF_PowîTy≥Def
;

76 
RF_ModeTy≥Def
 
g_RFMode
;

78 
	#TP0_THRESHOLD_H
 0x4a

	)

79 
	#TP0_THRESHOLD_L
 0x36

	)

80 
	#TP0_DEFAULT_VALUE
 0x40

	)

82 
	#TP1_THRESHOLD_H
 0x43

	)

83 
	#TP1_THRESHOLD_L
 0x2f

	)

84 
	#TP1_DEFAULT_VALUE
 0x39

	)

87 
	#RF_BLE_PACKET_LENGTH_OK
(
p
Ë’[0] =’[13]&0x3f)+17)

	)

88 
	#RF_BLE_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x40)

	)

90 
	#ZIGBEE_MAX_PACKET_SIZE
 127

	)

91 
	#RF_PACKET_LENGTH_OK
(
p
Ë(’[0] =p[12]+13Ë&&Ö[0] <(
ZIGBEE_MAX_PACKET_SIZE
+13))

	)

92 
	#RF_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x10)

	)

93 
	#RF_GET_TIMESTAMP
(
p
Ë’[8] | (p[9]<<8Ë| (p[10]<<16Ë| (p[11]<<24))

	)

94 
	#RF_GET_PKT_RSSI
(
p
Ë’[4])

	)

95 
	#RF_GET_PKT_PAYLOAD_LEN
(
p
Ë’[12])

	)

98 
	#RFDMA_RX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_RF_RX
))

	)

99 
	#RFDMA_RX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_RF_RX
))

	)

101 
	#RFDMA_TX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_RF_TX
))

	)

102 
	#RFDMA_TX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_RF_TX
))

	)

104 
	#RF_TxFöishCÀ¨Fœg
(Ë(
ªg_rf_úq_°©us
 = 
FLD_RF_IRQ_TX
)

	)

105 
	#RF_RxFöishCÀ¨Fœg
(Ë(
ªg_rf_úq_°©us
 = 
FLD_RF_IRQ_RX
)

	)

106 
	#RF_TxFöish
(Ë(
ªg_rf_úq_°©us
 & 
FLD_RF_IRQ_TX
)

	)

108 
ölöe
 
	$rf_úq_íabÀ
(
msk
)

110 
ªg_rf_úq_mask
 |
msk
;

111 
	}
}

113 
ölöe
 
	$rf_úq_dißbÀ
(
msk
)

115 
ªg_rf_úq_mask
 &(~
msk
);

116 
	}
}

118 
ölöe
 
	$RF_rx_buf„r_ªc⁄fig
(*
RF_RxAddr
)

120 
ªg_dma2_addr
 = ()(()
RF_RxAddr
);

121 
	}
}

127 
RF_Ba£B™dRe£t
();

137 
RF_Inô
(
RF_OscSñTy≥Def
 
OscSñ
, 
RF_ModeTy≥Def
 
RF_Mode
);

139 
RF_ˇl
(
çAddr
, 
ˇpAddr
);

151 
RF_SëGaöM™uÆMax
();

161 
RF_SëAgc
();

175 
RF_ModeSë
(
RF_ModeTy≥Def
 
RF_Mode
);

192 
RF_Upd©eTpVÆue
(
RF_ModeTy≥Def
 
RF_Mode
 ,
RF_TPLow
, 
RF_TPHigh
);

202 
RF_Upd©eC≠VÆue
(
RF_C≠
);

211 
RF_PowîLevñSë
(
RF_PowîTy≥Def
 
RF_TxPowîLevñ
);

229 
RF_TrxSèãSë
(
RF_SètusTy≥Def
 
RF_Sètus
, sig√d 
RF_Ch™√l
);

237 
RF_SètusTy≥Def
 
RF_TrxSèãGë
();

260 
RF_TxPkt
(*
RF_TxAddr
);

279 
RF_RxBuf„rSë
(*
RF_RxAddr
, 
Size
, 
Pögp⁄gEn
);

281 
RF_rx_cfg
(
Size
, 
Pögp⁄gEn
);

292 
RF_SèπStx
(*
RF_TxAddr
, 
RF_SèπTick
);

305 
RF_SèπSrx
(
RF_SèπTick
, 
RF_RxTimeoutUs
);

323 
RF_SèπStxToRx
(*
RF_TxAddr
, 
RF_SèπTick
, 
RF_RxTimeoutUs
);

344 
RF_SèπSrxToTx
(* 
RF_TxAddr
 ,
RF_SèπTick
,
RF_RxTimeoutUs
);

351 
RF_SëTxRxOff
();

360 sig√d 
RF_GëRssi
();

362 
RF_ª£t
();

371 
RF_RxBuf„rReque°
();

385 
RF_RxBuf„rCÀ¨Fœg
(
RF_RxBuf„rIdx
);

	@platform/chip_826x/spi.h

24 #i‚de‡
SPI_H


25 
	#SPI_H


	)

27 
	~"gpio.h
"

33 
	mSPI_MODE0
 = 0,

34 
	mSPI_MODE2
,

35 
	mSPI_MODE1
,

36 
	mSPI_MODE3
,

37 } 
	tSPI_ModeTy≥Def
;

43 
	mSPI_PIN_GPIOA
 = 0,

44 
	mSPI_PIN_GPIOB
,

45 } 
	tSPI_PöTy≥Def
;

52 
SPI_Ma°îPöSñe˘
(
SPI_PöTy≥Def
 
PöGΩ
);

59 
SPI_Ma°îCSPöSñe˘
(
GPIO_PöTy≥Def
 
CSPö
);

68 
SPI_Ma°îInô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

81 
SPI_Wrôe
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

94 
SPI_Ród
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

103 
SPI_SœveInô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

110 
SPI_SœvePöSñe˘
(
SPI_PöTy≥Def
 
PöGΩ
);

	@platform/chip_826x/timer.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

29 
	mTIMER0
 =0,

30 
	mTIMER1
 =1,

31 
	mTIMER2
 =2,

32 }
	tTIMER_Ty≥Def
;

35 
	mTIMER_MODE_SYSCLK
 =0,

36 
	mTIMER_MODE_GPIO_TRIGGER
 =1,

37 
	mTIMER_MODE_GPIO_WIDTH
 =2,

38 
	mTIMER_MODE_TICK
 =3,

39 }
	tTIMER_ModeTy≥Def
;

41 
ölöe
 
	$timî_£t_öô_tick
(
TIMER_Ty≥Def
 
ty≥
, 
öô_tick
)

43 
	`ªg_tmr_tick
(
ty≥
Ë
öô_tick
;

44 
	}
}

46 
ölöe
 
	$timî_£t_ˇp_tick
(
TIMER_Ty≥Def
 
ty≥
, 
ˇp_tick
)

48 
	`ªg_tmr_ˇ±
(
ty≥
Ë
ˇp_tick
;

49 
	}
}

51 
ölöe
 
	$timî_úq_íabÀ
(
TIMER_Ty≥Def
 
ty≥
)

53 
ªg_úq_mask
 |(1 << 
ty≥
);

54 
	}
}

56 
ölöe
 
	$°imî_£t_úq_ˇ±uª
(
ˇp_tick
)

58 
ªg_sy°em_tick_úq
 = 
ˇp_tick
;

59 
	}
}

61 
ölöe
 
	$°imî_úq_íabÀ
()

63 
ªg_sy°em_tick_mode
 |
FLD_SYSTEM_TICK_IRQ_EN
;

64 
	}
}

66 
ölöe
 
	$°imî_£t_úq_mask
()

68 
ªg_úq_mask
 |
FLD_IRQ_SYSTEM_TIMER
;

69 
	}
}

71 
ölöe
 
	$°imî_˛r_úq_mask
()

73 
ªg_úq_mask
 &~()
FLD_IRQ_SYSTEM_TIMER
;

74 
	}
}

76 
timî_£t_mode
(
TIMER_Ty≥Def
 
ty≥
, 
TIMER_ModeTy≥Def
 
mode
);

78 
timî_°¨t
(
TIMER_Ty≥Def
 
ty≥
);

80 
timî_°›
(
TIMER_Ty≥Def
 
ty≥
);

	@platform/chip_826x/uart.h

24 #i‚de‡
UART_H


25 
	#UART_H


	)

28 
	eHARDWARECONTROL
{

29 
	mCTSWODDPARITY
 = 0x0e,

30 
	mCTSWEVENPARITY
 = 0x06,

31 
	mCTSONLY
 = 0x02,

32 
	mODDPARITY
 = 0x0C,

33 
	mEVENPARITY
 = 0x04,

34 
	mNOCONTROL
 = 0x00,

37 
	eUARTIRQSOURCE
{

38 
	mNONE_DMA_IRQ
,

39 
	mUART_RX_DMA0
=1,

40 
	mUART_TX_DMA1
,

41 
	mRF_RX_DMA2
,

42 
	mRF_TX_DMA3
=4,

48 
	#UART_GPIO_CFG_PA6_PA7
(Ëdo{\

	)

52 
	#UART_GPIO_CFG_PB2_PB3
(Ëdo{\

	)

55 
	}

	$}whûe
(0)

56 
	#UART_GPIO_CFG_PC2_PC3
(Ëdo{\

	)

59 
	}

	$}whûe
(0)

69 
	`u¨t_Re£t
();

71 vﬁ©ûê
u¨t_°©us
;

81 
	`u¨t_Eº‹CLR
();

95 
	`u¨t_Inô
(
baud_øã
,
í_rx_úq
,
í_tx_úq
,
HARDWARECONTROL
 
hdwC
);

105 
	`u¨t_Síd
(*
addr
);

114 
	`u¨t_pktSíd
(*
d©a
);

133 
UARTIRQSOURCE
 
	`DMA_IRQSour˚Gë
();

146 
	`u¨t_RecBuffInô
(*
ªcAddr
, 
ªcBuffLí
);

	@platform/chip_826x/usbhw.h

24 #i‚de‡
USBHW_H


25 
	#USBHW_H


	)

27 
	~"bô.h
"

28 
	~"usbhw_i.h
"

29 
	~"gpio.h
"

33 
	mUSB_EDP_PRINTER_IN
 = 8,

34 
	mUSB_EDP_MOUSE
 = 2,

35 
	mUSB_EDP_KEYBOARD_IN
 = 1,

36 
	mUSB_EDP_KEYBOARD_OUT
 = 3,

37 
	mUSB_EDP_AUDIO_IN
 = 4,

38 
	mUSB_EDP_PRINTER_OUT
 = 5,

39 
	mUSB_EDP_SPEAKER
 = 6,

40 
	mUSB_EDP_MIC
 = 7,

41 #if(
USB_GAMEPAD_ENABLE
)

42 
	mUSB_EDP_GAMEPAD_IN
 = 3,

43 
	mUSB_EDP_GAMEPAD_OUT
 = 5,

45 
	mUSB_EDP_MS_IN
 = 
USB_EDP_PRINTER_IN
,

46 
	mUSB_EDP_MS_OUT
 = 
USB_EDP_PRINTER_OUT
,

47 
	mUSB_EDP_SOMATIC_IN
 = 
USB_EDP_AUDIO_IN
,

48 
	mUSB_EDP_SOMATIC_OUT
 = 
USB_EDP_PRINTER_OUT
,

49 
	mUSB_EDP_CDC_IN
 = 4,

50 
	mUSB_EDP_CDC_OUT
 = 5,

55 
	mUSB_HID_AUDIO
 = 2,

56 
	mUSB_HID_MOUSE
 = 1,

57 
	mUSB_HID_KB_MEDIA
 = 3,

58 
	mUSB_HID_KB_SYS
 = 4,

59 #if(
USB_GAMEPAD_ENABLE
)

60 
	mUSB_HID_GAMEPAD
 = 5,

62 
	mUSB_HID_SOMATIC
 = 5,

71 
ölöe
 
	$usb_dp_puŒup_í
(
í
)

73 
d©
 = 
	`™Æog_ªad
(0x00);

74 i‡(
í
) {

75 
d©
 &~
	`BIT
(4);

77 
d©
 |
	`BIT
(4);

80 
	`™Æog_wrôe
(0x00, 
d©
);

81 
	}
}

88 
ölöe
 
	$usb_£t_pö_í
()

91 
	`gpio_£t_func
(
GPIO_PE3
, 
AS_GPIO
);

92 
	`gpio_£t_ouçut_í
(
GPIO_PE3
, 1);

93 
	`gpio_wrôe
(
GPIO_PE3
, 0);

95 
	`gpio_£t_func
(
GPIO_PE2
, 
AS_USB
);

96 
	`gpio_£t_func
(
GPIO_PE3
, 
AS_USB
);

97 
	`gpio_£t_öput_í
(
GPIO_PE2
, 1);

98 
	`gpio_£t_öput_í
(
GPIO_PE3
, 1);

99 
	`usb_dp_puŒup_í
(1);

100 
	}
}

108 
usbhw_dißbÀ_m™uÆ_öãºu±
(
m
);

115 
usbhw_íabÀ_m™uÆ_öãºu±
(
m
);

124 
usbhw_wrôe_ï
(
ï
, * 
d©a
, 
Àn
);

132 
usbhw_wrôe_˘æ_ï_u16
(
v
);

139 
usbhw_ªad_˘æ_ï_u16
();

	@platform/chip_826x/usbhw_i.h

24 #i‚de‡
USBHW_I_H


25 
	#USBHW_I_H


	)

27 
	~"ªgi°î.h
"

34 
ölöe
 
	$usbhw_ª£t_˘æ_ï_±r
() {

35 
ªg_˘æ_ï_±r
 = 0;

36 
	}
}

43 
ölöe
 
	$usbhw_gë_˘æ_ï_úq
() {

44  
ªg_˘æ_ï_úq_°a
;

45 
	}
}

52 
ölöe
 
	$usbhw_˛r_˘æ_ï_úq
(
ï
) {

53 
ªg_˘æ_ï_úq_°a
 = 
ï
;

54 
	}
}

61 
ölöe
 
	$usbhw_wrôe_˘æ_ï_˘æ
(
d©a
) {

62 
ªg_˘æ_ï_˘æ
 = 
d©a
;

63 
	}
}

70 
ölöe
 
	$usbhw_ªad_˘æ_ï_d©a
() {

71  
ªg_˘æ_ï_d©
;

72 
	}
}

79 
ölöe
 
	$usbhw_wrôe_˘æ_ï_d©a
(
d©a
) {

80 
ªg_˘æ_ï_d©
 = 
d©a
;

81 
	}
}

88 
ölöe
 
	$usbhw_is_˘æ_ï_busy
() {

89  
ªg_˘æ_ï_úq_°a
 & 
FLD_USB_EP_BUSY
;

90 
	}
}

97 
ölöe
 
	$usbhw_ª£t_ï_±r
(
ï
) {

98 
	`ªg_usb_ï_±r
(
ï
 & 0x07) = 0;

99 
	}
}

105 
ölöe
 
	$usbhw_£t_ïs_úq_mask
(
mask
){

106 
ªg_usb_mask
|=
mask
;

107 
	}
}

113 
ölöe
 
	$usbhw_˛r_ïs_úq_mask
(
mask
){

114 
ªg_usb_mask
 &=(~
mask
);

115 
	}
}

122 
ölöe
 
	$usbhw_gë_ïs_úq
() {

123  
ªg_usb_úq
;

124 
	}
}

131 
ölöe
 
	$usbhw_˛r_ïs_úq
(
ï
) {

132 
ªg_usb_úq
 = 
ï
;

133 
	}
}

140 
ölöe
 
	$usbhw_ªad_ï_d©a
(
ï
) {

141  
	`ªg_usb_ï_d©
(
ï
 & 0x07);

142 
	}
}

149 
ölöe
 
	$usbhw_wrôe_ï_d©a
(
ï
, 
d©a
) {

150 
	`ªg_usb_ï_d©
(
ï
 & 0x07Ë
d©a
;

151 
	}
}

158 
ölöe
 
	$usbhw_is_ï_busy
(
ï
) {

159  
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë& 
FLD_USB_EP_BUSY
;

160 
	}
}

167 
ölöe
 
	$usbhw_d©a_ï_ack
(
ï
) {

168 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_BUSY
;

169 
	}
}

176 
ölöe
 
	$usbhw_d©a_ï_°Æl
(
ï
) {

177 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_STALL
;

178 
	}
}

185 
ölöe
 
	$usbhw_£t_¥öãr_thªshﬁd
(
th
) {

186 
ªg_usb_ï8_£nd_thª
 = 
th
;

187 
	}
}

	@platform/chip_826x/watchdog.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

29 
ölöe
 
	$wd_£t_öãrvÆ_ms
(
öãrvÆ_ms
)

31 
ªg_tmr2_tick
 = 0;

32 
ªg_tmr_˘æ
 |
	`MASK_VAL
(
FLD_TMR_WD_CAPT
, (
öãrvÆ_ms
 * 
tickPîUs
 * 1000 >> 
WATCHDOG_TIMEOUT_COEFF
));

33 
	}
}

35 
ölöe
 
	$wd_°¨t
()

37 
	`SET_FLD
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

38 
	}
}

40 
ölöe
 
	$wd_°›
()

42 
	`CLR_FLD
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

43 
	}
}

45 
ölöe
 
	$wd_˛ór
()

47 
	`SET_FLD
(
ªg_tmr_˘æ
, 
FLD_CLR_WD
);

48 
	}
}

	@platform/chip_8278/adc.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"™Æog.h
"

28 
	~"ªgi°î.h
"

29 
	~"gpio.h
"

42 
	madc_vªf
;

43 
	madc_ˇlib_í
;

44 }
	tadc_vªf_˘r_t
;

46 
adc_vªf_˘r_t
 
adc_vªf_cfg
;

52 
	mADC_VREF_0P9V
 = 0x01,

53 
	mADC_VREF_1P2V
 = 0x02,

54 }
	tADC_RefVﬁTy≥Def
;

60 
	mADC_VBAT_DIVIDER_OFF
 = 0,

61 
	mADC_VBAT_DIVIDER_1F3
=2,

66 }
	tADC_Vb©DivTy≥Def
;

68 
adc_vb©_dividî
;

74 
	mNOINPUTN
,

75 
	mB0N
,

76 
	mB1N
,

77 
	mB2N
,

78 
	mB3N
,

79 
	mB4N
,

80 
	mB5N
,

81 
	mB6N
,

82 
	mB7N
,

83 
	mC4N
,

84 
	mC5N
,

85 
	mPGA0N
,

86 
	mPGA1N
,

87 
	mTEMSENSORN
,

88 
	mTEMSENSORN_EE
,

89 
	mGND
,

90 }
	tADC_I≈utNchTy≥Def
;

96 
	mNOINPUTP
,

97 
	mB0P
,

98 
	mB1P
,

99 
	mB2P
,

100 
	mB3P
,

101 
	mB4P
,

102 
	mB5P
,

103 
	mB6P
,

104 
	mB7P
,

105 
	mC4P
,

106 
	mC5P
,

107 
	mPGA0P
,

108 
	mPGA1P
,

109 
	mTEMSENSORP
,

110 
	mTEMSENSORP_EE
,

111 
	mVBAT
,

112 }
	tADC_I≈utPchTy≥Def
;

118 
	mRES8
,

119 
	mRES10
,

120 
	mRES12
,

121 
	mRES14


122 }
	tADC_ResTy≥Def
;

128 
	mDIFFERENTIAL_MODE
 = 1,

129 }
	tADC_I≈utModeTy≥Def
;

135 
	mSAMPLING_CYCLES_3
,

136 
	mSAMPLING_CYCLES_6
,

137 
	mSAMPLING_CYCLES_9
,

138 
	mSAMPLING_CYCLES_12
,

139 
	mSAMPLING_CYCLES_15
,

140 
	mSAMPLING_CYCLES_18
,

141 
	mSAMPLING_CYCLES_21
,

142 
	mSAMPLING_CYCLES_24
,

143 
	mSAMPLING_CYCLES_27
,

144 
	mSAMPLING_CYCLES_30
,

145 
	mSAMPLING_CYCLES_33
,

146 
	mSAMPLING_CYCLES_36
,

147 
	mSAMPLING_CYCLES_39
,

148 
	mSAMPLING_CYCLES_42
,

149 
	mSAMPLING_CYCLES_45
,

150 
	mSAMPLING_CYCLES_48
,

151 }
	tADC_SampCycTy≥Def
;

157 
	mADC_MISC_CHN
 = 
BIT
(2),

158 }
	tADC_ChTy≥Def
;

164 
	mADC_PRESCALER_1
 = 0x00,

165 
	mADC_PRESCALER_1F8
 = 0x03,

166 }
	tADC_PªSˇlögTy≥Def
;

173 
	mADC_NORMAL_MODE
 = 0,

174 }
	tADC_ModeTy≥Def
;

183 
ölöe
 
	$adc_ˇlib_vªf_íabÀ
(
í
)

185 
adc_vªf_cfg
.
adc_ˇlib_í
 = 
í
;

186 
	}
}

193 
ölöe
 
	$adc_ª£t_adc_moduÀ
()

195 
ªg_r°1
 = 
FLD_RST1_ADC
;

196 
ªg_r°1
 = 0;

197 
	}
}

204 
ölöe
 
	$adc_íabÀ_˛k_24m_to_ßr_adc
(
í
)

206 if(
í
)

208 
	`™Æog_wrôe
(
¨eg_˛k_£âög
, 
	`™Æog_ªad
◊ªg_˛k_£âögË| 
FLD_CLK_24M_TO_SAR_EN
);

212 
	`™Æog_wrôe
(
¨eg_˛k_£âög
, 
	`™Æog_ªad
◊ªg_˛k_£âögË& ~
FLD_CLK_24M_TO_SAR_EN
);

214 
	}
}

223 
	#¨eg_adc_ßm∂ög_˛k_div
 0xf4

	)

225 
	mFLD_ADC_SAMPLE_CLK_DIV
 = 
BIT_RNG
(0,2),

233 
ölöe
 
	$adc_£t_ßm∂e_˛k
(
div
)

236 
	`™Æog_wrôe
(
¨eg_adc_ßm∂ög_˛k_div
, 
div
 & 0x07 );

237 
	}
}

248 
	#¨eg_adc_vªf
 0xó

	)

250 
	mFLD_ADC_VREF_CHN_M
 = 
BIT_RNG
(0,1),

258 
ölöe
 
	$adc_£t_vªf
(
ADC_RefVﬁTy≥Def
 
vRef_M
)

260 
	`™Æog_wrôe
(
¨eg_adc_vªf
, 
vRef_M
);

261 
	}
}

269 
adc_£t_ªf_vﬁège
(
ADC_RefVﬁTy≥Def
 
v_ªf
);

272 
	#¨eg_adc_vªf_vb©_div
 0xf9

	)

274 
	mFLD_ADC_VREF_VBAT_DIV
 = 
BIT_RNG
(2,3),

281 
ölöe
 
	$adc_£t_vªf_vb©_dividî
(
ADC_Vb©DivTy≥Def
 
vb©_div
)

283 
	`™Æog_wrôe
(
¨eg_adc_vªf_vb©_div
, (
	`™Æog_ªad
◊ªg_adc_vªf_vb©_divË& (~
FLD_ADC_VREF_VBAT_DIV
)Ë| (
vb©_div
 << 2));

284 if(
vb©_div
){

285 
adc_vb©_dividî
 = 5 - 
vb©_div
;

287 
adc_vb©_dividî
 = 1;

289 
	}
}

326 
	#¨eg_adc_aö_chn_misc
 0xeb

	)

328 
	mFLD_ADC_AIN_NEGATIVE
 = 
BIT_RNG
(0,3),

329 
	mFLD_ADC_AIN_POSITIVE
 = 
BIT_RNG
(4,7),

338 
ölöe
 
	$adc_£t_aö_chn_misc
(
ADC_I≈utPchTy≥Def
 
p_aö
, 
ADC_I≈utNchTy≥Def
 
n_aö
)

340 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, 
n_aö
 | 
p_aö
 << 4);

341 
	}
}

348 
ölöe
 
	$adc_£t_aö_√g©ive_chn_misc
(
ADC_I≈utNchTy≥Def
 
v_aö
)

350 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_miscË& (~
FLD_ADC_AIN_NEGATIVE
)Ë| (
v_aö
));

351 
	}
}

357 
ölöe
 
	$adc_£t_aö_posôive_chn_misc
(
ADC_I≈utPchTy≥Def
 
v_aö
)

359 
	`™Æog_wrôe
(
¨eg_adc_aö_chn_misc
, (
	`™Æog_ªad
◊ªg_adc_aö_chn_miscË& (~
FLD_ADC_AIN_POSITIVE
)Ë| (
v_aö
 << 4));

360 
	}
}

368 
adc_£t_ªsﬁuti⁄
(
ADC_ResTy≥Def
 
v_ªs
);

372 
	#™¨eg_adc_ªs_m
 0xec

	)

374 
	mFLD_ADC_RES_M
 = 
BIT_RNG
(0,1),

375 
	mFLD_ADC_EN_DIFF_CHN_M
 = 
BIT
(6),

382 
ölöe
 
	$adc_£t_ªsﬁuti⁄_chn_misc
(
ADC_ResTy≥Def
 
v_ªs
)

384 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, (
	`™Æog_ªad
◊«ªg_adc_ªs_mË& (~
FLD_ADC_RES_M
)Ë| (
v_ªs
));

385 
	}
}

392 
ölöe
 
	$adc_£t_öput_mode_chn_misc
(
ADC_I≈utModeTy≥Def
 
m_öput
)

395 
	`™Æog_wrôe
(
™¨eg_adc_ªs_m
, 
	`™Æog_ªad
◊«ªg_adc_ªs_mË| 
FLD_ADC_EN_DIFF_CHN_M
);

396 
	}
}

404 
adc_£t_öput_mode
(
ADC_I≈utModeTy≥Def
 
m_öput
);

407 
	#¨eg_adc_tsm≠À_m
 0xì

	)

409 
	mFLD_ADC_TSAMPLE_CYCLE_CHN_M
 = 
BIT_RNG
(0,3),

417 
ölöe
 
	$adc_£t_tßm∂e_cy˛e_chn_misc
(
ADC_SampCycTy≥Def
 
adcST
)

420 
	`™Æog_wrôe
(
¨eg_adc_tsm≠À_m
, 
adcST
);

421 
	}
}

429 
adc_£t_tßm∂e_cy˛e
(
ADC_SampCycTy≥Def
 
adcST
);

444 
	#¨eg_r_max_mc
 0xef

	)

446 
	mFLD_R_MAX_MC0
 = 
BIT_RNG
(0,7),

449 
	#¨eg_r_max_s
 0xf1

	)

451 
	mFLD_R_MAX_S
 = 
BIT_RNG
(0,3),

452 
	mFLD_R_MAX_MC1
 = 
BIT_RNG
(6,7),

460 
ölöe
 
	$adc_£t_Àngth_£t_°©e
(
r_max_s
)

462 
	`™Æog_wrôe
(
¨eg_r_max_s
, (
	`™Æog_ªad
◊ªg_r_max_sË& (~
FLD_R_MAX_S
)Ë| (
r_max_s
));

463 
	}
}

472 
ölöe
 
	$adc_£t_Àngth_ˇ±uª_°©e_f‹_chn_misc_∫s
 (
r_max_mc
)

474 
	`™Æog_wrôe
(
¨eg_r_max_mc
, (
r_max_mc
 & 0x0ff));

475 
	`™Æog_wrôe
(
¨eg_r_max_s
, ((
	`™Æog_ªad
◊ªg_r_max_sË& (~
FLD_R_MAX_MC1
)Ë| ((
r_max_mc
 & 0x3ff) >> 8) << 6));

476 
	}
}

484 
ölöe
 
	$adc_£t_°©e_Àngth
(
R_max_mc
,
R_max_s
)

486 
	`™Æog_wrôe
(
¨eg_r_max_mc
, 
R_max_mc
);

487 
	`™Æog_wrôe
(
¨eg_r_max_s
, ((
R_max_mc
 >> 8Ë<< 6)| (
R_max_s
 & 
FLD_R_MAX_S
));

488 
	}
}

500 
	#¨eg_adc_chn_í
 0xf2

	)

502 
	mFLD_ADC_CHN_EN_M
 = 
BIT
(2),

503 
	mFLD_ADC_CHN_EN_RNS
 = 
BIT
(3),

504 
	mFLD_ADC_MAX_SCNT
 = 
BIT_RNG
(4,5),

511 
ölöe
 
	$adc_£t_chn_íabÀ
(
ADC_ChTy≥Def
 
ad_ch
)

513 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, (
	`™Æog_ªad
◊ªg_adc_chn_íË& 0xf0Ë| 
ad_ch
);

514 
	}
}

522 
ölöe
 
	$adc_£t_chn_íabÀ_™d_max_°©e_˙t
(
ADC_ChTy≥Def
 
ad_ch
, 
s_˙t
)

524 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, 
ad_ch
 | ((
s_˙t
 & 0x07) << 4));

525 
	}
}

532 
ölöe
 
	$adc_£t_max_°©e_˙t
(
s_˙t
)

534 
	`™Æog_wrôe
(
¨eg_adc_chn_í
, (
	`™Æog_ªad
◊ªg_adc_chn_íË& (~
FLD_ADC_MAX_SCNT
)Ë| ((
s_˙t
 & 0x07) << 4));

535 
	}
}

549 
	#¨eg_aö_sˇÀ
 0xÁ

	)

551 
	mFLD_ADC_ITRIM_PREAMP
 = 
BIT_RNG
(0,1),

552 
	mFLD_ADC_ITRIM_VREFBUF
 = 
BIT_RNG
(2,3),

553 
	mFLD_ADC_ITRIM_VCMBUF
 = 
BIT_RNG
(4,5),

554 
	mFLD_SEL_AIN_SCALE
 = 
BIT_RNG
(6,7),

564 
	#¨eg_adc_pga_˘æ
 0xfc

	)

566 
	mFLD_SAR_ADC_POWER_DOWN
 = 
BIT
(5),

575 
ölöe
 
	$adc_powî_⁄_ßr_adc
(
⁄_off
)

577 
	`™Æog_wrôe
(
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad
◊ªg_adc_pga_˘æË& (~
FLD_SAR_ADC_POWER_DOWN
)Ë| (!
⁄_off
) << 5);

578 
	}
}

584 
	#¨eg_adc_misc_l
 0xf7

	)

585 
	#¨eg_adc_misc_h
 0xf8

	)

594 
adc_£t_aö_ch™√l_dif„ª¡ül_mode
(
ADC_I≈utPchTy≥Def
 
InPCH
, 
ADC_I≈utNchTy≥Def
 
InNCH
);

601 
adc_£t_aö_¥e_sˇÀr
(
ADC_PªSˇlögTy≥Def
 
v_s˛
);

609 
adc_öô
();

622 
adc_upd©e_1p2_vªf_ˇlib_vÆue
();

629 
adc_ba£_pö_öô
(
GPIO_PöTy≥Def
 
pö
);

636 
adc_vb©_pö_öô
(
GPIO_PöTy≥Def
 
pö
);

643 
adc_ba£_öô
(
GPIO_PöTy≥Def
 
pö
);

650 
adc_ãmp_öô
();

657 
adc_vb©_öô
(
GPIO_PöTy≥Def
 
pö
);

665 
adc_vb©_ch™√l_öô
();

672 
adc_ßm∂e_™d_gë_ªsu…
();

675 
	#adc_d©a_ßm∂e_c⁄åﬁ
 0xf3

	)

677 
	mNOT_SAMPLE_ADC_DATA
 = 
BIT
(0),

686 
adc_ßm∂e_™d_gë_ªsu…_m™uÆ_mode
();

693 sig√d 
adc_ãmp_ªsu…
();

	@platform/chip_8278/aes.h

24 #i‚de‡
AES_H_


25 
	#AES_H_


	)

36 
´s_í¸y±
(*
Key
, *
D©a
, *
Resu…
);

48 
´s_de¸y±
(*
Key
, *
D©a
, *
Resu…
);

	@platform/chip_8278/analog.h

24 #¥agm®
⁄˚


33 
™Æog_ªad
(
addr
);

41 
™Æog_wrôe
(
addr
, 
v
);

50 
™Æog_ªad_buff
(
addr
, *
buff
, 
Àn
);

59 
™Æog_wrôe_buff
(
addr
, *
buff
, 
Àn
);

62 
	#WrôeA«logReg
 
™Æog_wrôe


	)

63 
	#RódA«logReg
 
™Æog_ªad


	)

	@platform/chip_8278/audio.h

24 #i‚de‡
audio_H


25 
	#audio_H


	)

28 
	~"ªgi°î.h
"

29 
	~"i2c.h
"

30 
	~"™Æog.h
"

33 
	#AUDIO_DBL_BUF_ENABLE
 0

	)

39 
	mAUDIO_8K
,

40 
	mAUDIO_16K
,

41 
	mAUDIO_32K
,

42 
	mAUDIO_48K
,

43 
	mRATE_SIZE


44 }
	tAudioR©e_Ty≥def
;

51 
	mGPIO_PB4_PB5
,

52 
	mGPIO_PB6_PB7
,

53 }
	tAudio_SDM_OutPut_Pö
;

60 
	mAMIC
,

61 
	mDMIC
,

62 
	mI2S_IN
,

63 
	mUSB_IN
,

64 
	mBUF_IN
,

65 }
	tAudioI≈ut_Ty≥def
;

71 
	mCODEC_MODE_MICPHONE_TO_HEADPHONE_LINEOUT_I2S
,

72 
	mCODEC_MODE_LINE_TO_HEADPHONE_LINEOUT_I2S
,

73 
	mCODEC_MODE_I2S_TO_HEADPHONE_LINEOUT
,

74 }
	tCodecMode_Ty≥def
;

82 
ölöe
 
	$audio_ª£t
()

84 
ªg_r°2
 = 
FLD_RST2_AUD
;

85 
ªg_r°2
 = 0;

86 
	}
}

95 
ölöe
 
	$audio_£t_codec_˛k
(
°ï
,
mod
)

97 
ªg_codec_˛k_°ï
 = 
°ï
;

98 
ªg_codec_˛k_mod
 = 
mod
;

99 
	}
}

107 
ölöe
 
	$audio_£t_i2s_˛k
(
°ï
,
mod
)

109 
ªg_i2s_°ï
 = 
°ï
|
FLD_I2S_CLK_EN
;

110 
ªg_i2s_mod
 = 
mod
;

111 
	}
}

117 
ölöe
 
	$gë_mic_wr_±r
 ()

119  
ªg_audio_w±r
 >>1;

120 
	}
}

126 
audio_amic_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

134 
audio_codec_™d_pga_dißbÀ
();

142 
audio_rx_d©a_‰om_buff
(sig√d * 
buf
,
Àn
);

150 
audio_rx_d©a_‰om_ßm∂e_buff
(c⁄° *
buf
, 
Àn
);

157 
audio_dmic_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

164 
audio_usb_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

172 
audio_buff_öô
(
AudioR©e_Ty≥def
 
Audio_R©e
);

179 
audio_i2s_öô
();

190 
audio_£t_sdm_ouçut
(
Audio_SDM_OutPut_Pö
 
OutPö
,
AudioI≈ut_Ty≥def
 
InTy≥
,
AudioR©e_Ty≥def
 
Audio_R©e
,
audio_out_í
);

197 
audio_£t_usb_ouçut
();

205 
audio_£t_i2s_ouçut
(
AudioI≈ut_Ty≥def
 
InTy≥
,
AudioR©e_Ty≥def
 
Audio_R©e
);

215 
audio_£t_codec
(
I2C_GPIO_SdaTy≥Def
 
sda_pö
,
I2C_GPIO_S˛Ty≥Def
 
s˛_pö
, 
CodecMode_Ty≥def
 
CodecMode
, 
sys˛k
);

222 
ölöe
 
	$audio_£t_muã_pga
(
íabÀ
)

224 if(!
íabÀ
)

226 
	`™Æog_wrôe
(
codec_™a_cfg2
,
	`™Æog_ªad
(codec_™a_cfg2Ë| 
	`BIT
(5));

230 
	`™Æog_wrôe
(
codec_™a_cfg2
,
	`™Æog_ªad
(codec_™a_cfg2Ë& ~
	`BIT
(5));

232 
	}
}

	@platform/chip_8278/bsp.h

24 #i‚de‡
BSP_H_


25 
	#BSP_H_


	)

32 
	#REG_BASE_ADDR
 0x800000

	)

34 
	#REG_ADDR8
(
a
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (a)))

	)

35 
	#REG_ADDR16
(
a
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (a)))

	)

36 
	#REG_ADDR32
(
a
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (a)))

	)

38 
	#wrôe_ªg8
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

39 
	#wrôe_ªg16
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë()(v))

	)

40 
	#wrôe_ªg32
(
addr
,
v
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)Ë(v))

	)

42 
	#ªad_ªg8
(
addr
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)))

	)

43 
	#ªad_ªg16
(
addr
Ë(*(vﬁ©ûê*)(
REG_BASE_ADDR
 + (addr)))

	)

44 
	#ªad_ªg32
(
addr
Ë(*(vﬁ©ûê*Ë(
REG_BASE_ADDR
 + (addr)))

	)

46 
	#WRITE_REG8
 
wrôe_ªg8


	)

47 
	#WRITE_REG16
 
wrôe_ªg16


	)

48 
	#WRITE_REG32
 
wrôe_ªg32


	)

50 
	#READ_REG8
 
ªad_ªg8


	)

51 
	#READ_REG16
 
ªad_ªg16


	)

52 
	#READ_REG32
 
ªad_ªg32


	)

54 
	#TCMD_UNDER_BOTH
 0xc0

	)

55 
	#TCMD_UNDER_RD
 0x80

	)

56 
	#TCMD_UNDER_WR
 0x40

	)

58 
	#TCMD_MASK
 0x3f

	)

60 
	#TCMD_WRITE
 0x3

	)

61 
	#TCMD_WAIT
 0x7

	)

62 
	#TCMD_WAREG
 0x8

	)

68 
	sTBLCMDSET
 {

69 
	madr
;

70 
	md©
;

71 
	mcmd
;

72 } 
	tTBLCMDSET
;

82 
LﬂdTblCmdSë
(c⁄° 
TBLCMDSET
 * 
±
, 
size
);

93 
sub_wr_™a
(
addr
, 
vÆue
, 
e
, 
s
);

103 
sub_wr
(
addr
, 
vÆue
, 
e
, 
s
);

109 
ölöe
 
	$mcu_ª£t
()

111 
	`wrôe_ªg8
(0x06f,0x20);

112 
	}
}

	@platform/chip_8278/clock.h

24 #¥agm®
⁄˚


28 
	#_ASM_NOP_
 
	`asm
("ä›")

	)

33 
	#CLOCK_DLY_1_CYC
 
_ASM_NOP_


	)

34 
	#CLOCK_DLY_2_CYC
 
_ASM_NOP_
;
	)
_ASM_NOP_

35 
	#CLOCK_DLY_3_CYC
 
_ASM_NOP_
;_ASM_NOP_;
	)
_ASM_NOP_

36 
	#CLOCK_DLY_4_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

37 
	#CLOCK_DLY_5_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

38 
	#CLOCK_DLY_6_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

39 
	#CLOCK_DLY_7_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

40 
	#CLOCK_DLY_8_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

41 
	#CLOCK_DLY_9_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

42 
	#CLOCK_DLY_10_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

47 #i‚de‡
SYSCLK_RC_CLOCK_EN


48 
	#SYSCLK_RC_CLOCK_EN
 0

	)

51 
sy°em_˛k_ty≥
;

52 
sy°em_˛k_mHz
;

58 
	#CLK_48M_XTAL_EN
 0

	)

60 
	#VULTURE_A0
 0

	)

65 
	mLDO_MODE
 =0x40,

66 
	mDCDC_LDO_MODE
 =0x41,

67 
	mDCDC_MODE
 =0x43,

68 }
	tPOWER_MODE_Ty≥Def
;

73 
	mEXTERNAL_XTAL_24M
 = 0,

74 
	mEXTERNAL_XTAL_48M
 = 1,

75 }
	tXTAL_Ty≥Def
;

81 
	mSYS_CLK_12M_Cry°Æ
 = 0x44,

82 
	mSYS_CLK_16M_Cry°Æ
 = 0x43,

83 
	mSYS_CLK_24M_Cry°Æ
 = 0x42,

84 
	mSYS_CLK_32M_Cry°Æ
 = 0x60,

85 
	mSYS_CLK_48M_Cry°Æ
 = 0x20,

87 
	mSYS_CLK_RC_THRES
 = 0x10,

92 }
	tSYS_CLK_Ty≥Def
;

99 
	mCLK_32K_RC
 =0,

100 
	mCLK_32K_XTAL
 =1,

101 }
	tCLK_32K_Ty≥Def
;

108 
˛ock_öô
(
SYS_CLK_Ty≥Def
 
SYS_CLK
);

116 
ölöe
 
	$˛ock_gë_sy°em_˛k
()

118  
sy°em_˛k_ty≥
;

119 
	}
}

126 
˛ock_32k_öô
(
CLK_32K_Ty≥Def
 
§c
);

133 
rc_24m_ˇl
();

140 
rc_48m_ˇl
();

147 
rc_32k_ˇl
();

154 
dmic_¥ob_48M_rc
();

161 
pwm_kick_32k_∑d_times
(
times
);

	@platform/chip_8278/dfifo.h

24 #i‚de‡ 
DFIFO_H


25 
	#DFIFO_H


	)

27 
	~"ªgi°î.h
"

35 
ölöe
 
	$dfifo_íabÀ_dfifo2
()

37 
ªg_dfifo_mode
 |
FLD_AUD_DFIFO2_IN
;

38 
	}
}

45 
ölöe
 
	$dfifo_dißbÀ_dfifo2
()

47 
ªg_dfifo_mode
 &~
FLD_AUD_DFIFO2_IN
;

48 
	}
}

56 
ölöe
 
	$dfifo_£t_dfifo0
(* 
pbuff
,
size_buff
)

58 
ªg_dfifo0_addr
 = ()(()
pbuff
);

59 
ªg_dfifo0_size
 = (
size_buff
>>4)-1;

60 
	}
}

68 
ölöe
 
	$dfifo_£t_dfifo1
(* 
pbuff
,
size_buff
)

70 
ªg_dfifo1_addr
 = ()(()
pbuff
);

71 
ªg_dfifo1_size
 = (
size_buff
>>4)-1;

72 
	}
}

80 
ölöe
 
	$dfifo_£t_dfifo2
(* 
pbuff
,
size_buff
)

82 
ªg_dfifo2_addr
 = ()(()
pbuff
);

83 
ªg_dfifo2_size
 = (
size_buff
>>4)-1;

84 
	}
}

92 
ölöe
 
	$adc_c⁄fig_misc_ch™√l_buf
(* 
pbuff
,
size_buff
)

95 
ªg_dfifo_misc_chn_addr
 = ()(()
pbuff
);

96 
ªg_dfifo_misc_chn_size
 = (
size_buff
>>4)-1;

98 
ªg_dfifo2_w±r
 = 0;

99 
	}
}

108 
ölöe
 
	$audio_c⁄fig_mic_buf
(* 
pbuff
,
size_buff
)

110 
ªg_dfifo_audio_addr
 = ()(()
pbuff
);

111 
ªg_dfifo_audio_size
 = (
size_buff
>>4)-1;

112 
	}
}

	@platform/chip_8278/dma.h

24 #i‚de‡
DMA_H_


25 
	#DMA_H_


	)

27 
	~"ªgi°î.h
"

30 
	#DMA_RFRX_LEN_HW_INFO
 0

31 
	#DMA_RFRX_OFFSET_HEADER
 4

32 
	#DMA_RFRX_OFFSET_RFLEN
 5

33 
	#DMA_RFRX_OFFSET_DATA
 6

34 

	)

36 
	#DMA_RFRX_OFFSET_CRC24
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+6)

37 
	#DMA_RFRX_OFFSET_TIME_STAMP
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+9)

38 
	#DMA_RFRX_OFFSET_FREQ_OFFSET
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+13)

39 
	#DMA_RFRX_OFFSET_RSSI
(
p
Ë’[
DMA_RFRX_OFFSET_RFLEN
]+15)

40 

	)

43 
	#RFDMA_RX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_CHN_RF_RX
))

	)

44 
	#RFDMA_RX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_CHN_RF_RX
))

	)

46 
	#RFDMA_TX_DISABLE
 (
ªg_dma_chn_í
 &(~
FLD_DMA_CHN_RF_TX
))

	)

47 
	#RFDMA_TX_ENABLE
 (
ªg_dma_chn_í
 |(
FLD_DMA_CHN_RF_TX
))

	)

51 
	mDMA0_UART_RX
,

52 
	mDMA1_UART_TX
,

53 
	mDMA2_RF_RX
,

54 
	mDMA3_RF_TX
,

55 
	mDMA4_AES_DECO
,

56 
	mDMA5_AES_CODE
,

57 
	mDMA6
,

58 
	mDMA7_PWM
,

59 }
	tDMA_chn_Typdef
;

66 
ölöe
 
	$dma_ª£t
()

68 
ªg_r°1
 |
FLD_RST1_DMA
;

69 
ªg_r°1
 &(~
FLD_RST1_DMA
);

70 
	}
}

76 
ölöe
 
	$dma_úq_íabÀ
(
msk
)

78 
ªg_dma_chn_úq_msk
 |
msk
;

79 
	}
}

86 
ölöe
 
	$dma_úq_dißbÀ
(
msk
)

88 
ªg_dma_chn_úq_msk
 &~
msk
;

89 
	}
}

97 
ölöe
 
	$dma_chn_íabÀ
(
chn
, 
í
)

99 if(
í
){

100 
ªg_dma_chn_í
 |
chn
;

103 
ªg_dma_chn_í
 &~
chn
;

105 
	}
}

114 
ölöe
 
	$dma_chn_úq_íabÀ
(
chn
, 
í
)

116 
ªg_dma_úq_°©us
 = 
chn
;

118 if(
í
){

119 
ªg_dma_chn_í
 |
chn
;

120 
ªg_dma_chn_úq_msk
 |
chn
;

123 
ªg_dma_chn_í
 &~
chn
;

124 
ªg_dma_chn_úq_msk
 &~
chn
;

126 
	}
}

133 
ölöe
 
	$dma_chn_úq_°©us_˛r
(
úq_°©us
)

135 
ªg_dma_úq_°©us
 = 
úq_°©us
;

136 
	}
}

144 
ölöe
 
	$dma_chn_úq_°©us_gë
()

146  
ªg_dma_úq_°©us
;

147 
	}
}

154 
ölöe
 
	$dma_£t_buff_size
(
DMA_chn_Typdef
 
chn
,
size
)

156 
	`ªg_dma_size
(
chn
Ë()(
size
/16);

157 
	}
}

	@platform/chip_8278/driver_8278.h

24 #¥agm®
⁄˚


27 
	~"b•.h
"

28 
	~"ªgi°î.h
"

29 
	~"™Æog.h
"

30 
	~"˛ock.h
"

31 
	~"timî.h
"

32 
	~"úq.h
"

33 
	~"dfifo.h
"

34 
	~"w©chdog.h
"

35 
	~"dma.h
"

36 
	~"´s.h
"

37 
	~"gpio.h
"

38 
	~"adc.h
"

39 
	~"øndom.h
"

40 
	~"pwm.h
"

41 
	~"audio.h
"

42 
	~"Êash.h
"

43 
	~"i2c.h
"

44 
	~"•i.h
"

45 
	~"u¨t.h
"

46 
	~"usbhw.h
"

47 
	~"rf_drv.h
"

48 
	~"emi.h
"

49 
	~"pm.h
"

50 
	~"pke.h
"

	@platform/chip_8278/emi.h

24 #i‚de‡
EMI_H_


25 
	#EMI_H_


	)

27 
	~"rf_drv.h
"

35 
rf_£t_powî_Àvñ_ödex_sögÀt⁄e
 (
RF_PowîTy≥Def
 
Àvñ
);

43 
rf_emi_sögÀ_t⁄e
(
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
);

51 
rf_emi_°›
();

59 
rf_emi_rx
(
RF_ModeTy≥Def
 
mode
,sig√d 
rf_chn
);

65 
rf_emi_rx_lo›
();

72 
rf_emi_gë_rxpkt_˙t
();

79 
rf_emi_gë_rssi_avg
();

86 *
rf_emi_gë_rxpkt
();

93 
rf_c⁄töue_mode_run
();

109 
rf_emi_tx_c⁄töue_£tup
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

125 
rf_emi_tx_bur°_£tup
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

138 
rf_emi_tx_bru°_£tup_ømp
(
RF_ModeTy≥Def
 
rf_mode
,
RF_PowîTy≥Def
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

152 
rf_emi_tx_bur°_lo›_ømp
(
RF_ModeTy≥Def
 
rf_mode
,
pkt_ty≥
);

163 
rf_emi_tx_bur°_lo›
(
RF_ModeTy≥Def
 
rf_mode
,
pkt_ty≥
);

170 
rf_£t_ch™√l_sögÀt⁄e
 (sig√d 
chn
);

177 
≤Gí
(
°©e
);

	@platform/chip_8278/flash.c

24 
	~"Êash.h
"

25 
	~"•i_i.h
"

26 
	~"úq.h
"

27 
	~"timî.h
"

28 
	~"°rög.h
"

29 
	~"™Æog.h
"

39 
_©åibuã_øm_code_£c_
 
ölöe
 
	$Êash_is_busy
(){

40  
	`m•i_ªad
() & 0x01;

41 
	}
}

48 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_cmd
(
cmd
){

49 
	`m•i_high
();

50 
	`¶ìp_us
(1);

51 
	`m•i_low
();

52 
	`m•i_wrôe
(
cmd
);

53 
	`m•i_waô
();

54 
	}
}

61 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_addr
(
addr
){

62 
	`m•i_wrôe
(()(
addr
>>16));

63 
	`m•i_waô
();

64 
	`m•i_wrôe
(()(
addr
>>8));

65 
	`m•i_waô
();

66 
	`m•i_wrôe
(()(
addr
));

67 
	`m•i_waô
();

68 
	}
}

74 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_waô_d⁄e
()

76 
	`¶ìp_us
(100);

77 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_CMD_LOWBYTE
);

79 
i
;

80 
i
 = 0; i < 10000000; ++i){

81 if(!
	`Êash_is_busy
()){

85 
	`m•i_high
();

86 
	}
}

98 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_ªad_øm
(
cmd
, 
addr
, 
addr_í
, 
dummy_˙t
, *
d©a
, 
d©a_Àn
)

100 
r
 = 
	`úq_dißbÀ
();

102 
	`Êash_£nd_cmd
(
cmd
);

103 if(
addr_í
)

105 
	`Êash_£nd_addr
(
addr
);

107 
i
 = 0; i < 
dummy_˙t
; ++i)

109 
	`m•i_wrôe
(0x00);

110 
	`m•i_waô
();

112 
	`m•i_wrôe
(0x00);

113 
	`m•i_waô
();

114 
	`m•i_˘æ_wrôe
(0x0a);

115 
	`m•i_waô
();

116 
i
 = 0; i < 
d©a_Àn
; ++i)

118 *
d©a
++ = 
	`m•i_gë
();

119 
	`m•i_waô
();

121 
	`m•i_high
();

123 
	`úq_ª°‹e
(
r
);

124 
	}
}

136 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_m•i_wrôe_øm
(
cmd
, 
addr
, 
addr_í
, *
d©a
, 
d©a_Àn
)

138 
r
 = 
	`úq_dißbÀ
();

140 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

141 
	`Êash_£nd_cmd
(
cmd
);

142 if(
addr_í
)

144 
	`Êash_£nd_addr
(
addr
);

146 
i
 = 0; i < 
d©a_Àn
; ++i)

148 
	`m•i_wrôe
(
d©a
[
i
]);

149 
	`m•i_waô
();

151 
	`m•i_high
();

152 
	`Êash_waô_d⁄e
();

154 
	`úq_ª°‹e
(
r
);

155 
	}
}

171 
	$Êash_îa£_£˘‹
(
addr
)

173 
	`Êash_m•i_wrôe_øm
(
FLASH_SECT_ERASE_CMD
, 
addr
, 1, 
NULL
, 0);

174 
	}
}

192 
	$Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
)

194 
	`Êash_m•i_ªad_øm
(
FLASH_READ_CMD
, 
addr
, 1, 0, 
buf
, 
Àn
);

195 
	}
}

215 
	$Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
)

217 
ns
 = 
PAGE_SIZE
 - (
addr
&(PAGE_SIZE - 1));

218 
nw
 = 0;

221 
nw
 = 
Àn
 > 
ns
 ?Çs :len;

222 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_CMD
, 
addr
, 1, 
buf
, 
nw
);

223 
ns
 = 
PAGE_SIZE
;

224 
addr
 +
nw
;

225 
buf
 +
nw
;

226 
Àn
 -
nw
;

227 }
Àn
 > 0);

228 
	}
}

244 
	$Êash_ªad_°©us
(
cmd
)

246 
°©us
 = 0;

247 
	`Êash_m•i_ªad_øm
(
cmd
, 0, 0, 0, &
°©us
, 1);

248  
°©us
;

249 
	}
}

266 
	$Êash_wrôe_°©us
(
Êash_°©us_ty≥def_e
 
ty≥
 , 
d©a
)

268 
buf
[2];

270 
buf
[0] = 
d©a
;

271 
buf
[1] = 
d©a
>>8;

272 if(
ty≥
 =
FLASH_TYPE_8BIT_STATUS
){

273 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 1);

274 }if(
ty≥
 =
FLASH_TYPE_16BIT_STATUS_ONE_CMD
){

275 
	`Êash_m•i_wrôe_øm
(
FLASH_WRITE_STATUS_CMD_LOWBYTE
, 0, 0, 
buf
, 2);

277 
	}
}

294 
	$Êash_ªad_mid
()

296 
Êash_mid
 = 0;

297 
	`Êash_m•i_ªad_øm
(
FLASH_GET_JEDEC_ID
, 0, 0, 0, (*)(&
Êash_mid
), 3);

298  
Êash_mid
;

299 
	}
}

317 
	$Êash_ªad_uid
(
idcmd
, *
buf
)

319 if(
idcmd
 =
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
)

321 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x00, 1, 1, 
buf
, 16);

323 i‡(
idcmd
 =
FLASH_XTX_READ_UID_CMD
)

325 
	`Êash_m•i_ªad_øm
(
idcmd
, 0x80, 1, 1, 
buf
, 16);

327 
	}
}

348 
	$Êash_ªad_mid_uid_wôh_check
(*
Êash_mid
, *
Êash_uid
)

350 
no_uid
[16]={0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01};

351 
i
,
f_˙t
=0;

352 *
Êash_mid
 = 
	`Êash_ªad_mid
();

369 if((*
Êash_mid
 == 0x1160C8)||(*flash_mid == 0x1360C8)||(*flash_mid == 0x1460C8)||(*flash_mid == 0x11325E)||(*flash_mid == 0x12325E)||(*flash_mid == 0x13325E)||(*flash_mid == 0x14325E)){

370 
	`Êash_ªad_uid
(
FLASH_READ_UID_CMD_GD_PUYA_ZB_UT
, (*)
Êash_uid
);

375 
i
=0;i<16;i++){

376 if(
Êash_uid
[
i
] =
no_uid
[i]){

377 
f_˙t
++;

381 if(
f_˙t
 == 16){

386 
	}
}

393 
	$Êash_is_zb
()

395 
Êash_mid
 = 
	`Êash_ªad_mid
();

396 if((
Êash_mid
 == 0x13325E)||(flash_mid == 0x14325E)||(flash_mid == 0x11325E)||(flash_mid == 0x12325E))

401 
	}
}

409 
	$Êash_vdd_f_ˇlib
()

411 
ˇlib_vÆue
 = 
	`Êash_gë_vdd_f_ˇlib_vÆue
();

412 if((0xfff‡=
ˇlib_vÆue
) || (0 != (calib_value & 0xf8f8)))

414 if(
	`Êash_is_zb
())

416 
	`™Æog_wrôe
(0x09, ((
	`™Æog_ªad
(0x09Ë& 0x8fË| (
FLASH_VOLTAGE_1V95
 << 4)));

417 
	`™Æog_wrôe
(0x0c, ((
	`™Æog_ªad
(0x0cË& 0xf8Ë| 
FLASH_VOLTAGE_1V9
));

422 
	`™Æog_wrôe
(0x09, ((
	`™Æog_ªad
(0x09Ë& 0x8fË| ((
ˇlib_vÆue
 & 0xff00) >> 4) ));

423 
	`™Æog_wrôe
(0x0c, ((
	`™Æog_ªad
(0x0cË& 0xf8Ë| (
ˇlib_vÆue
 & 0xff)));

425 
	}
}

	@platform/chip_8278/flash.h

24 #¥agm®
⁄˚


26 
	~"compûî.h
"

29 
	#PAGE_SIZE
 256

	)

36 
	mFLASH_WRITE_CMD
 = 0x02,

37 
	mFLASH_READ_CMD
 = 0x03,

39 
	mFLASH_SECT_ERASE_CMD
 = 0x20,

41 
	mFLASH_READ_UID_CMD_GD_PUYA_ZB_UT
 = 0x4B,

42 
	mFLASH_READ_UID_CMD_XTX
 = 0x5A,

44 
	mFLASH_GET_JEDEC_ID
 = 0x9F,

47 
	mFLASH_WRITE_STATUS_CMD_LOWBYTE
 = 0x01,

48 
	mFLASH_WRITE_STATUS_CMD_HIGHBYTE
 = 0x31,

50 
	mFLASH_READ_STATUS_CMD_LOWBYTE
 = 0x05,

51 
	mFLASH_READ_STATUS_CMD_HIGHBYTE
 = 0x35,

53 
	mFLASH_WRITE_DISABLE_CMD
 = 0x04,

54 
	mFLASH_WRITE_ENABLE_CMD
 = 0x06,

62 
	mFLASH_TYPE_8BIT_STATUS
 = 0,

63 
	mFLASH_TYPE_16BIT_STATUS_ONE_CMD
 = 1,

64 
	mFLASH_TYPE_16BIT_STATUS_TWO_CMD
 = 2,

65 }
	tÊash_°©us_ty≥def_e
;

71 
	mFLASH_UID_CMD_GD_PUYA
 = 0x4b,

72 
	mFLASH_XTX_READ_UID_CMD
 = 0x5A,

73 }
	tÊash_uid_cmddef_e
;

83 
	mFLASH_SIZE_64K
 = 0x10,

84 
	mFLASH_SIZE_128K
 = 0x11,

85 
	mFLASH_SIZE_256K
 = 0x12,

86 
	mFLASH_SIZE_512K
 = 0x13,

87 
	mFLASH_SIZE_1M
 = 0x14,

88 
	mFLASH_SIZE_2M
 = 0x15,

89 
	mFLASH_SIZE_4M
 = 0x16,

90 
	mFLASH_SIZE_8M
 = 0x17,

91 } 
	tFœsh_C≠acôyDef
;

97 
	mFLASH_VOLTAGE_1V95
 = 0x07,

98 
	mFLASH_VOLTAGE_1V9
 = 0x06,

99 
	mFLASH_VOLTAGE_1V85
 = 0x05,

100 
	mFLASH_VOLTAGE_1V8
 = 0x04,

101 
	mFLASH_VOLTAGE_1V75
 = 0x03,

102 
	mFLASH_VOLTAGE_1V7
 = 0x02,

103 
	mFLASH_VOLTAGE_1V65
 = 0x01,

104 
	mFLASH_VOLTAGE_1V6
 = 0x00,

105 } 
	tFœsh_VﬁègeDef
;

125 
Êash_îa£_£˘‹
(
addr
);

143 
Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
);

163 
Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
);

180 
Êash_ªad_mid
();

198 
Êash_ªad_uid
(
idcmd
, *
buf
);

219 
Êash_ªad_mid_uid_wôh_check
–*
Êash_mid
, *
Êash_uid
);

226 
Êash_is_zb
();

234 
Êash_vdd_f_ˇlib
();

242 
ölöe
 
	$Êash_gë_vdd_f_ˇlib_vÆue
()

244 
mid
 = 
	`Êash_ªad_mid
();

245 
Êash_vﬁ©age
 = 0;

246 (
mid
 & 0xff0000) >> 16)

248 (
FLASH_SIZE_64K
):

249 
	`Êash_ªad_∑ge
(0xe1c0, 2, (*)&
Êash_vﬁ©age
);

251 (
FLASH_SIZE_128K
):

252 
	`Êash_ªad_∑ge
(0x1e1c0, 2, (*)&
Êash_vﬁ©age
);

254 (
FLASH_SIZE_512K
):

255 
	`Êash_ªad_∑ge
(0x771c0, 2, (*)&
Êash_vﬁ©age
);

257 (
FLASH_SIZE_1M
):

258 
	`Êash_ªad_∑ge
(0x„1c0, 2, (*)&
Êash_vﬁ©age
);

260 (
FLASH_SIZE_2M
):

261 
	`Êash_ªad_∑ge
(0x1„1c0, 2, (*)&
Êash_vﬁ©age
);

264 
Êash_vﬁ©age
 = 0xff;

267  
Êash_vﬁ©age
;

268 
	}
}

	@platform/chip_8278/gpio.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"ªgi°î.h
"

28 
	~"b•.h
"

36 
	mGPIO_GROUPA
 = 0x000,

37 
	mGPIO_GROUPB
 = 0x100,

38 
	mGPIO_GROUPC
 = 0x200,

39 
	mGPIO_GROUPD
 = 0x300,

40 
	mGPIO_GROUPE
 = 0x400,

42 
	mGPIO_PA0
 = 
GPIO_GROUPA
 | 
BIT
(0),

43 
	mGPIO_PA1
 = 
GPIO_GROUPA
 | 
BIT
(1),

44 
	mGPIO_PA2
 = 
GPIO_GROUPA
 | 
BIT
(2),

45 
	mGPIO_PA3
 = 
GPIO_GROUPA
 | 
BIT
(3),

46 
	mGPIO_PA4
 = 
GPIO_GROUPA
 | 
BIT
(4),

47 
	mGPIO_PA5
 = 
GPIO_GROUPA
 | 
BIT
(5), 
	mGPIO_DM
=
GPIO_PA5
,

48 
	mGPIO_PA6
 = 
GPIO_GROUPA
 | 
BIT
(6), 
	mGPIO_DP
=
GPIO_PA6
,

49 
	mGPIO_PA7
 = 
GPIO_GROUPA
 | 
BIT
(7), 
	mGPIO_SWS
=
GPIO_PA7
,

50 
	mGPIOA_ALL
 = 
GPIO_GROUPA
 | 0x00ff,

52 
	mGPIO_PB0
 = 
GPIO_GROUPB
 | 
BIT
(0),

53 
	mGPIO_PB1
 = 
GPIO_GROUPB
 | 
BIT
(1),

54 
	mGPIO_PB2
 = 
GPIO_GROUPB
 | 
BIT
(2),

55 
	mGPIO_PB3
 = 
GPIO_GROUPB
 | 
BIT
(3),

56 
	mGPIO_PB4
 = 
GPIO_GROUPB
 | 
BIT
(4),

57 
	mGPIO_PB5
 = 
GPIO_GROUPB
 | 
BIT
(5),

58 
	mGPIO_PB6
 = 
GPIO_GROUPB
 | 
BIT
(6),

59 
	mGPIO_PB7
 = 
GPIO_GROUPB
 | 
BIT
(7),

61 
	mGPIO_PC0
 = 
GPIO_GROUPC
 | 
BIT
(0),

62 
	mGPIO_PC1
 = 
GPIO_GROUPC
 | 
BIT
(1),

63 
	mGPIO_PC2
 = 
GPIO_GROUPC
 | 
BIT
(2),

64 
	mGPIO_PC3
 = 
GPIO_GROUPC
 | 
BIT
(3),

65 
	mGPIO_PC4
 = 
GPIO_GROUPC
 | 
BIT
(4),

66 
	mGPIO_PC5
 = 
GPIO_GROUPC
 | 
BIT
(5),

67 
	mGPIO_PC6
 = 
GPIO_GROUPC
 | 
BIT
(6),

68 
	mGPIO_PC7
 = 
GPIO_GROUPC
 | 
BIT
(7),

70 
	mGPIO_PD0
 = 
GPIO_GROUPD
 | 
BIT
(0),

71 
	mGPIO_PD1
 = 
GPIO_GROUPD
 | 
BIT
(1),

72 
	mGPIO_PD2
 = 
GPIO_GROUPD
 | 
BIT
(2),

73 
	mGPIO_PD3
 = 
GPIO_GROUPD
 | 
BIT
(3),

74 
	mGPIO_PD4
 = 
GPIO_GROUPD
 | 
BIT
(4),

75 
	mGPIO_PD5
 = 
GPIO_GROUPD
 | 
BIT
(5),

76 
	mGPIO_PD6
 = 
GPIO_GROUPD
 | 
BIT
(6),

77 
	mGPIO_PD7
 = 
GPIO_GROUPD
 | 
BIT
(7),

79 
	mGPIO_PE0
 = 
GPIO_GROUPE
 | 
BIT
(0), 
	mGPIO_MSDO
=
GPIO_PE0
,

80 
	mGPIO_PE1
 = 
GPIO_GROUPE
 | 
BIT
(1), 
	mGPIO_MCLK
=
GPIO_PE1
,

81 
	mGPIO_PE2
 = 
GPIO_GROUPE
 | 
BIT
(2), 
	mGPIO_MSCN
=
GPIO_PE2
,

82 
	mGPIO_PE3
 = 
GPIO_GROUPE
 | 
BIT
(3), 
	mGPIO_MSDI
=
GPIO_PE3
,

84 
	mGPIO_ALL
 = 0x500,

85 }
	tGPIO_PöTy≥Def
;

92 
	mAS_GPIO
 = 0,

93 
	mAS_MSPI
 = 1,

94 
	mAS_SWIRE
 = 2,

95 
	mAS_UART
 = 3,

96 
	mAS_I2C
 = 4,

97 
	mAS_SPI
 = 5,

98 
	mAS_I2S
 = 6,

99 
	mAS_AMIC
 = 7,

100 
	mAS_DMIC
 = 8,

101 
	mAS_SDM
 = 9,

102 
	mAS_USB
 = 10,

103 
	mAS_ADC
 = 11,

104 
	mAS_CMP
 = 12,

105 
	mAS_ATS
 = 13,

107 
	mAS_PWM0
 = 20,

108 
	mAS_PWM1
 = 21,

109 
	mAS_PWM2
 = 22,

110 
	mAS_PWM3
 = 23,

111 
	mAS_PWM4
 = 24,

112 
	mAS_PWM5
 = 25,

113 
	mAS_PWM0_N
 = 26,

114 
	mAS_PWM1_N
 = 27,

115 
	mAS_PWM2_N
 = 28,

116 
	mAS_PWM3_N
 = 29,

117 
	mAS_PWM4_N
 = 30,

118 
	mAS_PWM5_N
 = 31,

119 }
	tGPIO_FuncTy≥Def
;

123 
	mLevñ_Low
=0,

124 
	mLevñ_High
 =1,

125 }
	tGPIO_LevñTy≥Def
;

133 
	mPOL_RISING
 = 0, 
	mpﬁ_risög
 = 0,

134 
	mPOL_FALLING
 = 1, 
	mpﬁ_ÁŒög
 = 1,

135 }
	tGPIO_PﬁTy≥Def
;

141 
	mPM_PIN_UP_DOWN_FLOAT
 = 0,

142 
	mPM_PIN_PULLUP_1M
 = 1,

143 
	mPM_PIN_PULLDOWN_100K
 = 2,

144 
	mPM_PIN_PULLUP_10K
 = 3,

145 }
	tGPIO_PuŒTy≥Def
;

154 
gpio_£t_func
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_FuncTy≥Def
 
func
);

162 
ölöe
 
	$gpio_£t_ouçut_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
)

164 
bô
 = 
pö
 & 0xff;

165 if(!
vÆue
){

166 
	`BM_SET
(
	`ªg_gpio_€n
(
pö
), 
bô
);

168 
	`BM_CLR
(
	`ªg_gpio_€n
(
pö
), 
bô
);

170 
	}
}

178 
gpio_£t_öput_í
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
);

186 
ölöe
 
	$gpio_is_ouçut_í
(
GPIO_PöTy≥Def
 
pö
)

188  !
	`BM_IS_SET
(
	`ªg_gpio_€n
(
pö
),Öin & 0xff);

189 
	}
}

197 
ölöe
 
	$gpio_is_öput_í
(
GPIO_PöTy≥Def
 
pö
)

199  
	`BM_IS_SET
(
	`ªg_gpio_õ
(
pö
),Öin & 0xff);

200 
	}
}

208 
ölöe
 
	$gpio_wrôe
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
)

210 
bô
 = 
pö
 & 0xff;

211 if(
vÆue
){

212 
	`BM_SET
(
	`ªg_gpio_out
(
pö
), 
bô
);

214 
	`BM_CLR
(
	`ªg_gpio_out
(
pö
), 
bô
);

216 
	}
}

223 
ölöe
 
	$gpio_ªad
(
GPIO_PöTy≥Def
 
pö
)

225  
	`BM_IS_SET
(
	`ªg_gpio_ö
(
pö
),Öin & 0xff);

226 
	}
}

233 
ölöe
 
	$gpio_ªad_Æl
(*
p
)

235 
p
[0] = 
	`REG_ADDR8
(0x580);

236 
p
[1] = 
	`REG_ADDR8
(0x588);

237 
p
[2] = 
	`REG_ADDR8
(0x590);

238 
p
[3] = 
	`REG_ADDR8
(0x598);

239 
	}
}

246 
ölöe
 
	$gpio_toggÀ
(
GPIO_PöTy≥Def
 
pö
)

248 
	`ªg_gpio_out
(
pö
) ^= (pin & 0xFF);

249 
	}
}

257 
gpio_£t_d©a_°ªngth
(
GPIO_PöTy≥Def
 
pö
, 
vÆue
);

265 
gpio_£tup_up_down_ªsi°‹
(
GPIO_PöTy≥Def
 
gpio
, 
GPIO_PuŒTy≥Def
 
up_down
);

272 
gpio_shutdown
(
GPIO_PöTy≥Def
 
pö
);

280 
ölöe
 
	$gpio_£t_öãºu±_pﬁ
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

282 
bô
 = 
pö
 & 0xff;

283 if(
ÁŒög
){

284 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

286 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

288 
	}
}

296 
ölöe
 
	$gpio_£t_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

298 
bô
 = 
pö
 & 0xff;

301 
ªg_gpio_wakeup_úq
 |
FLD_GPIO_CORE_INTERRUPT_EN
;

302 if(
ÁŒög
){

303 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

305 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

308 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_EN
;

309 
ªg_úq_mask
 |
FLD_IRQ_GPIO_EN
;

310 
	}
}

318 
ölöe
 
	$gpio_í_öãºu±
(
GPIO_PöTy≥Def
 
pö
, 
í
)

320 
bô
 = 
pö
 & 0xff;

321 if(
í
){

322 
	`BM_SET
(
	`ªg_gpio_úq_wakeup_í
(
pö
), 
bô
);

325 
	`BM_CLR
(
	`ªg_gpio_úq_wakeup_í
(
pö
), 
bô
);

327 
	}
}

335 
ölöe
 
	$gpio_£t_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
){

336 
bô
 = 
pö
 & 0xff;

338 if(
ÁŒög
){

339 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

341 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

345 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC0_EN
;

346 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC0_EN
;

347 
	}
}

356 
ölöe
 
	$gpio_í_öãºu±_risc0
(
GPIO_PöTy≥Def
 
pö
, 
í
)

358 
bô
 = 
pö
 & 0xff;

359 if(
í
){

360 
	`BM_SET
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

363 
	`BM_CLR
(
	`ªg_gpio_úq_risc0_í
(
pö
), 
bô
);

365 
	}
}

374 
ölöe
 
	$gpio_£t_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
ÁŒög
)

376 
bô
 = 
pö
 & 0xff;

379 if(
ÁŒög
){

380 
	`BM_SET
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

382 
	`BM_CLR
(
	`ªg_gpio_pﬁ
(
pö
), 
bô
);

385 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC1_EN
;

386 
ªg_úq_mask
 |
FLD_IRQ_GPIO_RISC1_EN
;

387 
	}
}

395 
ölöe
 
	$gpio_í_öãºu±_risc1
(
GPIO_PöTy≥Def
 
pö
, 
í
)

397 
bô
 = 
pö
 & 0xff;

398 if(
í
){

399 
	`BM_SET
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

402 
	`BM_CLR
(
	`ªg_gpio_úq_risc1_í
(
pö
), 
bô
);

404 
	}
}

	@platform/chip_8278/gpio_default.h

24 #¥agm®
⁄˚


26 
	~"gpio.h
"

29 #i‚de‡
PA0_INPUT_ENABLE


30 
	#PA0_INPUT_ENABLE
 0

	)

32 #i‚de‡
PA1_INPUT_ENABLE


33 
	#PA1_INPUT_ENABLE
 0

	)

35 #i‚de‡
PA2_INPUT_ENABLE


36 
	#PA2_INPUT_ENABLE
 0

	)

38 #i‚de‡
PA3_INPUT_ENABLE


39 
	#PA3_INPUT_ENABLE
 0

	)

41 #i‚de‡
PA4_INPUT_ENABLE


42 
	#PA4_INPUT_ENABLE
 0

	)

44 #i‚de‡
PA5_INPUT_ENABLE


45 
	#PA5_INPUT_ENABLE
 0

47 #i‚de‡
PA6_INPUT_ENABLE


	)

48 
	#PA6_INPUT_ENABLE
 0

50 #i‚de‡
PA7_INPUT_ENABLE


	)

51 
	#PA7_INPUT_ENABLE
 1

53 #i‚de‡
PA0_OUTPUT_ENABLE


	)

54 
	#PA0_OUTPUT_ENABLE
 0

	)

56 #i‚de‡
PA1_OUTPUT_ENABLE


57 
	#PA1_OUTPUT_ENABLE
 0

	)

59 #i‚de‡
PA2_OUTPUT_ENABLE


60 
	#PA2_OUTPUT_ENABLE
 0

	)

62 #i‚de‡
PA3_OUTPUT_ENABLE


63 
	#PA3_OUTPUT_ENABLE
 0

	)

65 #i‚de‡
PA4_OUTPUT_ENABLE


66 
	#PA4_OUTPUT_ENABLE
 0

	)

68 #i‚de‡
PA5_OUTPUT_ENABLE


69 
	#PA5_OUTPUT_ENABLE
 0

	)

71 #i‚de‡
PA6_OUTPUT_ENABLE


72 
	#PA6_OUTPUT_ENABLE
 0

	)

74 #i‚de‡
PA7_OUTPUT_ENABLE


75 
	#PA7_OUTPUT_ENABLE
 0

	)

77 #i‚de‡
PA0_DATA_STRENGTH


78 
	#PA0_DATA_STRENGTH
 1

	)

80 #i‚de‡
PA1_DATA_STRENGTH


81 
	#PA1_DATA_STRENGTH
 1

	)

83 #i‚de‡
PA2_DATA_STRENGTH


84 
	#PA2_DATA_STRENGTH
 1

	)

86 #i‚de‡
PA3_DATA_STRENGTH


87 
	#PA3_DATA_STRENGTH
 1

	)

89 #i‚de‡
PA4_DATA_STRENGTH


90 
	#PA4_DATA_STRENGTH
 1

	)

92 #i‚de‡
PA5_DATA_STRENGTH


93 
	#PA5_DATA_STRENGTH
 1

	)

95 #i‚de‡
PA6_DATA_STRENGTH


96 
	#PA6_DATA_STRENGTH
 1

	)

98 #i‚de‡
PA7_DATA_STRENGTH


99 
	#PA7_DATA_STRENGTH
 1

	)

101 #i‚de‡
PA0_DATA_OUT


102 
	#PA0_DATA_OUT
 0

	)

104 #i‚de‡
PA1_DATA_OUT


105 
	#PA1_DATA_OUT
 0

	)

107 #i‚de‡
PA2_DATA_OUT


108 
	#PA2_DATA_OUT
 0

	)

110 #i‚de‡
PA3_DATA_OUT


111 
	#PA3_DATA_OUT
 0

	)

113 #i‚de‡
PA4_DATA_OUT


114 
	#PA4_DATA_OUT
 0

	)

116 #i‚de‡
PA5_DATA_OUT


117 
	#PA5_DATA_OUT
 0

	)

119 #i‚de‡
PA6_DATA_OUT


120 
	#PA6_DATA_OUT
 0

	)

122 #i‚de‡
PA7_DATA_OUT


123 
	#PA7_DATA_OUT
 0

	)

125 #i‚de‡
PA0_FUNC


126 
	#PA0_FUNC
 
AS_GPIO


	)

128 #i‚de‡
PA1_FUNC


129 
	#PA1_FUNC
 
AS_GPIO


	)

131 #i‚de‡
PA2_FUNC


132 
	#PA2_FUNC
 
AS_GPIO


	)

134 #i‚de‡
PA3_FUNC


135 
	#PA3_FUNC
 
AS_GPIO


	)

137 #i‚de‡
PA4_FUNC


138 
	#PA4_FUNC
 
AS_GPIO


	)

140 #i‚de‡
PA5_FUNC


141 
	#PA5_FUNC
 
AS_GPIO


	)

143 #i‚de‡
PA6_FUNC


144 
	#PA6_FUNC
 
AS_GPIO


	)

146 #i‚de‡
PA7_FUNC


147 
	#PA7_FUNC
 
AS_SWIRE


	)

149 #i‚de‡
PULL_WAKEUP_SRC_PA0


150 
	#PULL_WAKEUP_SRC_PA0
 0

	)

152 #i‚de‡
PULL_WAKEUP_SRC_PA1


153 
	#PULL_WAKEUP_SRC_PA1
 0

	)

155 #i‚de‡
PULL_WAKEUP_SRC_PA2


156 
	#PULL_WAKEUP_SRC_PA2
 0

	)

158 #i‚de‡
PULL_WAKEUP_SRC_PA3


159 
	#PULL_WAKEUP_SRC_PA3
 0

	)

161 #i‚de‡
PULL_WAKEUP_SRC_PA4


162 
	#PULL_WAKEUP_SRC_PA4
 0

	)

164 #i‚de‡
PULL_WAKEUP_SRC_PA5


165 
	#PULL_WAKEUP_SRC_PA5
 0

	)

167 #i‚de‡
PULL_WAKEUP_SRC_PA6


168 
	#PULL_WAKEUP_SRC_PA6
 0

	)

170 #i‚de‡
PULL_WAKEUP_SRC_PA7


171 
	#PULL_WAKEUP_SRC_PA7
 
PM_PIN_PULLUP_1M


173 

	)

175 #i‚de‡
PB0_INPUT_ENABLE


176 
	#PB0_INPUT_ENABLE
 0

	)

178 #i‚de‡
PB1_INPUT_ENABLE


179 
	#PB1_INPUT_ENABLE
 0

	)

181 #i‚de‡
PB2_INPUT_ENABLE


182 
	#PB2_INPUT_ENABLE
 0

	)

184 #i‚de‡
PB3_INPUT_ENABLE


185 
	#PB3_INPUT_ENABLE
 0

	)

187 #i‚de‡
PB4_INPUT_ENABLE


188 
	#PB4_INPUT_ENABLE
 0

	)

190 #i‚de‡
PB5_INPUT_ENABLE


191 
	#PB5_INPUT_ENABLE
 0

	)

193 #i‚de‡
PB6_INPUT_ENABLE


194 
	#PB6_INPUT_ENABLE
 0

	)

196 #i‚de‡
PB7_INPUT_ENABLE


197 
	#PB7_INPUT_ENABLE
 0

	)

199 #i‚de‡
PB0_OUTPUT_ENABLE


200 
	#PB0_OUTPUT_ENABLE
 0

	)

202 #i‚de‡
PB1_OUTPUT_ENABLE


203 
	#PB1_OUTPUT_ENABLE
 0

	)

205 #i‚de‡
PB2_OUTPUT_ENABLE


206 
	#PB2_OUTPUT_ENABLE
 0

	)

208 #i‚de‡
PB3_OUTPUT_ENABLE


209 
	#PB3_OUTPUT_ENABLE
 0

	)

211 #i‚de‡
PB4_OUTPUT_ENABLE


212 
	#PB4_OUTPUT_ENABLE
 0

	)

214 #i‚de‡
PB5_OUTPUT_ENABLE


215 
	#PB5_OUTPUT_ENABLE
 0

	)

217 #i‚de‡
PB6_OUTPUT_ENABLE


218 
	#PB6_OUTPUT_ENABLE
 0

	)

220 #i‚de‡
PB7_OUTPUT_ENABLE


221 
	#PB7_OUTPUT_ENABLE
 0

	)

223 #i‚de‡
PB0_DATA_STRENGTH


224 
	#PB0_DATA_STRENGTH
 1

	)

226 #i‚de‡
PB1_DATA_STRENGTH


227 
	#PB1_DATA_STRENGTH
 1

	)

229 #i‚de‡
PB2_DATA_STRENGTH


230 
	#PB2_DATA_STRENGTH
 1

	)

232 #i‚de‡
PB3_DATA_STRENGTH


233 
	#PB3_DATA_STRENGTH
 1

	)

235 #i‚de‡
PB4_DATA_STRENGTH


236 
	#PB4_DATA_STRENGTH
 1

	)

238 #i‚de‡
PB5_DATA_STRENGTH


239 
	#PB5_DATA_STRENGTH
 1

	)

241 #i‚de‡
PB6_DATA_STRENGTH


242 
	#PB6_DATA_STRENGTH
 1

	)

244 #i‚de‡
PB7_DATA_STRENGTH


245 
	#PB7_DATA_STRENGTH
 1

	)

247 #i‚de‡
PB0_DATA_OUT


248 
	#PB0_DATA_OUT
 0

	)

250 #i‚de‡
PB1_DATA_OUT


251 
	#PB1_DATA_OUT
 0

	)

253 #i‚de‡
PB2_DATA_OUT


254 
	#PB2_DATA_OUT
 0

	)

256 #i‚de‡
PB3_DATA_OUT


257 
	#PB3_DATA_OUT
 0

	)

259 #i‚de‡
PB4_DATA_OUT


260 
	#PB4_DATA_OUT
 0

	)

262 #i‚de‡
PB5_DATA_OUT


263 
	#PB5_DATA_OUT
 0

	)

265 #i‚de‡
PB6_DATA_OUT


266 
	#PB6_DATA_OUT
 0

	)

268 #i‚de‡
PB7_DATA_OUT


269 
	#PB7_DATA_OUT
 0

	)

271 #i‚de‡
PB0_FUNC


272 
	#PB0_FUNC
 
AS_GPIO


	)

274 #i‚de‡
PB1_FUNC


275 
	#PB1_FUNC
 
AS_GPIO


	)

277 #i‚de‡
PB2_FUNC


278 
	#PB2_FUNC
 
AS_GPIO


	)

280 #i‚de‡
PB3_FUNC


281 
	#PB3_FUNC
 
AS_GPIO


	)

283 #i‚de‡
PB4_FUNC


284 
	#PB4_FUNC
 
AS_GPIO


	)

286 #i‚de‡
PB5_FUNC


287 
	#PB5_FUNC
 
AS_GPIO


	)

289 #i‚de‡
PB6_FUNC


290 
	#PB6_FUNC
 
AS_GPIO


	)

292 #i‚de‡
PB7_FUNC


293 
	#PB7_FUNC
 
AS_GPIO


	)

295 #i‚de‡
PULL_WAKEUP_SRC_PB0


296 
	#PULL_WAKEUP_SRC_PB0
 0

	)

298 #i‚de‡
PULL_WAKEUP_SRC_PB1


299 
	#PULL_WAKEUP_SRC_PB1
 0

	)

301 #i‚de‡
PULL_WAKEUP_SRC_PB2


302 
	#PULL_WAKEUP_SRC_PB2
 0

	)

304 #i‚de‡
PULL_WAKEUP_SRC_PB3


305 
	#PULL_WAKEUP_SRC_PB3
 0

	)

307 #i‚de‡
PULL_WAKEUP_SRC_PB4


308 
	#PULL_WAKEUP_SRC_PB4
 0

	)

310 #i‚de‡
PULL_WAKEUP_SRC_PB5


311 
	#PULL_WAKEUP_SRC_PB5
 0

	)

313 #i‚de‡
PULL_WAKEUP_SRC_PB6


314 
	#PULL_WAKEUP_SRC_PB6
 0

	)

316 #i‚de‡
PULL_WAKEUP_SRC_PB7


317 
	#PULL_WAKEUP_SRC_PB7
 0

	)

321 #i‚de‡
PC0_INPUT_ENABLE


322 
	#PC0_INPUT_ENABLE
 0

	)

324 #i‚de‡
PC1_INPUT_ENABLE


325 
	#PC1_INPUT_ENABLE
 0

	)

327 #i‚de‡
PC2_INPUT_ENABLE


328 
	#PC2_INPUT_ENABLE
 0

	)

330 #i‚de‡
PC3_INPUT_ENABLE


331 
	#PC3_INPUT_ENABLE
 0

	)

333 #i‚de‡
PC4_INPUT_ENABLE


334 
	#PC4_INPUT_ENABLE
 0

	)

336 #i‚de‡
PC5_INPUT_ENABLE


337 
	#PC5_INPUT_ENABLE
 0

	)

339 #i‚de‡
PC6_INPUT_ENABLE


340 
	#PC6_INPUT_ENABLE
 0

	)

342 #i‚de‡
PC7_INPUT_ENABLE


343 
	#PC7_INPUT_ENABLE
 0

	)

345 #i‚de‡
PC0_OUTPUT_ENABLE


346 
	#PC0_OUTPUT_ENABLE
 0

	)

348 #i‚de‡
PC1_OUTPUT_ENABLE


349 
	#PC1_OUTPUT_ENABLE
 0

	)

351 #i‚de‡
PC2_OUTPUT_ENABLE


352 
	#PC2_OUTPUT_ENABLE
 0

	)

354 #i‚de‡
PC3_OUTPUT_ENABLE


355 
	#PC3_OUTPUT_ENABLE
 0

	)

357 #i‚de‡
PC4_OUTPUT_ENABLE


358 
	#PC4_OUTPUT_ENABLE
 0

	)

360 #i‚de‡
PC5_OUTPUT_ENABLE


361 
	#PC5_OUTPUT_ENABLE
 0

	)

363 #i‚de‡
PC6_OUTPUT_ENABLE


364 
	#PC6_OUTPUT_ENABLE
 0

	)

366 #i‚de‡
PC7_OUTPUT_ENABLE


367 
	#PC7_OUTPUT_ENABLE
 0

	)

369 #i‚de‡
PC0_DATA_STRENGTH


370 
	#PC0_DATA_STRENGTH
 1

	)

372 #i‚de‡
PC1_DATA_STRENGTH


373 
	#PC1_DATA_STRENGTH
 1

	)

375 #i‚de‡
PC2_DATA_STRENGTH


376 
	#PC2_DATA_STRENGTH
 1

	)

378 #i‚de‡
PC3_DATA_STRENGTH


379 
	#PC3_DATA_STRENGTH
 1

	)

381 #i‚de‡
PC4_DATA_STRENGTH


382 
	#PC4_DATA_STRENGTH
 1

	)

384 #i‚de‡
PC5_DATA_STRENGTH


385 
	#PC5_DATA_STRENGTH
 1

	)

387 #i‚de‡
PC6_DATA_STRENGTH


388 
	#PC6_DATA_STRENGTH
 1

	)

390 #i‚de‡
PC7_DATA_STRENGTH


391 
	#PC7_DATA_STRENGTH
 1

	)

393 #i‚de‡
PC0_DATA_OUT


394 
	#PC0_DATA_OUT
 0

	)

396 #i‚de‡
PC1_DATA_OUT


397 
	#PC1_DATA_OUT
 0

	)

399 #i‚de‡
PC2_DATA_OUT


400 
	#PC2_DATA_OUT
 0

	)

402 #i‚de‡
PC3_DATA_OUT


403 
	#PC3_DATA_OUT
 0

	)

405 #i‚de‡
PC4_DATA_OUT


406 
	#PC4_DATA_OUT
 0

	)

408 #i‚de‡
PC5_DATA_OUT


409 
	#PC5_DATA_OUT
 0

	)

411 #i‚de‡
PC6_DATA_OUT


412 
	#PC6_DATA_OUT
 0

	)

414 #i‚de‡
PC7_DATA_OUT


415 
	#PC7_DATA_OUT
 0

	)

417 #i‚de‡
PC0_FUNC


418 
	#PC0_FUNC
 
AS_GPIO


	)

420 #i‚de‡
PC1_FUNC


421 
	#PC1_FUNC
 
AS_GPIO


	)

423 #i‚de‡
PC2_FUNC


424 
	#PC2_FUNC
 
AS_GPIO


	)

426 #i‚de‡
PC3_FUNC


427 
	#PC3_FUNC
 
AS_GPIO


	)

429 #i‚de‡
PC4_FUNC


430 
	#PC4_FUNC
 
AS_GPIO


	)

432 #i‚de‡
PC5_FUNC


433 
	#PC5_FUNC
 
AS_GPIO


	)

435 #i‚de‡
PC6_FUNC


436 
	#PC6_FUNC
 
AS_GPIO


	)

438 #i‚de‡
PC7_FUNC


439 
	#PC7_FUNC
 
AS_GPIO


	)

441 #i‚de‡
PULL_WAKEUP_SRC_PC0


442 
	#PULL_WAKEUP_SRC_PC0
 0

	)

444 #i‚de‡
PULL_WAKEUP_SRC_PC1


445 
	#PULL_WAKEUP_SRC_PC1
 0

	)

447 #i‚de‡
PULL_WAKEUP_SRC_PC2


448 
	#PULL_WAKEUP_SRC_PC2
 0

	)

450 #i‚de‡
PULL_WAKEUP_SRC_PC3


451 
	#PULL_WAKEUP_SRC_PC3
 0

	)

453 #i‚de‡
PULL_WAKEUP_SRC_PC4


454 
	#PULL_WAKEUP_SRC_PC4
 0

	)

456 #i‚de‡
PULL_WAKEUP_SRC_PC5


457 
	#PULL_WAKEUP_SRC_PC5
 0

	)

459 #i‚de‡
PULL_WAKEUP_SRC_PC6


460 
	#PULL_WAKEUP_SRC_PC6
 0

	)

462 #i‚de‡
PULL_WAKEUP_SRC_PC7


463 
	#PULL_WAKEUP_SRC_PC7
 0

	)

467 #i‚de‡
PD0_INPUT_ENABLE


468 
	#PD0_INPUT_ENABLE
 0

	)

470 #i‚de‡
PD1_INPUT_ENABLE


471 
	#PD1_INPUT_ENABLE
 0

	)

473 #i‚de‡
PD2_INPUT_ENABLE


474 
	#PD2_INPUT_ENABLE
 0

	)

476 #i‚de‡
PD3_INPUT_ENABLE


477 
	#PD3_INPUT_ENABLE
 0

	)

479 #i‚de‡
PD4_INPUT_ENABLE


480 
	#PD4_INPUT_ENABLE
 0

	)

482 #i‚de‡
PD5_INPUT_ENABLE


483 
	#PD5_INPUT_ENABLE
 0

	)

485 #i‚de‡
PD6_INPUT_ENABLE


486 
	#PD6_INPUT_ENABLE
 0

	)

488 #i‚de‡
PD7_INPUT_ENABLE


489 
	#PD7_INPUT_ENABLE
 0

	)

491 #i‚de‡
PD0_OUTPUT_ENABLE


492 
	#PD0_OUTPUT_ENABLE
 0

	)

494 #i‚de‡
PD1_OUTPUT_ENABLE


495 
	#PD1_OUTPUT_ENABLE
 0

	)

497 #i‚de‡
PD2_OUTPUT_ENABLE


498 
	#PD2_OUTPUT_ENABLE
 0

	)

500 #i‚de‡
PD3_OUTPUT_ENABLE


501 
	#PD3_OUTPUT_ENABLE
 0

	)

503 #i‚de‡
PD4_OUTPUT_ENABLE


504 
	#PD4_OUTPUT_ENABLE
 0

	)

506 #i‚de‡
PD5_OUTPUT_ENABLE


507 
	#PD5_OUTPUT_ENABLE
 0

	)

509 #i‚de‡
PD6_OUTPUT_ENABLE


510 
	#PD6_OUTPUT_ENABLE
 0

	)

512 #i‚de‡
PD7_OUTPUT_ENABLE


513 
	#PD7_OUTPUT_ENABLE
 0

	)

515 #i‚de‡
PD0_DATA_STRENGTH


516 
	#PD0_DATA_STRENGTH
 1

	)

518 #i‚de‡
PD1_DATA_STRENGTH


519 
	#PD1_DATA_STRENGTH
 1

	)

521 #i‚de‡
PD2_DATA_STRENGTH


522 
	#PD2_DATA_STRENGTH
 1

	)

524 #i‚de‡
PD3_DATA_STRENGTH


525 
	#PD3_DATA_STRENGTH
 1

	)

527 #i‚de‡
PD4_DATA_STRENGTH


528 
	#PD4_DATA_STRENGTH
 1

	)

530 #i‚de‡
PD5_DATA_STRENGTH


531 
	#PD5_DATA_STRENGTH
 1

	)

533 #i‚de‡
PD6_DATA_STRENGTH


534 
	#PD6_DATA_STRENGTH
 1

	)

536 #i‚de‡
PD7_DATA_STRENGTH


537 
	#PD7_DATA_STRENGTH
 1

	)

539 #i‚de‡
PD0_DATA_OUT


540 
	#PD0_DATA_OUT
 0

	)

542 #i‚de‡
PD1_DATA_OUT


543 
	#PD1_DATA_OUT
 0

	)

545 #i‚de‡
PD2_DATA_OUT


546 
	#PD2_DATA_OUT
 0

	)

548 #i‚de‡
PD3_DATA_OUT


549 
	#PD3_DATA_OUT
 0

	)

551 #i‚de‡
PD4_DATA_OUT


552 
	#PD4_DATA_OUT
 0

	)

554 #i‚de‡
PD5_DATA_OUT


555 
	#PD5_DATA_OUT
 0

	)

557 #i‚de‡
PD6_DATA_OUT


558 
	#PD6_DATA_OUT
 0

	)

560 #i‚de‡
PD7_DATA_OUT


561 
	#PD7_DATA_OUT
 0

	)

563 #i‚de‡
PD0_FUNC


564 
	#PD0_FUNC
 
AS_GPIO


	)

566 #i‚de‡
PD1_FUNC


567 
	#PD1_FUNC
 
AS_GPIO


	)

569 #i‚de‡
PD2_FUNC


570 
	#PD2_FUNC
 
AS_GPIO


	)

572 #i‚de‡
PD3_FUNC


573 
	#PD3_FUNC
 
AS_GPIO


	)

575 #i‚de‡
PD4_FUNC


576 
	#PD4_FUNC
 
AS_GPIO


	)

578 #i‚de‡
PD5_FUNC


579 
	#PD5_FUNC
 
AS_GPIO


	)

581 #i‚de‡
PD6_FUNC


582 
	#PD6_FUNC
 
AS_GPIO


	)

584 #i‚de‡
PD7_FUNC


585 
	#PD7_FUNC
 
AS_GPIO


	)

587 #i‚de‡
PULL_WAKEUP_SRC_PD0


588 
	#PULL_WAKEUP_SRC_PD0
 0

	)

590 #i‚de‡
PULL_WAKEUP_SRC_PD1


591 
	#PULL_WAKEUP_SRC_PD1
 0

	)

593 #i‚de‡
PULL_WAKEUP_SRC_PD2


594 
	#PULL_WAKEUP_SRC_PD2
 0

	)

596 #i‚de‡
PULL_WAKEUP_SRC_PD3


597 
	#PULL_WAKEUP_SRC_PD3
 0

	)

599 #i‚de‡
PULL_WAKEUP_SRC_PD4


600 
	#PULL_WAKEUP_SRC_PD4
 0

	)

602 #i‚de‡
PULL_WAKEUP_SRC_PD5


603 
	#PULL_WAKEUP_SRC_PD5
 0

	)

605 #i‚de‡
PULL_WAKEUP_SRC_PD6


606 
	#PULL_WAKEUP_SRC_PD6
 0

	)

608 #i‚de‡
PULL_WAKEUP_SRC_PD7


609 
	#PULL_WAKEUP_SRC_PD7
 0

	)

613 #i‚de‡
PE0_INPUT_ENABLE


614 
	#PE0_INPUT_ENABLE
 1

616 #i‚de‡
PE1_INPUT_ENABLE


	)

617 
	#PE1_INPUT_ENABLE
 1

619 #i‚de‡
PE2_INPUT_ENABLE


	)

620 
	#PE2_INPUT_ENABLE
 1

622 #i‚de‡
PE3_INPUT_ENABLE


	)

623 
	#PE3_INPUT_ENABLE
 1

625 #i‚de‡
PE0_OUTPUT_ENABLE


	)

626 
	#PE0_OUTPUT_ENABLE
 0

	)

628 #i‚de‡
PE1_OUTPUT_ENABLE


629 
	#PE1_OUTPUT_ENABLE
 0

	)

631 #i‚de‡
PE2_OUTPUT_ENABLE


632 
	#PE2_OUTPUT_ENABLE
 0

	)

634 #i‚de‡
PE3_OUTPUT_ENABLE


635 
	#PE3_OUTPUT_ENABLE
 0

	)

638 #i‚de‡
PE0_DATA_STRENGTH


639 
	#PE0_DATA_STRENGTH
 1

	)

641 #i‚de‡
PE1_DATA_STRENGTH


642 
	#PE1_DATA_STRENGTH
 1

	)

644 #i‚de‡
PE2_DATA_STRENGTH


645 
	#PE2_DATA_STRENGTH
 1

	)

647 #i‚de‡
PE3_DATA_STRENGTH


648 
	#PE3_DATA_STRENGTH
 1

	)

651 #i‚de‡
PE0_DATA_OUT


652 
	#PE0_DATA_OUT
 0

	)

654 #i‚de‡
PE1_DATA_OUT


655 
	#PE1_DATA_OUT
 0

	)

657 #i‚de‡
PE2_DATA_OUT


658 
	#PE2_DATA_OUT
 0

	)

660 #i‚de‡
PE3_DATA_OUT


661 
	#PE3_DATA_OUT
 0

	)

664 #i‚de‡
PE0_FUNC


665 
	#PE0_FUNC
 
AS_MSPI


	)

667 #i‚de‡
PE1_FUNC


668 
	#PE1_FUNC
 
AS_MSPI


	)

670 #i‚de‡
PE2_FUNC


671 
	#PE2_FUNC
 
AS_MSPI


	)

673 #i‚de‡
PE3_FUNC


674 
	#PE3_FUNC
 
AS_MSPI


	)

683 
ölöe
 
	$gpio_™Æog_ªsi°™˚_öô
()

685 
	`™Æog_wrôe
 (0x0e, 
PULL_WAKEUP_SRC_PA0
 |

686 (
PULL_WAKEUP_SRC_PA1
<<2) |

687 (
PULL_WAKEUP_SRC_PA2
<<4) |

688 (
PULL_WAKEUP_SRC_PA3
<<6));

690 
	`™Æog_wrôe
 (0x0f, 
PULL_WAKEUP_SRC_PA4
 |

691 (
PULL_WAKEUP_SRC_PA5
<<2) |

692 (
PULL_WAKEUP_SRC_PA6
<<4) |

693 (
PULL_WAKEUP_SRC_PA7
<<6));

696 
	`™Æog_wrôe
 (0x10, 
PULL_WAKEUP_SRC_PB0
 |

697 (
PULL_WAKEUP_SRC_PB1
<<2) |

698 (
PULL_WAKEUP_SRC_PB2
<<4) |

699 (
PULL_WAKEUP_SRC_PB3
<<6));

701 
	`™Æog_wrôe
 (0x11, 
PULL_WAKEUP_SRC_PB4
 |

702 (
PULL_WAKEUP_SRC_PB5
<<2) |

703 (
PULL_WAKEUP_SRC_PB6
<<4) |

704 (
PULL_WAKEUP_SRC_PB7
<<6));

707 
	`™Æog_wrôe
 (0x12, 
PULL_WAKEUP_SRC_PC0
 |

708 (
PULL_WAKEUP_SRC_PC1
<<2) |

709 (
PULL_WAKEUP_SRC_PC2
<<4) |

710 (
PULL_WAKEUP_SRC_PC3
<<6));

712 
	`™Æog_wrôe
 (0x13, 
PULL_WAKEUP_SRC_PC4
 |

713 (
PULL_WAKEUP_SRC_PC5
<<2) |

714 (
PULL_WAKEUP_SRC_PC6
<<4) |

715 (
PULL_WAKEUP_SRC_PC7
<<6));

718 
	`™Æog_wrôe
 (0x14, 
PULL_WAKEUP_SRC_PD0
 |

719 (
PULL_WAKEUP_SRC_PD1
<<2) |

720 (
PULL_WAKEUP_SRC_PD2
<<4) |

721 (
PULL_WAKEUP_SRC_PD3
<<6));

723 
	`™Æog_wrôe
 (0x15, 
PULL_WAKEUP_SRC_PD4
 |

724 (
PULL_WAKEUP_SRC_PD5
<<2) |

725 (
PULL_WAKEUP_SRC_PD6
<<4) |

726 (
PULL_WAKEUP_SRC_PD7
<<6));

727 
	}
}

740 
ölöe
 
	$gpio_öô
(
™aRes_öô_í
)

742 
ªg_gpio_∑_£âög1
 =

743 (
PA0_INPUT_ENABLE
<<8Ë| (
PA1_INPUT_ENABLE
<<9Ë| (
PA2_INPUT_ENABLE
<<10Ë| (
PA3_INPUT_ENABLE
<<11) |

744 (
PA4_INPUT_ENABLE
<<12Ë| (
PA5_INPUT_ENABLE
<<13Ë| (
PA6_INPUT_ENABLE
<<14Ë| (
PA7_INPUT_ENABLE
<<15) |

745 ((
PA0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PA1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PA2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PA3_OUTPUT_ENABLE
?0:1)<<19) |

746 ((
PA4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PA5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PA6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PA7_OUTPUT_ENABLE
?0:1)<<23) |

747 (
PA0_DATA_OUT
<<24Ë| (
PA1_DATA_OUT
<<25Ë| (
PA2_DATA_OUT
<<26Ë| (
PA3_DATA_OUT
<<27) |

748 (
PA4_DATA_OUT
<<28Ë| (
PA5_DATA_OUT
<<29Ë| (
PA6_DATA_OUT
<<30Ë| (
PA7_DATA_OUT
<<31) ;

749 
ªg_gpio_∑_£âög2
 =

750 (
PA0_DATA_STRENGTH
<<8Ë| (
PA1_DATA_STRENGTH
<<9)| (
PA2_DATA_STRENGTH
<<10Ë| (
PA3_DATA_STRENGTH
<<11) |

751 (
PA4_DATA_STRENGTH
<<12Ë| (
PA5_DATA_STRENGTH
<<13Ë| (
PA6_DATA_STRENGTH
<<14Ë| (
PA7_DATA_STRENGTH
<<15) |

752 (
PA0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PA1_FUNC
==AS_GPIO ? BIT(17):0)| (
PA2_FUNC
==AS_GPIO ? BIT(18):0)| (
PA3_FUNC
==AS_GPIO ? BIT(19):0) |

753 (
PA4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PA5_FUNC
==AS_GPIO ? BIT(21):0)| (
PA6_FUNC
==AS_GPIO ? BIT(22):0)| (
PA7_FUNC
==AS_GPIO ? BIT(23):0);

757 
ªg_gpio_pb_£âög1
 =

758 (
PB0_INPUT_ENABLE
<<8Ë| (
PB1_INPUT_ENABLE
<<9Ë| (
PB2_INPUT_ENABLE
<<10Ë| (
PB3_INPUT_ENABLE
<<11) |

759 (
PB4_INPUT_ENABLE
<<12Ë| (
PB5_INPUT_ENABLE
<<13Ë| (
PB6_INPUT_ENABLE
<<14Ë| (
PB7_INPUT_ENABLE
<<15) |

760 ((
PB0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PB1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PB2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PB3_OUTPUT_ENABLE
?0:1)<<19) |

761 ((
PB4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PB5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PB6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PB7_OUTPUT_ENABLE
?0:1)<<23) |

762 (
PB0_DATA_OUT
<<24Ë| (
PB1_DATA_OUT
<<25Ë| (
PB2_DATA_OUT
<<26Ë| (
PB3_DATA_OUT
<<27) |

763 (
PB4_DATA_OUT
<<28Ë| (
PB5_DATA_OUT
<<29Ë| (
PB6_DATA_OUT
<<30Ë| (
PB7_DATA_OUT
<<31) ;

764 
ªg_gpio_pb_£âög2
 =

765 (
PB0_DATA_STRENGTH
<<8Ë| (
PB1_DATA_STRENGTH
<<9)| (
PB2_DATA_STRENGTH
<<10Ë| (
PB3_DATA_STRENGTH
<<11) |

766 (
PB4_DATA_STRENGTH
<<12Ë| (
PB5_DATA_STRENGTH
<<13Ë| (
PB6_DATA_STRENGTH
<<14Ë| (
PB7_DATA_STRENGTH
<<15) |

767 (
PB0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PB1_FUNC
==AS_GPIO ? BIT(17):0)| (
PB2_FUNC
==AS_GPIO ? BIT(18):0)| (
PB3_FUNC
==AS_GPIO ? BIT(19):0) |

768 (
PB4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PB5_FUNC
==AS_GPIO ? BIT(21):0)| (
PB6_FUNC
==AS_GPIO ? BIT(22):0)| (
PB7_FUNC
==AS_GPIO ? BIT(23):0);

772 
	`™Æog_wrôe
(
¨eg_gpio_pc_õ
, (
PC0_INPUT_ENABLE
<<0Ë| (
PC1_INPUT_ENABLE
<<1Ë| (
PC2_INPUT_ENABLE
<<2Ë| (
PC3_INPUT_ENABLE
<<3) |

773 (
PC4_INPUT_ENABLE
<<4Ë| (
PC5_INPUT_ENABLE
<<5Ë| (
PC6_INPUT_ENABLE
<<6Ë| (
PC7_INPUT_ENABLE
<<7) );

776 
ªg_gpio_pc_€n
 =

777 ((
PC0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PC1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PC2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PC3_OUTPUT_ENABLE
?0:1)<<3) |

778 ((
PC4_OUTPUT_ENABLE
?0:1)<<4Ë| ((
PC5_OUTPUT_ENABLE
?0:1)<<5Ë| ((
PC6_OUTPUT_ENABLE
?0:1)<<6Ë| ((
PC7_OUTPUT_ENABLE
?0:1)<<7);

780 
ªg_gpio_pc_out
 =

781 (
PC0_DATA_OUT
<<0Ë| (
PC1_DATA_OUT
<<1Ë| (
PC2_DATA_OUT
<<2Ë| (
PC3_DATA_OUT
<<3) |

782 (
PC4_DATA_OUT
<<4Ë| (
PC5_DATA_OUT
<<5Ë| (
PC6_DATA_OUT
<<6Ë| (
PC7_DATA_OUT
<<7) ;

785 
	`™Æog_wrôe
(
¨eg_gpio_pc_ds
, (
PC0_DATA_STRENGTH
<<0Ë| (
PC1_DATA_STRENGTH
<<1Ë| (
PC2_DATA_STRENGTH
<<2Ë| (
PC3_DATA_STRENGTH
<<3) |

786 (
PC4_DATA_STRENGTH
<<4Ë| (
PC5_DATA_STRENGTH
<<5Ë| (
PC6_DATA_STRENGTH
<<6Ë| (
PC7_DATA_STRENGTH
<<7) );

788 
ªg_gpio_pc_gpio
 =

789 (
PC0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PC1_FUNC
==AS_GPIO ? BIT(1):0)| (
PC2_FUNC
==AS_GPIO ? BIT(2):0)| (
PC3_FUNC
==AS_GPIO ? BIT(3):0) |

790 (
PC4_FUNC
==
AS_GPIO
 ? 
	`BIT
(4):0Ë| (
PC5_FUNC
==AS_GPIO ? BIT(5):0)| (
PC6_FUNC
==AS_GPIO ? BIT(6):0)| (
PC7_FUNC
==AS_GPIO ? BIT(7):0);

794 
ªg_gpio_pd_£âög1
 =

795 (
PD0_INPUT_ENABLE
<<8Ë| (
PD1_INPUT_ENABLE
<<9Ë| (
PD2_INPUT_ENABLE
<<10Ë| (
PD3_INPUT_ENABLE
<<11) |

796 (
PD4_INPUT_ENABLE
<<12Ë| (
PD5_INPUT_ENABLE
<<13)| (
PD6_INPUT_ENABLE
<<14Ë| (
PD7_INPUT_ENABLE
<<15) |

797 ((
PD0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PD1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PD2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PD3_OUTPUT_ENABLE
?0:1)<<19) |

798 ((
PD4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PD5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PD6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PD7_OUTPUT_ENABLE
?0:1)<<23) |

799 (
PD0_DATA_OUT
<<24Ë| (
PD1_DATA_OUT
<<25Ë| (
PD2_DATA_OUT
<<26Ë| (
PD3_DATA_OUT
<<27) |

800 (
PD4_DATA_OUT
<<28Ë| (
PD5_DATA_OUT
<<29Ë| (
PD6_DATA_OUT
<<30Ë| (
PD7_DATA_OUT
<<31) ;

801 
ªg_gpio_pd_£âög2
 =

802 (
PD0_DATA_STRENGTH
<<8Ë| (
PD1_DATA_STRENGTH
<<9Ë| (
PD2_DATA_STRENGTH
<<10Ë| (
PD3_DATA_STRENGTH
<<11) |

803 (
PD4_DATA_STRENGTH
<<12Ë| (
PD5_DATA_STRENGTH
<<13Ë| (
PD6_DATA_STRENGTH
<<14Ë| (
PD7_DATA_STRENGTH
<<15) |

804 (
PD0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PD1_FUNC
==AS_GPIO ? BIT(17):0)| (
PD2_FUNC
==AS_GPIO ? BIT(18):0)| (
PD3_FUNC
==AS_GPIO ? BIT(19):0) |

805 (
PD4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PD5_FUNC
==AS_GPIO ? BIT(21):0)| (
PD6_FUNC
==AS_GPIO ? BIT(22):0)| (
PD7_FUNC
==AS_GPIO ? BIT(23):0);

809 
ªg_gpio_≥_õ
 = (
PE0_INPUT_ENABLE
<<0Ë| (
PE1_INPUT_ENABLE
<<1)| (
PE2_INPUT_ENABLE
<<2Ë| (
PE3_INPUT_ENABLE
<<3);

810 
ªg_gpio_≥_€n
 = ((
PE0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PE1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PE2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PE3_OUTPUT_ENABLE
?0:1)<<3);

811 
ªg_gpio_≥_out
 = (
PE0_DATA_OUT
<<0Ë| (
PE1_DATA_OUT
<<1Ë| (
PE2_DATA_OUT
<<2Ë| (
PE3_DATA_OUT
<<3);

812 
ªg_gpio_≥_ds
 = (
PE0_DATA_STRENGTH
<<0Ë| (
PE1_DATA_STRENGTH
<<1Ë| (
PE2_DATA_STRENGTH
<<2Ë| (
PE3_DATA_STRENGTH
<<3);

813 
ªg_gpio_≥_gpio
 = (
PE0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PE1_FUNC
==AS_GPIO ? BIT(1):0)| (
PE2_FUNC
==AS_GPIO ? BIT(2):0)| (
PE3_FUNC
==AS_GPIO ? BIT(3):0);

815 if(
™aRes_öô_í
){

816 
	`gpio_™Æog_ªsi°™˚_öô
();

818 
	}
}

	@platform/chip_8278/i2c.h

24 #i‚de‡
I2C_H


25 
	#I2C_H


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

35 
	mI2C_GPIO_SDA_A3
 = 
GPIO_PA3
,

36 
	mI2C_GPIO_SDA_B6
 = 
GPIO_PB6
,

37 
	mI2C_GPIO_SDA_C0
 = 
GPIO_PC0
,

38 
	mI2C_GPIO_SDA_C2
 = 
GPIO_PC2
,

39 }
	tI2C_GPIO_SdaTy≥Def
;

42 
	mI2C_GPIO_SCL_A4
 = 
GPIO_PA4
,

43 
	mI2C_GPIO_SCL_D7
 = 
GPIO_PD7
,

44 
	mI2C_GPIO_SCL_C1
 = 
GPIO_PC1
,

45 
	mI2C_GPIO_SCL_C3
 = 
GPIO_PC3
,

46 }
	tI2C_GPIO_S˛Ty≥Def
;

73 
	mI2C_SLAVE_DMA
 = 0,

74 
	mI2C_SLAVE_MAP
,

75 }
	tI2C_SœveMode
;

78 
	mHOST_CMD_IRQ
 = 
BIT
(0), 
	mSLAVE_SPI_IRQ
 = 
HOST_CMD_IRQ
,

79 
	mHOST_READ_IRQ
 = 
BIT
(1),

80 }
	ti2c_úq_e
;

87 
ölöe
 
	$ª£t_i2c_moudÀ
()

89 
ªg_r°0
 |
FLD_RST0_I2C
;

90 
ªg_r°0
 &(~
FLD_RST0_I2C
);

91 
	}
}

98 
ölöe
 
	$i2c_£t_id
(
SœveID
)

100 
ªg_i2c_id
 = 
SœveID
;

101 
	}
}

108 
ölöe
 
	$i2c_¶ave_m≠pög_mode_d©a_buf„r_c⁄fig
(* 
pM≠Buf
)

110 
ªg_i2c_¶ave_m≠_addæ
 = ()((()
pM≠Buf
 & 0xff));

111 
ªg_i2c_¶ave_m≠_addrm
 = ()((()
pM≠Buf
>>8)&0xff);

112 
ªg_i2c_¶ave_m≠_addrh
 = 0x04;

113 
	}
}

120 
i2c_gpio_£t
(
I2C_GPIO_SdaTy≥Def
 
sda_pö
,
I2C_GPIO_S˛Ty≥Def
 
s˛_pö
);

128 
i2c_ma°î_öô
(
DivClock
);

138 
i2c_¶ave_öô
(
devi˚_ID
,
I2C_SœveMode
 
mode
,* 
pM≠Buf
);

149 
i2c_wrôe_byã
(
Addr
, 
AddrLí
, 
D©a
);

158 
i2c_ªad_byã
(
Addr
, 
AddrLí
);

168 
i2c_wrôe_£rõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

178 
i2c_ªad_£rõs
(
Addr
, 
AddrLí
, * 
d©aBuf
, 
d©aLí
);

186 
ölöe
 
	$i2c_˛ór_öãºu±_°©us
(
i2c_úq_e
 
úq_°©us
)

188 
ªg_i2c_¶ave_úq_°©us

úq_°©us
;

189 
	}
}

197 
ölöe
 
	$i2c_gë_öãºu±_°©us
(
i2c_úq_e
 
úq_°©us
){

198  
ªg_i2c_¶ave_úq_°©us
 & 
úq_°©us
;

199 
	}
}

	@platform/chip_8278/irq.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"bô.h
"

34 
ölöe
 
	$úq_íabÀ
(){

35 
r
 = 
ªg_úq_í
;

36 
ªg_úq_í
 = 1;

37  
r
;

38 
	}
}

45 
ölöe
 
	$úq_dißbÀ
(){

46 
r
 = 
ªg_úq_í
;

47 
ªg_úq_í
 = 0;

48  
r
;

49 
	}
}

56 
ölöe
 
	$úq_ª°‹e
(
í
){

57 
ªg_úq_í
 = 
í
;

58 
	}
}

65 
ölöe
 
	$úq_íabÀ_ty≥
(
msk
){

66 
	`BM_SET
(
ªg_úq_mask
, 
msk
);

67 
	}
}

74 
ölöe
 
	$úq_dißbÀ_ty≥
(
msk
){

75 
	`BM_CLR
(
ªg_úq_mask
, 
msk
);

76 
	}
}

83 
ölöe
 
	$úq_£t_mask
(
msk
){

84 
	`BM_SET
(
ªg_úq_mask
, 
msk
);

85 
	}
}

92 
ölöe
 
	$úq_˛r_mask
(
msk
){

93 
	`BM_CLR
(
ªg_úq_mask
, 
msk
);

94 
	}
}

101 
ölöe
 
	$úq_gë_mask
(){

102  
ªg_úq_mask
;

103 
	}
}

110 
ölöe
 
	$úq_gë_§c
(){

111  
ªg_úq_§c
;

112 
	}
}

119 
ölöe
 
	$úq_˛r_Æl_§c
()

121 
ªg_úq_§c
 = 0xffffffff;

122 
	}
}

129 
ölöe
 
	$úq_˛r_§c
(
msk
)

131 
ªg_úq_§c
 = 
msk
;

132 
	}
}

139 
ölöe
 
	$rf_úq_íabÀ
(
msk
)

141 
ªg_rf_úq_mask
 |
msk
;

142 
	}
}

149 
ölöe
 
	$rf_úq_dißbÀ
(
msk
)

151 
ªg_rf_úq_mask
 &(~
msk
);

152 
	}
}

159 
ölöe
 
	$rf_úq_§c_gë
()

161  
ªg_rf_úq_°©us
;

162 
	}
}

169 
ölöe
 
	$rf_úq_˛r_§c
(
msk
)

171 
ªg_rf_úq_°©us
 = 
msk
;

172 
	}
}

	@platform/chip_8278/pga.h

24 #i‚def 
pga_H


25 
	#pga_H


	)

27 
	~"b•.h
"

28 
	~"™Æog.h
"

31 
	mPGA_AIN_C0
,

32 
	mPGA_AIN_C1
,

33 
	mPGA_AIN_C2
,

34 
	mPGA_AIN_C3
,

39 
	mPGA_GAIN_VOL_45_2DB
 = 0x00,

40 
	mPGA_GAIN_VOL_43_5DB
 = 0x01,

41 
	mPGA_GAIN_VOL_42_1DB
 = 0x02,

42 
	mPGA_GAIN_VOL_40_5DB
 = 0x03,

43 
	mPGA_GAIN_VOL_39_1DB
 = 0x04,

44 
	mPGA_GAIN_VOL_37_4DB
 = 0x05,

45 
	mPGA_GAIN_VOL_36_0DB
 = 0x06,

46 
	mPGA_GAIN_VOL_34_6DB
 = 0x07,

47 
	mPGA_GAIN_VOL_33_0DB
 = 0x08,

48 
	mPGA_GAIN_VOL_30_1DB
 = 0x09,

49 
	mPGA_GAIN_VOL_27_0DB
 = 0x0a,

50 
	mPGA_GAIN_VOL_24_0DB
 = 0x0b,

51 
	mPGA_GAIN_VOL_21_0DB
 = 0x0c,

52 
	mPGA_GAIN_VOL_15_0DB
 = 0x0d,

53 
	mPGA_GAIN_VOL_9_0DB
 = 0x0e,

54 
	mPGA_GAIN_VOL_0_0DB
 = 0x0f,

57 
	#SET_PGA_CHN_ON
(
v
Ëdo{\

	)

58 
	gvÆ
=
™Æog_ªad
(0x80+124);\

59 
	gvÆ
 &(~(
v
));\

60 
™Æog_wrôe
(0x80+124,
vÆ
);\

62 
	#SET_PGA_LEFT_P_AIN
(
v
Ëdo{\

	)

63 
vÆ
=
	`RódA«logReg
(0x80+125);\

64 
vÆ
 &= 0xfc;\

65 
vÆ
 |((()(
v
))&0x03);\

66 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

67 
	}

	$}whûe
(0)

69 
	#SET_PGA_LEFT_N_AIN
(
v
Ëdo{\

	)

70 
vÆ
=
	`RódA«logReg
(0x80+125);\

71 
vÆ
 &= 0xf3;\

72 
vÆ
 |((()(
v
)<<2)&0x0c);\

73 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

74 
	}

	$}whûe
(0)

76 
	#SET_PGA_RIGHT_P_AIN
(
v
Ëdo{\

	)

77 
vÆ
=
	`RódA«logReg
(0x80+125);\

78 
vÆ
 &= 0xcf;\

79 
vÆ
 |((()(
v
)<<4)&0x30);\

80 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

81 
	}

	$}whûe
(0)

83 
	#SET_PGA_RIGHT_N_AIN
(
v
Ëdo{\

	)

84 
vÆ
=
	`RódA«logReg
(0x80+125);\

85 
vÆ
 &= 0x3f;\

86 
vÆ
 |((()(
v
)<<6)&0xc0);\

87 
	`WrôeA«logReg
(0x80+125,
vÆ
);\

88 
	}

	$}whûe
(0)

90 
	#SET_PGA_GAIN_FIX_VALUE
(
v
Ëdo{\

	)

91 
vÆ
=0;\

92 
vÆ
 |((()(
v
))&0x7f);\

93 
	`wrôe_ªg8
(0xb63,
vÆ
|0x80);\

94 
	}

	$}whûe
(0)

	@platform/chip_8278/pke.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

31 
	#GET_WORD_LEN
(
bôLí
Ë((bôLí+31)/32)

	)

32 
	#GET_BYTE_LEN
(
bôLí
Ë((bôLí+7)/8)

	)

34 
	#PKE_BASE
 (0X802000)

	)

35 
	#ªg_pke_a_øm
(
a
Ë((vﬁ©ûê*)(
PKE_BASE
+0x0400+◊)*(0x24)))

	)

36 
	#ªg_pke_b_øm
(
b
Ë((vﬁ©ûê*)(
PKE_BASE
+0x1000+(b)*(0x24)))

	)

39 
	#PKE_OPERAND_MAX_WORD_LEN
 (0x08)

	)

40 
	#PKE_OPERAND_MAX_BIT_LEN
 (0x100)

	)

41 
	#ECC_MAX_WORD_LEN
 
PKE_OPERAND_MAX_WORD_LEN


	)

42 
	#ECC_MAX_BIT_LEN
 
PKE_OPERAND_MAX_BIT_LEN


	)

44 #i‚de‡
NULL


45 
	#NULL
 0

	)

52 
	mec˝_p_bôLí
;

53 
	mec˝_n_bôLí
;

54 *
	mec˝_p
;

55 *
	mec˝_p_h
;

56 *
	mec˝_p_n1
;

57 *
	mec˝_a
;

58 *
	mec˝_b
;

59 *
	mec˝_Gx
;

60 *
	mec˝_Gy
;

61 *
	mec˝_n
;

62 *
	mec˝_n_h
;

63 *
	mec˝_n_n1
;

64 } 
	tec˝_curve_t
;

68 
	mm⁄t_p_bôLí
;

69 *
	mm⁄t_p
;

70 *
	mm⁄t_p_h
;

71 *
	mm⁄t_p_n1
;

72 *
	mm⁄t_a24
;

73 *
	mm⁄t_u
;

74 *
	mm⁄t_v
;

75 *
	mm⁄t_n
;

76 *
	mm⁄t_n_h
;

77 *
	mm⁄t_n_n1
;

78 *
	mm⁄t_h
;

79 } 
	tm⁄t_curve_t
;

83 
	medw¨d_p_bôLí
;

84 *
	medw¨d_p
;

85 *
	medw¨d_p_h
;

86 *
	medw¨d_p_n1
;

87 *
	medw¨d_d
;

88 *
	medw¨d_Gx
;

89 *
	medw¨d_Gy
;

90 *
	medw¨d_n
;

91 *
	medw¨d_n_h
;

92 *
	medw¨d_n_n1
;

93 *
	medw¨d_h
;

95 } 
	tedw¨d_curve_t
;

101 
	mPKE_SUCCESS
 = 0,

102 
	mPKE_ACTIVE_STOP
,

103 
	mPKE_MOD_INV_NOT_EXIST
,

104 
	mPKE_POINT_NOT_ON_CURVE
,

105 
	mPKE_INVALID_MICRO_CODE
,

106 
	mPKE_POINTOR_NULL
,

107 
	mPKE_INVALID_INPUT
,

108 }
	tpke_ªt_code_e
;

111 
	mPKE_EXE_CFG_ALL_NON_MONT
 = 0x15,

112 
	mPKE_EXE_CFG_ALL_MONT
 = 0x2A,

113 }
	tpke_exe_cfg_e
;

116 
	mPKE_MICROCODE_PDBL
 = 0x04,

117 
	mPKE_MICROCODE_PADD
 = 0x08,

118 
	mPKE_MICROCODE_PVER
 = 0x0C,

119 
	mPKE_MICROCODE_PMUL
 = 0x10,

120 
	mPKE_MICROCODE_MODMUL
 = 0x18,

121 
	mPKE_MICROCODE_MODINV
 = 0x1C,

122 
	mPKE_MICROCODE_MODADD
 = 0x20,

123 
	mPKE_MICROCODE_MODSUB
 = 0x24,

124 
	mPKE_MICROCODE_CAL_PRE_MON
 = 0x28,

125 
	mPKE_MICROCODE_C25519_PMUL
 = 0x34,

126 
	mPKE_MICROCODE_Ed25519_PMUL
 = 0x38,

127 
	mPKE_MICROCODE_Ed25519_PADD
 = 0x3C,

129 }
	tpke_mi¸ocode_e
;

140 sig√d 
big_öãgî_com∑ª
(*
a
, 
aW‹dLí
, *
b
, 
bW‹dLí
);

149 
sub_u32
(*
a
, *
b
, *
c
, 
w‹dLí
);

161 
div2n_u32
(
a
[], sig√d 
aW‹dLí
, 
n
);

167 
ölöe
 
	$pke_gë_úq_°©us
()

169  
ªg_pke_°©
 & 
FLD_PKE_STAT_DONE
;

170 
	}
}

176 
ölöe
 
	$pke_˛r_úq_°©us
()

178 
	`BM_CLR
(
ªg_pke_°©
, 
FLD_PKE_STAT_DONE
);

179 
	}
}

185 
ölöe
 
	$pke_£t_úq_mask
()

187 
	`BM_SET
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_IRQ_EN
);

188 
	}
}

194 
ölöe
 
	$pke_˛r_úq_mask
()

196 
	`BM_CLR
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_IRQ_EN
);

197 
	}
}

203 
ölöe
 
	$pke_£t_mi¸ocode
(
pke_mi¸ocode_e
 
addr
)

205 
ªg_pke_mc_±r
 = 
addr
;

206 
	}
}

212 
ölöe
 
	$pke_£t_exe_cfg
(
pke_exe_cfg_e
 
cfg
)

214 
ªg_pke_exe_c⁄f
 = 
cfg
;

215 
	}
}

221 
ölöe
 
	$pke_›r_°¨t
()

223 
	`BM_SET
(
ªg_pke_˘æ
, 
FLD_PKE_CTRL_START
);

224 
	}
}

234 
ölöe
 
	$pke_check_π_code
()

236  ()(
ªg_pke_π_code
 & 
FLD_PKE_RT_CODE_STOP_LOG
);

237 
	}
}

243 
ölöe
 
	$pke_£t_›î™d_width
(
bôLí
)

245 
	`BM_CLR
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_PARTIAL_RADIX
);

246 
	`BM_SET
(
ªg_pke_c⁄f
, 
	`GET_WORD_LEN
(
bôLí
)<<16);

247 
	`BM_CLR
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_BASE_RADIX
);

248 
	`BM_SET
(
ªg_pke_c⁄f
, 2<<24);

249 
	}
}

258 
pke_lﬂd_¥e_ˇlc_m⁄t
(*
H
, *
n1
, 
w‹dLí
);

268 
pke_ˇlc_¥e_m⁄t
(c⁄° *
modulus
, 
w‹dLí
);

278 
pke_ec˝_poöt_dñ
(
ec˝_curve_t
 *
curve
, *
k
, *
Px
, *
Py
,

279 *
Qx
, *
Qy
);

291 
pke_ec˝_poöt_add
(
ec˝_curve_t
 *
curve
, *
P1x
, *
P1y
, *
P2x
, *
P2y
,

292 *
Qx
, *
Qy
);

300 
pke_ec˝_poöt_vîify
(
ec˝_curve_t
 *
curve
, *
Px
, *
Py
);

311 
pke_ec˝_poöt_mul
(
ec˝_curve_t
 *
curve
, *
k
, *
Px
, *
Py
,

312 *
Qx
, *
Qy
);

322 
pke_mod_mul
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

323 *
out
, 
w‹dLí
);

333 
pke_mod_öv
(c⁄° *
modulus
, c⁄° *
a
, *
aöv
, 
modW‹dLí
,

334 
aW‹dLí
);

344 
pke_mod_add
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

345 *
out
, 
w‹dLí
);

355 
pke_mod_sub
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

356 *
out
, 
w‹dLí
);

365 
pke_x25519_poöt_mul
(
m⁄t_curve_t
 *
curve
, *
k
, *
Pu
, *
Qu
);

376 
pke_ed25519_poöt_mul
(
edw¨d_curve_t
 *
curve
, *
k
, *
Px
, *
Py
,

377 *
Qx
, *
Qy
);

390 
pke_ed25519_poöt_add
(
edw¨d_curve_t
 *
curve
, *
P1x
, *
P1y
, *
P2x
, *
P2y
,

391 *
Qx
, *
Qy
);

401 
pke_mod
(*
a
, 
aW‹dLí
, *
b
, *
b_h
, *
b_n1
,

402 
bW‹dLí
, *
c
);

	@platform/chip_8278/pm.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"gpio.h
"

28 
	~"˛ock.h
"

31 
	#XTAL_READY_CHECK_TIMING_OPTIMIZE
 1

	)

33 
	#RAM_CRC_EN
 1

34 

	)

37 
	#PM_DCDC_DELAY_DURATION
 187

39 

	)

40 
	#PM_XTAL_MANUAL_MODE_DELAY
 200

41 

	)

42 #if(
PM_DCDC_DELAY_DURATION
 == 62)

43 
	#PM_DCDC_DELAY_CYCLE
 0

	)

44 #ñif(
PM_DCDC_DELAY_DURATION
 == 125)

45 
	#PM_DCDC_DELAY_CYCLE
 1

	)

46 #ñif(
PM_DCDC_DELAY_DURATION
 == 187)

47 
	#PM_DCDC_DELAY_CYCLE
 2

	)

48 #ñif(
PM_DCDC_DELAY_DURATION
 == 250)

49 
	#PM_DCDC_DELAY_CYCLE
 3

	)

52 
	#EARLYWAKEUP_TIME_US_SUSPEND
 (
PM_DCDC_DELAY_DURATION
 + 
PM_XTAL_MANUAL_MODE_DELAY
 + 200)

53 
	#EARLYWAKEUP_TIME_US_DEEP_RET
 (
PM_DCDC_DELAY_DURATION
 + 64)

54 
	#EMPTYRUN_TIME_US
 (
EARLYWAKEUP_TIME_US_SUSPEND
 + 200)

	)

56 
	#EARLYWAKEUP_TIME
 19

	)

57 
	#tick_32k_tick_≥r_ms
 32

	)

58 
	#PM_EMPTYRUN_TIME_US
 25

	)

67 
	#DEEP_ANA_REG0
 0x3a

68 
	#DEEP_ANA_REG1
 0x3b

69 
	#DEEP_ANA_REG2
 0x3c

70 

	)

75 
	#DEEP_ANA_REG6
 0x35

76 
	#DEEP_ANA_REG7
 0x36

77 
	#DEEP_ANA_REG8
 0x37

78 
	#DEEP_ANA_REG9
 0x38

79 
	#DEEP_ANA_REG10
 0x39

80 

	)

82 
	#SYS_NEED_REINIT_EXT32K
 
	`BIT
(0)

	)

83 
	#SYS_DEEP_SLEEP_FLAG
 
	`BIT
(1)

	)

87 
	#SYS_DEEP_ANA_REG
 
DEEP_ANA_REG1


	)

88 
	#WAKEUP_STATUS_TIMER_CORE
 ( 
WAKEUP_STATUS_TIMER
 | 
WAKEUP_STATUS_CORE
)

	)

89 
	#WAKEUP_STATUS_TIMER_PAD
 ( 
WAKEUP_STATUS_TIMER
 | 
WAKEUP_STATUS_PAD
)

	)

91 
	#ZB_POWER_DOWN
 1

92 
	#AUDIO_POWER_DOWN
 1

93 
	#USB_POWER_DOWN
 1

94 

	)

100 
	mSUSPEND_MODE
 = 0x00,

102 
	mDEEPSLEEP_MODE
 = 0x30,

105 
	mDEEPSLEEP_MODE_RET_SRAM_LOW16K
 = 0x21,

106 
	mDEEPSLEEP_MODE_RET_SRAM_LOW32K
 = 0x03,

109 
	mDEEPSLEEP_RETENTION_FLAG
 = 0x0F,

110 }
	tSÀïMode_Ty≥Def
;

118 
	mPM_WAKEUP_PAD
 = 
BIT
(3),

119 
	mPM_WAKEUP_CORE
 = 
BIT
(4),

120 
	mPM_WAKEUP_TIMER
 = 
BIT
(5),

121 
	mPM_WAKEUP_COMPARATOR
 = 
BIT
(6),

122 
	mPM_WAKEUP_MDEC
 = 
BIT
(7),

123 }
	tSÀïWakeupSrc_Ty≥Def
;

129 
	mWAKEUP_STATUS_COMPARATOR
 = 
BIT
(0),

130 
	mWAKEUP_STATUS_TIMER
 = 
BIT
(1),

131 
	mWAKEUP_STATUS_CORE
 = 
BIT
(2),

132 
	mWAKEUP_STATUS_PAD
 = 
BIT
(3),

133 
	mWAKEUP_STATUS_MDEC
 = 
BIT
(4),

135 
	mSTATUS_GPIO_ERR_NO_ENTER_PM
 = 
BIT
(7),

136 
	mSTATUS_ENTER_SUSPEND
 = 
BIT
(30),

143 
	mMCU_STATUS_BOOT
,

144 
	mMCU_STATUS_DEEPRET_BACK
,

145 
	mMCU_STATUS_DEEP_BACK
,

146 }
	tpm_mcu_°©us
;

152 
	mis_∑d_wakeup
;

153 
	mwakeup_§c
;

154 
	mmcu_°©us
;

155 }
	tpm_∑ø_t
;

158 (*
	tsu•íd_h™dÀr_t
)();

159 (*
	tpm_tim_ªcovî_h™dÀr_t
)();

160 (*
	t˝u_pm_h™dÀr_t
)(
	tSÀïMode_Ty≥Def
 
	t¶ìp_mode
, 
	tSÀïWakeupSrc_Ty≥Def
 
	twakeup_§c
, 
	twakeup_tick
);

162 
su•íd_h™dÀr_t
 
func_bef‹e_su•íd
;

163 
pm_tim_ªcovî_h™dÀr_t
 
pm_tim_ªcovî
;

164 
˝u_pm_h™dÀr_t
 
˝u_¶ìp_wakeup
;

165 
pm_∑ø_t
 
pmP¨am
;

167 
PA5_PA6_DEEPSLEEP_LOW_LEVEL_WAKEUP_EN
;

168 
RAM_CRC_EN_16KRAM_TIME
;

169 
RAM_CRC_EN_32KRAM_TIME
;

170 
SOFT_START_DLY
;

171 
EARLYWAKEUP_TIME_US_DEEP
;

173 
	`bls_pm_ªgi°îFuncBef‹eSu•íd
(
su•íd_h™dÀr_t
 
func
);

181 
ölöe
 
	$dìp¶ìp_dp_dm_gpio_low_wake_íabÀ
()

183 
PA5_PA6_DEEPSLEEP_LOW_LEVEL_WAKEUP_EN
 = 0;

184 
	}
}

190 
ölöe
 
	$dìp¶ìp_dp_dm_gpio_low_wake_dißbÀ
()

192 
PA5_PA6_DEEPSLEEP_LOW_LEVEL_WAKEUP_EN
 = 1;

193 
	}
}

200 
ölöe
 
	$øm_¸c_í_timög
(
RAM_CRC_16K_Timög
, 
RAM_CRC_32K_Timög
)

202 
RAM_CRC_EN_16KRAM_TIME
 = 
RAM_CRC_16K_Timög
;

203 
RAM_CRC_EN_32KRAM_TIME
 = 
RAM_CRC_32K_Timög
;

204 
	}
}

211 
ölöe
 
	$so·_°¨t_dly_time
(
so·_°¨t_time
)

213 
SOFT_START_DLY
 = 
so·_°¨t_time
;

214 
EARLYWAKEUP_TIME_US_DEEP
 = 
PM_DCDC_DELAY_DURATION
 + 32 + ((
SOFT_START_DLY
)*62);

215 
	}
}

222 
ölöe
 
	$pm_gë_mcu_°©us
()

224  
pmP¨am
.
mcu_°©us
;

225 
	}
}

232 
ölöe
 
	$pm_is_∑dWakeup
()

234  
pmP¨am
.
is_∑d_wakeup
;

235 
	}
}

242 
ölöe
 
	$pm_gë_wakeup_§c
()

244  
pmP¨am
.
wakeup_§c
;

245 
	}
}

252 
˝u_°Æl_wakeup_by_timî0
(
tick
);

259 
˝u_°Æl_wakeup_by_timî1
(
tick
);

266 
˝u_°Æl_wakeup_by_timî2
(
tick
);

275 
˝u_£t_gpio_wakeup
(
GPIO_PöTy≥Def
 
pö
, 
GPIO_LevñTy≥Def
 
pﬁ
, 
í
);

282 
˝u_£t_mdec_vÆue_wakeup
(
vÆue
);

289 
pm_gë_32k_tick
();

297 
˝u_wakeup_öô
(
POWER_MODE_Ty≥Def
 
powî_mode
, 
XTAL_Ty≥Def
 
xèl
);

304 
pm_tim_ªcovî_32k_rc
(
now_tick_32k
);

311 
pm_tim_ªcovî_32k_xèl
(
now_tick_32k
);

320 
˝u_¶ìp_wakeup_32k_rc
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

329 
˝u_¶ìp_wakeup_32k_xèl
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

338 
pm_l⁄g_¶ìp_wakeup
(
SÀïMode_Ty≥Def
 
¶ìp_mode
, 
SÀïWakeupSrc_Ty≥Def
 
wakeup_§c
, 
wakeup_tick
);

345 
ölöe
 
	$pm_£À˘_öã∫Æ_32k_rc
()

347 
˝u_¶ìp_wakeup
 = 
˝u_¶ìp_wakeup_32k_rc
;

348 
pm_tim_ªcovî
 = 
pm_tim_ªcovî_32k_rc
;

349 
	}
}

356 
ölöe
 
	$pm_£À˘_exã∫Æ_32k_¸y°Æ
()

358 
˝u_¶ìp_wakeup
 = 
˝u_¶ìp_wakeup_32k_xèl
;

359 
pm_tim_ªcovî
 = 
pm_tim_ªcovî_32k_xèl
;

360 
	}
}

364 
é_mu…i_addr_L
;

365 
é_mu…i_addr_H
;

366 
é_24mrc_ˇl
;

367 
tick_32k_ˇlib
;

368 
tick_cur
;

369 
tick_32k_cur
;

370 
pm_l⁄g_su•íd
;

372 
¶ìp_°¨t
();

374 
pm_gë_öfo0
();

376 
pm_gë_öfo1
();

378 
˝u_gë_32k_tick
();

380 
˝u_£t_32k_tick
(
tick
);

	@platform/chip_8278/pwm.h

24 #i‚de‡
PWM_H_


25 
	#PWM_H_


	)

27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

29 
	~"timî.h
"

36 
	mPWM0_ID
 = 0,

37 
	mPWM1_ID
,

38 
	mPWM2_ID
,

39 
	mPWM3_ID
,

40 
	mPWM4_ID
,

41 
	mPWM5_ID
,

42 }
	tpwm_id
;

48 
	mPWM_NORMAL_MODE
 = 0x00,

49 
	mPWM_COUNT_MODE
 = 0x01,

50 
	mPWM_IR_MODE
 = 0x03,

51 
	mPWM_IR_FIFO_MODE
 = 0x07,

52 
	mPWM_IR_DMA_FIFO_MODE
 = 0x0F,

53 }
	tpwm_mode
;

59 
	mPWM_IRQ_PWM0_PNUM
 = 
BIT
(0),

60 
	mPWM_IRQ_PWM0_IR_DMA_FIFO_DONE
 = 
BIT
(1),

61 
	mPWM_IRQ_PWM0_FRAME
 = 
BIT
(2),

62 
	mPWM_IRQ_PWM1_FRAME
 = 
BIT
(3),

63 
	mPWM_IRQ_PWM2_FRAME
 = 
BIT
(4),

64 
	mPWM_IRQ_PWM3_FRAME
 = 
BIT
(5),

65 
	mPWM_IRQ_PWM4_FRAME
 = 
BIT
(6),

66 
	mPWM_IRQ_PWM5_FRAME
 = 
BIT
(7),

67 
	mPWM_IRQ_PWM0_IR_FIFO
 = 
BIT
(16)

68 }
	tPWM_IRQ
;

71 
	mPWM0_PULSE_NORMAL
 = 0,

72 
	mPWM0_PULSE_SHADOW
 = 
BIT
(14),

73 }
	tPwm0Pul£_Sñe˘Def
;

82 
ölöe
 
	$pwm_£t_mode
(
pwm_id
 
id
, 
pwm_mode
 
mode
){

83 if(
PWM0_ID
 =
id
){

84 
ªg_pwm0_mode
 = 
mode
;

86 
	}
}

95 
ölöe
 
	$pwm_£t_˛k
(
sy°em_˛ock_hz
, 
pwm_˛k
){

96 
ªg_pwm_˛k
 = ()
sy°em_˛ock_hz
 /
pwm_˛k
 - 1;

97 
	}
}

105 
ölöe
 
	$pwm_£t_cmp
(
pwm_id
 
id
, 
cmp_tick
)

107 
	`ªg_pwm_cmp
(
id
Ë
cmp_tick
;

108 
	}
}

116 
ölöe
 
	$pwm_£t_cy˛e
(
pwm_id
 
id
, 
cy˛e_tick
){

117 
	`ªg_pwm_max
(
id
Ë
cy˛e_tick
;

118 
	}
}

127 
ölöe
 
	$pwm_£t_cy˛e_™d_duty
(
pwm_id
 
id
, 
cy˛e_tick
, 
cmp_tick
){

128 
	`ªg_pwm_cy˛e
(
id
Ë
	`MASK_VAL
(
FLD_PWM_CMP
, 
cmp_tick
, 
FLD_PWM_MAX
, 
cy˛e_tick
);

129 
	}
}

137 
ölöe
 
	$pwm_£t_pwm0_shadow_cy˛e_™d_duty
(
cy˛e_tick
, 
cmp_tick
)

139 
ªg_pwm_tcmp0_shadow
 = 
cmp_tick
;

140 
ªg_pwm_tmax0_shadow
 = 
cy˛e_tick
;

141 
	}
}

149 
ölöe
 
	$pwm_£t_pha£
(
pwm_id
 
id
, 
pha£
){

151 
	}
}

159 
ölöe
 
	$pwm_£t_pul£_num
(
pwm_id
 
id
, 
pul£_num
){

160 if(
PWM0_ID
 =
id
){

161 
ªg_pwm0_pul£_num
 = 
pul£_num
;

163 
	}
}

170 
ölöe
 
	$pwm_°¨t
(
pwm_id
 
id
)

172 if(
PWM0_ID
 =
id
)

174 
	`BM_SET
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

177 
	`BM_SET
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

179 
	}
}

186 
ölöe
 
	$pwm_°›
(
pwm_id
 
id
)

188 if(
PWM0_ID
 =
id
)

190 
	`BM_CLR
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

193 
	`BM_CLR
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

195 
	}
}

202 
ölöe
 
	$pwm_ªvît
(
pwm_id
 
id
)

204 
ªg_pwm_övît
 |
	`BIT
(
id
);

205 
	}
}

212 
ölöe
 
	$pwm_n_ªvît
(
pwm_id
 
id
)

214 
ªg_pwm_n_övît
 |
	`BIT
(
id
);

215 
	}
}

223 
ölöe
 
	$pwm_pﬁo_íabÀ
(
pwm_id
 
id
, 
í
)

225 if(
í
){

226 
	`BM_SET
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

228 
	`BM_CLR
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

230 
	}
}

237 
ölöe
 
	$pwm_£t_öãºu±_íabÀ
(
PWM_IRQ
 
úq
){

238 if(
úq
 =
PWM_IRQ_PWM0_IR_FIFO
){

239 
	`BM_SET
(
ªg_pwm0_fifo_mode_úq_mask
,
	`BIT
(0));

241 
	`BM_SET
(
ªg_pwm_úq_mask
, 
úq
);

243 
	}
}

250 
ölöe
 
	$pwm_£t_öãºu±_dißbÀ
(
PWM_IRQ
 
úq
){

251 if(
úq
 =
PWM_IRQ_PWM0_IR_FIFO
){

252 
	`BM_CLR
(
ªg_pwm0_fifo_mode_úq_mask
,
	`BIT
(0));

254 
	`BM_CLR
(
ªg_pwm_úq_mask
, 
úq
);

256 
	}
}

263 
ölöe
 
	$pwm_˛ór_öãºu±_°©us
(
PWM_IRQ
 
°©us
)

265 if(
°©us
 =
PWM_IRQ_PWM0_IR_FIFO
){

266 
ªg_pwm0_fifo_mode_úq_°a
 = 
	`BIT
(0);

268 
ªg_pwm_úq_°a
 = 
°©us
;

270 
	}
}

277 
ölöe
 
	$pwm_ú_fifo_£t_úq_åig_Àvñ
(
åig_Àvñ
)

279 
ªg_pwm_ú_fifo_úq_åig_Àvñ
 = 
åig_Àvñ
;

280 
	}
}

288 
ölöe
 
	$pwm_ú_fifo_˛r_d©a
()

290 
ªg_pwm_ú_˛r_fifo_d©a
 |
FLD_PWM0_IR_FIFO_CLR_DATA
;

291 
	}
}

298 
ölöe
 
	$pwm_ú_fifo_gë_d©a_num
()

300  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_DATA_NUM
);

301 
	}
}

308 
ölöe
 
	$pwm_ú_fifo_is_em±y
()

310  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_EMPTY
);

311 
	}
}

318 
ölöe
 
	$pwm_ú_fifo_is_fuŒ
()

320  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_FULL
);

321 
	}
}

331 
ölöe
 
	$pwm_ú_fifo_£t_d©a_íåy
(
pul£_num
, 
u£_shadow
, 
ˇºõr_í
)

333 
ödex
=0;

334 
cfg_d©a
 = 
pul£_num
 + ((
u£_shadow
&
	`BIT
(0))<<14Ë+ ((
ˇºõr_í
&BIT(0))<<15);

335 
	`pwm_ú_fifo_is_fuŒ
());

336 
	`ªg_pwm_ú_fifo_d©
(
ödex
Ë
cfg_d©a
;

337 
ödex
++;

338 
ödex
&=0x01;

339 
	}
}

348 
ölöe
 
	$pwm_c⁄fig_dma_fifo_wavef‹m
(
ˇºõr_í
, 
Pwm0Pul£_Sñe˘Def
 
pul£_ty≥
, 
pul£_num
)

350  ( 
ˇºõr_í
<<15 | 
pul£_ty≥
 | (
pul£_num
 & 0x3fff) );

351 
	}
}

359 
ölöe
 
	$pwm_£t_dma_addªss
(* 
pd©
)

361 
ªg_dma_pwm_addr
 = ()(()
pd©
);

362 
ªg_dma7_addrHi
 = 0x04;

363 
ªg_dma_pwm_mode
 &~
FLD_DMA_WR_MEM
;

370 
ªg_dma7_size
 = 0xff;

371 
	}
}

378 
ölöe
 
	$pwm_°¨t_dma_ú_£ndög
()

380 
ªg_dma_chn_í
 |
FLD_DMA_CHN_PWM
;

381 
ªg_dma_tx_rdy0
 |
FLD_DMA_CHN_PWM
;

382 
	}
}

389 
ölöe
 
	$pwm_°›_dma_ú_£ndög
()

391 
ªg_r°0
 = 
FLD_RST0_PWM
;

392 
	`¶ìp_us
(20);

393 
ªg_r°0
 = 0;

394 
	}
}

401 
ölöe
 
	$pwm_gë_öãºu±_°©us
(
PWM_IRQ
 
°©us
){

403 if(
°©us
 =
PWM_IRQ_PWM0_IR_FIFO
){

404  (
ªg_pwm0_fifo_mode_úq_°a
 & 
	`BIT
(0));

406  (
ªg_pwm_úq_°a
 & 
°©us
);

409 
	}
}

	@platform/chip_8278/random.h

24 #¥agm®
⁄˚


34 
øndom_gíî©‹_öô
();

41 
ønd
();

	@platform/chip_8278/register.h

24 #¥agm®
⁄˚


26 
	~"bô.h
"

27 
	~"b•.h
"

36 
	#ªg_i2c_£t
 
	`REG_ADDR32
(0x00)

	)

37 
	#ªg_i2c_•ìd
 
	`REG_ADDR8
(0x00)

	)

38 
	#ªg_i2c_id
 
	`REG_ADDR8
(0x01)

	)

40 
	mFLD_I2C_WRITE_READ_BIT
 = 
BIT
(0),

41 
	mFLD_I2C_ID
 = 
BIT_RNG
(1,7),

44 
	#ªg_i2c_°©us
 
	`REG_ADDR8
(0x02)

	)

46 
	mFLD_I2C_CMD_BUSY
 = 
BIT
(0),

47 
	mFLD_I2C_BUS_BUSY
 = 
BIT
(1),

48 
	mFLD_I2C_NAK
 = 
BIT
(2),

51 
	#ªg_i2c_mode
 
	`REG_ADDR8
(0x03)

	)

53 
	mFLD_I2C_ADDR_AUTO_ADD
 = 
BIT
(0),

54 
	mFLD_I2C_MASTER_EN
 = 
BIT
(1),

55 
	mFLD_I2C_SLAVE_MAPPING
 = 
BIT
(2),

56 
	mFLD_I2C_HOLD_MASTER
 = 
BIT
(3),

59 
	#ªg_i2c_adr_d©
 
	`REG_ADDR16
(0x04)

	)

60 
	#ªg_i2c_d©_˘æ
 
	`REG_ADDR32
(0x04)

	)

61 
	#ªg_i2c_di_˘æ
 
	`REG_ADDR16
(0x06)

	)

62 
	#ªg_i2c_adr
 
	`REG_ADDR8
(0x04)

	)

63 
	#ªg_i2c_do
 
	`REG_ADDR8
(0x05)

	)

64 
	#ªg_i2c_di
 
	`REG_ADDR8
(0x06)

	)

65 
	#ªg_i2c_˘æ
 
	`REG_ADDR8
(0x07)

	)

67 
	mFLD_I2C_CMD_ID
 = 
BIT
(0),

68 
	mFLD_I2C_CMD_ADDR
 = 
BIT
(1),

69 
	mFLD_I2C_CMD_DO
 = 
BIT
(2),

70 
	mFLD_I2C_CMD_DI
 = 
BIT
(3),

71 
	mFLD_I2C_CMD_START
 = 
BIT
(4),

72 
	mFLD_I2C_CMD_STOP
 = 
BIT
(5),

73 
	mFLD_I2C_CMD_READ_ID
 = 
BIT
(6),

74 
	mFLD_I2C_CMD_ACK
 = 
BIT
(7),

77 
	#ªg_i2c_m≠_hadr
 
	`REG_ADDR8
(0xe0)

	)

79 
	#ªg_i2c_¶ave_m≠_addæ
 
	`REG_ADDR8
(0xe1)

	)

80 
	#ªg_i2c_¶ave_m≠_addrm
 
	`REG_ADDR8
(0xe2)

	)

81 
	#ªg_i2c_¶ave_m≠_addrh
 
	`REG_ADDR8
(0xe3)

	)

83 
	#ªg_i2c_¶ave_úq_°©us
 
	`REG_ADDR8
(0xe4)

	)

84 
	#ªg_•i_¶ave_úq_°©us
 
	`REG_ADDR8
(0xe4)

	)

85 
	#ªg_i2c_m≠_ho°_°©us
 
	`REG_ADDR8
(0xe4)

	)

87 
	mFLD_HOST_CMD_IRQ
 = 
BIT
(0), 
	mFLD_SLAVE_SPI_IRQ
 = 
FLD_HOST_CMD_IRQ
,

88 
	mFLD_HOST_READ_IRQ
 = 
BIT
(1),

91 
	#ªg_i2c_m≠_ªad0
 
	`REG_ADDR8
(0xe5)

	)

92 
	#ªg_i2c_m≠_ªad1
 
	`REG_ADDR8
(0xe6)

	)

93 
	#ªg_i2c_m≠_ªad2
 
	`REG_ADDR8
(0xe7)

	)

97 
	#ªg_•i_d©a
 
	`REG_ADDR8
(0x08)

	)

98 
	#ªg_•i_˘æ
 
	`REG_ADDR8
(0x09)

	)

100 
	mFLD_SPI_CS
 = 
BIT
(0),

101 
	mFLD_SPI_MASTER_MODE_EN
 = 
BIT
(1),

102 
	mFLD_SPI_DATA_OUT_DIS
 = 
BIT
(2),

103 
	mFLD_SPI_RD
 = 
BIT
(3),

104 
	mFLD_SPI_ADDR_AUTO_ADD
 = 
BIT
(4),

105 
	mFLD_SPI_SHARE_MODE
 = 
BIT
(5),

106 
	mFLD_SPI_BUSY
 = 
BIT
(6),

108 
	#ªg_•i_•
 
	`REG_ADDR8
(0x0a)

	)

110 
	mFLD_MSPI_CLK
 = 
BIT_RNG
(0,6),

111 
	mFLD_SPI_ENABLE
 = 
BIT
(7),

114 
	#ªg_•i_öv_˛k
 
	`REG_ADDR8
(0x0b)

115 íum {

	)

116 
	mFLD_SPI_MODE_WORK_MODE
 = 
BIT_RNG
(0,1),

121 
	#ªg_m•i_d©a
 
	`REG_ADDR8
(0x0c)

	)

122 
	#ªg_m•i_˘æ
 
	`REG_ADDR8
(0x0d)

	)

125 
	mFLD_MSPI_CS
 = 
BIT
(0),

126 
	mFLD_MSPI_SDO
 = 
BIT
(1),

127 
	mFLD_MSPI_CONT
 = 
BIT
(2),

128 
	mFLD_MSPI_RD
 = 
BIT
(3),

129 
	mFLD_MSPI_BUSY
 = 
BIT
(4),

132 
	#ªg_m•i_mode
 
	`REG_ADDR8
(0x0f)

	)

135 
	mFLD_MSPI_DUAL_DATA_MODE_EN
 = 
BIT
(0),

136 
	mFLD_MSPI_DUAL_ADDR_MODE_EN
 = 
BIT
(1),

137 
	mFLD_MSPI_CLK_DIV
 = 
BIT_RNG
(2,7),

142 
	#ªg_r°0
 
	`REG_ADDR8
(0x60)

	)

144 
	mFLD_RST0_SPI
 = 
BIT
(0),

145 
	mFLD_RST0_I2C
 = 
BIT
(1),

146 
	mFLD_RST0_UART
 = 
BIT
(2),

147 
	mFLD_RST0_USB
 = 
BIT
(3),

148 
	mFLD_RST0_PWM
 = 
BIT
(4),

149 
	mFLD_RST0_QDEC
 = 
BIT
(5),

150 
	mFLD_RST0_SWIRE
 = 
BIT
(7),

153 
	#ªg_r°1
 
	`REG_ADDR8
(0x61)

	)

155 
	mFLD_RST1_ZB
 = 
BIT
(0),

156 
	mFLD_RST1_SYS_TIMER
 = 
BIT
(1),

157 
	mFLD_RST1_DMA
 = 
BIT
(2),

158 
	mFLD_RST1_ALGM
 = 
BIT
(3),

159 
	mFLD_RST1_AES
 = 
BIT
(4),

160 
	mFLD_RST1_ADC
 = 
BIT
(5),

161 
	mFLD_RST1_ALG
 = 
BIT
(6),

164 
	#ªg_r°2
 
	`REG_ADDR8
(0x62)

	)

166 
	mFLD_RST2_AIF
 = 
BIT
(0),

167 
	mFLD_RST2_AUD
 = 
BIT
(1),

168 
	mFLD_RST2_DFIFO
 = 
BIT
(2),

169 
	mFLD_RST2_RISC
 = 
BIT
(4),

170 
	mFLD_RST2_MCIC
 = 
BIT
(5),

171 
	mFLD_RST2_RISC1
 = 
BIT
(6),

172 
	mFLD_RST2_MCIC1
 = 
BIT
(7),

176 
	#ªg_˛k_í0
 
	`REG_ADDR8
(0x63)

	)

178 
	mFLD_CLK0_SPI_EN
 = 
BIT
(0),

179 
	mFLD_CLK0_I2C_EN
 = 
BIT
(1),

180 
	mFLD_CLK0_UART_EN
 = 
BIT
(2),

181 
	mFLD_CLK0_USB_EN
 = 
BIT
(3),

182 
	mFLD_CLK0_PWM_EN
 = 
BIT
(4),

183 
	mFLD_CLK0_QDEC_EN
 = 
BIT
(5),

184 
	mFLD_CLK0_SWIRE_EN
 = 
BIT
(7),

187 
	#ªg_˛k_í1
 
	`REG_ADDR8
(0x64)

	)

189 
	mFLD_CLK1_ZB_EN
 = 
BIT
(0),

190 
	mFLD_CLK1_SYS_TIMER_EN
 = 
BIT
(1),

191 
	mFLD_CLK1_DMA_EN
 = 
BIT
(2),

192 
	mFLD_CLK1_ALGM_EN
 = 
BIT
(3),

193 
	mFLD_CLK1_AES_EN
 = 
BIT
(4),

198 
	#ªg_˛k_í2
 
	`REG_ADDR8
(0x65)

	)

200 
	mFLD_CLK2_AIF_EN
 = 
BIT
(0),

201 
	mFLD_CLK2_AUD_EN
 = 
BIT
(1),

202 
	mFLD_CLK2_DFIFO_EN
 = 
BIT
(2),

203 
	mFLD_CLK2_MC_EN
 = 
BIT
(4),

204 
	mFLD_CLK2_MCIC_EN
 = 
BIT
(5),

208 
	#ªg_˛k_£l
 
	`REG_ADDR8
(0x66)

	)

210 
	mFLD_SCLK_DIV
 = 
BIT_RNG
(0,4),

211 
	mFLD_SCLK_SEL
 = 
BIT_RNG
(5,6),

212 
	mFLD_SCLK_HS_SEL
 = 
BIT
(7),

215 
	#ªg_i2s_°ï
 
	`REG_ADDR8
(0x67)

	)

217 
	mFLD_I2S_STEP
 = 
BIT_RNG
(0,6),

218 
	mFLD_I2S_CLK_EN
 = 
BIT
(7),

221 
	#ªg_i2s_mod
 
	`REG_ADDR8
(0x68)

	)

223 
	#ªg_codec_˛k_°ï
 
	`REG_ADDR8
(0x6c)

	)

225 
	#ªg_codec_˛k_mod
 
	`REG_ADDR8
(0x6d)

	)

227 
	#ªg_wakeup_í
 
	`REG_ADDR8
(0x6e)

	)

229 
	mFLD_WAKEUP_SRC_I2C
 = 
BIT
(0),

230 
	mFLD_WAKEUP_SRC_SPI
 = 
BIT
(1),

231 
	mFLD_WAKEUP_SRC_USB
 = 
BIT
(2),

232 
	mFLD_WAKEUP_SRC_GPIO
 = 
BIT
(3),

233 
	mFLD_WAKEUP_SRC_I2C_SYN
 = 
BIT
(4),

234 
	mFLD_WAKEUP_SRC_GPIO_RM
 = 
BIT
(5),

235 
	mFLD_WAKEUP_SRC_USB_RESM
 = 
BIT
(6),

236 
	mFLD_WAKEUP_SRC_RST_SYS
 = 
BIT
(7),

239 
	#ªg_pwdn_˘æ
 
	`REG_ADDR8
(0x6f)

	)

242 
	mFLD_PWDN_CTRL_REBOOT
 = 
BIT
(5),

243 
	mFLD_PWDN_CTRL_SLEEP
 = 
BIT
(7),

247 
	#ªg_mcu_wakeup_mask
 
	`REG_ADDR32
(0x78)

	)

251 
	#ªg_7816_˛k_div
 
	`REG_ADDR8
(0x7b)

	)

255 
	#ªg_u¨t_d©a_buf0
 
	`REG_ADDR8
(0x90)

	)

256 
	#ªg_u¨t_d©a_buf1
 
	`REG_ADDR8
(0x91)

	)

257 
	#ªg_u¨t_d©a_buf2
 
	`REG_ADDR8
(0x92)

	)

258 
	#ªg_u¨t_d©a_buf3
 
	`REG_ADDR8
(0x93)

	)

260 
	#ªg_u¨t_d©a_buf
(
i
Ë
	`REG_ADDR8
(0x90 + (i))

261 
	#ªg_u¨t_˛k_div
 
	`REG_ADDR16
(0x94)

	)

263 
	mFLD_UART_CLK_DIV
 = 
BIT_RNG
(0,14),

264 
	mFLD_UART_CLK_DIV_EN
 = 
BIT
(15)

267 
	#ªg_u¨t_˘æ0
 
	`REG_ADDR8
(0x96)

	)

269 
	mFLD_UART_BPWC
 = 
BIT_RNG
(0,3),

270 
	mFLD_UART_RX_DMA_EN
 = 
BIT
(4),

271 
	mFLD_UART_TX_DMA_EN
 = 
BIT
(5),

272 
	mFLD_UART_RX_IRQ_EN
 = 
BIT
(6),

273 
	mFLD_UART_TX_IRQ_EN
 = 
BIT
(7),

276 
	#ªg_u¨t_˘æ1
 
	`REG_ADDR8
(0x97)

	)

278 
	mFLD_UART_CTRL1_CTS_SELECT
 = 
BIT
(0),

279 
	mFLD_UART_CTRL1_CTS_EN
 = 
BIT
(1),

280 
	mFLD_UART_CTRL1_PARITY_EN
 = 
BIT
(2),

281 
	mFLD_UART_CTRL1_PARITY_POLARITY
 = 
BIT
(3),

282 
	mFLD_UART_CTRL1_STOP_BIT
 = 
BIT_RNG
(4,5),

283 
	mFLD_UART_CTRL1_TTL
 = 
BIT
(6),

284 
	mFLD_UART_CTRL1_LOOPBACK
 = 
BIT
(7),

287 
	#ªg_u¨t_˘æ2
 
	`REG_ADDR16
(0x98)

	)

289 
	mFLD_UART_CTRL2_RTS_TRIG_LVL
 = 
BIT_RNG
(0,3),

290 
	mFLD_UART_CTRL2_RTS_PARITY
 = 
BIT
(4),

291 
	mFLD_UART_CTRL2_RTS_MANUAL_VAL
 = 
BIT
(5),

292 
	mFLD_UART_CTRL2_RTS_MANUAL_EN
 = 
BIT
(6),

293 
	mFLD_UART_CTRL2_RTS_EN
 = 
BIT
(7),

294 
	mFLD_UART_CTRL3_RX_IRQ_TRIG_LEVEL
 = 
BIT_RNG
(8,11),

295 
	mFLD_UART_CTRL3_TX_IRQ_TRIG_LEVEL
 = 
BIT_RNG
(12,15),

299 
	#ªg_u¨t_˘æ3
 
	`REG_ADDR8
(0x99)

	)

301 
	mFLD_UART_RX_IRQ_TRIG_LEV
 = 
BIT_RNG
(0,3),

302 
	mFLD_UART_TX_IRQ_TRIG_LEV
 = 
BIT_RNG
(4,7),

305 
	#ªg_u¨t_rx_timeout0
 
	`REG_ADDR8
(0x9a)

	)

307 
	mFLD_UART_TIMEOUT_BW
 = 
BIT_RNG
(0,7),

310 
	#ªg_u¨t_rx_timeout1
 
	`REG_ADDR8
(0x9b)

	)

312 
	mFLD_UART_TIMEOUT_MUL
 = 
BIT_RNG
(0,1),

313 
	mFLD_UART_P7816_EN
 = 
BIT
(5),

314 
	mFLD_UART_MASK_TXDONE_IRQ
 = 
BIT
(6),

315 
	mFLD_UART_MASK_ERR_IRQ
 = 
BIT
(7),

319 
	#ªg_u¨t_buf_˙t
 
	`REG_ADDR8
(0x9c)

	)

322 
	mFLD_UART_RX_BUF_CNT
 = 
BIT_RNG
(0,3),

323 
	mFLD_UART_TX_BUF_CNT
 = 
BIT_RNG
(4,7),

326 
	#ªg_u¨t_°©us0
 
	`REG_ADDR8
(0x9d)

	)

328 
	mFLD_UART_RBCNT
 = 
BIT_RNG
(0,2),

329 
	mFLD_UART_IRQ_FLAG
 = 
BIT
(3),

330 
	mFLD_UART_WBCNT
 = 
BIT_RNG
(4,6),

331 
	mFLD_UART_CLEAR_RX_FLAG
 = 
BIT
(6),

332 
	mFLD_UART_RX_ERR_FLAG
 = 
BIT
(7),

335 
	#ªg_u¨t_°©us1
 
	`REG_ADDR8
(0x9e)

	)

337 
	mFLD_UART_TX_DONE
 = 
BIT
(0),

338 
	mFLD_UART_TX_BUF_IRQ
 = 
BIT
(1),

339 
	mFLD_UART_RX_DONE
 = 
BIT
(2),

340 
	mFLD_UART_RX_BUF_IRQ
 = 
BIT
(3),

344 
	#ªg_u¨t_°©e
 
	`REG_ADDR8
(0x9f)

	)

346 
	mFLD_UART_TSTATE_I
 = 
BIT_RNG
(0,2),

347 
	mFLD_UART_RSTATE_I
 = 
BIT_RNG
(4,7),

353 
	#ªg_swúe_d©a
 
	`REG_ADDR8
(0xb0)

	)

354 
	#ªg_swúe_˘æ1
 
	`REG_ADDR8
(0xb1)

	)

356 
	mFLD_SWIRE_WR
 = 
BIT
(0),

357 
	mFLD_SWIRE_RD
 = 
BIT
(1),

358 
	mFLD_SWIRE_CMD
 = 
BIT
(2),

359 
	mFLD_SWIRE_USB_DET
 = 
BIT
(6),

360 
	mFLD_SWIRE_USB_EN
 = 
BIT
(7),

363 
	#ªg_swúe_˛k_div
 
	`REG_ADDR8
(0xb2)

	)

367 
	mFLD_SWIRE_CLK_DIV
 = 
BIT_RNG
(0,6),

370 
	#ªg_swúe_id
 
	`REG_ADDR8
(0xb3)

	)

374 
	mFLD_SWIRE_ID_SLAVE_ID
 = 
BIT_RNG
(0,6),

375 
	mFLD_SWIRE_ID_SLAVE_FIFO_EN
 = 
BIT
(7),

380 
	#ªg_™a_˘æ32
 
	`REG_ADDR32
(0xb8)

	)

381 
	#ªg_™a_addr_d©a
 
	`REG_ADDR16
(0xb8)

	)

382 
	#ªg_™a_addr
 
	`REG_ADDR8
(0xb8)

	)

383 
	#ªg_™a_d©a
 
	`REG_ADDR8
(0xb9)

	)

384 
	#ªg_™a_˘æ
 
	`REG_ADDR8
(0xba)

	)

387 
	mFLD_ANA_BUSY
 = 
BIT
(0),

388 
	mFLD_ANA_RSV
 = 
BIT
(4),

389 
	mFLD_ANA_RW
 = 
BIT
(5),

390 
	mFLD_ANA_START
 = 
BIT
(6),

391 
	mFLD_ANA_CYC
 = 
BIT
(7),

397 
	#ªg_˘æ_ï_±r
 
	`REG_ADDR8
(0x100)

	)

398 
	#ªg_˘æ_ï_d©
 
	`REG_ADDR8
(0x101)

	)

399 
	#ªg_˘æ_ï_˘æ
 
	`REG_ADDR8
(0x102)

	)

402 
	mFLD_EP_DAT_ACK
 = 
BIT
(0),

403 
	mFLD_EP_DAT_STALL
 = 
BIT
(1),

404 
	mFLD_EP_STA_ACK
 = 
BIT
(2),

405 
	mFLD_EP_STA_STALL
 = 
BIT
(3),

408 
	#ªg_˘æ_ï_úq_°a
 
	`REG_ADDR8
(0x103)

	)

410 
	mFLD_CTRL_EP_IRQ_TRANS
 = 
BIT_RNG
(0,3),

411 
	mFLD_CTRL_EP_IRQ_SETUP
 = 
BIT
(4),

412 
	mFLD_CTRL_EP_IRQ_DATA
 = 
BIT
(5),

413 
	mFLD_CTRL_EP_IRQ_STA
 = 
BIT
(6),

414 
	mFLD_CTRL_EP_IRQ_INTF
 = 
BIT
(7),

417 
	#ªg_˘æ_ï_úq_mode
 
	`REG_ADDR8
(0x104)

	)

419 
	mFLD_CTRL_EP_AUTO_ADDR
 = 
BIT
(0),

420 
	mFLD_CTRL_EP_AUTO_CFG
 = 
BIT
(1),

421 
	mFLD_CTRL_EP_AUTO_INTF
 = 
BIT
(2),

422 
	mFLD_CTRL_EP_AUTO_STA
 = 
BIT
(3),

423 
	mFLD_CTRL_EP_AUTO_SYN
 = 
BIT
(4),

424 
	mFLD_CTRL_EP_AUTO_DESC
 = 
BIT
(5),

425 
	mFLD_CTRL_EP_AUTO_FEAT
 = 
BIT
(6),

426 
	mFLD_CTRL_EP_AUTO_STD
 = 
BIT
(7),

429 
	#ªg_usb_˘æ
 
	`REG_ADDR8
(0x105)

	)

431 
	mFLD_USB_CTRL_AUTO_CLK
 = 
BIT
(0),

432 
	mFLD_USB_CTRL_LOW_SPD
 = 
BIT
(1),

433 
	mFLD_USB_CTRL_LOW_JITT
 = 
BIT
(2),

434 
	mFLD_USB_CTRL_TST_MODE
 = 
BIT
(3),

437 
	#ªg_usb_cyc_ˇli
 
	`REG_ADDR16
(0x106)

	)

438 
	#ªg_usb_mdev
 
	`REG_ADDR8
(0x10a)

	)

439 
	#ªg_usb_ho°_c⁄n
 
	`REG_ADDR8
(0x10b)

	)

441 
	mFLD_USB_MDEV_SELF_PWR
 = 
BIT
(0),

442 
	mFLD_USB_MDEV_SUSP_STA
 = 
BIT
(1),

445 
	#ªg_usb_sups_cyc_ˇli
 
	`REG_ADDR8
(0x10c)

	)

446 
	#ªg_usb_ötf_Æt
 
	`REG_ADDR8
(0x10d)

	)

447 
	#ªg_usb_ï_í
 
	`REG_ADDR8
(0x10e)

	)

449 
	mFLD_USB_EDP8_EN
 = 
BIT
(0),

450 
	mFLD_USB_EDP1_EN
 = 
BIT
(1),

451 
	mFLD_USB_EDP2_EN
 = 
BIT
(2),

452 
	mFLD_USB_EDP3_EN
 = 
BIT
(3),

453 
	mFLD_USB_EDP4_EN
 = 
BIT
(4),

454 
	mFLD_USB_EDP5_EN
 = 
BIT
(5),

455 
	mFLD_USB_EDP6_EN
 = 
BIT
(6),

456 
	mFLD_USB_EDP7_EN
 = 
BIT
(7),

457 }
	tusb_ï_í_e
;

458 
	#ªg_usb_ï8123_±r
 
	`REG_ADDR32
(0x110)

	)

459 
	#ªg_usb_ï8_±r
 
	`REG_ADDR8
(0x110)

	)

460 
	#ªg_usb_ï1_±r
 
	`REG_ADDR8
(0x111)

	)

461 
	#ªg_usb_ï2_±r
 
	`REG_ADDR8
(0x112)

	)

462 
	#ªg_usb_ï3_±r
 
	`REG_ADDR8
(0x113)

	)

463 
	#ªg_usb_ï4567_±r
 
	`REG_ADDR32
(0x114)

	)

464 
	#ªg_usb_ï4_±r
 
	`REG_ADDR8
(0x114)

	)

465 
	#ªg_usb_ï5_±r
 
	`REG_ADDR8
(0x115)

	)

466 
	#ªg_usb_ï6_±r
 
	`REG_ADDR8
(0x116)

	)

467 
	#ªg_usb_ï7_±r
 
	`REG_ADDR8
(0x117)

	)

468 
	#ªg_usb_ï_±r
(
i
Ë
	`REG_ADDR8
(0x110+((iË& 0x07))

	)

470 
	#ªg_usb_ï8123_d©
 
	`REG_ADDR32
(0x118)

	)

471 
	#ªg_usb_ï8_d©
 
	`REG_ADDR8
(0x118)

	)

472 
	#ªg_usb_ï1_d©
 
	`REG_ADDR8
(0x119)

	)

473 
	#ªg_usb_ï2_d©
 
	`REG_ADDR8
(0x11a)

	)

474 
	#ªg_usb_ï3_d©
 
	`REG_ADDR8
(0x11b)

	)

475 
	#ªg_usb_ï4567_d©
 
	`REG_ADDR32
(0x11c)

	)

476 
	#ªg_usb_ï4_d©
 
	`REG_ADDR8
(0x11c)

	)

477 
	#ªg_usb_ï5_d©
 
	`REG_ADDR8
(0x11d)

	)

478 
	#ªg_usb_ï6_d©
 
	`REG_ADDR8
(0x11e)

	)

479 
	#ªg_usb_ï7_d©
 
	`REG_ADDR8
(0x11f)

	)

480 
	#ªg_usb_ï_d©
(
i
Ë
	`REG_ADDR8
(0x118+((iË& 0x07))

	)

481 
	#ªg_usb_mic_d©0
 
	`REG_ADDR16
(0x1800)

	)

482 
	#ªg_usb_mic_d©1
 
	`REG_ADDR16
(0x1802)

	)

484 
	#ªg_usb_ï8_˘æ
 
	`REG_ADDR8
(0x120)

	)

485 
	#ªg_usb_ï1_˘æ
 
	`REG_ADDR8
(0x121)

	)

486 
	#ªg_usb_ï2_˘æ
 
	`REG_ADDR8
(0x122)

	)

487 
	#ªg_usb_ï3_˘æ
 
	`REG_ADDR8
(0x123)

	)

488 
	#ªg_usb_ï4_˘æ
 
	`REG_ADDR8
(0x124)

	)

489 
	#ªg_usb_ï5_˘æ
 
	`REG_ADDR8
(0x125)

	)

490 
	#ªg_usb_ï6_˘æ
 
	`REG_ADDR8
(0x126)

	)

491 
	#ªg_usb_ï7_˘æ
 
	`REG_ADDR8
(0x127)

	)

492 
	#ªg_usb_ï_˘æ
(
i
Ë
	`REG_ADDR8
(0x120+((iË& 0x07))

	)

495 
	mFLD_USB_EP_BUSY
 = 
BIT
(0),

496 
	mFLD_USB_EP_STALL
 = 
BIT
(1),

497 
	mFLD_USB_EP_DAT0
 = 
BIT
(2),

498 
	mFLD_USB_EP_DAT1
 = 
BIT
(3),

499 
	mFLD_USB_EP_MONO
 = 
BIT
(6),

500 
	mFLD_USB_EP_EOF_ISO
 = 
BIT
(7),

503 
	#ªg_usb_ï8123_buf_addr
 
	`REG_ADDR32
(0x128)

	)

504 
	#ªg_usb_ï8_buf_addr
 
	`REG_ADDR8
(0x128)

	)

505 
	#ªg_usb_ï1_buf_addr
 
	`REG_ADDR8
(0x129)

	)

506 
	#ªg_usb_ï2_buf_addr
 
	`REG_ADDR8
(0x12a)

	)

507 
	#ªg_usb_ï3_buf_addr
 
	`REG_ADDR8
(0x12b)

	)

508 
	#ªg_usb_ï4567_buf_addr
 
	`REG_ADDR32
(0x12c)

	)

509 
	#ªg_usb_ï4_buf_addr
 
	`REG_ADDR8
(0x12c)

	)

510 
	#ªg_usb_ï5_buf_addr
 
	`REG_ADDR8
(0x12d)

	)

511 
	#ªg_usb_ï6_buf_addr
 
	`REG_ADDR8
(0x12e)

	)

512 
	#ªg_usb_ï7_buf_addr
 
	`REG_ADDR8
(0x12f)

	)

513 
	#ªg_usb_ï_buf_addr
(
i
Ë
	`REG_ADDR8
(0x128+((iË& 0x07))

	)

515 
	#ªg_usb_øm_˘æ
 
	`REG_ADDR8
(0x130)

	)

517 
	mFLD_USB_CEN_PWR_DN
 = 
BIT
(0),

518 
	mFLD_USB_CLK_PWR_DN
 = 
BIT
(1),

519 
	mFLD_USB_WEN_PWR_DN
 = 
BIT
(3),

520 
	mFLD_USB_CEN_FUNC
 = 
BIT
(4),

523 
	#ªg_usb_iso_mode
 
	`REG_ADDR8
(0x138)

	)

524 
	#ªg_usb_úq
 
	`REG_ADDR8
(0x139)

	)

525 
	#ªg_usb_mask
 
	`REG_ADDR8
(0x13a)

	)

527 
	mFLD_USB_EDP8_IRQ
 = 
BIT
(0),

528 
	mFLD_USB_EDP1_IRQ
 = 
BIT
(1),

529 
	mFLD_USB_EDP2_IRQ
 = 
BIT
(2),

530 
	mFLD_USB_EDP3_IRQ
 = 
BIT
(3),

531 
	mFLD_USB_EDP4_IRQ
 = 
BIT
(4),

532 
	mFLD_USB_EDP5_IRQ
 = 
BIT
(5),

533 
	mFLD_USB_EDP6_IRQ
 = 
BIT
(6),

534 
	mFLD_USB_EDP7_IRQ
 = 
BIT
(7),

536 
	#ªg_usb_ï8_£nd_max
 
	`REG_ADDR8
(0x13b)

	)

537 
	#ªg_usb_ï8_£nd_thª
 
	`REG_ADDR8
(0x13c)

	)

538 
	#ªg_usb_ï8_fifo_mode
 
	`REG_ADDR8
(0x13d)

	)

539 
	#ªg_usb_ï_max_size
 
	`REG_ADDR8
(0x13e)

	)

542 
	mFLD_USB_ENP8_FIFO_MODE
 = 
BIT
(0),

543 
	mFLD_USB_ENP8_FULL_FLAG
 = 
BIT
(1),

546 
	#ªg_rf_acc_Àn
 
	`REG_ADDR8
(0x405)

	)

548 
	mFLD_RF_ACC_LEN
 = 
BIT_RNG
(0,2),

549 
	mFLD_RF_LR_MAN_EN
 = 
BIT
(3),

550 
	mFLD_RF_LR_TX_SEL
 = 
BIT
(4),

551 
	mFLD_RF_BLE_LR
 = 
BIT
(5),

552 
	mFLD_RF_LR_ACC_TRIG
 = 
BIT
(7),

556 
	#ªg_rf_time°amp
 
	`REG_ADDR32
(0x450)

	)

561 
	#ªg_´s_˘æ
 
	`REG_ADDR8
(0x540)

	)

564 
	mFLD_AES_CTRL_CODEC_TRIG
 = 
BIT
(0),

565 
	mFLD_AES_CTRL_DATA_FEED
 = 
BIT
(1),

566 
	mFLD_AES_CTRL_CODEC_FINISHED
 = 
BIT
(2),

569 
	#ªg_´s_d©a
 
	`REG_ADDR32
(0x548)

	)

570 
	#ªg_´s_key
(
v
Ë
	`REG_ADDR8
(0x550+v)

	)

575 
	#ªg_audio_˘æ
 
	`REG_ADDR8
(0x560)

	)

577 
	mAUDIO_OUTPUT_OFF
 = 0,

578 
	mFLD_AUDIO_MONO_MODE
 = 
BIT
(0),

579 
	mFLD_AUDIO_I2S_PLAYER_EN
 = 
BIT
(1),

580 
	mFLD_AUDIO_SDM_PLAYER_EN
 = 
BIT
(2),

581 
	mFLD_AUDIO_ISO_PLAYER_EN
 = 
BIT
(3),

582 
	mFLD_AUDIO_I2S_RECORDER_EN
 = 
BIT
(4),

583 
	mFLD_AUDIO_I2S_INTERFACE_EN
 = 
BIT
(5),

584 
	mFLD_AUDIO_GRP_EN
 = 
BIT
(6),

585 
	mFLD_AUDIO_HPF_EN
 = 
BIT
(7),

588 
	#ªg_pwm_˘æ
 
	`REG_ADDR8
(0x563)

	)

590 
	mFLD_PWM_MULTIPLY2
 = 
BIT
(0),

591 
	mFLD_PWM_ENABLE
 = 
BIT
(1),

592 
	mFLD_LINER_INTERPOLATE_EN
 = 
BIT
(2),

593 
	mFLD_LEFT_SHAPING_EN
 = 
BIT
(5),

594 
	mFLD_RIGTH_SHAPING_EN
 = 
BIT
(6)

597 
	#ªg_as˛_tu√
 
	`REG_ADDR32
(0x564)

	)

599 
	#ªg_≤1_À·
 
	`REG_ADDR8
(0x568)

	)

601 
	mPN1_LEFT_CHN_BITS
 = 
BIT_RNG
(0,4),

602 
	mPN2_LEFT_CHN_EN
 = 
BIT
(5),

603 
	mPN1_LEFT_CHN_EN
 = 
BIT
(6),

606 
	#ªg_≤2_À·
 
	`REG_ADDR8
(0x569)

	)

608 
	mPN2_LEFT_CHN_BITS
 = 
BIT_RNG
(0,4),

609 
	mPN2_RIGHT_CHN_EN
 = 
BIT
(5),

610 
	mPN1_RIGHT_CHN_EN
 = 
BIT
(6),

613 
	#ªg_≤1_right
 
	`REG_ADDR8
(0x56a)

	)

615 
	mPN1_RIGHT_CHN_BITS
 = 
BIT_RNG
(0,4),

616 
	mCLK2A_AUDIO_CLK_EN
 = 
BIT
(5),

617 
	mEXCHANGE_SDM_DATA_EN

BIT
(6),

620 
	#ªg_≤2_right
 
	`REG_ADDR8
(0x56b)

	)

622 
	mPN2_RIGHT_CHN_BITS
 = 
BIT_RNG
(0,4),

623 
	mSDM_LEFT_CHN_CONST_EN
 = 
BIT
(5),

624 
	mSDM_RIGHT_CHN_CONST_EN
 = 
BIT
(6),

629 
	#ªg_gpio_∑_ö
 
	`REG_ADDR8
(0x580)

	)

630 
	#ªg_gpio_∑_õ
 
	`REG_ADDR8
(0x581)

	)

631 
	#ªg_gpio_∑_€n
 
	`REG_ADDR8
(0x582)

	)

632 
	#ªg_gpio_∑_out
 
	`REG_ADDR8
(0x583)

	)

633 
	#ªg_gpio_∑_pﬁ
 
	`REG_ADDR8
(0x584)

	)

634 
	#ªg_gpio_∑_ds
 
	`REG_ADDR8
(0x585)

	)

635 
	#ªg_gpio_∑_gpio
 
	`REG_ADDR8
(0x586)

	)

636 
	#ªg_gpio_∑_úq_í
 
	`REG_ADDR8
(0x587)

	)

638 
	#ªg_gpio_pb_ö
 
	`REG_ADDR8
(0x588)

	)

639 
	#ªg_gpio_pb_õ
 
	`REG_ADDR8
(0x589)

	)

640 
	#ªg_gpio_pb_€n
 
	`REG_ADDR8
(0x58a)

	)

641 
	#ªg_gpio_pb_out
 
	`REG_ADDR8
(0x58b)

	)

642 
	#ªg_gpio_pb_pﬁ
 
	`REG_ADDR8
(0x58c)

	)

643 
	#ªg_gpio_pb_ds
 
	`REG_ADDR8
(0x58d)

	)

644 
	#ªg_gpio_pb_gpio
 
	`REG_ADDR8
(0x58e)

	)

645 
	#ªg_gpio_pb_úq_í
 
	`REG_ADDR8
(0x58f)

	)

647 
	#ªg_gpio_pc_ö
 
	`REG_ADDR8
(0x590)

	)

648 
	#¨eg_gpio_pc_õ
 0xc0

	)

649 
	#ªg_gpio_pc_€n
 
	`REG_ADDR8
(0x592)

	)

650 
	#ªg_gpio_pc_out
 
	`REG_ADDR8
(0x593)

	)

651 
	#ªg_gpio_pc_pﬁ
 
	`REG_ADDR8
(0x594)

	)

652 
	#¨eg_gpio_pc_ds
 0xc2

	)

653 
	#ªg_gpio_pc_gpio
 
	`REG_ADDR8
(0x596)

	)

654 
	#ªg_gpio_pc_úq_í
 
	`REG_ADDR8
(0x597)

	)

656 
	#ªg_gpio_pd_ö
 
	`REG_ADDR8
(0x598)

	)

657 
	#ªg_gpio_pd_õ
 
	`REG_ADDR8
(0x599)

	)

658 
	#ªg_gpio_pd_€n
 
	`REG_ADDR8
(0x59a)

	)

659 
	#ªg_gpio_pd_out
 
	`REG_ADDR8
(0x59b)

	)

660 
	#ªg_gpio_pd_pﬁ
 
	`REG_ADDR8
(0x59c)

	)

661 
	#ªg_gpio_pd_ds
 
	`REG_ADDR8
(0x59d)

	)

662 
	#ªg_gpio_pd_gpio
 
	`REG_ADDR8
(0x59e)

	)

663 
	#ªg_gpio_pd_úq_í
 
	`REG_ADDR8
(0x59f)

	)

665 
	#ªg_gpio_≥_ö
 
	`REG_ADDR8
(0x5a0)

	)

666 
	#ªg_gpio_≥_õ
 
	`REG_ADDR8
(0x5a1)

	)

667 
	#ªg_gpio_≥_€n
 
	`REG_ADDR8
(0x5a2)

	)

668 
	#ªg_gpio_≥_out
 
	`REG_ADDR8
(0x5a3)

	)

669 
	#ªg_gpio_≥_pﬁ
 
	`REG_ADDR8
(0x5a4)

	)

670 
	#ªg_gpio_≥_ds
 
	`REG_ADDR8
(0x5a5)

	)

671 
	#ªg_gpio_≥_gpio
 
	`REG_ADDR8
(0x5a6)

	)

672 
	#ªg_gpio_≥_úq_í
 
	`REG_ADDR8
(0x5a7)

	)

674 
	#ªg_gpio_∑_£âög1
 
	`REG_ADDR32
(0x580)

	)

675 
	#ªg_gpio_∑_£âög2
 
	`REG_ADDR32
(0x584)

	)

676 
	#ªg_gpio_pb_£âög1
 
	`REG_ADDR32
(0x588)

	)

677 
	#ªg_gpio_pb_£âög2
 
	`REG_ADDR32
(0x58c)

	)

678 
	#ªg_gpio_pd_£âög1
 
	`REG_ADDR32
(0x598)

	)

679 
	#ªg_gpio_pd_£âög2
 
	`REG_ADDR32
(0x59c)

	)

681 
	#ªg_gpio_ö
(
i
Ë
	`REG_ADDR8
(0x580+((i>>8)<<3))

	)

682 
	#ªg_gpio_õ
(
i
Ë
	`REG_ADDR8
(0x581+((i>>8)<<3))

	)

683 
	#ªg_gpio_€n
(
i
Ë
	`REG_ADDR8
(0x582+((i>>8)<<3))

	)

684 
	#ªg_gpio_out
(
i
Ë
	`REG_ADDR8
(0x583+((i>>8)<<3))

	)

685 
	#ªg_gpio_pﬁ
(
i
Ë
	`REG_ADDR8
(0x584+((i>>8)<<3))

	)

686 
	#ªg_gpio_ds
(
i
Ë
	`REG_ADDR8
(0x585+((i>>8)<<3))

	)

689 
	#ªg_gpio_func
(
i
Ë
	`REG_ADDR8
(0x586+((i>>8)<<3))

	)

691 
	#ªg_gpio_úq_wakeup_í
(
i
Ë
	`REG_ADDR8
(0x587+((i>>8)<<3))

692 

	)

693 
	#ªg_gpio_úq_risc0_í
(
i
Ë
	`REG_ADDR8
(0x5b8 + (i >> 8))

694 
	#ªg_gpio_úq_risc1_í
(
i
Ë
	`REG_ADDR8
(0x5c0 + (i >> 8))

695 
	#ªg_gpio_úq_risc2_í
(
i
Ë
	`REG_ADDR8
(0x5c8 + (ò>> 8))

	)

697 
	#ªg_mux_func_a1
 
	`REG_ADDR8
(0x5a8)

	)

698 
	#ªg_mux_func_a2
 
	`REG_ADDR8
(0x5a9)

	)

699 
	#ªg_mux_func_b1
 
	`REG_ADDR8
(0x5Ø)

	)

700 
	#ªg_mux_func_b2
 
	`REG_ADDR8
(0x5ab)

	)

701 
	#ªg_mux_func_c1
 
	`REG_ADDR8
(0x5ac)

	)

702 
	#ªg_mux_func_c2
 
	`REG_ADDR8
(0x5ad)

	)

703 
	#ªg_mux_func_d1
 
	`REG_ADDR8
(0x5´)

	)

704 
	#ªg_mux_func_d2
 
	`REG_ADDR8
(0x5af)

	)

706 
	#ªg_gpio_wakeup_úq
 
	`REG_ADDR8
(0x5b5)

	)

708 
	mFLD_GPIO_CORE_WAKEUP_EN
 = 
BIT
(2),

709 
	mFLD_GPIO_CORE_INTERRUPT_EN
 = 
BIT
(3),

712 
	#ªg_pö_i2c_•i_out_í
 
	`REG_ADDR8
(0x5b6)

	)

714 
	mFLD_PIN_PAGROUP_SPI_EN
 = 
BIT_RNG
(4,5),

715 
	mFLD_PIN_PBGROUP_SPI_EN
 = 
BIT
(6),

716 
	mFLD_PIN_PDGROUP_SPI_EN
 = 
BIT
(7),

720 
	#ªg_pö_i2c_•i_í
 
	`REG_ADDR8
(0x5b7)

721 íum{

	)

722 
	mFLD_PIN_PA3_SPI_EN
 = 
BIT
(0),

723 
	mFLD_PIN_PA4_SPI_EN
 = 
BIT
(1),

724 
	mFLD_PIN_PB6_SPI_EN
 = 
BIT
(2),

725 
	mFLD_PIN_PD7_SPI_EN
 = 
BIT
(3),

726 
	mFLD_PIN_PA3_I2C_EN
 = 
BIT
(4),

727 
	mFLD_PIN_PA4_I2C_EN
 = 
BIT
(5),

728 
	mFLD_PIN_PB6_I2C_EN
 = 
BIT
(6),

729 
	mFLD_PIN_PD7_I2C_EN
 = 
BIT
(7),

735 
	#ªg_tmr_˘æ
 
	`REG_ADDR32
(0x620)

	)

736 
	#ªg_tmr_˘æ16
 
	`REG_ADDR16
(0x620)

	)

737 
	#ªg_tmr_˘æ8
 
	`REG_ADDR8
(0x620)

	)

739 
	mFLD_TMR0_EN
 = 
BIT
(0),

740 
	mFLD_TMR0_MODE
 = 
BIT_RNG
(1,2),

741 
	mFLD_TMR1_EN
 = 
BIT
(3),

742 
	mFLD_TMR1_MODE
 = 
BIT_RNG
(4,5),

743 
	mFLD_TMR2_EN
 = 
BIT
(6),

744 
	mFLD_TMR2_MODE
 = 
BIT_RNG
(7,8),

745 
	mFLD_TMR_WD_CAPT
 = 
BIT_RNG
(9,22),

746 
	mFLD_TMR_WD_EN
 = 
BIT
(23),

747 
	mFLD_TMR0_STA
 = 
BIT
(24),

748 
	mFLD_TMR1_STA
 = 
BIT
(25),

749 
	mFLD_TMR2_STA
 = 
BIT
(26),

750 
	mFLD_CLR_WD
 = 
BIT
(27),

753 
	#ªg_tmr_°a
 
	`REG_ADDR8
(0x623)

	)

755 
	mFLD_TMR_STA_TMR0
 = 
BIT
(0),

756 
	mFLD_TMR_STA_TMR1
 = 
BIT
(1),

757 
	mFLD_TMR_STA_TMR2
 = 
BIT
(2),

758 
	mFLD_TMR_STA_WD
 = 
BIT
(3),

761 
	#ªg_tmr0_ˇ±
 
	`REG_ADDR32
(0x624)

	)

762 
	#ªg_tmr1_ˇ±
 
	`REG_ADDR32
(0x628)

	)

763 
	#ªg_tmr2_ˇ±
 
	`REG_ADDR32
(0x62c)

	)

764 
	#ªg_tmr_ˇ±
(
i
Ë
	`REG_ADDR32
(0x624 + ((iË<< 2))

	)

765 
	#ªg_tmr0_tick
 
	`REG_ADDR32
(0x630)

	)

766 
	#ªg_tmr1_tick
 
	`REG_ADDR32
(0x634)

	)

767 
	#ªg_tmr2_tick
 
	`REG_ADDR32
(0x638)

	)

768 
	#ªg_tmr_tick
(
i
Ë
	`REG_ADDR32
(0x630 + ((iË<< 2))

	)

772 
	#ªg_úq_mask
 
	`REG_ADDR32
(0x640)

	)

773 
	#ªg_úq_¥i
 
	`REG_ADDR32
(0x644)

	)

774 
	#ªg_úq_§c
 
	`REG_ADDR32
(0x648)

	)

775 
	#ªg_úq_§c3
 
	`REG_ADDR8
(0x64a)

	)

777 
	mFLD_IRQ_TMR0_EN
 = 
BIT
(0),

778 
	mFLD_IRQ_TMR1_EN
 = 
BIT
(1),

779 
	mFLD_IRQ_TMR2_EN
 = 
BIT
(2),

780 
	mFLD_IRQ_USB_PWDN_EN
 = 
BIT
(3),

781 
	mFLD_IRQ_DMA_EN
 = 
BIT
(4),

782 
	mFLD_IRQ_DAM_FIFO_EN
 = 
BIT
(5),

783 
	mFLD_IRQ_UART_EN
 = 
BIT
(6),

784 
	mFLD_IRQ_MIX_CMD_EN
 = 
BIT
(7), 
	mFLD_IRQ_HOST_CMD_EN
 = BIT(7),

786 
	mFLD_IRQ_EP0_SETUP_EN
 = 
BIT
(8),

787 
	mFLD_IRQ_EP0_DAT_EN
 = 
BIT
(9),

788 
	mFLD_IRQ_EP0_STA_EN
 = 
BIT
(10),

789 
	mFLD_IRQ_SET_INTF_EN
 = 
BIT
(11),

790 
	mFLD_IRQ_EP_DATA_EN
 = 
BIT
(12), 
	mFLD_IRQ_IRQ4_EN
 = BIT(12),

791 
	mFLD_IRQ_ZB_RT_EN
 = 
BIT
(13),

792 
	mFLD_IRQ_SW_PWM_EN
 = 
BIT
(14),

793 
	mFLD_IRQ_PKE_EN
 = 
BIT
(15),

795 
	mFLD_IRQ_USB_250US_EN
 = 
BIT
(16),

796 
	mFLD_IRQ_USB_RST_EN
 = 
BIT
(17),

797 
	mFLD_IRQ_GPIO_EN
 = 
BIT
(18),

798 
	mFLD_IRQ_PM_EN
 = 
BIT
(19),

799 
	mFLD_IRQ_SYSTEM_TIMER
 = 
BIT
(20),

800 
	mFLD_IRQ_GPIO_RISC0_EN
 = 
BIT
(21),

801 
	mFLD_IRQ_GPIO_RISC1_EN
 = 
BIT
(22),

804 
	mFLD_IRQ_EN
 = 
BIT_RNG
(24,31),

805 
	mFLD_IRQ_ALL
 = 0XFFFFFFFF,

807 
	#ªg_úq_í
 
	`REG_ADDR8
(0x643)

	)

814 
	#ªg_sy°em_tick
 
	`REG_ADDR32
(0x740)

	)

815 
	#ªg_sy°em_tick_úq_Àvñ
 
	`REG_ADDR32
(0x744)

	)

816 
	#ªg_sy°em_úq_mask
 
	`REG_ADDR8
(0x748)

	)

817 
	#ªg_sy°em_ˇl_úq
 
	`REG_ADDR8
(0x749)

	)

818 
	#ªg_sy°em_˘æ
 
	`REG_ADDR8
(0x74a)

	)

820 
	mFLD_SYSTEM_32K_CAL_MODE
 = 
BIT_RNG
(4,7),

821 
	mFLD_SYSTEM_32K_CAL_EN
 = 
BIT
(3),

822 
	mFLD_SYSTEM_TIMER_AUTO_EN
 = 
BIT
(2),

823 
	mFLD_SYSTEM_TIMER_MANUAL_EN
 = 
BIT
(1),

824 
	mFLD_SYSTEM_32K_WR_EN
 = 
BIT
(0),

827 
	#ªg_sy°em_°©us
 
	`REG_ADDR8
(0x74b)

	)

829 
	mFLD_SYSTEM_32K_TIMER_BUSY
 = 
BIT
(6),

830 
	mFLD_SYSTEM_32K_TIMER_UPDATE_RD
 = 
BIT
(5), 
	mFLD_SYSTEM_32K_TIMER_CLEAR_RD
 = BIT(5),

831 
	mFLD_SYSTEM_STATE_MACHINE_STATUS
 = 
BIT_RNG
(3,4), 
	mFLD_SYSTEM_32K_TIMER_SYCN_TRIG
 = 
BIT
(3),

832 
	mFLD_SYSTEM_CMD_SET_TRIG
 = 
BIT
(2),

833 
	mFLD_SYSTEM_CMD_SYCN_TRIG
 = 
BIT
(1),

834 
	mFLD_SYSTEM_TIMER_STATUS
 = 
BIT
(0),

837 
	#ªg_sy°em_32k_tick_wt
 
	`REG_ADDR32
(0x74c)

	)

838 
	#ªg_sy°em_32k_tick_rd
 
	`REG_ADDR32
(0x750)

	)

839 
	#ªg_sy°em_32k_tick_ˇl
 
	`REG_ADDR32
(0x754)

	)

843 
	#ªg_pwm_íabÀ
 
	`REG_ADDR8
(0x780)

	)

844 
	#ªg_pwm0_íabÀ
 
	`REG_ADDR8
(0x781)

	)

845 
	#ªg_pwm_˛k
 
	`REG_ADDR8
(0x782)

	)

847 
	#ªg_pwm0_mode
 
	`REG_ADDR8
(0x783)

	)

850 
	#ªg_pwm_övît
 
	`REG_ADDR8
(0x784)

	)

851 
	#ªg_pwm_n_övît
 
	`REG_ADDR8
(0x785)

	)

852 
	#ªg_pwm_pﬁ
 
	`REG_ADDR8
(0x786)

	)

854 
	#ªg_pwm_cy˛e
(
i
Ë
	`REG_ADDR32
(0x794 + (i << 2))

855 
	#ªg_pwm_cmp
(
i
Ë
	`REG_ADDR16
(0x794 + (i << 2))

856 
	#ªg_pwm_max
(
i
Ë
	`REG_ADDR16
(0x796 + (i << 2))

857 íum{

	)

858 
	mFLD_PWM_CMP
 = 
BIT_RNG
(0,15),

859 
	mFLD_PWM_MAX
 = 
BIT_RNG
(16,31),

862 
	#ªg_pwm0_pul£_num
 
	`REG_ADDR16
(0x7ac)

	)

864 
	#ªg_pwm_úq_mask
 
	`REG_ADDR8
(0x7b0)

	)

865 
	#ªg_pwm_úq_°a
 
	`REG_ADDR8
(0x7b1)

	)

867 
	mFLD_IRQ_PWM0_PNUM
 = 
BIT
(0),

868 
	mFLD_IRQ_PWM0_IR_DMA_FIFO_DONE
 = 
BIT
(1),

869 
	mFLD_IRQ_PWM0_FRAME
 = 
BIT
(2),

870 
	mFLD_IRQ_PWM1_FRAME
 = 
BIT
(3),

871 
	mFLD_IRQ_PWM2_FRAME
 = 
BIT
(4),

872 
	mFLD_IRQ_PWM3_FRAME
 = 
BIT
(5),

873 
	mFLD_IRQ_PWM4_FRAME
 = 
BIT
(6),

874 
	mFLD_IRQ_PWM5_FRAME
 = 
BIT
(7),

879 
	#ªg_pwm0_fifo_mode_úq_mask
 
	`REG_ADDR8
(0x7b2)

	)

882 
	mFLD_PWM0_IRQ_IR_FIFO_EN
 = 
BIT
(0),

885 
	#ªg_pwm0_fifo_mode_úq_°a
 
	`REG_ADDR8
(0x7b3)

	)

888 
	mFLD_PWM0_IRQ_IR_FIFO_CNT
 = 
BIT
(0),

893 
	#ªg_pwm_tcmp0_shadow
 
	`REG_ADDR16
(0x7c4)

894 
	#ªg_pwm_tmax0_shadow
 
	`REG_ADDR16
(0x7c6)

895 

	)

896 
	#ªg_pwm_ú_fifo_d©
(
i
Ë
	`REG_ADDR16
(0x7c8+i*2)

	)

897 
	#ªg_pwm_ú_fifo_úq_åig_Àvñ
 
	`REG_ADDR8
(0x7cc)

	)

899 
	#ªg_pwm_ú_fifo_d©a_°©us
 
	`REG_ADDR8
(0x7cd)

	)

901 
	mFLD_PWM0_IR_FIFO_DATA_NUM
 = 
BIT_RNG
(0,3),

902 
	mFLD_PWM0_IR_FIFO_EMPTY
 = 
BIT
(4),

903 
	mFLD_PWM0_IR_FIFO_FULL
 = 
BIT
(5),

906 
	#ªg_pwm_ú_˛r_fifo_d©a
 
	`REG_ADDR8
(0x7˚)

	)

909 
	mFLD_PWM0_IR_FIFO_CLR_DATA
 = 
BIT
(0),

914 
	#ªg_fifo0_d©a
 
	`REG_ADDR32
(0x800)

	)

915 
	#ªg_fifo1_d©a
 
	`REG_ADDR32
(0x900)

	)

916 
	#ªg_fifo2_d©a
 
	`REG_ADDR32
(0xa00)

	)

920 
	#ªg_dfifo0_addr
 
	`REG_ADDR16
(0xb00)

	)

921 
	#ªg_dfifo0_size
 
	`REG_ADDR8
(0xb02)

	)

922 
	#ªg_dfifo0_addHi
 
	`REG_ADDR8
(0xb03)

923 

	)

924 
	#ªg_dfifo1_addr
 
	`REG_ADDR16
(0xb04)

	)

925 
	#ªg_dfifo1_size
 
	`REG_ADDR8
(0xb06)

	)

926 
	#ªg_dfifo1_addHi
 
	`REG_ADDR8
(0xb07)

927 

	)

929 
	#ªg_dfifo2_addr
 
	`REG_ADDR16
(0xb08)

	)

930 
	#ªg_dfifo2_size
 
	`REG_ADDR8
(0xb0a)

	)

931 
	#ªg_dfifo2_addHi
 
	`REG_ADDR8
(0xb0b)

932 

	)

933 
	#ªg_dfifo_audio_addr
 
ªg_dfifo0_addr


	)

934 
	#ªg_dfifo_audio_size
 
ªg_dfifo0_size


	)

936 
	#ªg_dfifo_misc_chn_addr
 
ªg_dfifo2_addr


	)

937 
	#ªg_dfifo_misc_chn_size
 
ªg_dfifo2_size


	)

940 
	#ªg_dfifo0_l_Àvñ
 
	`REG_ADDR8
(0xb0c)

941 
	#ªg_dfifo0_h_Àvñ
 
	`REG_ADDR8
(0xb0d)

942 
	#ªg_dfifo1_h_Àvñ
 
	`REG_ADDR8
(0xb0e)

943 
	#ªg_dfifo2_h_Àvñ
 
	`REG_ADDR8
(0xb0f)

944 

	)

946 
	#ªg_dfifo_mode
 
	`REG_ADDR8
(0xb10)

	)

948 
	mFLD_AUD_DFIFO0_IN
 = 
BIT
(0),

949 
	mFLD_AUD_DFIFO1_IN
 = 
BIT
(1),

950 
	mFLD_AUD_DFIFO2_IN
 = 
BIT
(2),

951 
	mFLD_AUD_DFIFO0_OUT
 = 
BIT
(3),

952 
	mFLD_AUD_DFIFO0_L_INT
 = 
BIT
(4),

953 
	mFLD_AUD_DFIFO0_H_INT
 = 
BIT
(5),

954 
	mFLD_AUD_DFIFO1_H_INT
 = 
BIT
(6),

955 
	mFLD_AUD_DFIFO2_H_INT
 = 
BIT
(7),

958 
	#ªg_dfifo_aö
 
	`REG_ADDR8
(0xb11)

	)

960 
	mFLD_AUD_SAMPLE_TIME_CONFIG
 = 
BIT_RNG
(0,1),

961 
	mFLD_AUD_FIFO0_INPUT_SELECT
 = 
BIT_RNG
(2,3),

962 
	mFLD_AUD_FIFO1_INPUT_SELECT
 = 
BIT_RNG
(4,5),

963 
	mFLD_AUD_MIC_LEFT_CHN_SELECT
 = 
BIT
(6),

964 
	mFLD_AUD_MIC_RIGHT_CHN_SELECT
 = 
BIT
(7),

968 
	mAUDIO_FIFO0_INPUT_SELECT_USB
 = 0x00,

969 
	mAUDIO_FIFO0_INPUT_SELECT_I2S
 = 0x01,

970 
	mAUDIO_FIFO0_INPUT_SELECT_16BIT
 = 0x02,

971 
	mAUDIO_FIFO0_INPUT_SELECT_20BIT
 = 0x03,

975 
	mAUDIO_FIFO1_INPUT_SELECT_USB
 = 0x00,

976 
	mAUDIO_FIFO1_INPUT_SELECT_I2S
 = 0x01,

977 
	mAUDIO_FIFO1_INPUT_SELECT_16BIT
 = 0x02,

978 
	mAUDIO_FIFO1_INPUT_SELECT_20BIT
 = 0x03,

982 
	#ªg_mic_˘æ
 
	`REG_ADDR8
(0xb12)

	)

984 
	mFLD_AUD_MIC_VOL_CONTROL
 = 
BIT_RNG
(0,5),

985 
	mFLD_AUD_MIC_MONO_EN
 = 
BIT
(6),

986 
	mFLD_AUD_AMIC_DMIC_SELECT
 = 
BIT
(7),

990 
	mMIC_VOL_CONTROL_m48DB
 = 0x00,

991 
	mMIC_VOL_CONTROL_m42DB
 = 0x04,

992 
	mMIC_VOL_CONTROL_m36DB
 = 0x08,

993 
	mMIC_VOL_CONTROL_m30DB
 = 0x0c,

994 
	mMIC_VOL_CONTROL_m24DB
 = 0x10,

995 
	mMIC_VOL_CONTROL_m18DB
 = 0x14,

996 
	mMIC_VOL_CONTROL_m16DB
 = 0x15,

997 
	mMIC_VOL_CONTROL_m12DB
 = 0x18,

998 
	mMIC_VOL_CONTROL_m6DB
 = 0x1c,

999 
	mMIC_VOL_CONTROL_0DB
 = 0x20,

1000 
	mMIC_VOL_CONTROL_6DB
 = 0x24,

1001 
	mMIC_VOL_CONTROL_12DB
 = 0x28,

1002 
	mMIC_VOL_CONTROL_18DB
 = 0x2c,

1003 
	mMIC_VOL_CONTROL_24DB
 = 0x30,

1004 
	mMIC_VOL_CONTROL_30DB
 = 0x34,

1005 
	mMIC_VOL_CONTROL_36DB
 = 0x38,

1006 
	mMIC_VOL_CONTROL_42DB
 = 0x3c,

1010 
	#ªg_£t_fûãr_∑ø
 
	`REG_ADDR8
(0xb80)

	)

1012 
	#ªg_dfifo_dec_øtio
 
	`REG_ADDR8
(0xb8a)

	)

1014 
	#ªg_codec_dec_í
 
	`REG_ADDR8
(0xb8b)

	)

1016 
	mFLD_AUD_CODEC_DEC_EN
 = 
BIT
(0),

1019 
	#ªg_dfifo_úq_°©us
 
	`REG_ADDR8
(0xb13)

	)

1021 
	mFLD_AUD_DFIFO0_L_IRQ
 = 
BIT
(4),

1022 
	mFLD_AUD_DFIFO0_H_IRQ
 = 
BIT
(5),

1023 
	mFLD_AUD_DFIFO1_L_IRQ
 = 
BIT
(6),

1024 
	mFLD_AUD_DFIFO1_H_IRQ
 = 
BIT
(7),

1026 
	#ªg_dfifo0_Ωå
 
	`REG_ADDR16
(0xb14)

	)

1027 
	#ªg_dfifo0_w±r
 
	`REG_ADDR16
(0xb16)

	)

1029 
	#ªg_dfifo1_Ωå
 
	`REG_ADDR16
(0xb18)

	)

1030 
	#ªg_dfifo1_w±r
 
	`REG_ADDR16
(0xb1a)

	)

1032 
	#ªg_dfifo2_Ωå
 
	`REG_ADDR16
(0xb1c)

	)

1033 
	#ªg_dfifo2_w±r
 
	`REG_ADDR16
(0xb1e)

	)

1036 
	#ªg_audio_w±r
 
ªg_dfifo0_w±r


	)

1038 
	#ªg_dfifo0_num
 
	`REG_ADDR16
(0xb20)

	)

1039 
	#ªg_dfifo1_num
 
	`REG_ADDR16
(0xb24)

	)

1040 
	#ªg_dfifo2_num
 
	`REG_ADDR16
(0xb28)

	)

1042 
	#ªg_dfifo_m™uÆ_mode
 
	`REG_ADDR8
(0xb2c)

	)

1044 
	mFLD_DFIFO_MANUAL_MODE_EN
 = 
BIT
(0),

1047 
	#ªg_dfifo0_m™_d©
 
	`REG_ADDR32
(0xb30)

	)

1053 
	#ªg_dma0_addr
 
	`REG_ADDR16
(0xc00)

	)

1054 
	#ªg_dma0_size
 
	`REG_ADDR8
(0xc02)

	)

1055 
	#ªg_dma0_mode
 
	`REG_ADDR8
(0xc03)

	)

1057 
	mFLD_DMA_WR_MEM
 = 
BIT
(0),

1058 
	mFLD_DMA_PINGPONG_EN
 = 
BIT
(1),

1059 
	mFLD_DMA_FIFO_EN
 = 
BIT
(2),

1060 
	mFLD_DMA_AUTO_MODE
 = 
BIT
(3),

1061 
	mFLD_DMA_READ_MODE
 = 
BIT
(4),

1062 
	mFLD_DMA_BYTE_MODE
 = 
BIT
(5)

1067 
	#ªg_dma1_addr
 
	`REG_ADDR16
(0xc04)

	)

1068 
	#ªg_dma1_size
 
	`REG_ADDR8
(0xc06)

	)

1069 
	#ªg_dma1_mode
 
	`REG_ADDR8
(0xc07)

	)

1072 
	#ªg_dma2_addr
 
	`REG_ADDR16
(0xc08)

	)

1073 
	#ªg_dma2_size
 
	`REG_ADDR8
(0xc0a)

	)

1074 
	#ªg_dma2_mode
 
	`REG_ADDR8
(0xc0b)

	)

1077 
	#ªg_dma3_addr
 
	`REG_ADDR16
(0xc0c)

	)

1078 
	#ªg_dma3_size
 
	`REG_ADDR8
(0xc0e)

	)

1079 
	#ªg_dma3_mode
 
	`REG_ADDR8
(0xc0f)

	)

1081 
	#ªg_dma4_addr
 
	`REG_ADDR16
(0xc10)

	)

1082 
	#ªg_dma4_size
 
	`REG_ADDR8
(0xc12)

	)

1083 
	#ªg_dma4_mode
 
	`REG_ADDR8
(0xc13)

	)

1085 
	#ªg_dma5_addr
 
	`REG_ADDR16
(0xc14)

	)

1086 
	#ªg_dma5_size
 
	`REG_ADDR8
(0xc16)

	)

1087 
	#ªg_dma5_mode
 
	`REG_ADDR8
(0xc17)

	)

1090 
	#ªg_dma7_addr
 
	`REG_ADDR16
(0xc18)

	)

1091 
	#ªg_dma7_size
 
	`REG_ADDR8
(0xc1a)

	)

1092 
	#ªg_dma7_mode
 
	`REG_ADDR8
(0xc1b)

	)

1095 
	#ªg_dma_t_addr
 
	`REG_ADDR16
(0xc1c)

	)

1096 
	#ªg_dma_t_size
 
	`REG_ADDR8
(0xc1e)

	)

1098 
	#ªg_dma_size
(
v
Ë
	`REG_ADDR8
(0xc02+4*v)

	)

1101 
	#ªg_dma_u¨t_rx_addr
 
ªg_dma0_addr


	)

1102 
	#ªg_dma_u¨t_rx_size
 
ªg_dma0_size


	)

1103 
	#ªg_dma_u¨t_rx_mode
 
ªg_dma0_mode


	)

1105 
	#ªg_dma_u¨t_tx_addr
 
ªg_dma1_addr


	)

1106 
	#ªg_dma_u¨t_tx_size
 
ªg_dma1_size


	)

1107 
	#ªg_dma_u¨t_tx_mode
 
ªg_dma1_mode


	)

1109 
	#ªg_dma_rf_rx_addr
 
ªg_dma2_addr


	)

1110 
	#ªg_dma_rf_rx_size
 
ªg_dma2_size


	)

1111 
	#ªg_dma_rf_rx_mode
 
ªg_dma2_mode


	)

1113 
	#ªg_dma_rf_tx_addr
 
ªg_dma3_addr


	)

1114 
	#ªg_dma_rf_tx_size
 
ªg_dma3_size


	)

1115 
	#ªg_dma_rf_tx_mode
 
ªg_dma3_mode


	)

1117 
	#ªg_dma_pwm_addr
 
ªg_dma7_addr


	)

1118 
	#ªg_dma_pwm_size
 
ªg_dma7_size


	)

1119 
	#ªg_dma_pwm_mode
 
ªg_dma7_mode


	)

1123 
	#ªg_dma_chn_í
 
	`REG_ADDR8
(0xc20)

	)

1124 
	#ªg_dma_chn_úq_msk
 
	`REG_ADDR8
(0xc21)

	)

1125 
	#ªg_dma_tx_rdy0
 
	`REG_ADDR8
(0xc24)

	)

1126 
	#ªg_dma_tx_rdy1
 
	`REG_ADDR8
(0xc25)

	)

1127 
	#ªg_dma_rx_rdy0
 
	`REG_ADDR8
(0xc26)

	)

1128 
	#ªg_dma_rx_rdy1
 
	`REG_ADDR8
(0xc27)

	)

1130 
	#ªg_dma_úq_°©us
 
ªg_dma_rx_rdy0


	)

1133 
	mFLD_DMA_CHN0
 = 
BIT
(0), 
	mFLD_DMA_CHN_UART_RX
 = BIT(0),

1134 
	mFLD_DMA_CHN1
 = 
BIT
(1), 
	mFLD_DMA_CHN_UART_TX
 = BIT(1),

1135 
	mFLD_DMA_CHN2
 = 
BIT
(2), 
	mFLD_DMA_CHN_RF_RX
 = BIT(2),

1136 
	mFLD_DMA_CHN3
 = 
BIT
(3), 
	mFLD_DMA_CHN_RF_TX
 = BIT(3),

1137 
	mFLD_DMA_CHN4
 = 
BIT
(4), 
	mFLD_DMA_CHN_AES_OUT
 = BIT(4),

1138 
	mFLD_DMA_CHN5
 = 
BIT
(5), 
	mFLD_DMA_CHN_AES_IN
 = BIT(5),

1139 
	mFLD_DMA_CHN7
 = 
BIT
(7), 
	mFLD_DMA_CHN_PWM
 = BIT(7),

1143 
	mFLD_DMA_IRQ_UART_RX
 = 
BIT
(0),

1144 
	mFLD_DMA_IRQ_UART_TX
 = 
BIT
(1),

1145 
	mFLD_DMA_IRQ_RF_RX
 = 
BIT
(2),

1146 
	mFLD_DMA_IRQ_RF_TX
 = 
BIT
(3),

1147 
	mFLD_DMA_IRQ_AES_DECO
 = 
BIT
(4),

1148 
	mFLD_DMA_IRQ_AES_CODE
 = 
BIT
(5),

1149 
	mFLD_DMA_IRQ_PWM
 = 
BIT
(7),

1150 
	mFLD_DMA_IRQ_ALL
 = 0xff,

1151 } 
	tIRQ_DMAIrqTy≥Def
;

1154 
	#ªg_dma_rx_Ωå
 
	`REG_ADDR8
(0xc28)

	)

1155 
	#ªg_dma_rx_w±r
 
	`REG_ADDR8
(0xc29)

	)

1157 
	#ªg_dma_tx_Ωå
 
	`REG_ADDR8
(0xc2a)

	)

1158 
	#ªg_dma_tx_w±r
 
	`REG_ADDR8
(0xc2b)

	)

1159 
	#ªg_dma_tx_fifo
 
	`REG_ADDR16
(0xc2c)

	)

1161 
	mFLD_DMA_RPTR_CLR
 = 
BIT
(4),

1162 
	mFLD_DMA_RPTR_NEXT
 = 
BIT
(5),

1163 
	mFLD_DMA_RPTR_SET
 = 
BIT
(6),

1166 
	#ªg_dma0_addrHi
 
	`REG_ADDR8
(0xc40)

	)

1167 
	#ªg_dma1_addrHi
 
	`REG_ADDR8
(0xc41)

	)

1168 
	#ªg_dma2_addrHi
 
	`REG_ADDR8
(0xc42)

	)

1169 
	#ªg_dma3_addrHi
 
	`REG_ADDR8
(0xc43)

	)

1170 
	#ªg_dma4_addrHi
 
	`REG_ADDR8
(0xc44)

	)

1171 
	#ªg_dma5_addrHi
 
	`REG_ADDR8
(0xc45)

	)

1172 
	#ªg_dma_è_addrHi
 
	`REG_ADDR8
(0xc46)

	)

1173 
	#ªg_dma_a3_addrHi
 
	`REG_ADDR8
(0xc47)

	)

1174 
	#ªg_dma7_addrHi
 
	`REG_ADDR8
(0xc48)

	)

1178 
	#ªg_rf_Œ_˘æ_0
 
	`REG_ADDR8
(0xf02)

	)

1180 
	#ªg_rf_Œ_˘æ_1
 
	`REG_ADDR8
(0xf03)

	)

1182 
	mFLD_RF_FSM_TIMEOUT_EN
 = 
BIT
(0),

1183 
	mFLD_RF_RX_FIRST_TIMEOUT_EN
 = 
BIT
(1),

1184 
	mFLD_RF_RX_TIMEOUT_EN
 = 
BIT
(2),

1185 
	mFLD_RF_CRC_2_EN
 = 
BIT
(3),

1188 
	mFLD_RF_BRX_SN_INIT
 = 
BIT
(4),

1189 
	mFLD_RF_BRX_NESN_INIT
 = 
BIT
(5),

1190 
	mFLD_RF_BTX_SN_INIT
 = 
BIT
(6),

1191 
	mFLD_RF_BTX_NESN_INIT
 = 
BIT
(7),

1194 
	#FSM_TIMEOUT_ENABLE
 ( 
ªg_rf_Œ_˘æ_1
 |
FLD_RF_FSM_TIMEOUT_EN
 )

	)

1195 
	#FSM_TIMEOUT_DISABLE
 ( 
ªg_rf_Œ_˘æ_1
 &(~
FLD_RF_FSM_TIMEOUT_EN
Ë)

	)

1196 
	#FSM_RX_FIRST_TIMEOUT_ENABLE
 ( 
ªg_rf_Œ_˘æ_1
 |
FLD_RF_RX_FIRST_TIMEOUT_EN
 )

	)

1197 
	#FSM_RX_FIRST_TIMEOUT_DISABLE
 ( 
ªg_rf_Œ_˘æ_1
 &(~
FLD_RF_RX_FIRST_TIMEOUT_EN
Ë)

	)

1199 
	#ªg_rf_rx_timeout
 
	`REG_ADDR16
(0xf0a)

	)

1201 
	#ªg_rf_Œ_˘æ_2
 
	`REG_ADDR8
(0xf15)

	)

1203 
	#ªg_rf_Œ_˘æ_3
 
	`REG_ADDR8
(0xf16)

	)

1205 
	mFLD_RF_TX_EN_DLY_EN
 = 
BIT
(0),

1206 
	mFLD_RF_PLL_RST_EN
 = 
BIT
(1),

1207 
	mFLD_RF_CMD_SCHEDULE_EN
 = 
BIT
(2),

1208 
	mFLD_RF_R_TX_EN_DLY
 = 
BIT_RNG
(4,7),

1212 
	#ªg_rf_úq_mask
 
	`REG_ADDR16
(0xf1c)

	)

1213 
	#ªg_rf_úq_°©us
 
	`REG_ADDR16
(0xf20)

	)

1214 
	#ªg_rf_fsm_timeout
 
	`REG_ADDR32
(0xf2c)

	)

1216 
	#CLEAR_ALL_RFIRQ_STATUS
 ( 
ªg_rf_úq_°©us
 = 0xfff‡)

	)

1219 
	mFLD_RF_IRQ_RX
 = 
BIT
(0),

1220 
	mFLD_RF_IRQ_TX
 = 
BIT
(1),

1221 
	mFLD_RF_IRQ_RX_TIMEOUT
 = 
BIT
(2),

1222 
	mFLD_RF_IRQ_RX_CRC_2
 = 
BIT
(4),

1223 
	mFLD_RF_IRQ_CMD_DONE
 = 
BIT
(5),

1224 
	mFLD_RF_IRQ_FSM_TIMEOUT
 = 
BIT
(6),

1225 
	mFLD_RF_IRQ_RETRY_HIT
 = 
BIT
(7),

1226 
	mFLD_RF_IRQ_TX_DS
 = 
BIT
(8),

1227 
	mFLD_RF_IRQ_RX_DR
 = 
BIT
(9),

1228 
	mFLD_RF_IRQ_FIRST_TIMEOUT
 = 
BIT
(10),

1229 
	mFLD_RF_IRQ_INVALID_PID
 = 
BIT
(11),

1230 
	mFLD_RF_IRQ_STX_TIMEOUT
 = 
BIT
(12),

1231 
	mFLD_RF_IRQ_ALL
 = 0X1FFF,

1234 
	#REG_AURA_BASE
 0x1200

	)

1235 
	#ªg_rf_tx_Êex_mi_0
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x1c)

	)

1238 
	mFLD_RF_TX_MI_FRACTION
 = 
BIT_RNG
(0,5),

1239 
	mFLD_RF_TX_MI_INTEGER_1
 = 
BIT_RNG
(6,7),

1241 
	#ªg_rf_tx_Êex_mi_1
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x1d)

	)

1244 
	mFLD_RF_TX_MI_INTEGER_2
 = 
BIT
(0),

1247 
	#ªg_rf_rx_Êex_mi_0
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x1e)

	)

1250 
	mFLD_RF_RX_MI_FRACTION
 = 
BIT_RNG
(0,5),

1251 
	mFLD_RF_RX_MI_INTEGER_1
 = 
BIT_RNG
(6,7),

1253 
	#ªg_rf_rx_Êex_mi_1
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x1f)

	)

1256 
	mFLD_RF_RX_MI_INTEGER_2
 = 
BIT
(0),

1259 
	#ªg_rf_mode_cfg_tx1_0
 
	`REG_ADDR8
(
REG_AURA_BASE
+0x22)

	)

1262 
	mFLD_RF_BLE_MODE_TX
 = 
BIT
(0),

1263 
	mFLD_RF_VCO_TRIM_KVM
 = 
BIT_RNG
(1,3),

1264 
	mFLD_RF_HPMC_EXP_DIFF_COUNT_L
 = 
BIT_RNG
(4,7),

1267 
	#ªg_pke_˘æ
 
	`REG_ADDR32
(0x2000)

	)

1269 
	mFLD_PKE_CTRL_START
 = 
BIT
(0),

1270 
	mFLD_PKE_CTRL_STOP
 = 
BIT
(16),

1273 
	#ªg_pke_c⁄f
 
	`REG_ADDR32
(0x2004)

	)

1275 
	mFLD_PKE_CONF_IRQ_EN
 = 
BIT
(8),

1276 
	mFLD_PKE_CONF_PARTIAL_RADIX
 = 
BIT_RNG
(16,23),

1277 
	mFLD_PKE_CONF_BASE_RADIX
 = 
BIT_RNG
(24,26),

1280 
	#ªg_pke_mc_±r
 
	`REG_ADDR32
(0x2010)

	)

1282 
	#ªg_pke_°©
 
	`REG_ADDR32
(0x2020)

	)

1284 
	mFLD_PKE_STAT_DONE
 = 
BIT
(0),

1287 
	#ªg_pke_π_code
 
	`REG_ADDR32
(0x2024)

	)

1289 
	mFLD_PKE_RT_CODE_STOP_LOG
 = 
BIT_RNG
(0,3),

1292 
	#ªg_pke_exe_c⁄f
 
	`REG_ADDR32
(0x2050)

	)

1294 
	mFLD_PKE_EXE_CONF_IAFF_R0
 = 
BIT
(0),

1295 
	mFLD_PKE_EXE_CONF_IMON_R0
 = 
BIT
(1),

1296 
	mFLD_PKE_EXE_CONF_IAFF_R1
 = 
BIT
(2),

1297 
	mFLD_PKE_EXE_CONF_IMON_R1
 = 
BIT
(3),

1298 
	mFLD_PKE_EXE_CONF_OAFF
 = 
BIT
(4),

1299 
	mFLD_PKE_EXE_CONF_OMON
 = 
BIT
(5),

1300 
	mFLD_PKE_EXE_CONF_ME_SCA_EN
 = 
BIT_RNG
(8,9),

1311 
	#¨eg_06_∂l_bg
 0x06

	)

1313 
	mFLD_PLL_BG_POWER_DOWN
 = 
BIT
(4),

1316 
	#¨eg_0e_∑0_∑3_puŒ
 0x0E

	)

1317 
	#¨eg_0f_∑4_∑7_puŒ
 0x0F

	)

1318 
	#¨eg_10_pb0_pb3_puŒ
 0x10

	)

1319 
	#¨eg_11_pb4_pb7_puŒ
 0x11

	)

1320 
	#¨eg_12_pc0_pc3_puŒ
 0x12

	)

1321 
	#¨eg_13_pc4_pc7_puŒ
 0x13

	)

1322 
	#¨eg_14_pd0_pd3_puŒ
 0x14

	)

1323 
	#¨eg_15_pd4_pd7_puŒ
 0x15

	)

1328 
	#mdec_r°_addr
 0x16

	)

1330 
	mFLD_SELE_PA0
 = 
BIT
(0),

1331 
	mFLD_SELE_PB7
 = 
BIT
(1),

1332 
	mFLD_SELE_PC4
 = 
BIT
(2),

1333 
	mFLD_SELE_PD0
 = 
BIT
(3),

1334 
	mFLD_RST_MDEC
 = 
BIT
(4),

1335 
	mFLD_CLS_MDEC
 = 
BIT_RNG
(0,4),

1338 
	#mdec_m©ch_addr
 0x17

	)

1340 
	mFLD_CLS_MATCH_ADDR
 = 
BIT_RNG
(0,3),

1345 
	#¨eg_auto_pd_˘æ_0
 0x2B

	)

1347 
	mFLD_AUTO_PD_PL_ALL
 = 
BIT
(0),

1348 
	mFLD_AUTO_PD_PL_DCDC
 = 
BIT
(1),

1352 
	#¨eg_auto_pd_˘æ_1
 0x2C

	)

1354 
	mFLD_AUTO_PD_RC_32K
 = 
BIT
(0),

1355 
	mFLD_AUTO_PD_XTAL_32K
 = 
BIT
(1),

1356 
	mFLD_AUTO_PD_XTAL_24M
 = 
BIT
(2),

1357 
	mFLD_AUTO_PD_LC_COMP
 = 
BIT
(3),

1358 
	mFLD_AUTO_PD_MISC
 = 
BIT
(4),

1359 
	mFLD_AUTO_PD_XTAL_QUICK_RST
 = 
BIT
(5),

1360 
	mFLD_AUTO_PD_OTP
 = 
BIT
(6),

1366 
	#¨eg_˛k_£âög
 0x82

	)

1368 
	mFLD_DCCC_DOUBLER_POWER_DOWN
 = 
BIT
(3),

1369 
	mFLD_CLK_48M_TO_RX_EN
 = 
BIT
(4),

1370 
	mFLD_CLK_48M_TO_DIG_EN
 = 
BIT
(5),

1371 
	mFLD_CLK_24M_TO_SAR_EN
 = 
BIT
(6),

1372 
	mFLD_CLK_48M_TO_CAL_DIG_MAN_EN
 = 
BIT
(7),

1375 
	#¨eg_xo_£âög
 0x8a

	)

1377 
	mFLD_XO_CDAC_ANA
 = 
BIT_RNG
(0,5),

1378 
	mFLD_XO_MODE_ANA
 = 
BIT
(6),

1379 
	mFLD_XO_CAP_OFF_ANA
 = 
BIT
(7),

1383 
	#codec_™a_cfg2
 0xe6

	)

1384 
	#codec_™a_cfg3
 0xe7

	)

1385 
	#codec_™a_cfg4
 0xe8

	)

1387 
	#pga_audio_íabÀ
 0x34

	)

1390 #i‡
deföed
(
__˝lu•lus
)

	@platform/chip_8278/rf_drv.h

24 #i‚de‡
_RF_DRV_H_


25 
	#_RF_DRV_H_


	)

27 
	~"bô.h
"

28 
	~"b•.h
"

29 
	~"ªgi°î.h
"

30 
	~"Êash.h
"

31 
	~"™Æog.h
"

34 
	#RF_CHN_TABLE
 0x8000

	)

41 
	mRF_MODE_BLE_2M
 = 
BIT
(0),

42 
	mRF_MODE_BLE_1M
 = 
BIT
(1),

43 
	mRF_MODE_BLE_1M_NO_PN
 = 
BIT
(2),

44 
	mRF_MODE_ZIGBEE_250K
 = 
BIT
(3),

45 
	mRF_MODE_LR_S2_500K
 = 
BIT
(4),

46 
	mRF_MODE_LR_S8_125K
 = 
BIT
(5),

47 
	mRF_MODE_PRIVATE_250K
 = 
BIT
(6),

48 
	mRF_MODE_PRIVATE_500K
 = 
BIT
(7),

49 
	mRF_MODE_PRIVATE_1M
 = 
BIT
(8),

50 
	mRF_MODE_PRIVATE_2M
 = 
BIT
(9),

51 
	mRF_MODE_ANT
 = 
BIT
(10),

52 
	mRF_MODE_BLE_2M_NO_PN
 = 
BIT
(11),

53 
	mRF_MODE_HYBEE_1M
 = 
BIT
(12),

54 
	mRF_MODE_HYBEE_2M
 = 
BIT
(13),

55 
	mRF_MODE_HYBEE_500K
 = 
BIT
(14),

56 } 
	tRF_ModeTy≥Def
;

63 
	mRF_MODE_TX
 = 0,

64 
	mRF_MODE_RX
 = 1,

65 
	mRF_MODE_AUTO
 = 2,

66 
	mRF_MODE_OFF
 = 3

67 } 
	tRF_SètusTy≥Def
;

74 
	mRF_POWER_P11p26dBm
 = 63,

75 
	mRF_POWER_P11p09dBm
 = 61,

76 
	mRF_POWER_P10p83dBm
 = 58,

77 
	mRF_POWER_P10p62dBm
 = 56,

78 
	mRF_POWER_P10p30dBm
 = 53,

79 
	mRF_POWER_P10p05dBm
 = 51,

80 
	mRF_POWER_P9p79dBm
 = 49,

81 
	mRF_POWER_P9p54dBm
 = 47,

82 
	mRF_POWER_P9p23dBm
 = 45,

83 
	mRF_POWER_P8p92dBm
 = 43,

84 
	mRF_POWER_P8p57dBm
 = 41,

85 
	mRF_POWER_P8p20dBm
 = 39,

86 
	mRF_POWER_P7p80dBm
 = 37,

87 
	mRF_POWER_P7p37dBm
 = 35,

88 
	mRF_POWER_P6p91dBm
 = 33,

89 
	mRF_POWER_P6p45dBm
 = 31,

90 
	mRF_POWER_P5p92dBm
 = 29,

91 
	mRF_POWER_P5p33dBm
 = 27,

92 
	mRF_POWER_P4p69dBm
 = 25,

93 
	mRF_POWER_P3p99dBm
 = 23,

95 
	mRF_POWER_P3p50dBm
 = 
BIT
(7) | 63,

96 
	mRF_POWER_P3p33dBm
 = 
BIT
(7) | 61,

97 
	mRF_POWER_P3p13dBm
 = 
BIT
(7) | 59,

98 
	mRF_POWER_P2p93dBm
 = 
BIT
(7) | 57,

99 
	mRF_POWER_P2p60dBm
 = 
BIT
(7) | 54,

100 
	mRF_POWER_P2p36dBm
 = 
BIT
(7) | 52,

101 
	mRF_POWER_P2p10dBm
 = 
BIT
(7) | 50,

102 
	mRF_POWER_P1p83dBm
 = 
BIT
(7) | 48,

103 
	mRF_POWER_P1p56dBm
 = 
BIT
(7) | 46,

104 
	mRF_POWER_P1p25dBm
 = 
BIT
(7) | 44,

105 
	mRF_POWER_P0p71dBm
 = 
BIT
(7) | 41,

106 
	mRF_POWER_P0p52dBm
 = 
BIT
(7) | 40,

107 
	mRF_POWER_N0p28dBm
 = 
BIT
(7) | 36,

108 
	mRF_POWER_N0p51dBm
 = 
BIT
(7) | 35,

109 
	mRF_POWER_N0p74dBm
 = 
BIT
(7) | 34,

110 
	mRF_POWER_N1p21dBm
 = 
BIT
(7) | 32,

111 
	mRF_POWER_N1p69dBm
 = 
BIT
(7) | 30,

112 
	mRF_POWER_N2p23dBm
 = 
BIT
(7) | 28,

113 
	mRF_POWER_N2p84dBm
 = 
BIT
(7) | 26,

114 
	mRF_POWER_N3p48dBm
 = 
BIT
(7) | 24,

115 
	mRF_POWER_N4p18dBm
 = 
BIT
(7) | 22,

116 
	mRF_POWER_N4p97dBm
 = 
BIT
(7) | 20,

117 
	mRF_POWER_N5p85dBm
 = 
BIT
(7) | 18,

118 
	mRF_POWER_N6p83dBm
 = 
BIT
(7) | 16,

119 
	mRF_POWER_N7p88dBm
 = 
BIT
(7) | 14,

120 
	mRF_POWER_N9p14dBm
 = 
BIT
(7) | 12,

121 
	mRF_POWER_N10p70dBm
 = 
BIT
(7) | 10,

122 
	mRF_POWER_N12p57dBm
 = 
BIT
(7) | 8,

123 
	mRF_POWER_N15p01dBm
 = 
BIT
(7) | 6,

124 
	mRF_POWER_N18p40dBm
 = 
BIT
(7) | 4,

125 
	mRF_POWER_N24p28dBm
 = 
BIT
(7) | 2,

127 
	mRF_POWER_N30dBm
 = 0xff,

128 
	mRF_POWER_N50dBm
 = 
BIT
(7) | 0,

129 } 
	tRF_PowîTy≥Def
;

131 c⁄° 
RF_PowîTy≥Def
 
rf_powî_Levñ_li°
[60];

137 
	mRF_POWER_INDEX_P11p26dBm
,

138 
	mRF_POWER_INDEX_P11p09dBm
,

139 
	mRF_POWER_INDEX_P10p83dBm
,

140 
	mRF_POWER_INDEX_P10p62dBm
,

141 
	mRF_POWER_INDEX_P10p30dBm
,

142 
	mRF_POWER_INDEX_P10p05dBm
,

143 
	mRF_POWER_INDEX_P9p79dBm
,

144 
	mRF_POWER_INDEX_P9p54dBm
,

145 
	mRF_POWER_INDEX_P9p23dBm
,

146 
	mRF_POWER_INDEX_P8p92dBm
,

147 
	mRF_POWER_INDEX_P8p57dBm
,

148 
	mRF_POWER_INDEX_P8p20dBm
,

149 
	mRF_POWER_INDEX_P7p80dBm
,

150 
	mRF_POWER_INDEX_P7p37dBm
,

151 
	mRF_POWER_INDEX_P6p91dBm
,

152 
	mRF_POWER_INDEX_P6p45dBm
,

153 
	mRF_POWER_INDEX_P5p92dBm
,

154 
	mRF_POWER_INDEX_P5p33dBm
,

155 
	mRF_POWER_INDEX_P4p69dBm
,

156 
	mRF_POWER_INDEX_P3p99dBm
,

158 
	mRF_POWER_INDEX_P3p50dBm
,

159 
	mRF_POWER_INDEX_P3p33dBm
,

160 
	mRF_POWER_INDEX_P3p13dBm
,

161 
	mRF_POWER_INDEX_P2p93dBm
,

162 
	mRF_POWER_INDEX_P2p60dBm
,

163 
	mRF_POWER_INDEX_P2p36dBm
,

164 
	mRF_POWER_INDEX_P2p10dBm
,

165 
	mRF_POWER_INDEX_P1p83dBm
,

166 
	mRF_POWER_INDEX_P1p56dBm
,

167 
	mRF_POWER_INDEX_P1p25dBm
,

168 
	mRF_POWER_INDEX_P0p71dBm
,

169 
	mRF_POWER_INDEX_P0p52dBm
,

170 
	mRF_POWER_INDEX_N0p28dBm
,

171 
	mRF_POWER_INDEX_N0p51dBm
,

172 
	mRF_POWER_INDEX_N0p74dBm
,

173 
	mRF_POWER_INDEX_N1p21dBm
,

174 
	mRF_POWER_INDEX_N1p69dBm
,

175 
	mRF_POWER_INDEX_N2p23dBm
,

176 
	mRF_POWER_INDEX_N2p84dBm
,

177 
	mRF_POWER_INDEX_N3p48dBm
,

178 
	mRF_POWER_INDEX_N4p18dBm
,

179 
	mRF_POWER_INDEX_N4p97dBm
,

180 
	mRF_POWER_INDEX_N5p85dBm
,

181 
	mRF_POWER_INDEX_N6p83dBm
,

182 
	mRF_POWER_INDEX_N7p88dBm
,

183 
	mRF_POWER_INDEX_N9p14dBm
,

184 
	mRF_POWER_INDEX_N10p70dBm
,

185 
	mRF_POWER_INDEX_N12p57dBm
,

186 
	mRF_POWER_INDEX_N15p01dBm
,

187 
	mRF_POWER_INDEX_N18p40dBm
,

188 
	mRF_POWER_INDEX_N24p28dBm
,

189 } 
	tRF_PowîIndexTy≥Def
;

193 
	#RF_TRX_MODE
 0xe0

	)

194 
	#RF_TRX_OFF
 0x45

	)

196 
	#RF_PACKET_LENGTH_OK
(
p
Ë’[0] =p[12]+13)

	)

197 
	#RF_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x10)

	)

199 
	#RF_PACKET_1M_LENGTH_OK
(
p
Ë’[0] =p[5]+13)

	)

200 
	#RF_PACKET_2M_LENGTH_OK
(
p
Ë’[0] =’[12]&0x3f)+15)

	)

202 
	#RF_ZIGBEE_PACKET_LENGTH_OK
(
p
Ë’[0] =p[4]+9)

	)

203 
	#RF_ZIGBEE_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x51Ë=0x10)

	)

204 
	#RF_ZIGBEE_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

205 
	#RF_ZIGBEE_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

206 
	#RF_ZIGBEE_PACKET_PAYLOAD_LENGTH_GET
(
p
Ë’[4])

	)

208 
	#RF_NRF_ESB_PACKET_LENGTH_OK
(
p
Ë’[0] =’[4] & 0x3fË+ 11)

	)

209 
	#RF_NRF_ESB_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x01Ë=0x00)

	)

210 
	#RF_NRF_ESB_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

211 
	#RF_NRF_SB_PACKET_PAYLOAD_LENGTH_GET
(
p
Ë’[0] - 10)

	)

212 
	#RF_NRF_SB_PACKET_CRC_OK
(
p
Ë(’[p[0]+3] & 0x01Ë=0x00)

	)

213 
	#RF_NRF_SB_PACKET_CRC_GET
(
p
) ((p[p[0]-8]<<8) +Ö[p[0]-7])

214 
	#RF_NRF_SB_PACKET_RSSI_GET
(
p
Ë’[p[0]+2])

	)

215 
	#RF_NRF_ESB_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

216 
	#RF_NRF_SB_PACKET_TIMESTAMP_GET
(
p
Ë’[p[0]-4] | (p[p[0]-3]<<8Ë| (p[p[0]-2]<<16Ë| (p[p[0]-1]<<24))

	)

228 
ölöe
 
	$ª£t_ba£b™d
()

230 
	`REG_ADDR8
(0x61Ë
	`BIT
(0);

231 
	`REG_ADDR8
(0x61) = 0;

232 
	}
}

239 
ölöe
 
	$ª£t_¢_√¢
()

241 
	`REG_ADDR8
(0xf01) = 0x01;

242 
	}
}

249 
ölöe
 
	$rf_ª£t_¢
()

251 
	`wrôe_ªg8
(0xf01, 0x3f);

252 
	`wrôe_ªg8
(0xf01, 0x00);

253 
	}
}

260 
ölöe
 
	$rf_£t_tx_rx_off
()

262 
	`wrôe_ªg8
(0xf16, 0x29);

263 
	`wrôe_ªg8
(0x428, 
RF_TRX_MODE
);

264 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
);

265 
	}
}

272 
ölöe
 
	$rf_£t_tx_rx_off_auto_mode
()

274 
	`wrôe_ªg8
(0xf00, 0x80);

275 
	}
}

282 
ölöe
 
	$rf_£t_txmode
()

284 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
 | 
	`BIT
(4));

285 
	}
}

292 
ölöe
 
	$rf_£t_rxmode
()

294 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
);

295 
	`wrôe_ªg8
(0x428, 
RF_TRX_MODE
 | 
	`BIT
(0));

296 
	`wrôe_ªg8
(0xf02, 
RF_TRX_OFF
 | 
	`BIT
(5));

297 
	}
}

305 
ölöe
 
	$rf_rx_buf„r_ªc⁄fig
(*
RF_RxAddr
)

307 
ªg_dma2_addr
 = ()(()
RF_RxAddr
);

308 
	}
}

315 
ölöe
 sig√d 
	$rf_rssi_gë_154
()

317  (((sig√d )(
	`ªad_ªg8
(0x441))) - 110);

318 
	}
}

325 
ölöe
 
	$rf_tx_föish
()

327  ((
	`ªad_ªg8
(0xf20Ë& 
	`BIT
(1)) == 0x02);

328 
	}
}

339 
ölöe
 
	$rf_tx_föish_˛ór_Êag
()

341 
	`wrôe_ªg8
(0xf20, 0x02);

342 
	}
}

349 
ölöe
 
	$rf_rx_föish
()

351  ((
	`ªad_ªg8
(0xf20Ë& 
	`BIT
(0)) == 0x01);

352 
	}
}

363 
ölöe
 
	$rf_rx_föish_˛ór_Êag
()

365 
	`wrôe_ªg8
(0xf20, 0x01);

366 
	}
}

373 
ölöe
 
	$rf_drv_ˇp
(
addr
)

375 
ˇp
 = 0xff;

376 
	`Êash_ªad_∑ge
(
addr
, 1, &
ˇp
);

377 if(
ˇp
 != 0xff){

378 
ˇp
 &= 0x3f;

379 
	`™Æog_wrôe
(0x8a, (
	`™Æog_ªad
(0x8aË& 0xc0Ë| 
ˇp
);

381 
	}
}

388 
ölöe
 
	$tx_£âÀ_adju°
(
tx°l_us
)

390 
	`REG_ADDR16
(0xf04Ë
tx°l_us
;

391 
	}
}

398 
ölöe
 
	$rf_£t_tx_pùe
(
pùe
)

400 
	`wrôe_ªg8
(0xf15, 0xf0 | 
pùe
);

401 
	}
}

409 
rf_drv_öô
(
RF_ModeTy≥Def
 
rf_mode
);

416 
rf_£t_powî_Àvñ
(
RF_PowîTy≥Def
 
Àvñ
);

423 
rf_£t_powî_Àvñ_ödex
(
RF_PowîIndexTy≥Def
 
Àvñ_idx
);

431 
rf_£t_ch™√l
(sig√d 
chn
, 
£t
);

439 
rf_åx_°©e_£t
(
RF_SètusTy≥Def
 
rf_°©us
, sig√d 
rf_ch™√l
);

446 
RF_SètusTy≥Def
 
rf_åx_°©e_gë
();

454 
rf_°¨t_°x
(*
addr
, 
tick
);

461 
rf_°¨t_§x
(
tick
);

468 
rf_tx_pkt
(*
rf_txaddr
);

487 
rf_rx_buf„r_£t
(*
RF_RxAddr
, 
size
, 
Pögp⁄gEn
);

495 
rf_rx_cfg
(
size
, 
Pögp⁄gEn
);

501 
rf_≤_dißbÀ
();

	@platform/chip_8278/spi.h

24 #i‚de‡
SPI_H


25 
	#SPI_H


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

38 
	mSPI_GPIO_SCL_A4
=
GPIO_PA4
,

39 
	mSPI_GPIO_SCL_D7
=
GPIO_PD7
,

40 }
	tSPI_GPIO_S˛kTy≥Def
;

43 
	mSPI_GPIO_SDO_A2
=
GPIO_PA2
,

44 
	mSPI_GPIO_SDO_B7
=
GPIO_PB7
,

45 }
	tSPI_GPIO_SdoTy≥Def
;

48 
	mSPI_GPIO_SDI_A3
=
GPIO_PA3
,

49 
	mSPI_GPIO_SDI_B6
=
GPIO_PB6
,

50 }
	tSPI_GPIO_SdiTy≥Def
;

53 
	mSPI_GPIO_CS_D2
=
GPIO_PD2
,

54 
	mSPI_GPIO_CS_D6
=
GPIO_PD6
,

55 }
	tSPI_GPIO_CsTy≥Def
;

62 
	mSPI_MODE0
 = 0,

63 
	mSPI_MODE2
,

64 
	mSPI_MODE1
,

65 
	mSPI_MODE3
,

66 } 
	tSPI_ModeTy≥Def
;

72 
	mSPI_CLK_200K
 = 0x3c,

73 
	mSPI_CLK_250K
 = 0x2e,

74 
	mSPI_CLK_500K
 = 0x17,

75 
	mSPI_CLK_1M
 = 0x0b,

76 
	mSPI_CLK_2M
 = 0x05,

77 
	mSPI_CLK_4M
 = 0x02,

78 } 
	tSPI_24M_ClkTy≥Def
;

86 
ölöe
 
	$ª£t_•i_moudÀ
()

88 
ªg_r°0
 |
FLD_RST0_SPI
;

89 
ªg_r°0
 &(~
FLD_RST0_SPI
);

90 
	}
}

108 
•i_ma°î_gpio_£t
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
);

126 
•i_¶ave_gpio_£t
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
);

133 
•i_ma°îCSpö_£À˘
(
GPIO_PöTy≥Def
 
CSPö
);

149 
•i_ma°î_öô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

158 
•i_¶ave_öô
(
DivClock
, 
SPI_ModeTy≥Def
 
Mode
);

171 
•i_wrôe
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

184 
•i_ªad
(*
Cmd
, 
CmdLí
, *
D©a
, 
D©aLí
, 
GPIO_PöTy≥Def
 
CSPö
);

191 
•i_£t_sh¨e_mode_í
();

	@platform/chip_8278/spi_i.h

24 #¥agm®
⁄˚


26 
	~"ªgi°î.h
"

27 
	~"compûî.h
"

34 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_waô
(){

35 
ªg_m•i_˘æ
 & 
FLD_MSPI_BUSY
)

37 
	}
}

44 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_high
(){

45 
ªg_m•i_˘æ
 = 
FLD_MSPI_CS
;

46 
	}
}

53 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_low
(){

54 
ªg_m•i_˘æ
 = 0;

55 
	}
}

62 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_gë
(){

63  
ªg_m•i_d©a
;

64 
	}
}

71 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_wrôe
(
c
){

72 
ªg_m•i_d©a
 = 
c
;

73 
	}
}

80 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_˘æ_wrôe
(
c
){

81 
ªg_m•i_˘æ
 = 
c
;

82 
	}
}

89 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_ªad
(){

90 
	`m•i_wrôe
(0);

91 
	`m•i_waô
();

92  
	`m•i_gë
();

93 
	}
}

	@platform/chip_8278/timer.h

24 #i‚de‡
TIMER_H_


25 
	#TIMER_H_


	)

27 
	~"ªgi°î.h
"

28 
	~"gpio.h
"

34 
	mTIMER0
 =0,

35 
	mTIMER1
 =1,

36 
	mTIMER2
 =2,

37 }
	tTIMER_Ty≥Def
;

43 
	mTIMER_MODE_SYSCLK
 =0,

44 
	mTIMER_MODE_GPIO_TRIGGER
 =1,

45 
	mTIMER_MODE_GPIO_WIDTH
 =2,

46 
	mTIMER_MODE_TICK
 =3,

47 }
	tTIMER_ModeTy≥Def
;

49 
	#sys_tick_≥r_us
 16

	)

50 
	#CLOCK_SYS_CLOCK_1250US
 (1250 * 
sys_tick_≥r_us
)

	)

56 
	mCLOCK_16M_SYS_TIMER_CLK_1S
 = 16*1000*1000,

57 
	mCLOCK_16M_SYS_TIMER_CLK_1MS
 = 16*1000,

58 
	mCLOCK_16M_SYS_TIMER_CLK_1US
 = 16,

66 
ölöe
 
	$˛ock_time
()

68  
ªg_sy°em_tick
;

69 
	}
}

77 
ölöe
 
	$˛ock_time_ex˚ed
(
ªf
, 
us
)

79  (()(
	`˛ock_time
(Ë- 
ªf
Ë> 
us
 * 16);

80 
	}
}

88 
ölöe
 
	$timî_£t_öô_tick
(
TIMER_Ty≥Def
 
ty≥
, 
öô_tick
)

90 
	`ªg_tmr_tick
(
ty≥
Ë
öô_tick
;

91 
	}
}

99 
ölöe
 
	$timî_£t_ˇp_tick
(
TIMER_Ty≥Def
 
ty≥
, 
ˇp_tick
)

101 
	`ªg_tmr_ˇ±
(
ty≥
Ë
ˇp_tick
;

102 
	}
}

109 
ölöe
 
	$timî_úq_íabÀ
(
TIMER_Ty≥Def
 
ty≥
)

111 
ªg_úq_mask
 |(1 << 
ty≥
);

112 
	}
}

119 
ölöe
 
	$°imî_úq_íabÀ
()

121 
ªg_sy°em_úq_mask
 |
FLD_SYSTEM_TIMER_AUTO_EN
;

122 
	}
}

129 
ölöe
 
	$°imî_£t_úq_ˇ±uª
(
tick
)

133 
ªg_sy°em_tick_úq_Àvñ
 = (
tick
 & (~(()0x07)));

134 
	}
}

141 
ölöe
 
	$°imî_£t_úq_mask
()

143 
ªg_úq_mask
 |
FLD_IRQ_SYSTEM_TIMER
;

144 
	}
}

151 
ölöe
 
	$°imî_˛r_úq_mask
()

153 
ªg_úq_mask
 &~()
FLD_IRQ_SYSTEM_TIMER
;

154 
	}
}

162 
timî_£t_mode
(
TIMER_Ty≥Def
 
ty≥
, 
TIMER_ModeTy≥Def
 
mode
);

171 
timî_gpio_öô
(
TIMER_Ty≥Def
 
ty≥
, 
GPIO_PöTy≥Def
 
pö
, 
GPIO_PﬁTy≥Def
 
pﬁ
);

178 
timî_°¨t
(
TIMER_Ty≥Def
 
ty≥
);

185 
timî_°›
(
TIMER_Ty≥Def
 
ty≥
);

192 
¶ìp_us
(
us
);

194 
	#ClockTime
 
˛ock_time


	)

195 
	#WaôUs
 
¶ìp_us


	)

196 
	#WaôMs
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

197 
	#¶ìp_ms
(
t
Ë
	`¶ìp_us
(—)*1000)

	)

	@platform/chip_8278/uart.h

24 #i‚de‡
UART_H


25 
	#UART_H


	)

27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

29 
	~"gpio.h
"

37 
	mUART_BW_MUL1
 = 0,

38 
	mUART_BW_MUL2
 = 1,

39 
	mUART_BW_MUL3
 = 2,

40 
	mUART_BW_MUL4
 = 3,

47 
	mPARITY_NONE
 = 0,

48 
	mPARITY_EVEN
,

49 
	mPARITY_ODD
,

50 } 
	tUART_P¨ôyTy≥Def
;

56 
	mSTOP_BIT_ONE
 = 0,

57 
	mSTOP_BIT_ONE_DOT_FIVE
 = 
BIT
(4),

58 
	mSTOP_BIT_TWO
 = 
BIT
(5),

59 } 
	tUART_St›BôTy≥Def
;

65 
	mUART_RTS_MODE_AUTO
 = 0,

66 
	mUART_RTS_MODE_MANUAL
,

67 } 
	tUART_RTSModeTy≥Def
;

73 
	mUART_TX_PA2
 = 
GPIO_PA2
,

74 
	mUART_TX_PB1
 = 
GPIO_PB1
,

75 
	mUART_TX_PC2
 = 
GPIO_PC2
,

76 
	mUART_TX_PD0
 = 
GPIO_PD0
,

77 
	mUART_TX_PD3
 = 
GPIO_PD3
,

78 
	mUART_TX_PD7
 = 
GPIO_PD7
,

79 }
	tUART_TxPöDef
;

85 
	mUART_RX_PA0
 = 
GPIO_PA0
,

86 
	mUART_RX_PB0
 = 
GPIO_PB0
,

87 
	mUART_RX_PB7
 = 
GPIO_PB7
,

88 
	mUART_RX_PC3
 = 
GPIO_PC3
,

89 
	mUART_RX_PC5
 = 
GPIO_PC5
,

90 
	mUART_RX_PD6
 = 
GPIO_PD6
,

91 }
	tUART_RxPöDef
;

97 
	mUART_CTS_PA3
 = 
GPIO_PA3
,

98 
	mUART_CTS_PB2
 = 
GPIO_PB2
,

99 
	mUART_CTS_PC4
 = 
GPIO_PC4
,

100 
	mUART_CTS_PD1
 = 
GPIO_PD1
,

101 }
	tUART_CtsPöDef
;

107 
	mUART_RTS_PA4
 = 
GPIO_PA4
,

108 
	mUART_RTS_PB3
 = 
GPIO_PB3
,

109 
	mUART_RTS_PB6
 = 
GPIO_PB6
,

110 
	mUART_RTS_PC0
 = 
GPIO_PC0
,

111 }
	tUART_RtsPöDef
;

120 
ölöe
 
	$u¨t_tx_is_busy
()

122  ( (
ªg_u¨t_°©us1
 & 
FLD_UART_TX_DONE
) ? 0 : 1) ;

123 
	}
}

130 
ölöe
 
	$u¨t_ª£t
()

132 
ªg_r°0
 |
FLD_RST0_UART
;

133 
ªg_r°0
 &(~
FLD_RST0_UART
);

134 
	}
}

164 
u¨t_öô
(
g_u¨t_div
, 
g_bwpc
, 
UART_P¨ôyTy≥Def
 
P¨ôy
, 
UART_St›BôTy≥Def
 
St›Bô
);

174 
u¨t_öô_baudøã
(
Baudøã
, 
Sy°em_˛ock
 , 
UART_P¨ôyTy≥Def
 
P¨ôy
, 
UART_St›BôTy≥Def
 
St›Bô
);

182 
u¨t_dma_íabÀ
(
rx_dma_í
, 
tx_dma_í
);

190 
u¨t_úq_íabÀ
(
rx_úq_í
, 
tx_úq_í
);

193 
u¨t_TxIndex
;

203 
u¨t_ndma_£nd_byã
(
u¨tD©a
);

211 
ölöe
 
	$u¨t_ndma_˛ór_tx_ödex
()

213 
u¨t_TxIndex
=0;

214 
	}
}

226 
u¨t_ndma_úq_åigÀvñ
(
rx_Àvñ
, 
tx_Àvñ
);

235 
u¨t_ndmaúq_gë
();

244 
u¨t_dma_£nd
(* 
Addr
);

253 
u¨t_£nd_byã
(
byã
);

262 
u¨t_ªcbuff_öô
(*
RecvAddr
, 
RecvBufLí
);

270 
u¨t_is_∑rôy_îr‹
();

284 
u¨t_˛ór_∑rôy_îr‹
();

296 
u¨t_£t_πs
(
E«bÀ
, 
UART_RTSModeTy≥Def
 
Mode
, 
Thªsh
, 
Invît
, 
UART_RtsPöDef
 
pö
);

303 
u¨t_£t_πs_Àvñ
(
Pﬁ¨ôy
);

312 
u¨t_£t_˘s
(
E«bÀ
, 
Sñe˘
, 
UART_CtsPöDef
 
pö
);

320 
u¨t_gpio_£t
(
UART_TxPöDef
 
tx_pö
, 
UART_RxPöDef
 
rx_pö
);

327 
u¨t_mask_îr‹_úq_íabÀ
();

	@platform/chip_8278/usbhw.h

24 #i‚de‡
USBHW_H


25 
	#USBHW_H


	)

27 
	~"bô.h
"

28 
	~"™Æog.h
"

29 
	~"usbhw_i.h
"

30 
	~"gpio.h
"

33 
	mUSB_EDP_PRINTER_IN
 = 8,

34 
	mUSB_EDP_MOUSE
 = 2,

35 
	mUSB_EDP_KEYBOARD_IN
 = 1,

36 
	mUSB_EDP_KEYBOARD_OUT
 = 3,

37 
	mUSB_EDP_AUDIO_IN
 = 4,

38 
	mUSB_EDP_PRINTER_OUT
 = 5,

39 
	mUSB_EDP_SPEAKER
 = 6,

40 
	mUSB_EDP_MIC
 = 7,

41 #if(
USB_GAMEPAD_ENABLE
)

42 
	mUSB_EDP_GAMEPAD_IN
 = 3,

43 
	mUSB_EDP_GAMEPAD_OUT
 = 5,

45 
	mUSB_EDP_MS_IN
 = 
USB_EDP_PRINTER_IN
,

46 
	mUSB_EDP_MS_OUT
 = 
USB_EDP_PRINTER_OUT
,

47 
	mUSB_EDP_SOMATIC_IN
 = 
USB_EDP_AUDIO_IN
,

48 
	mUSB_EDP_SOMATIC_OUT
 = 
USB_EDP_PRINTER_OUT
,

49 
	mUSB_EDP_CDC_IN
 = 4,

50 
	mUSB_EDP_CDC_OUT
 = 5,

55 
	mUSB_HID_AUDIO
 = 2,

56 
	mUSB_HID_MOUSE
 = 1,

57 
	mUSB_HID_KB_MEDIA
 = 3,

58 
	mUSB_HID_KB_SYS
 = 4,

59 #if(
USB_GAMEPAD_ENABLE
)

60 
	mUSB_HID_GAMEPAD
 = 5,

62 
	mUSB_HID_SOMATIC
 = 5,

71 
ölöe
 
	$usb_dp_puŒup_í
(
í
)

73 
d©
 = 
	`™Æog_ªad
(0x0b);

74 if(
í
){

75 
d©
 = d© | 
	`BIT
(7);

77 
d©
 = dat & 0x7f ;

80 
	`™Æog_wrôe
(0x0b, 
d©
);

81 
	}
}

88 
ölöe
 
	$usb_powî_⁄
(
í
){

89 if(
í
){

90 
	`™Æog_wrôe
(0x34, 
	`™Æog_ªad
(0x34) & 0xfd);

92 
	`™Æog_wrôe
(0x34, 
	`™Æog_ªad
(0x34) | 0x02);

94 
	}
}

101 
ölöe
 
	$usb_£t_pö_í
()

104 
	`gpio_£t_func
(
GPIO_PA6
, 
AS_GPIO
);

105 
	`gpio_£t_ouçut_í
(
GPIO_PA6
, 1);

106 
	`gpio_wrôe
(
GPIO_PA6
, 0);

108 
	`gpio_£t_func
(
GPIO_PA5
, 
AS_USB
);

109 
	`gpio_£t_func
(
GPIO_PA6
, 
AS_USB
);

110 
	`usb_dp_puŒup_í
(1);

111 
	}
}

119 
usbhw_dißbÀ_m™uÆ_öãºu±
(
m
);

126 
usbhw_íabÀ_m™uÆ_öãºu±
(
m
);

135 
usbhw_wrôe_ï
(
ï
, * 
d©a
, 
Àn
);

143 
usbhw_wrôe_˘æ_ï_u16
(
v
);

150 
usbhw_ªad_˘æ_ï_u16
();

	@platform/chip_8278/usbhw_i.h

24 #i‚de‡
USBHW_I_H


25 
	#USBHW_I_H


	)

27 
	~"ªgi°î.h
"

34 
ölöe
 
	$usbhw_ª£t_˘æ_ï_±r
() {

35 
ªg_˘æ_ï_±r
 = 0;

36 
	}
}

43 
ölöe
 
	$usbhw_gë_˘æ_ï_úq
() {

44  
ªg_˘æ_ï_úq_°a
;

45 
	}
}

52 
ölöe
 
	$usbhw_˛r_˘æ_ï_úq
(
ï
) {

53 
ªg_˘æ_ï_úq_°a
 = 
ï
;

54 
	}
}

61 
ölöe
 
	$usbhw_wrôe_˘æ_ï_˘æ
(
d©a
) {

62 
ªg_˘æ_ï_˘æ
 = 
d©a
;

63 
	}
}

70 
ölöe
 
	$usbhw_ªad_˘æ_ï_d©a
() {

71  
ªg_˘æ_ï_d©
;

72 
	}
}

79 
ölöe
 
	$usbhw_wrôe_˘æ_ï_d©a
(
d©a
) {

80 
ªg_˘æ_ï_d©
 = 
d©a
;

81 
	}
}

88 
ölöe
 
	$usbhw_is_˘æ_ï_busy
() {

89  
ªg_˘æ_ï_úq_°a
 & 
FLD_USB_EP_BUSY
;

90 
	}
}

97 
ölöe
 
	$usbhw_ª£t_ï_±r
(
ï
) {

98 
	`ªg_usb_ï_±r
(
ï
 & 0x07) = 0;

99 
	}
}

105 
ölöe
 
	$usbhw_£t_ïs_úq_mask
(
mask
){

106 
ªg_usb_mask
|=
mask
;

107 
	}
}

113 
ölöe
 
	$usbhw_˛r_ïs_úq_mask
(
mask
){

114 
ªg_usb_mask
 &=(~
mask
);

115 
	}
}

122 
ölöe
 
	$usbhw_gë_ïs_úq
() {

123  
ªg_usb_úq
;

124 
	}
}

131 
ölöe
 
	$usbhw_˛r_ïs_úq
(
ï
) {

132 
ªg_usb_úq
 = 
ï
;

133 
	}
}

140 
ölöe
 
	$usbhw_ªad_ï_d©a
(
ï
) {

141  
	`ªg_usb_ï_d©
(
ï
 & 0x07);

142 
	}
}

149 
ölöe
 
	$usbhw_wrôe_ï_d©a
(
ï
, 
d©a
) {

150 
	`ªg_usb_ï_d©
(
ï
 & 0x07Ë
d©a
;

151 
	}
}

158 
ölöe
 
	$usbhw_is_ï_busy
(
ï
) {

159  
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë& 
FLD_USB_EP_BUSY
;

160 
	}
}

167 
ölöe
 
	$usbhw_d©a_ï_ack
(
ï
) {

168 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_BUSY
;

169 
	}
}

176 
ölöe
 
	$usbhw_d©a_ï_°Æl
(
ï
) {

177 
	`ªg_usb_ï_˘æ
(
ï
 & 0x07Ë
FLD_USB_EP_STALL
;

178 
	}
}

185 
ölöe
 
	$usbhw_£t_¥öãr_thªshﬁd
(
th
) {

186 
ªg_usb_ï8_£nd_thª
 = 
th
;

187 
	}
}

193 
ölöe
 
	$usbhw_£t_ï8_fifo_mode
() {

194 
ªg_usb_ï8_fifo_mode
 |
FLD_USB_ENP8_FIFO_MODE
;

195 
	}
}

	@platform/chip_8278/watchdog.h

24 #¥agm®
⁄˚


27 
	~"ªgi°î.h
"

28 
	~"bô.h
"

36 
ölöe
 
	$wd_£t_öãrvÆ_ms
(
≥riod_ms
)

38 
tmp_≥riod_ms
 = 0;

39 
tmp_≥riod_ms
 = (
≥riod_ms
*1000*
sy°em_˛k_mHz
>>18);

40 
ªg_tmr2_tick
 = 0x00000000;

41 
ªg_tmr_˘æ
 &(~
FLD_TMR_WD_CAPT
);

42 
ªg_tmr_˘æ
 |(
tmp_≥riod_ms
<<9);

43 
	}
}

50 
ölöe
 
	$wd_°¨t
(){

51 
	`BM_SET
(
ªg_tmr_˘æ
, 
FLD_TMR2_EN
);

52 
	`BM_SET
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

53 
	}
}

60 
ölöe
 
	$wd_°›
(){

61 
	`BM_CLR
(
ªg_tmr_˘æ
, 
FLD_TMR_WD_EN
);

62 
	}
}

69 
ölöe
 
	$wd_˛ór
()

71 
ªg_tmr_°a
 = 
FLD_TMR_STA_WD
;

72 
	}
}

	@platform/chip_b91/adc.h

34 #¥agm®
⁄˚


37 
	~"dma.h
"

38 
	~"compûî.h
"

39 
	~"gpio.h
"

40 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

43 
	mADC_VREF_0P9V
 = 0x01,

44 
	mADC_VREF_1P2V
 = 0x02,

45 }
	tadc_ªf_vﬁ_e
;

47 
	mADC_VBAT_DIV_OFF
 = 0,

48 
	mADC_VBAT_DIV_1F3
 = 0x02,

49 }
	tadc_vb©_div_e
;

52 
	mNOINPUTN
 = 0,

53 
	mADC_GPIO_PB0N
 = 0x01,

54 
	mADC_GPIO_PB1N
 = 0x02,

55 
	mADC_GPIO_PB2N
 = 0x03,

56 
	mADC_GPIO_PB3N
 = 0x04,

57 
	mADC_GPIO_PB4N
 = 0x05,

58 
	mADC_GPIO_PB5N
 = 0x06,

59 
	mADC_GPIO_PB6N
 = 0x07,

60 
	mADC_GPIO_PB7N
 = 0x08,

61 
	mADC_GPIO_PD0N
 = 0x09,

62 
	mADC_GPIO_PD1N
 = 0x0a,

63 
	mADC_TEMSENSORN_EE
 = 0x0e,

64 
	mGND
 = 0x0f,

65 }
	tadc_öput_nch_e
;

67 
	mNOINPUTP
 = 0,

68 
	mADC_GPIO_PB0P
 = 0x01,

69 
	mADC_GPIO_PB1P
 = 0x02,

70 
	mADC_GPIO_PB2P
 = 0x03,

71 
	mADC_GPIO_PB3P
 = 0x04,

72 
	mADC_GPIO_PB4P
 = 0x05,

73 
	mADC_GPIO_PB5P
 = 0x06,

74 
	mADC_GPIO_PB6P
 = 0x07,

75 
	mADC_GPIO_PB7P
 = 0x08,

76 
	mADC_GPIO_PD0P
 = 0x09,

77 
	mADC_GPIO_PD1P
 = 0x0a,

78 
	mADC_TEMSENSORP_EE
 = 0x0e,

79 
	mADC_VBAT
 = 0x0f,

80 }
	tadc_öput_pch_e
;

89 
	mADC_GPIO_PB0
 = 
GPIO_PB0
 | (0x1<<12),

90 
	mADC_GPIO_PB1
 = 
GPIO_PB1
 | (0x2<<12),

91 
	mADC_GPIO_PB2
 = 
GPIO_PB2
 | (0x3<<12),

92 
	mADC_GPIO_PB3
 = 
GPIO_PB3
 | (0x4<<12),

93 
	mADC_GPIO_PB4
 = 
GPIO_PB4
 | (0x5<<12),

94 
	mADC_GPIO_PB5
 = 
GPIO_PB5
 | (0x6<<12),

95 
	mADC_GPIO_PB6
 = 
GPIO_PB6
 | (0x7<<12),

96 
	mADC_GPIO_PB7
 = 
GPIO_PB7
 | (0x8<<12),

97 
	mADC_GPIO_PD0
 = 
GPIO_PD0
 | (0x9<<12),

98 
	mADC_GPIO_PD1
 = 
GPIO_PD1
 | (0xa<<12),

99 }
	tadc_öput_pö_def_e
;

101 
	mADC_GPIO_MODE
,

102 
	mADC_VBAT_MODE
,

103 }
	tadc_öput_pö_mode_e
;

106 
	mADC_RES8
 = 0,

107 
	mADC_RES10
 = 0x01,

108 
	mADC_RES12
 = 0x02,

109 
	mADC_RES14
 = 0x03,

110 }
	tadc_ªs_e
;

113 
	mADC_SAMPLE_CYC_3
,

114 
	mADC_SAMPLE_CYC_6
,

115 
	mADC_SAMPLE_CYC_9
,

116 
	mADC_SAMPLE_CYC_12
,

117 
	mADC_SAMPLE_CYC_15
,

118 
	mADC_SAMPLE_CYC_18
,

119 
	mADC_SAMPLE_CYC_21
,

120 
	mADC_SAMPLE_CYC_24
,

121 
	mADC_SAMPLE_CYC_27
,

122 
	mADC_SAMPLE_CYC_30
,

123 
	mADC_SAMPLE_CYC_33
,

124 
	mADC_SAMPLE_CYC_36
,

125 
	mADC_SAMPLE_CYC_39
,

126 
	mADC_SAMPLE_CYC_42
,

127 
	mADC_SAMPLE_CYC_45
,

128 
	mADC_SAMPLE_CYC_48
,

129 }
	tadc_ßm∂e_cy˛e_e
;

132 
	mADC_SAMPLE_FREQ_23K
,

133 
	mADC_SAMPLE_FREQ_48K
,

134 
	mADC_SAMPLE_FREQ_96K
,

135 }
	tadc_ßm∂e_‰eq_e
;

138 
	mADC_MISC_CHN
 = 
BIT
(2),

139 }
	tadc_chn_e
;

142 
	mADC_PRESCALE_1
 = 0x00,

144 
	mADC_PRESCALE_1F4
 = 0x02,

146 }
	tadc_¥e_sˇÀ_e
;

148 
	mADC_MAX_STATE_NUM
 = 0x02,

155 
ölöe
 
	$adc_powî_⁄
()

157 
	`™Æog_wrôe_ªg8
 (
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad_ªg8
◊ªg_adc_pga_˘æ)&(~
FLD_SAR_ADC_POWER_DOWN
)));

158 
	}
}

163 
ölöe
 
	$adc_powî_off
()

165 
	`™Æog_wrôe_ªg8
 (
¨eg_adc_pga_˘æ
, (
	`™Æog_ªad_ªg8
◊ªg_adc_pga_˘æ)|
FLD_SAR_ADC_POWER_DOWN
));

166 
	}
}

171 
ölöe
 
	$adc_ª£t
()

173 
ªg_r°3
 &(~
FLD_RST3_SARADC
 );

174 
ªg_r°3
 |=
FLD_RST3_SARADC
;

175 
	}
}

180 
ölöe
 
	$adc_fifo_íabÀ
()

182 
ªg_i2s_cfg2
 &(~
FLD_AUDIO_FIFO1_RST
);

183 
	}
}

188 
ölöe
 
	$adc_fifo_dißbÀ
()

190 
ªg_i2s_cfg2
 |
FLD_AUDIO_FIFO1_RST
;

191 
	}
}

196 
ölöe
 
	$adc_˛k_í
()

198 
	`™Æog_wrôe_ªg8
(
¨eg_adc_˛k_£âög
 , 
	`™Æog_ªad_ªg8
◊ªg_adc_˛k_£âög ) | 
FLD_CLK_24M_TO_SAR_EN
);

199 
	}
}

204 
ölöe
 
	$adc_˛k_dis
()

206 
	`™Æog_wrôe_ªg8
(
¨eg_adc_˛k_£âög
 , 
	`™Æog_ªad_ªg8
◊ªg_adc_˛k_£âög ) & (~
FLD_CLK_24M_TO_SAR_EN
));

207 
	}
}

213 
ölöe
 
	$adc_£t_˛k
(
div
)

215 
	`™Æog_wrôe_ªg8
(
¨eg_adc_ßm∂e_˛k_div
, 
div
);

216 
	}
}

221 
ölöe
 
	$adc_£t_m_chn_í
()

223 
	`™Æog_wrôe_ªg8
(
¨eg_adc_chn_í
, 
FLD_ADC_CHN_EN_M
 | (
ADC_MAX_STATE_NUM
<<4) );

224 
	}
}

230 
ölöe
 
	$adc_£t_ªsﬁuti⁄
(
adc_ªs_e
 
ªs
)

232 
	`™Æog_wrôe_ªg8
(
¨eg_adc_ªs_m
, (
	`™Æog_ªad_ªg8
◊ªg_adc_ªs_m)&(~
FLD_ADC_RES_M
)Ë| 
ªs
);

233 
	}
}

240 
ölöe
 
	$adc_£t_tßm∂e_cy˛e
(
adc_ßm∂e_cy˛e_e
 
ßm∂e_cy˛e
)

243 
	`™Æog_wrôe_ªg8
(
¨eg_adc_tsm≠À_m
, 
ßm∂e_cy˛e
);

244 
	}
}

249 
ölöe
 
	$adc_ãmp_£ns‹_powî_⁄
()

251 
	`™Æog_wrôe_ªg8
(
¨eg_ãmp_£ns‹_˘æ
, (
	`™Æog_ªad_ªg8
◊ªg_ãmp_£ns‹_˘æ)&(~
FLD_TEMP_SENSOR_POWER_DOWN
)));

252 
	}
}

257 
ölöe
 
	$adc_ãmp_£ns‹_powî_off
()

259 
	`™Æog_wrôe_ªg8
(
¨eg_ãmp_£ns‹_˘æ
, (
	`™Æog_ªad_ªg8
◊ªg_ãmp_£ns‹_˘æ)|
FLD_TEMP_SENSOR_POWER_DOWN
));

260 
	}
}

267 
ölöe
 
	$adc_£t_diff_öput
(
adc_öput_pch_e
 
p_aö
, 
adc_öput_nch_e
 
n_aö
)

269 
	`™Æog_wrôe_ªg8
(
¨eg_adc_ªs_m
, 
	`™Æog_ªad_ªg8
◊ªg_adc_ªs_mË| 
FLD_ADC_EN_DIFF_CHN_M
);

270 
	`™Æog_wrôe_ªg8
(
¨eg_adc_aö_chn_misc
, 
n_aö
 | 
p_aö
<<4 );

271 
	}
}

278 
ölöe
 
	$adc_£t_°©e_Àngth
(
r_max_mc
,
r_max_s
)

280 
	`™Æog_wrôe_ªg8
(
¨eg_r_max_mc
, 
r_max_mc
);

281 
	`™Æog_wrôe_ªg8
(
¨eg_r_max_s
, ((
r_max_mc
>>8)<<6)| (
r_max_s
 & 
FLD_R_MAX_S
));

282 
	}
}

288 
adc_£t_dma_c⁄fig
(
dma_chn_e
 
chn
);

295 
adc_°¨t_ßm∂e_dma
(*
adc_d©a_buf
,
d©a_byã_Àn
);

302 
adc_pö_c⁄fig
(
adc_öput_pö_mode_e
 
mode
 ,
adc_öput_pö_def_e
 
pö
);

309 
adc_£t_diff_pö
(
adc_öput_pö_def_e
 
p_pö
,ádc_öput_pö_def_ê
n_pö
);

315 
adc_£t_ªf_vﬁège
(
adc_ªf_vﬁ_e
 
v_ªf
);

321 
adc_£t_ßm∂e_øã
(
adc_ßm∂e_‰eq_e
 
ßm∂e_‰eq
);

327 
adc_£t_sˇÀ_Á˘‹
(
adc_¥e_sˇÀ_e
 
¥e_sˇÀ
);

335 
adc_ãm≥øtuª_ßm∂e_öô
();

346 
adc_gpio_ßm∂e_öô
(
adc_öput_pö_def_e
 
pö
,
adc_ªf_vﬁ_e
 
v_ªf
,
adc_¥e_sˇÀ_e
 
¥e_sˇÀ
,
adc_ßm∂e_‰eq_e
 
ßm∂e_‰eq
);

362 
adc_b©ãry_vﬁège_ßm∂e_öô
();

368 
adc_£t_vb©_dividî
(
adc_vb©_div_e
 
vb©_div
);

379 
adc_öô
(
adc_ªf_vﬁ_e
 
v_ªf
,
adc_¥e_sˇÀ_e
 
¥e_sˇÀ
,
adc_ßm∂e_‰eq_e
 
ßm∂e_‰eq
);

386 
adc_gë_code_dma
(*
ßm∂e_buf„r
, 
ßm∂e_num
);

391 
adc_gë_code
();

397 
adc_ˇlcuœã_vﬁège
(
adc_code
);

405 
adc_ˇlcuœã_ãm≥øtuª
(
adc_code
);

	@platform/chip_b91/aes.h

34 #i‚de‡
_AES_H_


35 
	#_AES_H_


	)

37 
	~"compûî.h
"

38 
	~"ªg_ö˛ude/´s_ªg.h
"

55 
	mAES_ENCRYPT_MODE
 = 0,

56 
	mAES_DECRYPT_MODE
 = 2,

57 }
	t´s_mode_e
;

71 
´s_í¸y±
(*
key
, * 
∂aöãxt
, *
ªsu…
);

80 
´s_de¸y±
(*
key
, * 
de¸y±ãxt
, *
ªsu…
);

87 
´s_£t_em_ba£_addr
(
addr
);

96 
´s_£t_key_d©a
(*
key
, * 
d©a
);

103 
´s_gë_ªsu…
(*
ªsu…
);

110 
ölöe
 
	$´s_£t_mode
(
´s_mode_e
 
mode
)

112 
ªg_´s_mode
 = (
FLD_AES_START
 | 
mode
);

113 
	}
}

120 
ölöe
 
	$´s_£t_úq_mask
(
´s_úq_e
 
mask
)

122 
ªg_´s_úq_mask
 |
mask
;

123 
	}
}

130 
ölöe
 
	$´s_˛r_úq_mask
(
´s_úq_e
 
mask
)

132 
ªg_´s_úq_mask
 &(~
mask
);

133 
	}
}

140 
ölöe
 
	$´s_gë_úq_°©us
(
´s_úq_e
 
°©us
)

142  (
ªg_´s_úq_°©us
 & 
°©us
);

143 
	}
}

150 
ölöe
 
	$´s_˛r_úq_°©us
(
´s_úq_e
 
°©us
)

152 
ªg_´s_˛r_úq_°©us
 = (
°©us
);

153 
	}
}

	@platform/chip_b91/analog.h

35 #¥agm®
⁄˚


38 
	~"dma.h
"

39 
	~"compûî.h
"

40 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

66 
_©åibuã_øm_code_£c_noölöe_
 
™Æog_ªad_ªg8
(
addr
);

74 
_©åibuã_øm_code_£c_noölöe_
 
™Æog_wrôe_ªg8
(
addr
, 
d©a
);

81 
™Æog_ªad_ªg16
(
addr
);

89 
™Æog_wrôe_ªg16
(
addr
, 
d©a
);

96 
™Æog_ªad_ªg32
(
addr
);

104 
™Æog_wrôe_ªg32
(
addr
, 
d©a
);

112 
_©åibuã_øm_code_£c_noölöe_
 
™Æog_ªad_buff
(
addr
, *
buff
, 
Àn
);

121 
_©åibuã_øm_code_£c_noölöe_
 
™Æog_wrôe_buff
(
addr
, *
buff
, 
Àn
);

131 
™Æog_wrôe_ªg32_dma
(
dma_chn_e
 
chn
, 
addr
, *
pd©
);

140 
™Æog_ªad_ªg32_dma
(
dma_chn_e
 
chn
, 
addr
,*
pd©
);

150 
™Æog_wrôe_buff_dma
(
dma_chn_e
 
chn
, 
addr
, *
pd©
, 
Àn
);

165 
™Æog_ªad_buff_dma
(
dma_chn_e
 
chn
, 
addr
, *
pd©
, 
Àn
);

185 
™Æog_wrôe_addr_d©a_dma
(
dma_chn_e
 
chn
, *
pd©
, 
Àn
);

	@platform/chip_b91/audio.h

34 #i‚de‡
audio_H


35 
	#audio_H


	)

37 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

38 
	~"i2c.h
"

39 
	~"pwm.h
"

40 
	~"compûî.h
"

43 
	mI2S_BCK_PC3
 = 
GPIO_PC3
,

44 
	mI2S_ADC_LR_PC4
 = 
GPIO_PC4
,

45 
	mI2S_ADC_DAT_PC5
 = 
GPIO_PC5
,

46 
	mI2S_DAC_LR_PC6
 = 
GPIO_PC6
,

47 
	mI2S_DAC_DAT_PC7
 = 
GPIO_PC7
,

48 }
	ti2s_pö_e
;

52 
	mDMIC_B2_DAT_B3_CLK
,

53 
	mDMIC_C1_DAT_C2_CLK
,

54 
	mDMIC_D4_DAT_D5_CLK
,

55 
	mDMIC_GROUPB_B2_DAT_B3_B4_CLK
,

56 
	mDMIC_GROUPC_C1_DAT_C2_C3_CLK
,

57 
	mDMIC_GROUPD_D4_DAT_D5_D6_CLK
,

58 }
	tdmic_pö_group_e
;

62 
	mMIC_MODE
,

63 
	mSPK_MODE
,

64 
	mLOOP_MODE
,

65 }
	taudio_lo›_mode_e
;

69 
	mCODEC_I2S
 ,

70 
	mIO_CODEC
 ,

71 
	mIO_I2S
,

72 }
	taudio_Êow_e
;

76 
	mI2S_RJ_MODE
 ,

77 
	mI2S_LJ_MODE
 ,

78 
	mI2S_I2S_MODE
,

79 
	mI2S_DSP_MODE
,

80 }
	ti2s_mode_£À˘_e
;

83 
	mCODEC_PARALLEL_MODE
 ,

84 
	mCODEC_LJ_MODE
 ,

85 
	mCODEC_DSP_MODE
,

86 
	mCODEC_I2S_MODE
,

87 }
	tcodec_mode_£À˘_e
;

91 
	mCODEC_ITF_AC
,

92 
	mCODEC_ITF_PD
,

93 }
	tcodec_öãrÁ˚_£À˘_e
;

96 
	mBIT_16_MONO
,

97 
	mBIT_20_OR_24_MONO
 ,

98 
	mBIT_16_STEREO
,

99 
	mBIT_20_OR_24_STEREO
 ,

100 }
	taudio_ö_mode_e
;

103 
	mBIT_16_MONO_FIFO0
 ,

104 
	mBIT_20_OR_24_MONO_FIFO0
 ,

105 
	mBIT_16_STEREO_FIFO0
 ,

106 
	mBIT_20_OR_24_STEREO_FIFO0
 ,

107 
	mBIT_16_MONO_FIFO1
 ,

108 
	mBIT_20_OR_24_MONO_FIFO1
 ,

109 
	mBIT_16_STEREO_FIFO0_AND_FIFO1
 ,

110 
	mBIT_20_OR_24STEREO_FIFO0_AND_FIFO1
 ,

112 }
	taudio_out_mode_e
;

115 
	mI2S_BIT_16_DATA
,

116 
	mI2S_BIT_20_DATA
 ,

117 
	mI2S_BIT_24_DATA
,

118 }
	ti2s_d©a_£À˘_e
;

121 
	mCODEC_BIT_16_DATA
,

122 
	mCODEC_BIT_20_DATA
=2,

123 
	mCODEC_BIT_24_DATA
,

124 }
	tcodec_d©a_£À˘_e
;

128 
	mMONO_BIT_16
,

129 
	mMONO_BIT_20
,

130 
	mMONO_BIT_24
,

131 
	mSTEREO_BIT_16
,

132 
	mSTEREO_BIT_20
,

133 
	mSTEREO_BIT_24
,

134 }
	taudio_ch™√l_wl_mode_e
;

138 
	mAUDIO_BIT_16_DATA
,

139 
	mAUDIO_BIT_20_DATA
,

140 
	mAUDIO_BIT_24_DATA
,

141 }
	taudio_wl_£À˘_e
;

144 
	mAUDIO_MONO
,

145 
	mAUDIO_STEREO
,

146 }
	taudio_ch™√l_£À˘_e
;

150 
	mI2S_S_CODEC_M
,

151 
	mI2S_M_CODEC_S
,

152 }
	ti2s_codec_m_s_mode_e
;

155 
	mMCU_WREG
,

156 
	mI2C_WREG
 ,

157 }
	tcodec_wªg_mode_e
;

160 
	mI2S_DATA_INVERT_DIS
,

161 
	mI2S_DATA_INVERT_EN
 ,

162 }
	taudio_d©a_övît_e
;

165 
	mI2S_LR_CLK_INVERT_DIS
,

166 
	mI2S_LR_CLK_INVERT_EN
,

167 }
	taudio_i2s_Ã_˛k_övît_e
;

171 
	mDAC_OUTPUT_L_R_CHN
,

172 
	mDAC_OUTPUT_L_CHN
,

173 }
	taudio_ouçut_chn_e
;

177 
	mSINGLE_ENDED_INPUT
,

178 
	mDIFF_ENDED_INPUT
,

179 }
	taudio_öput_mode_£À˘_e
;

182 
	maudio_ö_mode
;

183 
	maudio_out_mode
;

184 
	mi2s_d©a_£À˘
;

185 
	mcodec_d©a_£À˘
;

186 
	mi2s_codec_m_s_mode
;

187 
	mö_digôÆ_gaö
;

188 
	mö_™Æog_gaö
;

189 
	mout_digôÆ_gaö
;

190 
	mout_™Æog_gaö
;

191 
	mmic_öput_mode_£À˘
;

192 
	mdac_ouçut_chn_£À˘
;

193 
	madc_wnf_mode_£À˘
;

194 }
	taduio_i2s_codec_c⁄fig_t
;

198 
	mi2s_Ã_˛k_övît_£À˘
;

199 
	mi2s_d©a_övît_£À˘
;

200 }
	taduio_i2s_övît_c⁄fig_t
;

205 
	mI2S_DATA_IN_FIFO
 ,

206 
	mUSB_DATA_IN_FIFO
 ,

207 
	mSAR_ADC_DATA_IN_FIFO
,

208 
	mIN_NO_USE
,

209 }
	taudio_mux_aö_e
;

212 
	mI2S_OUT
 ,

213 
	mUSB_IOS_OUT
 ,

214 
	mOUT_NO_USE
=3,

215 }
	taudio_mux_aout_e
;

221 
	mAUDIO_8K
,

222 
	mAUDIO_16K
=3,

223 
	mAUDIO_32K
=6,

224 
	mAUDIO_44EP1K
,

225 
	mAUDIO_48K
,

226 
	mAUDIO_ADC_16K_DAC_48K
,

227 }
	taudio_ßm∂e_øã_e
;

230 
	mAMIC_INPUT
,

231 
	mDMIC_INPUT
,

232 
	mLINE_INPUT
,

233 }
	taudio_öput_mode_e
;

236 
	mAMIC_IN_TO_BUF
,

237 
	mDMIC_IN_TO_BUF
,

238 
	mLINE_IN_TO_BUF
,

239 
	mAMIC_IN_TO_BUF_TO_LINE_OUT
,

240 
	mDMIC_IN_TO_BUF_TO_LINE_OUT
,

241 
	mLINE_IN_TO_BUF_TO_LINE_OUT
,

242 
	mBUF_TO_LINE_OUT
,

243 }
	taudio_Êow_mode_e
;

248 
	mAUDIO_RATE_EQUAL
,

249 
	mAUDIO_RATE_GT_L0
,

250 
	mAUDIO_RATE_GT_L1
,

251 
	mAUDIO_RATE_LT_L0
,

252 
	mAUDIO_RATE_LT_L1
,

253 }
	taudio_øã_m©ch_e
;

258 
	mCODEC_IN_D_GAIN_0_DB
=0,

259 
	mCODEC_IN_D_GAIN_4_DB
=4,

260 
	mCODEC_IN_D_GAIN_8_DB
=8,

261 
	mCODEC_IN_D_GAIN_12_DB
=12,

262 
	mCODEC_IN_D_GAIN_16_DB
=16,

263 
	mCODEC_IN_D_GAIN_20_DB
=20,

264 
	mCODEC_IN_D_GAIN_43_DB
=43,

265 }
	tcodec_ö_∑th_digôÆ_gaö_e
;

269 
	mCODEC_IN_A_GAIN_0_DB
,

270 
	mCODEC_IN_A_GAIN_4_DB
,

271 
	mCODEC_IN_A_GAIN_8_DB
,

272 
	mCODEC_IN_A_GAIN_12_DB
,

273 
	mCODEC_IN_A_GAIN_16_DB
,

274 
	mCODEC_IN_A_GAIN_20_DB
,

275 }
	tcodec_ö_∑th_™Æog_gaö_e
;

280 
	mCODEC_OUT_D_GAIN_0_DB
=0,

281 
	mCODEC_OUT_D_GAIN_m1_DB
,

282 
	mCODEC_OUT_D_GAIN_m2_DB
,

283 
	mCODEC_OUT_D_GAIN_m3_DB
,

284 
	mCODEC_OUT_D_GAIN_m4_DB
,

285 
	mCODEC_OUT_D_GAIN_m5_DB
,

286 
	mCODEC_OUT_D_GAIN_m6_DB
,

287 
	mCODEC_OUT_D_GAIN_m7_DB
,

288 
	mCODEC_OUT_D_GAIN_m8_DB
,

289 
	mCODEC_OUT_D_GAIN_m9_DB
,

290 
	mCODEC_OUT_D_GAIN_m10_DB
,

291 
	mCODEC_OUT_D_GAIN_m11_DB
,

292 
	mCODEC_OUT_D_GAIN_m12_DB
,

293 
	mCODEC_OUT_D_GAIN_m13_DB
,

294 
	mCODEC_OUT_D_GAIN_m14_DB
,

295 
	mCODEC_OUT_D_GAIN_m15_DB
,

296 
	mCODEC_OUT_D_GAIN_m16_DB
,

297 
	mCODEC_OUT_D_GAIN_m17_DB
,

298 
	mCODEC_OUT_D_GAIN_m18_DB
,

299 
	mCODEC_OUT_D_GAIN_m19_DB
,

300 
	mCODEC_OUT_D_GAIN_m20_DB
,

301 
	mCODEC_OUT_D_GAIN_m21_DB
,

302 
	mCODEC_OUT_D_GAIN_m22_DB
,

303 
	mCODEC_OUT_D_GAIN_m23_DB
,

304 
	mCODEC_OUT_D_GAIN_m24_DB
,

305 
	mCODEC_OUT_D_GAIN_m25_DB
,

306 
	mCODEC_OUT_D_GAIN_m26_DB
,

307 
	mCODEC_OUT_D_GAIN_m27_DB
,

308 
	mCODEC_OUT_D_GAIN_m28_DB
,

309 
	mCODEC_OUT_D_GAIN_m29_DB
,

310 
	mCODEC_OUT_D_GAIN_m30_DB
,

311 
	mCODEC_OUT_D_GAIN_m31_DB
=31,

313 
	mCODEC_OUT_D_GAIN_32_DB
,

314 
	mCODEC_OUT_D_GAIN_31_DB
,

315 
	mCODEC_OUT_D_GAIN_30_DB
,

316 
	mCODEC_OUT_D_GAIN_29_DB
,

317 
	mCODEC_OUT_D_GAIN_28_DB
,

318 
	mCODEC_OUT_D_GAIN_27_DB
,

319 
	mCODEC_OUT_D_GAIN_26_DB
,

320 
	mCODEC_OUT_D_GAIN_25_DB
,

321 
	mCODEC_OUT_D_GAIN_24_DB
,

322 
	mCODEC_OUT_D_GAIN_23_DB
,

323 
	mCODEC_OUT_D_GAIN_22_DB
,

324 
	mCODEC_OUT_D_GAIN_21_DB
,

325 
	mCODEC_OUT_D_GAIN_20_DB
,

326 
	mCODEC_OUT_D_GAIN_19_DB
,

327 
	mCODEC_OUT_D_GAIN_18_DB
,

328 
	mCODEC_OUT_D_GAIN_17_DB
,

329 
	mCODEC_OUT_D_GAIN_16_DB
,

330 
	mCODEC_OUT_D_GAIN_15_DB
,

331 
	mCODEC_OUT_D_GAIN_14_DB
,

332 
	mCODEC_OUT_D_GAIN_13_DB
,

333 
	mCODEC_OUT_D_GAIN_12_DB
,

334 
	mCODEC_OUT_D_GAIN_11_DB
,

335 
	mCODEC_OUT_D_GAIN_10_DB
,

336 
	mCODEC_OUT_D_GAIN_9_DB
,

337 
	mCODEC_OUT_D_GAIN_8_DB
,

338 
	mCODEC_OUT_D_GAIN_7_DB
,

339 
	mCODEC_OUT_D_GAIN_6_DB
,

340 
	mCODEC_OUT_D_GAIN_5_DB
,

341 
	mCODEC_OUT_D_GAIN_4_DB
,

342 
	mCODEC_OUT_D_GAIN_3_DB
,

343 
	mCODEC_OUT_D_GAIN_2_DB
,

344 
	mCODEC_OUT_D_GAIN_1_DB
,

345 }
	tcodec_out_∑th_digôÆ_gaö_e
;

351 
	mCODEC_OUT_A_GAIN_12_DB
,

352 
	mCODEC_OUT_A_GAIN_11_DB
,

353 
	mCODEC_OUT_A_GAIN_10_DB
,

354 
	mCODEC_OUT_A_GAIN_9_DB
,

355 
	mCODEC_OUT_A_GAIN_8_DB
,

356 
	mCODEC_OUT_A_GAIN_7_DB
,

357 
	mCODEC_OUT_A_GAIN_6_DB
,

358 
	mCODEC_OUT_A_GAIN_5_DB
,

359 
	mCODEC_OUT_A_GAIN_4_DB
,

360 
	mCODEC_OUT_A_GAIN_3_DB
,

361 
	mCODEC_OUT_A_GAIN_2_DB
,

362 
	mCODEC_OUT_A_GAIN_1_DB
,

363 
	mCODEC_OUT_A_GAIN_0_DB
,

364 
	mCODEC_OUT_A_GAIN_m1_DB
,

365 
	mCODEC_OUT_A_GAIN_m2_DB
,

366 
	mCODEC_OUT_A_GAIN_m3_DB
,

367 
	mCODEC_OUT_A_GAIN_m4_DB
,

368 
	mCODEC_OUT_A_GAIN_m5_DB
,

369 
	mCODEC_OUT_A_GAIN_m6_DB
,

370 
	mCODEC_OUT_A_GAIN_m7_DB
,

371 
	mCODEC_OUT_A_GAIN_m8_DB
,

372 
	mCODEC_OUT_A_GAIN_m9_DB
,

373 
	mCODEC_OUT_A_GAIN_m10_DB
,

374 
	mCODEC_OUT_A_GAIN_m11_DB
,

375 
	mCODEC_OUT_A_GAIN_m12_DB
,

376 
	mCODEC_OUT_A_GAIN_m13_DB
,

377 
	mCODEC_OUT_A_GAIN_m14_DB
,

378 
	mCODEC_OUT_A_GAIN_m15_DB
,

379 
	mCODEC_OUT_A_GAIN_m16_DB
,

380 
	mCODEC_OUT_A_GAIN_m17_DB
,

381 
	mCODEC_OUT_A_GAIN_m18_DB
,

382 
	mCODEC_OUT_A_GAIN_m19_DB
,

383 }
	tcodec_out_∑th_™Æog_gaö_e
;

393 
	mCODEC_ADC_WNF_INACTIVE
,

394 
	mCODEC_ADC_WNF_MODE1
,

395 
	mCODEC_ADC_WNF_MODE2
,

396 
	mCODEC_ADC_WNF_MODE3
,

397 }
	tadc_wnf_mode_£l_e
;

403 
	mINNER_CODEC
,

404 
	mEXT_CODEC
,

405 }
	tcodec_ty≥_e
;

412 
	mCODEC_1P8V
,

413 
	mCODEC_2P8V
,

414 }
	tcodec_vﬁt_suµly_e
;

423 
ölöe
 
	$audio_£t_i2s_˛k
(
°ï
,
mod
)

425 
ªg_i2s_°ï
 = (
°ï
&
FLD_I2S_STEP
)|
FLD_I2S_CLK_EN
;

426 
ªg_i2s_mod
 = 
mod
;

427 
	}
}

436 
ölöe
 
	$audio_£t_codec_˛k
(
°ï
,
mod
)

438 
	`BM_CLR
(
ªg_dmic_˛k_£t
,
	`BIT
(0));

439 
ªg_dmic_°ï
 = (
°ï
&
FLD_DMIC_STEP
)|
FLD_DMIC_SEL
;

440 
ªg_dmic_mod
 = 
mod
;

441 
	}
}

448 
ölöe
 
	$audio_i2s_˛k_í
()

450 
	`BM_SET
(
ªg_i2s_°ï
,
FLD_I2S_CLK_EN
);

451 
	}
}

457 
ölöe
 
	$audio_i2s_˛k_dis
()

459 
	`BM_CLR
(
ªg_i2s_°ï
,
FLD_I2S_CLK_EN
);

460 
	}
}

467 
ölöe
 
	$audio_codec_˛k_í
()

469 
	`BM_SET
(
ªg_dmic_°ï
,
FLD_DMIC_SEL
);

470 
	}
}

477 
ölöe
 
	$audio_codec_˛k_dis
()

479 
	`BM_CLR
(
ªg_dmic_°ï
,
FLD_DMIC_SEL
);

480 
	}
}

488 
ölöe
 
	$audio_£t_i2s_b˛k
(
div
)

490 
ªg_pcm_˛k_num
=
div
&0x0f;

491 
	}
}

499 
ölöe
 
	$audio_£t_Ã˛k
(
adc_div
,
dac_div
)

501 
ªg_öt_pcm_num
=(
adc_div
-1);

502 
ªg_dec_pcm_num
=(
dac_div
-1);

503 
	}
}

512 
ölöe
 
	$audio_£t_tx_buff_Àn
(
Àn
)

514 
ªg_tx_max
=((
Àn
)>>2)-1;

515 
	}
}

522 
ölöe
 
	$audio_£t_rx_buff_Àn
(
Àn
)

524 
ªg_rx_max
=((
Àn
)>>2)-1;

525 
	}
}

534 
ölöe
 
	$audio_wrôe_codec_ªg
(
addr
,
d©a
)

536 
	`wrôe_ªg8
(
REG_AUDIO_AHB_BASE
+((0x80+
addr
)<<2), 
d©a
);

538 
	}
}

545 
ölöe
 
	$audio_ªad_codec_ªg
(
addr
)

547  
	`ªad_ªg8
(
REG_AUDIO_AHB_BASE
+((0x80+
addr
)<<2));

549 
	}
}

556 
ölöe
 
	$audio_£t_fifo_tx_åig_num
(
numbî
)

558 
ªg_fifo_åig0
 &=~
FLD_AUDIO_FIFO_AOUT0_TRIG_NUM
;

559 
ªg_fifo_åig0
 |=(
numbî
&
FLD_AUDIO_FIFO_AOUT0_TRIG_NUM
);

560 
	}
}

567 
ölöe
 
	$audio_£t_fifo_rx_åig_num
(
numbî
)

569 
ªg_fifo_åig0
 &~
FLD_AUDIO_FIFO_AIN0_TRIG_NUM
;

570 
ªg_fifo_åig0
 |=((
numbî
&0x0f)<<4);

571 
	}
}

579 
ölöe
 
	$audio_˛k_í
(
i2s_˛k_í
,
mc_˛k_í
)

581 
ªg_audio_í
=
	`MASK_VAL
–
FLD_AUDIO_I2S_CLK_EN
, 
i2s_˛k_í
,\

582 
FLD_AUDIO_MC_CLK_EN
, 
mc_˛k_í
);

583 
	}
}

591 
ölöe
 
	$audio_gë_rx_dma_w±r
 (
dma_chn_e
 
chn
)

593  
	`c⁄vît_øm_addr_bus2˝u
(
	`ªg_dma_d°_addr
(
chn
));

594 
	}
}

601 
ölöe
 
	$audio_gë_tx_dma_Ωå
 (
dma_chn_e
 
chn
)

603  
	`c⁄vît_øm_addr_bus2˝u
(
	`ªg_dma_§c_addr
(
chn
));

604 
	}
}

611 
ölöe
 
	$audio_övît_d©a_í
()

613 
	`BM_SET
(
ªg_i2s_cfg
,
FLD_AUDIO_I2S_LRSWAP
);

614 
	}
}

622 
ölöe
 
	$audio_d©a_fifo0_∑th_£l
 (
audio_mux_aö_e
 
aö0_£l
, 
audio_mux_aout_e
 
aout0_£l
)

624 
ªg_audio_£l
 = 
	`MASK_VAL
–
FLD_AUDIO_AIN0_SEL
, 
aö0_£l
,
FLD_AUDIO_AOUT0_SEL
, 
aout0_£l
);

625 
	}
}

634 
ölöe
 
	$audio_d©a_fifo1_∑th_£l
 ( 
audio_mux_aö_e
 
aö1_£l
, 
audio_mux_aout_e
 
aout1_£l
)

636 
ªg_audio_£l
 = 
	`MASK_VAL
–
FLD_AUDIO_AIN1_SEL
, 
aö1_£l
, 
FLD_AUDIO_AOUT1_SEL
, 
aout1_£l
);

637 
	}
}

645 
ölöe
 
	$audio_övît_d©a_dis
()

647 
	`BM_CLR
(
ªg_i2s_cfg
,
FLD_AUDIO_I2S_LRSWAP
);

648 
	}
}

656 
audio_£t_codec_suµly
 (
codec_vﬁt_suµly_e
 
vﬁt
);

663 
audio_£t_dmic_pö
(
dmic_pö_group_e
 
pö_gp
);

673 
audio_mux_c⁄fig
(
audio_Êow_e
 
audio_Êow
, 
audio_ö_mode_e
 
aö0_mode
 ,áudio_ö_mode_ê
aö1_mode
,
audio_out_mode_e
 
i2s_aout_mode
);

684 
audio_codec_dac_c⁄fig
(
i2s_codec_m_s_mode_e
 
mode
,
audio_ßm∂e_øã_e
 
øã
,
codec_d©a_£À˘_e
 
d©a_£À˘
,
codec_wªg_mode_e
 
wªg_mode
);

695 
audio_codec_adc_c⁄fig
(
i2s_codec_m_s_mode_e
 
mode
,
audio_öput_mode_e
 
ö_mode
,
audio_ßm∂e_øã_e
 
øã
,
codec_d©a_£À˘_e
 
d©a_£À˘
,
codec_wªg_mode_e
 
wªg_mode
);

712 
audio_i2s_c⁄fig
(
i2s_mode_£À˘_e
 
i2s_f‹m©
,
i2s_d©a_£À˘_e
 
wl
, 
i2s_codec_m_s_mode_e
 
m_s
 , 
aduio_i2s_övît_c⁄fig_t
 * 
i2s_c⁄fig_t
);

722 
_©åibuã_øm_code_£c_noölöe_
 
audio_£t_i2s_˛ock
 (
audio_ßm∂e_øã_e
 
audio_øã
,
audio_øã_m©ch_e
 
m©ch
, 
m©ch_í
);

732 
audio_rx_dma_c⁄fig
(
dma_chn_e
 
chn
,* 
d°_addr
,
d©a_Àn
,
dma_chaö_c⁄fig_t
 *
hód_of_li°
);

742 
audio_rx_dma_add_li°_ñemít
(
dma_chaö_c⁄fig_t
 * 
rx_c⁄fig
,dma_chaö_c⁄fig_à*
Œpoöãr
 ,* 
d°_addr
,
d©a_Àn
);

752 
audio_tx_dma_c⁄fig
(
dma_chn_e
 
chn
,* 
§c_addr
, 
d©a_Àn
,
dma_chaö_c⁄fig_t
 * 
hód_of_li°
);

762 
audio_tx_dma_add_li°_ñemít
(
dma_chaö_c⁄fig_t
 *
c⁄fig_addr
,dma_chaö_c⁄fig_à*
Œpoöãr
 ,* 
§c_addr
,
d©a_Àn
);

768 
audio_rx_dma_í
();

774 
audio_rx_dma_dis
();

780 
audio_tx_dma_í
();

787 
audio_tx_dma_dis
();

797 
audio_öô
(
audio_Êow_mode_e
 
Êow_mode
,
audio_ßm∂e_øã_e
 
øã
,
audio_ch™√l_wl_mode_e
 
ch™√l_wl
);

807 
audio_öô_i2c
(
audio_Êow_mode_e
 
Êow_mode
,
audio_ßm∂e_øã_e
 
øã
,
audio_ch™√l_wl_mode_e
 
ch™√l_wl
);

817 
audio_i2s_öô
(
pwm_pö_e
 
pwm0_pö
, 
i2c_sda_pö_e
 
sda_pö
,
i2c_s˛_pö_e
 
s˛_pö
);

826 
audio_rx_dma_chaö_öô
 (
dma_chn_e
 
chn
,* 
ö_buff
,
buff_size
 );

835 
audio_tx_dma_chaö_öô
 (
dma_chn_e
 
chn
,* 
out_buff
,
buff_size
);

843 
audio_£t_m⁄o_chn
(
audio_d©a_övît_e
 
í
);

853 
audio_övît_i2s_Ã_˛k
(
audio_i2s_Ã_˛k_övît_e
 
í
);

862 
audio_£t_codec_mic_öput_mode
 (
audio_öput_mode_£À˘_e
 
öput_mode
);

871 
audio_£t_codec_ö_∑th_a_d_gaö
 (
codec_ö_∑th_digôÆ_gaö_e
 
d_gaö
,
codec_ö_∑th_™Æog_gaö_e
 
a_gaö
 );

879 
audio_£t_codec_out_∑th_a_d_gaö
 (
codec_out_∑th_digôÆ_gaö_e
 
d_gaö
,
codec_out_∑th_™Æog_gaö_e
 
a_gaö
);

887 
audio_£t_i2s_codec_m_s
 (
i2s_codec_m_s_mode_e
 
m_s
);

899 
audio_£t_codec_wnf
(
adc_wnf_mode_£l_e
 
mode
);

907 
audio_£t_ouçut_chn
(
audio_ouçut_chn_e
 
chn
);

913 
audio_∑u£_out_∑th
();

920 
audio_ªsume_out_∑th
();

927 
_©åibuã_øm_code_£c_noölöe_
 
audio_ch™ge_ßm∂e_øã
 (
audio_ßm∂e_øã_e
 
øã
);

934 
audio_codec_dac_powî_down
();

940 
audio_codec_dac_powî_⁄
();

946 
audio_codec_adc_powî_down
();

952 
audio_codec_adc_powî_⁄
();

	@platform/chip_b91/clock.h

35 #i‚de‡
CLOCK_H_


36 
	#CLOCK_H_


	)

38 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

39 
	~"compûî.h
"

48 
	#CCLK_16M_HCLK_16M_PCLK_16M
 
	`˛ock_öô
(
PLL_CLK_192M
, 
PAD_PLL_DIV
, 
PLL_DIV12_TO_CCLK
, 
CCLK_DIV1_TO_HCLK
, 
HCLK_DIV1_TO_PCLK
, 
PLL_DIV4_TO_MSPI_CLK
)

	)

49 
	#CCLK_24M_HCLK_24M_PCLK_24M
 
	`˛ock_öô
(
PLL_CLK_192M
, 
PAD_PLL_DIV
, 
PLL_DIV8_TO_CCLK
, 
CCLK_DIV1_TO_HCLK
, 
HCLK_DIV1_TO_PCLK
, 
PLL_DIV4_TO_MSPI_CLK
)

	)

50 
	#CCLK_32M_HCLK_32M_PCLK_16M
 
	`˛ock_öô
(
PLL_CLK_192M
, 
PAD_PLL_DIV
, 
PLL_DIV6_TO_CCLK
, 
CCLK_DIV1_TO_HCLK
, 
HCLK_DIV2_TO_PCLK
, 
PLL_DIV4_TO_MSPI_CLK
)

	)

51 
	#CCLK_48M_HCLK_48M_PCLK_24M
 
	`˛ock_öô
(
PLL_CLK_192M
, 
PAD_PLL_DIV
, 
PLL_DIV4_TO_CCLK
, 
CCLK_DIV1_TO_HCLK
, 
HCLK_DIV2_TO_PCLK
, 
PLL_DIV4_TO_MSPI_CLK
)

	)

61 
	m∂l_˛k
;

62 
	mc˛k
;

63 
	mh˛k
;

64 
	mp˛k
;

65 
	mm•i_˛k
;

66 }
	tsys_˛k_t
;

77 
	mPLL_CLK_48M
 = (0 | (16 << 2) | (48 << 8)),

78 
	mPLL_CLK_54M
 = (0 | (17 << 2) | (54 << 8)),

79 
	mPLL_CLK_60M
 = (0 | (18 << 2) | (54 << 8)),

80 
	mPLL_CLK_66M
 = (0 | (19 << 2) | (66 << 8)),

81 
	mPLL_CLK_96M
 = (1 | (16 << 2) | (96 << 8)),

82 
	mPLL_CLK_108M
 = (1 | (17 << 2) | (108 << 8)),

83 
	mPLL_CLK_120M
 = (1 | (18 << 2) | (120 << 8)),

84 
	mPLL_CLK_132M
 = (1 | (19 << 2) | (132 << 8)),

85 
	mPLL_CLK_192M
 = (2 | (16 << 2) | (192 << 8)),

86 
	mPLL_CLK_216M
 = (2 | (17 << 2) | (216 << 8)),

87 
	mPLL_CLK_240M
 = (2 | (18 << 2) | (240 << 8)),

88 
	mPLL_CLK_264M
 = (2 | (19 << 2) | (264 << 8)),

89 }
	tsys_∂l_˛k_e
;

95 
	mRC24M
,

96 
	mPAD24M
,

97 
	mPAD_PLL_DIV
,

98 
	mPAD_PLL
,

99 }
	tsys_˛ock_§c_e
;

105 
	mCLK_32K_RC
 =0,

106 
	mCLK_32K_XTAL
 =1,

107 }
	t˛k_32k_ty≥_e
;

113 
	mPLL_DIV2_TO_CCLK
 = 2,

114 
	mPLL_DIV3_TO_CCLK
 = 3,

115 
	mPLL_DIV4_TO_CCLK
 = 4,

116 
	mPLL_DIV5_TO_CCLK
 = 5,

117 
	mPLL_DIV6_TO_CCLK
 = 6,

118 
	mPLL_DIV7_TO_CCLK
 = 7,

119 
	mPLL_DIV8_TO_CCLK
 = 8,

120 
	mPLL_DIV9_TO_CCLK
 = 9,

121 
	mPLL_DIV10_TO_CCLK
 = 10,

122 
	mPLL_DIV11_TO_CCLK
 = 11,

123 
	mPLL_DIV12_TO_CCLK
 = 12,

124 
	mPLL_DIV13_TO_CCLK
 = 13,

125 
	mPLL_DIV14_TO_CCLK
 = 14,

126 
	mPLL_DIV15_TO_CCLK
 = 15,

127 }
	tsys_∂l_div_to_c˛k_e
;

133 
	mCCLK_TO_MSPI_CLK
 = 1,

134 
	mPLL_DIV2_TO_MSPI_CLK
 = 2,

135 
	mPLL_DIV3_TO_MSPI_CLK
 = 3,

136 
	mPLL_DIV4_TO_MSPI_CLK
 = 4,

137 
	mPLL_DIV5_TO_MSPI_CLK
 = 5,

138 
	mPLL_DIV6_TO_MSPI_CLK
 = 6,

139 
	mPLL_DIV7_TO_MSPI_CLK
 = 7,

140 
	mPLL_DIV8_TO_MSPI_CLK
 = 8,

141 
	mPLL_DIV9_TO_MSPI_CLK
 = 9,

142 
	mPLL_DIV10_TO_MSPI_CLK
 = 10,

143 
	mPLL_DIV11_TO_MSPI_CLK
 = 11,

144 
	mPLL_DIV12_TO_MSPI_CLK
 = 12,

145 
	mPLL_DIV13_TO_MSPI_CLK
 = 13,

146 
	mPLL_DIV14_TO_MSPI_CLK
 = 14,

147 
	mPLL_DIV15_TO_MSPI_CLK
 = 15,

148 }
	tsys_∂l_div_to_m•i_˛k_e
;

154 
	mHCLK_DIV1_TO_PCLK
 = 1,

155 
	mHCLK_DIV2_TO_PCLK
 = 2,

156 
	mHCLK_DIV4_TO_PCLK
 = 4,

157 }
	tsys_h˛k_div_to_p˛k_e
;

163 
	mCCLK_DIV1_TO_HCLK
 = 1,

164 
	mCCLK_DIV2_TO_HCLK
 = 2,

165 }
	tsys_c˛k_div_to_h˛k_e
;

171 
	mRC_24M_CAL_DISABLE
=0,

172 
	mRC_24M_CAL_ENABLE
,

174 }
	trc_24M_ˇl_e
;

180 
sys_˛k_t
 
sys_˛k
;

181 
˛k_32k_ty≥_e
 
g_˛k_32k_§c
;

197 
_©åibuã_øm_code_£c_noölöe_
 
˛ock_öô
(
sys_∂l_˛k_e
 
∂l
,

198 
sys_˛ock_§c_e
 
§c
,

199 
sys_∂l_div_to_c˛k_e
 
c˛k_div
,

200 
sys_c˛k_div_to_h˛k_e
 
h˛k_div
,

201 
sys_h˛k_div_to_p˛k_e
 
p˛k_div
,

202 
sys_∂l_div_to_m•i_˛k_e
 
m•i_˛k_div
);

209 
˛ock_32k_öô
(
˛k_32k_ty≥_e
 
§c
);

216 
˛ock_kick_32k_xèl
(
xèl_times
);

222 
_©åibuã_øm_code_£c_noölöe_
 
˛ock_ˇl_24m_rc
 ();

228 
˛ock_ˇl_32k_rc
 ();

234 
_©åibuã_øm_code_£c_noölöe_
 
˛ock_gë_32k_tick
 ();

241 
_©åibuã_øm_code_£c_noölöe_
 
˛ock_£t_32k_tick
(
tick
);

	@platform/chip_b91/core.h

24 #i‚de‡
CORE_H


25 
	#CORE_H


	)

26 
	~"nds_öåösic.h
"

27 
	~"sys.h
"

29 
	#ªad_c§
(
ªg
Ë
	`__nds__c§r
‘eg)

	)

30 
	#wrôe_c§
(
ªg
, 
vÆ
Ë
	`__nds__c§w
(vÆ,Ñeg)

	)

31 
	#sw≠_c§
(
ªg
, 
vÆ
Ë
	`__nds__c§rw
(vÆ,Ñeg)

	)

32 
	#£t_c§
(
ªg
, 
bô
Ë
	`__nds__c§rs
(bô,Ñeg)

	)

33 
	#˛ór_c§
(
ªg
, 
bô
Ë
	`__nds__c§rc
(bô,Ñeg)

	)

39 
	#ßve_c§
(
r
Ë
__
##∏
	`ªad_c§
‘);

	)

40 
	#ª°‹e_c§
(
r
Ë
	`wrôe_c§
‘, 
__
##r);

	)

44 
	#ßve_mx°©us
(Ë
	`ßve_c§
(
NDS_MXSTATUS
)

	)

45 
	#ª°‹e_mx°©us
(Ë
	`ª°‹e_c§
(
NDS_MXSTATUS
)

	)

48 
	#c‹e_ßve_√°ed_c⁄ãxt
(Ë\

	)

49 
ßve_c§
(
NDS_MEPC
) \

50 
ßve_c§
(
NDS_MSTATUS
) \

51 
ßve_mx°©us
() \

52 
£t_c§
(
NDS_MSTATUS
, 1<<3);

55 
	#c‹e_ª°‹e_√°ed_c⁄ãxt
(Ë\

	)

56 
˛ór_c§
(
NDS_MSTATUS
, 1<<3); \

57 
ª°‹e_c§
(
NDS_MSTATUS
) \

58 
ª°‹e_c§
(
NDS_MEPC
) \

59 
	$ª°‹e_mx°©us
()

61 
	#„n˚_i‹w
 
	`__nds__„n˚
(
FENCE_IORW
,FENCE_IORW)

	)

64 
FLD_FEATURE_PREEMPT_PRIORITY_INT_EN
 = 
	`BIT
(0),

65 
FLD_FEATURE_VECTOR_MODE_EN
 = 
	`BIT
(1),

67 
	t„©uª_e
;

75 
ölöe
 
	$c‹e_öãºu±_dißbÀ
(){

77 
r
 = 
	`ªad_c§
 (
NDS_MIE
);

78 
	`˛ór_c§
(
NDS_MIE
, 
	`BIT
(3)| BIT(7)| BIT(11));

79  
r
;

80 
	}
}

89 
ölöe
 
	$c‹e_ª°‹e_öãºu±
(
í
){

91 
	`£t_c§
(
NDS_MIE
, 
í
);

93 
	}
}

99 
ölöe
 
	$c‹e_öãºu±_íabÀ
()

101 
	`£t_c§
(
NDS_MSTATUS
,1<<3);

102 
	`£t_c§
(
NDS_MIE
,1<<11 | 1 << 7 | 1 << 3);

104 
	}
}

	@platform/chip_b91/dma.h

34 #i‚de‡
DMA_H_


35 
	#DMA_H_


	)

36 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

38 
	mDMA0
=0,

39 
	mDMA1
,

40 
	mDMA2
,

41 
	mDMA3
,

42 
	mDMA4
,

43 
	mDMA5
,

44 
	mDMA6
,

45 
	mDMA7
,

46 }
	tdma_chn_e
;

49 
	mDMA_CHN0_IRQ
 = 
BIT
(0),

50 
	mDMA_CHN1_IRQ
 = 
BIT
(1),

51 
	mDMA_CHN2_IRQ
 = 
BIT
(2),

52 
	mDMA_CHN3_IRQ
 = 
BIT
(3),

53 
	mDMA_CHN4_IRQ
 = 
BIT
(4),

54 
	mDMA_CHN5_IRQ
 = 
BIT
(5),

55 
	mDMA_CHN6_IRQ
 = 
BIT
(6),

56 
	mDMA_CHN7_IRQ
 = 
BIT
(7),

57 }
	tdma_úq_chn_e
;

60 
	mDMA_REQ_SPI_AHB_TX
=0,

61 
	mDMA_REQ_SPI_AHB_RX
,

62 
	mDMA_REQ_UART0_TX
,

63 
	mDMA_REQ_UART0_RX
,

64 
	mDMA_REQ_SPI_APB_TX
,

65 
	mDMA_REQ_SPI_APB_RX
,

66 
	mDMA_REQ_I2C_TX
,

67 
	mDMA_REQ_I2C_RX
,

68 
	mDMA_REQ_ZB_TX
,

69 
	mDMA_REQ_ZB_RX
,

70 
	mDMA_REQ_PWM_TX
,

71 
	mDMA_REQ_RESERVED
,

72 
	mDMA_REQ_ALGM_TX
,

73 
	mDMA_REQ_ALGM_RX
,

74 
	mDMA_REQ_UART1_TX
,

75 
	mDMA_REQ_UART1_RX
,

76 
	mDMA_REQ_AUDIO0_TX
,

77 
	mDMA_REQ_AUDIO0_RX
,

78 
	mDMA_REQ_AUDIO1_TX
,

79 
	mDMA_REQ_AUDIO1_RX
,

81 }
	tdma_ªq_£l_e
;

84 
	mDMA_ADDR_INCREMENT
=0,

85 
	mDMA_ADDR_DECREMENT
,

86 
	mDMA_ADDR_FIX
,

88 
	tdma_addr_˘æ_e
;

92 
	mDMA_NORMAL_MODE
=0,

93 
	mDMA_HANDSHAKE_MODE
,

95 
	tdma_mode_e
;

98 
	mDMA_CTR_BYTE_WIDTH
=0,

99 
	mDMA_CTR_HWORD_WIDTH
,

100 
	mDMA_CTR_WORD_WIDTH
,

102 
	tdma_˘r_width_e
;

105 
	mDMA_BYTE_WIDTH
=1,

106 
	mDMA_HWORD_WIDTH
=2,

107 
	mDMA_WORD_WIDTH
=4,

109 
	tdma_å™s„r_width_e
;

112 
	mTC_MASK
 = 
BIT
(1),

113 
	mERR_MASK
 = 
BIT
(2),

114 
	mABT_MASK
 = 
BIT
(3),

115 }
	tdma_úq_mask_e
;

118 
	md°_ªq_£l
:5;

119 
	m§c_ªq_£l
:5;

120 
	md°_addr_˘æ
:2;

121 
	m§c_addr_˘æ
:2;

122 
	md°mode
:1;

123 
	m§cmode
:1;

124 
	md°width
:2;

125 
	m§cwidth
:2;

126 
	m§c_bur°_size
:3;

127 
	mvaˇ¡_bô
 :1;

128 
	mªad_num_í
:1;

129 
	m¥i‹ôy
:1;

130 
	mwrôe_num_í
:1;

131 
	mauto_í
:1;

132 }
	tdma_c⁄fig_t
;

136 
	mdma_chaö_˘l
;

137 
	mdma_chaö_§c_addr
;

138 
	mdma_chaö_d°_addr
;

139 
	mdma_chaö_d©a_Àn
;

140 
	mdma_chaö_Œp_±r
;

141 }
	tdma_chaö_c⁄fig_t
 ;

150 
ölöe
 
	$dma_c⁄fig
(
dma_chn_e
 
chn
 ,
dma_c⁄fig_t
 *
c⁄fig
)

152 
	`BM_CLR
(
	`ªg_dma_˘æ
(
chn
),
	`BIT_RNG
(4,31));

153 
	`ªg_dma_˘æ
(
chn
Ë|(*(*)
c⁄fig
)<<4;

154 
	}
}

162 
ölöe
 
	$dma_chn_í
(
dma_chn_e
 
chn
)

164 
	`BM_SET
(
	`ªg_dma_˘r0
(
chn
),
	`BIT
(0));

165 
	}
}

172 
ölöe
 
	$dma_chn_dis
(
dma_chn_e
 
chn
)

174 
	`BM_CLR
(
	`ªg_dma_˘r0
(
chn
),
	`BIT
(0));

175 
	}
}

183 
ölöe
 
	$dma_£t_úq_mask
(
dma_chn_e
 
chn
,
dma_úq_mask_e
 
mask
)

185 
	`ªg_dma_˘r0
(
chn
Ë‘eg_dma_˘r0(chnË| 
	`BIT_RNG
(1,3)Ë& (~(
mask
));

186 
	}
}

195 
ölöe
 
	$dma_˛r_úq_mask
(
dma_chn_e
 
chn
,
dma_úq_mask_e
 
mask
)

197 
	`ªg_dma_˘r0
(
chn
Ë|(
mask
);

198 
	}
}

204 
ölöe
 
	$dma_gë_tc_úq_°©us
(
dma_úq_chn_e
 
tc_chn
)

206  
ªg_dma_tc_i§
&
tc_chn
;

207 
	}
}

215 
ölöe
 
	$dma_˛r_tc_úq_°©us
(
dma_úq_chn_e
 
tc_chn
)

217 
ªg_dma_tc_i§
 = 
tc_chn
;

218 
	}
}

225 
ölöe
 
	$dma_gë_îr_úq_°©us
(
dma_úq_chn_e
 
îr_chn
)

227  
ªg_dma_îr_i§
&
îr_chn
;

228 
	}
}

236 
ölöe
 
	$dma_˛r_îr_úq_°©us
(
dma_úq_chn_e
 
îr_chn
)

238 
ªg_dma_îr_i§
 = 
îr_chn
;

239 
	}
}

246 
ölöe
 
	$dma_gë_abt_úq_°©us
(
dma_úq_chn_e
 
abt_chn
)

248  
ªg_dma_abt_i§
&
abt_chn
;

249 
	}
}

257 
ölöe
 
	$dma_˛r_abt_úq_°©us
(
dma_úq_chn_e
 
abt_chn
)

259 
ªg_dma_abt_i§
 = 
abt_chn
;

260 
	}
}

269 
ölöe
 
	$dma_£t_size
(
dma_chn_e
 
chn
,
size_byã
,
dma_å™s„r_width_e
 
byã_width
)

271 
	`ªg_dma_size
(
chn
Ë=((
size_byã
+
byã_width
-1)/byte_width)|( (size_byte % byte_width)<<22);

272 
	}
}

281 
ölöe
 
	$dma_ˇl_size
(
size_byã
,
dma_å™s„r_width_e
 
byã_width
)

283  (((
size_byã
+
byã_width
-1)/byte_width)|( (size_byte % byte_width)<<22));

284 
	}
}

297 
ölöe
 
	$dma_£t_addªss
(
dma_chn_e
 
chn
,
§c_addr
,
d°_addr
)

299 
	`ªg_dma_§c_addr
(
chn
)=
§c_addr
;

300 
	`ªg_dma_d°_addr
(
chn
)=
d°_addr
;

301 
	}
}

309 
ölöe
 
	$dma_£t_§c_addªss
(
dma_chn_e
 
chn
,
§c_addr
)

311 
	`ªg_dma_§c_addr
(
chn
)=
§c_addr
;

312 
	}
}

319 
ölöe
 
	$dma_£t_d°_addªss
(
dma_chn_e
 
chn
,
d°_addr
)

321 
	`ªg_dma_d°_addr
(
chn
)=
d°_addr
;

322 
	}
}

329 
ölöe
 
	$dma_ª£t
()

331 
ªg_r°1
 &~(
FLD_RST1_DMA
);

332 
ªg_r°1
 |
FLD_RST1_DMA
;

333 
	}
}

	@platform/chip_b91/driver_b91.h

24 #¥agm®
⁄˚


28 
	~"audio.h
"

29 
	~"™Æog.h
"

30 
	~"dma.h
"

31 
	~"gpio.h
"

32 
	~"i2c.h
"

33 
	~"•i.h
"

34 
	~"pwm.h
"

35 
	~"pm.h
"

36 
	~"timî.h
"

37 
	~"Êash.h
"

38 
	~"usbhw.h
"

39 
	~"w©chdog.h
"

40 
	~"s7816.h
"

41 
	~"nds_öåösic.h
"

42 
	~"mdec.h
"

44 
	~"ång.h
"

45 
	~"≈e.h
"

46 
	~"sys.h
"

47 
	~"pke.h
"

48 
	~"∂ic.h
"

49 
	~"u¨t.h
"

50 
	~"°imî.h
"

51 
	~"´s.h
"

53 
	~"rf.h
"

55 
	~"Õc.h
"

56 
	~"˛ock.h
"

57 
	~"emi.h
"

59 
	~"m•i.h
"

60 
	~"adc.h
"

61 
	~"swúe.h
"

	@platform/chip_b91/emi.h

24 #i‚de‡ 
EMI_H_


25 
	#EMI_H_


	)

27 
	~"rf.h
"

32 
	#EMI_ACCESS_ADDR
 0x140808

	)

33 
	#EMI_ACCESS_CODE
 0x29417671

	)

45 
rf_emi_tx_sögÀ_t⁄e
(
rf_powî_Àvñ_e
 
powî_Àvñ
,sig√d 
rf_chn
);

53 
rf_emi_rx_£tup
(
rf_mode_e
 
mode
,sig√d 
rf_chn
);

59 
rf_emi_rx_lo›
();

65 
rf_emi_°›
();

71 
rf_emi_gë_rxpkt_˙t
();

77 
rf_emi_gë_rssi_avg
();

84 
rf_emi_tx_c⁄töue_£tup
();

97 
rf_emi_tx_c⁄töue_upd©e_d©a
(
rf_mode_e
 
rf_mode
,
rf_powî_Àvñ_e
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

103 
rf_c⁄töue_mode_run
();

114 
rf_emi_tx_bur°_lo›
(
rf_mode_e
 
rf_mode
,
pkt_ty≥
);

127 
rf_emi_tx_bur°_£tup
(
rf_mode_e
 
rf_mode
,
rf_powî_Àvñ_e
 
powî_Àvñ
,sig√d 
rf_chn
,
pkt_ty≥
);

135 
rf_phy_ã°_¥bs9
 (*
p
, 
n
);

141 
rf_emi_ª£t_ba£b™d
();

148 
emi_≤_gí
(
°©e
);

	@platform/chip_b91/flash.c

24 
	~"Êash.h
"

25 
	~"m•i.h
"

26 
	~"∂ic.h
"

27 
	~"timî.h
"

28 
	~"sys.h
"

29 
	~"c‹e.h
"

30 
	~"°imî.h
"

31 vﬁ©ûê
	gÊash_˙t
 = 1;

33 
¥ìm±_c⁄fig_t
 
	gs_Êash_¥ìm±_c⁄fig
 =

35 .
¥ìm±_í
 =0,

36 .
	gthªshﬁd
 =1,

45 
	$Êash_∂ic_¥ìm±_c⁄fig
(
¥ìm±_í
,
thªshﬁd
)

47 
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
=preempt_en;

48 
s_Êash_¥ìm±_c⁄fig
.
thªshﬁd
=threshold;

49 
	}
}

59 
ölöe
 
	$Êash_is_busy
()

61  
	`m•i_ªad
() & 0x01;

62 
	}
}

71 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_cmd
(
cmd
)

73 
	`m•i_high
();

74 
CLOCK_DLY_10_CYC
;

75 
	`m•i_low
();

76 
	`m•i_wrôe
(
cmd
);

77 
	`m•i_waô
();

78 
	}
}

85 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£nd_addr
(
addr
)

87 
	`m•i_wrôe
(()(
addr
>>16));

88 
	`m•i_waô
();

89 
	`m•i_wrôe
(()(
addr
>>8));

90 
	`m•i_waô
();

91 
	`m•i_wrôe
(()(
addr
));

92 
	`m•i_waô
();

93 
	}
}

99 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_waô_d⁄e
()

101 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_CMD
);

103 
i
;

104 
i
 = 0; i < 10000000; ++i){

105 if(!
	`Êash_is_busy
()){

106 
Êash_˙t
++;

110 
	`m•i_high
();

111 
	}
}

122 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_îa£_£˘‹_øm
(
addr
)

124 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

125 
	`m•i_°›_xù
();

126 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

127 
	`Êash_£nd_cmd
(
FLASH_SECT_ERASE_CMD
);

128 
	`Êash_£nd_addr
(
addr
);

129 
	`m•i_high
();

130 
	`Êash_waô_d⁄e
();

131 
CLOCK_DLY_5_CYC
;

132 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

133 
	}
}

134 
_©åibuã_ãxt_£c_
 
	$Êash_îa£_£˘‹
(
addr
)

136 
	`__asm__
("csrci mmisc_ctl,8");

137 
	`Êash_îa£_£˘‹_øm
(
addr
);

138 
	`__asm__
("csrsi mmisc_ctl,8");

139 
	}
}

148 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_wrôe_∑ge_øm
(
addr
, 
Àn
, *
buf
)

150 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

151 
	`m•i_°›_xù
();

152 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

153 
	`Êash_£nd_cmd
(
FLASH_WRITE_CMD
);

154 
	`Êash_£nd_addr
(
addr
);

156 
i
;

157 
i
 = 0; i < 
Àn
; ++i){

158 
	`m•i_wrôe
(
buf
[
i
]);

159 
	`m•i_waô
();

161 
	`m•i_high
();

162 
	`Êash_waô_d⁄e
();

163 
CLOCK_DLY_5_CYC
;

164 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

165 
	}
}

166 
_©åibuã_ãxt_£c_
 
	$Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
)

168 
ns
 = 
PAGE_SIZE
 - (
addr
 & 0xff);

169 
nw
 = 0;

172 
nw
 = 
Àn
 > 
ns
 ?Çs :Üen;

173 
	`__asm__
("csrci mmisc_ctl,8");

174 
	`Êash_wrôe_∑ge_øm
(
addr
,
nw
,
buf
);

175 
	`__asm__
("csrsi mmisc_ctl,8");

176 
ns
 = 
PAGE_SIZE
;

177 
addr
 +
nw
;

178 
buf
 +
nw
;

179 
Àn
 -
nw
;

180 }
Àn
 > 0);

181 
	}
}

190 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_ªad_∑ge_øm
(
addr
, 
Àn
, *
buf
)

192 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

193 
	`m•i_°›_xù
();

194 
	`Êash_£nd_cmd
(
FLASH_READ_CMD
);

195 
	`Êash_£nd_addr
(
addr
);

197 
	`m•i_wrôe
(0x00);

198 
	`m•i_waô
();

199 
	`m•i_fm_rd_í
();

200 
	`m•i_waô
();

202 
i
 = 0; i < 
Àn
; ++i){

203 *
buf
++ = 
	`m•i_gë
();

204 
	`m•i_waô
();

206 
	`m•i_fm_rd_dis
();

207 
	`m•i_high
();

208 
CLOCK_DLY_5_CYC
;

209 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

210 
	}
}

211 
_©åibuã_ãxt_£c_
 
	$Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
)

213 
	`__asm__
("csrci mmisc_ctl,8");

214 
	`Êash_ªad_∑ge_øm
(
addr
,
Àn
,
buf
);

215 
	`__asm__
("csrsi mmisc_ctl,8");

216 
	}
}

222 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_îa£_chù_øm
()

224 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

225 
	`m•i_°›_xù
();

226 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

227 
	`Êash_£nd_cmd
(
FLASH_CHIP_ERASE_CMD
);

228 
	`m•i_high
();

229 
	`Êash_waô_d⁄e
();

230 
CLOCK_DLY_5_CYC
;

231 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

232 
	}
}

233 
_©åibuã_ãxt_£c_
 
	$Êash_îa£_chù
()

235 
	`__asm__
("csrci mmisc_ctl,8");

236 
	`Êash_îa£_chù_øm
();

237 
	`__asm__
("csrsi mmisc_ctl,8");

238 
	}
}

245 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_îa£_∑ge_øm
(
addr
)

247 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

249 
	`m•i_°›_xù
();

250 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

251 
	`Êash_£nd_cmd
(
FLASH_PAGE_ERASE_CMD
);

252 
	`Êash_£nd_addr
(
addr
);

253 
	`m•i_high
();

254 
	`Êash_waô_d⁄e
();

255 
CLOCK_DLY_5_CYC
;

256 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

257 
	}
}

258 
_©åibuã_ãxt_£c_
 
	$Êash_îa£_∑ge
(
addr
)

260 
	`__asm__
("csrci mmisc_ctl,8");

261 
	`Êash_îa£_∑ge_øm
(
addr
);

262 
	`__asm__
("csrsi mmisc_ctl,8");

263 
	}
}

270 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_îa£_32kblock_øm
(
addr
)

272 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

273 
	`m•i_°›_xù
();

274 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

275 
	`Êash_£nd_cmd
(
FLASH_32KBLK_ERASE_CMD
);

276 
	`Êash_£nd_addr
(
addr
);

277 
	`m•i_high
();

278 
	`Êash_waô_d⁄e
();

279 
CLOCK_DLY_5_CYC
;

280 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

281 
	}
}

282 
_©åibuã_ãxt_£c_
 
	$Êash_îa£_32kblock
(
addr
)

284 
	`__asm__
("csrci mmisc_ctl,8");

285 
	`Êash_îa£_32kblock_øm
(
addr
);

286 
	`__asm__
("csrsi mmisc_ctl,8");

287 
	}
}

294 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_îa£_64kblock_øm
(
addr
)

296 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

297 
	`m•i_°›_xù
();

298 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

299 
	`Êash_£nd_cmd
(
FLASH_64KBLK_ERASE_CMD
);

300 
	`Êash_£nd_addr
(
addr
);

301 
	`m•i_high
();

302 
	`Êash_waô_d⁄e
();

303 
CLOCK_DLY_5_CYC
;

304 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

305 
	}
}

306 
_©åibuã_ãxt_£c_
 
	$Êash_îa£_64kblock
(
addr
)

308 
	`__asm__
("csrci mmisc_ctl,8");

309 
	`Êash_îa£_64kblock_øm
(
addr
);

310 
	`__asm__
("csrsi mmisc_ctl,8");

311 
	}
}

318 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_wrôe_°©us_øm
(
d©a
)

320 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

321 
	`m•i_°›_xù
();

322 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

323 
	`Êash_£nd_cmd
(
FLASH_WRITE_STATUS_CMD
);

324 
	`m•i_wrôe
(()
d©a
);

325 
	`m•i_waô
();

326 
	`m•i_wrôe
(()(
d©a
>>8));

327 
	`m•i_waô
();

328 
	`m•i_high
();

329 
	`Êash_waô_d⁄e
();

330 
	`m•i_high
();

331 
CLOCK_DLY_5_CYC
;

332 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

333 
	}
}

334 
_©åibuã_ãxt_£c_
 
	$Êash_wrôe_°©us
(
d©a
)

336 
	`__asm__
("csrci mmisc_ctl,8");

337 
	`Êash_wrôe_°©us_øm
(
d©a
);

338 
	`__asm__
("csrsi mmisc_ctl,8");

339 
	}
}

345 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_ªad_°©us_øm
()

347 
°©us
 = 0;

348 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

350 
	`m•i_°›_xù
();

351 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_1_CMD
);

352 
°©us
 = (
	`m•i_ªad
()<<8);

353 
	`m•i_high
();

354 
	`Êash_£nd_cmd
(
FLASH_READ_STATUS_CMD
);

355 
°©us
 |
	`m•i_ªad
();

356 
	`m•i_high
();

357 
CLOCK_DLY_5_CYC
;

359 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

360  
°©us
;

361 
	}
}

362 
_©åibuã_ãxt_£c_
 
	$Êash_ªad_°©us
()

364 
	`__asm__
("csrci mmisc_ctl,8");

365 
°©us
 = 
	`Êash_ªad_°©us_øm
();

366 
	`__asm__
("csrsi mmisc_ctl,8");

367  
°©us
;

368 
	}
}

378 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_dìp_powîdown_øm
()

380 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

382 
	`m•i_°›_xù
();

383 
	`Êash_£nd_cmd
(
FLASH_POWER_DOWN
);

384 
	`m•i_high
();

385 
	`dñay_us
(1);

386 
CLOCK_DLY_5_CYC
;

388 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

389 
	}
}

390 
_©åibuã_ãxt_£c_
 
	$Êash_dìp_powîdown
()

392 
	`__asm__
("csrci mmisc_ctl,8");

393 
	`Êash_dìp_powîdown_øm
();

394 
	`__asm__
("csrsi mmisc_ctl,8");

395 
	}
}

406 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_ªÀa£_dìp_powîdown_øm
()

408 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

410 
	`m•i_°›_xù
();

411 
	`Êash_£nd_cmd
(
FLASH_POWER_DOWN_RELEASE
);

412 
	`m•i_high
();

413 
	`Êash_waô_d⁄e
();

414 
	`m•i_high
();

415 
CLOCK_DLY_5_CYC
;

417 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

418 
	}
}

419 
_©åibuã_ãxt_£c_
 
	$Êash_ªÀa£_dìp_powîdown
()

421 
	`__asm__
("csrci mmisc_ctl,8");

422 
	`Êash_ªÀa£_dìp_powîdown_øm
();

423 
	`__asm__
("csrsi mmisc_ctl,8");

424 
	}
}

433 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_ªad_mid_øm
(){

435 
j
 = 0;

436 
Êash_mid
 = 0;

437 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

439 
	`m•i_°›_xù
();

440 
	`Êash_£nd_cmd
(
FLASH_GET_JEDEC_ID
);

441 
	`m•i_wrôe
(0x00);

442 
	`m•i_waô
();

443 
	`m•i_fm_rd_í
();

444 
	`m•i_waô
();

446 
j
 = 0; j < 3; ++j){

447 ((*)(&
Êash_mid
))[
j
] = 
	`m•i_gë
();

448 
	`m•i_waô
();

450 
	`m•i_fm_rd_dis
();

451 
	`m•i_high
();

452 
CLOCK_DLY_5_CYC
;

454 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

455  
Êash_mid
;

456 
	}
}

457 
_©åibuã_ãxt_£c_
 
	$Êash_ªad_mid
(){

458 
Êash_mid
 = 0;

459 
	`__asm__
("csrci mmisc_ctl,8");

460 
Êash_mid
 = 
	`Êash_ªad_mid_øm
();

461 
	`__asm__
("csrsi mmisc_ctl,8");

462  
Êash_mid
;

463 
	}
}

471 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_ªad_uid_øm
(
idcmd
,*
buf
)

473 
j
 = 0;

474 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

476 
	`m•i_°›_xù
();

477 
	`Êash_£nd_cmd
(
idcmd
);

478 if(
idcmd
==
FLASH_GD_PUYA_READ_UID_CMD
)

480 
	`Êash_£nd_addr
(0x00);

481 
	`m•i_wrôe
(0x00);

482 
	`m•i_waô
();

484 i‡(
idcmd
==
FLASH_XTX_READ_UID_CMD
)

486 
	`Êash_£nd_addr
(0x80);

487 
	`m•i_wrôe
(0x00);

488 
	`m•i_waô
();

491 
	`m•i_wrôe
(0x00);

492 
	`m•i_waô
();

493 
	`m•i_fm_rd_í
();

494 
	`m•i_waô
();

496 
j
 = 0; j < 16; ++j){

497 *
buf
++ = 
	`m•i_gë
();

498 
	`m•i_waô
();

500 
	`m•i_fm_rd_dis
();

501 
	`m•i_high
();

502 
CLOCK_DLY_5_CYC
;

504 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

505 
	}
}

506 
_©åibuã_ãxt_£c_
 
	$Êash_ªad_uid
(
idcmd
,*
buf
)

508 
	`__asm__
("csrci mmisc_ctl,8");

509 
	`Êash_ªad_uid_øm
(
idcmd
,
buf
);

510 
	`__asm__
("csrsi mmisc_ctl,8");

511 
	}
}

520 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_lock_øm
(
Êash_ty≥_e
 
ty≥
 , 
d©a
)

522 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

524 
	`m•i_°›_xù
();

525 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

526 
	`Êash_£nd_cmd
(
FLASH_WRITE_STATUS_CMD
);

527 if(
ty≥
 =
FLASH_TYPE_PUYA
)

529 
	`m•i_wrôe
(()
d©a
);

530 
	`m•i_waô
();

531 
	`m•i_wrôe
(()(
d©a
>>8));

534 
	`m•i_waô
();

535 
	`m•i_high
();

536 
	`Êash_waô_d⁄e
();

537 
	`m•i_high
();

538 
CLOCK_DLY_5_CYC
;

540 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

541 
	}
}

542 
_©åibuã_ãxt_£c_
 
	$Êash_lock
(
Êash_ty≥_e
 
ty≥
 , 
d©a
)

544 
	`__asm__
("csrci mmisc_ctl,8");

545 
	`Êash_lock_øm
(
ty≥
,
d©a
);

546 
	`__asm__
("csrsi mmisc_ctl,8");

547 
	}
}

554 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_u∆ock_øm
(
Êash_ty≥_e
 
ty≥
)

556 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

558 
	`m•i_°›_xù
();

559 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

560 
	`Êash_£nd_cmd
(
FLASH_WRITE_STATUS_CMD
);

561 if(
ty≥
 =
FLASH_TYPE_PUYA
)

563 
	`m•i_wrôe
(0);

564 
	`m•i_waô
();

565 
	`m•i_wrôe
(0);

567 
	`m•i_waô
();

568 
	`m•i_high
();

569 
	`Êash_waô_d⁄e
();

570 
	`m•i_high
();

571 
CLOCK_DLY_5_CYC
;

573 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

574 
	}
}

575 
_©åibuã_ãxt_£c_
 
	$Êash_u∆ock
(
Êash_ty≥_e
 
ty≥
)

577 
	`__asm__
("csrci mmisc_ctl,8");

578 
	`Êash_u∆ock_øm
(
ty≥
);

579 
	`__asm__
("csrsi mmisc_ctl,8");

580 
	}
}

588 
_©åibuã_øm_code_£c_noölöe_
 
	$Êash_£t_xù_c⁄fig_§am
(
Êash_xù_c⁄fig_t
 
c⁄fig
)

590 
r
=
	`∂ic_íãr_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,s_Êash_¥ìm±_c⁄fig.
thªshﬁd
);

592 
	`m•i_°›_xù
();

593 
ªg_m•i_xù_c⁄fig
 = *((*)(&
c⁄fig
));

594 
CLOCK_DLY_5_CYC
;

596 
	`∂ic_exô_¸ôiˇl_£c
(
s_Êash_¥ìm±_c⁄fig
.
¥ìm±_í
,
r
);

597 
	}
}

598 
_©åibuã_ãxt_£c_
 
	$Êash_£t_xù_c⁄fig
(
Êash_xù_c⁄fig_t
 
c⁄fig
)

600 
	`__asm__
("csrci mmisc_ctl,8");

601 
	`Êash_£t_xù_c⁄fig_§am
(
c⁄fig
);

602 
	`__asm__
("csrsi mmisc_ctl,8");

603 
	}
}

615 
_©åibuã_ãxt_£c_
 
	$Êash_ªad_mid_uid_wôh_check
–*
Êash_mid
 ,*
Êash_uid
){

617 
no_uid
[16]={0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01,0x51,0x01};

618 
i
,
f_˙t
=0;

619 
mid
;

621 
mid
 = 
	`Êash_ªad_mid
();

622 
mid
 = mid&0xffff;

623 *
Êash_mid
 = 
mid
;

626 if(
mid
 == 0x6085){

627 
	`Êash_ªad_uid
(
FLASH_GD_PUYA_READ_UID_CMD
,(*)
Êash_uid
);

631 
i
=0;i<16;i++){

632 if(
Êash_uid
[
i
]==
no_uid
[i]){

633 
f_˙t
++;

636 if(
f_˙t
==16){

641 
	}
}

	@platform/chip_b91/flash.h

24 #¥agm®
⁄˚


26 
	~"m•i.h
"

27 
	~"compûî.h
"

30 
	#PAGE_SIZE
 256

	)

37 
	mFLASH_WRITE_STATUS_CMD
 = 0x01,

38 
	mFLASH_WRITE_CMD
 = 0x02,

39 
	mFLASH_READ_CMD
 = 0x03,

41 
	mFLASH_WRITE_DISABLE_CMD
 = 0x04,

42 
	mFLASH_READ_STATUS_CMD
 = 0x05,

43 
	mFLASH_WRITE_ENABLE_CMD
 = 0x06,

45 
	mFLASH_CHIP_ERASE_CMD
 = 0x60,

47 
	mFLASH_PES_CMD
 = 0x75,

48 
	mFLASH_PER_CMD
 = 0x7A,

49 
	mFLASH_QUAD_PAGE_PROGRAM_CMD
 = 0x32,

50 
	mFLASH_READ_DEVICE_ID_CMD
 = 0x90,

52 
	mFLASH_FAST_READ_CMD
 = 0x0B,

53 
	mFLASH_X2READ_CMD
 = 0xBB,

54 
	mFLASH_DREAD_CMD
 = 0x3B,

55 
	mFLASH_X4READ_CMD
 = 0xEB,

56 
	mFLASH_QREAD_CMD
 = 0x6B,

58 
	mFLASH_SECT_ERASE_CMD
 = 0x20,

59 
	mFLASH_32KBLK_ERASE_CMD
 = 0x52,

60 
	mFLASH_64KBLK_ERASE_CMD
 = 0xD8,

61 
	mFLASH_GD_PUYA_READ_UID_CMD
 = 0x4B,

62 
	mFLASH_XTX_READ_UID_CMD
 = 0x5A,

63 
	mFLASH_PAGE_ERASE_CMD
 = 0x81,

65 
	mFLASH_POWER_DOWN
 = 0xB9,

66 
	mFLASH_POWER_DOWN_RELEASE
 = 0xAB,

67 
	mFLASH_GET_JEDEC_ID
 = 0x9F,

68 
	mFLASH_READ_STATUS_1_CMD
 = 0x35,

70 
	mFLASH_VOLATILE_SR_WRITE_CMD
 = 0x50,

71 
	mFLASH_SET_BURST_WITH_WRAP_CMD
 = 0x77,

72 
	mFLASH_ENABLE_SO_TO_OUTPUT_CMD
 = 0x70,

73 
	mFLASH_READ_DEVICE_ID_DUAL_CME
 = 0x92,

74 
	mRLASH_READ_DEVICE_ID_QUAD_CMD
 = 0x94,

75 
	mFLASH_ERASE_SECURITY_REGISTERS_CMD
 = 0x44,

76 
	mFLASH_PROGRAM_SECURITY_REGISTERS_CMD
 = 0x42,

77 
	mFLASH_READ_SECURITY_REGISTERS_CMD
 = 0x48,

78 
	mFLASH_ENABLE_RESET_CMD
 = 0x99,

80 
	mFLASH_ENABLE_RESET
 = 0x66,

81 
	mFLASH_DISABLE_SO_TO_OUTPUT
 = 0x80,

82 }
	tÊash_comm™d_e
;

88 
	mFLASH_TYPE_PUYA
 = 0,

89 }
	tÊash_ty≥_e
;

100 
	mFLASH_SIZE_64K
 = 0x10,

101 
	mFLASH_SIZE_128K
 = 0x11,

102 
	mFLASH_SIZE_256K
 = 0x12,

103 
	mFLASH_SIZE_512K
 = 0x13,

104 
	mFLASH_SIZE_1M
 = 0x14,

105 
	mFLASH_SIZE_2M
 = 0x15,

106 
	mFLASH_SIZE_4M
 = 0x16,

107 
	mFLASH_SIZE_8M
 = 0x17,

108 } 
	tÊash_ˇ∑côy_e
;

111 
	mÊash_ªad_cmd
;

112 
	mÊash_ªad_dummy
:4;

113 
	mÊash_ªad_d©a_löe
:2;

114 
	mÊash_ªad_addr_löe
:1;

115 
	mÊash_ªad_cmd_löe
:1;

116 }
	tÊash_xù_c⁄fig_t
;

122 
_©åibuã_ãxt_£c_
 
Êash_îa£_∑ge
(
addr
);

129 
_©åibuã_ãxt_£c_
 
Êash_îa£_£˘‹
(
addr
);

136 
_©åibuã_ãxt_£c_
 
Êash_îa£_32kblock
(
addr
);

143 
_©åibuã_ãxt_£c_
 
Êash_îa£_64kblock
(
addr
);

149 
_©åibuã_ãxt_£c_
 
Êash_îa£_chù
();

158 
_©åibuã_ãxt_£c_
 
Êash_wrôe_∑ge
(
addr
, 
Àn
, *
buf
);

167 
_©åibuã_ãxt_£c_
 
Êash_ªad_∑ge
(
addr
, 
Àn
, *
buf
);

174 
_©åibuã_ãxt_£c_
 
Êash_wrôe_°©us
(
d©a
);

180 
_©åibuã_ãxt_£c_
 
Êash_ªad_°©us
();

190 
_©åibuã_ãxt_£c_
 
Êash_dìp_powîdown
();

201 
_©åibuã_ãxt_£c_
 
Êash_ªÀa£_dìp_powîdown
();

210 
_©åibuã_ãxt_£c_
 
Êash_ªad_mid
();

218 
_©åibuã_ãxt_£c_
 
Êash_ªad_uid
(
idcmd
, *
buf
);

226 
_©åibuã_ãxt_£c_
 
Êash_ªad_mid_uid_wôh_check
–*
Êash_mid
 ,*
Êash_uid
);

234 
_©åibuã_ãxt_£c_
 
Êash_lock
(
Êash_ty≥_e
 
ty≥
, 
d©a
);

241 
_©åibuã_ãxt_£c_
 
Êash_u∆ock
(
Êash_ty≥_e
 
ty≥
);

249 
_©åibuã_ãxt_£c_
 
Êash_∂ic_¥ìm±_c⁄fig
(
¥ìm±_í
, 
thªshﬁd
);

257 
_©åibuã_ãxt_£c_
 
Êash_£t_xù_c⁄fig
(
Êash_xù_c⁄fig_t
 
c⁄fig
);

265 
_©åibuã_øm_code_£c_noölöe_
 
Êash_£nd_cmd
(
cmd
);

	@platform/chip_b91/gpio.h

34 #i‚de‡
DRIVERS_GPIO_H_


35 
	#DRIVERS_GPIO_H_


	)

38 
	~"™Æog.h
"

39 
	~"∂ic.h
"

40 
	~"ªg_ö˛ude/gpio_ªg.h
"

57 
	mGPIO_GROUPA
 = 0x000,

58 
	mGPIO_GROUPB
 = 0x100,

59 
	mGPIO_GROUPC
 = 0x200,

60 
	mGPIO_GROUPD
 = 0x300,

61 
	mGPIO_GROUPE
 = 0x400,

62 
	mGPIO_GROUPF
 = 0x500,

63 
	mGPIO_ALL
 = 0x600,

64 
	mGPIO_PA0
 = 
GPIO_GROUPA
 | 
BIT
(0),

65 
	mGPIO_PA1
 = 
GPIO_GROUPA
 | 
BIT
(1),

66 
	mGPIO_PA2
 = 
GPIO_GROUPA
 | 
BIT
(2),

67 
	mGPIO_PA3
 = 
GPIO_GROUPA
 | 
BIT
(3),

68 
	mGPIO_PA4
 = 
GPIO_GROUPA
 | 
BIT
(4),

69 
	mGPIO_PA5
 = 
GPIO_GROUPA
 | 
BIT
(5),
	mGPIO_DM
=
GPIO_PA5
,

70 
	mGPIO_PA6
 = 
GPIO_GROUPA
 | 
BIT
(6),
	mGPIO_DP
=
GPIO_PA6
,

71 
	mGPIO_PA7
 = 
GPIO_GROUPA
 | 
BIT
(7),
	mGPIO_SWS
=
GPIO_PA7
,

72 
	mGPIOA_ALL
 = 
GPIO_GROUPA
 | 0x00ff,

74 
	mGPIO_PB0
 = 
GPIO_GROUPB
 | 
BIT
(0),

75 
	mGPIO_PB1
 = 
GPIO_GROUPB
 | 
BIT
(1),

76 
	mGPIO_PB2
 = 
GPIO_GROUPB
 | 
BIT
(2),

77 
	mGPIO_PB3
 = 
GPIO_GROUPB
 | 
BIT
(3),

78 
	mGPIO_PB4
 = 
GPIO_GROUPB
 | 
BIT
(4),

79 
	mGPIO_PB5
 = 
GPIO_GROUPB
 | 
BIT
(5),

80 
	mGPIO_PB6
 = 
GPIO_GROUPB
 | 
BIT
(6),

81 
	mGPIO_PB7
 = 
GPIO_GROUPB
 | 
BIT
(7),

83 
	mGPIO_PC0
 = 
GPIO_GROUPC
 | 
BIT
(0),
	mGPIO_SWM
=
GPIO_PC0
,

84 
	mGPIO_PC1
 = 
GPIO_GROUPC
 | 
BIT
(1),

85 
	mGPIO_PC2
 = 
GPIO_GROUPC
 | 
BIT
(2),

86 
	mGPIO_PC3
 = 
GPIO_GROUPC
 | 
BIT
(3),

87 
	mGPIO_PC4
 = 
GPIO_GROUPC
 | 
BIT
(4),

88 
	mGPIO_PC5
 = 
GPIO_GROUPC
 | 
BIT
(5),

89 
	mGPIO_PC6
 = 
GPIO_GROUPC
 | 
BIT
(6),

90 
	mGPIO_PC7
 = 
GPIO_GROUPC
 | 
BIT
(7),

91 
	mGPIOC_ALL
 = 
GPIO_GROUPC
 | 0x00ff,

93 
	mGPIO_PD0
 = 
GPIO_GROUPD
 | 
BIT
(0),

94 
	mGPIO_PD1
 = 
GPIO_GROUPD
 | 
BIT
(1),

95 
	mGPIO_PD2
 = 
GPIO_GROUPD
 | 
BIT
(2),

96 
	mGPIO_PD3
 = 
GPIO_GROUPD
 | 
BIT
(3),

97 
	mGPIO_PD4
 = 
GPIO_GROUPD
 | 
BIT
(4),

98 
	mGPIO_PD5
 = 
GPIO_GROUPD
 | 
BIT
(5),

99 
	mGPIO_PD6
 = 
GPIO_GROUPD
 | 
BIT
(6),

100 
	mGPIO_PD7
 = 
GPIO_GROUPD
 | 
BIT
(7),

102 
	mGPIO_PE0
 = 
GPIO_GROUPE
 | 
BIT
(0),

103 
	mGPIO_PE1
 = 
GPIO_GROUPE
 | 
BIT
(1),

104 
	mGPIO_PE2
 = 
GPIO_GROUPE
 | 
BIT
(2),

105 
	mGPIO_PE3
 = 
GPIO_GROUPE
 | 
BIT
(3),

106 
	mGPIO_PE4
 = 
GPIO_GROUPE
 | 
BIT
(4),

107 
	mGPIO_PE5
 = 
GPIO_GROUPE
 | 
BIT
(5),

108 
	mGPIO_PE6
 = 
GPIO_GROUPE
 | 
BIT
(6),

109 
	mGPIO_PE7
 = 
GPIO_GROUPE
 | 
BIT
(7),

110 
	mGPIOE_ALL
 = 
GPIO_GROUPE
 | 0x00ff,

112 
	mGPIO_PF0
 = 
GPIO_GROUPF
 | 
BIT
(0),

113 
	mGPIO_PF1
 = 
GPIO_GROUPF
 | 
BIT
(1),

114 
	mGPIO_PF2
 = 
GPIO_GROUPF
 | 
BIT
(2),

115 
	mGPIO_PF3
 = 
GPIO_GROUPF
 | 
BIT
(3),

117 }
	tgpio_pö_e
;

123 
	mAS_GPIO
,

124 
	mAS_MSPI
,

126 
	mAS_SWS
,

127 
	mAS_SWM
,

129 
	mAS_USB_DP
,

130 
	mAS_USB_DM
,

132 
	mAS_TDI
,

133 
	mAS_TDO
,

134 
	mAS_TMS
,

135 
	mAS_TCK
,

139 }
	tgpio_fuc_e
;

147 
	mPOL_RISING
 = 0,

148 
	mPOL_FALLING
 = 1,

149 }
	tgpio_pﬁ_e
;

156 
	mINTR_RISING_EDGE
=0,

157 
	mINTR_FALLING_EDGE
 ,

158 
	mINTR_HIGH_LEVEL
,

159 
	mINTR_LOW_LEVEL
,

160 } 
	tgpio_úq_åiggî_ty≥_e
;

166 
	mGPIO_PIN_UP_DOWN_FLOAT
 = 0,

167 
	mGPIO_PIN_PULLUP_1M
 = 1,

168 
	mGPIO_PIN_PULLDOWN_100K
 = 2,

169 
	mGPIO_PIN_PULLUP_10K
 = 3,

170 }
	tgpio_puŒ_ty≥_e
;

180 
ölöe
 
	$gpio_fun˘i⁄_í
(
gpio_pö_e
 
pö
)

182 
bô
 = 
pö
 & 0xff;

183 
	`BM_SET
(
	`ªg_gpio_func
(
pö
), 
bô
);

184 
	}
}

192 
ölöe
 
	$gpio_fun˘i⁄_dis
(
gpio_pö_e
 
pö
)

194 
bô
 = 
pö
 & 0xff;

195 
	`BM_CLR
(
	`ªg_gpio_func
(
pö
), 
bô
);

196 
	}
}

205 
ölöe
 
	$gpio_£t_high_Àvñ
(
gpio_pö_e
 
pö
)

207 
bô
 = 
pö
 & 0xff;

208 
	`BM_SET
(
	`ªg_gpio_out
(
pö
), 
bô
);

210 
	}
}

218 
ölöe
 
	$gpio_£t_low_Àvñ
(
gpio_pö_e
 
pö
)

220 
bô
 = 
pö
 & 0xff;

221 
	`BM_CLR
(
	`ªg_gpio_out
(
pö
), 
bô
);

223 
	}
}

231 
ölöe
 
	$gpio_£t_Àvñ
(
gpio_pö_e
 
pö
, 
vÆue
)

233 if(
vÆue
)

235 
	`gpio_£t_high_Àvñ
(
pö
);

239 
	`gpio_£t_low_Àvñ
(
pö
);

241 
	}
}

249 
ölöe
 
_Boﬁ
 
	$gpio_gë_Àvñ
(
gpio_pö_e
 
pö
)

251  
	`BM_IS_SET
(
	`ªg_gpio_ö
(
pö
),Öin & 0xff);

252 
	}
}

260 
ölöe
 
	$gpio_gë_Àvñ_Æl
(*
p
)

262 
p
[0] = 
ªg_gpio_∑_ö
;

263 
p
[1] = 
ªg_gpio_pb_ö
;

264 
p
[2] = 
ªg_gpio_pc_ö
;

265 
p
[3] = 
ªg_gpio_pd_ö
;

266 
p
[4] = 
ªg_gpio_≥_ö
;

267 
	}
}

276 
ölöe
 
	$gpio_toggÀ
(
gpio_pö_e
 
pö
)

278 
	`ªg_gpio_out
(
pö
) ^= (pin & 0xFF);

279 
	}
}

288 
ölöe
 
	$gpio_ouçut_í
(
gpio_pö_e
 
pö
)

290 
bô
 = 
pö
 & 0xff;

291 
	`BM_CLR
(
	`ªg_gpio_€n
(
pö
), 
bô
);

292 
	}
}

299 
ölöe
 
	$gpio_ouçut_dis
(
gpio_pö_e
 
pö
)

301 
bô
 = 
pö
 & 0xff;

302 
	`BM_SET
(
	`ªg_gpio_€n
(
pö
), 
bô
);

303 
	}
}

310 
ölöe
 
	$gpio_£t_ouçut
(
gpio_pö_e
 
pö
, 
vÆue
)

312 if(
vÆue
)

314 
	`gpio_ouçut_í
(
pö
);

318 
	`gpio_ouçut_dis
(
pö
);

321 
	}
}

328 
ölöe
 
_Boﬁ
 
	$gpio_is_ouçut_í
(
gpio_pö_e
 
pö
)

330  !
	`BM_IS_SET
(
	`ªg_gpio_€n
(
pö
),Öin & 0xff);

331 
	}
}

340 
ölöe
 
_Boﬁ
 
	$gpio_is_öput_í
(
gpio_pö_e
 
pö
)

342  
	`BM_IS_SET
(
	`ªg_gpio_õ
(
pö
),Öin & 0xff);

343 
	}
}

350 
ölöe
 
	$gpio_úq_í
(
gpio_pö_e
 
pö
)

352 
	`BM_SET
(
	`ªg_gpio_úq_í
(
pö
),Öin & 0xff);

353 
	}
}

360 
ölöe
 
	$gpio_úq_dis
(
gpio_pö_e
 
pö
)

362 
	`BM_CLR
(
	`ªg_gpio_úq_í
(
pö
),Öin & 0xff);

363 
	}
}

370 
ölöe
 
	$gpio_gpio2risc0_úq_í
(
gpio_pö_e
 
pö
)

372 
	`BM_SET
(
	`ªg_gpio_úq_risc0_í
(
pö
),Öin & 0xff);

373 
	}
}

379 
ölöe
 
	$gpio_gpio2risc0_úq_dis
(
gpio_pö_e
 
pö
)

381 
	`BM_CLR
(
	`ªg_gpio_úq_risc0_í
(
pö
),Öin & 0xff);

382 
	}
}

388 
ölöe
 
	$gpio_gpio2risc1_úq_í
(
gpio_pö_e
 
pö
)

390 
	`BM_SET
(
	`ªg_gpio_úq_risc1_í
(
pö
),Öin & 0xff);

391 
	}
}

398 
ölöe
 
	$gpio_gpio2risc1_úq_dis
(
gpio_pö_e
 
pö
)

400 
	`BM_CLR
(
	`ªg_gpio_úq_risc1_í
(
pö
),Öin & 0xff);

401 
	}
}

407 
ölöe
 
	$gpio_˛r_úq_°©us
(
gpio_úq_°©us_e
 
°©us
)

409 
ªg_gpio_úq_˛r
=
°©us
;

410 
	}
}

417 
gpio_ds_í
(
gpio_pö_e
 
pö
);

425 
gpio_ds_dis
(
gpio_pö_e
 
pö
);

430 
gpio_£t_úq
(
gpio_pö_e
 
pö
, 
gpio_úq_åiggî_ty≥_e
 
åiggî_ty≥
);

438 
gpio_£t_gpio2risc0_úq
(
gpio_pö_e
 
pö
, 
gpio_úq_åiggî_ty≥_e
 
åiggî_ty≥
);

446 
gpio_£t_gpio2risc1_úq
(
gpio_pö_e
 
pö
, 
gpio_úq_åiggî_ty≥_e
 
åiggî_ty≥
);

454 
gpio_öput_í
(
gpio_pö_e
 
pö
);

461 
gpio_öput_dis
(
gpio_pö_e
 
pö
);

469 
gpio_£t_öput
(
gpio_pö_e
 
pö
, 
vÆue
);

475 
gpio_shutdown
(
gpio_pö_e
 
pö
);

483 
gpio_£t_up_down_ªs
(
gpio_pö_e
 
pö
, 
gpio_puŒ_ty≥_e
 
up_down_ªs
);

490 
gpio_£t_puŒup_ªs_30k
(
gpio_pö_e
 
pö
);

	@platform/chip_b91/gpio_default.h

24 #i‚de‡
DRIVERS_GPIO_DEFAULT_H_


25 
	#DRIVERS_GPIO_DEFAULT_H_


	)

27 
	~"compûî.h
"

28 
	~"gpio.h
"

32 #i‚de‡
PA0_INPUT_ENABLE


33 
	#PA0_INPUT_ENABLE
 0

	)

35 #i‚de‡
PA1_INPUT_ENABLE


36 
	#PA1_INPUT_ENABLE
 0

	)

38 #i‚de‡
PA2_INPUT_ENABLE


39 
	#PA2_INPUT_ENABLE
 0

	)

41 #i‚de‡
PA3_INPUT_ENABLE


42 
	#PA3_INPUT_ENABLE
 0

	)

44 #i‚de‡
PA4_INPUT_ENABLE


45 
	#PA4_INPUT_ENABLE
 0

	)

47 #i‚de‡
PA5_INPUT_ENABLE


48 
	#PA5_INPUT_ENABLE
 0

50 #i‚de‡
PA6_INPUT_ENABLE


	)

51 
	#PA6_INPUT_ENABLE
 0

53 #i‚de‡
PA7_INPUT_ENABLE


	)

54 
	#PA7_INPUT_ENABLE
 1

56 #i‚de‡
PA0_OUTPUT_ENABLE


	)

57 
	#PA0_OUTPUT_ENABLE
 0

	)

59 #i‚de‡
PA1_OUTPUT_ENABLE


60 
	#PA1_OUTPUT_ENABLE
 0

	)

62 #i‚de‡
PA2_OUTPUT_ENABLE


63 
	#PA2_OUTPUT_ENABLE
 0

	)

65 #i‚de‡
PA3_OUTPUT_ENABLE


66 
	#PA3_OUTPUT_ENABLE
 0

	)

68 #i‚de‡
PA4_OUTPUT_ENABLE


69 
	#PA4_OUTPUT_ENABLE
 0

	)

71 #i‚de‡
PA5_OUTPUT_ENABLE


72 
	#PA5_OUTPUT_ENABLE
 0

	)

74 #i‚de‡
PA6_OUTPUT_ENABLE


75 
	#PA6_OUTPUT_ENABLE
 0

	)

77 #i‚de‡
PA7_OUTPUT_ENABLE


78 
	#PA7_OUTPUT_ENABLE
 0

	)

80 #i‚de‡
PA0_DATA_STRENGTH


81 
	#PA0_DATA_STRENGTH
 1

	)

83 #i‚de‡
PA1_DATA_STRENGTH


84 
	#PA1_DATA_STRENGTH
 1

	)

86 #i‚de‡
PA2_DATA_STRENGTH


87 
	#PA2_DATA_STRENGTH
 1

	)

89 #i‚de‡
PA3_DATA_STRENGTH


90 
	#PA3_DATA_STRENGTH
 1

	)

92 #i‚de‡
PA4_DATA_STRENGTH


93 
	#PA4_DATA_STRENGTH
 1

	)

95 #i‚de‡
PA5_DATA_STRENGTH


96 
	#PA5_DATA_STRENGTH
 1

	)

98 #i‚de‡
PA6_DATA_STRENGTH


99 
	#PA6_DATA_STRENGTH
 1

	)

101 #i‚de‡
PA7_DATA_STRENGTH


102 
	#PA7_DATA_STRENGTH
 1

	)

104 #i‚de‡
PA0_DATA_OUT


105 
	#PA0_DATA_OUT
 0

	)

107 #i‚de‡
PA1_DATA_OUT


108 
	#PA1_DATA_OUT
 0

	)

110 #i‚de‡
PA2_DATA_OUT


111 
	#PA2_DATA_OUT
 0

	)

113 #i‚de‡
PA3_DATA_OUT


114 
	#PA3_DATA_OUT
 0

	)

116 #i‚de‡
PA4_DATA_OUT


117 
	#PA4_DATA_OUT
 0

	)

119 #i‚de‡
PA5_DATA_OUT


120 
	#PA5_DATA_OUT
 0

	)

122 #i‚de‡
PA6_DATA_OUT


123 
	#PA6_DATA_OUT
 0

	)

125 #i‚de‡
PA7_DATA_OUT


126 
	#PA7_DATA_OUT
 0

	)

128 #i‚de‡
PA0_FUNC


129 
	#PA0_FUNC
 
AS_GPIO


	)

131 #i‚de‡
PA1_FUNC


132 
	#PA1_FUNC
 
AS_GPIO


	)

134 #i‚de‡
PA2_FUNC


135 
	#PA2_FUNC
 
AS_GPIO


	)

137 #i‚de‡
PA3_FUNC


138 
	#PA3_FUNC
 
AS_GPIO


	)

140 #i‚de‡
PA4_FUNC


141 
	#PA4_FUNC
 
AS_GPIO


	)

143 #i‚de‡
PA5_FUNC


144 
	#PA5_FUNC
 
AS_GPIO


	)

146 #i‚de‡
PA6_FUNC


147 
	#PA6_FUNC
 
AS_GPIO


	)

149 #i‚de‡
PA7_FUNC


150 
	#PA7_FUNC
 
AS_SWS


	)

152 #i‚de‡
PULL_WAKEUP_SRC_PA0


153 
	#PULL_WAKEUP_SRC_PA0
 0

	)

155 #i‚de‡
PULL_WAKEUP_SRC_PA1


156 
	#PULL_WAKEUP_SRC_PA1
 0

	)

158 #i‚de‡
PULL_WAKEUP_SRC_PA2


159 
	#PULL_WAKEUP_SRC_PA2
 0

	)

161 #i‚de‡
PULL_WAKEUP_SRC_PA3


162 
	#PULL_WAKEUP_SRC_PA3
 0

	)

164 #i‚de‡
PULL_WAKEUP_SRC_PA4


165 
	#PULL_WAKEUP_SRC_PA4
 0

	)

167 #i‚de‡
PULL_WAKEUP_SRC_PA5


168 
	#PULL_WAKEUP_SRC_PA5
 0

	)

170 #i‚de‡
PULL_WAKEUP_SRC_PA6


171 
	#PULL_WAKEUP_SRC_PA6
 0

	)

173 #i‚de‡
PULL_WAKEUP_SRC_PA7


174 
	#PULL_WAKEUP_SRC_PA7
 
GPIO_PIN_PULLUP_1M


176 

	)

178 #i‚de‡
PB0_INPUT_ENABLE


179 
	#PB0_INPUT_ENABLE
 0

	)

181 #i‚de‡
PB1_INPUT_ENABLE


182 
	#PB1_INPUT_ENABLE
 0

	)

184 #i‚de‡
PB2_INPUT_ENABLE


185 
	#PB2_INPUT_ENABLE
 0

	)

187 #i‚de‡
PB3_INPUT_ENABLE


188 
	#PB3_INPUT_ENABLE
 0

	)

190 #i‚de‡
PB4_INPUT_ENABLE


191 
	#PB4_INPUT_ENABLE
 0

	)

193 #i‚de‡
PB5_INPUT_ENABLE


194 
	#PB5_INPUT_ENABLE
 0

	)

196 #i‚de‡
PB6_INPUT_ENABLE


197 
	#PB6_INPUT_ENABLE
 0

	)

199 #i‚de‡
PB7_INPUT_ENABLE


200 
	#PB7_INPUT_ENABLE
 0

	)

202 #i‚de‡
PB0_OUTPUT_ENABLE


203 
	#PB0_OUTPUT_ENABLE
 0

	)

205 #i‚de‡
PB1_OUTPUT_ENABLE


206 
	#PB1_OUTPUT_ENABLE
 0

	)

208 #i‚de‡
PB2_OUTPUT_ENABLE


209 
	#PB2_OUTPUT_ENABLE
 0

	)

211 #i‚de‡
PB3_OUTPUT_ENABLE


212 
	#PB3_OUTPUT_ENABLE
 0

	)

214 #i‚de‡
PB4_OUTPUT_ENABLE


215 
	#PB4_OUTPUT_ENABLE
 0

	)

217 #i‚de‡
PB5_OUTPUT_ENABLE


218 
	#PB5_OUTPUT_ENABLE
 0

	)

220 #i‚de‡
PB6_OUTPUT_ENABLE


221 
	#PB6_OUTPUT_ENABLE
 0

	)

223 #i‚de‡
PB7_OUTPUT_ENABLE


224 
	#PB7_OUTPUT_ENABLE
 0

	)

226 #i‚de‡
PB0_DATA_STRENGTH


227 
	#PB0_DATA_STRENGTH
 1

	)

229 #i‚de‡
PB1_DATA_STRENGTH


230 
	#PB1_DATA_STRENGTH
 1

	)

232 #i‚de‡
PB2_DATA_STRENGTH


233 
	#PB2_DATA_STRENGTH
 1

	)

235 #i‚de‡
PB3_DATA_STRENGTH


236 
	#PB3_DATA_STRENGTH
 1

	)

238 #i‚de‡
PB4_DATA_STRENGTH


239 
	#PB4_DATA_STRENGTH
 1

	)

241 #i‚de‡
PB5_DATA_STRENGTH


242 
	#PB5_DATA_STRENGTH
 1

	)

244 #i‚de‡
PB6_DATA_STRENGTH


245 
	#PB6_DATA_STRENGTH
 1

	)

247 #i‚de‡
PB7_DATA_STRENGTH


248 
	#PB7_DATA_STRENGTH
 1

	)

250 #i‚de‡
PB0_DATA_OUT


251 
	#PB0_DATA_OUT
 0

	)

253 #i‚de‡
PB1_DATA_OUT


254 
	#PB1_DATA_OUT
 0

	)

256 #i‚de‡
PB2_DATA_OUT


257 
	#PB2_DATA_OUT
 0

	)

259 #i‚de‡
PB3_DATA_OUT


260 
	#PB3_DATA_OUT
 0

	)

262 #i‚de‡
PB4_DATA_OUT


263 
	#PB4_DATA_OUT
 0

	)

265 #i‚de‡
PB5_DATA_OUT


266 
	#PB5_DATA_OUT
 0

	)

268 #i‚de‡
PB6_DATA_OUT


269 
	#PB6_DATA_OUT
 0

	)

271 #i‚de‡
PB7_DATA_OUT


272 
	#PB7_DATA_OUT
 0

	)

274 #i‚de‡
PB0_FUNC


275 
	#PB0_FUNC
 
AS_GPIO


	)

277 #i‚de‡
PB1_FUNC


278 
	#PB1_FUNC
 
AS_GPIO


	)

280 #i‚de‡
PB2_FUNC


281 
	#PB2_FUNC
 
AS_GPIO


	)

283 #i‚de‡
PB3_FUNC


284 
	#PB3_FUNC
 
AS_GPIO


	)

286 #i‚de‡
PB4_FUNC


287 
	#PB4_FUNC
 
AS_GPIO


	)

289 #i‚de‡
PB5_FUNC


290 
	#PB5_FUNC
 
AS_GPIO


	)

292 #i‚de‡
PB6_FUNC


293 
	#PB6_FUNC
 
AS_GPIO


	)

295 #i‚de‡
PB7_FUNC


296 
	#PB7_FUNC
 
AS_GPIO


	)

298 #i‚de‡
PULL_WAKEUP_SRC_PB0


299 
	#PULL_WAKEUP_SRC_PB0
 0

	)

301 #i‚de‡
PULL_WAKEUP_SRC_PB1


302 
	#PULL_WAKEUP_SRC_PB1
 0

	)

304 #i‚de‡
PULL_WAKEUP_SRC_PB2


305 
	#PULL_WAKEUP_SRC_PB2
 0

	)

307 #i‚de‡
PULL_WAKEUP_SRC_PB3


308 
	#PULL_WAKEUP_SRC_PB3
 0

	)

310 #i‚de‡
PULL_WAKEUP_SRC_PB4


311 
	#PULL_WAKEUP_SRC_PB4
 0

	)

313 #i‚de‡
PULL_WAKEUP_SRC_PB5


314 
	#PULL_WAKEUP_SRC_PB5
 0

	)

316 #i‚de‡
PULL_WAKEUP_SRC_PB6


317 
	#PULL_WAKEUP_SRC_PB6
 0

	)

319 #i‚de‡
PULL_WAKEUP_SRC_PB7


320 
	#PULL_WAKEUP_SRC_PB7
 0

	)

324 #i‚de‡
PC0_INPUT_ENABLE


325 
	#PC0_INPUT_ENABLE
 0

	)

327 #i‚de‡
PC1_INPUT_ENABLE


328 
	#PC1_INPUT_ENABLE
 0

	)

330 #i‚de‡
PC2_INPUT_ENABLE


331 
	#PC2_INPUT_ENABLE
 0

	)

333 #i‚de‡
PC3_INPUT_ENABLE


334 
	#PC3_INPUT_ENABLE
 0

	)

336 #i‚de‡
PC4_INPUT_ENABLE


337 
	#PC4_INPUT_ENABLE
 0

	)

339 #i‚de‡
PC5_INPUT_ENABLE


340 
	#PC5_INPUT_ENABLE
 0

	)

342 #i‚de‡
PC6_INPUT_ENABLE


343 
	#PC6_INPUT_ENABLE
 0

	)

345 #i‚de‡
PC7_INPUT_ENABLE


346 
	#PC7_INPUT_ENABLE
 0

	)

348 #i‚de‡
PC0_OUTPUT_ENABLE


349 
	#PC0_OUTPUT_ENABLE
 0

	)

351 #i‚de‡
PC1_OUTPUT_ENABLE


352 
	#PC1_OUTPUT_ENABLE
 0

	)

354 #i‚de‡
PC2_OUTPUT_ENABLE


355 
	#PC2_OUTPUT_ENABLE
 0

	)

357 #i‚de‡
PC3_OUTPUT_ENABLE


358 
	#PC3_OUTPUT_ENABLE
 0

	)

360 #i‚de‡
PC4_OUTPUT_ENABLE


361 
	#PC4_OUTPUT_ENABLE
 0

	)

363 #i‚de‡
PC5_OUTPUT_ENABLE


364 
	#PC5_OUTPUT_ENABLE
 0

	)

366 #i‚de‡
PC6_OUTPUT_ENABLE


367 
	#PC6_OUTPUT_ENABLE
 0

	)

369 #i‚de‡
PC7_OUTPUT_ENABLE


370 
	#PC7_OUTPUT_ENABLE
 0

	)

372 #i‚de‡
PC0_DATA_STRENGTH


373 
	#PC0_DATA_STRENGTH
 1

	)

375 #i‚de‡
PC1_DATA_STRENGTH


376 
	#PC1_DATA_STRENGTH
 1

	)

378 #i‚de‡
PC2_DATA_STRENGTH


379 
	#PC2_DATA_STRENGTH
 1

	)

381 #i‚de‡
PC3_DATA_STRENGTH


382 
	#PC3_DATA_STRENGTH
 1

	)

384 #i‚de‡
PC4_DATA_STRENGTH


385 
	#PC4_DATA_STRENGTH
 1

	)

387 #i‚de‡
PC5_DATA_STRENGTH


388 
	#PC5_DATA_STRENGTH
 1

	)

390 #i‚de‡
PC6_DATA_STRENGTH


391 
	#PC6_DATA_STRENGTH
 1

	)

393 #i‚de‡
PC7_DATA_STRENGTH


394 
	#PC7_DATA_STRENGTH
 1

	)

396 #i‚de‡
PC0_DATA_OUT


397 
	#PC0_DATA_OUT
 0

	)

399 #i‚de‡
PC1_DATA_OUT


400 
	#PC1_DATA_OUT
 0

	)

402 #i‚de‡
PC2_DATA_OUT


403 
	#PC2_DATA_OUT
 0

	)

405 #i‚de‡
PC3_DATA_OUT


406 
	#PC3_DATA_OUT
 0

	)

408 #i‚de‡
PC4_DATA_OUT


409 
	#PC4_DATA_OUT
 0

	)

411 #i‚de‡
PC5_DATA_OUT


412 
	#PC5_DATA_OUT
 0

	)

414 #i‚de‡
PC6_DATA_OUT


415 
	#PC6_DATA_OUT
 0

	)

417 #i‚de‡
PC7_DATA_OUT


418 
	#PC7_DATA_OUT
 0

	)

420 #i‚de‡
PC0_FUNC


421 
	#PC0_FUNC
 
AS_GPIO


	)

423 #i‚de‡
PC1_FUNC


424 
	#PC1_FUNC
 
AS_GPIO


	)

426 #i‚de‡
PC2_FUNC


427 
	#PC2_FUNC
 
AS_GPIO


	)

429 #i‚de‡
PC3_FUNC


430 
	#PC3_FUNC
 
AS_GPIO


	)

432 #i‚de‡
PC4_FUNC


433 
	#PC4_FUNC
 
AS_GPIO


	)

435 #i‚de‡
PC5_FUNC


436 
	#PC5_FUNC
 
AS_GPIO


	)

438 #i‚de‡
PC6_FUNC


439 
	#PC6_FUNC
 
AS_GPIO


	)

441 #i‚de‡
PC7_FUNC


442 
	#PC7_FUNC
 
AS_GPIO


	)

444 #i‚de‡
PULL_WAKEUP_SRC_PC0


445 
	#PULL_WAKEUP_SRC_PC0
 0

	)

447 #i‚de‡
PULL_WAKEUP_SRC_PC1


448 
	#PULL_WAKEUP_SRC_PC1
 0

	)

450 #i‚de‡
PULL_WAKEUP_SRC_PC2


451 
	#PULL_WAKEUP_SRC_PC2
 0

	)

453 #i‚de‡
PULL_WAKEUP_SRC_PC3


454 
	#PULL_WAKEUP_SRC_PC3
 0

	)

456 #i‚de‡
PULL_WAKEUP_SRC_PC4


457 
	#PULL_WAKEUP_SRC_PC4
 0

	)

459 #i‚de‡
PULL_WAKEUP_SRC_PC5


460 
	#PULL_WAKEUP_SRC_PC5
 0

	)

462 #i‚de‡
PULL_WAKEUP_SRC_PC6


463 
	#PULL_WAKEUP_SRC_PC6
 0

	)

465 #i‚de‡
PULL_WAKEUP_SRC_PC7


466 
	#PULL_WAKEUP_SRC_PC7
 0

	)

470 #i‚de‡
PD0_INPUT_ENABLE


471 
	#PD0_INPUT_ENABLE
 0

	)

473 #i‚de‡
PD1_INPUT_ENABLE


474 
	#PD1_INPUT_ENABLE
 0

	)

476 #i‚de‡
PD2_INPUT_ENABLE


477 
	#PD2_INPUT_ENABLE
 0

	)

479 #i‚de‡
PD3_INPUT_ENABLE


480 
	#PD3_INPUT_ENABLE
 0

	)

482 #i‚de‡
PD4_INPUT_ENABLE


483 
	#PD4_INPUT_ENABLE
 0

	)

485 #i‚de‡
PD5_INPUT_ENABLE


486 
	#PD5_INPUT_ENABLE
 0

	)

488 #i‚de‡
PD6_INPUT_ENABLE


489 
	#PD6_INPUT_ENABLE
 0

	)

491 #i‚de‡
PD7_INPUT_ENABLE


492 
	#PD7_INPUT_ENABLE
 0

	)

494 #i‚de‡
PD0_OUTPUT_ENABLE


495 
	#PD0_OUTPUT_ENABLE
 0

	)

497 #i‚de‡
PD1_OUTPUT_ENABLE


498 
	#PD1_OUTPUT_ENABLE
 0

	)

500 #i‚de‡
PD2_OUTPUT_ENABLE


501 
	#PD2_OUTPUT_ENABLE
 0

	)

503 #i‚de‡
PD3_OUTPUT_ENABLE


504 
	#PD3_OUTPUT_ENABLE
 0

	)

506 #i‚de‡
PD4_OUTPUT_ENABLE


507 
	#PD4_OUTPUT_ENABLE
 0

	)

509 #i‚de‡
PD5_OUTPUT_ENABLE


510 
	#PD5_OUTPUT_ENABLE
 0

	)

512 #i‚de‡
PD6_OUTPUT_ENABLE


513 
	#PD6_OUTPUT_ENABLE
 0

	)

515 #i‚de‡
PD7_OUTPUT_ENABLE


516 
	#PD7_OUTPUT_ENABLE
 0

	)

518 #i‚de‡
PD0_DATA_STRENGTH


519 
	#PD0_DATA_STRENGTH
 1

	)

521 #i‚de‡
PD1_DATA_STRENGTH


522 
	#PD1_DATA_STRENGTH
 1

	)

524 #i‚de‡
PD2_DATA_STRENGTH


525 
	#PD2_DATA_STRENGTH
 1

	)

527 #i‚de‡
PD3_DATA_STRENGTH


528 
	#PD3_DATA_STRENGTH
 1

	)

530 #i‚de‡
PD4_DATA_STRENGTH


531 
	#PD4_DATA_STRENGTH
 1

	)

533 #i‚de‡
PD5_DATA_STRENGTH


534 
	#PD5_DATA_STRENGTH
 1

	)

536 #i‚de‡
PD6_DATA_STRENGTH


537 
	#PD6_DATA_STRENGTH
 1

	)

539 #i‚de‡
PD7_DATA_STRENGTH


540 
	#PD7_DATA_STRENGTH
 1

	)

542 #i‚de‡
PD0_DATA_OUT


543 
	#PD0_DATA_OUT
 0

	)

545 #i‚de‡
PD1_DATA_OUT


546 
	#PD1_DATA_OUT
 0

	)

548 #i‚de‡
PD2_DATA_OUT


549 
	#PD2_DATA_OUT
 0

	)

551 #i‚de‡
PD3_DATA_OUT


552 
	#PD3_DATA_OUT
 0

	)

554 #i‚de‡
PD4_DATA_OUT


555 
	#PD4_DATA_OUT
 0

	)

557 #i‚de‡
PD5_DATA_OUT


558 
	#PD5_DATA_OUT
 0

	)

560 #i‚de‡
PD6_DATA_OUT


561 
	#PD6_DATA_OUT
 0

	)

563 #i‚de‡
PD7_DATA_OUT


564 
	#PD7_DATA_OUT
 0

	)

566 #i‚de‡
PD0_FUNC


567 
	#PD0_FUNC
 
AS_GPIO


	)

569 #i‚de‡
PD1_FUNC


570 
	#PD1_FUNC
 
AS_GPIO


	)

572 #i‚de‡
PD2_FUNC


573 
	#PD2_FUNC
 
AS_GPIO


	)

575 #i‚de‡
PD3_FUNC


576 
	#PD3_FUNC
 
AS_GPIO


	)

578 #i‚de‡
PD4_FUNC


579 
	#PD4_FUNC
 
AS_GPIO


	)

581 #i‚de‡
PD5_FUNC


582 
	#PD5_FUNC
 
AS_GPIO


	)

584 #i‚de‡
PD6_FUNC


585 
	#PD6_FUNC
 
AS_GPIO


	)

587 #i‚de‡
PD7_FUNC


588 
	#PD7_FUNC
 
AS_GPIO


	)

590 #i‚de‡
PULL_WAKEUP_SRC_PD0


591 
	#PULL_WAKEUP_SRC_PD0
 0

	)

593 #i‚de‡
PULL_WAKEUP_SRC_PD1


594 
	#PULL_WAKEUP_SRC_PD1
 0

	)

596 #i‚de‡
PULL_WAKEUP_SRC_PD2


597 
	#PULL_WAKEUP_SRC_PD2
 0

	)

599 #i‚de‡
PULL_WAKEUP_SRC_PD3


600 
	#PULL_WAKEUP_SRC_PD3
 0

	)

602 #i‚de‡
PULL_WAKEUP_SRC_PD4


603 
	#PULL_WAKEUP_SRC_PD4
 0

	)

605 #i‚de‡
PULL_WAKEUP_SRC_PD5


606 
	#PULL_WAKEUP_SRC_PD5
 0

	)

608 #i‚de‡
PULL_WAKEUP_SRC_PD6


609 
	#PULL_WAKEUP_SRC_PD6
 0

	)

611 #i‚de‡
PULL_WAKEUP_SRC_PD7


612 
	#PULL_WAKEUP_SRC_PD7
 0

	)

616 #i‚de‡
PE0_INPUT_ENABLE


617 
	#PE0_INPUT_ENABLE
 0

	)

619 #i‚de‡
PE1_INPUT_ENABLE


620 
	#PE1_INPUT_ENABLE
 0

	)

622 #i‚de‡
PE2_INPUT_ENABLE


623 
	#PE2_INPUT_ENABLE
 0

	)

625 #i‚de‡
PE3_INPUT_ENABLE


626 
	#PE3_INPUT_ENABLE
 0

	)

628 #i‚de‡
PE4_INPUT_ENABLE


629 
	#PE4_INPUT_ENABLE
 0

	)

631 #i‚de‡
PE5_INPUT_ENABLE


632 
	#PE5_INPUT_ENABLE
 0

	)

634 #i‚de‡
PE6_INPUT_ENABLE


635 
	#PE6_INPUT_ENABLE
 1

	)

637 #i‚de‡
PE7_INPUT_ENABLE


638 
	#PE7_INPUT_ENABLE
 1

	)

641 #i‚de‡
PE0_OUTPUT_ENABLE


642 
	#PE0_OUTPUT_ENABLE
 0

	)

644 #i‚de‡
PE1_OUTPUT_ENABLE


645 
	#PE1_OUTPUT_ENABLE
 0

	)

647 #i‚de‡
PE2_OUTPUT_ENABLE


648 
	#PE2_OUTPUT_ENABLE
 0

	)

650 #i‚de‡
PE3_OUTPUT_ENABLE


651 
	#PE3_OUTPUT_ENABLE
 0

	)

653 #i‚de‡
PE4_OUTPUT_ENABLE


654 
	#PE4_OUTPUT_ENABLE
 0

	)

656 #i‚de‡
PE5_OUTPUT_ENABLE


657 
	#PE5_OUTPUT_ENABLE
 0

	)

659 #i‚de‡
PE6_OUTPUT_ENABLE


660 
	#PE6_OUTPUT_ENABLE
 0

	)

662 #i‚de‡
PE7_OUTPUT_ENABLE


663 
	#PE7_OUTPUT_ENABLE
 0

	)

666 #i‚de‡
PE0_DATA_STRENGTH


667 
	#PE0_DATA_STRENGTH
 1

	)

669 #i‚de‡
PE1_DATA_STRENGTH


670 
	#PE1_DATA_STRENGTH
 1

	)

672 #i‚de‡
PE2_DATA_STRENGTH


673 
	#PE2_DATA_STRENGTH
 1

	)

675 #i‚de‡
PE3_DATA_STRENGTH


676 
	#PE3_DATA_STRENGTH
 1

	)

678 #i‚de‡
PE4_DATA_STRENGTH


679 
	#PE4_DATA_STRENGTH
 1

	)

681 #i‚de‡
PE5_DATA_STRENGTH


682 
	#PE5_DATA_STRENGTH
 1

	)

684 #i‚de‡
PE6_DATA_STRENGTH


685 
	#PE6_DATA_STRENGTH
 1

	)

687 #i‚de‡
PE7_DATA_STRENGTH


688 
	#PE7_DATA_STRENGTH
 1

	)

691 #i‚de‡
PE0_DATA_OUT


692 
	#PE0_DATA_OUT
 0

	)

694 #i‚de‡
PE1_DATA_OUT


695 
	#PE1_DATA_OUT
 0

	)

697 #i‚de‡
PE2_DATA_OUT


698 
	#PE2_DATA_OUT
 0

	)

700 #i‚de‡
PE3_DATA_OUT


701 
	#PE3_DATA_OUT
 0

	)

703 #i‚de‡
PE4_DATA_OUT


704 
	#PE4_DATA_OUT
 0

	)

706 #i‚de‡
PE5_DATA_OUT


707 
	#PE5_DATA_OUT
 0

	)

709 #i‚de‡
PE6_DATA_OUT


710 
	#PE6_DATA_OUT
 0

	)

712 #i‚de‡
PE7_DATA_OUT


713 
	#PE7_DATA_OUT
 0

	)

716 #i‚de‡
PE0_FUNC


717 
	#PE0_FUNC
 
AS_GPIO


	)

719 #i‚de‡
PE1_FUNC


720 
	#PE1_FUNC
 
AS_GPIO


	)

722 #i‚de‡
PE2_FUNC


723 
	#PE2_FUNC
 
AS_GPIO


	)

725 #i‚de‡
PE3_FUNC


726 
	#PE3_FUNC
 
AS_GPIO


	)

728 #i‚de‡
PE4_FUNC


729 
	#PE4_FUNC
 
AS_GPIO


	)

731 #i‚de‡
PE5_FUNC


732 
	#PE5_FUNC
 
AS_GPIO


	)

734 #i‚de‡
PE6_FUNC


735 
	#PE6_FUNC
 
AS_TMS


	)

737 #i‚de‡
PE7_FUNC


738 
	#PE7_FUNC
 
AS_TCK


	)

740 #i‚de‡
PULL_WAKEUP_SRC_PE0


741 
	#PULL_WAKEUP_SRC_PE0
 0

	)

743 #i‚de‡
PULL_WAKEUP_SRC_PE1


744 
	#PULL_WAKEUP_SRC_PE1
 0

	)

746 #i‚de‡
PULL_WAKEUP_SRC_PE2


747 
	#PULL_WAKEUP_SRC_PE2
 0

	)

749 #i‚de‡
PULL_WAKEUP_SRC_PE3


750 
	#PULL_WAKEUP_SRC_PE3
 0

	)

752 #i‚de‡
PULL_WAKEUP_SRC_PE4


753 
	#PULL_WAKEUP_SRC_PE4
 0

	)

755 #i‚de‡
PULL_WAKEUP_SRC_PE5


756 
	#PULL_WAKEUP_SRC_PE5
 0

	)

758 #i‚de‡
PULL_WAKEUP_SRC_PE6


759 
	#PULL_WAKEUP_SRC_PE6
 0

	)

761 #i‚de‡
PULL_WAKEUP_SRC_PE7


762 
	#PULL_WAKEUP_SRC_PE7
 0

	)

765 #i‚de‡
PF0_INPUT_ENABLE


766 
	#PF0_INPUT_ENABLE
 1

768 #i‚de‡
PF1_INPUT_ENABLE


	)

769 
	#PF1_INPUT_ENABLE
 1

771 #i‚de‡
PF2_INPUT_ENABLE


	)

772 
	#PF2_INPUT_ENABLE
 1

774 #i‚de‡
PF3_INPUT_ENABLE


	)

775 
	#PF3_INPUT_ENABLE
 1

777 #i‚de‡
PF4_INPUT_ENABLE


	)

778 
	#PF4_INPUT_ENABLE
 1

780 #i‚de‡
PF5_INPUT_ENABLE


	)

781 
	#PF5_INPUT_ENABLE
 1

783 #i‚de‡
PF0_OUTPUT_ENABLE


	)

784 
	#PF0_OUTPUT_ENABLE
 0

	)

786 #i‚de‡
PF1_OUTPUT_ENABLE


787 
	#PF1_OUTPUT_ENABLE
 0

	)

789 #i‚de‡
PF2_OUTPUT_ENABLE


790 
	#PF2_OUTPUT_ENABLE
 0

	)

792 #i‚de‡
PF3_OUTPUT_ENABLE


793 
	#PF3_OUTPUT_ENABLE
 0

	)

795 #i‚de‡
PF4_OUTPUT_ENABLE


796 
	#PF4_OUTPUT_ENABLE
 0

	)

798 #i‚de‡
PF5_OUTPUT_ENABLE


799 
	#PF5_OUTPUT_ENABLE
 0

	)

802 #i‚de‡
PF0_DATA_STRENGTH


803 
	#PF0_DATA_STRENGTH
 1

	)

805 #i‚de‡
PF1_DATA_STRENGTH


806 
	#PF1_DATA_STRENGTH
 1

	)

808 #i‚de‡
PF2_DATA_STRENGTH


809 
	#PF2_DATA_STRENGTH
 1

	)

811 #i‚de‡
PF3_DATA_STRENGTH


812 
	#PF3_DATA_STRENGTH
 1

	)

814 #i‚de‡
PF4_DATA_STRENGTH


815 
	#PF4_DATA_STRENGTH
 1

	)

817 #i‚de‡
PF5_DATA_STRENGTH


818 
	#PF5_DATA_STRENGTH
 1

	)

821 #i‚de‡
PF0_DATA_OUT


822 
	#PF0_DATA_OUT
 0

	)

824 #i‚de‡
PF1_DATA_OUT


825 
	#PF1_DATA_OUT
 0

	)

827 #i‚de‡
PF2_DATA_OUT


828 
	#PF2_DATA_OUT
 0

	)

830 #i‚de‡
PF3_DATA_OUT


831 
	#PF3_DATA_OUT
 0

	)

833 #i‚de‡
PF4_DATA_OUT


834 
	#PF4_DATA_OUT
 0

	)

836 #i‚de‡
PF5_DATA_OUT


837 
	#PF5_DATA_OUT
 0

	)

840 #i‚de‡
PF0_FUNC


841 
	#PF0_FUNC
 
AS_MSPI


	)

843 #i‚de‡
PF1_FUNC


844 
	#PF1_FUNC
 
AS_MSPI


	)

846 #i‚de‡
PF2_FUNC


847 
	#PF2_FUNC
 
AS_MSPI


	)

849 #i‚de‡
PF3_FUNC


850 
	#PF3_FUNC
 
AS_MSPI


	)

852 #i‚de‡
PF4_FUNC


853 
	#PF4_FUNC
 
AS_MSPI


	)

855 #i‚de‡
PF5_FUNC


856 
	#PF5_FUNC
 
AS_MSPI


	)

869 
ölöe
 
	$gpio_™Æog_ªsi°™˚_öô
()

872 
	`™Æog_wrôe_ªg8
 (0x0e, 
PULL_WAKEUP_SRC_PA0
 |

873 (
PULL_WAKEUP_SRC_PA1
<<2) |

874 (
PULL_WAKEUP_SRC_PA2
<<4) |

875 (
PULL_WAKEUP_SRC_PA3
<<6));

877 
	`™Æog_wrôe_ªg8
 (0x0f, 
PULL_WAKEUP_SRC_PA4
 |

878 (
PULL_WAKEUP_SRC_PA5
<<2) |

879 (
PULL_WAKEUP_SRC_PA6
<<4) |

880 (
PULL_WAKEUP_SRC_PA7
<<6));

882 
	`™Æog_wrôe_ªg8
 (0x10, 
PULL_WAKEUP_SRC_PB0
 |

883 (
PULL_WAKEUP_SRC_PB1
<<2) |

884 (
PULL_WAKEUP_SRC_PB2
<<4) |

885 (
PULL_WAKEUP_SRC_PB3
<<6));

887 
	`™Æog_wrôe_ªg8
 (0x11, 
PULL_WAKEUP_SRC_PB4
 |

888 (
PULL_WAKEUP_SRC_PB5
<<2) |

889 (
PULL_WAKEUP_SRC_PB6
<<4) |

890 (
PULL_WAKEUP_SRC_PB7
<<6));

893 
	`™Æog_wrôe_ªg8
 (0x12, 
PULL_WAKEUP_SRC_PC0
 |

894 (
PULL_WAKEUP_SRC_PC1
<<2) |

895 (
PULL_WAKEUP_SRC_PC2
<<4) |

896 (
PULL_WAKEUP_SRC_PC3
<<6));

898 
	`™Æog_wrôe_ªg8
 (0x13, 
PULL_WAKEUP_SRC_PC4
 |

899 (
PULL_WAKEUP_SRC_PC5
<<2) |

900 (
PULL_WAKEUP_SRC_PC6
<<4) |

901 (
PULL_WAKEUP_SRC_PC7
<<6));

904 
	`™Æog_wrôe_ªg8
 (0x14, 
PULL_WAKEUP_SRC_PD0
 |

905 (
PULL_WAKEUP_SRC_PD1
<<2) |

906 (
PULL_WAKEUP_SRC_PD2
<<4) |

907 (
PULL_WAKEUP_SRC_PD3
<<6));

909 
	`™Æog_wrôe_ªg8
 (0x15, 
PULL_WAKEUP_SRC_PD4
 |

910 (
PULL_WAKEUP_SRC_PD5
<<2) |

911 (
PULL_WAKEUP_SRC_PD6
<<4) |

912 (
PULL_WAKEUP_SRC_PD7
<<6));

914 
	`™Æog_wrôe_ªg8
 (0x16, 
PULL_WAKEUP_SRC_PE0
 |

915 (
PULL_WAKEUP_SRC_PE1
<<2) |

916 (
PULL_WAKEUP_SRC_PE2
<<4) |

917 (
PULL_WAKEUP_SRC_PE3
<<6));

919 
	`™Æog_wrôe_ªg8
 (0x17, 
PULL_WAKEUP_SRC_PE4
 |

920 (
PULL_WAKEUP_SRC_PE5
<<2) |

921 (
PULL_WAKEUP_SRC_PE6
<<4) |

922 (
PULL_WAKEUP_SRC_PE7
<<6));

923 
	}
}

926 
_©åibuã_øm_code_£c_


927 
ölöe
 
	$gpio_öô
(
™aRes_öô_í
)

930 
ªg_gpio_∑_£âög1
 =

931 (
PA0_INPUT_ENABLE
<<8Ë| (
PA1_INPUT_ENABLE
<<9Ë| (
PA2_INPUT_ENABLE
<<10Ë| (
PA3_INPUT_ENABLE
<<11) |

932 (
PA4_INPUT_ENABLE
<<12Ë| (
PA5_INPUT_ENABLE
<<13Ë| (
PA6_INPUT_ENABLE
<<14Ë| (
PA7_INPUT_ENABLE
<<15) |

933 ((
PA0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PA1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PA2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PA3_OUTPUT_ENABLE
?0:1)<<19) |

934 ((
PA4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PA5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PA6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PA7_OUTPUT_ENABLE
?0:1)<<23) |

935 (
PA0_DATA_OUT
<<24Ë| (
PA1_DATA_OUT
<<25Ë| (
PA2_DATA_OUT
<<26Ë| (
PA3_DATA_OUT
<<27) |

936 (
PA4_DATA_OUT
<<28Ë| (
PA5_DATA_OUT
<<29Ë| (
PA6_DATA_OUT
<<30Ë| (
PA7_DATA_OUT
<<31) ;

937 
ªg_gpio_∑_£âög2
 =

938 (
PA0_DATA_STRENGTH
<<8Ë| (
PA1_DATA_STRENGTH
<<9)| (
PA2_DATA_STRENGTH
<<10Ë| (
PA3_DATA_STRENGTH
<<11) |

939 (
PA4_DATA_STRENGTH
<<12Ë| (
PA5_DATA_STRENGTH
<<13Ë| (
PA6_DATA_STRENGTH
<<14Ë| (
PA7_DATA_STRENGTH
<<15) |

940 (
PA0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PA1_FUNC
==AS_GPIO ? BIT(17):0)| (
PA2_FUNC
==AS_GPIO ? BIT(18):0)| (
PA3_FUNC
==AS_GPIO ? BIT(19):0) |

941 (
PA4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PA5_FUNC
==AS_GPIO ? BIT(21):0)| (
PA6_FUNC
==AS_GPIO ? BIT(22):0)| (
PA7_FUNC
==AS_GPIO ? BIT(23):0);

944 
ªg_gpio_pb_£âög1
 =

945 (
PB0_INPUT_ENABLE
<<8Ë| (
PB1_INPUT_ENABLE
<<9Ë| (
PB2_INPUT_ENABLE
<<10Ë| (
PB3_INPUT_ENABLE
<<11) |

946 (
PB4_INPUT_ENABLE
<<12Ë| (
PB5_INPUT_ENABLE
<<13Ë| (
PB6_INPUT_ENABLE
<<14Ë| (
PB7_INPUT_ENABLE
<<15) |

947 ((
PB0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PB1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PB2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PB3_OUTPUT_ENABLE
?0:1)<<19) |

948 ((
PB4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PB5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PB6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PB7_OUTPUT_ENABLE
?0:1)<<23) |

949 (
PB0_DATA_OUT
<<24Ë| (
PB1_DATA_OUT
<<25Ë| (
PB2_DATA_OUT
<<26Ë| (
PB3_DATA_OUT
<<27) |

950 (
PB4_DATA_OUT
<<28Ë| (
PB5_DATA_OUT
<<29Ë| (
PB6_DATA_OUT
<<30Ë| (
PB7_DATA_OUT
<<31) ;

951 
ªg_gpio_pb_£âög2
 =

952 (
PB0_DATA_STRENGTH
<<8Ë| (
PB1_DATA_STRENGTH
<<9)| (
PB2_DATA_STRENGTH
<<10Ë| (
PB3_DATA_STRENGTH
<<11) |

953 (
PB4_DATA_STRENGTH
<<12Ë| (
PB5_DATA_STRENGTH
<<13Ë| (
PB6_DATA_STRENGTH
<<14Ë| (
PB7_DATA_STRENGTH
<<15) |

954 (
PB0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PB1_FUNC
==AS_GPIO ? BIT(17):0)| (
PB2_FUNC
==AS_GPIO ? BIT(18):0)| (
PB3_FUNC
==AS_GPIO ? BIT(19):0) |

955 (
PB4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PB5_FUNC
==AS_GPIO ? BIT(21):0)| (
PB6_FUNC
==AS_GPIO ? BIT(22):0)| (
PB7_FUNC
==AS_GPIO ? BIT(23):0);

959 
	`™Æog_wrôe_ªg8
(
¨eg_gpio_pc_õ
, (
PC0_INPUT_ENABLE
<<0Ë| (
PC1_INPUT_ENABLE
<<1Ë| (
PC2_INPUT_ENABLE
<<2Ë| (
PC3_INPUT_ENABLE
<<3) |

960 (
PC4_INPUT_ENABLE
<<4Ë| (
PC5_INPUT_ENABLE
<<5Ë| (
PC6_INPUT_ENABLE
<<6Ë| (
PC7_INPUT_ENABLE
<<7) );

963 
ªg_gpio_pc_€n
 =

964 ((
PC0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PC1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PC2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PC3_OUTPUT_ENABLE
?0:1)<<3) |

965 ((
PC4_OUTPUT_ENABLE
?0:1)<<4Ë| ((
PC5_OUTPUT_ENABLE
?0:1)<<5Ë| ((
PC6_OUTPUT_ENABLE
?0:1)<<6Ë| ((
PC7_OUTPUT_ENABLE
?0:1)<<7);

967 
ªg_gpio_pc_out
 =

968 (
PC0_DATA_OUT
<<0Ë| (
PC1_DATA_OUT
<<1Ë| (
PC2_DATA_OUT
<<2Ë| (
PC3_DATA_OUT
<<3) |

969 (
PC4_DATA_OUT
<<4Ë| (
PC5_DATA_OUT
<<5Ë| (
PC6_DATA_OUT
<<6Ë| (
PC7_DATA_OUT
<<7) ;

972 
	`™Æog_wrôe_ªg8
(
¨eg_gpio_pc_ds
, (
PC0_DATA_STRENGTH
<<0Ë| (
PC1_DATA_STRENGTH
<<1Ë| (
PC2_DATA_STRENGTH
<<2Ë| (
PC3_DATA_STRENGTH
<<3) |

973 (
PC4_DATA_STRENGTH
<<4Ë| (
PC5_DATA_STRENGTH
<<5Ë| (
PC6_DATA_STRENGTH
<<6Ë| (
PC7_DATA_STRENGTH
<<7) );

975 
ªg_gpio_pc_gpio
 =

976 (
PC0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PC1_FUNC
==AS_GPIO ? BIT(1):0)| (
PC2_FUNC
==AS_GPIO ? BIT(2):0)| (
PC3_FUNC
==AS_GPIO ? BIT(3):0) |

977 (
PC4_FUNC
==
AS_GPIO
 ? 
	`BIT
(4):0Ë| (
PC5_FUNC
==AS_GPIO ? BIT(5):0)| (
PC6_FUNC
==AS_GPIO ? BIT(6):0)| (
PC7_FUNC
==AS_GPIO ? BIT(7):0);

981 
	`™Æog_wrôe_ªg8
(
¨eg_gpio_pd_õ
, (
PD0_INPUT_ENABLE
<<0Ë| (
PD1_INPUT_ENABLE
<<1Ë| (
PD2_INPUT_ENABLE
<<2Ë| (
PD3_INPUT_ENABLE
<<3) |

982 (
PD4_INPUT_ENABLE
<<4Ë| (
PD5_INPUT_ENABLE
<<5Ë| (
PD6_INPUT_ENABLE
<<6Ë| (
PD7_INPUT_ENABLE
<<7) );

985 
ªg_gpio_pd_€n
 =

986 ((
PD0_OUTPUT_ENABLE
?0:1)<<0Ë| ((
PD1_OUTPUT_ENABLE
?0:1)<<1Ë| ((
PD2_OUTPUT_ENABLE
?0:1)<<2Ë| ((
PD3_OUTPUT_ENABLE
?0:1)<<3) |

987 ((
PD4_OUTPUT_ENABLE
?0:1)<<4Ë| ((
PD5_OUTPUT_ENABLE
?0:1)<<5Ë| ((
PD6_OUTPUT_ENABLE
?0:1)<<6Ë| ((
PD7_OUTPUT_ENABLE
?0:1)<<7);

989 
ªg_gpio_pd_out
 =

990 (
PD0_DATA_OUT
<<0Ë| (
PD1_DATA_OUT
<<1Ë| (
PD2_DATA_OUT
<<2Ë| (
PD3_DATA_OUT
<<3) |

991 (
PD4_DATA_OUT
<<4Ë| (
PD5_DATA_OUT
<<5Ë| (
PD6_DATA_OUT
<<6Ë| (
PD7_DATA_OUT
<<7) ;

994 
	`™Æog_wrôe_ªg8
(
¨eg_gpio_pd_ds
, (
PD0_DATA_STRENGTH
<<0Ë| (
PD1_DATA_STRENGTH
<<1Ë| (
PD2_DATA_STRENGTH
<<2Ë| (
PD3_DATA_STRENGTH
<<3) |

995 (
PD4_DATA_STRENGTH
<<4Ë| (
PD5_DATA_STRENGTH
<<5Ë| (
PD6_DATA_STRENGTH
<<6Ë| (
PD7_DATA_STRENGTH
<<7) );

997 
ªg_gpio_pd_gpio
 =

998 (
PD0_FUNC
==
AS_GPIO
 ? 
	`BIT
(0):0Ë| (
PD1_FUNC
==AS_GPIO ? BIT(1):0)| (
PD2_FUNC
==AS_GPIO ? BIT(2):0)| (
PD3_FUNC
==AS_GPIO ? BIT(3):0) |

999 (
PD4_FUNC
==
AS_GPIO
 ? 
	`BIT
(4):0Ë| (
PD5_FUNC
==AS_GPIO ? BIT(5):0)| (
PD6_FUNC
==AS_GPIO ? BIT(6):0)| (
PD7_FUNC
==AS_GPIO ? BIT(7):0);

1002 
ªg_gpio_≥_£âög1
 =

1003 (
PE0_INPUT_ENABLE
<<8Ë| (
PE1_INPUT_ENABLE
<<9Ë| (
PE2_INPUT_ENABLE
<<10Ë| (
PE3_INPUT_ENABLE
<<11) |

1004 (
PE4_INPUT_ENABLE
<<12Ë| (
PE5_INPUT_ENABLE
<<13)| (
PE6_INPUT_ENABLE
<<14Ë| (
PE7_INPUT_ENABLE
<<15) |

1005 ((
PE0_OUTPUT_ENABLE
?0:1)<<16Ë| ((
PE1_OUTPUT_ENABLE
?0:1)<<17Ë| ((
PE2_OUTPUT_ENABLE
?0:1)<<18Ë| ((
PE3_OUTPUT_ENABLE
?0:1)<<19) |

1006 ((
PE4_OUTPUT_ENABLE
?0:1)<<20Ë| ((
PE5_OUTPUT_ENABLE
?0:1)<<21Ë| ((
PE6_OUTPUT_ENABLE
?0:1)<<22Ë| ((
PE7_OUTPUT_ENABLE
?0:1)<<23) |

1007 (
PE0_DATA_OUT
<<24Ë| (
PE1_DATA_OUT
<<25Ë| (
PE2_DATA_OUT
<<26Ë| (
PE3_DATA_OUT
<<27) |

1008 (
PE4_DATA_OUT
<<28Ë| (
PE5_DATA_OUT
<<29Ë| (
PE6_DATA_OUT
<<30Ë| (
PE7_DATA_OUT
<<31) ;

1009 
ªg_gpio_≥_£âög2
 =

1010 (
PE0_DATA_STRENGTH
<<8Ë| (
PE1_DATA_STRENGTH
<<9Ë| (
PE2_DATA_STRENGTH
<<10Ë| (
PE3_DATA_STRENGTH
<<11) |

1011 (
PE4_DATA_STRENGTH
<<12Ë| (
PE5_DATA_STRENGTH
<<13Ë| (
PE6_DATA_STRENGTH
<<14Ë| (
PE7_DATA_STRENGTH
<<15) |

1012 (
PE0_FUNC
==
AS_GPIO
 ? 
	`BIT
(16):0Ë| (
PE1_FUNC
==AS_GPIO ? BIT(17):0)| (
PE2_FUNC
==AS_GPIO ? BIT(18):0)| (
PE3_FUNC
==AS_GPIO ? BIT(19):0) |

1013 (
PE4_FUNC
==
AS_GPIO
 ? 
	`BIT
(20):0Ë| (
PE5_FUNC
==AS_GPIO ? BIT(21):0)| (
PE6_FUNC
==AS_GPIO ? BIT(22):0)| (
PE7_FUNC
==AS_GPIO ? BIT(23):0);

1015 if(
™aRes_öô_í
)

1017 
	`gpio_™Æog_ªsi°™˚_öô
();

1019 
	}
}

	@platform/chip_b91/i2c.h

35 #i‚de‡
I2C_H


36 
	#I2C_H


	)

37 
	~"gpio.h
"

39 
	~"™Æog.h
"

40 
	~"ªg_ö˛ude/i2c_ªg.h
"

41 
	~"dma.h
"

56 
	mI2C_GPIO_SDA_B3
 = 
GPIO_PB3
,

57 
	mI2C_GPIO_SDA_C2
 = 
GPIO_PC2
,

58 
	mI2C_GPIO_SDA_E2
 = 
GPIO_PE2
,

59 
	mI2C_GPIO_SDA_E3
 = 
GPIO_PE3
,

60 }
	ti2c_sda_pö_e
;

64 
	mI2C_GPIO_SCL_B2
 = 
GPIO_PB2
,

65 
	mI2C_GPIO_SCL_C1
 = 
GPIO_PC1
,

66 
	mI2C_GPIO_SCL_E0
 = 
GPIO_PE0
,

67 
	mI2C_GPIO_SCL_E1
 = 
GPIO_PE1
,

68 }
	ti2c_s˛_pö_e
;

73 
	mI2C_RX_BUF_MASK
 = 
BIT
(2),

74 
	mI2C_TX_BUF_MASK
 = 
BIT
(3),

75 
	mI2C_TX_DONE_MASK
 = 
BIT
(4),

76 
	mI2C_RX_DONE_MASK
 = 
BIT
(5),

77 }
	ti2c_úq_mask_e
;

82 
	mI2C_RX_BUFF_CLR
 = 
BIT
(6),

83 
	mI2C_TX_BUFF_CLR
 = 
BIT
(7),

84 }
	ti2c_buff_˛r_e
;

88 
	mI2C_TXDONE_STATUS
 = 
BIT
(0),

89 
	mI2C_TX_BUF_STATUS
 = 
BIT
(1),

90 
	mI2C_RXDONE_STATUS
 = 
BIT
(2),

91 
	mI2C_RX_BUF_STATUS
 = 
BIT
(3),

93 }
	ti2c_úq_°©us_e
;

97 
	mI2C_TX_DONE_CLR
 = 
BIT
(4),

98 }
	ti2c_úq_˛r_e
;

104 
ölöe
 
_Boﬁ
 
	$i2c_ma°î_busy
()

106  
ªg_i2c_m°
 & 
FLD_I2C_MST_BUSY
;

107 
	}
}

113 
ölöe
 
	$i2c_gë_tx_buf_˙t
()

115  (
ªg_i2c_buf_˙t
 & 
FLD_I2C_TX_BUFCNT
)>>4;

116 
	}
}

123 
ölöe
 
	$i2c_gë_rx_buf_˙t
()

125  (
ªg_i2c_buf_˙t
 & 
FLD_I2C_RX_BUFCNT
);

126 
	}
}

135 
ölöe
 
	$i2c_rx_úq_åig_˙t
(
˙t
)

137 
ªg_i2c_åig
 &(~
FLD_I2C_RX_IRQ_TRIG_LEV
);

138 
ªg_i2c_åig
 |
˙t
;

139 
	}
}

147 
i2c_ma°î_£nd_°›
(
í
);

155 
i2c_£t_pö
(
i2c_sda_pö_e
 
sda_pö
,
i2c_s˛_pö_e
 
s˛_pö
);

162 
i2c_ma°î_öô
();

170 
ölöe
 
	$i2c_£t_úq_mask
(
i2c_úq_mask_e
 
mask
)

172 
ªg_i2c_s˘0
 |
mask
;

173 
	}
}

180 
ölöe
 
	$i2c_˛r_úq_mask
(
i2c_úq_mask_e
 
mask
)

182 
ªg_i2c_s˘0
 &(~
mask
);

183 
	}
}

191 
ölöe
 
	$i2c_gë_úq_°©us
(
i2c_úq_°©us_e
 
°©us
)

193  
ªg_i2c_úq_°©us
&
°©us
;

194 
	}
}

202 
ölöe
 
	$i2c_˛r_fifo
(
i2c_buff_˛r_e
 
˛r
)

204 
ªg_i2c_°©us
 = 
˛r
;

205 
	}
}

211 
ölöe
 
	$i2c_˛r_úq_°©us
(
i2c_úq_˛r_e
 
°©us
)

213 
ªg_i2c_úq_°©us
=
°©us
;

214 
	}
}

224 
i2c_¶ave_öô
(
id
);

234 
i2c_ma°î_wrôe
(
id
, *
d©a
, 
Àn
);

244 
i2c_ma°î_ªad
(
id
, *
d©a
, 
Àn
);

256 
i2c_ma°î_wrôe_ªad
(
id
, *
wr_d©a
, 
wr_Àn
, *
rd_d©a
, 
rd_Àn
);

265 
i2c_ma°î_wrôe_dma
(
id
, *
d©a
, 
Àn
);

276 
i2c_ma°î_ªad_dma
(
id
, *
d©a
, 
Àn
);

287 
i2c_¶ave_£t_tx_dma
–*
d©a
, 
Àn
);

297 
i2c_¶ave_£t_rx_dma
(*
d©a
, 
Àn
);

306 
i2c_¶ave_ªad
(* 
d©a
 , 
Àn
 );

315 
i2c_¶ave_wrôe
(* 
d©a
 , 
Àn
);

325 
i2c_£t_ma°î_˛k
(
˛ock
);

332 
i2c_£t_tx_dma_c⁄fig
(
dma_chn_e
 
chn
);

339 
i2c_£t_rx_dma_c⁄fig
(
dma_chn_e
 
chn
);

	@platform/chip_b91/lpc.h

24 #¥agm®
⁄˚


26 
	~"™Æog.h
"

32 
	mLPC_INPUT_PB1
 = 1,

33 
	mLPC_INPUT_PB2
 = 2,

34 
	mLPC_INPUT_PB3
 = 3,

35 
	mLPC_INPUT_PB4
 = 4,

36 
	mLPC_INPUT_PB5
 = 5,

37 
	mLPC_INPUT_PB6
 = 6,

38 
	mLPC_INPUT_PB7
 = 7,

39 }
	tÕc_öput_ch™√l_e
;

45 
	mLPC_NORMAL
 = 0,

46 
	mLPC_LOWPOWER
,

47 }
	tÕc_mode_e
;

53 
	mLPC_REF_974MV
 = 1,

54 
	mLPC_REF_923MV
 = 2,

55 
	mLPC_REF_872MV
 = 3,

56 
	mLPC_REF_820MV
 = 4,

57 
	mLPC_REF_PB0
 = 5,

58 
	mLPC_REF_PB3
 = 6,

59 }
	tÕc_ª„ªn˚_e
;

65 
	mLPC_SCALING_PER25
 = 0,

66 
	mLPC_SCALING_PER50
 = 1,

67 
	mLPC_SCALING_PER75
 = 2,

68 
	mLPC_SCALING_PER100
 = 3,

69 }
	tÕc_sˇlög_e
;

75 
ölöe
 
	$Õc_powî_down
()

77 
	`™Æog_wrôe_ªg8
(0x07,(
	`™Æog_ªad_ªg8
(0x07))|0x08);

78 
	}
}

84 
ölöe
 
	$Õc_powî_⁄
()

86 
	`™Æog_wrôe_ªg8
(0x06,
	`™Æog_ªad_ªg8
(0x06) & 0xfd);

87 
	}
}

94 
ölöe
 
	$Õc_£t_öput_chn
(
Õc_öput_ch™√l_e
 
pö
)

96 
	`™Æog_wrôe_ªg8
(0x0d,(
	`™Æog_ªad_ªg8
(0x0dË& 0xf8Ë| 
pö
);

97 
	}
}

104 
ölöe
 
	$Õc_£t_sˇlög_c€ff
(
Õc_sˇlög_e
 
dividî
)

106 
	`™Æog_wrôe_ªg8
(0x0b,(
	`™Æog_ªad_ªg8
(0x0b)&0xcf)|(
dividî
<<4));

107 
	}
}

113 
ölöe
 
	$Õc_gë_ªsu…
()

115  ((
	`™Æog_ªad_ªg8
(0x88)&0x40)>>6);

116 
	}
}

124 
Õc_£t_öput_ªf
(
Õc_mode_e
 
mode
, 
Õc_ª„ªn˚_e
 
ªf
);

	@platform/chip_b91/mdec.h

24 #¥agm®
⁄˚


26 
	~"™Æog.h
"

27 
	~"ªg_ö˛ude/mdec_ªg.h
"

34 
ölöe
 
	$mdec_ª£t
()

36 
	`™Æog_wrôe_ªg8
(
mdec_r°_addr
,
	`™Æog_ªad_ªg8
(mdec_r°_addrË| 
FLD_MDEC_RST
);

37 
	`™Æog_wrôe_ªg8
(
mdec_r°_addr
,
	`™Æog_ªad_ªg8
(mdec_r°_addrË& (~
FLD_MDEC_RST
));

38 
	}
}

45 
ölöe
 
	$mdec_gë_úq_°©us
(
wakeup_°©us_e
 
°©us
)

47  (
	`™Æog_ªad_ªg8
(
ªg_wakeup_°©us
Ë& 
°©us
);

48 
	}
}

57 
ölöe
 
	$mdec_˛r_úq_°©us
(
wakeup_°©us_e
 
°©us
)

59 
	`™Æog_wrôe_ªg8
(
ªg_wakeup_°©us
, (
	`™Æog_ªad_ªg8
‘eg_wakeup_°©usË| 
°©us
));

60 
	}
}

68 
mdec_öô
(
mdec_pö_e
 
pö
);

75 
mdec_ªad_d©
(*
d©
);

	@platform/chip_b91/mspi.h

24 #¥agm®
⁄˚


26 
	~"compûî.h
"

27 
	~"gpio.h
"

28 
	~"ªg_ö˛ude/m•i_ªg.h
"

34 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_waô
(){

35 
ªg_m•i_°©us
 & 
FLD_MSPI_BUSY
);

36 
	}
}

42 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_fm_rd_í
(){

43 
ªg_m•i_fm
 |
FLD_MSPI_RD_TRIG_EN
;

44 
	}
}

50 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_fm_rd_dis
(){

51 
ªg_m•i_fm
 &~
FLD_MSPI_RD_TRIG_EN
;

52 
	}
}

58 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_high
(){

59 
ªg_m•i_fm
 |
FLD_MSPI_CSN
;

60 
	}
}

66 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_low
(){

67 
ªg_m•i_fm
 &~
FLD_MSPI_CSN
;

68 
	}
}

74 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_gë
(){

75  
ªg_m•i_d©a
;

76 
	}
}

83 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_wrôe
(
c
){

84 
ªg_m•i_d©a
 = 
c
;

85 
	}
}

92 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_fm_wrôe
(
c
){

93 
ªg_m•i_fm
 = 
c
;

94 
	}
}

100 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_ªad
(){

101 
	`m•i_wrôe
(0);

102 
	`m•i_waô
();

103  
	`m•i_gë
();

104 
	}
}

110 
_©åibuã_øm_code_£c_
 
ölöe
 
	$m•i_°›_xù
()

112 
	`m•i_waô
();

113 
	`m•i_high
();

114 
	`gpio_gë_Àvñ
(
GPIO_PF3
) == 0);

115 
	}
}

	@platform/chip_b91/npe.h

24 #i‚de‡ 
NPE_H_


25 
	#NPE_H_


	)

26 
	~"ªg_ö˛ude/≈e_ªg.h
"

28 
≈e_£t_ªg
();

29 
≈e_£t_c⁄fig
(
desc_poöãr
 );

	@platform/chip_b91/pke.h

24 #¥agm®
⁄˚


26 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

31 
	#GET_WORD_LEN
(
bôLí
Ë((bôLí+31)/32)

	)

32 
	#GET_BYTE_LEN
(
bôLí
Ë((bôLí+7)/8)

	)

34 
	#PKE_BASE
 (0X80110000)

	)

35 
	#ªg_pke_a_øm
(
a
Ë((vﬁ©ûê*)(
PKE_BASE
+0x0400+◊)*(0x24)))

	)

36 
	#ªg_pke_b_øm
(
b
Ë((vﬁ©ûê*)(
PKE_BASE
+0x1000+(b)*(0x24)))

	)

39 
	#PKE_OPERAND_MAX_WORD_LEN
 (0x08)

	)

40 
	#PKE_OPERAND_MAX_BIT_LEN
 (0x100)

	)

41 
	#ECC_MAX_WORD_LEN
 
PKE_OPERAND_MAX_WORD_LEN


	)

42 
	#ECC_MAX_BIT_LEN
 
PKE_OPERAND_MAX_BIT_LEN


	)

44 #i‚de‡
NULL


45 
	#NULL
 0

	)

53 
	mec˝_p_bôLí
;

54 
	mec˝_n_bôLí
;

55 *
	mec˝_p
;

56 *
	mec˝_p_h
;

57 *
	mec˝_p_n1
;

58 *
	mec˝_a
;

59 *
	mec˝_b
;

60 *
	mec˝_Gx
;

61 *
	mec˝_Gy
;

62 *
	mec˝_n
;

63 *
	mec˝_n_h
;

64 *
	mec˝_n_n1
;

65 }
	tec˝_curve_t
;

72 
	mm⁄t_p_bôLí
;

73 *
	mm⁄t_p
;

74 *
	mm⁄t_p_h
;

75 *
	mm⁄t_p_n1
;

76 *
	mm⁄t_a24
;

77 *
	mm⁄t_u
;

78 *
	mm⁄t_v
;

79 *
	mm⁄t_n
;

80 *
	mm⁄t_n_h
;

81 *
	mm⁄t_n_n1
;

82 *
	mm⁄t_h
;

83 }
	tm⁄t_curve_t
;

90 
	medw¨d_p_bôLí
;

91 *
	medw¨d_p
;

92 *
	medw¨d_p_h
;

93 *
	medw¨d_p_n1
;

94 *
	medw¨d_d
;

95 *
	medw¨d_Gx
;

96 *
	medw¨d_Gy
;

97 *
	medw¨d_n
;

98 *
	medw¨d_n_h
;

99 *
	medw¨d_n_n1
;

100 *
	medw¨d_h
;

102 }
	tedw¨d_curve_t
;

109 
	mPKE_SUCCESS
 = 0,

110 
	mPKE_ACTIVE_STOP
,

111 
	mPKE_MOD_INV_NOT_EXIST
,

112 
	mPKE_POINT_NOT_ON_CURVE
,

113 
	mPKE_INVALID_MICRO_CODE
,

114 
	mPKE_POINTOR_NULL
,

115 
	mPKE_INVALID_INPUT
,

116 }
	tpke_ªt_code_e
;

122 
	mPKE_EXE_CFG_ALL_NON_MONT
 = 0x15,

123 
	mPKE_EXE_CFG_ALL_MONT
 = 0x2A,

124 }
	tpke_exe_cfg_e
;

130 
	mPKE_MICROCODE_PDBL
 = 0x04,

131 
	mPKE_MICROCODE_PADD
 = 0x08,

132 
	mPKE_MICROCODE_PVER
 = 0x0C,

133 
	mPKE_MICROCODE_PMUL
 = 0x10,

134 
	mPKE_MICROCODE_MODMUL
 = 0x18,

135 
	mPKE_MICROCODE_MODINV
 = 0x1C,

136 
	mPKE_MICROCODE_MODADD
 = 0x20,

137 
	mPKE_MICROCODE_MODSUB
 = 0x24,

138 
	mPKE_MICROCODE_CAL_PRE_MON
 = 0x28,

139 
	mPKE_MICROCODE_C25519_PMUL
 = 0x34,

140 
	mPKE_MICROCODE_Ed25519_PMUL
 = 0x38,

141 
	mPKE_MICROCODE_Ed25519_PADD
 = 0x3C,

143 }
	tpke_mi¸ocode_e
;

150 
ölöe
 
	$pke_gë_úq_°©us
(
pke_°©us_e
 
°©us
)

152  
ªg_pke_°©
 & 
°©us
;

153 
	}
}

160 
ölöe
 
	$pke_˛r_úq_°©us
(
pke_°©us_e
 
°©us
)

162 
ªg_pke_°©
 = ~
°©us
;

163 
	}
}

170 
ölöe
 
	$pke_£t_úq_mask
(
pke_c⁄f_e
 
mask
)

172 
	`BM_SET
(
ªg_pke_c⁄f
, 
mask
);

173 
	}
}

180 
ölöe
 
	$pke_˛r_úq_mask
(
pke_c⁄f_e
 
mask
)

182 
	`BM_CLR
(
ªg_pke_c⁄f
, 
mask
);

183 
	}
}

190 
ölöe
 
	$pke_£t_mi¸ocode
(
pke_mi¸ocode_e
 
addr
)

192 
ªg_pke_mc_±r
 = 
addr
;

193 
	}
}

200 
ölöe
 
	$pke_£t_exe_cfg
(
pke_exe_cfg_e
 
cfg
)

202 
ªg_pke_exe_c⁄f
 = 
cfg
;

203 
	}
}

209 
ölöe
 
	$pke_›r_°¨t
()

211 
	`BM_SET
(
ªg_pke_˘æ
, 
FLD_PKE_CTRL_START
);

212 
	}
}

222 
ölöe
 
	$pke_check_π_code
()

224  ()(
ªg_pke_π_code
 & 
FLD_PKE_RT_CODE_STOP_LOG
);

225 
	}
}

232 
ölöe
 
	$pke_£t_›î™d_width
(
bôLí
)

234 
	`BM_CLR
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_PARTIAL_RADIX
);

235 
	`BM_SET
(
ªg_pke_c⁄f
, 
	`GET_WORD_LEN
(
bôLí
)<<16);

236 
	`BM_CLR
(
ªg_pke_c⁄f
, 
FLD_PKE_CONF_BASE_RADIX
);

237 
	`BM_SET
(
ªg_pke_c⁄f
, 2<<24);

238 
	}
}

248 sig√d 
big_öãgî_com∑ª
(*
a
, 
aW‹dLí
, *
b
, 
bW‹dLí
);

258 
sub_u32
(*
a
, *
b
, *
c
, 
w‹dLí
);

270 
div2n_u32
(
a
[], sig√d 
aW‹dLí
, 
n
);

280 
pke_lﬂd_¥e_ˇlc_m⁄t
(*
H
, *
n1
, 
w‹dLí
);

289 
pke_ˇlc_¥e_m⁄t
(c⁄° *
modulus
, 
w‹dLí
);

300 
pke_mod_mul
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

301 *
out
, 
w‹dLí
);

312 
pke_mod_öv
(c⁄° *
modulus
, c⁄° *
a
, *
aöv
, 
modW‹dLí
,

313 
aW‹dLí
);

324 
pke_mod_add
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

325 *
out
, 
w‹dLí
);

336 
pke_mod_sub
(c⁄° *
modulus
, c⁄° *
a
, c⁄° *
b
,

337 *
out
, 
w‹dLí
);

350 
pke_mod
(*
a
, 
aW‹dLí
, *
b
, *
b_h
, *
b_n1
,

351 
bW‹dLí
, *
c
);

362 
pke_ec˝_poöt_dñ
(
ec˝_curve_t
 *
curve
, *
Px
, *
Py
,

363 *
Qx
, *
Qy
);

372 
pke_ec˝_poöt_vîify
(
ec˝_curve_t
 *
curve
, *
Px
, *
Py
);

384 
pke_ec˝_poöt_mul
(
ec˝_curve_t
 *
curve
, *
k
, *
Px
, *
Py
,

385 *
Qx
, *
Qy
);

398 
pke_ec˝_poöt_add
(
ec˝_curve_t
 *
curve
, *
P1x
, *
P1y
, *
P2x
, *
P2y
,

399 *
Qx
, *
Qy
);

409 
pke_x25519_poöt_mul
(
m⁄t_curve_t
 *
curve
, *
k
, *
Pu
, *
Qu
);

421 
pke_ed25519_poöt_mul
(
edw¨d_curve_t
 *
curve
, *
k
, *
Px
, *
Py
,

422 *
Qx
, *
Qy
);

435 
pke_ed25519_poöt_add
(
edw¨d_curve_t
 *
curve
, *
P1x
, *
P1y
, *
P2x
, *
P2y
,

436 *
Qx
, *
Qy
);

	@platform/chip_b91/plic.c

29 
	~"∂ic.h
"

30 
	gg_∂ic_¥ìm±_í
=0;

38 
_©åibuã_øm_code_£c_noölöe_
 
	$∂ic_íãr_¸ôiˇl_£c
(
¥ìm±_í
 ,
thªshﬁd
)

40 
r
;

41 if(
g_∂ic_¥ìm±_í
&&
¥ìm±_í
)

43 
	`∂ic_£t_thªshﬁd
(
thªshﬁd
);

44 
r
=0;

48 
r
 = 
	`c‹e_öãºu±_dißbÀ
();

50  
r
 ;

51 
	}
}

59 
_©åibuã_øm_code_£c_noölöe_
 
	$∂ic_exô_¸ôiˇl_£c
(
¥ìm±_í
 ,
r
)

61 i‡(
g_∂ic_¥ìm±_í
&&
¥ìm±_í
)

63 
	`∂ic_£t_thªshﬁd
(0);

67 
	`c‹e_ª°‹e_öãºu±
(
r
);

69 
	}
}

76 
__©åibuã__
((
£˘i⁄
(".øm_code"))Ë
	$deÁu…_úq_h™dÀr
()

79 
	}
}

80 
	$°imî_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

81 
	$™Æog_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

82 
	$timî1_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

83 
	$timî0_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

84 
	$dma_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

85 
	$bmc_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

86 
	$usb_˘æ_ï_£tup_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

87 
	$usb_˘æ_ï_d©a_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

88 
	$usb_˘æ_ï_°©us_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

89 
	$usb_˘æ_ï_£töf_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

90 
	$usb_ídpoöt_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

91 
	$rf_dm_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

92 
	$rf_bÀ_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

93 
	$rf_bt_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

94 
	$rf_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

96 
	$pwm_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

97 
	$pke_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

98 
	$u¨t1_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

99 
	$u¨t0_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

100 
	$audio_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

102 
	$i2c_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

103 
	$h•i_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

104 
	$p•i_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

105 
	$usb_pwdn_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

106 
	$gpio_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

107 
	$gpio_risc0_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

108 
	$gpio_risc1_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

109 
	$so·_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

111 
	$≈e_bus0_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

112 
	$≈e_bus1_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

113 
	$≈e_bus2_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

114 
	$≈e_bus3_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

115 
	$≈e_bus4_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

116 
	$usb_250us_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

117 
	$usb_ª£t_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

119 
	$≈e_bus7_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

120 
	$≈e_bus8_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

122 
	$≈e_bus13_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

123 
	$≈e_bus14_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

125 
	$≈e_bus15_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

126 
	$≈e_bus17_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

128 
	$≈e_bus21_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

129 
	$≈e_bus22_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

130 
	$≈e_bus23_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

131 
	$≈e_bus24_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

132 
	$≈e_bus25_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

133 
	$≈e_bus26_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

134 
	$≈e_bus27_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

135 
	$≈e_bus28_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

137 
	$≈e_bus29_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

138 
	$≈e_bus30_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

139 
	$≈e_bus31_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

140 
	$≈e_comb_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

141 
	$pm_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

142 
	$eoc_úq_h™dÀr
(Ë
	`__©åibuã__
((
wók
, 
	`Æüs
("default_irq_handler")));

144 (*
	tfunc_i§_t
) ();

145 
_©åibuã_øm_code_£c_
 
	$∂ic_i§
(
func_i§_t
 
func
, 
úq_sour˚_e
 
§c
)

147 if(
g_∂ic_¥ìm±_í
)

149 
	`c‹e_ßve_√°ed_c⁄ãxt
();

150 
	`func
 ();

151 
	`c‹e_ª°‹e_√°ed_c⁄ãxt
();

152 
	`∂ic_öãºu±_com∂ëe
(
§c
);

153 
„n˚_i‹w
;

157 
	`func
 ();

158 
	`∂ic_öãºu±_com∂ëe
(
§c
);

160 
	}
}

166 
_©åibuã_øm_code_£c_
 
__©åibuã__
((
wók
)Ë
	$ex˚±_h™dÀr
()

170 vﬁ©ûê
i
 = 0; i < 0xffff; i++)

172 
	`__asm__
("nop");

175 
	}
}

176 
_©åibuã_øm_code_£c_noölöe_
 
__©åibuã__
((
wók
)Ë
	$å≠_íåy
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

177 
	$å≠_íåy
()

179 
	`ex˚±_h™dÀr
();

180 
	}
}

186 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq1
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

187 
	$íåy_úq1
()

189 
	`∂ic_i§
(
°imî_úq_h™dÀr
,
IRQ1_SYSTIMER
);

190 
	}
}

196 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq2
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

197 
	$íåy_úq2
()

199 
	`∂ic_i§
(
™Æog_úq_h™dÀr
,
IRQ2_ALG
);

200 
	}
}

207 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq3
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

208 
	$íåy_úq3
()

210 
	`∂ic_i§
(
timî1_úq_h™dÀr
,
IRQ3_TIMER1
);

211 
	}
}

217 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq4
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

218 
	$íåy_úq4
()

220 
	`∂ic_i§
(
timî0_úq_h™dÀr
,
IRQ4_TIMER0
);

221 
	}
}

228 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq5
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

229 
	$íåy_úq5
()

231 
	`∂ic_i§
(
dma_úq_h™dÀr
,
IRQ5_DMA
);

232 
	}
}

238 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq6
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

239 
	$íåy_úq6
()

241 
	`∂ic_i§
(
bmc_úq_h™dÀr
,
IRQ6_BMC
);

242 
	}
}

249 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq7
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

250 
	$íåy_úq7
()

252 
	`∂ic_i§
(
usb_˘æ_ï_£tup_úq_h™dÀr
,
IRQ7_USB_CTRL_EP_SETUP
);

253 
	}
}

259 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq8
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

260 
	$íåy_úq8
()

262 
	`∂ic_i§
(
usb_˘æ_ï_d©a_úq_h™dÀr
,
IRQ8_USB_CTRL_EP_DATA
);

263 
	}
}

269 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq9
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

270 
	$íåy_úq9
()

272 
	`∂ic_i§
(
usb_˘æ_ï_°©us_úq_h™dÀr
,
IRQ9_USB_CTRL_EP_STATUS
);

273 
	}
}

280 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq10
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

281 
	$íåy_úq10
()

283 
	`∂ic_i§
(
usb_˘æ_ï_£töf_úq_h™dÀr
,
IRQ10_USB_CTRL_EP_SETINF
);

284 
	}
}

290 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq11
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

291 
	$íåy_úq11
()

293 
	`∂ic_i§
(
usb_ídpoöt_úq_h™dÀr
,
IRQ11_USB_ENDPOINT
);

294 
	}
}

300 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq12
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

301 
	$íåy_úq12
()

303 
	`∂ic_i§
(
rf_dm_úq_h™dÀr
,
IRQ12_ZB_DM
);

304 
	}
}

310 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq13
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

311 
	$íåy_úq13
()

313 
	`∂ic_i§
(
rf_bÀ_úq_h™dÀr
,
IRQ13_ZB_BLE
);

314 
	}
}

321 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq14
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

322 
	$íåy_úq14
()

324 
	`∂ic_i§
(
rf_bt_úq_h™dÀr
,
IRQ14_ZB_BT
);

325 
	}
}

331 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq15
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

332 
	$íåy_úq15
()

334 
	`∂ic_i§
(
rf_úq_h™dÀr
,
IRQ15_ZB_RT
);

335 
	}
}

343 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq16
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

344 
	$íåy_úq16
()

346 
	`∂ic_i§
(
pwm_úq_h™dÀr
,
IRQ16_PWM
);

347 
	}
}

353 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq17
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

354 
	$íåy_úq17
()

356 
	`∂ic_i§
(
pke_úq_h™dÀr
,
IRQ17_PKE
);

357 
	}
}

365 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq18
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

366 
	$íåy_úq18
()

368 
	`∂ic_i§
(
u¨t1_úq_h™dÀr
,
IRQ18_UART1
);

369 
	}
}

377 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq19
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

378 
	$íåy_úq19
()

380 
	`∂ic_i§
(
u¨t0_úq_h™dÀr
,
IRQ19_UART0
);

381 
	}
}

388 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq20
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

389 
	$íåy_úq20
()

391 
	`∂ic_i§
(
audio_úq_h™dÀr
,
IRQ20_DFIFO
);

392 
	}
}

398 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq21
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

399 
	$íåy_úq21
()

401 
	`∂ic_i§
(
i2c_úq_h™dÀr
,
IRQ21_I2C
);

402 
	}
}

409 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq22
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

410 
	$íåy_úq22
()

412 
	`∂ic_i§
(
h•i_úq_h™dÀr
,
IRQ22_SPI_AHB
);

413 
	}
}

420 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq23
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

421 
	$íåy_úq23
()

423 
	`∂ic_i§
(
p•i_úq_h™dÀr
,
IRQ23_SPI_APB
);

425 
	}
}

431 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq24
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

432 
	$íåy_úq24
()

434 
	`∂ic_i§
(
usb_pwdn_úq_h™dÀr
,
IRQ24_USB_PWDN
);

435 
	}
}

441 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq25
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

442 
	$íåy_úq25
()

444 
	`∂ic_i§
(
gpio_úq_h™dÀr
,
IRQ25_GPIO
);

445 
	}
}

451 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq26
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

452 
	$íåy_úq26
()

454 
	`∂ic_i§
(
gpio_risc0_úq_h™dÀr
,
IRQ26_GPIO2RISC0
);

455 
	}
}

462 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq27
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

463 
	$íåy_úq27
()

465 
	`∂ic_i§
(
gpio_risc1_úq_h™dÀr
,
IRQ27_GPIO2RISC1
);

466 
	}
}

472 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq28
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

473 
	$íåy_úq28
()

475 
	`∂ic_i§
(
so·_úq_h™dÀr
,
IRQ28_SOFT
);

476 
	}
}

483 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq29
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

484 
	$íåy_úq29
()

486 
	`∂ic_i§
(
≈e_bus0_úq_h™dÀr
,
IRQ29_NPE_BUS0
);

487 
	}
}

492 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq30
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

493 
	$íåy_úq30
()

495 
	`∂ic_i§
(
≈e_bus1_úq_h™dÀr
,
IRQ30_NPE_BUS1
);

496 
	}
}

501 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq31
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

502 
	$íåy_úq31
()

504 
	`∂ic_i§
(
≈e_bus2_úq_h™dÀr
,
IRQ31_NPE_BUS2
);

505 
	}
}

510 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq32
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

511 
	$íåy_úq32
()

513 
	`∂ic_i§
(
≈e_bus3_úq_h™dÀr
,
IRQ32_NPE_BUS3
);

514 
	}
}

520 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq33
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

521 
	$íåy_úq33
()

523 
	`∂ic_i§
(
≈e_bus4_úq_h™dÀr
,
IRQ33_NPE_BUS4
);

524 
	}
}

529 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq34
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

530 
	$íåy_úq34
()

532 
	`∂ic_i§
(
usb_250us_úq_h™dÀr
,
IRQ34_USB_250US
);

533 
	}
}

538 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq35
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

539 
	$íåy_úq35
()

541 
	`∂ic_i§
(
usb_ª£t_úq_h™dÀr
,
IRQ35_USB_RESET
);

542 
	}
}

547 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq36
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

548 
	$íåy_úq36
()

550 
	`∂ic_i§
(
≈e_bus7_úq_h™dÀr
,
IRQ36_NPE_BUS7
);

551 
	}
}

556 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq37
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

557 
	$íåy_úq37
()

559 
	`∂ic_i§
(
≈e_bus8_úq_h™dÀr
,
IRQ37_NPE_BUS8
);

560 
	}
}

563 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq38
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

564 
	$íåy_úq38
()

567 
	}
}

568 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq39
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

569 
	$íåy_úq39
()

572 
	}
}

573 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq40
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

574 
	$íåy_úq40
()

577 
	}
}

578 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq41
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

579 
	$íåy_úq41
()

582 
	}
}

587 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq42
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

588 
	$íåy_úq42
()

590 
	`∂ic_i§
(
≈e_bus13_úq_h™dÀr
,
IRQ42_NPE_BUS13
);

591 
	}
}

596 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq43
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

597 
	$íåy_úq43
()

599 
	`∂ic_i§
(
≈e_bus14_úq_h™dÀr
,
IRQ43_NPE_BUS14
);

600 
	}
}

606 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq44
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

607 
	$íåy_úq44
()

609 
	`∂ic_i§
(
≈e_bus15_úq_h™dÀr
,
IRQ44_NPE_BUS15
);

610 
	}
}

611 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq45
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

612 
	$íåy_úq45
()

615 
	}
}

620 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq46
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

621 
	$íåy_úq46
()

623 
	`∂ic_i§
(
≈e_bus17_úq_h™dÀr
,
IRQ46_NPE_BUS17
);

624 
	}
}

627 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq47
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

628 
	$íåy_úq47
()

631 
	}
}

633 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq48
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

634 
	$íåy_úq48
()

637 
	}
}

639 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq49
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

640 
	$íåy_úq49
()

643 
	}
}

648 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq50
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

649 
	$íåy_úq50
()

651 
	`∂ic_i§
(
≈e_bus21_úq_h™dÀr
,
IRQ50_NPE_BUS21
);

652 
	}
}

657 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq51
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

658 
	$íåy_úq51
()

660 
	`∂ic_i§
(
≈e_bus22_úq_h™dÀr
,
IRQ51_NPE_BUS22
);

661 
	}
}

666 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq52
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

667 
	$íåy_úq52
()

669 
	`∂ic_i§
(
≈e_bus23_úq_h™dÀr
,
IRQ52_NPE_BUS23
);

670 
	}
}

675 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq53
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

676 
	$íåy_úq53
()

678 
	`∂ic_i§
(
≈e_bus24_úq_h™dÀr
,
IRQ53_NPE_BUS24
);

679 
	}
}

684 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq54
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

685 
	$íåy_úq54
()

687 
	`∂ic_i§
(
≈e_bus25_úq_h™dÀr
,
IRQ54_NPE_BUS25
);

688 
	}
}

693 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq55
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

694 
	$íåy_úq55
()

696 
	`∂ic_i§
(
≈e_bus26_úq_h™dÀr
,
IRQ55_NPE_BUS26
);

697 
	}
}

702 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq56
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

703 
	$íåy_úq56
()

705 
	`∂ic_i§
(
≈e_bus27_úq_h™dÀr
,
IRQ56_NPE_BUS27
);

706 
	}
}

711 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq57
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

712 
	$íåy_úq57
()

714 
	`∂ic_i§
(
≈e_bus28_úq_h™dÀr
,
IRQ57_NPE_BUS28
);

715 
	}
}

720 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq58
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

721 
	$íåy_úq58
()

723 
	`∂ic_i§
(
≈e_bus29_úq_h™dÀr
,
IRQ58_NPE_BUS29
);

724 
	}
}

729 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq59
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

730 
	$íåy_úq59
()

732 
	`∂ic_i§
(
≈e_bus30_úq_h™dÀr
,
IRQ59_NPE_BUS30
);

733 
	}
}

738 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq60
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

739 
	$íåy_úq60
()

741 
	`∂ic_i§
(
≈e_bus31_úq_h™dÀr
,
IRQ60_NPE_BUS31
);

742 
	}
}

747 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq61
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

748 
	$íåy_úq61
()

750 
	`∂ic_i§
(
≈e_comb_úq_h™dÀr
,
IRQ61_NPE_COMB
);

751 
	}
}

756 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq62
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

757 
	$íåy_úq62
()

759 
	`∂ic_i§
(
pm_úq_h™dÀr
,
IRQ62_PM_TM
);

760 
	}
}

765 
_©åibuã_øm_code_£c_noölöe_
 
	$íåy_úq63
(Ë
	`__©åibuã__
 ((
	`öãºu±
 ("machöe"Ë, 
	`Æig√d
(4)));

766 
	$íåy_úq63
()

768 
	`∂ic_i§
(
eoc_úq_h™dÀr
,
IRQ63_EOC
);

769 
	}
}

	@platform/chip_b91/plic.h

35 #i‚de‡ 
INTERRUPT_H


36 
	#INTERRUPT_H


	)

37 
	~"c‹e.h
"

39 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

40 
	~"compûî.h
"

44 
	m¥ìm±_í
;

45 
	mthªshﬁd
;

46 }
	t¥ìm±_c⁄fig_t
 ;

49 
g_∂ic_¥ìm±_í
;

52 
	mIRQ0_EXCEPTION
 ,

53 
	mIRQ1_SYSTIMER
,

54 
	mIRQ2_ALG
,

55 
	mIRQ3_TIMER1
,

56 
	mIRQ4_TIMER0
,

57 
	mIRQ5_DMA
,

58 
	mIRQ6_BMC
,

59 
	mIRQ7_USB_CTRL_EP_SETUP
,

60 
	mIRQ8_USB_CTRL_EP_DATA
,

61 
	mIRQ9_USB_CTRL_EP_STATUS
,

62 
	mIRQ10_USB_CTRL_EP_SETINF
,

63 
	mIRQ11_USB_ENDPOINT
,

64 
	mIRQ12_ZB_DM
,

65 
	mIRQ13_ZB_BLE
,

66 
	mIRQ14_ZB_BT
,

67 
	mIRQ15_ZB_RT
,

68 
	mIRQ16_PWM
,

69 
	mIRQ17_PKE
,

70 
	mIRQ18_UART1
,

71 
	mIRQ19_UART0
,

72 
	mIRQ20_DFIFO
,

73 
	mIRQ21_I2C
,

74 
	mIRQ22_SPI_AHB
,

75 
	mIRQ23_SPI_APB
,

76 
	mIRQ24_USB_PWDN
,

77 
	mIRQ25_GPIO
,

78 
	mIRQ26_GPIO2RISC0
,

79 
	mIRQ27_GPIO2RISC1
,

80 
	mIRQ28_SOFT
,

82 
	mIRQ29_NPE_BUS0
,

83 
	mIRQ30_NPE_BUS1
,

84 
	mIRQ31_NPE_BUS2
,

85 
	mIRQ32_NPE_BUS3
,

86 
	mIRQ33_NPE_BUS4
,

88 
	mIRQ34_USB_250US
,

89 
	mIRQ35_USB_RESET
,

90 
	mIRQ36_NPE_BUS7
,

91 
	mIRQ37_NPE_BUS8
,

93 
	mIRQ42_NPE_BUS13
=42,

94 
	mIRQ43_NPE_BUS14
,

95 
	mIRQ44_NPE_BUS15
,

97 
	mIRQ46_NPE_BUS17
=46,

99 
	mIRQ50_NPE_BUS21
=50,

100 
	mIRQ51_NPE_BUS22
,

101 
	mIRQ52_NPE_BUS23
,

102 
	mIRQ53_NPE_BUS24
,

103 
	mIRQ54_NPE_BUS25
,

104 
	mIRQ55_NPE_BUS26
,

105 
	mIRQ56_NPE_BUS27
,

106 
	mIRQ57_NPE_BUS28
,

107 
	mIRQ58_NPE_BUS29
,

108 
	mIRQ59_NPE_BUS30
,

109 
	mIRQ60_NPE_BUS31
,

111 
	mIRQ61_NPE_COMB
,

112 
	mIRQ62_PM_TM
,

113 
	mIRQ63_EOC
,

115 } 
	túq_sour˚_e
;

118 
	mIRQ_PRI_LEV0
,

119 
	mIRQ_PRI_LEV1
,

120 
	mIRQ_PRI_LEV2
,

121 
	mIRQ_PRI_LEV3
,

122 }
	túq_¥i‹ôy_e
;

130 
ölöe
 
	$∂ic_£t_„©uª
 (
„©uª_e
 
„©uª
)

132 
ªg_úq_„©uª
 = 
„©uª
;

133 
	}
}

139 
ölöe
 
	$∂ic_¥ìm±_„©uª_í
 ()

141 
ªg_úq_„©uª
 |
FLD_FEATURE_PREEMPT_PRIORITY_INT_EN
;

142 
g_∂ic_¥ìm±_í
=1;

143 
	}
}

149 
ölöe
 
	$∂ic_¥ìm±_„©uª_dis
 ()

151 
ªg_úq_„©uª
 &=(~ 
FLD_FEATURE_PREEMPT_PRIORITY_INT_EN
);

152 
g_∂ic_¥ìm±_í
=0;

153 
	}
}

161 
ölöe
 
	$∂ic_£t_≥ndög
 (
úq_sour˚_e
 
§c
)

163 
	`ªg_úq_≥ndög
(
§c
)=
	`BIT
(src%32);

164 
	}
}

171 
ölöe
 
	$∂ic_£t_thªshﬁd
 (
thªshﬁd
)

173 
ªg_úq_thªshﬁd
=
thªshﬁd
;

174 
	}
}

183 
ölöe
 
	$∂ic_£t_¥i‹ôy
 (
úq_sour˚_e
 
§c
, 
úq_¥i‹ôy_e
 
¥i‹ôy
)

185 
	`ªg_úq_§c_¥i‹ôy
(
§c
)=
¥i‹ôy
;

186 
	}
}

194 
ölöe
 
	$∂ic_öãºu±_íabÀ
(
úq_sour˚_e
 
§c
)

196 
	`ªg_úq_§c
(
§c
Ë|
	`BIT
(src%32);

198 
	}
}

205 
ölöe
 
	$∂ic_öãºu±_dißbÀ
(
úq_sour˚_e
 
§c
)

207 
	`ªg_úq_§c
(
§c
Ë&(~ 
	`BIT
(src%32));

208 
	}
}

215 
ölöe
 
	$∂ic_öãºu±_com∂ëe
(
úq_sour˚_e
 
§c
)

217 
ªg_úq_d⁄e
 = 
§c
;

218 
	}
}

224 
ölöe
 
	$∂ic_öãºu±_˛aim
()

226  
ªg_úq_d⁄e
;

227 
	}
}

237 
_©åibuã_øm_code_£c_noölöe_
 
∂ic_íãr_¸ôiˇl_£c
(
¥ìm±_í
 ,
thªshﬁd
);

247 
_©åibuã_øm_code_£c_noölöe_
 
∂ic_exô_¸ôiˇl_£c
(
¥ìm±_í
 ,
r
);

	@platform/chip_b91/pm.h

24 #¥agm®
⁄˚


26 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

27 
	~"compûî.h
"

28 
	~"gpio.h
"

29 
	~"˛ock.h
"

40 #i‚de‡
WDT_REBOOT_RESET_ANA7F_WORK_AROUND


41 
	#WDT_REBOOT_RESET_ANA7F_WORK_AROUND
 1

	)

44 #i‚de‡
SYS_TIMER_AUTO_MODE


45 
	#SYS_TIMER_AUTO_MODE
 1

	)

57 
	#PM_ANA_REG_WD_CLR_BUF0
 0x38

58 

	)

63 
	#PM_ANA_REG_POWER_ON_CLR_BUF0
 0x39

64 
	#PM_ANA_REG_POWER_ON_CLR_BUF1
 0x3a

65 
	#PM_ANA_REG_POWER_ON_CLR_BUF2
 0x3b

66 
	#PM_ANA_REG_POWER_ON_CLR_BUF3
 0x3c

67 
	#PM_ANA_REG_POWER_ON_CLR_BUF4
 0x3d

68 
	#PM_ANA_REG_POWER_ON_CLR_BUF5
 0x3e

69 
	#PM_ANA_REG_POWER_ON_CLR_BUF6
 0x3f

70 

	)

75 
	mWAKEUP_LEVEL_LOW
 = 0,

76 
	mWAKEUP_LEVEL_HIGH
 = 1,

77 }
	tpm_gpio_wakeup_Àvñ_e
;

83 
	mPM_TICK_STIMER_16M
 = 0,

84 
	mPM_TICK_32K
 = 1,

85 }
	tpm_wakeup_tick_ty≥_e
;

91 
	mPM_POWERON_BASEBAND
 = 
BIT
(0),

92 
	mPM_POWERON_USB
 = 
BIT
(1),

93 
	mPM_POWERON_NPE
 = 
BIT
(2),

94 }
	tpm_su•íd_powî_cfg_e
;

101 
	mSUSPEND_MODE
 = 0x00,

102 
	mDEEPSLEEP_MODE
 = 0x30,

105 
	mDEEPSLEEP_MODE_RET_SRAM_LOW32K
 = 0x21,

106 
	mDEEPSLEEP_MODE_RET_SRAM_LOW64K
 = 0x03,

108 
	mDEEPSLEEP_RETENTION_FLAG
 = 0x0F,

109 }
	tpm_¶ìp_mode_e
;

115 
	mPM_WAKEUP_PAD
 = 
BIT
(3),

116 
	mPM_WAKEUP_CORE
 = 
BIT
(4),

117 
	mPM_WAKEUP_TIMER
 = 
BIT
(5),

118 
	mPM_WAKEUP_COMPARATOR
 = 
BIT
(6),

119 
	mPM_WAKEUP_MDEC
 = 
BIT
(7),

120 }
	tpm_¶ìp_wakeup_§c_e
;

126 
	mWAKEUP_STATUS_COMPARATOR
 = 
BIT
(0),

127 
	mWAKEUP_STATUS_TIMER
 = 
BIT
(1),

128 
	mWAKEUP_STATUS_CORE
 = 
BIT
(2),

129 
	mWAKEUP_STATUS_PAD
 = 
BIT
(3),

130 
	mWAKEUP_STATUS_MDEC
 = 
BIT
(4),

132 
	mSTATUS_GPIO_ERR_NO_ENTER_PM
 = 
BIT
(7),

133 
	mSTATUS_ENTER_SUSPEND
 = 
BIT
(30),

134 }
	tpm_wakeup_°©us_e
;

143 
	mMCU_STATUS_POWER_ON
 = 
BIT
(0),

144 
	mMCU_STATUS_REBOOT_BACK
 = 
BIT
(2),

145 
	mMCU_STATUS_DEEPRET_BACK
 = 
BIT
(3),

146 
	mMCU_STATUS_DEEP_BACK
 = 
BIT
(4),

147 
	mMCU_STATUS_REBOOT_DEEP_BACK
 = 
BIT
(5),

148 }
	tpm_mcu_°©us
;

154 
	msu•íd_óæy_wakeup_time_us
;

155 
	mdìp_ªt_óæy_wakeup_time_us
;

156 
	mdìp_óæy_wakeup_time_us
;

157 
	m¶ìp_mö_time_us
;

158 }
	tpm_óæy_wakeup_time_us_s
;

164 
	mdìp_r_dñay_cy˛e
 ;

165 
	msu•íd_ªt_r_dñay_cy˛e
 ;

167 }
	tpm_r_dñay_cy˛e_s
;

173 
	mis_∑d_wakeup
;

174 
	mwakeup_§c
;

175 
	mmcu_°©us
;

176 
	mrsvd
;

177 }
	tpm_°©us_öfo_s
;

182 
	spm_˛ock_dri·


184 
	mªf_tick
;

185 
	mªf_tick_32k
;

186 
	moff£t
;

187 
	moff£t_dc
;

188 
	moff£t_cur
;

189 
	mtc
;

190 
	mrc32
;

191 
	mrc32_wakeup
;

192 
	mrc32_π
;

193 
	ms0
;

194 
	mˇlib
;

196 } 
	tpm_˛ock_dri·_t
;

199 
pm_˛ock_dri·_t
 
pmcd
;

200 
	$_©åibuã_Æig√d_
(4Ë
pm_°©us_öfo_s
 
g_pm_°©us_öfo
;

201 
_©åibuã_d©a_ªã¡i⁄_£c_
 
g_pm_su•íd_powî_cfg
;

202 
_©åibuã_d©a_ªã¡i⁄_£c_
 
g_pm_vb©_v
;

209 
ölöe
 
	$pm_£t_mdec_vÆue_wakeup
(
vÆue
)

211 
	`™Æog_wrôe_ªg8
(
mdec_˘æ
,((
	`™Æog_ªad_ªg8
(mdec_˘æË& (~0x0f)Ë| 
vÆue
));

212 
	}
}

219 
ölöe
 
	$pm_£t_su•íd_powî_cfg
(
pm_su•íd_powî_cfg_e
 
vÆue
)

221 
g_pm_su•íd_powî_cfg
 &(~
vÆue
);

222 
	}
}

228 
ölöe
 
	$pm_gë_dìp_ªã¡i⁄_Êag
()

230  !(
	`™Æog_ªad_ªg8
(0x7fË& 
	`BIT
(0));

231 
	}
}

237 
ölöe
 
pm_wakeup_°©us_e
 
	$pm_gë_wakeup_§c
()

239  
	`™Æog_ªad_ªg8
(0x64);

240 
	}
}

249 
pm_£t_gpio_wakeup
 (
gpio_pö_e
 
pö
, 
pm_gpio_wakeup_Àvñ_e
 
pﬁ
, 
í
);

256 
pm_£t_wakeup_time_∑øm
(
pm_r_dñay_cy˛e_s
 
∑øm
);

262 
_©åibuã_øm_code_£c_noölöe_
 
pm_waô_bb∂l_d⁄e
();

269 
_©åibuã_øm_code_£c_noölöe_
 
pm_°imî_ªcovî
();

285 
_©åibuã_øm_code_£c_noölöe_
 
pm_¶ìp_wakeup
(
pm_¶ìp_mode_e
 
¶ìp_mode
, 
pm_¶ìp_wakeup_§c_e
 
wakeup_§c
, 
pm_wakeup_tick_ty≥_e
 
wakeup_tick_ty≥
, 
wakeup_tick
);

292 
_©åibuã_øm_code_£c_noölöe_
 
pm_ˇl_32k_rc_off£t
 (
off£t_tick
);

298 
_©åibuã_øm_code_£c_noölöe_
 
pm_32k_rc_off£t_öô
();

	@platform/chip_b91/pwm.h

24 #i‚de‡
PWM_H_


25 
	#PWM_H_


	)

26 
	~"gpio.h
"

27 
	~"dma.h
"

28 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

30 
	#gë_pwmid
(
gpio
Ë((gpio==
PWM_PWM0_PB4
Ë? 0 : ( \

	)

31 (
	ggpio
==
PWM_PWM0_PC0
) ? 0 : ( \

32 (
gpio
==
PWM_PWM0_PE3
) ? 0 : ( \

33 (
gpio
==
PWM_PWM0_N_PD0
) ? 0 : ( \

34 (
gpio
==
PWM_PWM1_PB5
) ? 1 : ( \

35 (
gpio
==
PWM_PWM1_PE1
) ? 1 : ( \

36 (
gpio
==
PWM_PWM1_N_PD1
) ? 1 : ( \

37 (
gpio
==
PWM_PWM2_PB7
) ? 2 : ( \

38 (
gpio
==
PWM_PWM2_PE2
) ? 2 : ( \

39 (
gpio
==
PWM_PWM2_N_PD2
) ? 2 : ( \

40 (
gpio
==
PWM_PWM2_N_PE6
) ? 2 : ( \

41 (
gpio
==
PWM_PWM3_PB1
) ? 3 : ( \

42 (
gpio
==
PWM_PWM3_PE0
) ? 3 : ( \

43 (
gpio
==
PWM_PWM3_N_PD3
) ? 3 : ( \

44 (
gpio
==
PWM_PWM3_N_PE7
) ? 3 : ( \

45 (
gpio
==
PWM_PWM4_PD7
) ? 4 : ( \

46 (
gpio
==
PWM_PWM4_PE4
) ? 4 : ( \

47 (
gpio
==
PWM_PWM4_N_PD4
) ? 4 : ( \

48 (
gpio
==
PWM_PWM5_PB0
) ? 5 : ( \

49 (
gpio
==
PWM_PWM5_PE5
) ? 5 : ( \

50 (
gpio
==
PWM_PWM5_N_PD5
) ? 5 : 0 \

53 
	#gë_pwm_övît_vÆ
(
gpio
Ë((gpio==
PWM_PWM0_N_PD0
Ë|| \

	)

54 (
gpio
==
PWM_PWM1_N_PD1
) || \

55 (
gpio
==
PWM_PWM2_N_PD2
) || \

56 (
gpio
==
PWM_PWM2_N_PE6
) || \

57 (
gpio
==
PWM_PWM3_N_PD3
) || \

58 (
gpio
==
PWM_PWM3_N_PE7
) || \

59 (
gpio
==
PWM_PWM4_N_PD4
) || \

60 (
gpio
==
PWM_PWM5_N_PD5
))

66 
PWM0_ID
 = 0,

67 
	mPWM1_ID
,

68 
	mPWM2_ID
,

69 
	mPWM3_ID
,

70 
	mPWM4_ID
,

71 
	mPWM5_ID
,

72 }
	tpwm_id_e
;

79 
	mPWM_NORMAL_MODE
 = 0x00,

80 
	mPWM_COUNT_MODE
 = 0x01,

81 
	mPWM_IR_MODE
 = 0x03,

82 
	mPWM_IR_FIFO_MODE
 = 0x07,

83 
	mPWM_IR_DMA_FIFO_MODE
 = 0x0F,

84 }
	tpwm_mode_e
;

91 
	mPWM_PWM0_PB4
 = 
GPIO_PB4
,

92 
	mPWM_PWM0_PC0
 = 
GPIO_PC0
,

93 
	mPWM_PWM0_PE3
 = 
GPIO_PE3
,

94 
	mPWM_PWM0_N_PD0
 = 
GPIO_PD0
,

96 
	mPWM_PWM1_PB5
 = 
GPIO_PB5
,

97 
	mPWM_PWM1_PE1
 = 
GPIO_PE1
,

98 
	mPWM_PWM1_N_PD1
 = 
GPIO_PD1
,

100 
	mPWM_PWM2_PB7
 = 
GPIO_PB7
,

101 
	mPWM_PWM2_PE2
 = 
GPIO_PE2
,

102 
	mPWM_PWM2_N_PD2
 = 
GPIO_PD2
,

103 
	mPWM_PWM2_N_PE6
 = 
GPIO_PE6
,

105 
	mPWM_PWM3_PB1
 = 
GPIO_PB1
,

106 
	mPWM_PWM3_PE0
 = 
GPIO_PE0
,

107 
	mPWM_PWM3_N_PD3
 = 
GPIO_PD3
,

108 
	mPWM_PWM3_N_PE7
 = 
GPIO_PE7
,

110 
	mPWM_PWM4_PD7
 = 
GPIO_PD7
,

111 
	mPWM_PWM4_PE4
 = 
GPIO_PE4
,

112 
	mPWM_PWM4_N_PD4
 = 
GPIO_PD4
,

114 
	mPWM_PWM5_PB0
 = 
GPIO_PB0
,

115 
	mPWM_PWM5_PE5
 = 
GPIO_PE5
,

116 
	mPWM_PWM5_N_PD5
 = 
GPIO_PD5
,

117 }
	tpwm_pö_e
;

127 
	mPWM_CLOCK_32K_CHN_PWM0
 = 0x01,

128 
	mPWM_CLOCK_32K_CHN_PWM1
 = 0x02,

129 
	mPWM_CLOCK_32K_CHN_PWM2
 = 0x04,

130 
	mPWM_CLOCK_32K_CHN_PWM3
 = 0x08,

131 
	mPWM_CLOCK_32K_CHN_PWM4
 = 0x10,

132 
	mPWM_CLOCK_32K_CHN_PWM5
 = 0x20

134 }
	tpwm_˛k_32k_í_chn_e
;

147 
ölöe
 
	$pwm_£t_˛k
(
pwm_˛k_div
){

149 
ªg_pwm_˛kdiv
 = 
pwm_˛k_div
;

150 
	}
}

160 
ölöe
 
	$pwm_32k_chn_í
(
pwm_˛k_32k_í_chn_e
 
pwm_32K_í_chn
){

162 
ªg_pwm_mode32k
 |
pwm_32K_í_chn
;

164 
	}
}

172 
pwm_£t_pö
(
pwm_pö_e
 
pö
);

183 
ölöe
 
	$pwm_£t_tcmp
(
pwm_id_e
 
id
, 
tcmp
)

185 
	`ªg_pwm_cmp
(
id
Ë
tcmp
;

186 
	}
}

195 
ölöe
 
	$pwm_£t_tmax
(
pwm_id_e
 
id
, 
tmax
){

196 
	`ªg_pwm_max
(
id
Ë
tmax
;

197 
	}
}

203 
ölöe
 
	$pwm_32k_chn_upd©e_duty_cy˛e
(){

204 
ªg_pwm_˙t5_l
 |
FLD_PWM_32K_DUTY_CYCLE_UPDATE
;

205 
	}
}

212 
ölöe
 
	$pwm_°¨t
(
pwm_id_e
 
id
){

213 if(
PWM0_ID
 =
id
){

214 
	`BM_SET
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

217 
	`BM_SET
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

219 
	}
}

227 
ölöe
 
	$pwm_°›
(
pwm_id_e
 
id
){

228 if(
PWM0_ID
 =
id
){

229 
	`BM_CLR
(
ªg_pwm0_íabÀ
, 
	`BIT
(0));

232 
	`BM_CLR
(
ªg_pwm_íabÀ
, 
	`BIT
(
id
));

234 
	}
}

242 
ölöe
 
	$pwm_övît_í
(
pwm_id_e
 
id
){

243 
ªg_pwm_övît
 |
	`BIT
(
id
);

244 
	}
}

252 
ölöe
 
	$pwm_övît_dis
(
pwm_id_e
 
id
){

253 
	`BM_CLR
(
ªg_pwm_övît
, 
	`BIT
(
id
));

254 
	}
}

262 
ölöe
 
	$pwm_n_övît_í
(
pwm_id_e
 
id
){

263 
ªg_pwm_n_övît
 |
	`BIT
(
id
);

264 
	}
}

272 
ölöe
 
	$pwm_n_övît_dis
(
pwm_id_e
 
id
){

273 
	`BM_CLR
(
ªg_pwm_n_övît
, 
	`BIT
(
id
));

274 
	}
}

282 
ölöe
 
	$pwm_£t_pﬁ¨ôy_í
(
pwm_id_e
 
id
){

283 
	`BM_SET
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

284 
	}
}

292 
ölöe
 
	$pwm_£t_pﬁ¨ôy_dis
(
pwm_id_e
 
id
){

293 
	`BM_CLR
(
ªg_pwm_pﬁ
, 
	`BIT
(
id
));

294 
	}
}

302 
ölöe
 
	$pwm_£t_úq_mask
(
pwm_úq_e
 
mask
){

304 if(
mask
==
FLD_PWM0_IR_FIFO_IRQ
)

306 
	`BM_SET
(
	`ªg_pwm_úq_mask
(1), 
	`BIT
(0));

310 
	`BM_SET
(
	`ªg_pwm_úq_mask
(0), 
mask
);

313 
	}
}

321 
ölöe
 
	$pwm_˛r_úq_mask
(
pwm_úq_e
 
mask
){

323 if(
mask
==
FLD_PWM0_IR_FIFO_IRQ
)

325 
	`BM_SET
(
	`ªg_pwm_úq_mask
(1), 
	`BIT
(0));

329 
	`BM_SET
(
	`ªg_pwm_úq_mask
(0), 
mask
);

332 
	}
}

340 
ölöe
 
	$pwm_gë_úq_°©us
(
pwm_úq_e
 
°©us
){

342 if(
°©us
==
FLD_PWM0_IR_FIFO_IRQ
)

344  (
	`ªg_pwm_úq_°a
(1Ë& 
	`BIT
(0));

348  (
	`ªg_pwm_úq_°a
(0Ë& 
°©us
);

351 
	}
}

359 
ölöe
 
	$pwm_˛r_úq_°©us
(
pwm_úq_e
 
°©us
){

361 if(
°©us
==
FLD_PWM0_IR_FIFO_IRQ
)

363 
	`BM_SET
(
	`ªg_pwm_úq_°a
(1), 
	`BIT
(0));

367 
	`BM_SET
(
	`ªg_pwm_úq_°a
(0), 
°©us
);

370 
	}
}

378 
ölöe
 
	$pwm_£t_pwm0_mode
(
pwm_mode_e
 
mode
){

379 
ªg_pwm0_mode
 = 
mode
;

380 
	}
}

389 
ölöe
 
	$pwm_£t_pwm0_tcmp_™d_tmax_shadow
(
max_tick
, 
cmp_tick
)

391 
ªg_pwm_tcmp0_shadow
 = 
cmp_tick
;

392 
ªg_pwm_tmax0_shadow
 = 
max_tick
;

393 
	}
}

401 
ölöe
 
	$pwm_£t_pwm0_pul£_num
(
pul£_num
){

402 
ªg_pwm0_pul£_num0
 = 
pul£_num
;

403 
ªg_pwm0_pul£_num1
 = 
pul£_num
>>8;

404 
	}
}

412 
ölöe
 
	$pwm_£t_pwm0_ú_fifo_úq_åig_Àvñ
(
åig_Àvñ
)

414 
ªg_pwm_ú_fifo_úq_åig_Àvñ
 = 
åig_Àvñ
;

415 
	}
}

423 
ölöe
 
	$pwm_˛r_pwm0_ú_fifo
()

425 
ªg_pwm_ú_˛r_fifo_d©a
 |
FLD_PWM0_IR_FIFO_CLR_DATA
;

426 
	}
}

433 
ölöe
 
	$pwm_gë_pwm0_ú_fifo_d©a_num
()

435  (
ªg_pwm_ú_fifo_d©a_°©us
 & 
FLD_PWM0_IR_FIFO_DATA_NUM
);

436 
	}
}

443 
ölöe
 
	$pwm_gë_pwm0_ú_fifo_is_em±y
()

445  (
ªg_pwm_ú_fifo_d©a_°©us
 & 
FLD_PWM0_IR_FIFO_EMPTY
);

446 
	}
}

453 
ölöe
 
	$pwm_gë_pwm0_ú_fifo_is_fuŒ
()

455  (
ªg_pwm_ú_fifo_d©a_°©us
&
FLD_PWM0_IR_FIFO_FULL
);

456 
	}
}

466 
ölöe
 
	$pwm_ˇl_pwm0_ú_fifo_cfg_d©a
(
pul£_num
, 
shadow_í
, 
ˇºõr_í
)

468  ( 
ˇºõr_í
<<15 | (
shadow_í
<<14Ë| (
pul£_num
 & 0x3fff) );

469 
	}
}

480 
ölöe
 
	$pwm_£t_pwm0_ú_fifo_cfg_d©a
(
pul£_num
, 
u£_shadow
, 
ˇºõr_í
)

482 
ödex
=0;

483 
cfg_d©a
 = 
	`pwm_ˇl_pwm0_ú_fifo_cfg_d©a
(
pul£_num
,
u£_shadow
,
ˇºõr_í
);

484 
	`pwm_gë_pwm0_ú_fifo_is_fuŒ
());

485 
	`ªg_pwm_ú_fifo_d©
(
ödex
Ë
cfg_d©a
;

486 
ödex
++;

487 
ödex
&=0x01;

488 
	}
}

496 
pwm_£t_dma_c⁄fig
(
dma_chn_e
 
chn
);

506 
pwm_£t_dma_buf
(
dma_chn_e
 
chn
,
buf_addr
,
Àn
);

514 
pwm_ú_dma_mode_°¨t
(
dma_chn_e
 
chn
);

526 
pwm_£t_dma_chaö_Œp
(
dma_chn_e
 
chn
,* 
§c_addr
, 
d©a_Àn
,
dma_chaö_c⁄fig_t
 * 
hód_of_li°
);

540 
pwm_£t_tx_dma_add_li°_ñemít
(
dma_chn_e
 
chn
,
dma_chaö_c⁄fig_t
 *
c⁄fig_addr
,dma_chaö_c⁄fig_à*
Œp⁄ô
 ,* 
§c_addr
,
d©a_Àn
);

551 
ölöe
 
	$pwm_32k_chn_dis
(
pwm_˛k_32k_í_chn_e
 
pwm_32K_í_chn
)

553 
	`BM_CLR
(
ªg_pwm_mode32k
, 
pwm_32K_í_chn
);

554 
	}
}

	@platform/chip_b91/reg_include/adc_reg.h

24 #i‚de‡
ADC_REG_H


25 
	#ADC_REG_H


	)

26 
	~"../sys.h
"

28 
	#¨eg_adc_˛k_£âög
 0x82

	)

31 
	mFLD_CLK_24M_TO_SAR_EN
 = 
BIT
(6),

34 
	#¨eg_adc_vªf
 0xó

	)

36 
	mFLD_ADC_VREF_CHN_M
 = 
BIT_RNG
(0,1),

38 
	#¨eg_adc_aö_chn_misc
 0xeb

	)

40 
	mFLD_ADC_AIN_NEGATIVE
 = 
BIT_RNG
(0,3),

41 
	mFLD_ADC_AIN_POSITIVE
 = 
BIT_RNG
(4,7),

43 
	#¨eg_adc_ªs_m
 0xec

	)

45 
	mFLD_ADC_RES_M
 = 
BIT_RNG
(0,1),

46 
	mFLD_ADC_EN_DIFF_CHN_M
 = 
BIT
(6),

48 
	#¨eg_adc_tsm≠À_m
 0xì

	)

50 
	mFLD_ADC_TSAMPLE_CYCLE_CHN_M
 = 
BIT_RNG
(0,3),

52 
	#¨eg_r_max_mc
 0xef

	)

54 
	mFLD_R_MAX_MC0
 = 
BIT_RNG
(0,7),

56 
	#¨eg_r_max_s
 0xf1

	)

58 
	mFLD_R_MAX_S
 = 
BIT_RNG
(0,3),

59 
	mFLD_R_MAX_MC1
 = 
BIT_RNG
(6,7),

61 
	#¨eg_adc_chn_í
 0xf2

	)

63 
	mFLD_ADC_CHN_EN_M
 = 
BIT
(2),

64 
	mFLD_ADC_MAX_SCNT
 = 
BIT_RNG
(4,5),

66 
	#¨eg_adc_d©a_ßm∂e_c⁄åﬁ
 0xf3

	)

68 
	mFLD_NOT_SAMPLE_ADC_DATA
 = 
BIT
(0),

70 
	#¨eg_adc_ßm∂e_˛k_div
 0xf4

	)

72 
	mFLD_ADC_SAMPLE_CLK_DIV
 = 
BIT_RNG
(0,2),

74 
	#¨eg_adc_misc_l
 0xf7

	)

75 
	#¨eg_adc_misc_h
 0xf8

	)

76 
	#¨eg_adc_vªf_vb©_div
 0xf9

	)

78 
	mFLD_ADC_VREF_VBAT_DIV
 = 
BIT_RNG
(2,3),

80 
	#¨eg_aö_sˇÀ
 0xÁ

	)

82 
	mFLD_ADC_ITRIM_PREAMP
 = 
BIT_RNG
(0,1),

83 
	mFLD_ADC_ITRIM_VREFBUF
 = 
BIT_RNG
(2,3),

84 
	mFLD_ADC_ITRIM_VCMBUF
 = 
BIT_RNG
(4,5),

85 
	mFLD_SEL_AIN_SCALE
 = 
BIT_RNG
(6,7),

87 
	#¨eg_adc_pga_˘æ
 0xfc

	)

89 
	mFLD_SAR_ADC_POWER_DOWN
 = 
BIT
(5),

91 
	#¨eg_ãmp_£ns‹_˘æ
 0x00

	)

93 
	mFLD_TEMP_SENSOR_POWER_DOWN
 = 
BIT
(4),

	@platform/chip_b91/reg_include/aes_reg.h

24 #i‚de‡
_AES_REG_H_


25 
	#_AES_REG_H_


	)

27 
	~"../sys.h
"

30 
	#ªg_´s_mode
 
	`REG_ADDR32
(0x1600b0)

	)

32 
	mFLD_AES_START
 = 
BIT
(0),

33 
	mFLD_AES_MODE
 = 
BIT
(1),

36 
	#ªg_emba£_addr
 
	`REG_ADDR32
(0x140b04)

	)

38 
	#ªg_´s_úq_mask
 
	`REG_ADDR32
(0x16000c)

	)

40 
	#ªg_´s_úq_°©us
 
	`REG_ADDR32
(0x160010)

	)

42 
	#ªg_´s_˛r_úq_°©us
 
	`REG_ADDR32
(0x160018)

	)

47 
	mFLD_CRYPT_IRQ
 = 
BIT
(7),

48 }
	t´s_úq_e
;

51 
	#ªg_´s_key
(
v
Ë
	`REG_ADDR32
(0x1600b4+(v*4))

	)

53 
	#ªg_´s_±r
 
	`REG_ADDR32
(0x1600c4)

	)

	@platform/chip_b91/reg_include/analog_reg.h

24 #i‚de‡
ANALOG_REG_H


25 
	#ANALOG_REG_H


	)

26 
	~"../sys.h
"

28 
	#ALG_BASE_ADDR
 0x140180

	)

29 
	#ªg_™a_addr
 
	`REG_ADDR8
(
ALG_BASE_ADDR
)

	)

30 
	#ªg_™a_˘æ
 
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x02)

	)

34 
	mFLD_ANA_RX_EN
 = 
BIT
(1),

35 
	mFLD_ANA_MASKX_TX_DONE
 = 
BIT
(2),

36 
	mFLD_ANA_MASKX_RX_DONE
 = 
BIT
(3),

37 
	mFLD_ANA_CONTIU_ACC
 = 
BIT
(4),

38 
	mFLD_ANA_RW
 = 
BIT
(5),

39 
	mFLD_ANA_CYC
 = 
BIT
(6),

40 
	mFLD_ANA_BUSY
 = 
BIT
(7),

42 
	#ªg_™a_Àn
 
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x03)

	)

43 
	#ªg_™a_d©a
(
n
Ë
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x04+“))

	)

44 
	#ªg_™a_addr_d©a16
 
	`REG_ADDR16
(
ALG_BASE_ADDR
+0x04)

	)

45 
	#ªg_™a_addr_d©a32
 
	`REG_ADDR32
(
ALG_BASE_ADDR
+0x04)

	)

47 
	#ªg_™a_°a
 
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x09)

	)

50 
	mFLD_ANA_RX_DONE
 = 
BIT
(7),

52 
	#ªg_™a_úq_°a
 
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x0a)

	)

55 
	mFLD_ANA_TXBUFF_IRQ
 = 
BIT
(0),

56 
	mFLD_ANA_RXBUFF_IRQ
 = 
BIT
(1),

58 
	#ªg_™a_dma_˘l
 
	`REG_ADDR8
(
ALG_BASE_ADDR
+0x0b)

	)

61 
	mFLD_ANA_CYC1
 = 
BIT
(0),

62 
	mFLD_ANA_DMA_EN
 = 
BIT
(1),

	@platform/chip_b91/reg_include/audio_reg.h

24 #i‚de‡
AUDIO_REG_H


25 
	#AUDIO_REG_H


	)

26 
	~"../sys.h
"

28 
	#REG_AUDIO_AHB_BASE
 0x120000

	)

29 
	#REG_CODEC_BASE_ADDR
 0x120200

	)

30 
	#REG_AUDIO_APB_BASE
 0x140500

	)

31 
	#ªg_fifo_buf_adr
(
i
Ë
REG_AUDIO_AHB_BASE
+(i)*0x40

	)

32 
	#ªg_audio_í
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x00)

	)

35 
	mFLD_AUDIO_I2S_CLK_EN
 = 
BIT
(0),

36 
	mFLD_AUDIO_CLK_DIV2
 = 
BIT
(1),

37 
	mFLD_AUDIO_MC_CLK_EN
 = 
BIT
(2),

38 
	mFLD_AUDIO_MC_CLK_INV_O
 = 
BIT
(3),

41 
	#ªg_i2s_cfg
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x01)

	)

44 
	mFLD_AUDIO_I2S_FORMAT
 = 
BIT_RNG
(0,1),

45 
	mFLD_AUDIO_I2S_WL
 = 
BIT_RNG
(2,3),

46 
	mFLD_AUDIO_I2S_LRP
 = 
BIT
(4),

47 
	mFLD_AUDIO_I2S_LRSWAP
 = 
BIT
(5),

48 
	mFLD_AUDIO_I2S_ADC_DCI_MS
 = 
BIT
(6),

49 
	mFLD_AUDIO_I2S_DAC_DCI_MS
 = 
BIT
(7),

52 
	#ªg_i2s_cfg2
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x02)

	)

56 
	mFLD_AUDIO_FIFO1_RST
 = 
BIT
(3),

58 
	#ªg_audio_˘æ
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x03)

	)

61 
	mFLD_AUDIO_I2S_CMODE
 = 
BIT_RNG
(0,1),

62 
	mFLD_AUDIO_CODEC_I2S_SEL
 = 
BIT
(2),

63 
	mFLD_AUDIO_I2S_OUT_BIT_SEL
 = 
BIT
(3),

66 
	#ªg_audio_tu√
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x04)

	)

69 
	mFLD_AUDIO_I2S_I2S_AIN0_COME
 = 
BIT_RNG
(0,1),

70 
	mFLD_AUDIO_I2S_I2S_AIN1_COME
 = 
BIT_RNG
(2,3),

71 
	mFLD_AUDIO_I2S_I2S_AOUT_COME
 = 
BIT_RNG
(4,6),

75 
	#ªg_audio_£l
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x05)

	)

78 
	mFLD_AUDIO_AIN0_SEL
 = 
BIT_RNG
(0,1),

79 
	mFLD_AUDIO_AOUT0_SEL
 = 
BIT_RNG
(2,3),

80 
	mFLD_AUDIO_AIN1_SEL
 = 
BIT_RNG
(4,5),

81 
	mFLD_AUDIO_AOUT1_SEL
 = 
BIT_RNG
(6,7),

84 
	#ªg_audio_i2c_addr
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x08)

	)

85 
	#ªg_audio_i2c_mode
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x09)

	)

87 
	#ªg_fifo_åig0
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x0a)

	)

89 
	#ªg_audio_±r_£t
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x10)

	)

92 
	mFLD_AUDIO_TX_PTR_SEL
 = 
BIT
(0),

93 
	mFLD_AUDIO_RX_PTR_SEL
 = 
BIT
(4),

96 
	#ªg_audio_±r_í
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x11)

	)

99 
	mFLD_AUDIO_TX_WPTR_PTR_EN
 = 
BIT
(0),

100 
	mFLD_AUDIO_TX_RPTR_PTR_EN
 = 
BIT
(1),

101 
	mFLD_AUDIO_RX_WPTR_PTR_EN
 = 
BIT
(2),

102 
	mFLD_AUDIO_RX_RPTR_PTR_EN
 = 
BIT
(3),

108 
	mFLD_AUDIO_FIFO_AOUT0_TRIG_NUM
 = 
BIT_RNG
(0,3),

109 
	mFLD_AUDIO_FIFO_AIN0_TRIG_NUM
 = 
BIT_RNG
(4,7),

112 
	#fifo_åig1
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x0b)

	)

116 
	mFLD_AUDIO_FIFO_AOUT1_TRIG_NUM
 = 
BIT_RNG
(0,3),

117 
	mFLD_AUDIO_FIFO_AIN1_TRIG_NUM
 = 
BIT_RNG
(4,7),

120 
	#ªg_tx_w±r
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x20)

	)

121 
	#ªg_tx_Ωå
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x22)

	)

123 
	#ªg_tx_max
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x26)

	)

125 
	#ªg_rx_Ωå
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x2a)

	)

126 
	#ªg_rx_w±r
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x28)

	)

128 
	#ªg_rx_max
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x2e)

	)

130 
	#ªg_th0_h1
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x30)

131 
	#ªg_th0_l1
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x32)

132 

	)

133 
	#ªg_th0_h2
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x38)

134 
	#ªg_th0_l2
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x3a)

135 

	)

137 
	#ªg_th1_h1
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x40)

138 
	#ªg_th1_l1
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x42)

139 

	)

140 
	#ªg_th1_h2
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x48)

141 
	#ªg_th1_l2
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x4a)

142 

	)

145 
	#ªg_úq_fifo_°©e
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x5c)

	)

148 
	mFLD_AUDIO_IRQ_TXFIFO_L_L1
 = 
BIT
(0),

149 
	mFLD_AUDIO_IRQ_TXFIFO_H_L1
 = 
BIT
(1),

150 
	mFLD_AUDIO_IRQ_TXFIFO_L_L2
 = 
BIT
(2),

151 
	mFLD_AUDIO_IRQ_TXFIFO_H_L2
 = 
BIT
(3),

153 
	mFLD_AUDIO_IRQ_RXFIFO_L_L1
 = 
BIT
(4),

154 
	mFLD_AUDIO_IRQ_RXFIFO_H_L1
 = 
BIT
(5),

155 
	mFLD_AUDIO_IRQ_RXFIFO_L_L2
 = 
BIT
(6),

156 
	mFLD_AUDIO_IRQ_RXFIFO_H_L2
 = 
BIT
(7),

158 }
	taudio_fifo_úq_°©us_ty≥_e
;

160 
	#ªg_úq_fifo_mask
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x5d)

	)

164 
	mFLD_AUDIO_IRQ_TXFIFO_L_L1_EN
 = 
BIT
(0),

165 
	mFLD_AUDIO_IRQ_TXFIFO_H_L1_EN
 = 
BIT
(1),

166 
	mFLD_AUDIO_IRQ_TXFIFO_L_L2_EN
 = 
BIT
(2),

167 
	mFLD_AUDIO_IRQ_TXFIFO_H_L2_EN
 = 
BIT
(3),

169 
	mFLD_AUDIO_IRQ_RXFIFO_L_L1_EN
 = 
BIT
(4),

170 
	mFLD_AUDIO_IRQ_RXFIFO_H_L1_EN
 = 
BIT
(5),

171 
	mFLD_AUDIO_IRQ_RXFIFO_L_L2_EN
 = 
BIT
(6),

172 
	mFLD_AUDIO_IRQ_RXFIFO_H_L2_EN
 = 
BIT
(7),

174 }
	taudio_fifo_úq_mask_ty≥_e
;

178 
	#ªg_úq_m™uÆ_í
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x5e)

	)

181 
	mFLD_AUDIO_IRQ_TXFIFO_L_L1_MAN_EN
 = 
BIT
(0),

182 
	mFLD_AUDIO_IRQ_TXFIFO_H_L1_MAN_EN
 = 
BIT
(1),

183 
	mFLD_AUDIO_IRQ_TXFIFO_L_L2_MAN_EN
 = 
BIT
(2),

184 
	mFLD_AUDIO_IRQ_TXFIFO_H_L2_MAN_EN
 = 
BIT
(3),

186 
	mFLD_AUDIO_IRQ_RXFIFO_L_L1_MAN_EN
 = 
BIT
(4),

187 
	mFLD_AUDIO_IRQ_RXFIFO_H_L1_MAN_EN
 = 
BIT
(5),

188 
	mFLD_AUDIO_IRQ_RXFIFO_L_L2_MAN_EN
 = 
BIT
(6),

189 
	mFLD_AUDIO_IRQ_RXFIFO_H_L2_MAN_EN
 = 
BIT
(7)

193 
	#ªg_öt_pcm_num
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x50)

	)

194 
	#ªg_dec_pcm_num
 
	`REG_ADDR16
(
REG_AUDIO_APB_BASE
+0x52)

	)

196 
	#ªg_pcm_˛k_num
 
	`REG_ADDR8
(
REG_AUDIO_APB_BASE
+0x54)

	)

200 
	#ªg_audio_codec_°©_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x00<<2))

	)

201 
	#addr_audio_codec_°©_˘r
 0x00

	)

204 
	mFLD_AUDIO_CODEC_ADC12_LOCKED
 = 
BIT
(3),

205 
	mFLD_AUDIO_CODEC_DAC_LOCKED
 = 
BIT
(4),

206 
	mFLD_AUDIO_CODEC_PON_ACK
 = 
BIT
(7),

210 
	#ªg_audio_codec_vic_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x06<<2))

	)

211 
	#addr_audio_codec_vic_˘r
 0x06

	)

214 
	mFLD_AUDIO_CODEC_SB
 = 
BIT
(0),

215 
	mFLD_AUDIO_CODEC_SB_ANALOG
 = 
BIT
(1),

216 
	mFLD_AUDIO_CODEC_SLEEP_ANALOG
 = 
BIT
(2),

221 
	#ªg_audio_codec_dac_ôf_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x08<<2))

	)

222 
	#addr_audio_codec_dac_ôf_˘r
 0x08

	)

224 
	#ªg_audio_codec_adc_ôf_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x09<<2))

	)

225 
	#addr_audio_codec_adc_ôf_˘r
 0x09

	)

228 
	mFLD_AUDIO_CODEC_FORMAT
 = 
BIT_RNG
(0,1),

229 
	mFLD_AUDIO_CODEC_DAC_ITF_SB
 = 
BIT
(4),

230 
	mFLD_AUDIO_CODEC_SLAVE
 = 
BIT
(5),

231 
	mFLD_AUDIO_CODEC_WL
 = 
BIT_RNG
(6,7),

234 
	#ªg_audio_codec_adc2_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x0a<<2))

	)

235 
	#addr_audio_codec_adc2_˘r
 0x0a

	)

238 
	mFLD_AUDIO_CODEC_ADC12_SB
 = 
BIT
(0),

241 
	#ªg_audio_codec_dac_‰eq_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x0b<<2))

	)

242 
	#addr_audio_codec_dac_‰eq_˘r
 0x0b

	)

245 
	mFLD_AUDIO_CODEC_DAC_FREQ
 = 
BIT_RNG
(0,3),

248 
	#ªg_audio_codec_adc_wnf_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x0e<<2))

	)

249 
	#addr_audio_codec_adc_wnf_˘r
 0x0e

	)

252 
	mFLD_AUDIO_CODEC_ADC12_WNF
 = 
BIT_RNG
(0,1),

257 
	#ªg_audio_codec_adc_‰eq_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x0f<<2))

	)

258 
	#addr_audio_codec_adc_‰eq_˘r
 0x0f

	)

261 
	mFLD_AUDIO_CODEC_ADC_FREQ
 = 
BIT_RNG
(0,3),

262 
	mFLD_AUDIO_CODEC_ADC12_HPF_EN
 = 
BIT
(4),

267 
	#ªg_audio_dmic_12
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x10<<2))

	)

268 
	#addr_audio_dmic_12
 0x10

	)

271 
	mFLD_AUDIO_CODEC_ADC_DMIC_SEL2
 = 
BIT_RNG
(0,1),

272 
	mFLD_AUDIO_CODEC_ADC_DMIC_SEL1
 = 
BIT_RNG
(2,3),

273 
	mFLD_AUDIO_CODEC_DMIC2_SB
 = 
BIT
(6),

274 
	mFLD_AUDIO_CODEC_DMIC1_SB
 = 
BIT
(7),

278 
	#ªg_audio_codec_h∂_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x15<<2))

	)

279 
	#addr_audio_codec_h∂_gaö
 0x15

	)

283 
	mFLD_AUDIO_CODEC_HPL_GOL
 = 
BIT_RNG
(0,4),

284 
	mFLD_AUDIO_CODEC_HPL_LRGO
 = 
BIT
(7),

287 
	#ªg_audio_codec_h¥_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x16<<2))

	)

288 
	#addr_audio_codec_h¥_gaö
 0x16

	)

291 
	mFLD_AUDIO_CODEC_HPR_GOR
 = 
BIT_RNG
(0,4),

295 
	#ªg_audio_codec_mic1_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x17<<2))

	)

296 
	#addr_audio_codec_mic1_˘r
 0x17

	)

300 
	mFLD_AUDIO_CODEC_MIC1_SEL
 = 
BIT
(0),

301 
	mFLD_AUDIO_CODEC_MICBIAS1_SB
 = 
BIT
(5),

302 
	mFLD_AUDIO_CODEC_MIC_DIFF1
 = 
BIT
(6),

303 
	mFLD_AUDIO_CODEC_MICBIAS1_V
 = 
BIT
(7),

306 
	#ªg_audio_codec_mic2_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x18<<2))

	)

307 
	#addr_audio_codec_mic2_˘r
 0x18

	)

310 
	mFLD_AUDIO_CODEC_MIC2_SEL
 = 
BIT
(0),

311 
	mFLD_AUDIO_CODEC_MIC_DIFF2
 = 
BIT
(6),

316 
	#ªg_audio_codec_da˛_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x2a<<2))

	)

317 
	#addr_audio_codec_da˛_gaö
 0x2a

	)

320 
	mFLD_AUDIO_CODEC_DAC_GODL
 = 
BIT_RNG
(0,5),

321 
	mFLD_AUDIO_CODEC_DAC_LRGOD
 = 
BIT
(7),

324 
	#ªg_audio_codec_da¸_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x2b<<2))

	)

325 
	#addr_audio_codec_da¸_gaö
 0x2b

	)

328 
	mFLD_AUDIO_CODEC_DAC_GODR
 = 
BIT_RNG
(0,5),

331 
	#ªg_audio_codec_mic_l_R_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x1f<<2))

	)

332 
	#addr_audio_codec_mic_l_R_gaö
 0x1f

	)

335 
	mFLD_AUDIO_CODEC_AMIC_L_GAIN
 = 
BIT_RNG
(0,2),

336 
	mFLD_AUDIO_CODEC_AMIC_R_GAIN
 = 
BIT_RNG
(3,5),

340 
	#ªg_audio_codec_dac_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x23<<2))

	)

341 
	#addr_audio_codec_dac_˘r
 0x23

	)

344 
	mFLD_AUDIO_CODEC_DAC_SB
 = 
BIT
(4),

345 
	mFLD_AUDIO_CODEC_DAC_LEFT_ONLY
 = 
BIT
(5),

346 
	mFLD_AUDIO_CODEC_DAC_SOFT_MUTE
 = 
BIT
(7),

351 
	#ªg_audio_codec_adc12_˘r
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x24<<2))

	)

352 
	#addr_audio_codec_adc12_˘r
 0x24

	)

355 
	mFLD_AUDIO_CODEC_ADC1_SB
 = 
BIT
(4),

356 
	mFLD_AUDIO_CODEC_ADC2_SB
 = 
BIT
(5),

357 
	mFLD_AUDIO_CODEC_ADC12_SOFT_MUTE
 = 
BIT
(7),

361 
	#ªg_audio_adc1_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x2c<<2))

	)

362 
	#addr_audio_adc1_gaö
 0x2c

	)

365 
	mFLD_AUDIO_CODEC_ADC_GID1
 = 
BIT_RNG
(0,5),

366 
	mFLD_AUDIO_CODEC_ADC_LRGID
 = 
BIT
(7),

369 
	#ªg_audio_adc2_gaö
 
	`REG_ADDR8
(
REG_CODEC_BASE_ADDR
+(0x2d<<2))

	)

372 
	mFLD_AUDIO_CODEC_ADC_GID2
 = 
BIT_RNG
(0,5),

	@platform/chip_b91/reg_include/dma_reg.h

24 #i‚de‡
DMA_REG_H


25 
	#DMA_REG_H


	)

26 
	~"../sys.h
"

28 
	#ªg_dma_id
 
	`REG_ADDR32
(0x100400)

	)

29 
	#ªg_dma_cfg
 
	`REG_ADDR32
(0x100410)

	)

38 
	#FLD_DMA_CHANNEL_NUM
 = 
	`BIT_RNG
(0,3),

	)

39 
	#FLD_DMA_FIFO_DEPTH
 = 
	`BIT_RNG
(4,9),

	)

40 
	#FLD_DMA_REQ_NUM
 = 
	`BIT_RNG
(10,14),

	)

41 
	#FLD_DMA_REQ_SYNC
 = 
	`BIT
(30),

	)

42 
	#FLD_DMA_CHANINXFR
 = 
	`BIT
(31),

	)

44 
	#ªg_dma_˘æ
(
i
Ë
	`REG_ADDR32
(–0x00100444 +(i)*0x14))

	)

47 
	mFLD_DMA_CHANNEL_ENABLE
 = 
BIT
(0),

48 
	mFLD_DMA_CHANNEL_TC_MASK
 = 
BIT
(1),

49 
	mFLD_DMA_CHANNEL_ERR_MASK
 = 
BIT
(2),

50 
	mFLD_DMA_CHANNEL_ABT_MASK
 = 
BIT
(3),

51 
	mFLD_DMA_CHANNEL_DST_REQ_SEL
 = 
BIT_RNG
(4,8),

52 
	mFLD_DMA_CHANNEL_SRC_REQ_SEL
 = 
BIT_RNG
(9,13),

53 
	mFLD_DMA_CHANNEL_DST_ADDR_CTRL
 = 
BIT_RNG
(14,15),

54 
	mFLD_DMA_CHANNEL_SRC_ADDR_CTRL
 = 
BIT_RNG
(16,17),

55 
	mFLD_DMA_CHANNEL_DST_MODE
 = 
BIT
(18),

56 
	mFLD_DMA_CHANNEL_SRC_MODE
 = 
BIT
(19),

57 
	mFLD_DMA_CHANNEL_DST_WIDTH
 = 
BIT_RNG
(20,21),

58 
	mFLD_DMA_CHANNEL_SRC_WIDTH
 = 
BIT_RNG
(22,23),

61 
	#ªg_dma_˘r0
(
i
Ë
	`REG_ADDR8
(–0x00100444 +(i)*0x14))

	)

64 
	#ªg_dma_îr_i§
 
	`REG_ADDR8
(0x100430)

	)

65 
	#ªg_dma_abt_i§
 
	`REG_ADDR8
(0x100431)

	)

66 
	#ªg_dma_tc_i§
 
	`REG_ADDR8
(0x100432)

	)

69 
	mFLD_DMA_CHANNEL0_IRQ
 = 
BIT
(0),

70 
	mFLD_DMA_CHANNEL1_IRQ
 = 
BIT
(1),

71 
	mFLD_DMA_CHANNEL2_IRQ
 = 
BIT
(2),

72 
	mFLD_DMA_CHANNEL3_IRQ
 = 
BIT
(3),

73 
	mFLD_DMA_CHANNEL4_IRQ
 = 
BIT
(4),

74 
	mFLD_DMA_CHANNEL5_IRQ
 = 
BIT
(5),

75 
	mFLD_DMA_CHANNEL6_IRQ
 = 
BIT
(6),

76 
	mFLD_DMA_CHANNEL7_IRQ
 = 
BIT
(7),

83 
	#ªg_dma_˘r3
(
i
Ë
	`REG_ADDR8
((0x00100447 +(i)*0x14))

	)

86 
	mFLD_DMA_SRC_BURST_SIZE
 = 
BIT_RNG
(0,2),

87 
	mFLD_DMA_R_NUM_EN
 = 
BIT
(4),

88 
	mFLD_DMA_PRIORITY
 = 
BIT
(5),

89 
	mFLD_DMA_W_NUM_EN
 = 
BIT
(6),

90 
	mFLD_DMA_AUTO_ENABLE_EN
 = 
BIT
(7),

95 
	#ªg_dma_§c_addr
(
i
Ë
	`REG_ADDR32
 (–0x00100448 +(i)*0x14))

	)

96 
	#ªg_dma_d°_addr
(
i
Ë
	`REG_ADDR32
 (–0x0010044¯+(i)*0x14))

	)

97 
	#ªg_dma_size
(
i
Ë
	`REG_ADDR32
 (–0x00100450 +(i)*0x14))

	)

100 
	mFLD_DMA_TX_SIZE
 = 
BIT_RNG
(0,21),

101 
	mFLD_DMA_TX_SIZE_IDX
 = 
BIT_RNG
(22,23),

107 
	#ªg_dma_¸3_size
(
i
Ë(*(vﬁ©ûê*Ë–0x00100452 +(i)*0x14))

	)

110 
	mFLD_DMA_TSR2_SIZE_IDX
 = 
BIT_RNG
(6,7),

113 
	#ªg_dma_Œp
(
i
Ë
	`REG_ADDR32
 (–0x00100454 +(i)*0x14))

	)

116 
	#ªg_dma_rx_w±r
 
	`REG_ADDR8
(0x801004f4)

	)

117 
	#ªg_dma_tx_w±r
 
	`REG_ADDR8
(0x80100500)

	)

120 
	mFLD_DMA_WPTR_MASK
 = 
BIT_RNG
(0,4),

124 
	#ªg_dma_rx_Ωå
 
	`REG_ADDR8
(0x801004f5)

	)

125 
	#ªg_dma_tx_Ωå
 
	`REG_ADDR8
(0x80100501)

	)

127 
	mFLD_DMA_RPTR_MASK
 = 
BIT_RNG
(0,4),

128 
	mFLD_DMA_RPTR_SET
 = 
BIT
(5),

129 
	mFLD_DMA_RPTR_NEXT
 = 
BIT
(6),

130 
	mFLD_DMA_RPTR_CLR
 = 
BIT
(7),

	@platform/chip_b91/reg_include/gpio_reg.h

24 #i‚de‡
GPIO_REG_H_


25 
	#GPIO_REG_H_


	)

26 
	~"../sys.h
"

29 
	#ªg_gpio_∑_£âög1
 
	`REG_ADDR32
(0x140300)

	)

30 
	#ªg_gpio_∑_ö
 
	`REG_ADDR8
(0x140300)

	)

31 
	#ªg_gpio_∑_õ
 
	`REG_ADDR8
(0x140301)

	)

32 
	#ªg_gpio_∑_€n
 
	`REG_ADDR8
(0x140302)

	)

33 
	#ªg_gpio_∑_out
 
	`REG_ADDR8
(0x140303)

	)

35 
	#ªg_gpio_∑_£âög2
 
	`REG_ADDR32
(0x140304)

	)

36 
	#ªg_gpio_∑_pﬁ
 
	`REG_ADDR8
(0x140304)

	)

37 
	#ªg_gpio_∑_ds
 
	`REG_ADDR8
(0x140305)

	)

38 
	#ªg_gpio_∑_gpio
 
	`REG_ADDR8
(0x140306)

	)

39 
	#ªg_gpio_∑_úq_í
 
	`REG_ADDR8
(0x140307)

	)

41 
	#ªg_gpio_∑_fs
 
	`REG_ADDR16
(0x140330)

	)

42 
	#ªg_gpio_∑_fuc_l
 
	`REG_ADDR8
(0x140330)

	)

43 
	#ªg_gpio_∑_fuc_h
 
	`REG_ADDR8
(0x140331)

	)

46 
	#ªg_gpio_pb_£âög1
 
	`REG_ADDR32
(0x140308)

	)

47 
	#ªg_gpio_pb_ö
 
	`REG_ADDR8
(0x140308)

	)

48 
	#ªg_gpio_pb_õ
 
	`REG_ADDR8
(0x140309)

	)

49 
	#ªg_gpio_pb_€n
 
	`REG_ADDR8
(0x14030a)

	)

50 
	#ªg_gpio_pb_out
 
	`REG_ADDR8
(0x14030b)

	)

52 
	#ªg_gpio_pb_£âög2
 
	`REG_ADDR32
(0x14030c)

	)

53 
	#ªg_gpio_pb_pﬁ
 
	`REG_ADDR8
(0x14030c)

	)

54 
	#ªg_gpio_pb_ds
 
	`REG_ADDR8
(0x14030d)

	)

55 
	#ªg_gpio_pb_gpio
 
	`REG_ADDR8
(0x14030e)

	)

56 
	#ªg_gpio_pb_úq_í
 
	`REG_ADDR8
(0x14030f)

	)

58 
	#ªg_gpio_pb_fs
 
	`REG_ADDR16
(0x140332)

	)

59 
	#ªg_gpio_pb_fuc_l
 
	`REG_ADDR8
(0x140332)

	)

60 
	#ªg_gpio_pb_fuc_h
 
	`REG_ADDR8
(0x140333)

	)

63 
	#ªg_gpio_pc_£âög1
 
	`REG_ADDR32
(0x140310)

	)

64 
	#ªg_gpio_pc_ö
 
	`REG_ADDR8
(0x140310)

	)

65 
	#¨eg_gpio_pc_õ
 0xbd

	)

66 
	#¨eg_gpio_pc_≥
 0xbe

	)

67 
	#ªg_gpio_pc_€n
 
	`REG_ADDR8
(0x140312)

	)

68 
	#ªg_gpio_pc_out
 
	`REG_ADDR8
(0x140313)

	)

70 
	#ªg_gpio_pc_£âög2
 
	`REG_ADDR32
(0x140314)

	)

71 
	#ªg_gpio_pc_pﬁ
 
	`REG_ADDR8
(0x140314)

	)

72 
	#¨eg_gpio_pc_ds
 0xbf

	)

73 
	#ªg_gpio_pc_gpio
 
	`REG_ADDR8
(0x140316)

	)

74 
	#ªg_gpio_pc_úq_í
 
	`REG_ADDR8
(0x140317)

	)

76 
	#ªg_gpio_pc_fs
 
	`REG_ADDR16
(0x140334)

	)

77 
	#ªg_gpio_pc_fuc_l
 
	`REG_ADDR8
(0x140334)

	)

78 
	#ªg_gpio_pc_fuc_h
 
	`REG_ADDR8
(0x140335)

	)

81 
	#ªg_gpio_pd_£âög1
 
	`REG_ADDR32
(0x140318)

	)

82 
	#ªg_gpio_pd_ö
 
	`REG_ADDR8
(0x140318)

	)

83 
	#¨eg_gpio_pd_õ
 0xc0

	)

84 
	#¨eg_gpio_pd_≥
 0xc1

	)

85 
	#ªg_gpio_pd_€n
 
	`REG_ADDR8
(0x14031a)

	)

86 
	#ªg_gpio_pd_out
 
	`REG_ADDR8
(0x14031b)

	)

88 
	#ªg_gpio_pd_£âög2
 
	`REG_ADDR32
(0x14031c)

	)

89 
	#ªg_gpio_pd_pﬁ
 
	`REG_ADDR8
(0x14031c)

	)

90 
	#¨eg_gpio_pd_ds
 0xc2

	)

91 
	#ªg_gpio_pd_gpio
 
	`REG_ADDR8
(0x14031e)

	)

92 
	#ªg_gpio_pd_úq_í
 
	`REG_ADDR8
(0x14031f)

	)

94 
	#ªg_gpio_pd_fs
 
	`REG_ADDR16
(0x140336)

	)

95 
	#ªg_gpio_pd_fuc_l
 
	`REG_ADDR8
(0x140336)

96 
	#ªg_gpio_pd_fuc_h
 
	`REG_ADDR8
(0x140337)

	)

99 
	#ªg_gpio_≥_£âög1
 
	`REG_ADDR32
(0x140320)

	)

100 
	#ªg_gpio_≥_ö
 
	`REG_ADDR8
(0x140320)

	)

101 
	#ªg_gpio_≥_õ
 
	`REG_ADDR8
(0x140321)

	)

102 
	#ªg_gpio_≥_€n
 
	`REG_ADDR8
(0x140322)

	)

103 
	#ªg_gpio_≥_out
 
	`REG_ADDR8
(0x140323)

	)

105 
	#ªg_gpio_≥_£âög2
 
	`REG_ADDR32
(0x140324)

	)

106 
	#ªg_gpio_≥_pﬁ
 
	`REG_ADDR8
(0x140324)

	)

107 
	#ªg_gpio_≥_ds
 
	`REG_ADDR8
(0x140325)

	)

108 
	#ªg_gpio_≥_gpio
 
	`REG_ADDR8
(0x140326)

	)

109 
	#ªg_gpio_≥_úq_í
 
	`REG_ADDR8
(0x140327)

	)

111 
	#ªg_gpio_≥_fs
 
	`REG_ADDR16
(0x140350)

	)

112 
	#ªg_gpio_≥_fuc_l
 
	`REG_ADDR8
(0x140350)

	)

113 
	#ªg_gpio_≥_fuc_h
 
	`REG_ADDR8
(0x140351)

	)

116 
	#ªg_gpio_pf_£âög1
 
	`REG_ADDR32
(0x140328)

	)

117 
	#ªg_gpio_pf_ö
 
	`REG_ADDR8
(0x140328)

	)

118 
	#ªg_gpio_pf_õ
 
	`REG_ADDR8
(0x140329)

	)

119 
	#ªg_gpio_pf_€n
 
	`REG_ADDR8
(0x14032a)

	)

120 
	#ªg_gpio_pf_out
 
	`REG_ADDR8
(0x14032b)

	)

122 
	#ªg_gpio_pf_£âög2
 
	`REG_ADDR32
(0x14032c)

	)

123 
	#ªg_gpio_pf_ds
 
	`REG_ADDR8
(0x14032d)

	)

124 
	#ªg_gpio_pf_gpio
 
	`REG_ADDR8
(0x14032e)

	)

126 
	#ªg_gpio_pf_fs
 
	`REG_ADDR16
(0x140356)

	)

127 
	#ªg_gpio_pf_fuc_l
 
	`REG_ADDR8
(0x140356)

	)

128 
	#ªg_gpio_pf_fuc_h
 
	`REG_ADDR8
(0x140357)

	)

130 
	#ªg_gpio_ö
(
i
Ë
	`REG_ADDR8
(0x140300+((i>>8)<<3))

	)

131 
	#ªg_gpio_õ
(
i
Ë
	`REG_ADDR8
(0x140301+((i>>8)<<3))

	)

132 
	#ªg_gpio_€n
(
i
Ë
	`REG_ADDR8
(0x140302+((i>>8)<<3))

	)

133 
	#ªg_gpio_out
(
i
Ë
	`REG_ADDR8
(0x140303+((i>>8)<<3))

	)

134 
	#ªg_gpio_pﬁ
(
i
Ë
	`REG_ADDR8
(0x140304+((i>>8)<<3))

	)

135 
	#ªg_gpio_ds
(
i
Ë
	`REG_ADDR8
(0x140305+((i>>8)<<3))

	)

138 
	#ªg_gpio_func
(
i
Ë
	`REG_ADDR8
(0x140306+((i>>8)<<3))

	)

139 
	#ªg_gpio_úq_í
(
i
Ë
	`REG_ADDR8
(0x140307+((i>>8)<<3))

140 
	#ªg_gpio_úq_risc0_í
(
i
Ë
	`REG_ADDR8
(0x140338 + (i >> 8))

141 
	#ªg_gpio_úq_risc1_í
(
i
Ë
	`REG_ADDR8
(0x140340 + (i >> 8))

142 

	)

143 
	#ªg_gpio_func_mux
(
i
Ë
	`REG_ADDR8
(0x140330 + (((i>>8)>3Ë? 0x20 : ((i>>8)<<1ËË+ ((i&0x0f0Ë? 1 : 0 ))

	)

146 
	#ªg_gpio_úq_risc_mask
 
	`REG_ADDR8
(0x140352)

	)

148 
	mFLD_GPIO_IRQ_MASK_GPIO
 = 
BIT
(0),

149 
	mFLD_GPIO_IRQ_MASK_GPIO2RISC0
 = 
BIT
(1),

150 
	mFLD_GPIO_IRQ_MASK_GPIO2RISC1
 = 
BIT
(2),

152 
	mFLD_GPIO_IRQ_LVL_GPIO
 = 
BIT
(4),

153 
	mFLD_GPIO_IRQ_LVL_GPIO2RISC0
 = 
BIT
(5),

154 
	mFLD_GPIO_IRQ_LVL_GPIO2RISC1
 = 
BIT
(6),

157 
	#ªg_gpio_úq_˘æ
 
	`REG_ADDR8
(0x140353)

	)

159 
	mFLD_GPIO_CORE_WAKEUP_EN
 = 
BIT
(2),

160 
	mFLD_GPIO_CORE_INTERRUPT_EN
 = 
BIT
(3),

162 
	#ªg_gpio_∑d_mul_£l
 
	`REG_ADDR8
(0x140355)

	)

164 
	#ªg_gpio_úq_˛r
 
	`REG_ADDR8
(0x140358)

	)

166 
	mFLD_GPIO_IRQ_CLR
 = 
BIT
(0),

167 
	mFLD_GPIO_IRQ_GPIO2RISC0_CLR
 = 
BIT
(1),

168 
	mFLD_GPIO_IRQ_GPIO2RISC1_CLR
 = 
BIT
(2),

169 }
	tgpio_úq_°©us_e
;

	@platform/chip_b91/reg_include/i2c_reg.h

24 #i‚de‡
I2C_REG_H_


25 
	#I2C_REG_H_


	)

26 
	~"../sys.h
"

30 
	#REG_I2C_BASE
 0x140280

	)

33 
	#ªg_i2c_d©a_buf0_addr
 0x80140288

	)

42 
	#ªg_i2c_•
 
	`REG_ADDR8
(
REG_I2C_BASE
)

	)

50 
	#ªg_i2c_id
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x01)

	)

52 
	mFLD_I2C_WRITE_READ_BIT
 = 
BIT
(0),

53 
	mFLD_I2C_ID
 = 
BIT_RNG
(1,7),

65 
	#ªg_i2c_m°
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x02)

	)

67 
	mFLD_I2C_MST_BUSY
 = 
BIT
(0),

68 
	mFLD_I2C_SCS_N
 = 
BIT
(1),

69 
	mFLD_I2C_ACK_IN
 = 
BIT
(2),

70 
	mFLD_I2C_MST_P
 = 
BIT_RNG
(3,5),

71 
	mFLD_I2C_SS
 = 
BIT_RNG
(6,7),

89 
	#ªg_i2c_s˘0
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x03)

	)

91 
	mFLD_I2C_MASTER
 = 
BIT
(0),

92 
	mFLD_I2C_R_CLK_STRETCH_EN
 = 
BIT
(1),

93 
	mFLD_I2C_RX_BUF_MASK
 = 
BIT
(2),

94 
	mFLD_I2C_TX_BUF_MASK
 = 
BIT
(3),

95 
	mFLD_I2C_TX_DONE_MASK
 = 
BIT
(4),

96 
	mFLD_I2C_RX_DONE_MASK
 = 
BIT
(5),

97 
	mFLD_I2C_RNCK_EN
 = 
BIT
(6),

98 
	mFLD_I2C_MANUAL_SDA_DELAY
 = 
BIT
(7),

99 }
	ti2c_mask_úq_ty≥_e
;

116 
	#ªg_i2c_s˘1
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x04)

	)

118 
	mFLD_I2C_LS_ID
 = 
BIT
(0),

119 
	mFLD_I2C_LS_ADDR
 = 
BIT
(1),

120 
	mFLD_I2C_LS_DATAW
 = 
BIT
(2),

121 
	mFLD_I2C_LS_DATAR
 = 
BIT
(3),

122 
	mFLD_I2C_LS_START
 = 
BIT
(4),

123 
	mFLD_I2C_LS_STOP
 = 
BIT
(5),

124 
	mFLD_I2C_LS_ID_R
 = 
BIT
(6),

125 
	mFLD_I2C_LS_ACK
 = 
BIT
(7),

134 
	#ªg_i2c_åig
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x05)

	)

136 
	mFLD_I2C_RX_IRQ_TRIG_LEV
 = 
BIT_RNG
(0,3),

137 
	mFLD_I2C_TX_IRQ_TRIG_LEV
 = 
BIT_RNG
(4,7),

142 
	#ªg_i2c_Àn
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x06)

	)

153 
	#ªg_i2c_¶ave_°ªch_í
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x07)

	)

155 
	mFLD_I2C_R_CLK_STRETCH_SEN
 = 
BIT
(0),

156 
	mFLD_I2C_R_MANUAL_STRETCH
 = 
BIT
(1),

157 
	mFLD_I2C_MANUAL_STRETCH_CLR
 = 
BIT
(2),

158 
	mFLD_I2C_R_HS_MODE
 = 
BIT
(6),

159 
	mFLD_I2C_R_FAST_MODE
 = 
BIT
(7),

162 
	#ªg_i2c_d©a_buf
(
i
Ë
	`REG_ADDR8
(–
REG_I2C_BASE
+0x08 +(iË))

	)

167 
	#ªg_i2c_d©a_buf0
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x08)

	)

169 
	mFLD_I2C_BUF0
 = 
BIT_RNG
(0,7),

177 
	#ªg_i2c_d©a_buf1
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x09)

	)

179 
	mFLD_I2C_BUF1
 = 
BIT_RNG
(0,7),

187 
	#ªg_i2c_d©a_buf2
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0a)

	)

189 
	mFLD_I2C_BUF2
 = 
BIT_RNG
(0,7),

197 
	#ªg_i2c_d©a_buf3
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0b)

	)

199 
	mFLD_I2C_BUF3
 = 
BIT_RNG
(0,7),

208 
	#ªg_i2c_buf_˙t
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0c)

	)

210 
	mFLD_I2C_RX_BUFCNT
 = 
BIT_RNG
(0,3),

211 
	mFLD_I2C_TX_BUFCNT
 = 
BIT_RNG
(4,7),

222 
	#ªg_i2c_°©us
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0d)

	)

224 
	mFLD_I2C_RBCNT
 = 
BIT_RNG
(0,2),

225 
	mFLD_I2C_IRQ_O
 = 
BIT
(3),

226 
	mFLD_I2C_WBCNT
 = 
BIT_RNG
(4,6),

227 
	mFLD_I2C_RX_CLR
 = 
BIT
(6),

228 
	mFLD_I2C_TX_CLR
 = 
BIT
(7),

241 
	#ªg_i2c_úq_°©us
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0e)

	)

243 
	mFLD_I2C_TXDONE
 = 
BIT
(0),

244 
	mFLD_I2C_TX_BUF_IRQ
 = 
BIT
(1),

245 
	mFLD_I2C_RXDONE
 = 
BIT
(2),

246 
	mFLD_I2C_RX_BUF_IRQ
 = 
BIT
(3),

247 
	mFLD_I2C_TX_EN
 = 
BIT
(4),

252 
	#ªg_i2c_rx_fifo_Àn
 
	`REG_ADDR8
(
REG_I2C_BASE
+0x0f)

	)

254 
	mFLD_I2C_RX_FIFO_LEN
 = 
BIT_RNG
(0,7),

	@platform/chip_b91/reg_include/mdec_reg.h

24 #¥agm®
⁄˚


26 
	~"../sys.h
"

28 
	#mdec_r°_addr
 0x53

	)

30 
	mFLD_SELE_PA0
 = 
BIT
(0),

31 
	mFLD_SELE_PB7
 = 
BIT
(1),

32 
	mFLD_SELE_PC4
 = 
BIT
(2),

33 
	mFLD_SELE_PD0
 = 
BIT
(3),

34 
	mFLD_SELE_PE0
 = 
BIT
(4),

35 }
	tmdec_pö_e
;

37 
	mFLD_CLS_MDEC
 = 
BIT_RNG
(0,4),

38 
	mFLD_RSVD
 = 
BIT_RNG
(5,6),

39 
	mFLD_MDEC_RST
 = 
BIT
(7),

40 }
	tmdec_£t_e
;

42 
	#mdec_˘æ
 0x54

	)

	@platform/chip_b91/reg_include/mspi_reg.h

24 #¥agm®
⁄˚


26 
	~"../sys.h
"

29 
	#ªg_m•i_d©a
 
	`REG_ADDR8
(0x140100)

	)

31 
	#ªg_m•i_fm
 
	`REG_ADDR8
(0x140101)

	)

33 
	mFLD_MSPI_RD_TRIG_EN
 = 
BIT
(0),

34 
	mFLD_MSPI_RD_MODE
 = 
BIT
(1),

35 
	mFLD_MSPI_DATA_LINE
 = 
BIT_RNG
(2,3),

36 
	mFLD_MSPI_CSN
 = 
BIT
(4),

39 
	#ªg_m•i_°©us
 
	`REG_ADDR8
(0x140102)

	)

41 
	mFLD_MSPI_BUSY
 = 
BIT
(0),

44 
	#ªg_m•i_fm1
 
	`REG_ADDR8
(0x140103)

	)

46 
	mFLD_MSPI_TIMEOUT_CNT
 = 
BIT_RNG
(0,2),

47 
	mFLD_MSPI_CS2SCL_CNT
 = 
BIT_RNG
(3,4),

48 
	mFLD_MSPI_CS2CS_CNT
 = 
BIT_RNG
(5,7),

51 
	#ªg_m•i_c⁄fig
 
	`REG_ADDR32
(0x140104)

	)

52 
	#ªg_m•i_£t_l
 
	`REG_ADDR8
(0x140104)

	)

54 
	mFLD_MSPI_MULTIBOOT_ADDR_OFFSET
 = 
BIT_RNG
(0,2),

57 
	#ªg_m•i_£t_h
 
	`REG_ADDR8
(0x140105)

	)

59 
	mFLD_MSPI_PROGRAM_SPACE_SIZE
 = 
BIT_RNG
(0,6),

61 
	#ªg_m•i_xù_c⁄fig
 
	`REG_ADDR16
(0x140106)

	)

62 
	#ªg_m•i_cmd_ahb
 
	`REG_ADDR8
(0x140106)

	)

64 
	mFLD_MSPI_RD_CMD
 = 
BIT_RNG
(0,7),

67 
	#ªg_m•i_fm_ahb
 
	`REG_ADDR8
(0x140107)

	)

69 
	mFLD_MSPI_DUMMY
 = 
BIT_RNG
(0,3),

70 
	mFLD_MSPI_DAT_LINE
 = 
BIT_RNG
(4,5),

71 
	mFLD_MSPI_ADDR_LINE
 = 
BIT
(6),

72 
	mFLD_MSPI_CMD_LINE
 = 
BIT
(7),

	@platform/chip_b91/reg_include/npe_reg.h

24 #i‚de‡
NPE_REG_H


25 
	#NPE_REG_H


	)

26 
	~"../sys.h
"

27 
	#NPE_BASE_ADDR
 0x112000

	)

28 
	#ªg_≈e_addr
(
addr
Ë(◊ddr)-
CPU_DLM_BASE
+
DLM_BASE
)

	)

29 
	#ªg_≈e_0x40
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x40)

	)

30 
	#ªg_≈e_0x6c
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x6c)

	)

31 
	#ªg_≈e_0x84
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x84)

	)

32 
	#ªg_≈e_0x74
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x74)

	)

33 
	#ªg_≈e_0x80
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x80)

	)

34 
	#ªg_≈e_0x84
 
	`REG_ADDR32
(
NPE_BASE_ADDR
+0x84)

	)

37 
	#ªg_≈e_úq_0
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x20)

	)

40 
	mFLD_IRQ_NPE_BUS0
 = 
BIT
(0),

41 
	mFLD_IRQ_NPE_BUS1
 = 
BIT
(1),

42 
	mFLD_IRQ_NPE_BUS2
 = 
BIT
(2),

43 
	mFLD_IRQ_NPE_BUS3
 = 
BIT
(3),

44 
	mFLD_IRQ_NPE_BUS4
 = 
BIT
(4),

45 
	mFLD_IRQ_NPE_BUS7
 = 
BIT
(7),

49 
	#ªg_≈e_úq_1
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x21)

	)

52 
	mFLD_IRQ_NPE_BUS8
 = 
BIT
(0),

53 
	mFLD_IRQ_NPE_BUS13
 = 
BIT
(5),

54 
	mFLD_IRQ_NPE_BUS14
 = 
BIT
(6),

55 
	mFLD_IRQ_NPE_BUS15
 = 
BIT
(7),

58 
	#ªg_≈e_úq_2
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x22)

	)

61 
	mFLD_IRQ_NPE_BUS17
 = 
BIT
(1),

62 
	mFLD_IRQ_NPE_BUS21
 = 
BIT
(5),

63 
	mFLD_IRQ_NPE_BUS22
 = 
BIT
(6),

64 
	mFLD_IRQ_NPE_BUS23
 = 
BIT
(7),

67 
	#ªg_≈e_úq_3
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x23)

	)

70 
	mFLD_IRQ_NPE_BUS24
 = 
BIT
(0),

71 
	mFLD_IRQ_NPE_BUS25
 = 
BIT
(1),

72 
	mFLD_IRQ_NPE_BUS26
 = 
BIT
(2),

73 
	mFLD_IRQ_NPE_BUS27
 = 
BIT
(3),

74 
	mFLD_IRQ_NPE_BUS28
 = 
BIT
(4),

75 
	mFLD_IRQ_NPE_BUS29
 = 
BIT
(5),

76 
	mFLD_IRQ_NPE_BUS30
 = 
BIT
(6),

77 
	mFLD_IRQ_NPE_BUS31
 = 
BIT
(7),

	@platform/chip_b91/reg_include/pke_reg.h

24 #¥agm®
⁄˚


26 
	~"../sys.h
"

32 
	#REG_PKE_BASE
 0x110000

	)

34 
	#ªg_pke_˘æ
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x00)

	)

36 
	mFLD_PKE_CTRL_START
 = 
BIT
(0),

37 
	mFLD_PKE_CTRL_STOP
 = 
BIT
(16),

40 
	#ªg_pke_c⁄f
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x04)

	)

42 
	mFLD_PKE_CONF_IRQ_EN
 = 
BIT
(8),

43 
	mFLD_PKE_CONF_PARTIAL_RADIX
 = 
BIT_RNG
(16,23),

44 
	mFLD_PKE_CONF_BASE_RADIX
 = 
BIT_RNG
(24,26),

45 }
	tpke_c⁄f_e
;

47 
	#ªg_pke_mc_±r
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x10)

	)

49 
	#ªg_pke_°©
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x20)

	)

51 
	mFLD_PKE_STAT_DONE
 = 
BIT
(0),

52 }
	tpke_°©us_e
;

54 
	#ªg_pke_π_code
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x24)

	)

56 
	mFLD_PKE_RT_CODE_STOP_LOG
 = 
BIT_RNG
(0,3),

59 
	#ªg_pke_exe_c⁄f
 
	`REG_ADDR32
(
REG_PKE_BASE
+0x50)

	)

61 
	mFLD_PKE_EXE_CONF_IAFF_R0
 = 
BIT
(0),

62 
	mFLD_PKE_EXE_CONF_IMON_R0
 = 
BIT
(1),

63 
	mFLD_PKE_EXE_CONF_IAFF_R1
 = 
BIT
(2),

64 
	mFLD_PKE_EXE_CONF_IMON_R1
 = 
BIT
(3),

65 
	mFLD_PKE_EXE_CONF_OAFF
 = 
BIT
(4),

66 
	mFLD_PKE_EXE_CONF_OMON
 = 
BIT
(5),

67 
	mFLD_PKE_EXE_CONF_ME_SCA_EN
 = 
BIT_RNG
(8,9),

	@platform/chip_b91/reg_include/plic_reg.h

24 #i‚de‡
INTERRUPT_REG_H


25 
	#INTERRUPT_REG_H


	)

26 
	~"../sys.h
"

30 
	#ªg_úq_„©uª
 (*(vﬁ©ûê*)(0 + (0xe4000000)))

	)

32 
	#ªg_úq_≥ndög
(
i
Ë(*(vﬁ©ûê*)(0 + (0xe4001000+((i>31Ë? 4 : 0))))

	)

34 
	#ªg_úq_§c0
 (*(vﬁ©ûê*)(0 + (0xe4002000)))

	)

35 
	#ªg_úq_§c1
 (*(vﬁ©ûê*)(0 + (0xe4002004)))

	)

37 
	#ªg_úq_§c
(
i
Ë(*(vﬁ©ûê*)(0 + (0xe4002000+((i>31Ë? 4 : 0Ë)))

	)

39 
	#ªg_úq_thªshﬁd
 (*(vﬁ©ûê*)(0 + (0xe4200000)))

	)

40 
	#ªg_úq_d⁄e
 (*(vﬁ©ûê*)(0 + (0xe4200004)))

	)

42 
	#ªg_úq_§c_¥i‹ôy
(
i
Ë(*(vﬁ©ûê*)(0 + 0xe4000000+((i)<<2)))

	)

	@platform/chip_b91/reg_include/pwm_reg.h

24 #i‚de‡
PWM_REG_H


25 
	#PWM_REG_H


	)

27 
	~"../sys.h
"

32 
	#ªg_pwm_d©a_buf_adr
 0x80140448

	)

38 
	#REG_PWM_BASE
 0x140400

	)

44 
	#ªg_pwm_íabÀ
 
	`REG_ADDR8
(
REG_PWM_BASE
)

	)

46 
	mFLD_PWM1_EN
 = 
BIT
(1),

47 
	mFLD_PWM2_EN
 = 
BIT
(2),

48 
	mFLD_PWM3_EN
 = 
BIT
(3),

49 
	mFLD_PWM4_EN
 = 
BIT
(4),

50 
	mFLD_PWM5_EN
 = 
BIT
(5),

57 
	#ªg_pwm0_íabÀ
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x01)

	)

59 
	mFLD_PWM0_EN
 = 
BIT
(0),

66 
	#ªg_pwm_˛kdiv
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x02)

	)

72 
	#ªg_pwm0_mode
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x03)

	)

79 
	#ªg_pwm_övît
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x04)

	)

81 
	mFLD_PWM0_OUT_INVERT
 = 
BIT
(0),

82 
	mFLD_PWM1_OUT_INVERT
 = 
BIT
(1),

83 
	mFLD_PWM2_OUT_INVERT
 = 
BIT
(2),

84 
	mFLD_PWM3_OUT_INVERT
 = 
BIT
(3),

85 
	mFLD_PWM4_OUT_INVERT
 = 
BIT
(4),

86 
	mFLD_PWM5_OUT_INVERT
 = 
BIT
(5),

94 
	#ªg_pwm_n_övît
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x05)

	)

96 
	mFLD_PWM0_INV_OUT_INVERT
 = 
BIT
(0),

97 
	mFLD_PWM1_INV_OUT_INVERT
 = 
BIT
(1),

98 
	mFLD_PWM2_INV_OUT_INVERT
 = 
BIT
(2),

99 
	mFLD_PWM3_INV_OUT_INVERT
 = 
BIT
(3),

100 
	mFLD_PWM4_INV_OUT_INVERT
 = 
BIT
(4),

101 
	mFLD_PWM5_INV_OUT_INVERT
 = 
BIT
(5),

115 
	#ªg_pwm_pﬁ
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x06)

	)

117 
	mFLD_PWM0_FIRST_OUT_LEVEL
 = 
BIT
(0),

118 
	mFLD_PWM1_FIRST_OUT_LEVEL
 = 
BIT
(1),

119 
	mFLD_PWM2_FIRST_OUT_LEVEL
 = 
BIT
(2),

120 
	mFLD_PWM3_FIRST_OUT_LEVEL
 = 
BIT
(3),

121 
	mFLD_PWM4_FIRST_OUT_LEVEL
 = 
BIT
(4),

122 
	mFLD_PWM5_FIRST_OUT_LEVEL
 = 
BIT
(5),

131 
	#ªg_pwm_mode32k
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x07)

	)

133 
	mFLD_PWM0_32K_ENABLE
 = 
BIT
(0),

134 
	mFLD_PWM1_32K_ENABLE
 = 
BIT
(1),

135 
	mFLD_PWM2_32K_ENABLE
 = 
BIT
(2),

136 
	mFLD_PWM3_32K_ENABLE
 = 
BIT
(3),

137 
	mFLD_PWM4_32K_ENABLE
 = 
BIT
(4),

138 
	mFLD_PWM5_32K_ENABLE
 = 
BIT
(5),

146 
	#ªg_pwm_cmp
(
i
Ë
	`REG_ADDR16
(
REG_PWM_BASE
+0x14 +(ò<< 2))

	)

153 
	#ªg_pwm_cy˛e
(
i
Ë
	`REG_ADDR32
(
REG_PWM_BASE
+0x14 + (ò<< 2))

	)

159 
	#FLD_PWM_CMP
 = 
	`BIT_RNG
(0,15),

	)

160 
	#FLD_PWM_MAX
 = 
	`BIT_RNG
(16,31),

	)

165 
	#ªg_pwm_max
(
i
Ë
	`REG_ADDR16
(
REG_PWM_BASE
+0x16 + (ò<< 2))

	)

170 
	#ªg_pwm_˙t5_l
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x3e)

	)

173 
	mFLD_PWM_32K_DUTY_CYCLE_UPDATE
 = 
BIT
(0),

179 
	#ªg_pwm0_pul£_num0
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x2c)

180 
	#ªg_pwm0_pul£_num1
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x2d)

181 

	)

188 
	mFLD_PWM0_PNUM_IRQ
 = 
BIT
(0),

189 
	mFLD_PWM0_IR_DMA_FIFO_IRQ
 = 
BIT
(1),

190 
	mFLD_PWM0_FRAME_DONE_IRQ
 = 
BIT
(2),

191 
	mFLD_PWM1_FRAME_DONE_IRQ
 = 
BIT
(3),

192 
	mFLD_PWM2_FRAME_DONE_IRQ
 = 
BIT
(4),

193 
	mFLD_PWM3_FRAME_DONE_IRQ
 = 
BIT
(5),

194 
	mFLD_PWM4_FRAME_DONE_IRQ
 = 
BIT
(6),

195 
	mFLD_PWM5_FRAME_DONE_IRQ
 = 
BIT
(7),

197 
	mFLD_PWM0_IR_FIFO_IRQ
 = 
BIT
(16),

199 }
	tpwm_úq_e
;

213 
	#ªg_pwm_úq_mask
(
i
Ë
	`REG_ADDR8
(
REG_PWM_BASE
+0x30+i*2)

	)

229 
	#ªg_pwm_úq_°a
(
i
Ë
	`REG_ADDR8
(
REG_PWM_BASE
+0x31+i*2)

	)

235 
	#ªg_pwm_˙t
(
i
Ë
	`REG_ADDR16
(
REG_PWM_BASE
+0x34 +(ò<< 1))

	)

241 
	#ªg_pwm_n˙t_l
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x40)

	)

247 
	#ªg_pwm_n˙t_h
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x41)

	)

253 
	#ªg_pwm_tcmp0_shadow
 
	`REG_ADDR16
(
REG_PWM_BASE
+0x44)

	)

259 
	#ªg_pwm_tmax0_shadow
 
	`REG_ADDR16
(
REG_PWM_BASE
+0x46)

	)

265 
	#ªg_pwm_ú_fifo_d©
(
i
Ë
	`REG_ADDR16
(
REG_PWM_BASE
+0x48+i*2)

	)

272 
	#ªg_pwm_ú_fifo_úq_åig_Àvñ
 
	`REG_ADDR8
(
REG_PWM_BASE
+0x4c)

	)

274 
	mFLD_PWM0_FIFO_NUM_OF_TRIGGLE_LEVEL
 = 
BIT_RNG
(0,3),

284 
	#ªg_pwm_ú_fifo_d©a_°©us
 
	`REG_ADDR8
(0x14044d)

	)

286 
	mFLD_PWM0_IR_FIFO_DATA_NUM
 = 
BIT_RNG
(0,3),

287 
	mFLD_PWM0_IR_FIFO_EMPTY
 = 
BIT
(4),

288 
	mFLD_PWM0_IR_FIFO_FULL
 = 
BIT
(5),

296 
	#ªg_pwm_ú_˛r_fifo_d©a
 
	`REG_ADDR8
(0x14044e)

	)

298 
	mFLD_PWM0_IR_FIFO_CLR_DATA
 = 
BIT
(0),

	@platform/chip_b91/reg_include/register_b91.h

24 #i‚de‡ 
REGISTER_B91_H


25 
	#REGISTER_B91_H


	)

27 
	~"gpio_ªg.h
"

28 
	~"soc.h
"

29 
	~"™Æog_ªg.h
"

30 
	~"audio_ªg.h
"

31 
	~"timî_ªg.h
"

32 
	~"dma_ªg.h
"

33 
	~"usb_ªg.h
"

34 
	~"pwm_ªg.h
"

35 
	~"•i_ªg.h
"

36 
	~"i2c_ªg.h
"

37 
	~"m•i_ªg.h
"

38 
	~"rf_ªg.h
"

39 
	~"ång_ªg.h
"

40 
	~"≈e_ªg.h
"

41 
	~"pke_ªg.h
"

42 
	~"∂ic_ªg.h
"

43 
	~"u¨t_ªg.h
"

44 
	~"°imî_ªg.h
"

45 
	~"´s_ªg.h
"

46 
	~"adc_ªg.h
"

47 
	~"mdec_ªg.h
"

48 
	~"swúe_ªg.h
"

	@platform/chip_b91/reg_include/rf_reg.h

24 #i‚de‡ 
RF_REG_H


25 
	#RF_REG_H


	)

26 
	~"../sys.h
"

29 
	#APBADDR
 0x140000

	)

30 
	#BBADDR
 
APBADDR
+0x800

31 
	#RADIOADDR
 
APBADDR
+0xe00

32 
	#MODEMADDR
 
APBADDR
+0xc00

33 
	#CHNADDR
 0x100400

	)

34 
	#APBRG_BASE
 0x140000

	)

35 
	#APBRG_APB_BASE
 (
APBRG_BASE
+0x0000)

	)

38 
	#REG_TL_RADIO_BASE_ADDR
 (
APBRG_BASE
+0x0e00)

	)

41 
	#ªg_rf_bb_auto_˘æ
 
	`REG_ADDR8
(0x10050c)

	)

44 
	mFLD_RF_TX_MULTI_EN
 = 
BIT
(0),

45 
	mFLD_RF_RX_MULTI_EN
 = 
BIT
(1),

46 
	mFLD_RF_CH_0_RNUM_EN_BK
 = 
BIT
(2),

47 
	mFLD_RF_CH_1_RNUM_EN_BK
 = 
BIT
(3),

48 
	mFLD_RF_CH1_RX_ERR_EN
 = 
BIT
(4),

49 
	mFLD_RF_DMA_REQ_D1_EN
 = 
BIT
(5),

51 
	#ªg_rf_bb_tx_chn_dï
 
	`REG_ADDR8
(0x1004f3)

	)

52 
	#ªg_rf_bb_tx_size
 
	`REG_ADDR8
(0x1004f2)

	)

54 
	#ªg_rf_dma_rx_w±r
 
	`REG_ADDR8
(0x001004f4)

	)

55 
	#ªg_rf_dma_rx_Ωå
 
	`REG_ADDR8
(0x001004f5)

	)

57 
	#ªg_rf_dma_tx_Ωå
(
i
Ë
	`REG_ADDR8
(0x00100501 + (ò<< 1))

	)

58 
	#ªg_rf_dma_tx_w±r
(
i
Ë
	`REG_ADDR8
(0x00100500 + (ò<< 1))

	)

60 
	#ªg_rf_bb_rx_size
 
	`REG_ADDR8
(
CHNADDR
+0xf6)

	)

64 
	#ªg_rf_rx_w±r_mask
 
	`REG_ADDR8
(
CHNADDR
+0x10d)

	)

69 
	#REG_BASEBAND_BASE_ADDR
 0x0140800

	)

72 
	#ªg_rf_tx_mode1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
)

	)

74 
	mFLD_RF_DMA_EN
 = 
BIT
(0),

75 
	mFLD_RF_CRC_EN
 = 
BIT
(1),

76 
	mFLD_RF_TX_FMT
 = 
BIT_RNG
(2,3),

77 
	mFLD_RF_TX_XOR_MODE
 = 
BIT
(4),

78 
	mFLD_RF_TX_TEST_DATA
 = 
BIT
(5),

79 
	mFLD_RF_TX_TEST_EN
 = 
BIT
(6),

80 
	mFLD_RF_BB_DEC
 = 
BIT
(7),

84 
	#ªg_rf_tx_mode2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x01)

	)

86 
	mFLD_RF_ZB_PN_EN
 = 
BIT
(0),

87 
	mFLD_RF_RESERVED0
 = 
BIT_RNG
(1,2),

88 
	mFLD_RF_V_PN_EN
 = 
BIT
(3),

89 
	mFLD_RF_RESERVED1
 = 
BIT_RNG
(4,5),

90 
	mFLD_RF_TX_OUT_PLR
 = 
BIT
(6),

94 
	#ªg_rf_¥ómbÀ_åaû
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x02)

	)

96 
	mFLD_RF_PREAMBLE_LEN
 = 
BIT_RNG
(0,4),

97 
	mFLD_RF_TRAILER_LEN
 = 
BIT_RNG
(5,7),

101 
	#ªg_rf_bbdbg
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x03)

	)

103 
	mFLD_RF_SLOW_EN
 = 
BIT
(0),

104 
	mFLD_RF_SLOW_SEL
 = 
BIT
(1),

105 
	mFLD_RF_XMODE_EN
 = 
BIT
(2),

106 
	mFLD_RF_REV_ORDER
 = 
BIT
(3),

107 
	mFLD_RF_TX_MODE
 = 
BIT
(4),

108 
	mFLD_RF_R_DBG_SEL0
 = 
BIT
(5),

109 
	mFLD_RF_MODEM1M_PAT
 = 
BIT
(6),

110 
	mFLD_RF_R_DBG_SEL1
 = 
BIT
(7),

114 
	#ªg_rf_f‹m©
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x04)

	)

116 
	mFLD_RF_HEAD_MODE
 = 
BIT_RNG
(0,1),

117 
	mFLD_RF_CRC_MODE
 = 
BIT_RNG
(2,3),

118 
	mFLD_RF_BLE_1M
 = 
BIT
(4),

119 
	mFLD_RF_BLE_WT
 = 
BIT
(5),

120 
	mFLD_RF_TX_NOACK
 = 
BIT
(6),

121 
	mFLD_RF_PN_AUTO
 = 
BIT
(7),

126 
	#ªg_rf_acc_Àn
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x05)

	)

128 
	mFLD_RF_ACC_LEN
 = 
BIT_RNG
(0,2),

129 
	mFLD_RF_LR_TX_SEL
 = 
BIT
(4),

130 
	mFLD_RF_BLE_LR
 = 
BIT
(5),

135 
	#ªg_rf_sbÀn
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x06)

	)

138 
	#ªg_rf_rxchn
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x07)

	)

140 
	mFLD_RF_TEST_TXON
 = 
BIT
(6),

141 
	mFLD_RF_TEST_TXON_EN
 = 
BIT
(7),

144 
	#ªg_rf_ac˚ss_code
 
	`REG_ADDR32
(
REG_BASEBAND_BASE_ADDR
+0x08)

	)

145 
	#ªg_rf_ac˚ss_0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x08)

	)

146 
	#ªg_rf_ac˚ss_1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x09)

	)

147 
	#ªg_rf_ac˚ss_2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x0a)

	)

148 
	#ªg_rf_ac˚ss_3
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x0b)

	)

149 
	#ªg_rf_ac˚ss_4
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x0c)

	)

152 
	#ªg_rf_≤
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x0d)

	)

154 
	mFLD_RF_PN_INIT
 = 
BIT_RNG
(0,5),

158 
	#ªg_rf_ac˚ss_5
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x10)

	)

159 
	#ªg_rf_ac˚ss_6
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x11)

	)

160 
	#ªg_rf_ac˚ss_7
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x12)

	)

161 
	#ªg_rf_ac˚ss_8
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x13)

	)

162 
	#ªg_rf_ac˚ss_9
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x14)

	)

163 
	#ªg_rf_ac˚ss_10
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x18)

	)

164 
	#ªg_rf_ac˚ss_11
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x19)

	)

165 
	#ªg_rf_ac˚ss_12
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x1a)

	)

166 
	#ªg_rf_ac˚ss_13
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x1b)

	)

167 
	#ªg_rf_ac˚ss_code_ba£_pùe0
 0x140808

	)

168 
	#ªg_rf_ac˚ss_code_ba£_pùe2
 0x140818

	)

170 
	#ªg_rf_txfifo
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x1c)

	)

172 
	mFLD_RF_TX_FIFO_FULL
 = 
BIT
(0),

173 
	mFLD_RF_TX_ACT_2D
 = 
BIT
(1),

177 
	#ªg_rf_rxgth1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x21)

	)

179 
	mFLD_RF_R_PILOT_LEN_O
 = 
BIT_RNG
(0,3),

180 
	mFLD_RF_R_ZB_SFD_O
 = 
BIT
(4),

181 
	mFLD_RF_R_PKTLEN_O
 = 
BIT
(5),

182 
	mFLD_RF_R_SN_LEN_O
 = 
BIT
(6),

183 
	mFLD_RF_R_LEN_0_EN_O
 = 
BIT
(7),

187 
	#ªg_rf_rxsfd0_num
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x22)

	)

189 
	mFLD_RF_RXCHN_MAN_EN
 = 
BIT
(3),

190 
	mFLD_RF_RXCHN_MAN
 = 
BIT_RNG
(4,6),

194 
	#ªg_rf_¸c_öô0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x24)

	)

195 
	#ªg_rf_¸c_öô1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x25)

	)

196 
	#ªg_rf_¸c_öô2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x26)

	)

199 
	#ªg_rf_˘æ_0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x27)

	)

201 
	mFLD_RF_H1M_ODD
 = 
BIT
(0),

202 
	mFLD_RF_REV_ZB_SAMP
 = 
BIT
(1),

203 
	mFLD_RF_SFD_LAST_CHIP
 = 
BIT
(2),

207 
	#ªg_rf_rxmode
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x28)

	)

209 
	mFLD_RF_RX_ENABLE
 = 
BIT
(0),

213 
	#ªg_rf_rx˛k_⁄
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x2a)

	)

215 
	mFLD_RF_CLKON_O
 = 
BIT_RNG
(0,1),

219 
	#ªg_rf_rx˛k_auto
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x2b)

	)

221 
	mFLD_RF_CLK_AUTO
 = 
BIT_RNG
(0,1),

225 
	#ªg_rf_rxdma_hs
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x2c)

	)

227 
	mFLD_RF_RXDMA_HS
 = 
BIT
(0),

231 
	#ªg_rf_rxt¸˝kt
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x30)

	)

233 
	mFLD_RF_FILTER_CRC_PKT
 = 
BIT
(0),

234 
	mFLD_RF_EN_TS_RX
 = 
BIT
(2),

235 
	mFLD_RF_EN_TS_TX
 = 
BIT
(3),

236 
	mFLD_RF_LEN_SET_O
 = 
BIT_RNG
(4,5),

240 
	#ªg_rf_rxtmaxÀn
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x31)

	)

243 
	#ªg_rf_rxœtf
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x33)

	)

245 
	mFLD_RF_R_LATF_CNT_O
 = 
BIT_RNG
(0,3),

246 
	mFLD_RF_R_LATF_AT_END_O
 = 
BIT
(4),

250 
	#ªg_rf_b™k_˙t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x34)

	)

252 
	mFLD_RF_BANK_CNT
 = 
BIT_RNG
(0,2),

256 
	#ªg_rf_rxsuµ
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x38)

	)

258 
	mFLD_RF_RX_SUPP_D_EN
 = 
BIT
(0),

259 
	mFLD_RF_RX_SUPP_A_EN
 = 
BIT
(1),

260 
	mFLD_RF_TX_SUPP_D_EN
 = 
BIT
(2),

261 
	mFLD_RF_TX_SUPP_A_EN
 = 
BIT
(3),

262 
	mFLD_RF_ANT_NUM
 = 
BIT_RNG
(4,7),

266 
	#ªg_rf_tx_™toff£t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x39)

	)

267 
	#ªg_rf_rx_™toff£t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3a)

	)

268 
	#ªg_rf_ßmp_off£t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3b)

	)

271 
	#ªg_rf_m™_™t_¶Ÿ
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3c)

	)

273 
	mFLD_RF_ANT_SEL_MAN
 = 
BIT_RNG
(0,2),

274 
	mFLD_RF_ANT_SEL_MAN_EN
 = 
BIT
(3),

275 
	mFLD_RF_SLOT_1US_MAN_EN
 = 
BIT
(4),

276 
	mFLD_RF_SLOT_1US_MAN
 = 
BIT
(5),

277 
	mFLD_RF_ANT_PAT
 = 
BIT_RNG
(6,7),

281 
	#ªg_rf_sof_off£t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3d)

	)

283 
	mFLD_RF_ANT_SOF_OFFSET
 = 
BIT_RNG
(0,1),

284 
	mFLD_RF_SAMP_SOF_OFFSET
 = 
BIT_RNG
(2,3),

285 
	mFLD_RF_SUPP_MODE
 = 
BIT_RNG
(4,6),

289 
	#ªg_rf_mode_˘æ0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3e)

	)

291 
	mFLD_RF_INTV_MODE
 = 
BIT_RNG
(0,1),

292 
	mFLD_RF_IQ_SAMP_EN
 = 
BIT
(2),

293 
	mFLD_RF_IQ_SAMP_INTERVAL
 = 
BIT_RNG
(4,7),

297 
	#ªg_rf_iq_ßmp_°¨t
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x3f)

	)

300 
	#ªg_rf_dec_îr
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x40)

	)

302 
	mFLD_RF_SS
 = 
BIT_RNG
(0,2),

303 
	mFLD_RF_PKT_DEC_ERR
 = 
BIT_RNG
(4,7),

306 
	#ªg_rf_time°amp
 
	`REG_ADDR32
(
REG_BASEBAND_BASE_ADDR
+0x50)

	)

307 
	#ªg_rf_t°amp0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x50)

	)

309 
	mFLD_RF_R_TSTAMP0
 = 
BIT_RNG
(0,7),

313 
	#ªg_rf_t°amp1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x51)

	)

315 
	mFLD_RF_R_TSTAMP1
 = 
BIT_RNG
(0,7),

319 
	#ªg_rf_t°amp2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x52)

	)

321 
	mFLD_RF_R_TSTAMP2
 = 
BIT_RNG
(0,7),

325 
	#ªg_rf_t°amp3
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x53)

	)

327 
	mFLD_RF_R_TSTAMP3
 = 
BIT_RNG
(0,7),

331 
	#ªg_rf_™t_lut_0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x68)

	)

333 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

334 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

338 
	#ªg_rf_™t_lut_1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x69)

	)

340 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

341 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

345 
	#ªg_rf_™t_lut_2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6a)

	)

347 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

348 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

352 
	#ªg_rf_™t_lut_3
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6b)

	)

354 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

355 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

359 
	#ªg_rf_™t_lut_4
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6c)

	)

361 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

362 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

366 
	#ªg_rf_™t_lut_5
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6d)

	)

368 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

369 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

373 
	#ªg_rf_™t_lut_6
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6e)

	)

375 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

376 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

380 
	#ªg_rf_™t_lut_7
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x6f)

	)

382 
	mFLD_RF_ANT_LUT0
 = 
BIT_RNG
(0,2),

383 
	mFLD_RF_ANT_LUT1
 = 
BIT_RNG
(4,6),

387 
	#ªg_rf_rxdma_adr
 0x140880

	)

388 
	#ªg_rf_rxdma_fifo0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x80)

	)

390 
	mFLD_RF_RXDMA_FIFO0
 = 
BIT_RNG
(0,7),

394 
	#ªg_rf_rxdma_fifo1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x81)

	)

396 
	mFLD_RF_RXDMA_FIFO1
 = 
BIT_RNG
(0,7),

400 
	#ªg_rf_rxdma_fifo2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x82)

	)

402 
	mFLD_RF_RXDMA_FIFO2
 = 
BIT_RNG
(0,7),

406 
	#ªg_rf_rxdma_fifo3
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x83)

	)

408 
	mFLD_RF_RXDMA_FIFO3
 = 
BIT_RNG
(0,7),

411 
	#ªg_rf_txdma_adr
 0x140884

	)

412 
	#ªg_rf_txdma_fifo0
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x84)

	)

414 
	mFLD_RF_TXDMA_FIFO0
 = 
BIT_RNG
(0,7),

418 
	#ªg_rf_txdma_fifo1
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x85)

	)

420 
	mFLD_RF_TXDMA_FIFO1
 = 
BIT_RNG
(0,7),

424 
	#ªg_rf_txdma_fifo2
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x86)

	)

426 
	mFLD_RF_TXDMA_FIFO2
 = 
BIT_RNG
(0,7),

430 
	#ªg_rf_txdma_fifo3
 
	`REG_ADDR8
(
REG_BASEBAND_BASE_ADDR
+0x87)

	)

432 
	mFLD_RF_TXDMA_FIFO3
 = 
BIT_RNG
(0,7),

440 
	#REG_BB_LL_BASE_ADDR
 0x0140a00

	)

443 
	#ªg_rf_Œ_cmd
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
)

	)

445 
	mFLD_RF_R_CMD
 = 
BIT_RNG
(0,3),

446 
	mFLD_RF_R_STOP
 = 0,

447 
	mFLD_RF_R_BTX
 = 1,

448 
	mFLD_RF_R_BRX
 = 2,

449 
	mFLD_RF_R_PTX
 = 3,

450 
	mFLD_RF_R_PRX
 = 4,

451 
	mFLD_RF_R_STX
 = 5,

452 
	mFLD_RF_R_SRX
 = 6,

453 
	mFLD_RF_R_STR
 = 7,

454 
	mFLD_RF_R_SRT
 = 8,

455 
	mFLD_RF_R_CMD_TRIG
 = 
BIT
(7),

459 
	#ªg_rf_Œ_ª°_pid
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x01)

	)

461 
	mFLD_RF_R_RESET_PID_0
 = 
BIT
(0),

462 
	mFLD_RF_R_RESET_PID_1
 = 
BIT
(1),

463 
	mFLD_RF_R_RESET_PID_2
 = 
BIT
(2),

464 
	mFLD_RF_R_RESET_PID_3
 = 
BIT
(3),

465 
	mFLD_RF_R_RESET_PID_4
 = 
BIT
(4),

466 
	mFLD_RF_R_RESET_PID_5
 = 
BIT
(5),

470 
	#ªg_rf_Œ_˘æ0
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x02)

	)

472 
	mFLD_RF_R_MD_EN
 = 
BIT
(0),

473 
	mFLD_RF_R_ID_EN
 = 
BIT
(1),

474 
	mFLD_RF_R_RX_NOACK_MAN
 = 
BIT
(2),

475 
	mFLD_RF_R_RX_NOACK_MAN_EN
 = 
BIT
(3),

476 
	mFLD_RF_R_TX_EN_MAN
 = 
BIT
(4),

477 
	mFLD_RF_R_RX_EN_MAN
 = 
BIT
(5),

478 
	mFLD_RF_R_TX_TRIQ_AUTO_EN
 = 
BIT
(6),

479 
	mFLD_RF_R_S_TX_TIMEOUT_EN
 = 
BIT
(7),

483 
	#ªg_rf_Œ_˘æ_1
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x03)

	)

486 
	mFLD_RF_FSM_TIMEOUT_EN
 = 
BIT
(0),

487 
	mFLD_RF_RX_FIRST_TIMEOUT_EN
 = 
BIT
(1),

488 
	mFLD_RF_RX_TIMEOUT_EN
 = 
BIT
(2),

489 
	mFLD_RF_CRC_2_EN
 = 
BIT
(3),

492 
	mFLD_RF_BRX_SN_INIT
 = 
BIT
(4),

493 
	mFLD_RF_BRX_NESN_INIT
 = 
BIT
(5),

494 
	mFLD_RF_BTX_SN_INIT
 = 
BIT
(6),

495 
	mFLD_RF_BTX_NESN_INIT
 = 
BIT
(7),

498 
	#FSM_TIMEOUT_ENABLE
 ( 
ªg_rf_Œ_˘æ_1
 |
FLD_RF_FSM_TIMEOUT_EN
 )

	)

499 
	#FSM_TIMEOUT_DISABLE
 ( 
ªg_rf_Œ_˘æ_1
 &(~
FLD_RF_FSM_TIMEOUT_EN
Ë)

	)

501 
	#ªg_rf_Œ_tx_°l
 
	`REG_ADDR16
(
REG_BB_LL_BASE_ADDR
+0x04)

	)

503 
	#ªg_rf_Œ_tx_°l_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x04)

	)

506 
	#ªg_rf_Œ_tx_°l_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x05)

	)

508 
	mFLD_RF_R_T_TXSTL_H
 = 
BIT_RNG
(0,3),

512 
	#ªg_rf_Œ_rxwaô_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x06)

	)

515 
	#ªg_rf_Œ_rxwaô_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x07)

	)

517 
	mFLD_RF_R_T_RXWAIT_H
 = 
BIT_RNG
(0,3),

521 
	#ªg_rf_Œ_rx_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0a)

	)

523 
	#ªg_rf_rx_timeout
 
	`REG_ADDR16
(
REG_BB_LL_BASE_ADDR
+0x0a)

	)

525 
	#ªg_rf_Œ_rx_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0b)

	)

527 
	mFLD_RF_R_T_RX_H
 = 
BIT_RNG
(0,3),

531 
	#ªg_rf_Œ_rx°l_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0c)

	)

534 
	#ªg_rf_Œ_rx°l_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0d)

	)

536 
	mFLD_RF_R_T_RXSTL_H
 = 
BIT_RNG
(0,3),

540 
	#ªg_rf_Œ_txwaô_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0e)

	)

543 
	#ªg_rf_Œ_txwaô_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x0f)

	)

545 
	mFLD_RF_R_T_TXWAIT_H
 = 
BIT_RNG
(0,3),

549 
	#ªg_rf_Œ_¨d_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x10)

	)

552 
	#ªg_rf_Œ_¨d_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x11)

	)

554 
	mFLD_RF_R_T_ARD_H
 = 
BIT_RNG
(0,3),

558 
	#ªg_rf_t_c€x_t1
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x12)

	)

559 
	#ªg_rf_t_c€x_t2
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x13)

	)

560 
	#ªg_rf_Œ_max_ª£t_˙t
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x14)

	)

563 
	#ªg_rf_Œ_˘æ2
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x15)

	)

565 
	mFLD_RF_R_TXCHN_MAN
 = 
BIT_RNG
(0,2),

566 
	mFLD_RF_R_NOACK_RECNT_EN
 = 
BIT
(3),

567 
	mFLD_RF_R_TXCHN_MAN_EN
 = 
BIT
(4),

568 
	mFLD_RF_R_NOACK_REV_EN
 = 
BIT
(5),

569 
	mFLD_RF_R_RXIRQ_REPORT_ALL
 = 
BIT
(6),

570 
	mFLD_RF_R_REP_SN_PID_EN
 = 
BIT
(7),

574 
	#ªg_rf_Œ_˘æ3
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x16)

	)

576 
	mFLD_RF_R_TX_EN_DLY_EN
 = 
BIT
(0),

577 
	mFLD_RF_R_PLL_RESET_EN
 = 
BIT
(1),

578 
	mFLD_RF_R_CMD_SCHDULE_EN
 = 
BIT
(2),

579 
	mFLD_RF_R_PLL_EN_MAN
 = 
BIT
(3),

580 
	mFLD_RF_R_T_TX_EN_DLY
 = 
BIT_RNG
(4,7),

584 
	#ªg_rf_Œ_∂l_ª£t
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x17)

	)

585 
	#ªg_rf_Œ_cmd_scheduÀ
 
	`REG_ADDR32
(
REG_BB_LL_BASE_ADDR
+0x18)

	)

586 
	#ªg_rf_Œ_cmd_scheduÀ0
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x18)

	)

587 
	#ªg_rf_Œ_cmd_scheduÀ1
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x19)

	)

588 
	#ªg_rf_Œ_cmd_scheduÀ2
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1a)

	)

589 
	#ªg_rf_Œ_cmd_scheduÀ3
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1b)

	)

590 
	#ªg_rf_Œ_úq_mask_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1c)

	)

591 
	#ªg_rf_Œ_úq_mask_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1d)

	)

592 
	#ªg_rf_úq_mask
 
	`REG_ADDR16
(
REG_BB_LL_BASE_ADDR
+0x1c)

	)

595 
	#ªg_rf_Œ_tx_id
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1e)

	)

597 
	mFLD_RF_R_TX_ID
 = 
BIT_RNG
(0,6),

601 
	#ªg_rf_Œ_tx_commôãd
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x1f)

	)

603 
	mFLD_RF_R_TX_COMMITTED
 = 
BIT_RNG
(0,5),

608 
	#ªg_rf_úq_°©us
 
	`REG_ADDR16
(
REG_BB_LL_BASE_ADDR
+0x20)

	)

611 
	mFLD_RF_IRQ_RX
 = 
BIT
(0),

612 
	mFLD_RF_IRQ_TX
 = 
BIT
(1),

613 
	mFLD_RF_IRQ_RX_TIMEOUT
 = 
BIT
(2),

614 
	mFLD_RF_IRQ_RX_FIFO_FULL
 = 
BIT
(3),

615 
	mFLD_RF_IRQ_RX_CRC_2
 = 
BIT
(4),

616 
	mFLD_RF_IRQ_CMD_DONE
 = 
BIT
(5),

617 
	mFLD_RF_IRQ_FSM_TIMEOUT
 = 
BIT
(6),

618 
	mFLD_RF_IRQ_TX_RETRYCNT
 = 
BIT
(7),

619 
	mFLD_RF_IRQ_TX_DS
 = 
BIT
(8),

620 
	mFLD_RF_IRQ_RX_DR
 = 
BIT
(9),

621 
	mFLD_RF_IRQ_FIRST_TIMEOUT
 = 
BIT
(10),

622 
	mFLD_RF_IRQ_INVALID_PID
 = 
BIT
(11),

623 
	mFLD_RF_IRQ_STX_TIMEOUT
 = 
BIT
(12),

624 
	mFLD_RF_IRQ_WIFI_DENY
 = 
BIT
(13),

625 
	mFLD_RF_IRQ_SUPP_OF
 = 
BIT
(14),

626 
	mFLD_RF_IRQ_RXDMA_OF
 = 
BIT
(15),

627 
	mFLD_RF_IRQ_ALL
 = 0X1FFF,

628 }
	trf_úq_e
;

632 
	#ªg_rf_Œ_pid_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x22)

	)

634 
	mFLD_RF_PID0
 = 
BIT_RNG
(0,1),

635 
	mFLD_RF_PID1
 = 
BIT_RNG
(2,3),

636 
	mFLD_RF_PID2
 = 
BIT_RNG
(4,5),

637 
	mFLD_RF_PID3
 = 
BIT_RNG
(6,7),

641 
	#ªg_rf_Œ_pid_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x23)

	)

643 
	mFLD_RF_PID4
 = 
BIT_RNG
(0,1),

644 
	mFLD_RF_PID5
 = 
BIT_RNG
(2,3),

645 
	mFLD_RF_NESN
 = 
BIT
(4),

649 
	#ªg_rf_Œ_2d_s˛k
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x24)

	)

651 
	mFLD_RF_STATE_MACHINE_IDLE
 = 0,

652 
	mFLD_RF_STATE_MACHINE_TX_SETTLE
,

653 
	mFLD_RF_STATE_MACHINE_TX
,

654 
	mFLD_RF_STATE_MACHINE_RX_WAIT
,

655 
	mFLD_RF_STATE_MACHINE_RX
,

656 
	mFLD_RF_STATE_MACHINE_TX_WAIT
,

657 } 
	t°©e_machöe_°©us_e
;

660 
	#ªg_rf_Œ_ªåy_˙t
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x25)

	)

662 
	mFLD_RF_LL_RETRY_CNT
 = 
BIT_RNG
(0,7),

666 
	#ªg_rf_Œ_˙t0
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x26)

	)

668 
	mFLD_RF_CRC_CNT
 = 
BIT_RNG
(0,3),

669 
	mFLD_RF_NAK_CNT
 = 
BIT_RNG
(4,7),

673 
	#ªg_rf_Œ_˙t1
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x27)

	)

675 
	mFLD_RF_OLD_CNT
 = 
BIT_RNG
(0,3),

676 
	mFLD_RF_ID_CNT
 = 
BIT_RNG
(4,7),

679 
	#ªg_rf_Œ_rx_f°_timeout
 
	`REG_ADDR32
(
REG_BB_LL_BASE_ADDR
+0x28)

	)

680 
	#ªg_rf_Œ_rx_f°_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x28)

	)

681 
	#ªg_rf_Œ_rx_f°_m
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x29)

	)

682 
	#ªg_rf_Œ_rx_f°_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x2a)

	)

684 
	#ªg_rf_Œ_fsm_timeout
 
	`REG_ADDR32
(
REG_BB_LL_BASE_ADDR
+0x2c)

	)

685 
	#ªg_rf_Œ_fsm_timeout_l
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x2c)

	)

686 
	#ªg_rf_Œ_fsm_timeout_m
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x2d)

	)

687 
	#ªg_rf_Œ_fsm_timeout_h
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x2e)

	)

689 
	#ªg_rf_fsm_timeout
 
	`REG_ADDR32
(0x80140a2c)

	)

691 
	#ªg_rf_c€x_íabÀ
 
	`REG_ADDR8
(
REG_BB_LL_BASE_ADDR
+0x30)

	)

693 
	mFLD_RF_COEX_EN
 = 
BIT
(0),

694 
	mFLD_RF_COEX_WF_DN_POL
 = 
BIT
(1),

695 
	mFLD_RF_COEX_STATUS
 = 
BIT
(2),

696 
	mFLD_RF_COEX_TRX_POL
 = 
BIT
(3),

697 
	mFLD_RF_TRX_PRIO
 = 
BIT
(4),

698 
	mFLD_RF_TX_PRIO
 = 
BIT
(5),

699 
	mFLD_RF_RX_PRIO
 = 
BIT
(6),

701 
	#CLEAR_ALL_RFIRQ_STATUS
 (
ªg_rf_úq_°©us
 = 0xffff)

	)

702 
	#REG_TL_MODEM_BASE_ADDR
 0x140c00

703 

	)

704 
	#ªg_rf_modem_mode_cfg_rx1_0
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x20)

	)

707 
	mFLD_RF_LR_MODE
 = 
BIT
(0),

708 
	mFLD_RF_BT_BLE_SEL_AUTO
 = 
BIT
(1),

709 
	mFLD_RF_BT_BLE_SEL_EN_RX
 = 
BIT
(2),

710 
	mFLD_RF_CONT_MODE
 = 
BIT
(3),

711 
	mFLD_RF_NTL_CV
 = 
BIT
(4),

712 
	mFLD_RF_RX_DATA_CLK_DBG
 = 
BIT
(5),

713 
	mFLD_RF_LR_TRIG_MODE
 = 
BIT
(6),

714 
	mFLD_RF_FDC_DBG_SEL
 = 
BIT
(7),

717 
	#ªg_rf_modem_mode_˘æ_tx1_0
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x22)

	)

720 
	mFLD_RF_BLE_MODEM_TX
 = 
BIT
(0),

723 
	#ªg_rf_modem_rx_˘æ_0
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x4c)

	)

726 
	mFLD_RF_RX_ACC_LNE
 = 
BIT_RNG
(0,2),

727 
	mFLD_RF_RX_CRC_EN
 = 
BIT
(3),

728 
	mFLD_RF_SFD0_NUM
 = 
BIT_RNG
(4,6),

731 
	#ªg_rf_modem_sync_thª_bÀ
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x4e)

	)

733 
	#ªg_rf_agc_rssi_œt
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x5d)

	)

735 
	#ªg_rf_tx_é_˘æ
 
	`REG_ADDR8
(
REG_TL_MODEM_BASE_ADDR
+0x9a)

	)

738 
	mFLD_RF_TX_TP_EN
 = 
BIT
(0),

739 
	mFLD_RF_TX_IQ_EN
 = 
BIT
(1),

740 
	mFLD_RF_TX_MPSK_EN
 = 
BIT
(2),

741 
	mFLD_RF_TX_TP_ALIGN
 = 
BIT
(3),

745 
	#ªg_rf_mode_cfg_rx1_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x20)

	)

748 
	mFLD_RF_BW_CODE
 = 
BIT_RNG
(1,3),

749 
	mFLD_RF_SC_CODE
 = 
BIT
(4),

752 
	#ªg_rf_mode_cfg_rx1_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x21)

	)

755 
	mFLD_RF_MODE_VANT_RX
 = 
BIT
(1),

756 
	mFLD_RF_FE_RTRIM_RX
 = 
BIT_RNG
(2,4),

757 
	mFLD_RF_IF_FREQ
 = 
BIT_RNG
(5,6),

761 
	#ªg_rf_mode_cfg_tx1_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x22)

	)

764 
	mFLD_RF_BLE_MODE_TX
 = 
BIT
(0),

765 
	mFLD_RF_VCO_TRIM_KVM
 = 
BIT_RNG
(1,3),

766 
	mFLD_RF_HPMC_EXP_DIFF_COUNT_L
 = 
BIT_RNG
(4,7),

769 
	#ªg_rf_mode_cfg_tx1_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x23)

	)

772 
	mFLD_RF_HPMC_EXP_DIFF_COUNT_H
 = 
BIT_RNG
(0,4),

773 
	mFLD_RF_DAC_TRIM_CFBK
 = 
BIT_RNG
(5,6),

777 
	#ªg_rf_mode_cfg_txrx_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x26)

	)

780 
	mFLD_RF_DIS_CLK_DIG_O
 = 
BIT
(0),

781 
	mFLD_RF_VANT_PULLDN
 = 
BIT
(1),

782 
	mFLD_RF_GF_BT
 = 
BIT
(2),

783 
	mFLD_RF_LDO_ANT_TRIM
 = 
BIT_RNG
(3,5),

784 
	mFLD_RF_CBPF_TYPE
 = 
BIT
(6),

785 
	mFLD_RF_TX_PA_PWR_L
 = 
BIT
(7),

789 
	#ªg_rf_mode_cfg_txrx_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x27)

	)

793 
	mFLD_RF_TX_PA_PWR_H
 = 
BIT_RNG
(0,4),

796 
	#ªg_rf_bur°_cfg_txrx_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x28)

	)

799 
	mFLD_RF_CHNL_NUM
 = 
BIT_RNG
(0,7),

802 
	#ªg_rf_bur°_cfg_txrx_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x29)

	)

805 
	mFLD_RF_CH_NUMLL_SEL
 = 
BIT
(0),

806 
	mFLD_RF_TX_EN_PIF
 = 
BIT
(1),

807 
	mFLD_RF_RX_EN_PIF
 = 
BIT
(2),

808 
	mFLD_RF_RX_TIM_SRQ_SEL_TESQ
 = 
BIT
(3),

809 
	mFLD_RF_TX_TIM_SRQ_SEL_TESQ
 = 
BIT
(4),

810 
	mFLD_RF_FE_CTRIM
 = 
BIT_RNG
(5,7),

813 
	#ªg_rf_mode_cfg_tx3_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x3c)

	)

816 
	mFLD_RF_MODE_CFG_TX3
 = 
BIT_RNG
(0,5),

817 
	mFLD_RF_MODE_VANT_TX_BLE
 = 
BIT
(6),

818 
	mFLD_RF_TX_IQ_MODE_EN_BLE
 = 
BIT
(7),

823 
	#ªg_rf_mode_cfg_tx3_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x3d)

	)

826 
	mFLD_RF_LDO_ANT_TRIM_BLE
 = 
BIT_RNG
(0,2),

827 
	mFLD_RF_BT_BLE_SEL_EN
 = 
BIT
(3),

828 
	mFLD_RF_TXC_PWR_SRL
 = 
BIT
(4),

829 
	mFLD_RF_BW_CODE_BLE
 = 
BIT_RNG
(5,7),

833 
	#ªg_rf_txrx_dbg3_0
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x44)

	)

836 
	mFLD_RF_CHNL_FREQ_DIRECT
 = 
BIT
(0),

837 
	mFLD_RF_CHNL_FREQ_L
 = 
BIT_RNG
(1,7),

840 
	#ªg_rf_txrx_dbg3_1
 
	`REG_ADDR8
(
REG_TL_RADIO_BASE_ADDR
+0x45)

	)

843 
	mFLD_RF_CHNL_FREQ_H
 = 
BIT_RNG
(0,5),

844 
	mFLD_RF_DSN_DITHER_DISABLE
 = 
BIT
(6),

845 
	mFLD_RF_DSM_INT_MODE
 = 
BIT
(7),

	@platform/chip_b91/reg_include/soc.h

24 #¥agm®
⁄˚


26 
	~"../sys.h
"

28 
	#LM_BASE
 0x80000000

	)

30 
	#ILM_BASE
 (
LM_BASE
 + 0x40000000)

	)

31 
	#DLM_BASE
 (
LM_BASE
 + 0x40200000)

	)

32 
	#CPU_ILM_BASE
 (0x00000000)

	)

33 
	#CPU_DLM_BASE
 (0x00080000)

	)

35 
	#SC_BASE_ADDR
 0x1401c0

	)

37 
	#ªg_r°
 
	`REG_ADDR32
(0x1401e0)

	)

39 
	#ªg_r°0
 
	`REG_ADDR8
(0x1401e0)

	)

41 
	mFLD_RST0_HSPI
 = 
BIT
(0),

42 
	mFLD_RST0_I2C
 = 
BIT
(1),

43 
	mFLD_RST0_UART0
 = 
BIT
(2),

44 
	mFLD_RST0_USB
 = 
BIT
(3),

45 
	mFLD_RST0_PWM
 = 
BIT
(4),

47 
	mFLD_RST0_UART1
 = 
BIT
(6),

48 
	mFLD_RST0_SWIRE
 = 
BIT
(7),

52 
	#ªg_r°1
 
	`REG_ADDR8
(0x1401e1)

	)

55 
	mFLD_RST1_SYS_STIMER
 = 
BIT
(1),

56 
	mFLD_RST1_DMA
 = 
BIT
(2),

57 
	mFLD_RST1_ALGM
 = 
BIT
(3),

58 
	mFLD_RST1_PKE
 = 
BIT
(4),

60 
	mFLD_RST1_PSPI
 = 
BIT
(6),

61 
	mFLD_RST1_SPISLV
 = 
BIT
(7),

64 
	#ªg_r°2
 
	`REG_ADDR8
(0x1401e2)

	)

66 
	mFLD_RST2_TIMER
 = 
BIT
(0),

67 
	mFLD_RST2_AUD
 = 
BIT
(1),

68 
	mFLD_RST2_TRNG
 = 
BIT
(2),

70 
	mFLD_RST2_MCU
 = 
BIT
(4),

71 
	mFLD_RST2_LM
 = 
BIT
(5),

72 
	mFLD_RST2_NPE
 = 
BIT
(6),

76 
	#ªg_r°3
 
	`REG_ADDR8
(0x1401e3)

	)

78 
	mFLD_RST3_ZB
 = 
BIT
(0),

79 
	mFLD_RST3_MSTCLK
 = 
BIT
(1),

80 
	mFLD_RST3_LPCLK
 = 
BIT
(2),

81 
	mFLD_RST3_ZB_CRYPT
 = 
BIT
(3),

82 
	mFLD_RST3_MSPI
 = 
BIT
(4),

83 
	mFLD_RST3_CODEC
 = 
BIT
(5),

84 
	mFLD_RST3_SARADC
 = 
BIT
(6),

85 
	mFLD_RST3_ALG
 = 
BIT
(7),

88 
	#ªg_˛k_í
 
	`REG_ADDR32
(0x1401e4)

	)

90 
	#ªg_˛k_í0
 
	`REG_ADDR8
(0x1401e4)

	)

92 
	mFLD_CLK0_HSPI_EN
 = 
BIT
(0),

93 
	mFLD_CLK0_I2C_EN
 = 
BIT
(1),

94 
	mFLD_CLK0_UART0_EN
 = 
BIT
(2),

95 
	mFLD_CLK0_USB_EN
 = 
BIT
(3),

96 
	mFLD_CLK0_PWM_EN
 = 
BIT
(4),

97 
	mFLD_CLK0_UART1_EN
 = 
BIT
(6),

98 
	mFLD_CLK0_SWIRE_EN
 = 
BIT
(7),

101 
	#ªg_˛k_í1
 
	`REG_ADDR8
(0x1401e5)

	)

103 
	mFLD_CLK1_SYS_TIMER_EN
 = 
BIT
(1),

104 
	mFLD_CLK1_ALGM_EN
 = 
BIT
(3),

105 
	mFLD_CLK1_PKE_EN
 = 
BIT
(4),

106 
	mFLD_CLK1_MACHINETIME_EN
 = 
BIT
(5),

107 
	mFLD_CLK1_PSPI_EN
 = 
BIT
(6),

108 
	mFLD_CLK1_SPISLV_EN
 = 
BIT
(7),

112 
	#ªg_˛k_í2
 
	`REG_ADDR8
(0x1401e6)

	)

114 
	mFLD_CLK2_TIMER_EN
 = 
BIT
(0),

115 
	mFLD_CLK2_AUD_EN
 = 
BIT
(1),

116 
	mFLD_CLK2_TRNG_EN
 = 
BIT
(2),

117 
	mFLD_CLK2_MCU_EN
 = 
BIT
(4),

119 
	mFLD_CLK2_NPE_EN
 = 
BIT
(6),

120 
	mFLD_CLK2_EOC_EN
 = 
BIT
(7),

123 
	#ªg_˛k_í3
 
	`REG_ADDR8
(0x1401e7)

	)

125 
	mFLD_CLK3_ZB_PCLK_EN
 = 
BIT
(0),

126 
	mFLD_CLK3_ZB_MSTCLK_EN
 = 
BIT
(1),

127 
	mFLD_CLK3_ZB_LPCLK_EN
 = 
BIT
(2),

130 
	#ªg_˛k_£l0
 
	`REG_ADDR8
(0x1401e8)

	)

132 
	mFLD_CLK_SCLK_DIV
 = 
BIT_RNG
(0,3),

133 
	mFLD_CLK_SCLK_SEL
 = 
BIT_RNG
(4,6),

134 
	mFLD_CLK_MSPI_CLK_SEL
 = 
BIT
(7),

137 
	#ªg_˛k_£l1
 
	`REG_ADDR8
(0x1401e9)

	)

139 
	mFLD_CLK_MSPI_DIV
 = 
BIT_RNG
(4,7),

142 
	#ªg_i2s_°ï
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x2a)

	)

144 
	mFLD_I2S_STEP
 = 
BIT_RNG
(0,6),

145 
	mFLD_I2S_CLK_EN
 = 
BIT
(7),

148 
	#ªg_i2s_mod
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x2b)

	)

151 
	#ªg_dmic_°ï
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x2c)

	)

153 
	mFLD_DMIC_STEP
 = 
BIT_RNG
(0,6),

154 
	mFLD_DMIC_SEL
 = 
BIT
(7),

157 
	#ªg_dmic_mod
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x2d)

	)

159 
	#ªg_wakeup_í
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x2e)

	)

161 
	mFLD_USB_PWDN_I
 = 
BIT
(0),

162 
	mFLD_GPIO_WAKEUP_I
 = 
BIT
(1),

163 
	mFLD_USB_RESUME
 = 
BIT
(2),

164 
	mFLD_STANDBY_EX
 = 
BIT
(3),

167 
	#ªg_dmic_˛k_£t
 
	`REG_ADDR8
(
SC_BASE_ADDR
+0x33)

	)

170 
	#ªg_wakeup_°©us
 0x64

	)

172 
	mFLD_WKUP_CMP
 = 
BIT
(0),

173 
	mFLD_WKUP_TIMER
 = 
BIT
(1),

174 
	mFLD_WKUP_DIG
 = 
BIT
(2),

175 
	mFLD_WKUP_PAD
 = 
BIT
(3),

176 
	mFLD_WKUP_MDEC
 = 
BIT
(4),

177 
	mFLD_MDEC_RSVD
 = 
BIT_RNG
(5,7),

178 }
	twakeup_°©us_e
;

	@platform/chip_b91/reg_include/spi_reg.h

24 #i‚de‡
SPI_REG_H


25 
	#SPI_REG_H


	)

27 
	~"../sys.h
"

33 
	#HSPI_BASE_ADDR
 0x1FFFFC0

	)

34 
	#PSPI_BASE_ADDR
 0x140040

	)

35 
	#BASE_ADDR_DIFF
 0x1EBFF80

	)

37 
	#ªg_h•i_d©a_buf_adr
 0x1FFFFC8

	)

38 
	#ªg_h•i_xù_ba£_adr
 0x1000000

	)

39 
	#ªg_•i_d©a_buf_adr
(
i
Ë0x140048+(i)*
BASE_ADDR_DIFF


	)

53 
	#ªg_•i_mode0
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+(i)*
BASE_ADDR_DIFF
)

	)

55 
	mFLD_SPI_CS2SCLK
 = 
BIT_RNG
(0,1),

56 
	mFLD_SPI_3LINE
 = 
BIT
(2),

57 
	mFLD_SPI_LSB
 = 
BIT
(3),

58 
	mFLD_SPI_DUAL
 = 
BIT
(4),

59 
	mFLD_SPI_MODE_WORK_MODE
 = 
BIT_RNG
(5,6),

60 
	mFLD_SPI_MASTER_MODE
 = 
BIT
(7),

68 
	#ªg_•i_mode1
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x01+(i)*
BASE_ADDR_DIFF
)

	)

76 
	#ªg_•i_mode2
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x02+(i)*
BASE_ADDR_DIFF
)

	)

80 
	mFLD_HSPI_CMD_FMT
 =
BIT
(0),

81 
	mFLD_HSPI_QUAD
 =
BIT
(1),

82 
	mFLD_SPI_CMD_EN
 =
BIT
(2),

83 
	mFLD_SPI_HSPI_MODE2_RESERVED
 =
BIT
(3),

84 
	mFLD_SPI_CSHT
 =
BIT_RNG
(4,7),

90 
	#ªg_•i_tx_˙t0
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x03+(i)*
BASE_ADDR_DIFF
)

	)

96 
	#ªg_•i_tx_˙t1
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x12+(i)*(
BASE_ADDR_DIFF
-0x12+0x20))

	)

102 
	#ªg_•i_tx_˙t2
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x13+(i)*(
BASE_ADDR_DIFF
-0x13+0x21))

	)

107 
	#ªg_•i_rx_˙t0
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x04+(i)*
BASE_ADDR_DIFF
)

	)

113 
	#ªg_•i_rx_˙t1
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x10+(i)*(
BASE_ADDR_DIFF
-0x10+0x1e))

	)

118 
	#ªg_•i_rx_˙t2
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x11+(i)*(
BASE_ADDR_DIFF
-0x11+0x1f))

	)

138 
	#ªg_•i_å™s0
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x05+(i)*
BASE_ADDR_DIFF
)

	)

141 
	mFLD_SPI_DUMMY_CNT
 = 
BIT_RNG
(0,3),

142 
	mFLD_SPI_TRANSMODE
 =
BIT_RNG
(4,7),

151 
	#ªg_•i_å™s1
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x06+(i)*
BASE_ADDR_DIFF
)

	)

153 
	mFLD_SPI_CMD_RESERVED
 =
BIT
(0),

154 
	mFLD_SPI_CMD_TRANS_HWORD
 =
BIT
(1),

155 
	mFLD_SPI_CMD_TRANS_WORD
 =
BIT
(2),

156 
	mFLD_SPI_CMD_RD_DUMMY_4CYCLE
 =
BIT
(3),

157 
	mFLD_SPI_CMD_ADDR_AUTO_INCREASE
 =
BIT
(4),

158 
	mFLD_SPI_CMD_DATA_DUAL
 =
BIT
(5),

159 
	mFLD_SPI_CMD_ADDR_DUAL
 =
BIT
(6),

160 
	mFLD_SPI_CMD_RD_EN
 =
BIT
(7),

174 
	#ªg_•i_å™s2
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x07+(i)*
BASE_ADDR_DIFF
)

	)

176 
	mFLD_SPI_RXFIFO_OR_INT_EN
 =
BIT
(0),

177 
	mFLD_SPI_TXFIFO_UR_INT_EN
 =
BIT
(1),

178 
	mFLD_SPI_RXFIFO_INT_EN
 =
BIT
(2),

179 
	mFLD_SPI_TXFIFO_INT_EN
 =
BIT
(3),

180 
	mFLD_SPI_END_INT_EN
 =
BIT
(4),

181 
	mFLD_SPI_SLV_CMD_EN
 =
BIT
(5),

182 
	mFLD_SPI_RX_DMA_EN
 =
BIT
(6),

183 
	mFLD_SPI_TX_DMA_EN
 =
BIT
(7),

191 
	#ªg_•i_wr_rd_d©a0
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x08+(i)*
BASE_ADDR_DIFF
)

	)

196 
	#ªg_•i_wr_rd_d©a1
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x09+(i)*
BASE_ADDR_DIFF
)

	)

200 
	#ªg_•i_wr_rd_d©a2
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x0a+(i)*
BASE_ADDR_DIFF
)

	)

206 
	#ªg_•i_wr_rd_d©a3
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x0b+(i)*
BASE_ADDR_DIFF
)

	)

208 
	#ªg_•i_wr_rd_d©a
(
i
,
j
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x08+(j)+(i)*
BASE_ADDR_DIFF
)

	)

216 
	#ªg_•i_fifo_num
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x0c+(i)*
BASE_ADDR_DIFF
)

	)

219 
	mFLD_SPI_RXF_NUM
 = 
BIT_RNG
(0,3),

220 
	mFLD_SPI_TXF_NUM
 = 
BIT_RNG
(4,7),

231 
	#ªg_•i_fifo_°©e
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
+0x0d+(i)*
BASE_ADDR_DIFF
)

	)

234 
	mFLD_SPI_FIFO_STA_RESERVED
 = 
BIT_RNG
(0,1),

235 
	mFLD_SPI_RXF_CLR
 =
BIT
(2),

236 
	mFLD_SPI_TXF_CLR
 =
BIT
(3),

237 
	mFLD_SPI_RXF_FULL
 =
BIT
(4),

238 
	mFLD_SPI_RXF_EMPTY
 =
BIT
(5),

239 
	mFLD_SPI_TXF_FULL
 =
BIT
(6),

240 
	mFLD_SPI_TXF_EMPTY
 =
BIT
(7),

251 
	#ªg_•i_úq_°©e
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
 + 0x0ê+(i)*
BASE_ADDR_DIFF
)

	)

254 
	mFLD_SPI_STATE_RESERVED
 =
BIT_RNG
(0,1),

255 
	mFLD_SPI_RXF_OR_INT
 =
BIT
(2),

256 
	mFLD_SPI_TXF_UR_INT
 =
BIT
(3),

257 
	mFLD_SPI_RXF_INT
 =
BIT
(4),

258 
	mFLD_SPI_TXF_INT
 =
BIT
(5),

259 
	mFLD_SPI_END_INT
 =
BIT
(6),

260 
	mFLD_SPI_SLV_CMD_INT
 =
BIT
(7),

269 
	#ªg_•i_°©us
(
i
Ë
	`REG_ADDR8
(
PSPI_BASE_ADDR
 + 0x0‡+(i)*
BASE_ADDR_DIFF
)

	)

271 
	mFLD_HSPI_SLAVE_READY
 =
BIT
(0),

272 
	mFLD_HSPI_SOFT_RESET
 =
BIT
(1),

273 
	mFLD_HSPI_HSPI_STATUS_RESERVED
 =
BIT_RNG
(2,3),

274 
	mFLD_HSPI_FIFO_THRES
 =
BIT_RNG
(4,6),

275 
	mFLD_HSPI_BUSY
 =
BIT
(7),

281 
	#ªg_h•i_addr0
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x10)

	)

286 
	#ªg_h•i_addr1
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x11)

	)

291 
	#ªg_h•i_addr2
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x12)

	)

296 
	#ªg_h•i_addr3
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x13)

	)

298 
	#ªg_h•i_addr
(
i
Ë
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x10+i)

	)

302 
	#ªg_h•i_addr_32
 
	`REG_ADDR32
(
HSPI_BASE_ADDR
+0x10)

	)

315 
	#ªg_h•i_xù_˘æ
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x14)

	)

317 
	mFLD_HSPI_ADDR_EN
 = 
BIT
(0),

318 
	mFLD_HSPI_ADDR_FMT
 = 
BIT
(1),

319 
	mFLD_HSPI_ADDR_LEN
 = 
BIT_RNG
(2,3),

320 
	mFLD_HSPI_XIP_ENABLE
 = 
BIT
(4),

321 
	mFLD_HSPI_XIP_STOP
 = 
BIT
(5),

322 
	mFLD_HSPI_XIP_MODE
 = 
BIT
(6),

323 
	mFLD_HSPI_XIP_TIMEOUT_MODE
 = 
BIT
(7),

330 
	#ªg_h•i_xù_wr_cmd
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x15)

	)

335 
	#ªg_h•i_xù_rd_cmd
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x16)

	)

340 
	#ªg_h•i_∑ge_size
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x17)

	)

347 
	#ªg_h•i_xù_å™s_mode
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x18)

	)

349 
	mFLD_HSPI_XIP_WR_TRANS_MODE
 = 
BIT_RNG
(0,3),

350 
	mFLD_HSPI_XIP_RD_TRANS_MODE
 = 
BIT_RNG
(4,7),

356 
	#ªg_h•i_xù_addr_off£t0
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x19)

	)

361 
	#ªg_h•i_xù_addr_off£t1
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x1a)

	)

367 
	#ªg_h•i_xù_addr_off£t2
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x1b)

	)

372 
	#ªg_h•i_xù_addr_off£t3
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x1c)

	)

379 
	#ªg_h•i_xù_timeout_˙t
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x1d)

	)

385 
	#ªg_h•i_∑√l_˘æ
 
	`REG_ADDR8
(
HSPI_BASE_ADDR
+0x22)

	)

387 
	mFLD_HSPI_PANEL_3LINE_DCX_EN
 = 
BIT
(0),

388 
	mFLD_HSPI_PANEL_3LINE_DCX
 = 
BIT
(1),

389 
	mFLD_HSPI_PANEL_2DATA_LANE
 = 
BIT_RNG
(2,4),

	@platform/chip_b91/reg_include/stimer_reg.h

24 #i‚de‡
STIMER_REG_H_


25 
	#STIMER_REG_H_


	)

27 
	~"../sys.h
"

29 
	#STIMER_BASE_ADDR
 0x140200

	)

30 
	#ªg_sy°em_tick
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
)

	)

32 
	#ªg_sy°em_úq_Àvñ
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
+0x4)

	)

34 
	#ªg_sy°em_úq_mask
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x8)

	)

36 
	mFLD_SYSTEM_IRQ_MASK
 = 
BIT_RNG
(0,2),

37 
	mFLD_SYSTEM_TRIG_PAST_EN
 = 
BIT
(3),

40 
	#ªg_sy°em_ˇl_úq
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0x9)

	)

43 
	mFLD_SYSTEM_IRQ
 = 
BIT
(0),

44 
	mFLD_SYSTEM_32K_IRQ
 = 
BIT
(1),

45 }
	t°imî_úq_e
;

47 
	#ªg_sy°em_˘æ
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0xa)

	)

49 
	mFLD_SYSTEM_32K_WR_EN
 = 
BIT
(0),

50 
	mFLD_SYSTEM_TIMER_EN
 = 
BIT
(1),

51 
	mFLD_SYSTEM_TIMER_AUTO
 = 
BIT
(2),

52 
	mFLD_SYSTEM_32K_TRACK_EN
 = 
BIT
(3),

53 
	mFLD_SYSTEM_32K_CAL_MODE
 = 
BIT_RNG
(4,7),

57 
	#ªg_sy°em_°
 
	`REG_ADDR8
(
STIMER_BASE_ADDR
+0xb)

	)

61 
	mFLD_SYSTEM_CMD_STOP
 = 
BIT
(1),

62 
	mFLD_SYSTEM_CMD_SYNC
 = 
BIT
(3),

63 
	mFLD_SYSTEM_CLK_32K
 = 
BIT
(4),

64 
	mFLD_SYSTEM_CLR_RD_DONE
 = 
BIT
(5),

65 
	mFLD_SYSTEM_RD_BUSY
 = 
BIT
(6),

66 
	mFLD_SYSTEM_CMD_SET_DLY_DONE
 = 
BIT
(7),

70 
	#ªg_sy°em_timî_£t_32k
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
+0xc)

	)

72 
	#ªg_sy°em_timî_ªad_32k
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
+0x10)

	)

74 
	#ªg_sy°em_ˇl_œtch_32k
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
+0x14)

	)

76 
	#ªg_sy°em_up_32k
 
	`REG_ADDR32
(
STIMER_BASE_ADDR
+0x18)

	)

79 
	mFLD_SYSTEM_UPDATE_UPON_32K
 = 
BIT
(0),

80 
	mFLD_SYSTEM_RUN_UPON_NXT_32K
 = 
BIT
(1),

	@platform/chip_b91/reg_include/swire_reg.h

24 #i‚de‡
SWIRE_REG_H


25 
	#SWIRE_REG_H


	)

26 
	~"../sys.h
"

31 
	#SWIRE_BASE_ADDR
 0x100c00

	)

34 
	#ªg_swúe_d©a
 
	`REG_ADDR8
(
SWIRE_BASE_ADDR
)

	)

36 
	#ªg_swúe_˘l
 
	`REG_ADDR8
(
SWIRE_BASE_ADDR
+1)

	)

38 
	mFLD_SWIRE_WR
 = 
BIT
(0),

39 
	mFLD_SWIRE_RD
 = 
BIT
(1),

40 
	mFLD_SWIRE_CMD
 = 
BIT
(2),

41 
	mFLD_SWIRE_ERR_FLAG
 = 
BIT
(3),

44 
	mFLD_SWIRE_EOP
 = 
BIT
(4),

45 
	mFLD_SWIRE_USB_DET
 = 
BIT
(6),

46 
	mFLD_SWIRE_USB_EN
 = 
BIT
(7),

48 
	#ªg_swúe_˘l2
 
	`REG_ADDR8
(
SWIRE_BASE_ADDR
+2)

	)

50 
	mFLD_SWIRE_CLK_DIV
 = 
BIT_RNG
(0,6),

53 
	#ªg_swúe_id
 
	`REG_ADDR8
(
SWIRE_BASE_ADDR
+3)

	)

55 
	mFLD_SWIRE_ID_VALID
 = 
BIT_RNG
(0,4),

56 
	mFLD_SWIRE_FIFO_MODE
 = 
BIT
(7),

	@platform/chip_b91/reg_include/timer_reg.h

24 #i‚de‡
TIMER_REG_H


25 
	#TIMER_REG_H


	)

26 
	~"../sys.h
"

29 
	#ªg_tmr_˘æ0
 
	`REG_ADDR8
(0x140140)

	)

30 
	#ªg_tmr_˘æ16
 
	`REG_ADDR16
(0x140140)

	)

31 
	#ªg_tmr_˘æ32
 
	`REG_ADDR32
(0x140140)

	)

33 
	mFLD_TMR0_MODE
 = 
BIT_RNG
(0,1),

34 
	mFLD_TMR0_EN
 = 
BIT
(2),

35 
	mFLD_TMR0_NOWRAP
 = 
BIT
(3),

36 
	mFLD_TMR1_MODE
 = 
BIT_RNG
(4,5),

37 
	mFLD_TMR1_EN
 = 
BIT
(6),

38 
	mFLD_TMR1_NOWRAP
 = 
BIT
(7),

41 
	#ªg_tmr_˘æ2
 
	`REG_ADDR8
(0x140142)

	)

44 
	mFLD_TMR_WD_EN
 = 
BIT
(7),

47 
	#ªg_tmr_°a
 
	`REG_ADDR8
(0x140143)

	)

49 
	mFLD_TMR_STA_TMR0
 = 
BIT
(0),

50 
	mFLD_TMR_STA_TMR1
 = 
BIT
(1),

51 
	mFLD_TMR_STA_WD
 = 
BIT
(2),

52 
	mFLD_TMR_WD_CNT_CLR
 = 
BIT
(3),

53 
	mFLD_TMR_SW_IRQ
 = 
BIT
(7),

56 
	#ªg_tmr0_ˇ±
 
	`REG_ADDR32
(0x140144)

	)

57 
	#ªg_tmr1_ˇ±
 
	`REG_ADDR32
(0x140148)

	)

58 
	#ªg_tmr_ˇ±
(
i
Ë
	`REG_ADDR32
(0x140144 + ((iË<< 2))

	)

60 
	#ªg_wt_èrgë0
 
	`REG_ADDR8
(0x14014c)

61 
	#ªg_wt_èrgë1
 
	`REG_ADDR8
(0x14014d)

	)

62 
	#ªg_wt_èrgë2
 
	`REG_ADDR8
(0x14014e)

	)

63 
	#ªg_wt_èrgë3
 
	`REG_ADDR8
(0x14014f)

	)

64 
	#ªg_wt_èrgë
 
	`REG_ADDR32
(0x14014c)

	)

67 
	#ªg_tmr0_tick
 
	`REG_ADDR32
(0X140150)

	)

68 
	#ªg_tmr1_tick
 
	`REG_ADDR32
(0X140154)

	)

69 
	#ªg_tmr_tick
(
i
Ë
	`REG_ADDR32
(0X140150 + ((iË<< 2))

	)

	@platform/chip_b91/reg_include/trng_reg.h

24 #i‚de‡
TRNG_REG_H_


25 
	#TRNG_REG_H_


	)

28 
	#REG_TRNG_BASE
 0x101800

	)

31 
	#ªg_ång_¸0
 
	`REG_ADDR8
(
REG_TRNG_BASE
)

	)

33 
	mFLD_TRNG_CR0_RBGEN
 = 
BIT
(0),

34 
	mFLD_TRNG_CR0_ROSEN0
 = 
BIT
(1),

35 
	mFLD_TRNG_CR0_ROSEN1
 = 
BIT
(2),

36 
	mFLD_TRNG_CR0_ROSEN2
 = 
BIT
(3),

37 
	mFLD_TRNG_CR0_ROSEN3
 = 
BIT
(4),

40 
	#ªg_ång_π¸
 
	`REG_ADDR32
(
REG_TRNG_BASE
+0x04)

	)

42 
	mFLD_TRNG_RTCR_MSEL
 = 
BIT
(0),

45 
	#ªg_rbg_§
 
	`REG_ADDR8
(
REG_TRNG_BASE
+0x08)

	)

47 
	mFLD_RBG_SR_DRDY
 = 
BIT
(0),

50 
	#ªg_rbg_dr
 
	`REG_ADDR32
(
REG_TRNG_BASE
+0x0c)

	)

	@platform/chip_b91/reg_include/uart_reg.h

24 #i‚de‡
UART_REG_H


25 
	#UART_REG_H


	)

26 
	~"../sys.h
"

30 
	#ªg_u¨t_d©a_buf_adr
(
i
) (0x140080+(i)*0x40)

31 

	)

32 
	#ªg_u¨t_d©a_buf
(
i
,
j
Ë
	`REG_ADDR8
(
	`ªg_u¨t_d©a_buf_adr
(i)+(j))

33 
	#ªg_u¨t_d©a_hw‹d_buf
(
i
,
j
Ë
	`REG_ADDR16
(
	`ªg_u¨t_d©a_buf_adr
(i)+(j)*2)

	)

35 
	#ªg_u¨t_d©a_w‹d_buf
(
i
Ë
	`REG_ADDR32
(
	`ªg_u¨t_d©a_buf_adr
(i))

36 

	)

37 
	#ªg_u¨t_˛k_div
(
i
Ë
	`REG_ADDR16
(0x140084+(i)*0x40)

	)

40 
	mFLD_UART_CLK_DIV
 = 
BIT_RNG
(0,14),

41 
	mFLD_UART_CLK_DIV_EN
 = 
BIT
(15)

44 
	#ªg_u¨t_˘æ0
(
i
Ë
	`REG_ADDR8
(0x140086+(i)*0x40)

	)

47 
	mFLD_UART_BPWC_O
 = 
BIT_RNG
(0,3),

48 
	mFLD_UART_MASK_RX_IRQ
 = 
BIT
(6),

49 
	mFLD_UART_MASK_TX_IRQ
 = 
BIT
(7)

52 
	#ªg_u¨t_˘æ1
(
i
Ë
	`REG_ADDR8
(0x140087+(i)*0x40)

	)

55 
	mFLD_UART_TX_CTS_POLARITY
 = 
BIT
(0),

56 
	mFLD_UART_TX_CTS_ENABLE
 = 
BIT
(1),

57 
	mFLD_UART_PARITY_ENABLE
 = 
BIT
(2),

58 
	mFLD_UART_PARITY_POLARITY
 = 
BIT
(3),

59 
	mFLD_UART_STOP_SEL
 = 
BIT_RNG
(4,5),

60 
	mFLD_UART_TTL_ENABLE
 = 
BIT
(6),

61 
	mFLD_UART_LOOPBACK_O
 = 
BIT
(7),

65 
	#ªg_u¨t_˘æ2
(
i
Ë
	`REG_ADDR16
(0x140088+(i)*0x40)

	)

68 
	mFLD_UART_RTS_TRIQ_LEV
 = 
BIT_RNG
(0,3),

69 
	mFLD_UART_RTS_POLARITY
 = 
BIT
(4),

70 
	mFLD_UART_RTS_MANUAL_V
 = 
BIT
(5),

71 
	mFLD_UART_RTS_MANUAL_M
 = 
BIT
(6),

72 
	mFLD_UART_RTS_EN
 = 
BIT
(7),

75 
	#ªg_u¨t_˘æ3
(
i
Ë
	`REG_ADDR8
(0x140089+(i)*0x40)

	)

78 
	mFLD_UART_RX_IRQ_TRIQ_LEV
 = 
BIT_RNG
(0,3),

79 
	mFLD_UART_TX_IRQ_TRIQ_LEV
 = 
BIT_RNG
(4,7),

82 
	#ªg_u¨t_rx_timeout0
(
i
Ë
	`REG_ADDR8
(0x14008a+(i)*0x40)

	)

85 
	mFLD_UART_TIMEOUT_BW
 = 
BIT_RNG
(0,7),

88 
	#ªg_u¨t_rx_timeout1
(
i
Ë
	`REG_ADDR8
(0x14008b+0x40*(i))

	)

91 
	mFLD_UART_TIMEOUT_MUL
 = 
BIT_RNG
(0,1),

92 
	mFLD_UART_MARK_RXDONE
 = 
BIT
(2),

94 
	mFLD_UART_P7816_EN
 = 
BIT
(5),

95 
	mFLD_UART_MASK_TXDONE
 = 
BIT
(6),

96 
	mFLD_UART_MASK_ERR_IRQ
 = 
BIT
(7),

101 
	#ªg_u¨t_buf_˙t
(
i
Ë
	`REG_ADDR8
(0x14008c+(i)*0x40)

	)

103 
	mFLD_UART_RX_BUF_CNT
 = 
BIT_RNG
(0,3),

104 
	mFLD_UART_TX_BUF_CNT
 = 
BIT_RNG
(4,7),

107 
	#ªg_u¨t_°©us1
(
i
Ë
	`REG_ADDR8
(0x14008d+((i)*0x40))

	)

109 
	mFLD_UART_RBCNT
 = 
BIT_RNG
(0,2),

110 
	mFLD_UART_IRQ_O
 = 
BIT
(3),

111 
	mFLD_UART_WBCNT
 = 
BIT_RNG
(4,6),

112 
	mFLD_UART_CLEAR_RX
 = 
BIT
(6),

113 
	mFLD_UART_RX_ERR
 = 
BIT
(7),

114 
	mFLD_UART_CLEAR_TX
 = 
BIT
(7),

118 
	#ªg_u¨t_°©us2
(
i
Ë
	`REG_ADDR8
((0x14008eË+(0x40*(i)))

	)

120 
	mFLD_UART_TX_DONE
 = 
BIT
(0),

121 
	mFLD_UART_TX_BUF_IRQ
 = 
BIT
(1),

122 
	mFLD_UART_RX_DONE
 = 
BIT
(2),

123 
	mFLD_UART_RX_BUF_IRQ
 = 
BIT
(3),

127 
	#ªg_u¨t_°©e
(
i
Ë
	`REG_ADDR8
(0x14008f+0x40*(i))

	)

129 
	mFLD_UART_TSTATE_i
 = 
BIT_RNG
(0,2),

130 
	mFLD_UART_RSTATE_i
 = 
BIT_RNG
(4,7),

134 
	#ªg_7816_˛k_div
 
	`REG_ADDR8
(0x1401f0)

	)

136 
	mFLD_7816_CLK_DIV
 = 
BIT_RNG
(4,7),

	@platform/chip_b91/reg_include/usb_reg.h

24 #i‚de‡
USB_REG_H


25 
	#USB_REG_H


	)

26 
	~"../sys.h
"

29 
	#ªg_˘æ_ï_±r
 
	`REG_ADDR8
(0x100800)

	)

30 
	#ªg_˘æ_ï_d©
 
	`REG_ADDR8
(0x100801)

	)

31 
	#ªg_˘æ_ï_˘æ
 
	`REG_ADDR8
(0x100802)

	)

33 
	mFLD_EP_DAT_ACK
 = 
BIT
(0),

34 
	mFLD_EP_DAT_STALL
 = 
BIT
(1),

35 
	mFLD_EP_STA_ACK
 = 
BIT
(2),

36 
	mFLD_EP_STA_STALL
 = 
BIT
(3),

39 
	#ªg_˘æ_ï_úq_°a
 
	`REG_ADDR8
(0x100803)

	)

41 
	mFLD_CTRL_EP_IRQ_TRANS
 = 
BIT_RNG
(0,3),

42 
	mFLD_CTRL_EP_IRQ_SETUP
 = 
BIT
(4),

43 
	mFLD_CTRL_EP_IRQ_DATA
 = 
BIT
(5),

44 
	mFLD_CTRL_EP_IRQ_STA
 = 
BIT
(6),

45 
	mFLD_CTRL_EP_IRQ_INTF
 = 
BIT
(7),

48 
	#ªg_˘æ_ï_úq_mode
 
	`REG_ADDR8
(0x100804)

	)

50 
	mFLD_CTRL_EP_AUTO_ADDR
 = 
BIT
(0),

51 
	mFLD_CTRL_EP_AUTO_CFG
 = 
BIT
(1),

52 
	mFLD_CTRL_EP_AUTO_INTF
 = 
BIT
(2),

53 
	mFLD_CTRL_EP_AUTO_STA
 = 
BIT
(3),

54 
	mFLD_CTRL_EP_AUTO_SYN
 = 
BIT
(4),

55 
	mFLD_CTRL_EP_AUTO_DESC
 = 
BIT
(5),

56 
	mFLD_CTRL_EP_AUTO_FEAT
 = 
BIT
(6),

57 
	mFLD_CTRL_EP_AUTO_STD
 = 
BIT
(7),

60 
	#ªg_usb_˘æ
 
	`REG_ADDR8
(0x100805)

	)

62 
	mFLD_USB_CTRL_AUTO_CLK
 = 
BIT
(0),

63 
	mFLD_USB_CTRL_LOW_SPD
 = 
BIT
(1),

64 
	mFLD_USB_CTRL_LOW_JITT
 = 
BIT
(2),

65 
	mFLD_USB_CTRL_TST_MODE
 = 
BIT
(3),

68 
	#ªg_usb_cy˛_ˇli
 
	`REG_ADDR16
(0x100806)

	)

69 
	#ªg_usb_cych_ˇli
 
	`REG_ADDR16
(0x100807)

	)

70 
	#ªg_usb_mdev
 
	`REG_ADDR8
(0x10080a)

	)

72 
	mFLD_USB_MDEV_SELF_PWR
 = 
BIT
(0),

73 
	mFLD_USB_MDEV_SUSP_STA
 = 
BIT
(1),

74 
	mFLD_USB_MDEV_WAKE_FEA
 = 
BIT
(2),

75 
	mFLD_USB_MDEV_VEND_CMD
 = 
BIT
(3),

76 
	mFLD_USB_MDEV_VEND_DIS
 = 
BIT
(4),

79 
	#ªg_usb_ho°_c⁄n
 
	`REG_ADDR8
(0x10080b)

	)

80 
	#ªg_usb_sups_cyc_ˇli
 
	`REG_ADDR8
(0x10080c)

	)

81 
	#ªg_usb_ötf_Æt
 
	`REG_ADDR8
(0x10080d)

	)

82 
	#ªg_usb_edp_í
 
	`REG_ADDR8
(0x10080e)

	)

84 
	mFLD_USB_EDP8_EN
 = 
BIT
(0),

85 
	mFLD_USB_EDP1_EN
 = 
BIT
(1),

86 
	mFLD_USB_EDP2_EN
 = 
BIT
(2),

87 
	mFLD_USB_EDP3_EN
 = 
BIT
(3),

88 
	mFLD_USB_EDP4_EN
 = 
BIT
(4),

89 
	mFLD_USB_EDP5_EN
 = 
BIT
(5),

90 
	mFLD_USB_EDP6_EN
 = 
BIT
(6),

91 
	mFLD_USB_EDP7_EN
 = 
BIT
(7),

92 }
	tusb_ï_í_e
;

94 
	#ªg_usb_úq_mask
 
	`REG_ADDR8
(0x10080f)

	)

96 
	mFLD_USB_IRQ_RESET_MASK
 = 
BIT
(0),

97 
	mFLD_USB_IRQ_250US_MASK
 = 
BIT
(1),

98 
	mFLD_USB_IRQ_SUSPEND_MASK
 = 
BIT
(2),

99 
	mFLD_USB_IRQ_RESET_LVL
 = 
BIT
(3),

100 
	mFLD_USB_IRQ_250US_LVL
 = 
BIT
(4),

101 
	mFLD_USB_IRQ_RESET_O
 = 
BIT
(5),

102 
	mFLD_USB_IRQ_250US_O
 = 
BIT
(6),

103 
	mFLD_USB_IRQ_SUSPEND_O
 = 
BIT
(7),

106 
	#ªg_usb_ï8123_±r
 
	`REG_ADDR32
(0x100810)

	)

107 
	#ªg_usb_ï8_±r
 
	`REG_ADDR8
(0x100810)

	)

108 
	#ªg_usb_ï1_±r
 
	`REG_ADDR8
(0x100811)

	)

109 
	#ªg_usb_ï2_±r
 
	`REG_ADDR8
(0x100812)

	)

110 
	#ªg_usb_ï3_±r
 
	`REG_ADDR8
(0x100813)

	)

111 
	#ªg_usb_ï4567_±r
 
	`REG_ADDR32
(0x100814)

	)

112 
	#ªg_usb_ï4_±r
 
	`REG_ADDR8
(0x100814)

	)

113 
	#ªg_usb_ï5_±r
 
	`REG_ADDR8
(0x100815)

	)

114 
	#ªg_usb_ï6_±r
 
	`REG_ADDR8
(0x100816)

	)

115 
	#ªg_usb_ï7_±r
 
	`REG_ADDR8
(0x100817)

	)

116 
	#ªg_usb_ï_±r
(
i
Ë
	`REG_ADDR8
(0x100810+((iË& 0x07))

	)

118 
	#ªg_usb_ï8123_d©
 
	`REG_ADDR32
(0x100818)

	)

119 
	#ªg_usb_ï8_d©
 
	`REG_ADDR8
(0x100818)

	)

120 
	#ªg_usb_ï1_d©
 
	`REG_ADDR8
(0x100819)

	)

121 
	#ªg_usb_ï2_d©
 
	`REG_ADDR8
(0x10081a)

	)

122 
	#ªg_usb_ï3_d©
 
	`REG_ADDR8
(0x10081b)

	)

123 
	#ªg_usb_ï4567_d©
 
	`REG_ADDR32
(0x10081c)

	)

124 
	#ªg_usb_ï4_d©
 
	`REG_ADDR8
(0x10081c)

	)

125 
	#ªg_usb_ï5_d©
 
	`REG_ADDR8
(0x10081d)

	)

126 
	#ªg_usb_ï6_d©
 
	`REG_ADDR8
(0x10081e)

	)

127 
	#ªg_usb_ï7_d©
 
	`REG_ADDR8
(0x10081f)

	)

128 
	#ªg_usb_ï_d©
(
i
Ë
	`REG_ADDR8
(0x100818+((iË& 0x07))

	)

130 
	#ªg_usb_ï8_˘æ
 
	`REG_ADDR8
(0x100820)

	)

131 
	#ªg_usb_ï1_˘æ
 
	`REG_ADDR8
(0x100821)

	)

132 
	#ªg_usb_ï2_˘æ
 
	`REG_ADDR8
(0x100822)

	)

133 
	#ªg_usb_ï3_˘æ
 
	`REG_ADDR8
(0x100823)

	)

134 
	#ªg_usb_ï4_˘æ
 
	`REG_ADDR8
(0x100824)

	)

135 
	#ªg_usb_ï5_˘æ
 
	`REG_ADDR8
(0x100825)

	)

136 
	#ªg_usb_ï6_˘æ
 
	`REG_ADDR8
(0x100826)

	)

137 
	#ªg_usb_ï7_˘æ
 
	`REG_ADDR8
(0x100827)

	)

138 
	#ªg_usb_ï_˘æ
(
i
Ë
	`REG_ADDR8
(0x100820+((iË& 0x07))

	)

141 
	mFLD_USB_EP_BUSY
 = 
BIT
(0),

142 
	mFLD_USB_EP_STALL
 = 
BIT
(1),

143 
	mFLD_USB_EP_DAT0
 = 
BIT
(2),

144 
	mFLD_USB_EP_DAT1
 = 
BIT
(3),

145 
	mFLD_USB_EP_MONO
 = 
BIT
(6),

146 
	mFLD_USB_EP_EOF_ISO
 = 
BIT
(7),

149 
	#ªg_usb_ï8123_buf_addr
 
	`REG_ADDR32
(0x100828)

	)

150 
	#ªg_usb_ï8_buf_addr
 
	`REG_ADDR8
(0x100828)

	)

151 
	#ªg_usb_ï1_buf_addr
 
	`REG_ADDR8
(0x100829)

	)

152 
	#ªg_usb_ï2_buf_addr
 
	`REG_ADDR8
(0x10082a)

	)

153 
	#ªg_usb_ï3_buf_addr
 
	`REG_ADDR8
(0x10082b)

	)

154 
	#ªg_usb_ï4567_buf_addr
 
	`REG_ADDR32
(0x10082c)

	)

155 
	#ªg_usb_ï4_buf_addr
 
	`REG_ADDR8
(0x10082c)

	)

156 
	#ªg_usb_ï5_buf_addr
 
	`REG_ADDR8
(0x10082d)

	)

157 
	#ªg_usb_ï6_buf_addr
 
	`REG_ADDR8
(0x10082e)

	)

158 
	#ªg_usb_ï7_buf_addr
 
	`REG_ADDR8
(0x10082f)

	)

159 
	#ªg_usb_ï_buf_addr
(
i
Ë
	`REG_ADDR8
(0x100828+((iË& 0x07))

	)

162 
	#ªg_usb_øm_˘æ
 
	`REG_ADDR8
(0x100830)

	)

165 
	mFLD_USB_CEN_PWR_DN
 = 
BIT
(0),

166 
	mFLD_USB_CLK_PWR_DN
 = 
BIT
(1),

167 
	mFLD_USB_WEN_PWR_DN
 = 
BIT
(3),

168 
	mFLD_USB_CEN_FUNC
 = 
BIT
(4),

171 
	#ªg_usb_iso_mode
 
	`REG_ADDR8
(0x100838)

	)

173 
	#ªg_usb_ï_úq_°©us
 
	`REG_ADDR8
(0x100839)

	)

174 
	#ªg_usb_ï_úq_mask
 
	`REG_ADDR8
(0x10083a)

	)

176 
	mFLD_USB_EDP8_IRQ
 = 
BIT
(0),

177 
	mFLD_USB_EDP1_IRQ
 = 
BIT
(1),

178 
	mFLD_USB_EDP2_IRQ
 = 
BIT
(2),

179 
	mFLD_USB_EDP3_IRQ
 = 
BIT
(3),

180 
	mFLD_USB_EDP4_IRQ
 = 
BIT
(4),

181 
	mFLD_USB_EDP5_IRQ
 = 
BIT
(5),

182 
	mFLD_USB_EDP6_IRQ
 = 
BIT
(6),

183 
	mFLD_USB_EDP7_IRQ
 = 
BIT
(7),

184 }
	tusb_ï_úq_e
 ;

187 
	#ªg_usb_ï8_£nd_max
 
	`REG_ADDR8
(0x10083b)

	)

188 
	#ªg_usb_ï8_£nd_thª
 
	`REG_ADDR8
(0x10083c)

	)

189 
	#ªg_usb_ï8_fifo_mode
 
	`REG_ADDR8
(0x10083d)

	)

191 
	mFLD_USB_ENP8_FIFO_MODE
 = 
BIT
(0),

192 
	mFLD_USB_ENP8_FULL_FLAG
 = 
BIT
(1),

195 
	#ªg_usb_ï_max_size
 
	`REG_ADDR8
(0x10083e)

	)

196 
	#ªg_usb_ï_tick
 
	`REG_ADDR8
(0x10083f)

	)

198 
	#ªg_usb_mic_d©0
 
	`REG_ADDR16
(0x1800)

	)

199 
	#ªg_usb_mic_d©1
 
	`REG_ADDR16
(0x1802)

	)

	@platform/chip_b91/rf.h

24 #i‚de‡ 
RF_H


25 
	#RF_H


	)

27 
	~"gpio.h
"

28 
	~"sys.h
"

36 
	#rf_tx_∑ckë_dma_Àn
(
rf_d©a_Àn
Ë((‘f_d©a_Àn)+3)/4)|((‘f_d©a_ÀnË% 4)<<22)

	)

42 
	#RF_BLE_DMA_RFRX_LEN_HW_INFO
 0

	)

43 
	#RF_BLE_DMA_RFRX_OFFSET_HEADER
 4

	)

44 
	#RF_BLE_DMA_RFRX_OFFSET_RFLEN
 5

	)

45 
	#RF_BLE_DMA_RFRX_OFFSET_DATA
 6

	)

50 
	#rf_bÀ_dma_rx_off£t_¸c24
(
p
Ë’[
RF_BLE_DMA_RFRX_OFFSET_RFLEN
]+6)

51 
	#rf_bÀ_dma_rx_off£t_time_°amp
(
p
Ë’[
RF_BLE_DMA_RFRX_OFFSET_RFLEN
]+9)

52 
	#rf_bÀ_dma_rx_off£t_‰eq_off£t
(
p
Ë’[
RF_BLE_DMA_RFRX_OFFSET_RFLEN
]+13)

53 
	#rf_bÀ_dma_rx_off£t_rssi
(
p
Ë’[
RF_BLE_DMA_RFRX_OFFSET_RFLEN
]+15)

54 
	#rf_bÀ_∑ckë_Àngth_ok
(
p
Ë’[5] <
ªg_rf_rxtmaxÀn
)

55 
	#rf_bÀ_∑ckë_¸c_ok
(
p
Ë(’[’[5]+5 + 11)] & 0x01Ë=0x0)

	)

61 
	#RF_RX_SHORT_MODE_EN
 1

62 

	)

68 
	#RF_PRI_ESB_DMA_RFRX_OFFSET_RFLEN
 4

	)

74 
	#rf_¥i_esb_dma_rx_off£t_¸c
(
p
Ë’[
RF_PRI_ESB_DMA_RFRX_OFFSET_RFLEN
]+5)

75 
	#rf_¥i_esb_dma_rx_off£t_time_°amp
(
p
Ë’[
RF_PRI_ESB_DMA_RFRX_OFFSET_RFLEN
]+7)

76 
	#rf_¥i_esb_dma_rx_off£t_‰eq_off£t
(
p
Ë’[
RF_PRI_ESB_DMA_RFRX_OFFSET_RFLEN
]+11)

77 
	#rf_¥i_esb_dma_rx_off£t_rssi
(
p
Ë’[
RF_PRI_ESB_DMA_RFRX_OFFSET_RFLEN
]+13)

78 
	#rf_¥i_esb_∑ckë_¸c_ok
(
p
Ë(’[(’[4] & 0x3fË+ 11+3)] & 0x01Ë=0x00)

	)

87 
	#RF_ZIGBEE_DMA_RFRX_OFFSET_RFLEN
 4

	)

94 
	#rf_zigbì_dma_rx_off£t_¸c
(
p
Ë’[
RF_ZIGBEE_DMA_RFRX_OFFSET_RFLEN
]+3)

95 
	#rf_zigbì_dma_rx_off£t_time_°amp
(
p
Ë’[
RF_ZIGBEE_DMA_RFRX_OFFSET_RFLEN
]+5)

96 
	#rf_zigbì_dma_rx_off£t_‰eq_off£t
(
p
Ë’[
RF_ZIGBEE_DMA_RFRX_OFFSET_RFLEN
]+9)

97 
	#rf_zigbì_dma_rx_off£t_rssi
(
p
Ë’[
RF_ZIGBEE_DMA_RFRX_OFFSET_RFLEN
]+11)

98 
	#rf_zigbì_∑ckë_¸c_ok
(
p
Ë(’[’[4]+9+3)] & 0x51Ë=0x0)

	)

99 
	#rf_zigbì_gë_∑ylﬂd_Àn
(
p
Ë’[4])

	)

100 
	#rf_zigbì_∑ckë_Àngth_ok
(
p
Ë(1)

	)

104 
	#rf_¥i_sb_∑ckë_¸c_ok
(
p
Ë(’[(
ªg_rf_sbÀn
 & 0x3f)+4+9] & 0x01Ë=0x00)

	)

105 
	#rf_hybì_∑ckë_¸c_ok
(
p
Ë(’[’[4]+9+3)] & 0x51Ë=0x0)

	)

107 
	#rf_™t_∑ckë_¸c_ok
(
p
Ë(’[(
ªg_rf_sbÀn
 & 0x3f)+4+9] & 0x01Ë=0x00)

	)

117 
	mRF_MODE_TX
 = 0,

118 
	mRF_MODE_RX
 = 1,

119 
	mRF_MODE_AUTO
=2,

120 
	mRF_MODE_OFF
 =3

121 } 
	trf_°©us_e
;

128 
	mRF_RFFE_RX_PB1
 = 
GPIO_PB1
,

129 
	mRF_RFFE_RX_PD6
 = 
GPIO_PD6
,

130 
	mRF_RFFE_RX_PE4
 = 
GPIO_PE4


131 } 
	trf_ a_rx_pö_e
;

135 
	mRF_RFFE_TX_PB0
 = 
GPIO_PB0
,

136 
	mRF_RFFE_TX_PB6
 = 
GPIO_PB6
,

137 
	mRF_RFFE_TX_PD7
 = 
GPIO_PD7
,

138 
	mRF_RFFE_TX_PE5
 = 
GPIO_PE5


139 } 
	trf_∑_tx_pö_e
;

146 
	mRF_POWER_P9p11dBm
 = 63,

147 
	mRF_POWER_P8p57dBm
 = 45,

148 
	mRF_POWER_P8p05dBm
 = 35,

149 
	mRF_POWER_P7p45dBm
 = 27,

150 
	mRF_POWER_P6p98dBm
 = 23,

151 
	mRF_POWER_P5p68dBm
 = 18,

153 
	mRF_POWER_P4p35dBm
 = 
BIT
(7) | 63,

154 
	mRF_POWER_P3p83dBm
 = 
BIT
(7) | 50,

155 
	mRF_POWER_P3p25dBm
 = 
BIT
(7) | 41,

156 
	mRF_POWER_P2p79dBm
 = 
BIT
(7) | 36,

157 
	mRF_POWER_P2p32dBm
 = 
BIT
(7) | 32,

158 
	mRF_POWER_P1p72dBm
 = 
BIT
(7) | 26,

159 
	mRF_POWER_P0p80dBm
 = 
BIT
(7) | 22,

160 
	mRF_POWER_P0p01dBm
 = 
BIT
(7) | 20,

161 
	mRF_POWER_N0p53dBm
 = 
BIT
(7) | 18,

162 
	mRF_POWER_N1p37dBm
 = 
BIT
(7) | 16,

163 
	mRF_POWER_N2p01dBm
 = 
BIT
(7) | 14,

164 
	mRF_POWER_N3p37dBm
 = 
BIT
(7) | 12,

165 
	mRF_POWER_N4p77dBm
 = 
BIT
(7) | 10,

166 
	mRF_POWER_N6p54dBm
 = 
BIT
(7) | 8,

167 
	mRF_POWER_N8p78dBm
 = 
BIT
(7) | 6,

168 
	mRF_POWER_N12p06dBm
 = 
BIT
(7) | 4,

169 
	mRF_POWER_N17p83dBm
 = 
BIT
(7) | 2,

170 
	mRF_POWER_N23p54dBm
 = 
BIT
(7) | 1,

172 
	mRF_POWER_N30dBm
 = 0xff,

173 
	mRF_POWER_N50dBm
 = 
BIT
(7) | 0,

175 } 
	trf_powî_Àvñ_e
;

182 
	mRF_POWER_INDEX_P9p11dBm
,

183 
	mRF_POWER_INDEX_P8p57dBm
,

184 
	mRF_POWER_INDEX_P8p05dBm
,

185 
	mRF_POWER_INDEX_P7p45dBm
,

186 
	mRF_POWER_INDEX_P6p98dBm
,

187 
	mRF_POWER_INDEX_P5p68dBm
,

189 
	mRF_POWER_INDEX_P4p35dBm
,

190 
	mRF_POWER_INDEX_P3p83dBm
,

191 
	mRF_POWER_INDEX_P3p25dBm
,

192 
	mRF_POWER_INDEX_P2p79dBm
,

193 
	mRF_POWER_INDEX_P2p32dBm
,

194 
	mRF_POWER_INDEX_P1p72dBm
,

195 
	mRF_POWER_INDEX_P0p80dBm
,

196 
	mRF_POWER_INDEX_P0p01dBm
,

197 
	mRF_POWER_INDEX_N0p53dBm
,

198 
	mRF_POWER_INDEX_N1p37dBm
,

199 
	mRF_POWER_INDEX_N2p01dBm
,

200 
	mRF_POWER_INDEX_N3p37dBm
,

201 
	mRF_POWER_INDEX_N4p77dBm
,

202 
	mRF_POWER_INDEX_N6p54dBm
,

203 
	mRF_POWER_INDEX_N8p78dBm
,

204 
	mRF_POWER_INDEX_N12p06dBm
,

205 
	mRF_POWER_INDEX_N17p83dBm
,

206 
	mRF_POWER_INDEX_N23p54dBm
,

207 } 
	trf_powî_Àvñ_ödex_e
;

215 
	mRF_MODE_BLE_2M
 = 
BIT
(0),

216 
	mRF_MODE_BLE_1M
 = 
BIT
(1),

217 
	mRF_MODE_BLE_1M_NO_PN
 = 
BIT
(2),

218 
	mRF_MODE_ZIGBEE_250K
 = 
BIT
(3),

219 
	mRF_MODE_LR_S2_500K
 = 
BIT
(4),

220 
	mRF_MODE_LR_S8_125K
 = 
BIT
(5),

221 
	mRF_MODE_PRIVATE_250K
 = 
BIT
(6),

222 
	mRF_MODE_PRIVATE_500K
 = 
BIT
(7),

223 
	mRF_MODE_PRIVATE_1M
 = 
BIT
(8),

224 
	mRF_MODE_PRIVATE_2M
 = 
BIT
(9),

225 
	mRF_MODE_ANT
 = 
BIT
(10),

226 
	mRF_MODE_BLE_2M_NO_PN
 = 
BIT
(11),

227 
	mRF_MODE_HYBEE_1M
 = 
BIT
(12),

228 
	mRF_MODE_HYBEE_2M
 = 
BIT
(13),

229 
	mRF_MODE_HYBEE_500K
 = 
BIT
(14),

230 } 
	trf_mode_e
;

238 
	mRF_CHANNEL_0
 = 
BIT
(0),

239 
	mRF_CHANNEL_1
 = 
BIT
(1),

240 
	mRF_CHANNEL_2
 = 
BIT
(2),

241 
	mRF_CHANNEL_3
 = 
BIT
(3),

242 
	mRF_CHANNEL_4
 = 
BIT
(4),

243 
	mRF_CHANNEL_5
 = 
BIT
(5),

244 
	mRF_CHANNEL_NONE
 = 0x00,

245 
	mRF_CHANNEL_ALL
 = 0x0f,

246 } 
	trf_ch™√l_e
;

251 c⁄° 
rf_powî_Àvñ_e
 
rf_powî_Levñ_li°
[30];

264 
ölöe
 
	$rf_ª˚ivög_Êag
()

267  ((
	`ªad_ªg8
(0x140840)&0x07) > 1);

268 
	}
}

276 
ölöe
 
	$rf_gë_°©e_machöe_°©us
(
°©e_machöe_°©us_e
 
°©us
)

278  
°©us
 =
	`ªad_ªg8
(0x140a24);

279 
	}
}

285 
ölöe
 
	$rf_£t_úq_mask
(
rf_úq_e
 
mask
)

287 
	`BM_SET
(
ªg_rf_úq_mask
,
mask
);

288 
	}
}

296 
ölöe
 
	$rf_˛r_úq_mask
(
rf_úq_e
 
mask
)

298 
	`BM_CLR
(
ªg_rf_úq_mask
,
mask
);

299 
	}
}

307 
ölöe
 
	$rf_gë_úq_°©us
(
rf_úq_e
 
°©us
)

309  (()
	`BM_IS_SET
(
ªg_rf_úq_°©us
,
°©us
));

310 
	}
}

321 
ölöe
 
	$rf_˛r_úq_°©us
(
rf_úq_e
 
°©us
)

323 
ªg_rf_úq_°©us
 = 
°©us
;

324 
	}
}

333 
ölöe
 
	$rf_tx_£âÀ_us
(
tx°l_us
)

335 
	`REG_ADDR16
(0x80140a04Ë
tx°l_us
;

336 
	}
}

344 
ölöe
 
	$rf_ac˚ss_code_comm
 (
acc
)

346 
ªg_rf_ac˚ss_code
 = 
acc
;

348 
	`wrôe_ªg8
(0x140c25,
	`ªad_ªg8
(0x140c25)|0x01);

349 
	}
}

362 
ölöe
 
	$rf_rx_acc_code_pùe_í
(
rf_ch™√l_e
 
pùe
)

364 
	`wrôe_ªg8
(0x140c4d, (
	`ªad_ªg8
(0x140c4d)&0xc0Ë| 
pùe
);

365 
	}
}

378 
ölöe
 
	$rf_tx_acc_code_pùe_í
(
rf_ch™√l_e
 
pùe
)

380 
	`wrôe_ªg8
(0x140a15, (
	`ªad_ªg8
(0x140a15)&0xf8Ë| 
pùe
);

381 
	}
}

388 
ölöe
 
	$rf_£t_tx_rx_off
()

390 
	`wrôe_ªg8
 (0x80140a16, 0x29);

391 
	`wrôe_ªg8
 (0x80140828, 0x80);

392 
	`wrôe_ªg8
 (0x80140a02, 0x45);

393 
	}
}

400 
ölöe
 
	$rf_£t_tx_rx_off_auto_mode
()

402 
	`wrôe_ªg8
 (0x80140a00, 0x80);

403 
	}
}

410 
ölöe
 
	$rf_£t_bÀ_¸c_adv
 ()

412 
	`wrôe_ªg32
 (0x80140824, 0x555555);

413 
	}
}

421 
ölöe
 
	$rf_£t_bÀ_¸c_vÆue
 (
¸c
)

423 
	`wrôe_ªg32
 (0x80140824, 
¸c
);

424 
	}
}

433 
ölöe
 
	$rf_£t_rx_maxÀn
(
byã_Àn
)

435 
ªg_rf_rxtmaxÀn
 = 
byã_Àn
;

436 
	}
}

444 
ölöe
 
	$rf_£t_rx_dma_fifo_size
(
fifo_byã_size
)

446 
ªg_rf_bb_rx_size
 = 
fifo_byã_size
>>4;

447 
	}
}

453 
ölöe
 
	$rf_£t_rx_dma_fifo_num
(
fifo_num
)

455 
ªg_rf_rx_w±r_mask
 = 
fifo_num
;

456 
	}
}

467 
ölöe
 
	$rf_£t_rx_buf„r
(*
rx_addr
)

469 
rx_addr
 += 4;

470 
	`dma_£t_d°_addªss
(
DMA1
,
	`c⁄vît_øm_addr_˝u2bus
(
rx_addr
));

471 
	}
}

477 
ölöe
 
	$rf_£t_tx_dma_fifo_num
(
fifo_num
)

479 
ªg_rf_bb_tx_chn_dï
 = 
fifo_num
;

480 
	}
}

487 
ölöe
 
	$rf_£t_tx_dma_fifo_size
(
fifo_byã_size
)

489 
ªg_rf_bb_tx_size
 = 
fifo_byã_size
>>4;

490 
	}
}

496 
ölöe
 
	$rf_£t_tx_£âÀ_time
(
tx_°l_us
 )

498 
tx_°l_us
 &= 0x0fff;

499 
	`wrôe_ªg8
(0x140a04, (
	`ªad_ªg8
(0x140a04)& 0xf000Ë|
tx_°l_us
);

500 
	}
}

506 
ölöe
 
	$rf_£t_rx_£âÀ_time
–
rx_°l_us
 )

508 
rx_°l_us
 &= 0x0fff;

509 
	`wrôe_ªg8
(0x140a0c, (
	`ªad_ªg8
(0x140a0c)& 0xf000Ë|
rx_°l_us
);

510 
	}
}

517 
ölöe
 
	$rf_gë_tx_w±r
(
pùe_id
)

519  
	`ªg_rf_dma_tx_w±r
(
pùe_id
);

520 
	}
}

528 
ölöe
 
	$rf_£t_tx_w±r
(
pùe_id
,
w±r
)

530 
	`ªg_rf_dma_tx_w±r
(
pùe_id
Ë
w±r
;

531 
	}
}

539 
ölöe
 
	$rf_˛r_tx_w±r
(
pùe_id
)

541 
	`ªg_rf_dma_tx_w±r
(
pùe_id
) = 0;

542 
	}
}

549 
ölöe
 
	$rf_gë_tx_Ωå
(
pùe_id
)

551  
	`ªg_rf_dma_tx_Ωå
(
pùe_id
);

552 
	}
}

560 
ölöe
 
	$rf_˛r_tx_Ωå
(
pùe_id
)

562 
	`ªg_rf_dma_tx_Ωå
(
pùe_id
) = 0x80;

563 
	}
}

569 
ölöe
 
	$rf_gë_rx_Ωå
()

571  
ªg_rf_dma_rx_Ωå
;

572 
	}
}

578 
ölöe
 
	$rf_˛r_rx_Ωå
()

580 
	`wrôe_ªg8
(0x1004f5, 0x80);

581 
	}
}

588 
ölöe
 
	$rf_gë_rx_w±r
()

590  
ªg_rf_dma_rx_w±r
;

591 
	}
}

598 
ölöe
 
	$rf_gë_±x_pid
()

600  ((
ªg_rf_Œ_˘æ_1
 & 0xc0)>>6);

601 
	}
}

609 
ölöe
 
	$rf_£t_±x_pid
(
pùe_pid
)

611 
ªg_rf_Œ_˘æ_1
 |(
pùe_pid
 << 6);

612 
	}
}

619 
rf_mode_öô
();

626 
rf_£t_bÀ_1M_mode
();

633 
rf_£t_bÀ_1M_NO_PN_mode
();

640 
rf_£t_bÀ_2M_mode
();

647 
rf_£t_bÀ_2M_NO_PN_mode
();

654 
rf_£t_bÀ_500K_mode
();

661 
rf_£t_bÀ_125K_mode
();

668 
rf_£t_zigbì_250K_mode
();

675 
rf_£t_¥i_250K_mode
();

682 
rf_£t_¥i_500K_mode
();

689 
rf_£t_¥i_1M_mode
();

696 
rf_£t_¥i_2M_mode
();

703 
rf_£t_hybì_500K_mode
();

710 
rf_£t_hybì_2M_mode
();

717 
rf_£t_hybì_1M_mode
();

727 
rf_£t_™t_mode
();

734 
rf_£t_tx_dma_c⁄fig
();

741 
rf_£t_tx_dma
(
fifo_dïth
,
fifo_byã_size
);

751 
rf_£t_rx_dma
(*
buff
,
w±r_mask
,
fifo_byã_size
);

758 
rf_£t_rx_dma_c⁄fig
();

765 
rf_°¨t_§x
(
tick
);

772 sig√d 
rf_gë_rssi
();

781 
rf_£t_rf„_pö
(
rf_∑_tx_pö_e
 
tx_pö
, 
rf_ a_rx_pö_e
 
rx_pö
);

789 
rf_£t_txmode
();

797 
_©åibuã_øm_code_£c_
 
rf_tx_pkt
(* 
addr
);

806 
rf_£t_åx_°©e
(
rf_°©us_e
 
rf_°©us
, sig√d 
rf_ch™√l
);

814 
rf_£t_chn
(sig√d 
chn
);

821 
rf_¥iv©e_sb_í
();

829 
rf_£t_¥iv©e_sb_Àn
(
∑y_Àn
);

836 
rf_≤_dißbÀ
();

846 * 
rf_gë_rx_∑ckë_addr
(
fifo_num
,
fifo_dï
,* 
addr
);

854 
rf_£t_powî_Àvñ
 (
rf_powî_Àvñ_e
 
Àvñ
);

862 
rf_£t_powî_Àvñ_ödex
(
rf_powî_Àvñ_ödex_e
 
idx
);

869 
rf_tu∫_off_öã∫Æ_ˇp
();

877 
rf_upd©e_öã∫Æ_ˇp
(
vÆue
);

884 
rf_°©us_e
 
rf_gë_åx_°©e
();

892 
rf_£t_¥ómbÀ_Àn
(
Àn
);

899 
rf_£t_¥i_tx_ack_í
(
rf_mode_e
 
rf_mode
);

907 
rf_£t_ac˚ss_code_Àn
(
byã_Àn
);

916 
rf_£t_pùe_ac˚ss_code
 (
pùe_id
, *
addr
);

923 
rf_£t_rx_timeout
(
timeout_us
);

930 
rf_±x_c⁄fig
();

936 
rf_¥x_c⁄fig
();

944 
rf_°¨t_±x
 (* 
addr
, 
tick
);

951 
rf_°¨t_¥x
(
tick
);

960 
rf_£t_±x_ªåy
(
ªåy_times
, 
ªåy_dñay
);

970 
rf_is_rx_fifo_em±y
(
pùe_id
);

979 
_©åibuã_øm_code_£c_noölöe_
 
rf_°¨t_°x
(* 
addr
, 
tick
);

988 
_©åibuã_øm_code_£c_noölöe_
 
rf_°¨t_°x2rx
 (* 
addr
, 
tick
);

996 
_©åibuã_øm_code_£c_noölöe_
 
rf_£t_bÀ_chn
(sig√d 
chn_num
);

1004 
_©åibuã_øm_code_£c_noölöe_
 
rf_£t_rxmode
();

1016 
_©åibuã_øm_code_£c_noölöe_
 
rf_°¨t_brx
 (* 
addr
, 
tick
);

1028 
_©åibuã_øm_code_£c_noölöe_
 
rf_°¨t_btx
 (* 
addr
, 
tick
);

	@platform/chip_b91/s7816.h

24 #i‚de‡
S7816_H_


25 
	#S7816_H_


	)

27 
	~"gpio.h
"

28 
	~"u¨t.h
"

29 
	~"°imî.h
"

31 
	#s7816_í
(
u¨t_num
Ë
	`u¨t_πx_í
(u¨t_num)

	)

32 
	#s7816_£t_πx_pö
(
s7816_åx_pö
Ë
	`u¨t_£t_πx_pö
(s7816_åx_pö)

	)

38 
	mS7816_UART0_RTX_A4
=
GPIO_PA4
,

39 
	mS7816_UART0_RTX_B3
=
GPIO_PB3
,

40 
	mS7816_UART0_RTX_D3
=
GPIO_PD3
,

42 
	mS7816_UART1_RTX_C7
=
GPIO_PC7
,

43 
	mS7816_UART1_RTX_D7
=
GPIO_PD7
,

44 
	mS7816_UART1_RTX_E2
=
GPIO_PE2
,

45 }
	ts7816_πx_pö_e
;

51 
	mS7816_4MHZ
=4,

52 
	mS7816_6MHZ
=6,

53 
	mS7816_12MHZ
=12,

54 }
	ts7816_˛ock_e
;

60 
	mS7817_CLK_PA0
=
GPIO_PA0
,

61 }
	ts7816_˛k_pö_e
;

72 
s7816_£t_˛k
(
div
);

83 
s7816_öô
(
u¨t_num_e
 
u¨t_num
,
s7816_˛ock_e
 
˛ock
,
f
,
d
);

91 
s7816_cﬁdª£t
();

101 
s7816_£t_pö
(
gpio_pö_e
 
r°_pö
,gpio_pö_ê
vcc_pö
,
s7816_˛k_pö_e
 
˛k_pö
,
s7816_πx_pö_e
 
åx_pö
);

108 
s7816_ªÀa£_åig
();

115 
s7816_£t_r°_pö
(
gpio_pö_e
 
pö_7816_r°
);

122 
s7816_£t_vcc_pö
(
gpio_pö_e
 
pö_7816_vcc
);

130 
s7816_w¨mª£t
();

137 
s7816_£t_time
(
r°_time_us
);

145 
s7816_£nd_byã
(
u¨t_num_e
 
u¨t_num
, 
tx_d©a
);

	@platform/chip_b91/spi.h

24 #i‚de‡
SPI_H


25 
	#SPI_H


	)

27 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

28 
	~"gpio.h
"

29 
	~"dma.h
"

42 
	mSPI_RXFIFO_OR_INT_EN
 =
BIT
(0),

43 
	mSPI_TXFIFO_UR_INT_EN
 =
BIT
(1),

44 
	mSPI_RXFIFO_INT_EN
 =
BIT
(2),

45 
	mSPI_TXFIFO_INT_EN
 =
BIT
(3),

46 
	mSPI_END_INT_EN
 =
BIT
(4),

47 
	mSPI_SLV_CMD_EN
 =
BIT
(5),

48 }
	t•i_úq_mask
;

51 
	mSPI_RXF_OR_INT
 =
BIT
(2),

52 
	mSPI_TXF_UR_INT
 =
BIT
(3),

53 
	mSPI_RXF_INT
 =
BIT
(4),

54 
	mSPI_TXF_INT
 =
BIT
(5),

55 
	mSPI_END_INT
 =
BIT
(6),

56 
	mSPI_SLV_CMD_INT
 =
BIT
(7),

57 }
	t•i_úq_°©us_e
;

60 
	mPSPI_MODULE
 = 0,

61 
	mHSPI_MODULE
 = 1 ,

62 }
	t•i_£l_e
;

68 
	mSPI_MODE0
 = 0,

74 
	mSPI_MODE1
,

75 
	mSPI_MODE2
,

76 
	mSPI_MODE3
,

77 } 
	t•i_mode_ty≥_e
;

83 
	mSPI_SINGLE_MODE
 = 0,

84 
	mSPI_DUAL_MODE
 = 1 ,

85 
	mHSPI_QUAD_MODE
 = 2,

86 
	mSPI_3_LINE_MODE
 = 3

87 } 
	t•i_io_mode_e
;

90 
	mSPI_NOMAL
 = 0,

91 
	mSPI_3LINE
 = 3,

92 } 
	t•i_nomÆ_3löe_mode_e
;

95 
	mPSPI_SINGLE
 = 0,

96 
	mPSPI_DUAL
 = 1,

97 
	mPSPI_3LINE
 = 3

98 } 
	tp•i_sögÀ_duÆ_mode_e
;

101 
	mHSPI_SINGLE
 = 0,

102 
	mHSPI_DUAL
 = 1,

103 
	mHSPI_QUAD
 = 2,

104 
	mHSPI_3LINE
 = 3

105 } 
	th•i_sögÀ_duÆ_quad_mode_e
;

112 
	mSPI_MODE_WRITE_AND_READ
 = 0,

113 
	mSPI_MODE_WRITE_ONLY
,

114 
	mSPI_MODE_READ_ONLY
,

115 
	mSPI_MODE_WRITE_READ
,

116 
	mSPI_MODE_READ_WRITE
,

117 
	mSPI_MODE_WRITE_DUMMY_READ
,

118 
	mSPI_MODE_READ_DUMMY_WRITE
,

119 
	mSPI_MODE_NONE_DATA
,

120 
	mSPI_MODE_DUMMY_WRITE
,

121 
	mSPI_MODE_DUMMY_READ
,

122 
	mSPI_MODE_RESERVED
,

123 }
	t•i_èns_mode_e
;

126 
	mSPI_MODE_WR_WRITE_ONLY
 = 1,

127 
	mSPI_MODE_WR_DUMMY_WRITE
 = 8,

128 }
	t•i_wr_èns_mode_e
;

131 
	mSPI_MODE_RD_READ_ONLY
 = 2,

132 
	mSPI_MODE_RD_DUMMY_READ
 = 9,

133 }
	t•i_rd_èns_mode_e
;

136 
	mSPI_MODE_WR_RD
 = 3,

137 
	mSPI_MODE_WR_DUMMY_RD
 = 5,

138 }
	t•i_wr_rd_èns_mode_e
;

141 
h•i_sögÀ_duÆ_quad_mode_e
 
	mh•i_io_mode
;

142 
	mh•i_dummy_˙t
;

143 
	mh•i_cmd_í
;

144 
	mh•i_addr_í
;

145 
	mh•i_addr_Àn
;

146 
	mh•i_cmd_fmt_í
;

147 
	mh•i_addr_fmt_í
;

148 }
	th•i_c⁄fig_t
;

151 
p•i_sögÀ_duÆ_mode_e
 
	mp•i_io_mode
;

152 
	mp•i_dummy_˙t
;

153 
_Boﬁ
 
	mp•i_cmd_í
;

154 }
	tp•i_c⁄fig_t
;

158 
	mSPI_SLAVE_WRITE_DATA_CMD
 = 0x00,

159 
	mSPI_SLAVE_WRITE_DATA_DUAL_CMD
 = 
FLD_SPI_CMD_DATA_DUAL
,

160 
	mSPI_SLAVE_WRITE_ADDR_DUAL_CMD
 = 
FLD_SPI_CMD_ADDR_DUAL
,

162 
	mSPI_SLAVE_WRITE_DATA_DUAL_4CYC_CMD
 = 
FLD_SPI_CMD_DATA_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

163 
	mSPI_SLAVE_WRITE_ADDR_DUAL_4CYC_CMD
 = 
FLD_SPI_CMD_ADDR_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

164 
	mSPI_SLAVE_WRITE_DATA_AND_ADDR_DUL_4CYC_CMD
 = 
FLD_SPI_CMD_ADDR_DUAL
 | 
FLD_SPI_CMD_DATA_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

165 }
	t•i_¶ave_wrôe_cmd_e
;

168 
	mSPI_SLAVE_READ_DATA_CMD
 = 
FLD_SPI_CMD_RD_EN
,

169 
	mSPI_SLAVE_READ_DATA_DUAL_CMD
 = 
FLD_SPI_CMD_RD_EN
 | 
FLD_SPI_CMD_DATA_DUAL
,

170 
	mSPI_SLAVE_READ_ADDR_DUAL_CMD
 = 
FLD_SPI_CMD_RD_EN
 | 
FLD_SPI_CMD_ADDR_DUAL
,

172 
	mSPI_SLAVE_READ_DATA_DUAL_4CYC_CMD
 = 
FLD_SPI_CMD_RD_EN
 | 
FLD_SPI_CMD_DATA_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

173 
	mSPI_SLAVE_READ_ADDR_DUAL_4CYC_CMD
 = 
FLD_SPI_CMD_RD_EN
 | 
FLD_SPI_CMD_ADDR_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

175 
	mSPI_SLAVE_READ_DATA_AND_ADDR_DUL_4CYC_CMD
 = 
FLD_SPI_CMD_RD_EN
 | 
FLD_SPI_CMD_ADDR_DUAL
 | 
FLD_SPI_CMD_DATA_DUAL
 | 
FLD_SPI_CMD_RD_DUMMY_4CYCLE
,

177 }
	t•i_¶ave_ªad_cmd_e
;

180 
	mSPI_READ_STATUS_SINGLE_CMD
 = 0x05,

181 
	mSPI_READ_STATUS_DUAL_CMD
 = 0x15,

182 
	mHSPI_READ_STATUS_QUAD_CMD
 = 0x25,

183 
	mSPI_READ_DATA_SINGLE_CMD
 = 0x0B,

184 
	mSPI_READ_DATA_DUAL_CMD
 = 0x0C,

185 
	mHSPI_READ_DATA_QUAD_CMD
 = 0x0E,

186 
	mSPI_WRITE_DATA_SINGLE_CMD
 = 0x51,

187 
	mSPI_WRITE_DATA_DUAL_CMD
 = 0x52,

188 
	mHSPI_WRITE_DATA_QUAD_CMD
 = 0x54,

189 }
	tp•i_h•i_cmd_e
;

194 
	mPSRAM_READ_CMD
 = 0x03,

195 
	mPSRAM_FAST_READ_CMD
 = 0x0B,

196 
	mPSRAM_FAST_READ_QUAD_CMD
 = 0xEB,

198 
	mPSRAM_WRITE_CMD
 = 0x02,

199 
	mPSRAM_QUAD_WRITE_CMD
 = 0x38,

200 
	mPSRAM_WRAPPED_READ_CMD
 = 0x8B,

201 
	mPSRAM_WRAPPED_WRITE_CMD
 = 0x82,

203 
	mPSRAM_MODE_RG_READ_CMD
 = 0xB5,

204 
	mPSRAM_MODE_RG_WRITE_CMD
 = 0xB1,

206 
	mPSRAM_ENTER_QUAD_MODE_CMD
 = 0x35,

207 
	mPSRAM_EXIT_QUAD_MODE_CMD
 = 0xF5,

209 
	mPSRAM_REST_ENABLE_CMD
 = 0x66,

210 
	mPSRAM_REST_CMD
 = 0x99,

211 
	mPSRAM_BURST_LENGTH_TOGGLE_CMD
 = 0xC0,

212 
	mPSRAM_READ_ID_CMD
 = 0x95,

214 }
	t•i_xù_cmd_e
;

220 
	mHSPI_2DATA_LANE_CLOSE
 = 0x00,

221 
	mHSPI_2DATA_LANE_RGB565
 = 0x01,

222 
	mHSPI_2DATA_LANE_RGB666
 = 0x03,

223 
	mHSPI_2DATA_LANE_RGB888
 = 0x07,

224 }
	th•i_∑√l_2d©a_œ√_mode_e
;

230 
	mHSPI_CLK_PB4
 = 
GPIO_PB4
,

231 
	mHSPI_CLK_PA2
 = 
GPIO_PA2
,

232 }
	th•i_˛k_pö_def_e
;

235 
	mHSPI_CSN_PB6
 = 
GPIO_PB6
,

236 
	mHSPI_CSN_PA1
 = 
GPIO_PA1
,

237 }
	th•i_c¢_pö_def_e
;

240 
	mHSPI_MOSI_IO0_PB3
 = 
GPIO_PB3
,

241 
	mHSPI_MOSI_IO0_PA4
 = 
GPIO_PA4
,

242 }
	th•i_mosi_io0_pö_def_e
;

245 
	mHSPI_MISO_IO1_PB2
 = 
GPIO_PB2
,

246 
	mHSPI_MISO_IO1_PA3
 = 
GPIO_PA3
,

247 }
	th•i_miso_io1_pö_def_e
;

250 
	mHSPI_WP_IO2_PB1
 = 
GPIO_PB1
,

251 }
	th•i_wp_io2_pö_def_e
;

254 
	mHSPI_HOLD_IO3_PB0
 = 
GPIO_PB0
,

255 }
	th•i_hﬁd_io3_pö_def_e
;

258 
	mHSPI_CLK_PB4_PIN
 = 
GPIO_PB4
,

259 
	mHSPI_CLK_PA2_PIN
 = 
GPIO_PA2
,

261 
	mHSPI_CSN_PB6_PIN
 = 
GPIO_PB6
,

262 
	mHSPI_CSN_PA1_PIN
 = 
GPIO_PA1
,

264 
	mHSPI_MOSI_IO0_PB3_PIN
 = 
GPIO_PB3
,

265 
	mHSPI_MOSI_IO0_PA4_PIN
 = 
GPIO_PA4
,

267 
	mHSPI_MISO_IO1_PB2_PIN
 = 
GPIO_PB2
,

268 
	mHSPI_MISO_IO1_PA3_PIN
 = 
GPIO_PA3
,

270 
	mHSPI_WP_IO2_PB1_PIN
 = 
GPIO_PB1
,

271 
	mHSPI_HOLD_IO3_PB0_PIN
 = 
GPIO_PB0
,

272 
	mHSPI_NONE_PIN
 = 0xfff,

273 }
	th•i_pö_def_e
;

276 
h•i_˛k_pö_def_e
 
	mh•i_˛k_pö
;

277 
h•i_c¢_pö_def_e
 
	mh•i_c¢_pö
;

278 
h•i_mosi_io0_pö_def_e
 
	mh•i_mosi_io0_pö
;

279 
h•i_miso_io1_pö_def_e
 
	mh•i_miso_io1_pö
;

280 
h•i_wp_io2_pö_def_e
 
	mh•i_wp_io2_pö
;

281 
h•i_hﬁd_io3_pö_def_e
 
	mh•i_hﬁd_io3_pö
;

282 }
	th•i_pö_c⁄fig_t
;

286 
	mPSPI_CLK_PC5
 = 
GPIO_PC5
,

287 
	mPSPI_CLK_PB5
 = 
GPIO_PB5
,

288 
	mPSPI_CLK_PD1
 = 
GPIO_PD1
,

289 }
	tp•i_˛k_pö_def_e
;

292 
	mPSPI_CSN_PC4
 = 
GPIO_PC4
,

293 
	mPSPI_CSN_PC0
 = 
GPIO_PC0
,

294 
	mPSPI_CSN_PD0
 = 
GPIO_PD0
,

295 }
	tp•i_c¢_pö_def_e
;

298 
	mPSPI_MOSI_IO0_PC7
 = 
GPIO_PC7
,

299 
	mPSPI_MOSI_IO0_PB7
 = 
GPIO_PB7
,

300 
	mPSPI_MOSI_IO0_PD3
 = 
GPIO_PD3
,

301 }
	tp•i_mosi_io0_pö_def_e
;

304 
	mPSPI_MISO_IO1_PC6
 = 
GPIO_PC6
,

305 
	mPSPI_MISO_IO1_PB6
 = 
GPIO_PB6
,

306 
	mPSPI_MISO_IO1_PD2
 = 
GPIO_PD2
,

307 }
	tp•i_miso_io1_pö_def_e
;

310 
	mPSPI_CLK_PC5_PIN
 = 
GPIO_PC5
,

311 
	mPSPI_CLK_PB5_PIN
 = 
GPIO_PB5
,

312 
	mPSPI_CLK_PD1_PIN
 = 
GPIO_PD1
,

314 
	mPSPI_CSN_PC4_PIN
 = 
GPIO_PC4
,

315 
	mPSPI_CSN_PC0_PIN
 = 
GPIO_PC0
,

316 
	mPSPI_CSN_PD0_PIN
 = 
GPIO_PD0
,

318 
	mPSPI_MOSI_IO0_PC7_PIN
 = 
GPIO_PC7
,

319 
	mPSPI_MOSI_IO0_PB7_PIN
 = 
GPIO_PB7
,

320 
	mPSPI_MOSI_IO0_PD3_PIN
 = 
GPIO_PD3
,

322 
	mPSPI_MISO_IO1_PC6_PIN
 = 
GPIO_PC6
,

323 
	mPSPI_MISO_IO1_PB6_PIN
 = 
GPIO_PB6
,

324 
	mPSPI_MISO_IO1_PD2_PIN
 = 
GPIO_PD2
,

325 
	mPSPI_NONE_PIN
 = 0xfff,

326 }
	tp•i_pö_def_e
;

329 
p•i_˛k_pö_def_e
 
	mp•i_˛k_pö
;

330 
p•i_c¢_pö_def_e
 
	mp•i_c¢_pö
;

331 
p•i_mosi_io0_pö_def_e
 
	mp•i_mosi_io0_pö
;

332 
p•i_miso_io1_pö_def_e
 
	mp•i_miso_io1_pö
;

333 }
	tp•i_pö_c⁄fig_t
;

340 
ölöe
 
	$h•i_ª£t
()

342 
ªg_r°0
 &(~
FLD_RST0_HSPI
);

343 
ªg_r°0
 |
FLD_RST0_HSPI
;

344 
	}
}

349 
ölöe
 
	$p•i_ª£t
()

351 
ªg_r°1
 &(~
FLD_RST1_PSPI
);

352 
ªg_r°1
 |
FLD_RST1_PSPI
;

353 
	}
}

360 
ölöe
 
	$•i_gë_txfifo_num
(
•i_£l_e
 
•i_£l
)

362  (
	`ªg_•i_fifo_num
(
•i_£l
Ë& 
FLD_SPI_TXF_NUM
) >> 4;

363 
	}
}

370 
ölöe
 
	$•i_gë_rxfifo_num
(
•i_£l_e
 
•i_£l
)

372  
	`ªg_•i_fifo_num
(
•i_£l
Ë& 
FLD_SPI_RXF_NUM
;

373 
	}
}

381 
ölöe
 
	$•i_rx_˙t
(
•i_£l_e
 
•i_£l
, 
˙t
)

383 
	`ªg_•i_rx_˙t2
(
•i_£l
Ë((
˙t
 - 1) >> 16) & 0xff;

384 
	`ªg_•i_rx_˙t1
(
•i_£l
Ë((
˙t
 - 1) >> 8) & 0xff;

385 
	`ªg_•i_rx_˙t0
(
•i_£l
Ë(
˙t
 - 1) & 0xff;

387 
	}
}

395 
ölöe
 
	$•i_tx_˙t
(
•i_£l_e
 
•i_£l
, 
˙t
)

397 
	`ªg_•i_tx_˙t2
(
•i_£l
Ë((
˙t
 - 1) >> 16) & 0xff;

398 
	`ªg_•i_tx_˙t1
(
•i_£l
Ë((
˙t
 - 1) >> 8) & 0xff;

399 
	`ªg_•i_tx_˙t0
(
•i_£l
Ë(
˙t
 - 1) & 0xff;

401 
	}
}

408 
ölöe
 
	$•i_tx_fifo_˛r
(
•i_£l_e
 
•i_£l
)

410 
	`BM_SET
(
	`ªg_•i_fifo_°©e
(
•i_£l
), 
FLD_SPI_TXF_CLR
);

411 
	}
}

418 
ölöe
 
	$•i_rx_fifo_˛r
(
•i_£l_e
 
•i_£l
)

420 
	`BM_SET
(
	`ªg_•i_fifo_°©e
(
•i_£l
), 
FLD_SPI_RXF_CLR
);

421 
	}
}

429 
ölöe
 
	$•i_£t_cmd
(
•i_£l_e
 
•i_£l
, 
cmd
)

431 
	`ªg_•i_å™s1
(
•i_£l
Ë
cmd
;

432 
	}
}

439 
ölöe
 
	$•i_cmd_í
(
•i_£l_e
 
•i_£l
)

441 
	`BM_SET
–
	`ªg_•i_mode2
(
•i_£l
), 
FLD_SPI_CMD_EN
);

442 
	}
}

449 
ölöe
 
	$•i_cmd_dis
(
•i_£l_e
 
•i_£l
)

452 
	`BM_CLR
(
	`ªg_•i_mode2
(
•i_£l
), 
FLD_SPI_CMD_EN
);

453 
	}
}

459 
ölöe
 
	$h•i_cmd_fmt_í
()

461 
	`BM_SET
–
	`ªg_•i_mode2
(
HSPI_MODULE
), 
FLD_HSPI_CMD_FMT
);

462 
	}
}

468 
ölöe
 
	$h•i_cmd_fmt_dis
()

470 
	`BM_CLR
(
	`ªg_•i_mode2
(
HSPI_MODULE
), 
FLD_HSPI_CMD_FMT
);

471 
	}
}

477 
ölöe
 
	$h•i_quad_mode_í
()

479 
	`BM_SET
(
	`ªg_•i_mode2
(
HSPI_MODULE
), 
FLD_HSPI_QUAD
);

480 
	}
}

487 
ölöe
 
	$h•i_quad_mode_dis
(
•i_£l_e
 
•i_£l
)

489 
	`BM_CLR
(
	`ªg_•i_mode2
(
•i_£l
), 
FLD_HSPI_QUAD
);

490 
	}
}

497 
ölöe
 
	$•i_duÆ_mode_í
(
•i_£l_e
 
•i_£l
)

499 
	`BM_SET
(
	`ªg_•i_mode0
(
•i_£l
), 
FLD_SPI_DUAL
);

500 
	}
}

507 
ölöe
 
	$•i_duÆ_mode_dis
(
•i_£l_e
 
•i_£l
)

509 
	`BM_CLR
(
	`ªg_•i_mode0
(
•i_£l
), 
FLD_SPI_DUAL
);

510 
	}
}

517 
ölöe
 
	$•i_3löe_mode_í
(
•i_£l_e
 
•i_£l
)

519 
	`BM_SET
(
	`ªg_•i_mode0
(
•i_£l
), 
FLD_SPI_3LINE
);

520 
	}
}

527 
ölöe
 
	$•i_3löe_mode_dis
(
•i_£l_e
 
•i_£l
)

529 
	`BM_CLR
(
	`ªg_•i_mode0
(
•i_£l
), 
FLD_SPI_3LINE
);

530 
	}
}

536 
ölöe
 
	$h•i_addr_fmt_í
()

538 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_ADDR_FMT
);

540 
	}
}

546 
ölöe
 
	$h•i_addr_fmt_dis
()

548 
	`BM_CLR
–
ªg_h•i_xù_˘æ
, 
FLD_HSPI_ADDR_FMT
);

550 
	}
}

557 
ölöe
 
_Boﬁ
 
	$•i_is_busy
(
•i_£l_e
 
•i_£l
)

559  
	`ªg_•i_°©us
(
•i_£l
Ë& 
FLD_HSPI_BUSY
;

561 
	}
}

568 
ölöe
 
	$•i_tx_dma_í
(
•i_£l_e
 
•i_£l
)

570 
	`BM_SET
(
	`ªg_•i_å™s2
(
•i_£l
), 
FLD_SPI_TX_DMA_EN
);

571 
	}
}

578 
ölöe
 
	$•i_tx_dma_dis
(
•i_£l_e
 
•i_£l
)

580 
	`BM_CLR
(
	`ªg_•i_å™s2
(
•i_£l
), 
FLD_SPI_TX_DMA_EN
);

581 
	}
}

588 
ölöe
 
	$•i_rx_dma_í
(
•i_£l_e
 
•i_£l
)

590 
	`BM_SET
(
	`ªg_•i_å™s2
(
•i_£l
), 
FLD_SPI_RX_DMA_EN
);

591 
	}
}

598 
ölöe
 
	$•i_rx_dma_dis
(
•i_£l_e
 
•i_£l
)

600 
	`BM_CLR
(
	`ªg_•i_å™s2
(
•i_£l
), 
FLD_SPI_RX_DMA_EN
);

601 
	}
}

608 
ölöe
 
	$h•i_xù_£t_wr_cmd
(
wr_cmd
)

610 
ªg_h•i_xù_wr_cmd
 = 
wr_cmd
;

611 
	}
}

618 
ölöe
 
	$h•i_xù_£t_rd_cmd
(
rd_cmd
)

621 
ªg_h•i_xù_rd_cmd
 = 
rd_cmd
;

622 
	}
}

629 
ölöe
 
	$h•i_xù_addr_off£t
(
addr_off£t
)

631 
ªg_h•i_xù_addr_off£t0
 = 
addr_off£t
 & 0xff;

632 
ªg_h•i_xù_addr_off£t1
 = (
addr_off£t
 >> 8) & 0xff;

633 
ªg_h•i_xù_addr_off£t2
 = (
addr_off£t
 >> 16) & 0xff;

634 
ªg_h•i_xù_addr_off£t3
 = (
addr_off£t
 >> 24) & 0xff;

635 
	}
}

642 
ölöe
 
	$h•i_xù_ªad_å™smode
(
rd_mode
)

644 
ªg_h•i_xù_å™s_mode
 &(~
FLD_HSPI_XIP_RD_TRANS_MODE
);

645 
ªg_h•i_xù_å™s_mode
 |(
rd_mode
 & 0xf) << 4;

646 
	}
}

653 
ölöe
 
	$h•i_xù_wrôe_å™smode
(
wr_mode
)

655 
ªg_h•i_xù_å™s_mode
 &(~
FLD_HSPI_XIP_WR_TRANS_MODE
);

656 
ªg_h•i_xù_å™s_mode
 |
wr_mode
 & 
FLD_HSPI_XIP_WR_TRANS_MODE
;

657 
	}
}

663 
ölöe
 
	$h•i_addr_í
()

665 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_ADDR_EN
);

666 
	}
}

672 
ölöe
 
	$h•i_addr_dis
()

674 
	`BM_CLR
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_ADDR_EN
);

675 
	}
}

682 
ölöe
 
	$h•i_£t_addr_Àn
(
Àn
)

684 
ªg_h•i_xù_˘æ
 |((
Àn
 - 1) & 0x3) << 2;

685 
	}
}

691 
ölöe
 
	$h•i_xù_£q_mode_í
()

693 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_MODE
);

694 
	}
}

700 
ölöe
 
	$h•i_xù_£q_mode_dis
()

702 
	`BM_CLR
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_MODE
);

703 
	}
}

709 
ölöe
 
	$h•i_xù_í
()

711 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_ENABLE
);

712 
	}
}

718 
ölöe
 
	$h•i_xù_dis
()

720 
	`BM_CLR
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_ENABLE
);

721 
	}
}

727 
ölöe
 
	$h•i_xù_°›
()

729 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_STOP
);

730 
	}
}

736 
ölöe
 
	$h•i_xù_timeout_mode_í
()

738 
	`BM_SET
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_TIMEOUT_MODE
);

739 
	}
}

745 
ölöe
 
	$h•i_xù_timeout_mode_dis
()

747 
	`BM_CLR
(
ªg_h•i_xù_˘æ
, 
FLD_HSPI_XIP_TIMEOUT_MODE
);

748 
	}
}

755 
ölöe
 
	$h•i_xù_timeout_˙t
(
˙t
)

757 
ªg_h•i_xù_timeout_˙t
 = 
˙t
 & 0xff;

758 
	}
}

765 
ölöe
 
	$h•i_xù_∑ge_size
(
∑ge_size_i
)

767 
ªg_h•i_∑ge_size
 = 
∑ge_size_i
;

768 
	}
}

775 
ölöe
 
	$•i_¶ave_ªady_í
(
•i_£l_e
 
•i_£l
)

777 
	`BM_SET
(
	`ªg_•i_°©us
(
•i_£l
), 
FLD_HSPI_SLAVE_READY
);

778 
	}
}

785 
ölöe
 
	$•i_¶ave_ªady_dis
(
•i_£l_e
 
•i_£l
)

787 
	`BM_CLR
(
	`ªg_•i_°©us
(
•i_£l
), 
FLD_HSPI_SLAVE_READY
);

788 
	}
}

795 
ölöe
 
	$•i_¶ave_gë_cmd
(
•i_£l_e
 
•i_£l
)

797  
	`ªg_•i_å™s1
(
•i_£l
);

798 
	}
}

807 
ölöe
 
	$•i_rx_tx_úq_åig_˙t
(
•i_£l_e
 
•i_£l
, 
˙t
)

809 
	`BM_CLR
(
	`ªg_•i_°©us
(
•i_£l
), 
FLD_HSPI_FIFO_THRES
);

810 
	`ªg_•i_°©us
(
•i_£l
Ë|((
˙t
 & 7) << 4);

811 
	}
}

819 
ölöe
 
	$•i_gë_úq_°©us
(
•i_£l_e
 
•i_£l
,
•i_úq_°©us_e
 
°©us
 )

821  
	`ªg_•i_úq_°©e
(
•i_£l
)&
°©us
;

822 
	}
}

830 
ölöe
 
	$•i_˛r_úq_°©us
(
•i_£l_e
 
•i_£l
, 
•i_úq_°©us_e
 
°©us
)

832 
	`ªg_•i_úq_°©e
(
•i_£l
Ë
°©us
;

833 
	}
}

841 
ölöe
 
	$•i_£t_úq_mask
(
•i_£l_e
 
•i_£l
, 
•i_úq_mask
 
mask
)

843 
	`BM_SET
(
	`ªg_•i_å™s2
(
•i_£l
), 
mask
);

844 
	}
}

852 
ölöe
 
	$•i_˛r_úq_mask
(
•i_£l_e
 
•i_£l
, 
•i_úq_mask
 
mask
)

854 
	`BM_CLR
(
	`ªg_•i_å™s2
(
•i_£l
), 
mask
);

855 
	}
}

861 
ölöe
 
	$h•i_3löe_dcx_í
()

863 
	`BM_SET
(
ªg_h•i_∑√l_˘æ
, 
FLD_HSPI_PANEL_3LINE_DCX_EN
);

864 
	}
}

870 
ölöe
 
	$h•i_3löe_dcx_dis
()

872 
	`BM_CLR
(
ªg_h•i_∑√l_˘æ
, 
FLD_HSPI_PANEL_3LINE_DCX_EN
);

873 
	}
}

879 
ölöe
 
	$h•i_£t_3löe_dcx_d©a
()

881 
	`BM_SET
(
ªg_h•i_∑√l_˘æ
, 
FLD_HSPI_PANEL_3LINE_DCX
);

882 
	}
}

888 
ölöe
 
	$h•i_£t_3löe_dcx_cmd
()

890 
	`BM_CLR
(
ªg_h•i_∑√l_˘æ
, 
FLD_HSPI_PANEL_3LINE_DCX
);

891 
	}
}

897 
ölöe
 
	$h•i_£t_∑√l_2d©a_œ√_mode
(
h•i_∑√l_2d©a_œ√_mode_e
 
mode
)

899 
ªg_h•i_∑√l_˘æ
 &(~
FLD_HSPI_PANEL_2DATA_LANE
);

900 
ªg_h•i_∑√l_˘æ
 |(
mode
 & 0xf) << 2;

901 
	}
}

907 
•i_¶ave_£t_pö
();

913 
h•i_£t_pö
(
h•i_pö_c⁄fig_t
 *
c⁄fig
);

920 
p•i_£t_pö
(
p•i_pö_c⁄fig_t
 *
c⁄fig
);

927 
h•i_cs_pö_í
(
h•i_c¢_pö_def_e
 
pö
);

934 
h•i_cs_pö_dis
(
h•i_c¢_pö_def_e
 
pö
);

941 
p•i_cs_pö_í
(
p•i_c¢_pö_def_e
 
pö
);

948 
p•i_cs_pö_dis
(
p•i_c¢_pö_def_e
 
pö
);

963 
•i_ma°î_öô
(
•i_£l_e
 
•i_£l
, 
div_˛ock
, 
•i_mode_ty≥_e
 
mode
);

977 
•i_¶ave_öô
(
•i_£l_e
 
•i_£l
, 
•i_mode_ty≥_e
 
mode
);

985 
•i_£t_dummy_˙t
(
•i_£l_e
 
•i_£l
, 
dummy_˙t
);

992 
h•i_£t_addªss
(
addr
);

1000 
•i_£t_å™smode
(
•i_£l_e
 
•i_£l
, 
•i_èns_mode_e
 
mode
);

1008 
•i_£t_n‹mÆ_mode
(
•i_£l_e
 
•i_£l
);

1015 
•i_£t_duÆ_mode
(
•i_£l_e
 
•i_£l
);

1021 
h•i_£t_quad_mode
();

1028 
•i_£t_3löe_mode
(
•i_£l_e
 
•i_£l
);

1036 
•i_£t_io_mode
(
•i_£l_e
 
•i_£l
, 
•i_io_mode_e
 
mode
);

1044 
•i_ma°î_c⁄fig
(
•i_£l_e
 
•i_£l
, 
•i_nomÆ_3löe_mode_e
 
mode
);

1051 
h•i_ma°î_c⁄fig_∂us
(
h•i_c⁄fig_t
 *
c⁄fig
);

1058 
p•i_ma°î_c⁄fig_∂us
(
p•i_c⁄fig_t
 *
c⁄fig
);

1067 
•i_wrôe
(
•i_£l_e
 
•i_£l
, *
d©a
, 
Àn
);

1076 
•i_ªad
(
•i_£l_e
 
•i_£l
, *
d©a
, 
Àn
);

1085 
•i_ma°î_wrôe
(
•i_£l_e
 
•i_£l
, *
d©a
, 
Àn
);

1096 
•i_ma°î_wrôe_ªad
(
•i_£l_e
 
•i_£l
, *
wr_d©a
, 
wr_Àn
, *
rd_d©a
, 
rd_Àn
);

1108 
•i_ma°î_wrôe_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, 
addr
, *
d©a
, 
d©a_Àn
, 
•i_wr_èns_mode_e
 
wr_mode
);

1120 
•i_ma°î_ªad_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, 
addr
, *
d©a
, 
d©a_Àn
, 
•i_rd_èns_mode_e
 
rd_mode
);

1133 
•i_ma°î_wrôe_ªad_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, *
addrs
, 
addr_Àn
, *
d©a
, 
d©a_Àn
, 
•i_rd_èns_mode_e
 
wr_mode
);

1140 
h•i_£t_tx_dma_c⁄fig
(
dma_chn_e
 
chn
);

1147 
h•i_£t_rx_dma_c⁄fig
(
dma_chn_e
 
chn
);

1154 
p•i_£t_tx_dma_c⁄fig
(
dma_chn_e
 
chn
);

1161 
p•i_£t_rx_dma_c⁄fig
(
dma_chn_e
 
chn
);

1170 
•i_£t_dma
(
dma_chn_e
 
•i_dma_chn
, 
§c_addr
, 
d°_addr
, 
Àn
);

1181 
_©åibuã_øm_code_£c_
 
•i_£t_tx_dma
(
•i_£l_e
 
•i_£l
, * 
§c_addr
,
Àn
);

1190 
_©åibuã_øm_code_£c_
 
•i_£t_rx_dma
(
•i_£l_e
 
•i_£l
, * 
d°_addr
,
Àn
);

1198 
•i_ma°î_wrôe_dma
(
•i_£l_e
 
•i_£l
, *
§c_addr
, 
Àn
);

1209 
•i_ma°î_wrôe_ªad_dma
(
•i_£l_e
 
•i_£l
, *
addr
, 
addr_Àn
, *
d©a
, 
d©a_Àn
);

1221 
•i_ma°î_wrôe_dma_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, 
addr
, *
d©a
, 
d©a_Àn
, 
•i_wr_èns_mode_e
 
wr_mode
);

1233 
•i_ma°î_ªad_dma_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, 
addr
, *
d°_addr
, 
d©a_Àn
, 
•i_rd_èns_mode_e
 
rd_mode
);

1246 
•i_ma°î_wrôe_ªad_dma_∂us
(
•i_£l_e
 
•i_£l
, 
cmd
, *
addr
, 
addr_Àn
, *
rd_d©a
, 
rd_Àn
, 
•i_rd_èns_mode_e
 
rd_mode
);

1257 
h•i_ma°î_wrôe_xù
(
cmd
, 
addr_off£t
, *
d©a
, 
d©a_Àn
, 
•i_wr_èns_mode_e
 
wr_mode
);

1268 
h•i_ma°î_ªad_xù
(
cmd
, 
addr_off£t
, *
d©a
, 
d©a_Àn
, 
•i_rd_èns_mode_e
 
rd_mode
);

1278 
h•i_ma°î_wrôe_xù_cmd_d©a
(
cmd
, 
addr_off£t
, 
d©a_ö
, 
•i_wr_èns_mode_e
 
wr_mode
);

	@platform/chip_b91/stimer.h

34 #i‚de‡
STIMER_H_


35 
	#STIMER_H_


	)

36 
	~"compûî.h
"

37 
	~"ªg_ö˛ude/°imî_ªg.h
"

61 
	mSYSTEM_TIMER_TICK_1US
 = 16,

62 
	mSYSTEM_TIMER_TICK_1MS
 = 16000,

63 
	mSYSTEM_TIMER_TICK_1S
 = 16000000,

65 
	mSYSTEM_TIMER_TICK_625US
 = 10000,

66 
	mSYSTEM_TIMER_TICK_1250US
 = 20000,

75 
ölöe
 
	$°imî_£t_úq_mask
(
°imî_úq_e
 
mask
)

77 
ªg_sy°em_úq_mask
 |
mask
;

78 
	}
}

85 
ölöe
 
	$°imî_˛r_úq_mask
(
°imî_úq_e
 
mask
)

87 
ªg_sy°em_úq_mask
 &(~
mask
);

88 
	}
}

95 
ölöe
 
	$°imî_˛r_úq_°©us
(
°imî_úq_e
 
°©us
)

97 
ªg_sy°em_ˇl_úq
 = (
°©us
);

98 
	}
}

105 
ölöe
 
	$°imî_gë_úq_°©us
(
°imî_úq_e
 
°©us
)

107  (
ªg_sy°em_ˇl_úq
 & 
°©us
);

108 
	}
}

115 
ölöe
 
	$°imî_£t_úq_ˇ±uª
(
tick
)

117 
ªg_sy°em_úq_Àvñ
 = (
tick
);

118 
	}
}

125 
ölöe
 
	$°imî_£t_tick
(
tick
)

127 
ªg_sy°em_tick
 = (
tick
);

128 
	}
}

134 
ölöe
 
	$°imî_íabÀ
()

136 
ªg_sy°em_˘æ
 |
FLD_SYSTEM_TIMER_EN
;

137 
	}
}

144 
ölöe
 
	$°imî_dißbÀ
()

146 
ªg_sy°em_˘æ
 &~(
FLD_SYSTEM_TIMER_EN
);

147 
	}
}

153 
ölöe
 
	$°imî_gë_tick
()

156  
ªg_sy°em_tick
;

157 
	}
}

165 
ölöe
 
_Boﬁ
 
	$˛ock_time_ex˚ed
(
ªf
, 
us
)

167  (()(
	`°imî_gë_tick
(Ë- 
ªf
Ë> 
us
 * 
SYSTEM_TIMER_TICK_1US
);

168 
	}
}

174 
_©åibuã_øm_code_£c_noölöe_
 
dñay_us
(
mi¸o£c
);

182 
_©åibuã_øm_code_£c_noölöe_
 
dñay_ms
(
mûli£c
);

	@platform/chip_b91/swire.h

24 #i‚de‡
_SWIRE_H_


25 
	#_SWIRE_H_


	)

26 
	~"compûî.h
"

27 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

35 
ölöe
 
	$swúe_ª£t
()

37 
ªg_r°0
 &(~
FLD_RST0_SWIRE
);

38 
ªg_r°0
 |(
FLD_RST0_SWIRE
);

39 
	}
}

44 
ölöe
 
	$swúe_waô_wr_d⁄e
()

46 
ªg_swúe_˘l
 & 
FLD_SWIRE_WR
);

47 
	}
}

53 
ölöe
 
	$swúe_ma°î_wrôe_cmd
(
cmd
)

55 
ªg_swúe_d©a
 = 
cmd
;

56 
ªg_swúe_˘l
 = (
FLD_SWIRE_CMD
 | 
FLD_SWIRE_WR
 );

57 
	`swúe_waô_wr_d⁄e
();

58 
	}
}

64 
ölöe
 
	$swúe_ma°î_wrôe_d©a
(
d©a
)

66 
ªg_swúe_d©a
 = 
d©a
;

67 
ªg_swúe_˘l
 = 
FLD_SWIRE_WR
 ;

68 
	`swúe_waô_wr_d⁄e
();

69 
	}
}

77 
ölöe
 
	$swúe_fifo_mode_dis
()

79 
	`BM_CLR
(
ªg_swúe_id
, 
FLD_SWIRE_FIFO_MODE
);

81 
	}
}

89 
ölöe
 
	$swúe_fifo_mode_í
()

91 
	`BM_SET
(
ªg_swúe_id
, 
FLD_SWIRE_FIFO_MODE
);

93 
	}
}

104 
swúe_sync
 (
dp_through_swúe_í
);

109 
swúe_£t_swm_í
();

114 
swúe_£t_sws_í
();

125 
swúe_£t_˛k
(
swúe_˛ock
);

133 
swúe_£t_¶ave_id
(
id
);

149 
swúe_ma°î_wrôe
(
¶ave_id
,*
addr
, 
addr_Àn
,*
d©a
,
d©a_Àn
);

164 
swúe_ma°î_ªad
 (
¶ave_id
,*
addr
, 
addr_Àn
,*
d©a
,
d©a_Àn
);

	@platform/chip_b91/sys.h

35 #i‚de‡
SYS_H_


36 
	#SYS_H_


	)

37 
	~"bô.h
"

38 
	~"ªg_ö˛ude/°imî_ªg.h
"

52 
	#_ASM_NOP_
 
	`__asm__
("n›")

	)

54 
	#CLOCK_DLY_1_CYC
 
_ASM_NOP_


	)

55 
	#CLOCK_DLY_2_CYC
 
_ASM_NOP_
;
	)
_ASM_NOP_

56 
	#CLOCK_DLY_3_CYC
 
_ASM_NOP_
;_ASM_NOP_;
	)
_ASM_NOP_

57 
	#CLOCK_DLY_4_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

58 
	#CLOCK_DLY_5_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

59 
	#CLOCK_DLY_6_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

60 
	#CLOCK_DLY_7_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

61 
	#CLOCK_DLY_8_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

62 
	#CLOCK_DLY_9_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

63 
	#CLOCK_DLY_10_CYC
 
_ASM_NOP_
;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;_ASM_NOP_;
	)
_ASM_NOP_

65 
	#FLASH_R_BASE_ADDR
 0x20000000

	)

66 
	#REG_RW_BASE_ADDR
 0x80000000

	)

67 
	#REG_ADDR8
(
a
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (a)))

	)

68 
	#REG_ADDR16
(
a
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (a)))

	)

69 
	#REG_ADDR32
(
a
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (a)))

	)

71 
	#wrôe_ªg8
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)Ë()(v))

	)

72 
	#wrôe_ªg16
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)Ë()(v))

	)

73 
	#wrôe_ªg32
(
addr
,
v
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)Ë()(v))

	)

75 
	#ªad_ªg8
(
addr
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)))

	)

76 
	#ªad_ªg16
(
addr
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)))

	)

77 
	#ªad_ªg32
(
addr
Ë(*(vﬁ©ûê*)(
REG_RW_BASE_ADDR
 | (addr)))

	)

79 
	#wrôe_§am8
(
addr
,
v
Ë(*(vﬁ©ûê*)–◊ddr)Ë()(v))

	)

80 
	#wrôe_§am16
(
addr
,
v
Ë(*(vﬁ©ûê*)–◊ddr)Ë()(v))

	)

81 
	#wrôe_§am32
(
addr
,
v
Ë(*(vﬁ©ûê*)–◊ddr)Ë()(v))

	)

83 
	#ªad_§am8
(
addr
Ë(*(vﬁ©ûê*)(◊ddr)))

	)

84 
	#ªad_§am16
(
addr
Ë(*(vﬁ©ûê*)(◊ddr)))

	)

85 
	#ªad_§am32
(
addr
Ë(*(vﬁ©ûê*)(◊ddr)))

	)

86 
	#TCMD_UNDER_BOTH
 0xc0

	)

87 
	#TCMD_UNDER_RD
 0x80

	)

88 
	#TCMD_UNDER_WR
 0x40

	)

90 
	#TCMD_MASK
 0x3f

	)

92 
	#TCMD_WRITE
 0x3

	)

93 
	#TCMD_WAIT
 0x7

	)

94 
	#TCMD_WAREG
 0x8

	)

109 
	#c⁄vît_øm_addr_˝u2bus
(
addr
Ë(()◊ddr)+0xc0180000)

	)

114 
	#c⁄vît_øm_addr_bus2˝u
(
addr
Ë((((()◊ddr)Ë>=0xc0200000)?((()◊ddr)Ë+ 0x80000-0xc0200000Ë: ((()◊ddr)Ë- 0xc0000000)))

	)

124 
	mLDO_1P4_LDO_1P8
 = 0x00,

125 
	mDCDC_1P4_LDO_1P8
 = 0x01,

126 
	mDCDC_1P4_DCDC_1P8
 = 0x03,

127 }
	tpowî_mode_e
;

137 
	mVBAT_MAX_VALUE_GREATER_THAN_3V6
 = 0x00,

138 
	mVBAT_MAX_VALUE_LESS_THAN_3V6
 = 
BIT
(3),

139 }
	tvb©_ty≥_e
;

144 
	stbl_cmd_£t_t
 {

145 
	madr
;

146 
	md©
;

147 
	mcmd
;

148 } 
	ttbl_cmd_£t_t
;

155 
g_chù_vîsi⁄
;

164 
ölöe
 
	$sys_ªboŸ
()

166 
	`wrôe_ªg8
(0x1401ef, 0x20);

167 
	}
}

174 
sys_öô
(
powî_mode_e
 
powî_mode
, 
vb©_ty≥_e
 
vb©_v
);

184 
wrôe_ªg_èbÀ
(c⁄° 
tbl_cmd_£t_t
 * 
±
, 
size
);

	@platform/chip_b91/timer.h

40 #i‚de‡
TIMER_H_


41 
	#TIMER_H_


	)

43 
	~"™Æog.h
"

44 
	~"gpio.h
"

45 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

60 
	mTIMER0
 =0,

61 
	mTIMER1
 =1,

62 }
	ttimî_ty≥_e
;

69 
	mTIMER_MODE_SYSCLK
 =0,

70 
	mTIMER_MODE_GPIO_TRIGGER
 =1,

71 
	mTIMER_MODE_GPIO_WIDTH
 =2,

72 
	mTIMER_MODE_TICK
 =3,

73 }
	ttimî_mode_e
;

76 
	mTMR_STA_TMR0
 = 
BIT
(0),

77 
	mTMR_STA_TMR1
 = 
BIT
(1),

78 }
	ttime_úq_e
;

89 
ölöe
 
	$timî_gë_úq_°©us
(
time_úq_e
 
°©us
)

91  
ªg_tmr_°a
&
°©us
 ;

92 
	}
}

99 
ölöe
 
	$timî_˛r_úq_°©us
(
time_úq_e
 
°©us
)

101 
ªg_tmr_°a

°©us
;

102 
	}
}

109 
ölöe
 
	$timî0_gë_gpio_width
()

111  
ªg_tmr0_tick
;

113 
	}
}

120 
ölöe
 
	$timî1_gë_gpio_width
()

122  
ªg_tmr1_tick
;

124 
	}
}

132 
ölöe
 
	$timî0_£t_tick
(
tick
)

134 
ªg_tmr0_tick
 = 
tick
;

135 
	}
}

141 
ölöe
 
	$timî0_gë_tick
()

143  
ªg_tmr0_tick
 ;

144 
	}
}

152 
ölöe
 
	$timî1_£t_tick
(
tick
)

154 
ªg_tmr1_tick
 = 
tick
;

155 
	}
}

161 
ölöe
 
	$timî1_gë_tick
()

163  
ªg_tmr1_tick
;

164 
	}
}

172 
ölöe
 
	$timî_£t_öô_tick
(
timî_ty≥_e
 
ty≥
, 
öô_tick
)

174 
	`ªg_tmr_tick
(
ty≥
Ë
öô_tick
;

175 
	}
}

182 
ölöe
 
	$timî_£t_ˇp_tick
(
timî_ty≥_e
 
ty≥
, 
ˇp_tick
)

184 
	`ªg_tmr_ˇ±
(
ty≥
Ë
ˇp_tick
;

185 
	}
}

194 
timî_°¨t
(
timî_ty≥_e
 
ty≥
);

202 
timî_£t_mode
(
timî_ty≥_e
 
ty≥
, 
timî_mode_e
 
mode
);

211 
timî_gpio_öô
(
timî_ty≥_e
 
ty≥
, 
gpio_pö_e
 
pö
, 
gpio_pﬁ_e
 
pﬁ
 );

220 
timî_°›
(
timî_ty≥_e
 
ty≥
);

	@platform/chip_b91/trng.h

34 #i‚de‡
TRNG_H_


35 
	#TRNG_H_


	)

37 
	~"sys.h
"

38 
	~"°imî.h
"

39 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

66 
ång_öô
();

72 
ång_ønd
();

	@platform/chip_b91/uart.h

34 #i‚de‡ 
UART_H_


35 
	#UART_H_


	)

37 
	~"gpio.h
"

38 
	~"dma.h
"

39 
	~"timî.h
"

40 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

42 
u¨t_rx_byã_ödex
[2];

43 
u¨t_tx_byã_ödex
[2];

45 
	#u¨t_πx_pö_tx_åig
(
u¨t_num
Ë
	`u¨t_˛r_tx_d⁄e
(u¨t_num)

	)

63 
	mUART_PARITY_NONE
 = 0,

64 
	mUART_PARITY_EVEN
,

65 
	mUART_PARITY_ODD
,

66 } 
	tu¨t_∑rôy_e
;

72 
	mUART0
 = 0,

73 
	mUART1
,

74 }
	tu¨t_num_e
;

80 
	mUART_BW_MUL1
 = 0,

81 
	mUART_BW_MUL2
 = 1,

82 
	mUART_BW_MUL3
 = 2,

83 
	mUART_BW_MUL4
 = 3,

84 } 
	tu¨t_timeout_mul_e
;

90 
	mUART_STOP_BIT_ONE
 = 0,

91 
	mUART_STOP_BIT_ONE_DOT_FIVE
 = 
BIT
(4),

92 
	mUART_STOP_BIT_TWO
 = 
BIT
(5),

93 } 
	tu¨t_°›_bô_e
;

99 
	mUART_RTS_MODE_AUTO
 = 0,

100 
	mUART_RTS_MODE_MANUAL
,

101 } 
	tu¨t_πs_mode_e
;

107 
	mUART0_CTS_PA1
 = 
GPIO_PA1
,

108 
	mUART0_CTS_PB6
 = 
GPIO_PB6
,

109 
	mUART0_CTS_PD0
 = 
GPIO_PD0
,

111 
	mUART1_CTS_PC4
 = 
GPIO_PC4
,

112 
	mUART1_CTS_PD4
 = 
GPIO_PD4
,

113 
	mUART1_CTS_PE1
 = 
GPIO_PE1
,

114 }
	tu¨t_˘s_pö_e
;

120 
	mUART0_RTS_PA2
 = 
GPIO_PA2
,

121 
	mUART0_RTS_PB4
 = 
GPIO_PB4
,

122 
	mUART0_RTS_PD1
 = 
GPIO_PD1
,

124 
	mUART1_RTS_PC5
 = 
GPIO_PC5
,

125 
	mUART1_RTS_PD5
 = 
GPIO_PD5
,

126 
	mUART1_RTS_PE3
 = 
GPIO_PE3
,

127 }
	tu¨t_πs_pö_e
;

133 
	mUART0_TX_PA3
 = 
GPIO_PA3
,

134 
	mUART0_TX_PB2
 = 
GPIO_PB2
,

135 
	mUART0_TX_PD2
 = 
GPIO_PD2
,

137 
	mUART1_TX_PC6
 = 
GPIO_PC6
,

138 
	mUART1_TX_PD6
 = 
GPIO_PD6
,

139 
	mUART1_TX_PE0
 = 
GPIO_PE0
,

140 }
	tu¨t_tx_pö_e
;

147 
	mUART0_RX_PA4
 = 
GPIO_PA4
,

148 
	mUART0_RX_PB3
 = 
GPIO_PB3
,

149 
	mUART0_RX_PD3
 = 
GPIO_PD3
,

151 
	mUART1_RX_PC7
 = 
GPIO_PC7
,

152 
	mUART1_RX_PD7
 = 
GPIO_PD7
,

153 
	mUART1_RX_PE2
 = 
GPIO_PE2
,

154 }
	tu¨t_rx_pö_e
;

160 
	mUART_RX_IRQ_MASK
 = 
BIT
(0),

161 
	mUART_TX_IRQ_MASK
 = 
BIT
(1),

162 
	mUART_RXDONE_MASK
 = 
BIT
(2),

163 
	mUART_TXDONE_MASK
 = 
BIT
(3),

164 
	mUART_ERR_IRQ_MASK
 = 
BIT
(4),

165 }
	tu¨t_úq_mask_e
;

174 
	mUART_RX_ERR
 = 
BIT
(7),

175 
	mUART_TXDONE
 = 
BIT
(0),

176 
	mUART_TXBUF_IRQ_STATUS
 = 
BIT
(1),

177 
	mUART_RXDONE
 = 
BIT
(2),

178 
	mUART_RXBUF_IRQ_STATUS
 = 
BIT
(3),

179 }
	tu¨t_úq_°©us_gë_e
;

185 
	mUART_CLR_RX
 = 
BIT
(6),

186 
	mUART_CLR_TX
 = 
BIT
(7),

187 }
	tu¨t_úq_°©us_˛r_e
;

201 
ölöe
 
	$u¨t_gë_rxfifo_num
(
u¨t_num_e
 
u¨t_num
)

203  
	`ªg_u¨t_buf_˙t
(
u¨t_num
)&
FLD_UART_RX_BUF_CNT
 ;

204 
	}
}

211 
ölöe
 
	$u¨t_gë_txfifo_num
(
u¨t_num_e
 
u¨t_num
)

213  (
	`ªg_u¨t_buf_˙t
(
u¨t_num
)&
FLD_UART_TX_BUF_CNT
 )>>4;

214 
	}
}

221 
ölöe
 
	$u¨t_ª£t
(
u¨t_num_e
 
u¨t_num
)

224 
ªg_r°0
 &(~((
u¨t_num
)?
FLD_RST0_UART1
:
FLD_RST0_UART0
));

225 
ªg_r°0
 |((
u¨t_num
)?
FLD_RST0_UART1
:
FLD_RST0_UART0
);

226 
	}
}

233 
ölöe
 
	$u¨t_˛k_í
(
u¨t_num_e
 
u¨t_num
)

235 
ªg_˛k_í0
 |((
u¨t_num
)?
FLD_CLK0_UART1_EN
:
FLD_CLK0_UART0_EN
);

236 
	}
}

264 
u¨t_öô
(
u¨t_num_e
 
u¨t_num
,
div
, 
bwpc
, 
u¨t_∑rôy_e
 
∑rôy
, 
u¨t_°›_bô_e
 
°›_bô
);

277 
u¨t_ˇl_div_™d_bwpc
(
baudøã
, 
sys˛k
, * 
div
, *
bwpc
);

289 
u¨t_£t_dma_rx_timeout
(
u¨t_num_e
 
u¨t_num
,
bwpc
, 
bô_˙t
, 
u¨t_timeout_mul_e
 
mul
);

297 
ölöe
 
	$u¨t_rx_úq_åig_Àvñ
(
u¨t_num_e
 
u¨t_num
,
rx_Àvñ
)

299 
	`ªg_u¨t_˘æ3
(
u¨t_num
Ë‘eg_u¨t_˘æ3(u¨t_numË& (~
FLD_UART_RX_IRQ_TRIQ_LEV
)Ë| (
rx_Àvñ
 & 0x0f);

300 
	}
}

308 
ölöe
 
	$u¨t_tx_úq_åig_Àvñ
(
u¨t_num_e
 
u¨t_num
,
tx_Àvñ
)

310 
	`ªg_u¨t_˘æ3
(
u¨t_num
Ë‘eg_u¨t_˘æ3(u¨t_numË& (~
FLD_UART_TX_IRQ_TRIQ_LEV
)Ë| (
tx_Àvñ
 << 4);

311 
	}
}

319 
u¨t_£nd_byã
(
u¨t_num_e
 
u¨t_num
,
tx_d©a
);

326 
u¨t_ªad_byã
(
u¨t_num_e
 
u¨t_num
);

333 
u¨t_tx_is_busy
(
u¨t_num_e
 
u¨t_num
);

340 
u¨t_£nd_hw‹d
(
u¨t_num_e
 
u¨t_num
, 
d©a
);

348 
u¨t_£nd_w‹d
(
u¨t_num_e
 
u¨t_num
, 
d©a
);

357 
u¨t_£t_πs_Àvñ
(
u¨t_num_e
 
u¨t_num
, 
pﬁ¨ôy
);

364 
u¨t_£t_˘s_pö
(
u¨t_˘s_pö_e
 
˘s_pö
);

371 
u¨t_£t_πs_pö
(
u¨t_πs_pö_e
 
πs_pö
);

379 
u¨t_£t_pö
(
u¨t_tx_pö_e
 
tx_pö
,
u¨t_rx_pö_e
 
rx_pö
);

386 
u¨t_£t_πx_pö
(
u¨t_rx_pö_e
 
rx_pö
);

397 
u¨t_£nd_dma
(
u¨t_num_e
 
u¨t_num
, * 
addr
, 
Àn
 );

406 
u¨t_£nd
(
u¨t_num_e
 
u¨t_num
, * 
addr
, 
Àn
 );

417 
u¨t_ª˚ive_dma
(
u¨t_num_e
 
u¨t_num
, * 
addr
,
ªv_size
);

425 
u¨t_gë_dma_ªv_d©a_Àn
(
u¨t_num_e
 
u¨t_num
, 
dma_chn_e
 
chn
);

433 
u¨t_£t_tx_dma_c⁄fig
(
u¨t_num_e
 
u¨t_num
, 
dma_chn_e
 
chn
);

441 
u¨t_£t_rx_dma_c⁄fig
(
u¨t_num_e
 
u¨t_num
, 
dma_chn_e
 
chn
);

449 
ölöe
 
	$u¨t_£t_úq_mask
(
u¨t_num_e
 
u¨t_num
,
u¨t_úq_mask_e
 
mask
)

451 if((
mask
 & 
UART_RX_IRQ_MASK
Ë|| (mask & 
UART_TX_IRQ_MASK
))

453 
	`ªg_u¨t_˘æ0
(
u¨t_num
Ë|(((
mask
 & 
UART_RX_IRQ_MASK
)? 1:0Ë<< 6Ë| (((mask & 
UART_TX_IRQ_MASK
)? 1:0 )<< 7);

456 if((
mask
 & 
UART_RXDONE_MASK
Ë|| (mask & 
UART_TXDONE_MASK
Ë|| (mask & 
UART_ERR_IRQ_MASK
))

458 
	`ªg_u¨t_rx_timeout1
(
u¨t_num
Ë|(((
mask
 & 
UART_RXDONE_MASK
)? 1:0Ë<< 2Ë| (((mask & 
UART_TXDONE_MASK
Ë? 1:0 )<< 6Ë| (((mask & 
UART_ERR_IRQ_MASK
) ? 1:0 )<< 7);

460 
	}
}

468 
ölöe
 
	$u¨t_˛r_úq_mask
(
u¨t_num_e
 
u¨t_num
,
u¨t_úq_mask_e
 
mask
)

470 if((
mask
 & 
UART_RX_IRQ_MASK
Ë|| (mask & 
UART_TX_IRQ_MASK
))

472 
	`ªg_u¨t_˘æ0
(
u¨t_num
Ë&~((((
mask
 & 
UART_RX_IRQ_MASK
)? 1:0)<< 6Ë| (((mask & 
UART_TX_IRQ_MASK
)? 1:0) << 7));

474 if((
mask
 & 
UART_RXDONE_MASK
Ë|| (mask & 
UART_TXDONE_MASK
Ë|| (mask & 
UART_ERR_IRQ_MASK
)){

475 
	`ªg_u¨t_rx_timeout1
(
u¨t_num
Ë&~((((
mask
 & 
UART_RXDONE_MASK
)? 1:0Ë<< 2Ë| (((mask & 
UART_TXDONE_MASK
)? 1:0)<< 6Ë| (((mask & 
UART_ERR_IRQ_MASK
)? 1:0) << 7));

477 
	}
}

486 
ölöe
 
	$u¨t_gë_úq_°©us
(
u¨t_num_e
 
u¨t_num
,
u¨t_úq_°©us_gë_e
 
°©us
)

488 if(
°©us
 =
UART_RX_ERR
){

489  (
	`ªg_u¨t_°©us1
(
u¨t_num
Ë& (
°©us
));

493  (
	`ªg_u¨t_°©us2
(
u¨t_num
Ë& (
°©us
));

495 
	}
}

504 
ölöe
 
	$u¨t_˛r_úq_°©us
(
u¨t_num_e
 
u¨t_num
,
u¨t_úq_°©us_˛r_e
 
°©us
)

506 
	`ªg_u¨t_°©us1
(
u¨t_num
Ë|(
°©us
);

507 
	}
}

514 
ölöe
 
	$u¨t_£t_πs_í
(
u¨t_num_e
 
u¨t_num
)

516 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë|
FLD_UART_RTS_EN
;

517 
	}
}

524 
ölöe
 
	$u¨t_£t_πs_dis
(
u¨t_num_e
 
u¨t_num
)

526 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë&(~
FLD_UART_RTS_EN
);

527 
	}
}

534 
ölöe
 
	$u¨t_£t_˘s_í
(
u¨t_num_e
 
u¨t_num
)

536 
	`ªg_u¨t_˘æ1
(
u¨t_num
Ë|
FLD_UART_TX_CTS_ENABLE
;

537 
	}
}

544 
ölöe
 
	$u¨t_£t_˘s_dis
(
u¨t_num_e
 
u¨t_num
)

546 
	`ªg_u¨t_˘æ1
(
u¨t_num
Ë&(~
FLD_UART_TX_CTS_ENABLE
);

547 
	}
}

556 
u¨t_˘s_c⁄fig
(
u¨t_num_e
 
u¨t_num
,
u¨t_˘s_pö_e
 
˘s_pö
,
˘s_∑rôy
);

566 
u¨t_πs_c⁄fig
(
u¨t_num_e
 
u¨t_num
,
u¨t_πs_pö_e
 
πs_pö
,
πs_∑rôy
,
auto_mode_í
);

574 
ölöe
 
	$u¨t_πs_åig_Àvñ_auto_mode
(
u¨t_num_e
 
u¨t_num
,
Àvñ
)

576 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë&(~
FLD_UART_RTS_TRIQ_LEV
);

577 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë|(
Àvñ
 & 
FLD_UART_RTS_TRIQ_LEV
);

578 
	}
}

585 
ölöe
 
	$u¨t_πs_auto_mode
(
u¨t_num_e
 
u¨t_num
)

587 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë&(~
FLD_UART_RTS_MANUAL_M
);

588 
	}
}

595 
ölöe
 
	$u¨t_πs_m™uÆ_mode
(
u¨t_num_e
 
u¨t_num
)

597 
	`ªg_u¨t_˘æ2
(
u¨t_num
Ë|(
FLD_UART_RTS_MANUAL_M
);

598 
	}
}

607 
ölöe
 
	$u¨t_˛r_rx_ödex
(
u¨t_num_e
 
u¨t_num
)

609 
u¨t_rx_byã_ödex
[
u¨t_num
]=0;

610 
	}
}

618 
ölöe
 
	$u¨t_˛r_tx_ödex
(
u¨t_num_e
 
u¨t_num
)

620 
u¨t_tx_byã_ödex
[
u¨t_num
]=0;

621 
	}
}

628 
ölöe
 
	$u¨t_˛r_tx_d⁄e
(
u¨t_num_e
 
u¨t_num
)

630 
	`ªg_u¨t_°©e
(
u¨t_num
Ë|=
	`BIT
(7);

631 
	}
}

638 
ölöe
 
	$u¨t_πx_í
(
u¨t_num_e
 
chn
)

640 
	`ªg_u¨t_rx_timeout1
(
chn
)|=
FLD_UART_P7816_EN
;

641 
	}
}

	@platform/chip_b91/usbhw.h

35 #¥agm®
⁄˚


37 
	~"ªg_ö˛ude/ªgi°î_b91.h
"

38 
	~"™Æog.h
"

39 
	~"gpio.h
"

43 
	mUSB_IRQ_RESET_MASK
 =
BIT
(0),

44 
	mUSB_IRQ_250US_MASK
 =
BIT
(1),

45 
	mUSB_IRQ_SUSPEND_MASK
 =
BIT
(2),

46 }
	tusb_úq_mask_e
;

50 
	mUSB_IRQ_RESET_STATUS
 =
BIT
(5),

51 
	mUSB_IRQ_250US_STATUS
 =
BIT
(6),

52 
	mUSB_IRQ_SUSPEND_STATUS
 =
BIT
(7),

53 }
	tusb_úq_°©us_e
;

61 
ölöe
 
	$usbhw_£t_ï8_fifo_mode
() {

62 
	`BM_SET
(
ªg_usb_ï8_fifo_mode
,
FLD_USB_ENP8_FIFO_MODE
);

63 
	}
}

69 
ölöe
 
	$usbhw_ª£t_˘æ_ï_±r
() {

70 
ªg_˘æ_ï_±r
 = 0;

71 
	}
}

77 
ölöe
 
	$usbhw_gë_˘æ_ï_úq
() {

78  
ªg_˘æ_ï_úq_°a
;

79 
	}
}

86 
ölöe
 
	$usbhw_˛r_˘æ_ï_úq
(
ï
) {

87 #ifde‡
WIN32


88 
	`BM_CLR
(
ªg_˘æ_ï_úq_°a
, 
ï
);

90 
ªg_˘æ_ï_úq_°a
 = 
ï
;

92 
	}
}

99 
ölöe
 
	$usbhw_wrôe_˘æ_ï_˘æ
(
d©a
) {

100 
ªg_˘æ_ï_˘æ
 = 
d©a
;

101 
	}
}

107 
ölöe
 
	$usbhw_ªad_˘æ_ï_d©a
() {

108  
ªg_˘æ_ï_d©
;

109 
	}
}

116 
ölöe
 
	$usbhw_wrôe_˘æ_ï_d©a
(
d©a
) {

117 
ªg_˘æ_ï_d©
 = 
d©a
;

118 
	}
}

124 
ölöe
 
	$usbhw_is_˘æ_ï_busy
() {

125  
ªg_˘æ_ï_úq_°a
 & 
FLD_USB_EP_BUSY
;

126 
	}
}

134 
ölöe
 
	$usbhw_ª£t_ï_±r
(
ï
) {

135 
	`ªg_usb_ï_±r
(
ï
) = 0;

136 
	}
}

142 
ölöe
 
	$usbhw_£t_ïs_úq_mask
(
usb_ï_úq_e
 
mask
)

144 
ªg_usb_ï_úq_mask
|=
mask
;

146 
	}
}

152 
ölöe
 
	$usbhw_˛r_ïs_úq_mask
(
usb_ï_úq_e
 
mask
)

154 
ªg_usb_ï_úq_mask
 &=(~
mask
);

156 
	}
}

162 
ölöe
 
	$usbhw_gë_ïs_úq
() {

163  
ªg_usb_ï_úq_°©us
;

164 
	}
}

171 
ölöe
 
	$usbhw_˛r_ïs_úq
(
ï
) {

172 
ªg_usb_ï_úq_°©us
 = 
ï
;

173 
	}
}

180 
ölöe
 
	$usbhw_£t_úq_mask
–
usb_úq_mask_e
 
mask
)

182 
ªg_usb_úq_mask
|=
mask
;

183 
	}
}

190 
ölöe
 
	$usbhw_˛r_úq_mask
–
usb_úq_mask_e
 
mask
)

192 
ªg_usb_úq_mask
 &(~
mask
);

193 
	}
}

200 
ölöe
 
	$usbhw_gë_úq_°©us
(
usb_úq_°©us_e
 
°©us
)

202  
ªg_usb_úq_mask
&
°©us
;

203 
	}
}

210 
ölöe
 
	$usbhw_˛r_úq_°©us
(
usb_úq_°©us_e
 
°©us
)

212 
ªg_usb_úq_mask
|=
°©us
;

213 
	}
}

221 
ölöe
 
	$usbhw_£t_ïs_í
(
usb_ï_í_e
 
ï
)

223 
ªg_usb_edp_í

ï
;

224 
	}
}

231 
ölöe
 
	$usbhw_£t_ïs_dis
(
usb_ï_í_e
 
ï
)

233 
ªg_usb_edp_í
 &=(~ 
ï
);

234 
	}
}

241 
ölöe
 
	$usbhw_ªad_ï_d©a
(
ï
) {

242  
	`ªg_usb_ï_d©
(
ï
);

243 
	}
}

251 
ölöe
 
	$usbhw_wrôe_ï_d©a
(
ï
, 
d©a
) {

252 
	`ªg_usb_ï_d©
(
ï
Ë
d©a
;

253 
	}
}

263 
ölöe
 
	$usbhw_£t_ï_í
(
ï
, 
í
) {

264 if(
í
)

266 
ªg_usb_edp_í
 |
ï
;

270 
ªg_usb_edp_í
 &~(
ï
);

272 
	}
}

279 
ölöe
 
	$usbhw_is_ï_busy
(
ï
) {

280  
	`ªg_usb_ï_˘æ
(
ï
Ë& 
FLD_USB_EP_BUSY
;

281 
	}
}

288 
ölöe
 
	$usbhw_d©a_ï_ack
(
ï
) {

289 
	`ªg_usb_ï_˘æ
(
ï
Ë
FLD_USB_EP_BUSY
;

290 
	}
}

297 
ölöe
 
	$usbhw_d©a_ï_°Æl
(
ï
) {

298 
	`ªg_usb_ï_˘æ
(
ï
Ë
FLD_USB_EP_STALL
;

299 
	}
}

307 
ölöe
 
	$usbhw_£t_¥öãr_thªshﬁd
(
th
) {

308 
ªg_usb_ï8_£nd_thª
 = 
th
;

309 
	}
}

312 
	mUSB_EDP_PRINTER_IN
 = 8,

313 
	mUSB_EDP_MOUSE
 = 2,

314 
	mUSB_EDP_KEYBOARD_IN
 = 1,

315 
	mUSB_EDP_IN
 = 3,

316 
	mUSB_EDP_AUDIO_IN
 = 4,

317 
	mUSB_EDP_PRINTER_OUT
 = 5,

318 
	mUSB_EDP_SPEAKER
 = 6,

319 
	mUSB_EDP_MIC
 = 7,

320 
	mUSB_EDP_MS_IN
 = 
USB_EDP_PRINTER_IN
,

321 
	mUSB_EDP_MS_OUT
 = 
USB_EDP_PRINTER_OUT
,

322 
	mUSB_EDP_SOMATIC_IN
 = 
USB_EDP_AUDIO_IN
,

323 
	mUSB_EDP_SOMATIC_OUT
 = 
USB_EDP_PRINTER_OUT
,

324 
	mUSB_EDP_CDC_IN
 = 4,

325 
	mUSB_EDP_CDC_OUT
 = 5,

330 
	mUSB_HID_AUDIO
 = 2,

331 
	mUSB_HID_MOUSE
 = 1,

332 
	mUSB_HID_KB_MEDIA
 = 3,

333 
	mUSB_HID_KB_SYS
 = 4,

334 
	mUSB_HID_SOMATIC
 = 5,

344 
usbhw_dißbÀ_m™uÆ_öãºu±
(
m
);

351 
usbhw_íabÀ_m™uÆ_öãºu±
(
m
);

360 
usbhw_wrôe_ï
(
ï
, * 
d©a
, 
Àn
);

368 
usbhw_wrôe_˘æ_ï_u16
(
v
);

374 
usbhw_ªad_˘æ_ï_u16
();

381 
ölöe
 
	$usb_dp_puŒup_í
 (
í
)

383 
d©
 = 
	`™Æog_ªad_ªg8
(0x0b);

384 i‡(
í
) {

385 
d©
 = d© | 
	`BIT
(7);

389 
d©
 = dat & 0x7f ;

392 
	`™Æog_wrôe_ªg8
 (0x0b, 
d©
);

393 
	}
}

400 
ölöe
 
	$usb_powî_⁄
(
í
)

402 if(
í
)

404 
	`™Æog_wrôe_ªg8
(0x7d,
	`™Æog_ªad_ªg8
(0x7d)&0xfd);

408 
	`™Æog_wrôe_ªg8
(0x7d,
	`™Æog_ªad_ªg8
(0x7d)|0x02);

410 
	}
}

416 
ölöe
 
	$usb_£t_pö_í
()

418 
	`ªg_gpio_func_mux
(
GPIO_PA5
)Ùeg_gpio_func_mux(GPIO_PA5)&(~
	`BIT_RNG
(2,3));

419 
	`gpio_fun˘i⁄_dis
(
GPIO_PA5
);

420 
	`ªg_gpio_func_mux
(
GPIO_PA6
)Ùeg_gpio_func_mux(GPIO_PA6)&(~
	`BIT_RNG
(4,5));

421 
	`gpio_fun˘i⁄_dis
(
GPIO_PA6
);

422 
	`gpio_öput_í
(
GPIO_PA5
|
GPIO_PA6
);

423 
	`usb_dp_puŒup_í
 (1);

424 
	}
}

	@platform/chip_b91/watchdog.h

24 #i‚de‡
WATCHDOG_H_


25 
	#WATCHDOG_H_


	)

26 
	~"™Æog.h
"

27 
	~"gpio.h
"

33 
ölöe
 
	$wd_°¨t
(){

35 
	`BM_SET
(
ªg_tmr_˘æ2
, 
FLD_TMR_WD_EN
);

36 
	}
}

43 
ölöe
 
	$wd_°›
(){

44 
	`BM_CLR
(
ªg_tmr_˘æ2
, 
FLD_TMR_WD_EN
);

45 
	}
}

52 
ölöe
 
	$wd_˛ór
()

54 
ªg_tmr_°a
 = 
FLD_TMR_STA_WD
|
FLD_TMR_WD_CNT_CLR
;

56 
	}
}

62 
ölöe
 
	$wd_˛ór_˙t
()

64 
ªg_tmr_°a
 = 
FLD_TMR_WD_CNT_CLR
;

66 
	}
}

76 
ölöe
 
	$wd_£t_öãrvÆ_ms
(
≥riod_ms
)

78 
tmp_≥riod_ms
 = 0;

79 
tmp_≥riod_ms
=
≥riod_ms
*
sys_˛k
.
p˛k
*1000;

80 
ªg_wt_èrgë
=
tmp_≥riod_ms
;

81 
	}
}

	@platform/platform.h

24 #¥agm®
⁄˚


27 #i‡
deföed
 (
MCU_CORE_826x
)

28 
	~"chù_826x/drivî_826x.h
"

29 
	~"chù_826x/gpio_deÁu….h
"

30 #ñi‡
deföed
 (
MCU_CORE_8258
)

31 
	~"chù_8258/drivî_8258.h
"

32 
	~"chù_8258/gpio_deÁu….h
"

33 #ñi‡
deföed
 (
MCU_CORE_8278
)

34 
	~"chù_8278/drivî_8278.h
"

35 
	~"chù_8278/gpio_deÁu….h
"

36 #ñi‡
deföed
 (
MCU_CORE_B91
)

37 
	~"chù_b91/drivî_b91.h
"

38 
	~"chù_b91/gpio_deÁu….h
"

	@platform/riscv/firmware_encrypt.h

24 #i‚de‡
ENCRYPT_H_


25 
	#ENCRYPT_H_


	)

27 
fúmw¨e_í¸y±_ba£d_⁄_uid
(* 
uid
,* 
cùhîãxt
);

	@platform/services/b85m/irq_handler.c

24 
	~"é_comm⁄.h
"

26 #i‡(
__PROJECT_TL_SNIFFER__
)

27 
úq_¢if„r_h™dÀr
();

29 
rf_rx_úq_h™dÀr
();

30 
rf_tx_úq_h™dÀr
();

32 vﬁ©ûê
u8
 
	gT_DBG_úqTe°
[16] = {0};

35 
_©åibuã_øm_code_
 
	$úq_h™dÀr
(){

36 #i‡(
__PROJECT_TL_BOOT_LOADER__
)

38 #ñi‡(
__PROJECT_TL_SNIFFER__
)

39 
	`úq_¢if„r_h™dÀr
();

41 
u16
 
§c_rf
 = 
	`rf_úq_§c_gë
();

42 if(
§c_rf
 & 
FLD_RF_IRQ_TX
){

43 
	`rf_úq_˛r_§c
(
FLD_RF_IRQ_TX
);

44 
T_DBG_úqTe°
[0]++;

45 
	`rf_tx_úq_h™dÀr
();

48 if(
§c_rf
 & 
FLD_RF_IRQ_RX
){

49 
	`rf_úq_˛r_§c
(
FLD_RF_IRQ_RX
);

50 
T_DBG_úqTe°
[1]++;

51 
	`rf_rx_úq_h™dÀr
();

54 
u32
 
§c
 = 
	`úq_gë_§c
();

56 if((
§c
 & 
FLD_IRQ_TMR0_EN
)){

57 
ªg_úq_§c
 = 
FLD_IRQ_TMR0_EN
;

58 
ªg_tmr_°a
 = 
FLD_TMR_STA_TMR0
;

59 
T_DBG_úqTe°
[2]++;

60 
	`drv_timî_úq0_h™dÀr
();

63 if((
§c
 & 
FLD_IRQ_TMR1_EN
)){

64 
ªg_úq_§c
 = 
FLD_IRQ_TMR1_EN
;

65 
ªg_tmr_°a
 = 
FLD_TMR_STA_TMR1
;

66 
T_DBG_úqTe°
[3]++;

67 
	`drv_timî_úq1_h™dÀr
();

70 if((
§c
 & 
FLD_IRQ_SYSTEM_TIMER
)){

71 
ªg_úq_§c
 = 
FLD_IRQ_SYSTEM_TIMER
;

72 
T_DBG_úqTe°
[4]++;

73 
	`drv_timî_úq3_h™dÀr
();

76 if((
§c
 & 
FLD_IRQ_GPIO_EN
)==FLD_IRQ_GPIO_EN){

77 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_EN
;

78 
T_DBG_úqTe°
[5]++;

79 
	`drv_gpio_úq_h™dÀr
();

82 if((
§c
 & 
FLD_IRQ_GPIO_RISC0_EN
)==FLD_IRQ_GPIO_RISC0_EN){

83 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC0_EN
;

84 
T_DBG_úqTe°
[6]++;

85 
	`drv_gpio_úq_risc0_h™dÀr
();

88 if((
§c
 & 
FLD_IRQ_GPIO_RISC1_EN
)==FLD_IRQ_GPIO_RISC1_EN){

89 
ªg_úq_§c
 = 
FLD_IRQ_GPIO_RISC1_EN
;

90 
T_DBG_úqTe°
[7]++;

91 
	`drv_gpio_úq_risc1_h™dÀr
();

94 
u16
 
dma_úq_sour˚
 = 
	`dma_chn_úq_°©us_gë
();

96 if(
dma_úq_sour˚
 & 
FLD_DMA_CHN_UART_RX
){

97 
	`dma_chn_úq_°©us_˛r
(
FLD_DMA_CHN_UART_RX
);

98 
T_DBG_úqTe°
[8]++;

99 
	`drv_u¨t_rx_úq_h™dÀr
();

100 }if(
dma_úq_sour˚
 & 
FLD_DMA_CHN_UART_TX
){

101 
	`dma_chn_úq_°©us_˛r
(
FLD_DMA_CHN_UART_TX
);

102 
T_DBG_úqTe°
[9]++;

103 
	`drv_u¨t_tx_úq_h™dÀr
();

105 
	`dma_chn_úq_°©us_˛r
(~(
FLD_DMA_CHN_UART_TX
 | 
FLD_DMA_CHN_UART_RX
));

108 
	}
}

	@platform/services/b91m/irq_handler.c

24 
	~"é_comm⁄.h
"

26 
rf_rx_úq_h™dÀr
();

27 
rf_tx_úq_h™dÀr
();

31 vﬁ©ûê
u8
 
	gT_DBG_ã°Irq
[16] = {0};

33 
	$rf_úq_h™dÀr
()

35 
T_DBG_ã°Irq
[0]++;

36 if(
	`rf_gë_úq_°©us
(
FLD_RF_IRQ_RX
)){

37 
	`rf_˛r_úq_°©us
(
FLD_RF_IRQ_RX
);

38 
T_DBG_ã°Irq
[1]++;

39 
	`rf_rx_úq_h™dÀr
();

40 }if(
	`rf_gë_úq_°©us
(
FLD_RF_IRQ_TX
)){

41 
	`rf_˛r_úq_°©us
(
FLD_RF_IRQ_TX
);

42 
T_DBG_ã°Irq
[2]++;

43 
	`rf_tx_úq_h™dÀr
();

45 
T_DBG_ã°Irq
[3]++;

46 
	`rf_˛r_úq_°©us
(0xffff);

48 
	}
}

50 
	$timî0_úq_h™dÀr
()

52 if(
	`timî_gë_úq_°©us
(
TMR_STA_TMR0
)){

53 
	`timî_˛r_úq_°©us
(
TMR_STA_TMR0
);

54 
	`drv_timî_úq0_h™dÀr
();

56 
	}
}

58 
	$timî1_úq_h™dÀr
()

60 if(
	`timî_gë_úq_°©us
(
TMR_STA_TMR1
)){

61 
	`timî_˛r_úq_°©us
(
TMR_STA_TMR1
);

62 
	`drv_timî_úq1_h™dÀr
();

64 
	}
}

66 
	$°imî_úq_h™dÀr
()

68 if(
	`°imî_gë_úq_°©us
(
FLD_SYSTEM_IRQ
)){

69 
	`°imî_˛r_úq_°©us
(
FLD_SYSTEM_IRQ
);

70 
T_DBG_ã°Irq
[4]++;

71 
	`drv_timî_úq3_h™dÀr
();

73 
	}
}

75 
	$gpio_úq_h™dÀr
()

77 
T_DBG_ã°Irq
[5]++;

78 
	`gpio_˛r_úq_°©us
(
FLD_GPIO_IRQ_CLR
);

79 
	`drv_gpio_úq_h™dÀr
();

80 
	}
}

82 
	$gpio_risc0_úq_h™dÀr
()

84 
T_DBG_ã°Irq
[6]++;

85 
	`gpio_˛r_úq_°©us
(
FLD_GPIO_IRQ_GPIO2RISC0_CLR
);

86 
	`drv_gpio_úq_risc0_h™dÀr
();

87 
	}
}

89 
	$gpio_risc1_úq_h™dÀr
()

91 
T_DBG_ã°Irq
[7]++;

92 
	`gpio_˛r_úq_°©us
(
FLD_GPIO_IRQ_GPIO2RISC1_CLR
);

93 
	`drv_gpio_úq_risc1_h™dÀr
();

94 
	}
}

96 
	$u¨t0_úq_h™dÀr
()

98 if(
	`u¨t_gë_úq_°©us
(
UART0
, 
UART_TXDONE
)){

99 
T_DBG_ã°Irq
[8]++;

100 
	`drv_u¨t_tx_úq_h™dÀr
();

103 if(
	`u¨t_gë_úq_°©us
(
UART0
, 
UART_RXDONE
)){

104 
T_DBG_ã°Irq
[9]++;

105 
	`drv_u¨t_rx_úq_h™dÀr
();

107 
	}
}

	@platform/tc32/div_mod.S

24 
	#UDIV
 #0

	)

25 
	#SDIV
 #1

	)

26 
	#UMOD
 #2

	)

27 
	#SMOD
 #3

	)

29 .
	gcode
 16

30 .
	gãxt


32 .
	gÆign
 2

33 .
globÆ
 
	g__modsi3


34 .
	gcode
 16

35 .
	gthumb_func


36 .
ty≥
 
	g__modsi3
, %
fun˘i⁄


37 
	g__modsi3
:

38 
tmov
 
r2
, 
SMOD


39 
tj
 
	gdiv


40 .
size
 
	g__modsi3
, .-__modsi3

42 .
	gÆign
 2

43 .
globÆ
 
	g__divsi3


44 .
	gcode
 16

45 .
	gthumb_func


46 .
ty≥
 
	g__divsi3
, %
fun˘i⁄


47 
	g__divsi3
:

48 
tmov
 
r2
, 
SDIV


49 
tj
 
	gdiv


50 .
size
 
	g__divsi3
, .-__divsi3

52 .
	gÆign
 2

53 .
globÆ
 
	g__umodsi3


54 .
	gcode
 16

55 .
	gthumb_func


56 .
ty≥
 
	g__umodsi3
, %
fun˘i⁄


57 
	g__umodsi3
:

58 
tmov
 
r2
, 
UMOD


59 
tj
 
	gdiv


60 .
size
 
	g__umodsi3
, .-__umodsi3

62 .
	gÆign
 2

63 .
globÆ
 
	g__udivsi3


64 .
	gcode
 16

65 .
	gthumb_func


66 .
ty≥
 
	g__udivsi3
, %
fun˘i⁄


67 
	g__udivsi3
:

68 
tmov
 
r2
, 
UDIV


69 
tj
 
	gdiv


70 .
size
 
	g__udivsi3
, .-__udivsi3

72 .
	gÆign
 2

73 .
globÆ
 
	gdiv


74 .
	gcode
 16

75 .
	gthumb_func


76 .
ty≥
 
	gdiv
, %
fun˘i⁄


77 
	gdiv
:

78 
tmrcs
 
r3


79 
çush
 {
r3
, 
	gr4
}

80 
tmov
 
	gr4
, #0
x80


81 
t‹
 
	gr3
, 
r4


82 
tmc§
 
r3


84 
éﬂdr
 
	gr3
, .
L11


85 
t°‹î
 
	gr0
, [
r3
]

86 
èdd
 
	gr3
,Ñ3, #4

87 
t°‹î
 
	gr1
, [
r3
]

88 
tsub
 
	gr3
,Ñ3, #8

89 
t°‹îb
 
	gr2
, [
r3
]

91 .
	gL2
:

92 
éﬂdrb
 
r0
, [
r3
]

93 
tcmp
 
	gr0
, #0

94 
	gtj√
 .
L2


95 
tcmp
 
	gr2
, #1

96 
	gtjls
 .
L4


97 
èdd
 
	gr3
,Ñ3, #8

98 
éﬂdr
 
	gr0
, [
r3
]

99 
	gtj
 .
	gL6


100 .
	gL4
:

101 
èdd
 
r3
, 
	gr3
, #4

102 
éﬂdr
 
	gr0
, [
r3
]

104 .
	gL6
:

105 
ç›
 {
r3
, 
	gr4
}

106 
tmc§
 
r3


107 
tjex
 
	gÃ


109 .
	gÆign
 4

110 .
	gL11
:

111 .
w‹d
(0x800664)

112 .
w‹d
(0x800660)

113 .
w‹d
(0x800668)

114 .
size
 
div
, .-
	gdiv


	@platform/tc32/firmware_encrypt.h

24 #i‚de‡
ENCRYPT_H_


25 
	#ENCRYPT_H_


	)

27 
fúmw¨e_í¸y±_ba£d_⁄_uid
(* 
uid
,* 
cùhîãxt
);

	@proj/common/assert.h

24 #¥agm®
⁄˚


27 #i‡(
ASSERT_DEBUG_MODE
)

28 
	#as£π
(
exp
Ëdo{ \

	)

29 if(!(
	gexp
)){ \

30 
DEBUG_OUT
("Fûe:%s,Löe:%d\n",
__FILE__
,
__LINE__
); \

35 
	#åa˚_rouã
 do{ \

	)

36 
	`DEBUG_OUT
("Fûe:%s,Löe:%d\n",
__FILE__
,
__LINE__
); \

37 
	}

	$}whûe
(0)

39 
	#as£π
(
ign‹e
Ë((Ë0)

	)

40 
	#åa˚_rouã


	)

48 
	#_STRINGIFY
(
x
Ë#x

	)

49 
	#STRINGIFY
(
x
Ë
	`_STRINGIFY
(x)

	)

51 #ifde‡
__GNUC__


52 
	#COMPILE_MESSAGE
(
x
Ë
	`_Pøgma
 (#x)

	)

55 #i‡(
__SHOW_TODO__
)

56 #ifde‡
__GNUC__


57 
	#TODO
(
x
Ë
	`COMPILE_MESSAGE
(
	`mesßge
 ("--TODO-- " #x))

	)

59 
	#TODO
(
x
Ë
	`__¥agma
(
	`mesßge
("--TODO-- "
	`_STRINGIFY
(xË" ::fun˘i⁄: " 
__FUNCTION__
 "@"
	`STRINGIFY
(
__LINE__
)))

	)

62 
	#TODO
(
x
)

	)

65 #i‡(
__SHOW_WARN__
)

66 #ifde‡
__GNUC__


67 
	#WARN
(
x
Ë
	`COMPILE_MESSAGE
(
	`mesßge
 ("--WARN-- " #x))

	)

69 
	#WARN
(
x
Ë
	`__¥agma
(
	`mesßge
("--WARN-- "
	`_STRINGIFY
(xË" ::fun˘i⁄: " 
__FUNCTION__
 "@"
	`STRINGIFY
(
__LINE__
)))

	)

72 
	#WARN
(
x
)

	)

75 #i‡(
__SHOW_WARN__
)

76 #ifde‡
__GNUC__


77 
	#NOTE
(
x
Ë
	`COMPILE_MESSAGE
(
	`mesßge
 ("--NOTE-- " #x))

	)

79 
	#NOTE
(
x
Ë
	`__¥agma
(
	`mesßge
("--NOTE-- "
	`_STRINGIFY
(xË" ::fun˘i⁄: " 
__FUNCTION__
 "@"
	`STRINGIFY
(
__LINE__
)))

	)

82 
	#NOTE
(
x
)

	)

	@proj/common/bit.h

24 #¥agm®
⁄˚


28 
	~"ma¸o_åick.h
"

30 
	#BIT
(
n
Ë–1<<“Ë)

	)

33 
	#BITS1
(
a
Ë
	`BIT
◊)

	)

34 
	#BITS2
(
a
, 
b
Ë(
	`BIT
◊Ë| BIT(b))

	)

35 
	#BITS3
(
a
, 
b
, 
c
Ë(
	`BIT
◊Ë| BIT(bË| BIT(c))

	)

36 
	#BITS4
(
a
, 
b
, 
c
, 
d
Ë(
	`BIT
◊Ë| BIT(bË| BIT(cË| BIT(d))

	)

37 
	#BITS5
(
a
, 
b
, 
c
, 
d
, 
e
Ë(
	`BIT
◊Ë| BIT(bË| BIT(cË| BIT(dË| BIT”))

	)

38 
	#BITS6
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
Ë(
	`BIT
◊Ë| BIT(bË| BIT(cË| BIT(dË| BIT”Ë| BIT(f))

	)

39 
	#BITS7
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
Ë(
	`BIT
◊Ë| BIT(bË| BIT(cË| BIT(dË| BIT”Ë| BIT(fË| BIT(g))

	)

40 
	#BITS8
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
Ë(
	`BIT
◊Ë| BIT(bË| BIT(cË| BIT(dË| BIT”Ë| BIT(fË| BIT(gË| BIT(h))

	)

42 
	#BITS
(...Ë
	`VARARG
(
BITS
, 
__VA_ARGS__
)

	)

46 
	#BIT_RNG
(
s
, 
e
Ë(
	`BIT_MASK_LEN
(”)-(s)+1Ë<< (s))

	)

48 
	#BM_MASK_V
(
x
, 
mask
Ë–(xË| (maskË)

	)

49 
	#BM_CLR_MASK_V
(
x
, 
mask
Ë–(xË& ~(maskË)

	)

51 
	#BM_SET
(
x
, 
mask
Ë–(xË|(maskË)

	)

52 
	#BM_CLR
(
x
, 
mask
Ë–(xË&~(maskË)

	)

53 
	#BM_IS_SET
(
x
, 
mask
Ë–(xË& (maskË)

	)

54 
	#BM_IS_CLR
(
x
, 
mask
Ë–(~xË& (maskË)

	)

55 
	#BM_FLIP
(
x
, 
mask
Ë–(xË^(maskË)

	)

58 
	#BM_MASK_VAL
(
x
, 
mask
, 
v
Ë–((xË& ~(mask)Ë| (v))

	)

59 
	#BM_SET_MASK_VAL
(
x
, 
mask
, 
v
Ë–(xË
	`BM_MASK_VAL
(x, mask, vË)

	)

62 
	#SETB
(
v
,
n
Ë(*(vﬁ©ûê*)v |n)

	)

63 
	#CLRB
(
v
,
n
Ë(*(vﬁ©ûê*)v &~n)

	)

64 
	#TEST
(
v
,
n
Ë(((*(vﬁ©ûê*)vË&ÇË? 1:0)

	)

65 
	#BIT_SET
(
x
, 
n
Ë((xË|
	`BIT
“))

	)

66 
	#BIT_CLR
(
x
, 
n
Ë((xË&~ 
	`BIT
“))

	)

67 
	#BIT_IS_SET
(
x
, 
n
Ë((xË& 
	`BIT
“))

	)

68 
	#BIT_FLIP
(
x
, 
n
Ë((xË^
	`BIT
“))

	)

69 
	#BIT_SET_HIGH
(
x
Ë((xË|
	`BIT
((((x))*8-1)))

70 
	#BIT_CLR_HIGH
(
x
Ë((xË&~ 
	`BIT
((((x))*8-1)))

71 
	#BIT_IS_SET_HIGH
(
x
Ë((xË& 
	`BIT
((((x))*8-1)))

72 

	)

73 
	#BIT_MASK_LEN
(
Àn
Ë(
	`BIT
÷í)-1)

	)

74 
	#BIT_MASK
(
°¨t
, 
Àn
Ë(
	`BIT_MASK_LEN
÷íË<< (°¨tË)

	)

77 
	#BIT_PREP
(
x
, 
°¨t
, 
Àn
Ë((xË& 
	`BIT_MASK
(°¨t,Üí))

	)

80 
	#BIT_GET
(
x
, 
°¨t
, 
Àn
Ë(((xË>> (°¨t)Ë& 
	`BIT_MASK_LEN
÷í))

	)

81 
	#BIT_GET_LOW
(
x
, 
Àn
Ë((xË& 
	`BIT_MASK_LEN
÷í))

	)

84 
	#BIT_MERGE
(
y
, 
x
, 
°¨t
, 
Àn
Ë\

	)

85 –
	gy
 = ((
y
Ë&~ 
BIT_MASK
(
°¨t
, 
Àn
)Ë| 
	$BIT_PREP
(
x
, 
°¨t
, 
Àn
) )

87 
	#BIT_IS_EVEN
(
x
Ë(((x)&1)==0)

	)

88 
	#BIT_IS_ODD
(
x
Ë(!
	`BIT_IS_EVEN
((x)))

	)

90 
	#BIT_IS_POW2
(
x
Ë(!((xË& ((x)-1)))

	)

93 
	#BIT_TURNOFF_1
(
x
Ë((xË&((x)-1))

	)

95 
	#BIT_ISOLATE_1
(
x
Ë((xË&(-(x)))

	)

97 
	#BIT_PROPAGATE_1
(
x
Ë((xË|((x)-1))

	)

99 
	#BIT_ISOLATE_0
(
x
Ë((xË~(xË& ((x)+1))

	)

101 
	#BIT_TURNON_0
(
x
Ë((xË|((x)+1))

	)

103 
	#CLAMP_TO_ONE
(
x
) (!!(x))

104 

	)

105 
	#ONES
(
x
Ë
	`BIT_MASK_LEN
(x)

	)

106 
	#ONES_32
 0xffffffff

	)

107 
	#ALL_SET
 0xffffffff

	)

111 
	#BFN_PREP
(
x
, 
«me
Ë–((x)<<«me##
_SHIFT
Ë&Çame##
_MASK
 )

	)

114 
	#BFN_GET
(
y
, 
«me
Ë–((yË&Çame##
_MASK
)>>«me##
_SHIFT
 )

	)

117 
	#BFN_SET
(
y
, 
x
, 
«me
Ë(y = ((y)&~«me##
_MASK
Ë| 
	`BFN_PREP
(x,«meË)

	)

120 
¥io
 = 
	`BFN_GET
(
©å2
, 
ATTR2_PRIO
);

121 
	`BFN_SET
(
©å2
, 
x
, 
ATTR2_PRIO
);

137 
	#BIT_LOW_BIT
(
y
Ë(((yË& 
	`BIT
(0))?0:(((yË& BIT(1))?1:(((yË& BIT(2))?2:(((yË& BIT(3))?3: \

	)

138 (((
y
Ë& 
	`BIT
(4))?4:(((y) & BIT(5))?5:(((y) & BIT(6))?6:(((y) & BIT(7))?7: \

139 (((
y
Ë& 
	`BIT
(8))?8:(((y) & BIT(9))?9:(((y) & BIT(10))?10:(((y) & BIT(11))?11: \

140 (((
y
Ë& 
	`BIT
(12))?12:(((y) & BIT(13))?13:(((y) & BIT(14))?14:(((y) & BIT(15))?15: \

141 (((
y
Ë& 
	`BIT
(16))?16:(((y) & BIT(17))?17:(((y) & BIT(18))?18:(((y) & BIT(19))?19: \

142 (((
y
Ë& 
	`BIT
(20))?20:(((y) & BIT(21))?21:(((y) & BIT(22))?22:(((y) & BIT(23))?23: \

143 (((
y
Ë& 
	`BIT
(24))?24:(((y) & BIT(25))?25:(((y) & BIT(26))?26:(((y) & BIT(27))?27: \

144 (((
y
Ë& 
	`BIT
(28))?28:(((y) & BIT(29))?29:(((y) & BIT(30))?30:(((y) & BIT(31))?31:32 \

148 
	#BIT_HIGH_BIT
(
y
Ë(((yË& 
	`BIT
(31))?31:(((yË& BIT(30))?30:(((yË& BIT(29))?29:(((yË& BIT(28))?28: \

	)

149 (((
y
Ë& 
	`BIT
(27))?27:(((y) & BIT(26))?26:(((y) & BIT(25))?25:(((y) & BIT(24))?24: \

150 (((
y
Ë& 
	`BIT
(23))?23:(((y) & BIT(22))?22:(((y) & BIT(21))?21:(((y) & BIT(20))?20: \

151 (((
y
Ë& 
	`BIT
(19))?19:(((y) & BIT(18))?18:(((y) & BIT(17))?17:(((y) & BIT(16))?16: \

152 (((
y
Ë& 
	`BIT
(15))?15:(((y) & BIT(14))?14:(((y) & BIT(13))?13:(((y) & BIT(12))?12: \

153 (((
y
Ë& 
	`BIT
(11))?11:(((y) & BIT(10))?10:(((y) & BIT(9))?9:(((y) & BIT(8))?8: \

154 (((
y
Ë& 
	`BIT
(7))?7:(((y) & BIT(6))?6:(((y) & BIT(5))?5:(((y) & BIT(4))?4: \

155 (((
y
Ë& 
	`BIT
(3))?3:(((y) & BIT(2))?2:(((y) & BIT(1))?1:(((y) & BIT(0))?0:32 \

158 
	#BM_MASK_FLD
(
x
, 
mask
Ë(((xË& (mask)Ë>> 
	`BIT_LOW_BIT
(mask))

	)

159 
	#BM_SET_MASK_FLD
(
x
, 
mask
, 
v
Ë–(xË
	`BM_MASK_VAL
(x,mask,vË)

	)

162 
	#MV
(
m
, 
v
Ë(((vË<< 
	`BIT_LOW_BIT
(m)Ë& (m))

	)

165 
	#MASK_VAL2
(
m
, 
v
Ë(
	`MV
(m,v))

	)

166 
	#MASK_VAL4
(
m1
,
v1
,
m2
,
v2
Ë(
	`MV
(m1,v1)|MV(m2,v2))

	)

167 
	#MASK_VAL6
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3))

	)

168 
	#MASK_VAL8
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
,
m4
,
v4
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3)|MV(m4,v4))

	)

169 
	#MASK_VAL10
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
,
m4
,
v4
,
m5
,
v5
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3)|MV(m4,v4)|MV(m5,v5))

	)

170 
	#MASK_VAL12
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
,
m4
,
v4
,
m5
,
v5
,
m6
,
v6
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3)|MV(m4,v4)|MV(m5,v5)|MV(m6,v6))

	)

171 
	#MASK_VAL14
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
,
m4
,
v4
,
m5
,
v5
,
m6
,
v6
,
m7
,
v7
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3)|MV(m4,v4)|MV(m5,v5)|MV(m6,v6)|MV(m7,v7))

	)

172 
	#MASK_VAL16
(
m1
,
v1
,
m2
,
v2
,
m3
,
v3
,
m4
,
v4
,
m5
,
v5
,
m6
,
v6
,
m7
,
v7
,
m8
,
v8
Ë(
	`MV
(m1,v1)|MV(m2,v2)|MV(m3,v3)|MV(m4,v4)|MV(m5,v5)|MV(m6,v6)|MV(m7,v7)|MV(m8,v8))

	)

174 
	#MASK_VAL
(...Ë
	`VARARG
(
MASK_VAL
, 
__VA_ARGS__
)

	)

176 
	#FLD_MASK_VAL
(
x
, 
mask
, 
v
Ë
	`BM_MASK_VAL
(x, mask, 
	`MV
(mask,v))

	)

178 
	#SET_FLD
(
x
, 
mask
Ë
	`BM_SET
(x, mask)

	)

179 
	#CLR_FLD
(
x
, 
mask
Ë
	`BM_CLR
(x, mask)

	)

180 
	#FLIP_FLD
(
x
, 
mask
Ë
	`BM_FLIP
(x, mask)

	)

182 
	#GET_FLD
(
x
, 
mask
Ë
	`BM_MASK_FLD
(x, mask)

	)

184 #i‚de‡
WIN32


186 
	#SET_FLD_V3
(
x
, 
m
, 
v
Ë\

	)

187 
	`BM_SET_MASK_FLD
(
x
,
m
,
	$MV
(
m
,
v
))

189 
	#SET_FLD_V5
(
x
, 
m1
, 
v1
, 
m2
, 
v2
Ë\

	)

190 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
, 
	`MV
(m1,
v1
)| 
	$MV
(
m2
,
v2
))

192 
	#SET_FLD_V7
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
Ë\

	)

193 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| 
	$MV
(
m3
,
v3
))

195 
	#SET_FLD_V9
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
Ë\

	)

196 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| 
	$MV
(
m4
,
v4
))

198 
	#SET_FLD_V11
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
Ë\

	)

199 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
|
m5
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| MV(m4,
v4
)| 
	$MV
(
m5
,
v5
))

201 
	#SET_FLD_V13
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
, 
m6
, 
v6
Ë\

	)

202 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
|
m5
|
m6
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| MV(m4,
v4
)| MV(m5,
v5
)| 
	$MV
(
m6
,
v6
))

204 
	#SET_FLD_V3
(
x
, 
m
, 
v
Ë\

	)

205 
	`__¥agma
(
	`w¨nög
(
push
)) \

206 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

207 
	`BM_SET_MASK_FLD
(
x
,
m
,
	`MV
(m,
v
)) \

208 
	`__¥agma
(
	$w¨nög
(
p›
))

210 
	#SET_FLD_V5
(
x
, 
m1
, 
v1
, 
m2
, 
v2
Ë\

	)

211 
	`__¥agma
(
	`w¨nög
(
push
)) \

212 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

213 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)) \

214 
	`__¥agma
(
	$w¨nög
(
p›
))

216 
	#SET_FLD_V7
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
Ë\

	)

217 
	`__¥agma
(
	`w¨nög
(
push
)) \

218 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

219 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)) \

220 
	`__¥agma
(
	$w¨nög
(
p›
))

222 
	#SET_FLD_V9
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
Ë\

	)

223 
	`__¥agma
(
	`w¨nög
(
push
)) \

224 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

225 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| MV(m4,
v4
)) \

226 
	`__¥agma
(
	$w¨nög
(
p›
))

228 
	#SET_FLD_V11
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
Ë\

	)

229 
	`__¥agma
(
	`w¨nög
(
push
)) \

230 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

231 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
|
m5
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| MV(m4,
v4
)| MV(m5,
v5
)) \

232 
	`__¥agma
(
	$w¨nög
(
p›
))

234 
	#SET_FLD_V13
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
, 
m6
, 
v6
Ë\

	)

235 
	`__¥agma
(
	`w¨nög
(
push
)) \

236 
	`__¥agma
(
	`w¨nög
(
dißbÀ
:4244)) \

237 
	`BM_SET_MASK_FLD
(
x
, 
m1
|
m2
|
m3
|
m4
|
m5
|
m6
, 
	`MV
(m1,
v1
)| MV(m2,
v2
)| MV(m3,
v3
)| MV(m4,
v4
)| MV(m5,
v5
)| MV(m6,
v6
)) \

238 
	`__¥agma
(
	$w¨nög
(
p›
))

241 
	#SET_FLD_V
(...Ë
	`VARARG
(
SET_FLD_V
, 
__VA_ARGS__
)

	)

245 
	#SET_FLD_FULL_V3
(
x
, 
m
, 
v
Ë((xË
	`MASK_VAL2
(m,v))

	)

246 
	#SET_FLD_FULL_V5
(
x
, 
m1
, 
v1
, 
m2
, 
v2
Ë((xË
	`MASK_VAL4
(m1,v1,m2,v2))

	)

247 
	#SET_FLD_FULL_V7
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
Ë((xË
	`MASK_VAL6
(m1,v1,m2,v2,m3,v3))

	)

248 
	#SET_FLD_FULL_V9
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
Ë((xË
	`MASK_VAL8
(m1,v1,m2,v2,m3,v3,m4,v4))

	)

249 
	#SET_FLD_FULL_V11
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
Ë((xË
	`MASK_VAL10
(m1,v1,m2,v2,m3,v3,m4,v4,m5,v5))

	)

250 
	#SET_FLD_FULL_V13
(
x
, 
m1
, 
v1
, 
m2
, 
v2
, 
m3
, 
v3
, 
m4
, 
v4
, 
m5
, 
v5
, 
m6
, 
v6
Ë((xË
	`MASK_VAL12
(m1,v1,m2,v2,m3,v3,m4,v4,m5,v5,m6,v6))

	)

251 
	#SET_FLD_FULL_V
(...Ë
	`VARARG
(
SET_FLD_FULL_V
, 
__VA_ARGS__
)

	)

254 
	#HEXIFY
(
y
Ë0x##y##
LU


	)

256 
	#BIT_8IFY
(
y
Ë(((y&0x0000000FLU)?1:0Ë+ \

	)

257 ((
y
&0x000000F0LU)?2:0) + \

258 ((
y
&0x00000F00LU)?4:0) + \

259 ((
y
&0x0000F000LU)?8:0) + \

260 ((
y
&0x000F0000LU)?16:0) + \

261 ((
y
&0x00F00000LU)?32:0) + \

262 ((
y
&0x0F000000LU)?64:0) + \

263 ((
y
&0xF0000000LU)?128:0))

265 
	#BIT_8
(
Z
Ë(()
	`BIT_8IFY
(
	`HEXIFY
(Z)))

	)

	@proj/common/compiler.h

24 #¥agm®
⁄˚


26 
	#_©åibuã_∑cked_
 
	`__©åibuã__
((
∑cked
))

	)

27 
	#_©åibuã_Æig√d_
(
s
Ë
	`__©åibuã__
((
	`Æig√d
(s)))

	)

28 
	#_©åibuã_£ssi⁄_
(
s
Ë
	`__©åibuã__
((
	`£˘i⁄
(s)))

	)

30 
	#_©åibuã_no_ölöe_
 
	`__©åibuã__
((
noölöe
))

	)

32 
	#_©åibuã_d©a_ªã¡i⁄_


	)

33 
	#_©åibuã_d©a_ªã¡i⁄_£c_


	)

35 
	#_©åibuã_øm_code_
 
	`__©åibuã__
((
	`£˘i⁄
(".øm_code")))

	)

36 
	#_©åibuã_øm_code_£c_
 
	`__©åibuã__
((
	`£˘i⁄
(".øm_code")))

	)

37 
	#_©åibuã_øm_code_£c_noölöe_
 
	`__©åibuã__
((
	`£˘i⁄
(".øm_code"))Ë__©åibuã__((
noölöe
))

	)

38 
	#_©åibuã_cu°om_d©a_
 
	`__©åibuã__
((
	`£˘i⁄
(".cu°om_d©a")))

	)

39 
	#_©åibuã_cu°om_bss_
 
	`__©åibuã__
((
	`£˘i⁄
(".cu°om_bss")))

	)

40 
	#_©åibuã_ãxt_£c_
 
	`__©åibuã__
((
	`£˘i⁄
(".ãxt")))

	)

41 
	#_©åibuã_´s_d©a_£c_
 
	`__©åibuã__
((
	`£˘i⁄
(".´s_d©a")))

	)

	@proj/common/list.c

24 
	~"ty≥s.h
"

25 
	~"li°.h
"

27 
	sli°
{

28 
li°
 *
	m√xt
;

31 
	$li°Inô
(
li°_t
 
li°
){

32 *
li°
 = 
NULL
;

33 
	}
}

35 *
	$li°Hód
(
li°_t
 
li°
){

36  *
li°
;

37 
	}
}

39 
	$li°C›y
(
li°_t
 
de°
,Üi°_à
§c
){

40 *
de°
 = *
§c
;

41 
	}
}

43 *
	$li°Taû
(
li°_t
 
li°
){

44 
li°
 *
l
;

46 if(*
li°
 =
NULL
){

47  
NULL
;

50 
l
 = *
li°
;Ü->
√xt
 !
NULL
;Ü =Ü->next);

52  
l
;

53 
	}
}

55 
	$li°Add
(
li°_t
 
li°
, *
ôem
){

56 
li°
 *
l
;

58 ((
li°
 *)
ôem
)->
√xt
 = 
NULL
;

60 
l
 = 
	`li°Taû
(
li°
);

61 if(
l
 =
NULL
){

62 *
li°
 = 
ôem
;

64 
l
->
√xt
 = 
ôem
;

66 
	}
}

68 
	$li°Push
(
li°_t
 
li°
, *
ôem
){

69 ((
li°
 *)
ôem
)->
√xt
 = *list;

70 *
li°
 = 
ôem
;

71 
	}
}

73 *
	$li°Ch›
(
li°_t
 
li°
){

74 
li°
 *
l
, *
p
;

76 if(*
li°
 =
NULL
){

77  
NULL
;

80 if(((
li°
 *)*li°)->
√xt
 =
NULL
){

81 
l
 = *
li°
;

82 *
li°
 = 
NULL
;

83  
l
;

86 
l
 = *
li°
;Ü->
√xt
->√xà!
NULL
;Ü =Ü->next);

88 
p
 = 
l
->
√xt
;

89 
l
->
√xt
 = 
NULL
;

91  
p
;

92 
	}
}

94 *
	$li°P›
(
li°_t
 
li°
){

95 if(*
li°
 !
NULL
){

96 *
li°
 = ((li° *)*li°)->
√xt
;

99  *
li°
;

100 
	}
}

102 
	$li°Remove
(
li°_t
 
li°
, *
ôem
){

103 
li°
 *
l
, *
p
;

105 if(*
li°
 =
NULL
){

109 
p
 = 
NULL
;

110 
l
 = *
li°
;Ü !
NULL
;Ü =Ü->
√xt
){

111 if(
l
 =
ôem
){

112 if(
p
 =
NULL
){

113 *
li°
 = 
l
->
√xt
;

115 
p
->
√xt
 = 
l
->next;

117 
l
->
√xt
 = 
NULL
;

120 
p
 = 
l
;

122 
	}
}

124 
	$li°Lígth
(
li°_t
 
li°
){

125 
li°
 *
l
;

126 
num
 = 0;

128 
l
 = *
li°
;Ü !
NULL
;Ü =Ü->
√xt
){

129 ++
num
;

132  
num
;

133 
	}
}

135 
	$li°In£π
(
li°_t
 
li°
, *
¥evIãm
, *
√wIãm
){

136 if(
¥evIãm
 =
NULL
){

137 
	`li°Push
(
li°
, 
√wIãm
);

139 ((
li°
 *)
√wIãm
)->
√xt
 = ((li° *)
¥evIãm
)->next;

140 ((
li°
 *)
¥evIãm
)->
√xt
 = 
√wIãm
;

142 
	}
}

	@proj/common/list.h

24 #¥agm®
⁄˚


26 
	#LIST_CONCAT2
(
a
, 
b
Ëa##
	)
b

27 
	#LIST_CONCAT
(
a
, 
b
Ë
	`LIST_CONCAT2
◊, b)

	)

29 
	#LIST
(
«me
Ë\

	)

30 *
LIST_CONCAT
(
«me
, 
_li°
Ë
NULL
; \

31 
li°_t
 
	g«me
 = (li°_t)&
LIST_CONCAT
(
«me
, 
_li°
);

34 ** 
	tli°_t
;

36 
li°Inô
(
li°_t
 
li°
);

37 *
li°Hód
(
li°_t
 
li°
);

38 *
li°Taû
(
li°_t
 
li°
);

39 *
li°P›
 (
li°_t
 
li°
);

40 
li°Push
(
li°_t
 
li°
, *
ôem
);

42 *
li°Ch›
(
li°_t
 
li°
);

44 
li°Add
(
li°_t
 
li°
, *
ôem
);

45 
li°Remove
(
li°_t
 
li°
, *
ôem
);

47 
li°Lígth
(
li°_t
 
li°
);

49 
li°C›y
(
li°_t
 
de°
,Üi°_à
§c
);

51 
li°In£π
(
li°_t
 
li°
, *
¥evIãm
, *
√wIãm
);

	@proj/common/macro_trick.h

24 #¥agm®
⁄˚


32 
	#COUNT_ARGS_IMPL2
(
_1
, 
_2
, 
_3
, 
_4
, 
_5
, 
_6
, 
_7
, 
_8
 , 
_9
, 
_10
, 
_11
, 
_12
, 
_13
, 
_14
, 
_15
, 
_16
, 
_17
, 
_18
, 
_19
, 
_20
, 
N
, ...Ë
	)
N

33 
	#COUNT_ARGS_IMPL
(
¨gs
Ë
COUNT_ARGS_IMPL2
 
	)
args

34 
	#COUNT_ARGS
(...Ë
	`COUNT_ARGS_IMPL
((
__VA_ARGS__
, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0))

	)

36 
	#MACRO_CHOOSE_HELPER2
(
ba£
, 
cou¡
Ëba£##
	)
count

37 
	#MACRO_CHOOSE_HELPER1
(
ba£
, 
cou¡
Ë
	`MACRO_CHOOSE_HELPER2
(ba£, cou¡)

	)

38 
	#MACRO_CHOOSE_HELPER
(
ba£
, 
cou¡
Ë
	`MACRO_CHOOSE_HELPER1
(ba£, cou¡)

	)

40 
	#MACRO_GLUE
(
x
, 
y
Ëx 
	)
y

41 
	#VARARG
(
ba£
, ...Ë
	`MACRO_GLUE
(
	`MACRO_CHOOSE_HELPER
(ba£, 
	`COUNT_ARGS
(
__VA_ARGS__
)),(__VA_ARGS__))

	)

49 
	#VA_NARGS_IMPL
(
_1
, 
_2
, 
_3
, 
_4
, 
_5
, 
_6
, 
_7
, 
_8
 , 
_9
, 
_10
, 
N
, ...Ë
	)
N

50 
	#VA_NARGS
(...Ë
	`VA_NARGS_IMPL
(
X
,##
__VA_ARGS__
, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)

	)

51 
	#VARARG_IMPL2
(
ba£
, 
cou¡
, ...Ëba£##
	`cou¡
(
__VA_ARGS__
)

	)

52 
	#VARARG_IMPL
(
ba£
, 
cou¡
, ...Ë
	`VARARG_IMPL2
(ba£, cou¡, 
__VA_ARGS__
)

	)

53 
	#VARARG
(
ba£
, ...Ë
	`VARARG_IMPL
(ba£, 
	`VA_NARGS
(
__VA_ARGS__
), __VA_ARGS__)

	)

	@proj/common/mempool.c

24 
	~"mempoﬁ.h
"

25 
	~"utûôy.h
"

27 
mem_poﬁ_t
 *
	$mempoﬁ_öô
(
mem_poﬁ_t
 *
poﬁ
, *
mem
, 
ôemsize
, 
ôemcou¡
)

29 if(!
poﬁ
 || !
mem
)

32 
poﬁ
->
‰ì_li°
 = (
mem_block_t
 *)
mem
;

34 
block_size
 = ()(
	`MEMPOOL_ITEMSIZE_2_BLOCKSIZE
(
ôemsize
));

35 
mem_block_t
 *
tmp
 = (mem_block_à*)
mem
;

36 
i
;

37 
i
 = 0; i < 
ôemcou¡
 - 1; ++i){

38 
tmp
 =Åmp->
√xt_block
 = (
mem_block_t
 *)(((ÈmpË+ 
block_size
);

40 
tmp
->
√xt_block
 = 0;

41  
poﬁ
;

42 
	}
}

44 
mem_block_t
 *
	$mempoﬁ_hódî
(*
pd
)

46  (
mem_block_t
 *)(
pd
 - 
	`OFFSETOF
(mem_block_t, 
d©a
));

47 
	}
}

49 *
	$mempoﬁ_Æloc
(
mem_poﬁ_t
 *
poﬁ
)

51 if(!
poﬁ
->
‰ì_li°
)

54 
mem_block_t
 *
tmp
 = 
poﬁ
->
‰ì_li°
;

55 
poﬁ
->
‰ì_li°
 = 
tmp
->
√xt_block
;

56  &
tmp
->
d©a
;

57 
	}
}

59 
	$mempoﬁ_‰ì
(
mem_poﬁ_t
 *
poﬁ
, *
p
)

61 
mem_block_t
 *
tmp
 = 
	`mempoﬁ_hódî
((*)
p
);

62 
tmp
->
√xt_block
 = 
poﬁ
->
‰ì_li°
;

63 
poﬁ
->
‰ì_li°
 = 
tmp
;

64 
	}
}

	@proj/common/mempool.h

24 #¥agm®
⁄˚


27 
	smem_block_t
{

28 
mem_block_t
 *
	m√xt_block
;

29 
	md©a
[4];

30 }
	tmem_block_t
;

32 
	smem_poﬁ_t
{

33 
mem_block_t
 *
	m‰ì_li°
;

34 }
	tmem_poﬁ_t
;

36 
	#MEMPOOL_ALIGNMENT
 4

	)

37 
	#MEMPOOL_ITEMSIZE_2_BLOCKSIZE
(
s
Ë((†+ (
MEMPOOL_ALIGNMENT
 - 1)Ë& ~(MEMPOOL_ALIGNMENT-1))

	)

39 
	#MEMPOOL_DECLARE
(
poﬁ_«me
, 
poﬁ_mem
, 
ôemsize
, 
ôemcou¡
Ë\

	)

40 
mem_poﬁ_t
 
	gpoﬁ_«me
; \

41 
u8
 
	gpoﬁ_mem
[
MEMPOOL_ITEMSIZE_2_BLOCKSIZE
(
ôemsize
Ë* 
ôemcou¡
] 
_©åibuã_Æig√d_
(4);

43 
mem_poﬁ_t
 *
mempoﬁ_öô
(mem_poﬁ_à*
poﬁ
, *
mem
, 
ôemsize
, 
ôemcou¡
);

44 *
mempoﬁ_Æloc
(
mem_poﬁ_t
 *
poﬁ
);

45 
mempoﬁ_‰ì
(
mem_poﬁ_t
 *
poﬁ
, *
p
);

46 
mem_block_t
* 
mempoﬁ_hódî
(*
pd
);

	@proj/common/static_assert.h

24 #¥agm®
⁄˚


31 
	#STATIC_ASSERT_M
(
COND
,
MSG
Ë
	t°©ic_as£πi⁄_
##
	tMSG
[(!!(COND))*2-1]

	)

33 
	tSTATIC_ASSERT3
(
	tX
,
	tL
Ë
	tSTATIC_ASSERT_M
(X,
	t°©ic_as£πi⁄_©_löe_
##L)

	)

34 
	tSTATIC_ASSERT2
(
	tX
,
	tL
Ë
	tSTATIC_ASSERT3
(X,L)

	)

36 
	tSTATIC_ASSERT
(
	tX
Ë
	tSTATIC_ASSERT2
(X,
	t__LINE__
)

	)

38 
	tSTATIC_ASSERT_POW2
(
	tex¥
Ë
	tSTATIC_ASSERT
(!((expr) & ((expr)-1)))

39 
	tSTATIC_ASSERT_EVEN
(
	tex¥
Ë
	tSTATIC_ASSERT
(!(”x¥Ë& 1))

	)

40 
	tSTATIC_ASSERT_ODD
(
	tex¥
Ë
	tSTATIC_ASSERT
((”x¥Ë& 1))

	)

41 
	tSTATIC_ASSERT_INT_DIV
(
	ta
, 
	tb
Ë
	tSTATIC_ASSERT
(◊Ë/ (bË* (bË=◊))

	)

	@proj/common/string.c

24 
	~"ty≥s.h
"

25 
	~"°rög.h
"

26 
	~"as£π.h
"

27 
	~"../os/ev_buf„r.h
"

28 
	~"../os/ev.h
"

30 *
	$°r˝y
(*
d°0
, c⁄° *
§c0
){

31 *
s
 = 
d°0
;

32 (*
d°0
++ = *
§c0
++));

33  
s
;

34 
	}
}

36 *
	$°rchr
(c⁄° *
s
, 
c
){

38 if(*
s
 =
c
){

39  (*)
s
;

41 }*
s
++);

44 
	}
}

46 
	$memcmp
(c⁄° * 
m1
, c⁄° *
m2
, 
n
){

47 *
s1
 = (*)
m1
;

48 *
s2
 = (*)
m2
;

50 
n
--){

51 if(*
s1
 !*
s2
){

52  *
s1
 - *
s2
;

54 
s1
++;

55 
s2
++;

58 
	}
}

60 *
	$memchr
(c⁄° *
§c_void
, 
c
, 
Àngth
){

61 c⁄° *
§c
 = (c⁄° *)
§c_void
;

63 
Àngth
-- > 0){

64 if(*
§c
 =
c
)

65  (*)
§c
;

66 
§c
++;

68  
NULL
;

69 
	}
}

71 *
	$memmove
(*
de°
, c⁄° *
§c
, 
n
){

72 *
d
 = (*)
de°
;

73 *
s
 = (*)
§c
;

75 if(
d
 < 
s
){

76 
n
--)

77 *
d
++ = *
s
++;

79 
d
 = d + (
n
 - 1);

80 
s
 = s + (
n
 - 1);

82 
n
--)

83 *
d
-- = *
s
--;

86  
de°
;

87 
	}
}

89 
	$bc›y
(*
§c
, *
de°
, 
Àn
){

90 *
s
 = (*)
§c
;

91 *
d
 = (*)
de°
;

93 if(
d
 < 
s
){

94 
Àn
--)

95 *
d
++ = *
s
++;

97 
s
 = s + (
Àn
 - 1);

98 
d
 = d + (
Àn
 - 1);

100 
Àn
--)

101 *
d
-- = *
s
--;

103 
	}
}

108 *
	$mem£t
(*
de°
, 
vÆ
, 
Àn
){

109 if(
de°
 =
NULL
){

110 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

111  
NULL
;

113 if(
	`is_ev_buf
(
de°
Ë&& (
Àn
 > 
LARGE_BUFFER
)){

114 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

115  
NULL
;

118 *
±r
 = (*)
de°
;

119 
Àn
-- > 0)

120 *
±r
++ = ()
vÆ
;

121  
de°
;

122 
	}
}

124 *
	$mem˝y
(*
out
, c⁄° *
ö
, 
Àngth
){

125 if(
Àngth
 == 0){

126  
NULL
;

128 if(
out
 =
NULL
){

129 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

130  
NULL
;

132 if(
ö
 =
NULL
){

133 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

134  
NULL
;

136 if(
	`is_ev_buf
(
out
Ë&& (
Àngth
 > 
LARGE_BUFFER
)){

137 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

138  
NULL
;

141 
	`bc›y
((*)
ö
, (*)
out
, ()
Àngth
);

142  
out
;

143 
	}
}

145 vﬁ©ûê
	gAAã°Löe0
 = 0;

146 *
	$mymem£t
(*
de°
, 
vÆ
, 
Àn
, 
löe
){

147 
AAã°Löe0
 = 
löe
;

149 if(
de°
 =
NULL
){

150 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

153 if(
	`is_ev_buf
(
de°
Ë&& (
Àn
 > 
LARGE_BUFFER
)){

154 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

157 if(
	`is_zb_buf
(
de°
Ë&& (
Àn
 > 
ZB_BUF_SIZE
)){

158 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

161 *
±r
 = (*)
de°
;

162 
Àn
-- > 0)

163 *
±r
++ = ()
vÆ
;

164  
de°
;

165 
	}
}

167 vﬁ©ûê
	gAAã°Löe
 = 0;

168 *
	$mymem˝y
(*
out
, c⁄° *
ö
, 
Àngth
, 
löe
){

169 
AAã°Löe
 = 
löe
;

171 if(
Àngth
 == 0){

172  
NULL
;

175 if(
out
 =
NULL
){

176 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

179 if(
ö
 =
NULL
){

180 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

183 if(
	`is_ev_buf
(
out
Ë&& (
Àngth
 > 
LARGE_BUFFER
)){

184 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

187 if(
	`is_zb_buf
(
out
Ë&& (
Àngth
 > 
ZB_BUF_SIZE
Ë&& (Àngth !(ZB_BUF_SIZE + (
zb_buf_hdr_t
) - 1))){

188 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_MEM_ACCESS
);

191 
	`bc›y
((*)
ö
, (*)
out
, ()
Àngth
);

192  
out
;

193 
	}
}

197 
	$mem˝y4
(*
d
, c⁄° *
s
, 
Àngth
){

198 *
d°
 = (*)
d
;

199 *
§c
 = (*)
s
;

200 
	`as£π
(((()
d°
) >> 2) << 2 == (()dst));

201 
	`as£π
(((()
§c
) >> 2) << 2 == (()src));

202 
	`as£π
((
Àngth
 >> 2) << 2 ==Üength);

203 
	`as£π
(–((*)
d°
Ë+ 
Àngth
 <(c⁄° *)
§c
) || (((const *)src) +Üength <= (*)dst));

204 
Àn
 = 
Àngth
 >> 2;

205 
Àn
 --){

206 *
d°
++ = *
§c
++;

208 
	}
}

210 
	$°æí
(c⁄° *
°r
){

211 
Àn
 = 0;

213 if(
°r
 !
NULL
){

214 *
°r
++){

215 
Àn
++;

219  
Àn
;

220 
	}
}

222 
	$°rcmp
(c⁄° *
fú°Såög
, c⁄° *
£c⁄dSåög
){

223 *
fú°Såög
 =*
£c⁄dSåög
){

224 if(*
fú°Såög
 == '\0'){

227 ++
fú°Såög
;

228 ++
£c⁄dSåög
;

230 if((()*
fú°Såög
 - ()*
£c⁄dSåög
) < 0){

234 
	}
}

236 *
	$°∫˝y
(*
s
, c⁄° *
t
, 
n
){

237 *
p
 = 
s
;

238 
i
 = 0;

240 if(!
s
)

241  
s
;

243 
t
 && 
i
 < 
n
){

244 *
s
++ = *
t
++;

245 
i
++;

248 if(!
t
){

250 *
s
++ = '\0';

251 }
i
++ < 
n
);

253  
p
;

254 
	}
}

256 
	$ismemzîo4
(*
d©a
, 
Àn
){

257 *
p
 = (*)
d©a
;

258 
Àn
 =Üen >> 2;

259 
i
 = 0; i < 
Àn
; ++i){

260 if(*
p
){

263 ++
p
;

266 
	}
}

268 
	$ismemf4
(*
d©a
, 
Àn
){

269 *
p
 = (*)
d©a
;

270 
Àn
 =Üen >> 2;

271 
i
 = 0; i < 
Àn
; ++i){

272 if(*
p
 != 0xffffffff){

275 ++
p
;

278 
	}
}

280 *
	$mem£t4
(*
de°
, 
vÆ
, 
Àn
){

281 *
p
 = (*)
de°
;

282 
Àn
 =Üen >> 2;

283 
i
 = 0; i < 
Àn
; ++i){

284 *
p
++ = 
vÆ
;

286  
de°
;

287 
	}
}

289 
	$zîomem4
(*
d©a
, 
Àn
){

290 
	`mem£t4
(
d©a
, 0, 
Àn
);

291 
	}
}

	@proj/common/string.h

24 #¥agm®
⁄˚


26 #i‚de‡
NULL


27 
	#NULL
 0

	)

30 *
memmove
(*
de°
, c⁄° *
§c
, 
n
);

32 *
mem£t
(*
d
, 
c
, 
n
);

33 *
mem˝y
(*
des_±r
, c⁄° *
§c_±r
, );

35 *
mymem£t
(*
d
, 
c
, 
n
,);

36 *
mymem˝y
(*
des_±r
, c⁄° *
§c_±r
, , );

37 
	#mem˝y
(
x
,
y
,
z
Ë
	`mymem˝y
(x,y,z,
__LINE__
)

	)

38 
	#mem£t
(
x
,
y
,
z
Ë
	`mymem£t
(x,y,z,
__LINE__
)

	)

42 
mem˝y4
(*
de°
, c⁄° *
§c
, );

43 *
memchr
(c⁄° *
_s
, 
_c
, 
_n
);

44 
memcmp
(c⁄° *
_s1
, c⁄° *
_s2
, 
_n
);

46 *
°rˇt
(*
_s1
, c⁄° *
_s2
);

47 *
°rchr
(c⁄° *
_s
, 
_c
);

48 
°rcmp
(c⁄° *
_s1
, c⁄° *
_s2
);

49 
°rcﬁl
(c⁄° *
_s1
, c⁄° *
_s2
);

50 *
°r˝y
(*
_s1
, c⁄° *
_s2
);

51 
°rc•n
(c⁄° *
_s1
, c⁄° *
_s2
);

52 *
°ªº‹
(
_îrcode
);

53 
°æí
(c⁄° *
_s
);

54 *
°∫ˇt
(*
_s1
, c⁄° *
_s2
, 
_n
);

55 
°∫cmp
(c⁄° *
_s1
, c⁄° *
_s2
, 
_n
);

56 *
°∫˝y
(*
_s1
, c⁄° *
_s2
, 
_n
);

57 *
°Ωbrk
(c⁄° *
_s1
, c⁄° *
_s2
);

58 *
°ºchr
(c⁄° *
_s
, 
_c
);

59 
°r•n
(c⁄° *
_s1
, c⁄° *
_s2
);

60 *
°r°r
(c⁄° *
_s1
, c⁄° *
_s2
);

61 *
°πok
(*
_s1
, c⁄° *
_s2
);

62 
°rx‰m
(*
_s1
, c⁄° *
_s2
, 
_n
);

63 *
°rchr
(c⁄° *
s
, 
c
);

64 *
memchr
(c⁄° *
§c_void
, 
c
, 
Àngth
);

65 
ismemzîo4
(*
d©a
, 
Àn
);

66 
ismemf4
(*
d©a
, 
Àn
);

67 *
mem£t4
(*
de°
, 
vÆ
, 
Àn
);

68 
zîomem4
(*
d©a
, 
Àn
);

	@proj/common/tlPrintf.c

24 
	~"../drivîs/drv_putch¨.h
"

25 #i‡
deföed
(
MCU_CORE_B91
)

26 
	~<°d¨g.h
>

28 *
	tva_li°
;

30 
	#_INTSIZEOF
(
n
Ë–(“Ë+ (Ë- 1Ë& ~((Ë- 1Ë)

	)

32 
	#va_°¨t
(
≠
,
v
Ë–≠ = (
va_li°
)&v + 
	`_INTSIZEOF
(vË)

	)

33 
	#va_¨g
(
≠
,
t
Ë–*— *)(◊∞+
	`_INTSIZEOF
—)Ë- _INTSIZEOF—)Ë)

	)

34 
	#va_íd
(
≠
Ë–≠ = (
va_li°
)0 )

	)

36 
	#DECIMAL_OUTPUT
 10

	)

37 
	#OCTAL_OUTPUT
 8

	)

38 
	#HEX_OUTPUT
 16

	)

43 #i‡
deföed
(
MCU_CORE_B91
)

44 
__©åibuã__
((
u£d
)Ë
	$_wrôe
(
fd
, c⁄° *
buf
, 
size
){

45 ()
fd
;

46 
i
;

47 
i
 = 0; i < 
size
; i++){

48 
	`drv_putch¨
(
buf
[
i
]);

50  
i
;

51 
	}
}

53 
	$put_s
(*
s
){

54 (*
s
 != '\0')){

55 
	`drv_putch¨
(*
s
++);

57 
	}
}

59 
	$puti
(
num
, 
ba£
){

60 
ª
[]="0123456789ABCDEF";

62 
buf
[50];

64 *
addr
 = &
buf
[49];

66 *
addr
 = '\0';

69 *--
addr
 = 
ª
[
num
%
ba£
];

70 
num
/=
ba£
;

71 }
num
!=0);

73 
	`put_s
(
addr
);

74 
	}
}

76 
	$Tl_¥ötf
(c⁄° *
f‹m©
, ...){

77 
•™
;

78 
j
;

79 *
s
;

80 
m
;

82 
va_li°
 
¨g_±r
;

83 
	`va_°¨t
(
¨g_±r
, 
f‹m©
);

85 (
•™
 = *(
f‹m©
++))){

86 if(
•™
 != '%'){

87 
	`drv_putch¨
(
•™
);

89 
•™
 = *(
f‹m©
++);

90 if(
•™
 == 'c'){

91 
j
 = 
	`va_¨g
(
¨g_±r
,);

92 
	`drv_putch¨
(
j
);

93 }if(
•™
 == 'd'){

94 
m
 = 
	`va_¨g
(
¨g_±r
,);

95 if(
m
<0){

96 
	`drv_putch¨
('-');

97 
m
 = -m;

99 
	`puti
(
m
,
DECIMAL_OUTPUT
);

100 }if(
•™
 == 's'){

101 
s
 = 
	`va_¨g
(
¨g_±r
,*);

102 
	`put_s
(
s
);

103 }if(
•™
 == 'o'){

104 
j
 = 
	`va_¨g
(
¨g_±r
,);

105 
	`puti
(
j
,
OCTAL_OUTPUT
);

106 }if(
•™
 == 'x'){

107 
j
 = 
	`va_¨g
(
¨g_±r
,);

108 
	`puti
(
j
,
HEX_OUTPUT
);

109 }if(
•™
 == 0){

112 
	`drv_putch¨
(
•™
);

116 
	`va_íd
(
¨g_±r
);

119 
	}
}

	@proj/common/tlPrintf.h

24 #¥agm®
⁄˚


26 #i‡
deföed
(
MCU_CORE_B91
)

27 
	~<°dio.h
>

30 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

31 
Tl_¥ötf
(c⁄° *
f‹m©
, ...);

35 #i‡(
UART_PRINTF_MODE
 || 
USB_PRINTF_MODE
)

36 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

37 
	#¥ötf
 
Tl_¥ötf


	)

40 
	#TRACE
 
¥ötf


	)

42 
	#DEBUG
(
compûeFœg
, ...Ëdo{ \

	)

43 if(
	gcompûeFœg
Ë
TRACE
(
__VA_ARGS__
); \

46 
	#DEBUG_ARRAY
(
compûeFœg
, 
¨øyAddr
, 
Àn
Ëdo{ \

	)

47 if(
compûeFœg
){ \

48 
	`TRACE
("*********************************\n"); \

49 
i
 = 0; \

51 
	`TRACE
(" %x", ((*)
¨øyAddr
)[
i
++]); \

52 }
i
 < 
Àn
); \

53 
	`TRACE
("\n*********************************\n"); \

55 
	}

	$}whûe
(0)

57 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

58 
	#¥ötf


	)

61 
	#TRACE


	)

62 
	#DEBUG
(
compûeFœg
, ...)

	)

63 
	#DEBUG_ARRAY
(
compûeFœg
, 
¨øyAddr
, 
Àn
)

	)

	@proj/common/types.h

24 #¥agm®
⁄˚


27 sig√d 
	töt8_t
;

28 
	tuöt8_t
;

30 sig√d 
	töt16_t
;

31 
	tuöt16_t
;

33 sig√d 
	töt32_t
;

34 
	tuöt32_t
;

36 
öt16_t
 
	tcof„e_∑ge_t
;

39 
	tu8
;

40 sig√d 
	ts8
;

42 
	tu16
;

43 sig√d 
	ts16
;

45 
	tu32
;

46 sig√d 
	ts32
;

49 
	ts64
;

50 
	tu64
;

52 (*
	t‚_±r
)(
	tu8
*);

54 
u32
 
	tu24
;

55 
s32
 
	ts24
;

58 
u8
 
	t°©us_t
;

59 
u32
 
	tUTCTime
;

61 
u32
 
	t¨g_t
;

64 
ZB_FALSE
 = 0,

65 
ZB_TRUE
 = 1

68 
u8
 
	tcId_t
;

73 
u8
 
	taddrExt_t
[8];

74 
u8
 
	textPANId_t
[8];

76 
addrExt_t
 
	textAddr_t
;

79 
u16
 
sh‹tAddr
;

80 
addrExt_t
 
extAddr
;

81 }
	té_zb_addr_t
;

84 
u32
 
§cId
;

85 
addrExt_t
 
gpdIìeAddr
;

86 }
	tgpdId_t
;

93 
u16
 
sh‹tAddr
;

94 
addrExt_t
 
extAddr
;

95 } 
addr
;

96 
u8
 
addrMode
;

97 } 
	taddr_t
;

100 
u16
 
id
;

101 
u8
 
mode
;

102 } 
	t∑n_id_t
;

104 #ifde‡
WIN32


105 #i‚de‡
FALSE


106 
	#FALSE
 0

	)

108 #i‚de‡
TRUE


109 
	#TRUE
 1

	)

112 
	#PACK_1


	)

113 
	#CODE


	)

114 
	#__no_öô


	)

115 
	#GENERIC


	)

117 
	#NULL_OK


	)

118 
	#INP


	)

119 
	#OUTP


	)

120 
	#UNUSED


	)

121 
	#ONLY


	)

122 
	#READONLY


	)

123 
	#SHARED


	)

124 
	#KEEP


	)

127 #i‚de‡
NULL


128 
	#NULL
 0

	)

131 #i‚de‡
__˝lu•lus


133 
u8
 
	tboﬁ
;

135 #i‚de‡
FALSE


136 
	#FALSE
 0

	)

138 #i‚de‡
TRUE


139 
	#TRUE
 (!
FALSE
)

	)

142 
	#Ál£
 
FALSE


	)

143 
	#åue
 
TRUE


	)

145 #ñi‡
deföed
 
WIN32


147 #i‚de‡
FALSE


148 
	#FALSE
 0

	)

150 #i‚de‡
TRUE


151 
	#TRUE
 1

	)

158 #ifde‡
__GNUC__


159 
u16
 
	twch¨_t
;

162 #i‚de‡
WIN32


163 
u32
 
	tsize_t
;

166 
	#U32_MAX
 ((
u32
)0xffffffff)

	)

167 
	#U16_MAX
 ((
u16
)0xffff)

	)

168 
	#U8_MAX
 ((
u8
)0xff)

	)

169 
	#U31_MAX
 ((
u32
)0x7fffffff)

	)

170 
	#U15_MAX
 ((
u16
)0x7fff)

	)

171 
	#U7_MAX
 ((
u8
)0x7f)

	)

175 
	#SUCCESS
 0x00

	)

176 
	#FAILURE
 0x01

	)

177 
	#INVALIDPARAMETER
 0x02

	)

178 
	#INVALID_TASK
 0x03

	)

179 
	#MSG_BUFFER_NOT_AVAIL
 0x04

	)

180 
	#INVALID_MSG_POINTER
 0x05

	)

181 
	#INVALID_EVENT_ID
 0x06

	)

182 
	#INVALID_INTERRUPT_ID
 0x07

	)

183 
	#NO_TIMER_AVAIL
 0x08

	)

184 
	#NV_ITEM_UNINIT
 0x09

	)

185 
	#NV_OPER_FAILED
 0x0A

	)

186 
	#INVALID_MEM_SIZE
 0x0B

	)

187 
	#NV_BAD_ITEM_LEN
 0x0C

	)

190 
	#ADDR_MODE_NONE
 0

191 
	#ADDR_MODE_SHORT
 2

192 
	#ADDR_MODE_EXT
 3

193 

	)

	@proj/common/utility.h

24 #¥agm®
⁄˚


28 
	#abs
(
a
Ë((◊Ë> 0Ë? (◊)Ë: (-◊)))

	)

29 
	#absSub
(
a
, 
b
Ë(◊Ë> (bË? (◊)-(b)Ë: ((b)-◊)))

	)

31 
	#ˇt2
(
i
,
j
Ëi##
	)
j

32 
	#ˇt3
(
i
,
j
,
k
Ëi##j##
	)
k

34 #i‚de‡
mö


35 
	#mö
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

37 #i‚de‡
mö2


38 
	#mö2
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

40 #i‚de‡
mö3


41 
	#mö3
(
a
,
b
,
c
Ë
	`mö2
(mö2◊, b), c)

	)

43 #i‚de‡
max2


44 
	#max2
(
a
,
b
Ë(◊Ë> (bË? (a): (b))

	)

46 #i‚de‡
max3


47 
	#max3
(
a
,
b
,
c
Ë
	`max2
(max2◊, b), c)

	)

50 
	#LENGTHOF
(
s
, 
m
Ë((((s*)0)->m))

	)

51 
	#OFFSETOF
(
s
, 
m
Ë((Ë&((†*)0)->m)

	)

52 
	#ROUND_INT
(
x
, 
r
Ë(((xË+ (rË- 1Ë/ (rË* (r))

	)

53 
	#ROUND_TO_POW2
(
x
, 
r
Ë(((xË+ (rË- 1Ë& ~(‘Ë- 1))

	)

56 
	#U8_GET
(
addr
Ë(*(vﬁ©ûê*)◊ddr))

	)

57 
	#U16_GET
(
addr
Ë(*(vﬁ©ûê*)◊ddr))

	)

58 
	#U32_GET
(
addr
Ë(*(vﬁ©ûê*)◊ddr))

	)

60 
	#U8_SET
(
addr
, 
v
Ë(*(vﬁ©ûê*)◊ddrË()(v))

	)

61 
	#U16_SET
(
addr
, 
v
Ë(*(vﬁ©ûê*)◊ddrË()(v))

	)

62 
	#U32_SET
(
addr
, 
v
Ë(*(vﬁ©ûê*)◊ddrË(v))

	)

64 
	#U8_INC
(
addr
Ë
	`U8_GET
◊ddrË+1

	)

65 
	#U16_INC
(
addr
Ë
	`U16_GET
◊ddrË+1

	)

66 
	#U32_INC
(
addr
Ë
	`U32_GET
◊ddrË+1

	)

68 
	#U8_DEC
(
addr
Ë
	`U8_GET
◊ddrË-1

	)

69 
	#U16_DEC
(
addr
Ë
	`U16_GET
◊ddrË-1

	)

70 
	#U32_DEC
(
addr
Ë
	`U32_GET
◊ddrË-1

	)

72 
	#U8_CPY
(
addr1
,
addr2
Ë
	`U8_SET
◊ddr1, 
	`U8_GET
◊ddr2))

	)

73 
	#U16_CPY
(
addr1
,
addr2
Ë
	`U16_SET
◊ddr1, 
	`U16_GET
◊ddr2))

	)

74 
	#U32_CPY
(
addr1
,
addr2
Ë
	`U32_SET
◊ddr1, 
	`U32_GET
◊ddr2))

	)

76 
	#BOUND
(
x
, 
l
, 
m
Ë((xË< (lË? (lË: ((xË> (mË? (mË: (x)))

	)

77 
	#SET_BOUND
(
x
, 
l
, 
m
Ë((xË
	`BOUND
(x,Ü, m))

	)

78 
	#BOUND_INC
(
x
, 
m
Ëdo{++(x); (xË(xË< (mË? (xË: 0;} 0)

	)

79 
	#BOUND_INC_POW2
(
x
, 
m
Ëdo{ \

	)

80 
STATIC_ASSERT_POW2
(
m
); \

81 (
	gx
Ë((
x
)+1Ë& (
m
-1); \

84 
	#IS_POWER_OF_2
(
x
Ë(!(x & (x-1)))

	)

85 
	#IS_LITTLE_ENDIAN
 (*(*)"\0\xff" > 0x100)

	)

87 
	#IMPLIES
(
x
, 
y
Ë(!(xË|| (y))

	)

90 
	#COMPARE
(
x
, 
y
Ë(((xË> (y)Ë- ((xË< (y)))

	)

91 
	#SIGN
(
x
Ë
	`COMPARE
(x, 0)

	)

94 
	#SWAP
(
x
, 
y
, 
T
Ëdÿ{ T 
tmp
 = (x); (xË(y); (yËtmp; 
	}
} 0)

	)

95 
	#SORT2
(
a
, 
b
, 
T
Ëdÿ{ i‡(◊Ë> (b)Ë
	`SWAP
(◊), (b), T); } 0)

	)

97 
	#f‹óch
(
i
, 
n
Ëò0; i < (n); ++i)

	)

98 
	#f‹óch_ønge
(
i
, 
s
, 
e
Ëò(s); i < (e); ++i)

	)

99 
	#f‹óch_¨r
(
i
, 
¨r
Ëò0; i < 
	`ARRAY_SIZE
◊º); ++i)

	)

101 
	#f‹óch_höt
(
i
, 
n
, 
h
Ëò0, ++h, h=h<n?h:0; i <Ç; ++h, h=h<n?h:0)

	)

103 
	#ARRAY_SIZE
(
a
Ë(◊Ë/ (*a))

	)

105 
	#evîyN
(
i
, 
n
Ë++(i); (i)=((iË< 
N
 ? (iË: 0); if(0 =(i))

	)

108 
	#HI_UINT16
(
a
Ë((◊Ë>> 8Ë& 0xFF)

	)

109 
	#LO_UINT16
(
a
Ë(◊Ë& 0xFF)

	)

111 
	#U24_BYTE0
(
a
Ë(◊Ë& 0xFF)

	)

112 
	#U24_BYTE1
(
a
Ë((◊Ë>> 8Ë& 0xFF)

	)

113 
	#U24_BYTE2
(
a
Ë((◊Ë>> 16Ë& 0xFF)

	)

115 
	#U32_BYTE0
(
a
Ë(◊Ë& 0xFF)

	)

116 
	#U32_BYTE1
(
a
Ë((◊Ë>> 8Ë& 0xFF)

	)

117 
	#U32_BYTE2
(
a
Ë((◊Ë>> 16Ë& 0xFF)

	)

118 
	#U32_BYTE3
(
a
Ë((◊Ë>> 24Ë& 0xFF)

	)

120 
	#BUILD_U16
(
lo
, 
hi
Ë–()((((hiË& 0x00FFË<< 8Ë+ (÷oË& 0x00FF)Ë)

	)

121 
	#BUILD_U24
(
b0
, 
b1
, 
b2
Ë–()((((b2Ë& 0x000000FFË<< 16Ë+ (((b1Ë& 0x000000FFË<< 8Ë+ ((b0Ë& 0x000000FF)Ë)

	)

122 
	#BUILD_U32
(
b0
, 
b1
, 
b2
, 
b3
Ë–()((((b3Ë& 0x000000FFË<< 24Ë+ (((b2Ë& 0x000000FFË<< 16Ë+ (((b1Ë& 0x000000FFË<< 8Ë+ ((b0Ë& 0x000000FF)Ë)

	)

124 
	#BUILD_S16
(
lo
, 
hi
Ë–(sig√d )((((hiË& 0x00FFË<< 8Ë+ (÷oË& 0x00FF)Ë)

	)

125 
	#BUILD_S24
(
b0
, 
b1
, 
b2
Ë–(sig√d )((((b2Ë& 0x000000FFË<< 16Ë+ (((b1Ë& 0x000000FFË<< 8Ë+ ((b0Ë& 0x000000FF)Ë)

	)

126 
	#BUILD_S32
(
b0
, 
b1
, 
b2
, 
b3
Ë–(sig√d )((((b3Ë& 0x000000FFË<< 24Ë+ (((b2Ë& 0x000000FFË<< 16Ë+ (((b1Ë& 0x000000FFË<< 8Ë+ ((b0Ë& 0x000000FF)Ë)

	)

129 
	#HASH_MAGIC_VAL
 5381u

	)

130 
	#INT_MASK
 0x7fffffff

	)

133 
	#HASH_FUNC_STEP
(
hash_v¨
, 
v
Ë((((hash_v¨Ë<< 5Ë+ (hash_v¨)Ë+ (v))

	)

134 
	#FOUR_INT_HASH_FUNC
(
v1
, 
v2
, 
v3
, 
v4
Ë(
	`HASH_FUNC_STEP
(HASH_FUNC_STEP–HASH_FUNC_STEP–HASH_FUNC_STEP(
HASH_MAGIC_VAL
, (v1)), (v2)), (v3)), (v4)Ë& 
INT_MASK
)

	)

135 
	#TWO_INT_HASH_FUNC
(
v1
, 
v2
Ë(
	`HASH_FUNC_STEP
(HASH_FUNC_STEP(
HASH_MAGIC_VAL
, (v1)), (v2)Ë& 
INT_MASK
)

	)

	@proj/common/utlist.h

24 #i‚de‡
UTLIST_H


25 
	#UTLIST_H


	)

27 
	#LIST_ADD
(
hód
, 
ñe
Ëdo{ \

	)

28 (
	gñe
)->
	g√xt
 = 
hód
; \

29 
	ghód
 = 
ñe
; \

33 
	#LIST_DELETE
(
hód
, 
ñe
Ëdo{ \

	)

34 
	`__ty≥of
(
hód
Ë
l°
; \

35 i‡((
hód
Ë=(
ñe
)) { \

36 (
hód
Ë(hód)->
√xt
; \

38 
l°
 = 
hód
; \

39 
l°
->
√xt
 && (l°->√xà!(
ñe
))) { \

40 
l°
 =Ü°->
√xt
; \

42 i‡(
l°
->
√xt
) { \

43 
l°
->
√xt
 = ((
ñe
)->next); \

46 
	}

	$}whûe
(0)

51 
	#LIST_EXIST
(
hód
, 
ñe
, 
ªsu…
Ëdo{ \

	)

52 
ªsu…
 = 
hód
;Ñesu…;Ñesu… = (ªsu…)->
√xt
){ \

53 if(
ªsu…
 =
ñe
){ \

57 
	}

	$}whûe
(0)

	@proj/drivers/drv_adc.c

24 
	~"../é_comm⁄.h
"

26 #if 
deföed
(
MCU_CORE_826x
)

27 
	#ADC_VALUE_GET_WITH_BASE_MODE
(
v
) (3300 * (v - 128)/(16384 - 256))

28 
	#ADC_VALUE_GET_WITH_VBAT_MODE
(
v
Ë(3*(1428*(v - 128)/(16384 - 256)))

	)

29 #ñi‡
deföed
(
MCU_CORE_B91
)

30 
	#ADC_DMA_CHN
 
DMA7


	)

31 
	#ADC_SAMPLE_NUM
 8

	)

34 #i‡
deföed
(
MCU_CORE_B91
)

39 
u16
 
	$adc_gë_vﬁège_dma
()

41 
u16
 
adc_ßm∂e_buf„r
[
ADC_SAMPLE_NUM
] = {0};

42 
u16
 
adc_code_avîage
 = 0;

44 
	`adc_gë_code_dma
(
adc_ßm∂e_buf„r
, 
ADC_SAMPLE_NUM
);

47 
u16
 
ãmp
 = 0;

48 
s8
 
i
, 
j
;

49 
i
 = 1; i < 
ADC_SAMPLE_NUM
; i++){

50 if(
adc_ßm∂e_buf„r
[
i
] <ádc_sample_buffer[i - 1]){

51 
ãmp
 = 
adc_ßm∂e_buf„r
[
i
];

52 
adc_ßm∂e_buf„r
[
i
] =ádc_sample_buffer[i - 1];

53 
j
 = 
i
 - 1; j >0 && 
adc_ßm∂e_buf„r
[j] > 
ãmp
; j--){

54 
adc_ßm∂e_buf„r
[
j
 + 1] =ádc_sample_buffer[j];

56 
adc_ßm∂e_buf„r
[
j
 + 1] = 
ãmp
;

60 
i
 = 
ADC_SAMPLE_NUM
 >> 2; i < (ADC_SAMPLE_NUM - (ADC_SAMPLE_NUM >> 2)); i++){

61 
adc_code_avîage
 +
adc_ßm∂e_buf„r
[
i
] / (
ADC_SAMPLE_NUM
 >> 1);

64  
	`adc_ˇlcuœã_vﬁège
(
adc_code_avîage
);

65 
	}
}

75 
boﬁ
 
	$drv_adc_öô
()

77 #if 
	`deföed
(
MCU_CORE_826x
)

78 
	`ADC_Inô
();

79 
	`AUDIO2ADC
();

80 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

81 
	`adc_öô
();

82 #ñi‡
	`deföed
(
MCU_CORE_B91
)

83 
	`adc_£t_dma_c⁄fig
(
ADC_DMA_CHN
);

85  
TRUE
;

86 
	}
}

93 
u16
 
	$drv_gë_adc_d©a
()

95 #i‡
	`deföed
(
MCU_CORE_826x
)

96 
u32
 
tmpSum
 = 0;

97 
u8
 
i
 = 0; i < 8; i++){

98 
tmpSum
 +
	`ADC_Sam∂eVÆueGë
();

100 
tmpSum
 /= 8;

101 if(
tmpSum
 < 128){

102 
tmpSum
 = 128;

104  (
u16
)
	`ADC_VALUE_GET_WITH_VBAT_MODE
(
tmpSum
);

105 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

106  (
u16
)
	`adc_ßm∂e_™d_gë_ªsu…
();

107 #ñi‡
	`deföed
(
MCU_CORE_B91
)

108  
	`adc_gë_vﬁège_dma
();

110 
	}
}

118 #i‡
deföed
(
MCU_CORE_826x
)

119 
	$drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
ADC_I≈utPTy≥Def
 
pö
)

121 if(
mode
 =
DRV_ADC_BASE_MODE
){

122 
	`ADC_P¨amSëtög
(
pö
, 
SINGLEEND
, 
RV_AVDD
, 
RES14
, 
S_3
);

123 }if(
mode
 =
DRV_ADC_VBAT_MODE
){

124 
	`ADC_B©ãryCheckInô
(
B©ãry_Chn_VCC
);

126 
	}
}

127 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

128 
	$drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
GPIO_PöTy≥Def
 
pö
)

130 if(
mode
 =
DRV_ADC_BASE_MODE
){

131 
	`adc_ba£_öô
(
pö
);

132 }if(
mode
 =
DRV_ADC_VBAT_MODE
){

133 
	`adc_vb©_öô
(
pö
);

135 
	}
}

136 #ñi‡
deföed
(
MCU_CORE_B91
)

137 
	$drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
adc_öput_pö_def_e
 
pö
)

139 if(
mode
 =
DRV_ADC_BASE_MODE
){

140 
	`adc_gpio_ßm∂e_öô
(
pö
, 
ADC_VREF_1P2V
, 
ADC_PRESCALE_1F4
, 
ADC_SAMPLE_FREQ_96K
);

141 }if(
mode
 =
DRV_ADC_VBAT_MODE
){

146 ()
pö
;

147 
	`adc_b©ãry_vﬁège_ßm∂e_öô
();

149 
	}
}

157 
	$drv_adc_íabÀ
(
boﬁ
 
íabÀ
)

159 #i‡
	`deföed
(
MCU_CORE_826x
)

160 if(
íabÀ
){

161 
EN_ADCCLK
;

163 
DIS_ADCCLK
;

165 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

166 
	`adc_powî_⁄_ßr_adc
(()
íabÀ
);

167 #ñi‡
	`deföed
(
MCU_CORE_B91
)

168 if(
íabÀ
){

169 
	`adc_powî_⁄
();

171 
	`adc_powî_off
();

174 
	}
}

	@proj/drivers/drv_adc.h

24 #¥agm®
⁄˚


29 
	mDRV_ADC_BASE_MODE
,

30 
	mDRV_ADC_VBAT_MODE
,

31 }
	tdrv_adc_mode_t
;

40 
boﬁ
 
drv_adc_öô
();

47 
u16
 
drv_gë_adc_d©a
();

54 #i‡
deföed
 (
MCU_CORE_826x
)

55 
drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
ADC_I≈utPTy≥Def
 
pö
);

56 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

57 
drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
GPIO_PöTy≥Def
 
pö
);

58 #ñi‡
deföed
(
MCU_CORE_B91
)

59 
drv_adc_mode_pö_£t
(
drv_adc_mode_t
 
mode
, 
adc_öput_pö_def_e
 
pö
);

67 
drv_adc_íabÀ
(
boﬁ
 
íabÀ
);

	@proj/drivers/drv_flash.c

24 
	~"../é_comm⁄.h
"

27 
	$Êash_wrôe
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

28 #i‡(
MODULE_WATCHDOG_ENABLE
)

29 
	`drv_wd_˛ór
();

32 #i‡(
VOLTAGE_DETECT_ENABLE
)

33 if(
	`drv_gë_adc_d©a
(Ë< 
BATTERY_SAFETY_THRESHOLD
){;}

36 
	`Êash_wrôe_∑ge
(
addr
, 
Àn
, 
buf
);

37 
	}
}

39 
	$Êash_ªad
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

40 
	`Êash_ªad_∑ge
(
addr
, 
Àn
, 
buf
);

41 
	}
}

43 
	$Êash_îa£
(
u32
 
addr
){

44 #i‡(
MODULE_WATCHDOG_ENABLE
)

45 
	`drv_wd_˛ór
();

48 #i‡(
VOLTAGE_DETECT_ENABLE
)

49 if(
	`drv_gë_adc_d©a
(Ë< 
BATTERY_SAFETY_THRESHOLD
){;}

52 
	`Êash_îa£_£˘‹
(
addr
);

53 
	}
}

55 #ifde‡
CFS_ENABLE


56 
_©åibuã_øm_code_
 
	$cfs_Êash_wrôe_∑ge
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

57 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

59 
	`Êash_£nd_cmd
(
FLASH_WRITE_ENABLE_CMD
);

60 
	`Êash_£nd_cmd
(
FLASH_WRITE_CMD
);

61 
	`Êash_£nd_addr
(
addr
);

63 
u32
 
i
;

64 
i
 = 0; i < 
Àn
; ++i){

65 
	`m•i_wrôe
(~(
buf
[
i
]));

66 
	`m•i_waô
();

68 
	`m•i_high
();

69 
	`Êash_waô_d⁄e
();

70 
	`drv_ª°‹e_úq
(
r
);

71 
	}
}

73 
_©åibuã_øm_code_
 
	$cfs_Êash_ªad_∑ge
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

74 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

75 
	`Êash_£nd_cmd
(
FLASH_READ_CMD
);

76 
	`Êash_£nd_addr
(
addr
);

78 
	`m•i_wrôe
(0x00);

79 
	`m•i_waô
();

80 
	`m•i_˘æ_wrôe
(0x0a);

81 
	`m•i_waô
();

83 
i
 = 0; i < 
Àn
; ++i){

84 *
buf
++ = ~(
	`m•i_gë
());

85 
	`m•i_waô
();

87 
	`m•i_high
();

88 
	`drv_ª°‹e_úq
(
r
);

89 
	}
}

91 
	$cfs_Êash_›
(
u8
 
›mode
, 
u32
 
addr
, u32 
Àn
, u8 *
buf
){

92 
u32
 
ª
 = 
addr
%256;

94 
u32
 
∑geReLí
 = (
ª
)?(256 -re):256;

96 
u32
 
wrôeLí
 = 0;

97 
u32
 
ªmaöLí
 = 
Àn
;

100 if(
ªmaöLí
 <
∑geReLí
){

101 
wrôeLí
 = 
ªmaöLí
;

102 
ªmaöLí
 = 0;

104 
ªmaöLí
 -
∑geReLí
;

105 
wrôeLí
 = 
∑geReLí
;

106 
∑geReLí
 = 256;

108 if(
›mode
){

109 
	`cfs_Êash_wrôe_∑ge
(
addr
,
wrôeLí
,
buf
);

111 
	`cfs_Êash_ªad_∑ge
(
addr
,
wrôeLí
,
buf
);

113 
buf
 +
wrôeLí
;

114 
addr
 +
wrôeLí
;

115 }
ªmaöLí
);

116 
	}
}

118 
	$cfs_Êash_wrôe
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

119 
	`cfs_Êash_›
(1, 
addr
, 
Àn
, 
buf
);

120 
	}
}

122 
	$cfs_Êash_ªad
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
){

123 
	`cfs_Êash_›
(0, 
addr
, 
Àn
, 
buf
);

124 
	}
}

	@proj/drivers/drv_flash.h

24 #¥agm®
⁄˚


27 (*
	tdrv_Êash_wrôe
)(
	taddr
, 
	tÀn
, *
	tbuf
);

28 (*
	tdrv_Êash_ªad
)(
	taddr
, 
	tÀn
, *
	tbuf
);

29 (*
	tdrv_Êash_îa£
)(
	taddr
);

32 
drv_Êash_wrôe
 
wrôe
;

33 
drv_Êash_ªad
 
ªad
;

34 
drv_Êash_îa£
 
îa£
;

35 }
	tdrv_Êash_t
;

37 
	`Êash_wrôe
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
);

38 
	`Êash_ªad
(
u32
 
addr
, u32 
Àn
, 
u8
 *
buf
);

39 
	`Êash_îa£
(
u32
 
addr
);

	@proj/drivers/drv_gpio.c

24 
	~"../é_comm⁄.h
"

27 
	sgpio_c⁄f_li°


29 
gpio_c⁄f_li°
 *
	m√xt
;

30 
úq_ˇŒback
 
	mgpio_úq_ˇŒback
;

31 
u32
 
	mpö
;

32 
drv_gpioIrqMode_t
 
	mmode
;

33 
drv_gpioPﬁl_e
 
	mpﬁ¨ôy
;

34 }
	tgpio_c⁄f_li°
;

36 
	#GPIO_IRQ_HANDLER_Q_NUM
 3

	)

38 
LIST
(
gpioIrqH™dÀrQ
);

40 
gpio_c⁄f_li°
 *
	gli°_hód
 = 
NULL
;

49 
	$drv_gpio_úq_c⁄fig
(
drv_gpioIrqMode_t
 
mode
, 
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
, 
úq_ˇŒback
 
gpio_úq_ˇŒback
)

51 
boﬁ
 
£¨ched
 = 0;

52 if(
	`li°Lígth
(
gpioIrqH™dÀrQ
)){

53 
gpio_c⁄f_li°
 *
pLi°
 = 
	`li°Hód
(
gpioIrqH™dÀrQ
);

54 
pLi°
){

55 if(
pLi°
->
mode
 =modê&&ÖLi°->
pö
 ==Öin){

56 if(
pLi°
->
pﬁ¨ôy
 !=Öolarity){

57 
pLi°
->
pﬁ¨ôy
 =Öolarity;

59 if(
pLi°
->
gpio_úq_ˇŒback
 != gpio_irq_callback){

60 
pLi°
->
gpio_úq_ˇŒback
 = gpio_irq_callback;

63 
£¨ched
 = 1;

67 
pLi°
 =ÖLi°->
√xt
;

71 if(!
£¨ched
){

72 if(
	`li°Lígth
(
gpioIrqH™dÀrQ
Ë>
GPIO_IRQ_HANDLER_Q_NUM
){

76 
gpio_c⁄f_li°
 *
li°_node
 = (gpio_c⁄f_li°*)
	`ev_buf_Æloˇã
((gpio_conf_list));

77 if(!
li°_node
){

81 
	`mem£t
((
u8
 *)
li°_node
, 0, (
gpio_c⁄f_li°
));

82 
li°_node
->
mode
 = mode;

83 
li°_node
->
pö
 =Öin;

84 
li°_node
->
pﬁ¨ôy
 =Öolarity;

85 
li°_node
->
gpio_úq_ˇŒback
 = gpio_irq_callback;

86 
	`li°Add
(
gpioIrqH™dÀrQ
, (*)
li°_node
);

89 if(
mode
 =
GPIO_IRQ_MODE
){

90 
	`drv_gpio_úq_£t
(
pö
, 
pﬁ¨ôy
);

91 }if(
mode
 =
GPIO_IRQ_RISC0_MODE
){

92 
	`drv_gpio_úq_risc0_£t
(
pö
, 
pﬁ¨ôy
);

93 }if(
mode
 =
GPIO_IRQ_RISC1_MODE
){

94 
	`drv_gpio_úq_risc1_£t
(
pö
, 
pﬁ¨ôy
);

98 
	}
}

105 
	$drv_gpio_úq_¥o˚ss
(
drv_gpioIrqMode_t
 
mode
)

107 if(
	`li°Lígth
(
gpioIrqH™dÀrQ
)){

108 
gpio_c⁄f_li°
 *
pLi°
 = 
	`li°Hód
(
gpioIrqH™dÀrQ
);

109 
pLi°
){

110 if(
pLi°
->
mode
 == mode){

111 if(
pLi°
->
gpio_úq_ˇŒback
){

112 
pLi°
->
	`gpio_úq_ˇŒback
();

117 
pLi°
 =ÖLi°->
√xt
;

120 
	}
}

122 
	$drv_gpio_úq_h™dÀr
()

124 
	`drv_gpio_úq_¥o˚ss
(
GPIO_IRQ_MODE
);

125 
	}
}

127 
	$drv_gpio_úq_risc0_h™dÀr
()

129 
	`drv_gpio_úq_¥o˚ss
(
GPIO_IRQ_RISC0_MODE
);

130 
	}
}

132 
	$drv_gpio_úq_risc1_h™dÀr
()

134 
	`drv_gpio_úq_¥o˚ss
(
GPIO_IRQ_RISC1_MODE
);

135 
	}
}

137 
	$drv_gpio_func_£t
(
u32
 
pö
)

139 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

140 
	`gpio_£t_func
(
pö
, 
AS_GPIO
);

141 #ñi‡
	`deföed
(
MCU_CORE_B91
)

142 
	`gpio_fun˘i⁄_í
(
pö
);

144 
	}
}

146 
	$drv_gpio_ouçut_í
(
u32
 
pö
, 
boﬁ
 
íabÀ
)

148 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

149 
	`gpio_£t_ouçut_í
(
pö
, 
íabÀ
);

150 #ñi‡
	`deföed
(
MCU_CORE_B91
)

151 
	`gpio_£t_ouçut
(
pö
, 
íabÀ
);

153 
	}
}

155 
	$drv_gpio_öput_í
(
u32
 
pö
, 
boﬁ
 
íabÀ
)

157 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

158 
	`gpio_£t_öput_í
(
pö
, 
íabÀ
);

159 #ñi‡
	`deföed
(
MCU_CORE_B91
)

160 
	`gpio_£t_öput
(
pö
, 
íabÀ
);

162 
	}
}

164 
	$drv_gpio_up_down_ªsi°‹
(
u32
 
pö
, 
u8
 
ªs
)

166 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

167 
	`gpio_£tup_up_down_ªsi°‹
(
pö
, 
ªs
);

168 #ñi‡
	`deföed
(
MCU_CORE_B91
)

169 
	`gpio_£t_up_down_ªs
(
pö
, 
ªs
);

171 
	}
}

173 
	$drv_gpio_wrôe
(
u32
 
pö
, 
boﬁ
 
vÆue
)

175 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

176 
	`gpio_wrôe
(
pö
, 
vÆue
);

177 #ñi‡
	`deföed
(
MCU_CORE_B91
)

178 
	`gpio_£t_Àvñ
(
pö
, 
vÆue
);

180 
	}
}

182 
boﬁ
 
	$drv_gpio_ªad
(
u32
 
pö
)

184 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

185  
	`gpio_ªad
(
pö
);

186 #ñi‡
	`deföed
(
MCU_CORE_B91
)

187  
	`gpio_gë_Àvñ
(
pö
);

189 
	}
}

191 
	$drv_gpio_ªad_Æl
(
u8
 *
p
)

193 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

194 
	`gpio_ªad_Æl
(
p
);

195 #ñi‡
	`deföed
(
MCU_CORE_B91
)

196 
	`gpio_gë_Àvñ_Æl
(
p
);

198 
	}
}

200 
	$drv_gpio_úq_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
)

202 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

203 
	`gpio_£t_öãºu±
(
pö
, 
pﬁ¨ôy
);

204 #ñi‡
	`deföed
(
MCU_CORE_B91
)

205 
	`gpio_£t_úq
(
pö
, 
pﬁ¨ôy
);

207 
	}
}

209 
	$drv_gpio_úq_risc0_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
)

211 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

212 
	`gpio_£t_öãºu±_risc0
(
pö
, 
pﬁ¨ôy
);

213 #ñi‡
	`deföed
(
MCU_CORE_B91
)

214 
	`gpio_£t_gpio2risc0_úq
(
pö
, 
pﬁ¨ôy
);

216 
	}
}

218 
	$drv_gpio_úq_risc1_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
)

220 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

221 
	`gpio_£t_öãºu±_risc1
(
pö
, 
pﬁ¨ôy
);

222 #ñi‡
	`deföed
(
MCU_CORE_B91
)

223 
	`gpio_£t_gpio2risc1_úq
(
pö
, 
pﬁ¨ôy
);

225 
	}
}

232 
	$drv_gpio_úq_í
(
u32
 
pö
)

234 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

235 
	`gpio_í_öãºu±
(
pö
, 1);

236 #ñi‡
	`deföed
(
MCU_CORE_B91
)

237 
	`gpio_úq_í
(
pö
);

238 
	`∂ic_öãºu±_íabÀ
(
IRQ25_GPIO
);

240 
	}
}

242 
	$drv_gpio_úq_risc0_í
(
u32
 
pö
)

244 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

245 
	`gpio_í_öãºu±_risc0
(
pö
, 1);

246 #ñi‡
	`deföed
(
MCU_CORE_B91
)

247 
	`gpio_gpio2risc0_úq_í
(
pö
);

248 
	`∂ic_öãºu±_íabÀ
(
IRQ26_GPIO2RISC0
);

250 
	}
}

252 
	$drv_gpio_úq_risc1_í
(
u32
 
pö
)

254 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

255 
	`gpio_í_öãºu±_risc1
(
pö
, 1);

256 #ñi‡
	`deföed
(
MCU_CORE_B91
)

257 
	`gpio_gpio2risc1_úq_í
(
pö
);

258 
	`∂ic_öãºu±_íabÀ
(
IRQ27_GPIO2RISC1
);

260 
	}
}

262 
	$drv_gpio_úq_dis
(
u32
 
pö
)

264 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

265 
	`gpio_í_öãºu±
(
pö
, 0);

266 #ñi‡
	`deföed
(
MCU_CORE_B91
)

267 
	`gpio_úq_dis
(
pö
);

268 
	`∂ic_öãºu±_dißbÀ
(
IRQ25_GPIO
);

270 
	}
}

272 
	$drv_gpio_úq_risc0_dis
(
u32
 
pö
)

274 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

275 
	`gpio_í_öãºu±_risc0
(
pö
, 0);

276 #ñi‡
	`deföed
(
MCU_CORE_B91
)

277 
	`gpio_gpio2risc0_úq_dis
(
pö
);

278 
	`∂ic_öãºu±_dißbÀ
(
IRQ26_GPIO2RISC0
);

280 
	}
}

282 
	$drv_gpio_úq_risc1_dis
(
u32
 
pö
)

284 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

285 
	`gpio_í_öãºu±_risc1
(
pö
, 0);

286 #ñi‡
	`deföed
(
MCU_CORE_B91
)

287 
	`gpio_gpio2risc1_úq_dis
(
pö
);

288 
	`∂ic_öãºu±_dißbÀ
(
IRQ27_GPIO2RISC1
);

290 
	}
}

299 
ev_synchr⁄ous_timî
();

300 
	$timî_synchr⁄ous_úq_ˇŒback
()

302 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

303 
	`ev_synchr⁄ous_timî
();

304 
	`drv_ª°‹e_úq
(
r
);

305 
	}
}

314 
	$gpio_timî_synchr⁄ous_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
)

316 
	`drv_gpio_úq_c⁄fig
(
GPIO_IRQ_MODE
, 
pö
, 
pﬁ¨ôy
, 
timî_synchr⁄ous_úq_ˇŒback
);

317 
	}
}

	@proj/drivers/drv_gpio.h

24 #¥agm®
⁄˚


29 
	mRISING_EDGE
,

30 
	mFALLING_EDGE
,

31 
	mHIGH_LEVEL
,

32 
	mLOW_LEVEL
,

33 }
	tdrv_gpioPﬁl_e
;

36 
	mGPIO_IRQ_INVALID
,

37 
	mGPIO_IRQ_MODE
,

38 
	mGPIO_IRQ_RISC0_MODE
,

39 
	mGPIO_IRQ_RISC1_MODE
,

40 }
	tdrv_gpioIrqMode_t
;

42 (*
	túq_ˇŒback
)();

51 
	`drv_gpio_úq_c⁄fig
(
drv_gpioIrqMode_t
 
mode
, 
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
, 
úq_ˇŒback
 
gpio_úq_ˇŒback
);

53 
	`drv_gpio_úq_h™dÀr
();

54 
	`drv_gpio_úq_risc0_h™dÀr
();

55 
	`drv_gpio_úq_risc1_h™dÀr
();

57 
	`drv_gpio_úq_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
);

58 
	`drv_gpio_úq_risc0_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
);

59 
	`drv_gpio_úq_risc1_£t
(
u32
 
pö
, 
drv_gpioPﬁl_e
 
pﬁ¨ôy
);

61 
	`drv_gpio_úq_í
(
u32
 
pö
);

62 
	`drv_gpio_úq_risc0_í
(
u32
 
pö
);

63 
	`drv_gpio_úq_risc1_í
(
u32
 
pö
);

65 
	`drv_gpio_úq_dis
(
u32
 
pö
);

66 
	`drv_gpio_úq_risc0_dis
(
u32
 
pö
);

67 
	`drv_gpio_úq_risc1_dis
(
u32
 
pö
);

69 
	`drv_gpio_func_£t
(
u32
 
pö
);

70 
	`drv_gpio_ouçut_í
(
u32
 
pö
, 
boﬁ
 
íabÀ
);

71 
	`drv_gpio_öput_í
(
u32
 
pö
, 
boﬁ
 
íabÀ
);

72 
	`drv_gpio_up_down_ªsi°‹
(
u32
 
pö
, 
u8
 
ªs
);

73 
	`drv_gpio_wrôe
(
u32
 
pö
, 
boﬁ
 
vÆue
);

74 
boﬁ
 
	`drv_gpio_ªad
(
u32
 
pö
);

75 
	`drv_gpio_ªad_Æl
(
u8
 *
p
);

	@proj/drivers/drv_hw.c

24 
	~"../é_comm⁄.h
"

29 #i‡
deföed
(
MCU_CORE_826x
)

30 #if(
CLOCK_SYS_CLOCK_HZ
 == 32000000)

31 
	#SYS_CLOCK_VALUE
 
SYS_CLK_32M_PLL


	)

32 #ñif(
CLOCK_SYS_CLOCK_HZ
 == 16000000)

33 
	#SYS_CLOCK_VALUE
 
SYS_CLK_16M_PLL


	)

35 #îr‹ 
∂ó£
 
c⁄fig
 
sy°em
 
˛ock


37 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

38 #if(
CLOCK_SYS_CLOCK_HZ
 == 24000000)

39 
	#SYS_CLOCK_VALUE
 
SYS_CLK_24M_Cry°Æ


	)

40 #ñif(
CLOCK_SYS_CLOCK_HZ
 == 16000000)

41 
	#SYS_CLOCK_VALUE
 
SYS_CLK_16M_Cry°Æ


	)

42 #ñif(
CLOCK_SYS_CLOCK_HZ
 == 48000000)

43 
	#SYS_CLOCK_VALUE
 
SYS_CLK_48M_Cry°Æ


	)

45 #îr‹ 
∂ó£
 
c⁄fig
 
sy°em
 
˛ock


47 #ñi‡
deföed
(
MCU_CORE_B91
)

48 #if(
CLOCK_SYS_CLOCK_HZ
 == 48000000)

49 
	#CLOCK_INIT
 
CCLK_48M_HCLK_48M_PCLK_24M


	)

51 #îr‹ 
∂ó£
 
c⁄fig
 
sy°em
 
˛ock


57 
u32
 
	gsysTimîPîUs
;

60 
	$øndInô
()

62 #i‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

63 
	`øndom_gíî©‹_öô
();

64 #ñi‡
	`deföed
(
MCU_CORE_B91
)

65 
	`ång_öô
();

67 
	}
}

80 
	$öã∫ÆFœshSizeCheck
(){

81 #i‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

82 
u32
 
mid
 = 
	`Êash_ªad_mid
();

83 
u8
 *
pMid
 = (u8 *)&
mid
;

85 if–(
pMid
[2] < 
FLASH_SIZE_512K
) ||

86 ((
g_u32MacFœshAddr
 =
FLASH_ADDR_0F_MAC_ADDR_1M
Ë&& (
pMid
[2] < 
FLASH_SIZE_1M
)) ){

91 if–(
g_u32MacFœshAddr
 =
FLASH_ADDR_OF_MAC_ADDR_512K
Ë&& (
pMid
[2] >
FLASH_SIZE_1M
) ){

92 
g_u32MacFœshAddr
 = 
FLASH_ADDR_0F_MAC_ADDR_1M
;

93 
g_u32CfgFœshAddr
 = 
FLASH_ADDR_OF_F_CFG_INFO_1M
;

96 
	}
}

98 #i‡
VOLTAGE_DETECT_ENABLE


99 
	$vﬁège_dëe˘_öô
()

101 
	`drv_adc_öô
();

103 #i‡
	`deföed
(
MCU_CORE_826x
)

104 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
NOINPUT
);

105 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

106 
	`drv_adc_mode_pö_£t
(
DRV_ADC_VBAT_MODE
, 
GPIO_PC5
);

107 #ñi‡
	`deföed
(
MCU_CORE_B91
)

108 
	`drv_adc_mode_pö_£t
(
DRV_ADC_BASE_MODE
, 
ADC_GPIO_PB0
);

111 
	`drv_adc_íabÀ
(1);

112 
	}
}

114 
	$vﬁège_dëe˘
()

116 
u16
 
vﬁège
 = 
	`drv_gë_adc_d©a
();

117 
u32
 
curTick
 = 
	`˛ock_time
();

121 
vﬁège
 < 
BATTERY_SAFETY_THRESHOLD
){

122 if(
	`˛ock_time_ex˚ed
(
curTick
, 1000 * 1000)){

123 #i‡
PM_ENABLE


124 
	`drv_pm_¶ìp
(
PM_SLEEP_MODE_DEEPSLEEP
, 0, 0);

126 
	`SYSTEM_RESET
();

129 
vﬁège
 = 
	`drv_gë_adc_d©a
();

131 
	}
}

134 
°¨tup_°©e_e
 
	$∂©f‹m_wakeup_öô
()

136 
°¨tup_°©e_e
 
°©e
 = 
SYSTEM_RETENTION_NONE
;

138 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

139 
	`˝u_wakeup_öô
();

140 #ñi‡
	`deföed
(
MCU_CORE_8278
)

141 
	`˝u_wakeup_öô
(
LDO_MODE
, 
EXTERNAL_XTAL_24M
);

142 #ñi‡
	`deföed
(
MCU_CORE_B91
)

143 
	`sys_öô
(
LDO_1P4_LDO_1P8
, 
VBAT_MAX_VALUE_GREATER_THAN_3V6
);

146 #i‡
	`deföed
(
MCU_CORE_826x
)

148 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

149 
°©e
 = (
	`pm_gë_mcu_°©us
(Ë=
MCU_STATUS_DEEPRET_BACK
Ë? 
SYSTEM_RETENTION_EN
 : 
SYSTEM_RETENTION_NONE
;

150 #ñi‡
	`deföed
(
MCU_CORE_B91
)

151 
°©e
 = (
g_pm_°©us_öfo
.
mcu_°©us
 =
MCU_STATUS_DEEPRET_BACK
Ë? 
SYSTEM_RETENTION_EN
 : 
SYSTEM_RETENTION_NONE
;

154  
°©e
;

155 
	}
}

165 
°¨tup_°©e_e
 
	$drv_∂©f‹m_öô
()

167 
°¨tup_°©e_e
 
°©e
 = 
	`∂©f‹m_wakeup_öô
();

169 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

170 
	`˛ock_öô
(
SYS_CLOCK_VALUE
);

171 #ñi‡
	`deföed
(
MCU_CORE_B91
)

172 
CLOCK_INIT
;

176 #i‡
	`deföed
(
MCU_CORE_826x
)

177 
sysTimîPîUs
 = 
tickPîUs
;

178 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

179 
sysTimîPîUs
 = 
sys_tick_≥r_us
;

180 #ñi‡
	`deföed
(
MCU_CORE_B91
)

181 
sysTimîPîUs
 = 
SYSTEM_TIMER_TICK_1US
;

184 
	`gpio_öô
(
TRUE
);

186 #i‡
UART_PRINTF_MODE


187 
	`DEBUG_TX_PIN_INIT
();

190 if(
°©e
 =
SYSTEM_RETENTION_NONE
){

191 
	`øndInô
();

192 
	`öã∫ÆFœshSizeCheck
();

193 #i‡
PM_ENABLE


194 
	`PM_CLOCK_INIT
();

197 #i‡
PM_ENABLE


198 
	`drv_pm_wakeupTimeUpd©e
();

202 #i‡
VOLTAGE_DETECT_ENABLE


203 
	`vﬁège_dëe˘_öô
();

206 
	`ZB_RADIO_INIT
();

208 
	`ZB_TIMER_INIT
();

210  
°©e
;

211 
	}
}

213 
	$drv_íabÀ_úq
()

215 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

216 
	`úq_íabÀ
();

217 #ñi‡
	`deföed
(
MCU_CORE_B91
)

218 
	`c‹e_öãºu±_íabÀ
();

220 
	}
}

222 
u32
 
	$drv_dißbÀ_úq
()

224 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

225  (
u32
)
	`úq_dißbÀ
();

226 #ñi‡
	`deföed
(
MCU_CORE_B91
)

227  
	`c‹e_öãºu±_dißbÀ
();

229 
	}
}

231 
u32
 
	$drv_ª°‹e_úq
(
u32
 
í
)

233 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

234 
	`úq_ª°‹e
((
u8
)
í
);

236 #ñi‡
	`deföed
(
MCU_CORE_B91
)

237  
	`c‹e_ª°‹e_öãºu±
(
í
);

239 
	}
}

241 
	$drv_wd_£tI¡îvÆ
(
u32
 
ms
)

243 
	`wd_£t_öãrvÆ_ms
(
ms
);

244 
	}
}

246 
	$drv_wd_°¨t
()

248 
	`wd_°¨t
();

249 
	}
}

251 
	$drv_wd_˛ór
()

253 
	`wd_˛ór
();

254 
	}
}

256 
u32
 
	$drv_u32R™d
()

258 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

259  
	`ønd
();

260 #ñi‡
	`deföed
(
MCU_CORE_B91
)

261  
	`ång_ønd
();

263 
	}
}

265 
	$drv_gíî©eR™domD©a
(
u8
 *
pD©a
, u8 
Àn
)

267 
u32
 
øndNums
 = 0;

269 
u8
 
i
 = 0; i < 
Àn
; i++){

270 if((
i
 & 3) == 0){

271 
øndNums
 = 
	`drv_u32R™d
();

274 
pD©a
[
i
] = 
øndNums
 & 0xff;

275 
øndNums
 >>= 8;

277 
	}
}

	@proj/drivers/drv_hw.h

24 #¥agm®
⁄˚


26 
	#BATTERY_SAFETY_THRESHOLD
 2200

27 

	)

28 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

29 
	#SYSTEM_RESET
(Ë
	`mcu_ª£t
()

	)

30 #ñi‡
deföed
(
MCU_CORE_B91
)

31 
	#SYSTEM_RESET
(Ë
	`sys_ªboŸ
()

	)

35 
	mSYSTEM_RETENTION_NONE
,

36 
	mSYSTEM_RETENTION_EN
,

37 }
	t°¨tup_°©e_e
;

39 
u32
 
sysTimîPîUs
;

41 
°¨tup_°©e_e
 
drv_∂©f‹m_öô
();

43 
drv_íabÀ_úq
();

44 
u32
 
drv_dißbÀ_úq
();

45 
u32
 
drv_ª°‹e_úq
(u32 
í
);

47 
drv_wd_£tI¡îvÆ
(
u32
 
ms
);

48 
drv_wd_°¨t
();

49 
drv_wd_˛ór
();

51 
u32
 
drv_u32R™d
();

52 
drv_gíî©eR™domD©a
(
u8
 *
pD©a
, u8 
Àn
);

54 
vﬁège_dëe˘
();

	@proj/drivers/drv_i2c.c

24 
	~"../é_comm⁄.h
"

34 
	$drv_i2c_ma°î_öô
(
u32
 
i2cClock
)

36 
u8
 
divClock
 = (u8)(
I2C_CLOCK_SOURCE
 / (4 * 
i2cClock
));

38 #if 
	`deföed
(
MCU_CORE_826x
)

39 
	`I2C_Ma°îInô
(
divClock
);

40 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

41 
	`i2c_ma°î_öô
(
divClock
);

42 #ñi‡
	`deföed
(
MCU_CORE_B91
)

43 
	`i2c_ma°î_öô
();

44 
	`i2c_£t_ma°î_˛k
(
divClock
);

46 
	}
}

54 
	$drv_i2c_¶ave_öô
(
u8
 
devi˚ID
)

56 #if 
	`deföed
(
MCU_CORE_826x
)

57 
	`I2C_SœveInô
(
devi˚ID
, 0, 
NULL
);

58 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

59 
	`i2c_¶ave_öô
(
devi˚ID
, 0, 
NULL
);

60 #ñi‡
	`deföed
(
MCU_CORE_B91
)

61 
	`i2c_¶ave_öô
(
devi˚ID
);

63 
	}
}

75 
	$drv_i2c_wrôe_byã
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 
d©a
)

77 #if 
	`deföed
(
MCU_CORE_826x
)

78 
	`I2C_SëId
(
¶aveID
);

79 
	`I2C_WrôeByã
(
addr
, 
addrLí
, 
d©a
);

80 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

81 
	`i2c_£t_id
(
¶aveID
);

82 
	`i2c_wrôe_byã
(
addr
, 
addrLí
, 
d©a
);

83 #ñi‡
	`deföed
(
MCU_CORE_B91
)

84 
u8
 
buf
[6] = {0};

85 
u8
 *
pBuf
 = 
buf
;

87 
u8
 
i
 = 0; i < 
addrLí
; i++){

88 *
pBuf
++ = (
u8
)(
addr
 >> ((
addrLí
 - 1 - 
i
) << 3));

90 *
pBuf
++ = 
d©a
;

92 
	`i2c_ma°î_wrôe
(
¶aveID
, 
buf
, (
u8
)(
pBuf
 - buf));

94 
	}
}

105 
	$drv_i2c_wrôe_£rõs
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 *
d©aBuf
, 
d©aLí
)

107 #if 
	`deföed
(
MCU_CORE_826x
)

108 
	`I2C_SëId
(
¶aveID
);

109 
	`I2C_WrôeSîõs
(
addr
, 
addrLí
, 
d©aBuf
, 
d©aLí
);

110 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

111 
	`i2c_£t_id
(
¶aveID
);

112 
	`i2c_wrôe_£rõs
(
addr
, 
addrLí
, 
d©aBuf
, 
d©aLí
);

113 #ñi‡
	`deföed
(
MCU_CORE_B91
)

114 
u8
 *
pBuf
 = (u8 *)
	`ev_buf_Æloˇã
(
addrLí
 + 
d©aLí
);

115 if(
pBuf
){

116 
u8
 *
pD©a
 = 
pBuf
;

118 
u8
 
i
 = 0; i < 
addrLí
; i++){

119 *
pD©a
++ = (
u8
)(
addr
 >> ((
addrLí
 - 1 - 
i
) << 3));

121 
	`mem˝y
(
pD©a
, 
d©aBuf
, 
d©aLí
);

122 
pD©a
 +
d©aLí
;

124 
	`i2c_ma°î_wrôe
(
¶aveID
, 
pBuf
, (
u8
)(
addrLí
 + 
d©aLí
));

126 
	`ev_buf_‰ì
(
pBuf
);

129 
	}
}

139 
u8
 
	$drv_i2c_ªad_byã
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
)

141 #if 
	`deföed
(
MCU_CORE_826x
)

142 
	`I2C_SëId
(
¶aveID
);

143  
	`I2C_RódByã
(
addr
, 
addrLí
);

144 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

145 
	`i2c_£t_id
(
¶aveID
);

146  
	`i2c_ªad_byã
(
addr
, 
addrLí
);

147 #ñi‡
	`deföed
(
MCU_CORE_B91
)

148 
u8
 
d©a
 = 0;

149 
u8
 
buf
[4] = {0};

150 
u8
 *
pBuf
 = 
buf
;

152 
u8
 
i
 = 0; i < 
addrLí
; i++){

153 *
pBuf
++ = (
u8
)(
addr
 >> ((
addrLí
 - 1 - 
i
) << 3));

156 
	`i2c_ma°î_wrôe_ªad
(
¶aveID
, 
buf
, (
u8
)
addrLí
, &
d©a
, 1);

158  
d©a
;

160 
	}
}

171 
	$drv_i2c_ªad_£rõs
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 *
d©aBuf
, 
d©aLí
)

173 #if 
	`deföed
(
MCU_CORE_826x
)

174 
	`I2C_SëId
(
¶aveID
);

175 
	`I2C_RódSîõs
(
addr
, 
addrLí
, 
d©aBuf
, 
d©aLí
);

176 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

177 
	`i2c_£t_id
(
¶aveID
);

178 
	`i2c_ªad_£rõs
(
addr
, 
addrLí
, 
d©aBuf
, 
d©aLí
);

179 #ñi‡
	`deföed
(
MCU_CORE_B91
)

180 
u8
 
buf
[4] = {0};

181 
u8
 *
pBuf
 = 
buf
;

183 
u8
 
i
 = 0; i < 
addrLí
; i++){

184 *
pBuf
++ = (
u8
)(
addr
 >> ((
addrLí
 - 1 - 
i
) << 3));

187 
	`i2c_ma°î_wrôe_ªad
(
¶aveID
, 
buf
, (
u8
)
addrLí
, 
d©aBuf
, (u8)
d©aLí
);

189 
	}
}

196 #if 
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

197 
	$drv_i2c_gpio_£t
(
I2C_GPIO_GroupTy≥Def
 
i2c_pö_group
)

199 #if 
	`deföed
(
MCU_CORE_826x
)

200 
	`I2C_PöSñe˘
(
i2c_pö_group
);

202 
	`i2c_gpio_£t
(
i2c_pö_group
);

204 
	}
}

205 #ñi‡
deföed
(
MCU_CORE_8278
)

206 
	$drv_i2c_gpio_£t
(
I2C_GPIO_SdaTy≥Def
 
sda_pö
, 
I2C_GPIO_S˛Ty≥Def
 
s˛_pö
)

208 
	`i2c_gpio_£t
(
sda_pö
, 
s˛_pö
);

209 
	}
}

210 #ñi‡
deföed
(
MCU_CORE_B91
)

211 
	$drv_i2c_gpio_£t
(
i2c_sda_pö_e
 
sda_pö
, 
i2c_s˛_pö_e
 
s˛_pö
)

213 
	`i2c_£t_pö
(
sda_pö
, 
s˛_pö
);

214 
	}
}

	@proj/drivers/drv_i2c.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

28 
	#I2C_CLOCK_SOURCE
 
CLOCK_SYS_CLOCK_HZ


	)

29 #ñi‡
deföed
(
MCU_CORE_B91
)

31 
	#I2C_CLOCK_SOURCE
 (
sys_˛k
.
p˛k
 * 1000 * 1000)

	)

41 
drv_i2c_ma°î_öô
(
u32
 
i2cClock
);

49 
drv_i2c_¶ave_öô
(
u8
 
devi˚ID
);

60 
drv_i2c_wrôe_byã
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 
d©a
);

70 
u8
 
drv_i2c_ªad_byã
(u8 
¶aveID
, 
u32
 
addr
, u32 
addrLí
);

81 
drv_i2c_wrôe_£rõs
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 *
d©aBuf
, 
d©aLí
);

92 
drv_i2c_ªad_£rõs
(
u8
 
¶aveID
, 
u32
 
addr
, u32 
addrLí
, u8 *
d©aBuf
, 
d©aLí
);

99 #if 
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
)

100 
drv_i2c_gpio_£t
(
I2C_GPIO_GroupTy≥Def
 
i2c_pö_group
);

101 #ñi‡
deföed
(
MCU_CORE_8278
)

102 
drv_i2c_gpio_£t
(
I2C_GPIO_SdaTy≥Def
 
sda_pö
, 
I2C_GPIO_S˛Ty≥Def
 
s˛_pö
);

103 #ñi‡
deföed
(
MCU_CORE_B91
)

104 
drv_i2c_gpio_£t
(
i2c_sda_pö_e
 
sda_pö
, 
i2c_s˛_pö_e
 
s˛_pö
);

	@proj/drivers/drv_keyboard.c

24 
	~"../é_comm⁄.h
"

27 #i‡(
deföed
(
KB_DRIVE_PINS
Ë&& deföed(
KB_SCAN_PINS
))

30 #i‚def 
SCAN_PIN_50K_PULLUP_ENABLE


31 
	#SCAN_PIN_50K_PULLUP_ENABLE
 0

	)

33 #i‚def 
KB_MAP_DEFAULT


34 
	#KB_MAP_DEFAULT
 1

	)

36 #i‚def 
KB_LINE_MODE


37 
	#KB_LINE_MODE
 1

	)

39 #i‚def 
KB_LINE_HIGH_VALID


40 
	#KB_LINE_HIGH_VALID
 0

	)

42 #i‚def 
KB_KEY_FLASH_PIN_MULTI_USE


43 
	#KB_KEY_FLASH_PIN_MULTI_USE
 0

	)

45 #i‚def 
KB_HAS_CTRL_KEYS


46 
	#KB_HAS_CTRL_KEYS
 0

	)

48 #i‚def 
KB_ONLY_SINGLEKEY_SUPP


49 
	#KB_ONLY_SINGLEKEY_SUPP
 0

	)

51 #i‚def 
KB_RM_GHOST_KEY_EN


52 
	#KB_RM_GHOST_KEY_EN
 0

	)

54 #i‚def 
KB_HAS_FN_KEY


55 
	#KB_HAS_FN_KEY
 0

	)

57 #i‚def 
KB_DRV_DELAY_TIME


58 
	#KB_DRV_DELAY_TIME
 10

	)

61 
u32
 
	gdrive_pös
[] = 
KB_DRIVE_PINS
;

62 
u32
 
	gsˇn_pös
[] = 
KB_SCAN_PINS
;

64 
kb_d©a_t
 
	gkb_evít
;

65 
kb_d©a_t
 
	gœ°_kb_evít
;

67 
u8
 
	tkb_k_mp_t
[
ARRAY_SIZE
(
drive_pös
)];

70 c⁄° 
u8
 
	gkb_m≠_n‹mÆ
[
ARRAY_SIZE
(
sˇn_pös
)][ARRAY_SIZE(
drive_pös
)] = 
KB_MAP_NORMAL
;

73 
kb_k_mp_t
 *
	gkb_p_m≠
[2] = {

74 (
kb_k_mp_t
 *)
kb_m≠_n‹mÆ
,

75 (
kb_k_mp_t
 *)
kb_m≠_n‹mÆ
,

78 
u32
 
	gsˇn_pö_√ed
;

79 
u8
 
	gkb_is_‚_¥es£d
 = 0;

80 
kb_k_mp_t
 *
	gkb_k_mp
;

82 
	$kb_rmv_gho°_key
(
u32
 *
¥es£d_m©rix
){

83 
u32
 
mix_föÆ
 = 0;

85 
	`f‹óch_¨r
(
i
, 
drive_pös
){

86 
j
 = (
i
+1); j < 
	`ARRAY_SIZE
(
drive_pös
); ++j){

87 
u32
 
mix
 = (
¥es£d_m©rix
[
i
] &Öªs£d_m©rix[
j
]);

90 if–
mix
 && (!
	`BIT_IS_POW2
(mixË|| (
¥es£d_m©rix
[
i
] ^Öªs£d_m©rix[
j
])) ){

94 
mix_föÆ
 |
mix
;

97 
¥es£d_m©rix
[
i
] &~
mix_föÆ
;

99 
	}
}

102 
u32
 
	$key_deboun˚_fûãr
(
u32
 
måx_cur
[], u32 
fût_í
){

103 
u32
 
kc
 = 0;

104 
u32
 
måx_¥e
[
	`ARRAY_SIZE
(
drive_pös
)];

105 
u32
 
måx_œ°
[
	`ARRAY_SIZE
(
drive_pös
)];

107 
	`f‹óch_¨r
(
i
, 
drive_pös
){

108 
u32
 
måx_tmp
 = 
måx_cur
[
i
];

109 if(
fût_í
){

111 
måx_cur
[
i
] = ( ~
måx_œ°
[i] & (
måx_¥e
[i] & 
måx_tmp
) ) | ( mtrx_last[i] & (mtrx_pre[i] | mtrx_tmp) );

113 if(
måx_cur
[
i
] !
måx_œ°
[i]){

114 
kc
 = 1;

116 
måx_¥e
[
i
] = 
måx_tmp
;

117 
måx_œ°
[
i
] = 
måx_cur
[i];

119  
kc
;

120 
	}
}

126 
ölöe
 
	$kb_ªm≠_key_row
(
drv_öd
, 
u32
 
m
, 
key_max
, 
kb_d©a_t
 *
kb_d©a
){

127 
	`f‹óch_¨r
(
i
, 
sˇn_pös
){

128 if(
m
 & 0x01){

129 
u8
 
kc
 = 
kb_k_mp
[
i
][
drv_öd
];

130 #i‡(
KB_HAS_CTRL_KEYS
)

131 if(
kc
 >
VK_CTRL
 && k¯<
VK_RWIN
)

132 
kb_d©a
->
˘æ_key
 |
	`BIT
(
kc
 - 
VK_CTRL
);

135 if(
VK_ZOOM_IN
 =
kc
 || 
VK_ZOOM_OUT
 == kc){

136 
kb_d©a
->
˘æ_key
 |
VK_MSK_LCTRL
;

137 
kb_d©a
->
keycode
[kb_d©a->
˙t
++] = (
VK_ZOOM_IN
 =
kc
)? 
VK_EQUAL
 : 
VK_MINUS
;

139 if(
kc
 !
VK_FN
)

140 
kb_d©a
->
keycode
[kb_d©a->
˙t
++] = 
kc
;

142 
kb_d©a
->
keycode
[kb_d©a->
˙t
++] = 
kc
;

144 if(
kb_d©a
->
˙t
 >
key_max
){

148 
m
 = m >> 1;

149 if(!
m
){

153 
	}
}

155 
ölöe
 
	$kb_ªm≠_key_code
(
u32
 *
¥es£d_m©rix
, 
key_max
, 
kb_d©a_t
 *
kb_d©a
, 
numlock_°©us
){

156 
kb_k_mp
 = 
kb_p_m≠
[0];

158 
	`f‹óch_¨r
(
i
, 
drive_pös
){

159 
u32
 
m
 = 
¥es£d_m©rix
[
i
];

160 if(!
m
) ;

161 
	`kb_ªm≠_key_row
(
i
, 
m
, 
key_max
, 
kb_d©a
);

162 if(
kb_d©a
->
˙t
 >
key_max
){

166 
	}
}

168 
u32
 
	$kb_key_¥es£d
(
u8
 *
gpio
)

170 #if(!
KB_LINE_MODE
)

171 
	`f‹óch_¨r
(
i
, 
drive_pös
){

172 
	`drv_gpio_wrôe
(
drive_pös
[
i
], 
KB_LINE_HIGH_VALID
);

173 
	`drv_gpio_ouçut_í
(
drive_pös
[
i
], 1);

175 
	`WaôUs
(20);

177 
	`drv_gpio_ªad_Æl
(
gpio
);

179 
u32
 
ªt
 = 0;

180 
u8
 
ªÀa£_˙t
 = 0;

181 
u32
 
ªt_œ°
 = 0;

183 
	`f‹óch_¨r
(
i
, 
sˇn_pös
){

184 if(
KB_LINE_HIGH_VALID
 !!
	`gpio_ªad_ˇche
(
sˇn_pös
[
i
], 
gpio
)){

185 
ªt
 |(1 << 
i
);

186 
ªÀa£_˙t
 = 6;

187 
ªt_œ°
 = 
ªt
;

190 if(
ªÀa£_˙t
){

191 
ªt
 = 
ªt_œ°
;

192 
ªÀa£_˙t
--;

195 #if(!
KB_LINE_MODE
)

196 
	`f‹óch_¨r
(
i
, 
drive_pös
){

197 
	`drv_gpio_wrôe
(
drive_pös
[
i
], 0);

198 
	`drv_gpio_ouçut_í
(
drive_pös
[
i
], 0);

201  
ªt
;

202 
	}
}

204 
u32
 
	$kb_sˇn_row
(
drv_öd
, 
u8
 *
gpio
){

209 #if (
KB_KEY_FLASH_PIN_MULTI_USE
)

210 
MSPI_AS_GPIO
;

213 #if(!
KB_LINE_MODE
)

214 
u32
 
drv_pö
 = 
drive_pös
[
drv_öd
];

215 
	`drv_gpio_wrôe
(
drv_pö
, 
KB_LINE_HIGH_VALID
);

216 
	`drv_gpio_ouçut_í
(
drv_pö
, 1);

219 
u32
 
m©rix
 = 0;

220 
	`f‹óch_¨r
(
j
, 
sˇn_pös
){

221 if(
sˇn_pö_√ed
 & 
	`BIT
(
j
)){

222 
key
 = !
	`gpio_ªad_ˇche
(
sˇn_pös
[
j
], 
gpio
);

223 if(
KB_LINE_HIGH_VALID
 !
key
) {

224 
m©rix
 |(1 << 
j
);

229 
	`drv_gpio_ªad_Æl
(
gpio
);

233 #if (
KB_KEY_FLASH_PIN_MULTI_USE
)

234 
MSPI_AS_SPI
;

237 #if(!
KB_LINE_MODE
)

240 
	`drv_gpio_wrôe
(
drv_pö
, 0);

241 
	`drv_gpio_ouçut_í
(
drv_pö
, 0);

245  
m©rix
;

246 
	}
}

248 
u32
 
	gm©rix_buff
[4][
ARRAY_SIZE
(
drive_pös
)];

249 
	gm©rix_w±r
, 
	gm©rix_Ωå
;

251 
u32
 
	$kb_sˇn_key
(
numlock_°©us
, 
ªad_key
){

252 
u8
 
gpio
[8];

254 
sˇn_pö_√ed
 = 
	`kb_key_¥es£d
(
gpio
);

256 if(
sˇn_pö_√ed
){

257 
kb_evít
.
˙t
 = 0;

258 
kb_evít
.
˘æ_key
 = 0;

259 
kb_is_‚_¥es£d
 = 0;

261 
u32
 
¥es£d_m©rix
[
	`ARRAY_SIZE
(
drive_pös
)] = {0};

262 
kb_k_mp
 = 
kb_p_m≠
[0];

264 
	`kb_sˇn_row
(0, 
gpio
);

266 
i
 = 0; i <
	`ARRAY_SIZE
(
drive_pös
); i++) {

267 
u32
 
r
 = 
	`kb_sˇn_row
(
i
 < 
	`ARRAY_SIZE
(
drive_pös
Ë? i : 0, 
gpio
);

268 if(
i
){

269 
¥es£d_m©rix
[
i
 - 1] = 
r
;

273 #if(
KB_RM_GHOST_KEY_EN
)

274 
	`kb_rmv_gho°_key
(&
¥es£d_m©rix
[0]);

277 
u32
 
key_ch™ged
 = 
	`key_deboun˚_fûãr
(
¥es£d_m©rix
, 1);

283 
u32
 *
pd
;

284 if(
key_ch™ged
){

286 
pd
 = 
m©rix_buff
[
m©rix_w±r
 & 3];

287 
k
 = 0; k < 
	`ARRAY_SIZE
(
drive_pös
); k++){

288 *
pd
++ = 
¥es£d_m©rix
[
k
];

290 
m©rix_w±r
 = (matrix_wptr + 1) & 7;

291 if–((
m©rix_w±r
 - 
m©rix_Ωå
) & 7) > 4 ){

292 
m©rix_Ωå
 = (
m©rix_w±r
 - 4) & 7;

296 if(
numlock_°©us
 & 
KB_NUMLOCK_STATUS_INVALID
){

301 if(
m©rix_w±r
 =
m©rix_Ωå
 || !
ªad_key
){

304 
pd
 = 
m©rix_buff
[
m©rix_Ωå
&3];

305 
m©rix_Ωå
 = (matrix_rptr + 1) & 7;

309 #if(
KB_ONLY_SINGLEKEY_SUPP
)

310 
	`kb_ªm≠_key_code
(
pd
, 2, &
kb_evít
, 
numlock_°©us
);

311 
mu…ikey_¥es£d
 = 0;

314 if(
kb_evít
.
˙t
 > 1){

315 
kb_evít
.
˙t
 = 0;

316 
mu…ikey_¥es£d
 = 1;

319 
	`kb_ªm≠_key_code
(
pd
, 
KB_RETURN_KEY_MAX
, &
kb_evít
, 
numlock_°©us
);

325 
	}
}

328 
	$kb_is_d©a_ßme
(
kb_d©a_t
 *
a
, kb_d©a_à*
b
){

329 if(!
a
 || !
b
){

332 if((
a
->
˙t
 !
b
->˙tË|| (a->
˘æ_key
 != b->ctrl_key))

334 
	`f‹óch
(
i
, 
a
->
˙t
){

335 if(
a
->
keycode
[
i
] !
b
->keycode[i]){

340 
	}
}

	@proj/drivers/drv_keyboard.h

24 #¥agm®
⁄˚


28 
	#KB_RETURN_KEY_MAX
 6

	)

29 
	#KB_NUMLOCK_STATUS_INVALID
 
	`BIT
(7)

	)

32 
u8
 
	m˙t
;

33 
u8
 
	m˘æ_key
;

34 
u8
 
	mkeycode
[
KB_RETURN_KEY_MAX
];

36 }
	tkb_d©a_t
;

39 
kb_d©a_t
 *
	mœ°_£nd_d©a
;

40 
u32
 
	mœ°_£nd_time
;

41 
u8
 
	mª£¡_no_ack_˙t
;

42 
u8
 
	mkey_¥es£d
;

43 
u8
 
	m‰ame_no
;

44 
u8
 
	mack_‰ame_no
;

45 }
	trf_kb_˘æ_t
;

48 
u8
 
	mvÆ_‹g
;

49 
u8
 
	mvÆ_chg
;

50 
u8
 
	mthis_¥es£d
;

51 
u8
 
	mœ°_¥es£d
;

52 
u32
 
	ml⁄g¥ess_th
;

53 
u32
 
	m¥ess_°¨t_time
;

54 
u8
 
	ml⁄g¥es£d
;

55 
u8
 
	m¥o˚s£d
;

56 }
	tkb_l⁄g¥ess_˘æ_t
;

59 
	mKB_NOT_LONGPRESS
,

60 
	mKB_IS_LONGPRESS
,

61 
	mKB_KEY_RELEASE
,

64 
kb_d©a_t
 
kb_evít
;

68 
ölöe
 
	$gpio_ªad_ˇche
(
u32
 
pö
, 
u8
 *
p
){

69  
p
[
pö
>>8] & (pin & 0xff);

70 
	}
}

72 
ölöe
 
	$kb_is_key_vÆid
(
kb_d©a_t
 *
p
){

73  (
p
->
˙t
 ||Ö->
˘æ_key
);

74 
	}
}

75 
ölöe
 
	$kb_£t_key_övÆid
(
kb_d©a_t
 *
p
){

76 
p
->
˙t
 =Ö->
˘æ_key
 = 0;

77 
	}
}

80 
kb_is_d©a_ßme
(
kb_d©a_t
 *
a
, kb_d©a_à*
b
);

82 
u32
 
kb_sˇn_key
(
numlock_°©us
, 
ªad_key
);

	@proj/drivers/drv_nv.c

24 
	~"../é_comm⁄.h
"

26 #i‡
FLASH_CAP_SIZE_1M


27 
u32
 
	gg_u32MacFœshAddr
 = 
FLASH_ADDR_0F_MAC_ADDR_1M
;

28 
u32
 
	gg_u32CfgFœshAddr
 = 
FLASH_ADDR_OF_F_CFG_INFO_1M
;

30 
u32
 
	gg_u32MacFœshAddr
 = 
FLASH_ADDR_OF_MAC_ADDR_512K
;

31 
u32
 
	gg_u32CfgFœshAddr
 = 
FLASH_ADDR_OF_F_CFG_INFO_512K
;

34 
nv_°s_t
 
	$nv_ödex_upd©e
(
u16
 
id
, 
u8
 
›Se˘
, u16 
›IãmIdx
, 
nv_öfo_idx_t
 *
idx
)

36 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

37 
	`Êash_wrôe
(
idxSèπAddr
 + 
›IãmIdx
 * (
nv_öfo_idx_t
), “v_öfo_idx_t), (
u8
 *)
idx
);

38  
NV_SUCC
;

39 
	}
}

41 
nv_°s_t
 
	$nv_ödex_ªad
(
u16
 
id
, 
u8
 
ôemId
, u16 
Àn
, u8 
›Se˘
, 
u32
 
tŸÆIãmNum
, u16 *
idxNo
)

43 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

44 
u32
 
idxTŸÆNum
 = 
tŸÆIãmNum
;

45 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
Ë+ (
idxTŸÆNum
Ë* (
nv_öfo_idx_t
);

46 
u16
 
›IãmIdx
 = 
idxTŸÆNum
;

47 
u16
 
ªadIdxNum
 = 4;

48 
nv_öfo_idx_t
 
idxInfo
[4];

49 
u8
 
jump
 = 0;

50 
u8
 
ôemFœg
 = 
ITEM_FIELD_VALID
;

51 
u16
 
ôemTŸÆSize
 = 
	`ITEM_TOTAL_LEN
(
Àn
);

53 i‡(
ôemId
 =
ITEM_FIELD_IDLE
)

55 
ôemFœg
 = 
ITEM_FIELD_IDLE
;

56 
ôemTŸÆSize
 = 0xffff;

59 
ªt
 = 
NV_ITEM_NOT_FOUND
;

60 
s32
 
i
 = 0;

61 
idxTŸÆNum
 > 0)

63 
ªadIdxNum
 = (
idxTŸÆNum
 > 4) ? 4 : idxTotalNum;

64 
idxSèπAddr
 -
ªadIdxNum
 * (
nv_öfo_idx_t
);

65 
›IãmIdx
 -
ªadIdxNum
;

66 
idxTŸÆNum
 -
ªadIdxNum
;

67 
	`Êash_ªad
(
idxSèπAddr
, 
ªadIdxNum
 * (
nv_öfo_idx_t
), (
u8
 *)
idxInfo
);

68 
i
 = 
ªadIdxNum
 - 1; i >= 0; i--)

70 i‡(
ôemId
 !
ITEM_FIELD_IDLE
)

72 i‡(
idxInfo
[
i
].
u£dSèã
 =
ôemFœg
 && idxInfo[i].
size
 =
ôemTŸÆSize
 && idxInfo[i].
ôemId
 == itemId)

74 
jump
 = 1;

80 i‡(
idxInfo
[
i
].
u£dSèã
 !
ôemFœg
 || idxInfo[i].
size
 !
ôemTŸÆSize
 || idxInfo[i].
ôemId
 != itemId)

82 
jump
 = 1;

87 i‡(
jump
)

89 
›IãmIdx
 +
i
;

90 *
idxNo
 = 
›IãmIdx
;

91 
ªt
 = 
NV_SUCC
;

96  
ªt
;

97 
	}
}

99 
nv_°s_t
 
	$nv_£˘‹_ªad
(
u16
 
id
, 
u8
 
£˘TŸÆNum
, 
nv_£˘_öfo_t
 *
£˘Info
)

101 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

102 
nv_£˘_öfo_t
 
s
;

103 
u32
 
moduÀSèπAddr
 = 
	`MODULES_START_ADDR
(
id
);

104 
s32
 
i
 = 0;

106 
i
 = 0; i < 
£˘TŸÆNum
; i++)

108 
	`Êash_ªad
(
moduÀSèπAddr
, (
nv_£˘_öfo_t
), (
u8
 *)&
s
);

109 i‡(
s
.
u£dFœg
 =
NV_SECTOR_VALID
 && s.
idName
 =
id
)

111 
	`mem˝y
(
£˘Info
, &
s
, (
nv_£˘_öfo_t
));

114 
moduÀSèπAddr
 +
	`NV_SECTOR_SIZE
(
id
);

116 i‡(
i
 =
£˘TŸÆNum
)

118 
ªt
 = 
NV_ITEM_NOT_FOUND
;

120  
ªt
;

121 
	}
}

123 
nv_°s_t
 
	$nv_wrôe_ôem
(
u16
 
id
, 
u8
 
ôemId
, u8 
›Se˘
, u16 
›IãmIdx
, u16 
Àn
, u8 *
buf
, 
boﬁ
 
isFœshC›y
)

126 
nv_öfo_idx_t
 
idxInfo
;

127 
	`mem£t
((
u8
 *)&
idxInfo
, 0, (
nv_öfo_idx_t
));

128 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

129 
u32
 
off£t
 = 0;

131 i‡(
›IãmIdx
 == 0)

133 
off£t
 = 
	`MODULE_CONTEXT_START
(
id
, 
›Se˘
, 
Àn
);

137 
	`Êash_ªad
(
idxSèπAddr
 + (
›IãmIdx
 - 1Ë* (
nv_öfo_idx_t
), “v_öfo_idx_t), (
u8
 *)&
idxInfo
);

138 
off£t
 = ((
idxInfo
.off£à+ idxInfo.
size
 + 3) & (~0x03));

140 
idxInfo
.
u£dSèã
 = 
ITEM_FIELD_OPERATION
;

141 
idxInfo
.
size
 = 
Àn
 + (
ôemHdr_t
);

142 
idxInfo
.
off£t
 = offset;

143 
idxInfo
.
ôemId
 = itemId;

145 
	`Êash_wrôe
(
idxSèπAddr
 + 
›IãmIdx
 * (
nv_öfo_idx_t
), “v_öfo_idx_t), (
u8
 *)&
idxInfo
);

148 i‡(
isFœshC›y
)

151 
u8
 
c›yLí
 = 48;

152 
u8
 *
pTemp
 = (u8 *)
	`ev_buf_Æloˇã
(
c›yLí
);

153 i‡(
pTemp
)

155 
u8
 
wLí
 = 0;

156 
u16
 
tﬂlLí
 = 
idxInfo
.
size
;

157 
u32
 
sAddr
 = (u32)
buf
;

158 
u32
 
dAddr
 = 
idxInfo
.
off£t
;

159 
tﬂlLí
 > 0)

161 
wLí
 = (
tﬂlLí
 > 
c›yLí
) ? copyLen :ÅoalLen;

162 
	`Êash_ªad
(
sAddr
, 
wLí
, 
pTemp
);

163 
	`Êash_wrôe
(
dAddr
, 
wLí
, 
pTemp
);

164 
tﬂlLí
 -
wLí
;

165 
sAddr
 +
wLí
;

166 
dAddr
 +
wLí
;

168 
	`ev_buf_‰ì
(
pTemp
);

172  
NV_NOT_ENOUGH_SAPCE
;

177 
u32
 
checkSum
 = 0;

178 
ôemHdr_t
 
hdr
;

179 
u32
 
∑ylﬂdAddr
 = 
idxInfo
.
off£t
 + (
ôemHdr_t
);

181 
s32
 
i
 = 0; i < 
Àn
; i++)

183 
checkSum
 +
buf
[
i
];

185 
	`Êash_wrôe
(
∑ylﬂdAddr
, 
Àn
, 
buf
);

188 
u8
 
vCheck
[16];

189 
u16
 
tLí
 = 
Àn
;

190 
u16
 
unôLí
;

191 
u32
 
checkSumRód
 = 0;

192 
tLí
 > 0)

194 
unôLí
 = (
tLí
 > 16) ? 16 :ÅLen;

195 
	`Êash_ªad
(
∑ylﬂdAddr
, 
unôLí
, 
vCheck
);

196 
s32
 
i
 = 0; i < 
unôLí
; i++)

198 
checkSumRód
 +
vCheck
[
i
];

200 
tLí
 -
unôLí
;

201 
∑ylﬂdAddr
 +
unôLí
;

204 i‡(
checkSum
 =
checkSumRód
)

206 
hdr
.
ôemId
 = itemId;

207 
hdr
.
size
 = 
Àn
;

208 
hdr
.
u£d
 = 
ITEM_FIELD_VALID
;

209 
hdr
.
checkSum
 = checkSum;

210 
	`Êash_wrôe
(
idxInfo
.
off£t
, (
ôemHdr_t
), (
u8
 *)&
hdr
);

214  
NV_CHECK_SUM_ERROR
;

219 
u8
 
°aOff£t
 = 
	`OFFSETOF
(
nv_öfo_idx_t
, 
u£dSèã
);

220 
idxInfo
.
u£dSèã
 = 
ITEM_FIELD_VALID
;

221 
	`Êash_wrôe
(
idxSèπAddr
 + 
›IãmIdx
 * (
nv_öfo_idx_t
Ë+ 
°aOff£t
, 1, (
u8
 *)&
idxInfo
.
u£dSèã
);

223  
NV_SUCC
;

224 
	}
}

226 
nv_°s_t
 
	$nv_ÊashRódByIndex
(
u8
 
id
, u8 
ôemId
, u8 
›Se˘
, 
u16
 
›Idx
, u16 
Àn
, u8 *
buf
)

228 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

229 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

230 
nv_öfo_idx_t
 
idx
;

231 
	`Êash_ªad
(
idxSèπAddr
 + 
›Idx
 * (
nv_öfo_idx_t
), “v_öfo_idx_t), (
u8
 *)&
idx
);

232 i‡(
idx
.
u£dSèã
 !
ITEM_FIELD_VALID
)

234  
NV_ITEM_NOT_FOUND
;

237 
ôemHdr_t
 
hdr
;

238 
	`Êash_ªad
(
idx
.
off£t
, (
ôemHdr_t
), (
u8
 *)&
hdr
);

239 i‡(
hdr
.
size
 =
Àn
 && hdr.
u£d
 =
ITEM_FIELD_VALID
 && hdr.
ôemId
 == itemId)

241 
	`Êash_ªad
(
idx
.
off£t
 + (
ôemHdr_t
), 
Àn
, 
buf
);

245 
ªt
 = 
NV_ITEM_NOT_FOUND
;

247  
ªt
;

248 
	}
}

250 
nv_°s_t
 
	$nv_ôemDñëeByIndex
(
u8
 
id
, u8 
ôemId
, u8 
›Se˘
, 
u16
 
›Idx
)

252 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

253 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

254 
nv_öfo_idx_t
 
idx
;

255 
u8
 
°aOff£t
 = 
	`OFFSETOF
(
nv_öfo_idx_t
, 
u£dSèã
);

256 
idx
.
u£dSèã
 = 
ITEM_FIELD_INVALID
;

257 
	`Êash_wrôe
(
idxSèπAddr
 + 
›Idx
 * (
nv_öfo_idx_t
Ë+ 
°aOff£t
, 1, &(
idx
.
u£dSèã
));

258  
ªt
;

259 
	}
}

261 
nv_°s_t
 
	$nv_ÊashWrôeNew
(
u8
 
sögÀ
, 
u16
 
id
, u8 
ôemId
, u16 
Àn
, u8 *
buf
)

263 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

264 
nv_£˘_öfo_t
 
£˘Info
;

265 
u8
 
›Se˘
 = 0;

266 
u32
 
moduÀSèπAddr
 = 
	`MODULES_START_ADDR
(
id
);

268 
s32
 
i
 = 0;

271 i‡(
	`NV_SECTOR_SIZE
(
id
Ë< 
	`ITEM_TOTAL_LEN
(
Àn
Ë+ 
	`MODULE_INFO_SIZE
(id))

273  
NV_NOT_ENOUGH_SAPCE
;

277 
ªt
 = 
	`nv_£˘‹_ªad
(
id
, 
MODULE_SECTOR_NUM
, &
£˘Info
);

278 i‡(
ªt
 !
NV_SUCC
)

281 
s32
 
j
 = 0; j < 
MODULE_SECTOR_NUM
; j++){

282 
	`Êash_îa£
(
moduÀSèπAddr
 + 
j
 * 
FLASH_SECTOR_SIZE
);

285 
›Se˘
 = 0;

289 
›Se˘
 = 
£˘Info
.opSect;

295 
u32
 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

296 
u16
 
wIãmIdx
 = 0;

297 
nv_öfo_idx_t
 
idxInfo
[4];

298 
u8
 
£˘‹Upd©e
 = 0;

299 
s32
 
idxTŸÆNum
 = 
	`MODULE_IDX_NUM
(
id
);

300 
ªt
 = 
	`nv_ödex_ªad
(
id
, 
ITEM_FIELD_IDLE
, 
Àn
, 
›Se˘
, 
idxTŸÆNum
, &
wIãmIdx
);

301 i‡(
ªt
 =
NV_SUCC
)

303 
	`Êash_ªad
(
idxSèπAddr
 + 
wIãmIdx
 * (
nv_öfo_idx_t
), “v_öfo_idx_t), (
u8
 *)
idxInfo
);

304 i‡((
wIãmIdx
 =
idxTŸÆNum
 - 1) ||

305 (
idxInfo
[0].
off£t
 + idxInfo[0].
size
 + 
	`ITEM_TOTAL_LEN
(
Àn
)Ë> 
	`MODULE_SECT_END
(
id
, 
›Se˘
))

307 
£˘‹Upd©e
 = 1;

311 
wIãmIdx
 += 1;

315 
u8
 
ﬁdSe˘
 = 
›Se˘
;

316 i‡(
£˘‹Upd©e
)

318 
wIãmIdx
 = 0;

319 
›Se˘
 = (›Se˘ + 1Ë& (
MODULE_SECTOR_NUM
 - 1);

321 
u8
 
nv_ªÆSe˘Num
 = 
	`NV_SECTOR_SIZE
(
id
Ë/ 
FLASH_SECTOR_SIZE
;

322 
u32
 
îa£Addr
 = 
moduÀSèπAddr
 + 
›Se˘
 * 
	`NV_SECTOR_SIZE
(
id
);

323 
s32
 
k
 = 0; k < 
nv_ªÆSe˘Num
; k++)

326 
	`Êash_îa£
(
îa£Addr
);

327 
îa£Addr
 +
FLASH_SECTOR_SIZE
;

330 
u32
 
sizeu£dAddr
 = 0;

331 
u8
 
ªadIdxNum
 = 0;

332 
sizeu£dAddr
 = 
	`MODULE_CONTEXT_START
(
id
, 
›Se˘
, 
Àn
);

333 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
ﬁdSe˘
);

334 
idxTŸÆNum
 = 
	`MODULE_IDX_NUM
(
id
);

336 
idxTŸÆNum
 > 0)

338 
ªadIdxNum
 = (
idxTŸÆNum
 > 4) ? 4 : idxTotalNum;

339 
	`Êash_ªad
(
idxSèπAddr
, 
ªadIdxNum
 * (
nv_öfo_idx_t
), (
u8
 *)
idxInfo
);

340 
i
 = 0; i < 
ªadIdxNum
; i++)

342 i‡(
idxInfo
[
i
].
u£dSèã
 =
ITEM_FIELD_VALID
 &&

343 (
idxInfo
[
i
].
ôemId
 !ôemId || ((idxInfo[i].ôemId =ôemIdË&& !
sögÀ
)))

345 
ªt
 = 
	`nv_wrôe_ôem
(
id
, 
idxInfo
[
i
].
ôemId
, 
›Se˘
, 
wIãmIdx
, idxInfo[i].
size
 - (
ôemHdr_t
), (
u8
 *)idxInfo[i].
off£t
, 
TRUE
);

346 i‡(
ªt
 !
NV_SUCC
)

348  
ªt
;

350 
sizeu£dAddr
 +
idxInfo
[
i
].
size
;

351 
sizeu£dAddr
 = ((sizeusedAddr + 0x03) & (~0x03));

352 
wIãmIdx
 += 1;

355 
idxTŸÆNum
 -
ªadIdxNum
;

356 
idxSèπAddr
 +
ªadIdxNum
 * (
nv_öfo_idx_t
);

359 
idxTŸÆNum
 = 
	`MODULE_IDX_NUM
(
id
);

360 i‡(
wIãmIdx
 =
idxTŸÆNum
 || (
sizeu£dAddr
 + 
	`ITEM_TOTAL_LEN
(
Àn
)Ë> 
	`MODULE_SECT_END
(
id
, 
›Se˘
))

362  
NV_NOT_ENOUGH_SAPCE
;

367 
u8
 
dñëeIãmEn
 = 0;

368 
u16
 
dñëeIdx
 = 0;

369 
idxTŸÆNum
 = 
	`MODULE_IDX_NUM
(
id
);

370 i‡(
sögÀ
)

372 i‡(
NV_SUCC
 =
	`nv_ödex_ªad
(
id
, 
ôemId
, 
Àn
, 
›Se˘
, 
idxTŸÆNum
, &
dñëeIdx
))

374 
dñëeIãmEn
 = 1;

379 
ªt
 = 
	`nv_wrôe_ôem
(
id
, 
ôemId
, 
›Se˘
, 
wIãmIdx
, 
Àn
, 
buf
, 
FALSE
);

382 
idxSèπAddr
 = 
	`MODULE_IDX_START
(
id
, 
›Se˘
);

383 i‡(
dñëeIãmEn
)

385 
u8
 
°aOff£t
 = 
	`OFFSETOF
(
nv_öfo_idx_t
, 
u£dSèã
);

386 
idxInfo
[0].
u£dSèã
 = 
ITEM_FIELD_INVALID
;

387 
	`Êash_wrôe
(
idxSèπAddr
 + 
dñëeIdx
 * (
nv_öfo_idx_t
Ë+ 
°aOff£t
, 1, &(
idxInfo
[0].
u£dSèã
));

390 i‡(
ªt
 =
NV_SUCC
)

392 i‡(
£˘‹Upd©e
)

394 
£˘Info
.
idName
 = 
id
;

395 
£˘Info
.
›Se˘
 = opSect;

396 
£˘Info
.
u£dFœg
 = 
NV_SECTOR_INVALID
;

397 
	`Êash_wrôe
(
	`MODULE_SECT_START
(
id
, 
ﬁdSe˘
), (
nv_£˘_öfo_t
), (
u8
 *)&
£˘Info
);

399 
£˘Info
.
u£dFœg
 = 
NV_SECTOR_VALID
;

400 
£˘Info
.
›Se˘
 = opSect;

401 
	`Êash_wrôe
(
	`MODULE_SECT_START
(
id
, 
›Se˘
), (
nv_£˘_öfo_t
), (
u8
 *)&
£˘Info
);

405 i‡(
wIãmIdx
 == 0)

407 
£˘Info
.
idName
 = 
id
;

408 
£˘Info
.
u£dFœg
 = 
NV_SECTOR_VALID
;

409 
£˘Info
.
›Se˘
 = opSect;

410 
	`Êash_wrôe
(
	`MODULE_SECT_START
(
id
, 
›Se˘
), (
nv_£˘_öfo_t
), (
u8
 *)&
£˘Info
);

415  
ªt
;

416 
	}
}

418 
nv_°s_t
 
	$nv_ÊashRódNew
(
u8
 
sögÀ
, u8 
id
, u8 
ôemId
, 
u16
 
Àn
, u8 *
buf
)

420 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

421 
nv_£˘_öfo_t
 
£˘Info
;

422 
u8
 
›Se˘
 = 0;

423 
s32
 
idxTŸÆNum
 = 0;

424 
u16
 
›Idx
 = 0;

426 
ªt
 = 
	`nv_£˘‹_ªad
(
id
, 
MODULE_SECTOR_NUM
, &
£˘Info
);

427 i‡(
ªt
 !
NV_SUCC
)

429  
ªt
;

432 
›Se˘
 = 
£˘Info
.opSect;

433 
idxTŸÆNum
 = 
	`MODULE_IDX_NUM
(
id
);

435 
ªt
 = 
NV_ITEM_NOT_FOUND
;

436 
ªt
 = 
	`nv_ödex_ªad
(
id
, 
ôemId
, 
Àn
, 
›Se˘
, 
idxTŸÆNum
, &
›Idx
);

437 i‡(
sögÀ
)

439 i‡(
ªt
 =
NV_SUCC
)

441 
ªt
 = 
	`nv_ÊashRódByIndex
(
id
, 
ôemId
, 
›Se˘
, 
›Idx
, 
Àn
, 
buf
);

446 
ôemI‚o_t
 *
pInfo
 = (ôemI‚o_à*)
buf
;

447 
pInfo
->
›Index
 = 
›Idx
;

448 
pInfo
->
›Se˘
 = opSect;

451  
ªt
;

452 
	}
}

454 
nv_°s_t
 
	$nv_nwkFømeCou¡Sórch
(
u8
 
id
, u8 
›Se˘
, 
u32
 *
‰ameCou¡
, u32 *
vÆidAddr
)

456 
nv_°s_t
 
ªt
 = 
NV_ITEM_NOT_FOUND
;

457 
u16
 
‰mC¡TŸÆNum
 = 
	`FRAMECOUNT_NUM_PER_SECT
();

458 
u32
 
sizeU£d
 = 
‰mC¡TŸÆNum
 * 4;

459 
u32
 
∑geU£d
 = (
sizeU£d
 & 0xffË? sizeU£d / 
FLASH_PAGE_SIZE
 + 1 : sizeUsed / FLASH_PAGE_SIZE;

460 
u16
 
checkSize
 = 0;

461 *
vÆidAddr
 = 
	`FRAMECOUNT_PAYLOAD_START
(
›Se˘
);

463 
u32
 *
›PageAddr
 = (u32 *)(
	`MODULE_SECT_END
(
id
, 
›Se˘
Ë- 
FLASH_PAGE_SIZE
);

464 
s32
 
i
 = 0;

465 
u32
 
checkVÆid
[4];

467 
i
 = 0; i < 
∑geU£d
 - 1; i++)

469 
	`Êash_ªad
((
u32
)
›PageAddr
, 4, (
u8
 *)
checkVÆid
);

470 i‡(
checkVÆid
[0] != 0xffffffff)

472 
checkSize
 = 
FLASH_PAGE_SIZE
;

477 *
vÆidAddr
 = (
u32
)
›PageAddr
;

479 
›PageAddr
 -
FLASH_PAGE_SIZE
 / 4;

481 i‡(
i
 =
∑geU£d
 - 1)

483 
›PageAddr
 = (
u32
 *)(
	`FRAMECOUNT_PAYLOAD_START
(
›Se˘
));

484 
checkSize
 = (
FLASH_PAGE_SIZE
 - (
nv_£˘_öfo_t
)) & (~0x03);

487 
›PageAddr
 = (
u32
 *)(((u32)›PageAdd∏+ 
FLASH_PAGE_SIZE
) & (~(FLASH_PAGE_SIZE - 1)));

488 
u8
 
unôSize
 = 16;

489 
checkSize
)

491 
u8
 
ªadSize
 = (
checkSize
 > 
unôSize
) ? unitSize : checkSize;

492 
›PageAddr
 -
ªadSize
 / 4;

493 
checkSize
 -
ªadSize
;

495 
	`Êash_ªad
((
u32
)
›PageAddr
, 
ªadSize
, (
u8
 *)
checkVÆid
);

496 i‡(
checkVÆid
[0] != 0xffffffff)

498 *
‰ameCou¡
 = 
checkVÆid
[0];

499 
s32
 
i
 = 1; i < 
ªadSize
 / 4; i++)

501 i‡(
checkVÆid
[
i
] != 0xffffffff)

503 *
‰ameCou¡
 = 
checkVÆid
[
i
];

504 i‡(
i
 =(
ªadSize
 / 4 - 1))

506 *
vÆidAddr
 = (
u32
)(
›PageAddr
 + 
i
 + 1);

507  
NV_SUCC
;

512 *
vÆidAddr
 = (
u32
)(
›PageAddr
 + 
i
);

513  
NV_SUCC
;

519 *
vÆidAddr
 = (
u32
)
›PageAddr
;

523  
ªt
;

524 
	}
}

526 
nv_°s_t
 
	$nv_nwkFømeCou¡SaveToFœsh
(
u32
 
‰ameCou¡
)

528 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

529 
nv_£˘_öfo_t
 
£˘Info
;

530 
u8
 
›Se˘
 = 0;

531 
u8
 
id
 = 
NV_MODULE_NWK_FRAME_COUNT
;

532 
u32
 
moduÀSèπAddr
 = 
	`MODULES_START_ADDR
(
id
);

535 
ªt
 = 
	`nv_£˘‹_ªad
(
id
, 
MODULE_SECTOR_NUM
, &
£˘Info
);

536 i‡(
ªt
 !
NV_SUCC
)

538 
s32
 
j
 = 0; j < 
MODULE_SECTOR_NUM
; j++)

540 
	`Êash_îa£
(
moduÀSèπAddr
 + 
j
 * 
FLASH_SECTOR_SIZE
);

542 
›Se˘
 = 0;

546 
›Se˘
 = 
£˘Info
.opSect;

549 
u32
 
œ°FrmC¡
;

550 
u32
 
wAddr
;

551 
u8
 
ﬁdSe˘
 = 
›Se˘
;

552 
u8
 
£˘‹Upd©e
 = 0;

553 i‡(
NV_SUCC
 =
	`nv_nwkFømeCou¡Sórch
(
id
, 
›Se˘
, &
œ°FrmC¡
, &
wAddr
))

555 i‡(
wAddr
 =(
	`MODULE_SECT_END
(
id
, 
›Se˘
)))

557 
›Se˘
 = (›Se˘ + 1Ë& (
MODULE_SECTOR_NUM
 - 1);

558 
	`Êash_îa£
(
moduÀSèπAddr
 + 
›Se˘
 * 
FLASH_SECTOR_SIZE
);

559 
	`Êash_wrôe
(
	`FRAMECOUNT_PAYLOAD_START
(
›Se˘
), 4, (
u8
 *)&
œ°FrmC¡
);

560 
wAddr
 = 
	`FRAMECOUNT_PAYLOAD_START
(
›Se˘
) + 4;

561 
£˘‹Upd©e
 = 1;

565 
	`Êash_wrôe
(
wAddr
, 4, (
u8
 *)&
‰ameCou¡
);

567 i‡(
£˘‹Upd©e
 || (
wAddr
 =
	`FRAMECOUNT_PAYLOAD_START
(
›Se˘
)))

569 
£˘Info
.
u£dFœg
 = 
NV_SECTOR_VALID
;

570 
£˘Info
.
›Se˘
 = opSect;

571 
£˘Info
.
idName
 = 
id
;

572 
	`Êash_wrôe
((
u32
)
	`MODULE_SECT_START
(
id
, 
›Se˘
), (
nv_£˘_öfo_t
), (
u8
 *)&
£˘Info
);

574 i‡(
£˘‹Upd©e
)

576 
£˘Info
.
u£dFœg
 = 
NV_SECTOR_INVALID
;

577 
	`Êash_wrôe
((
u32
)
	`MODULE_SECT_START
(
id
, 
ﬁdSe˘
), (
nv_£˘_öfo_t
), (
u8
 *)&
£˘Info
);

581  
ªt
;

582 
	}
}

584 
nv_°s_t
 
	$nv_nwkFømeCou¡FromFœsh
(
u32
 *
‰ameCou¡
)

586 
nv_°s_t
 
ªt
 = 
NV_SUCC
;

587 
u8
 
id
 = 
NV_MODULE_NWK_FRAME_COUNT
;

588 
nv_£˘_öfo_t
 
£˘Info
;

589 
u32
 
œ°FrmC¡
;

590 
u32
 
wAddr
;

591 
u8
 
›Se˘
 = 0;

594 
ªt
 = 
	`nv_£˘‹_ªad
(
id
, 
MODULE_SECTOR_NUM
, &
£˘Info
);

595 i‡(
ªt
 !
NV_SUCC
)

597  
ªt
;

599 
›Se˘
 = 
£˘Info
.opSect;

601 
ªt
 = 
	`nv_nwkFømeCou¡Sórch
(
id
, 
›Se˘
, &
œ°FrmC¡
, &
wAddr
);

602 i‡(
ªt
 =
NV_SUCC
)

604 *
‰ameCou¡
 = 
œ°FrmC¡
;

607  
ªt
;

608 
	}
}

610 
nv_°s_t
 
	$nv_ª£tModuÀ
(
u8
 
moduÀs
)

612 
u32
 
îa£Addr
 = 
	`MODULES_START_ADDR
(
moduÀs
);

613 
u8
 
£˘Numbî
 = 
	`NV_SECTOR_SIZE
(
moduÀs
Ë/ 
FLASH_SECTOR_SIZE
;

614 
s32
 
i
 = 0; i < 
MODULE_SECTOR_NUM
; i++)

616 
s32
 
j
 = 0; j < 
£˘Numbî
; j++)

618 
	`Êash_îa£
(
îa£Addr
);

619 
îa£Addr
 +
FLASH_SECTOR_SIZE
;

622  
SUCCESS
;

623 
	}
}

625 
nv_°s_t
 
	$nv_ª£tAŒ
()

627 #i‡
NV_ENABLE


628 
	`f‹óch
 (
i
, 
NV_MAX_MODULS
)

630 
	`nv_ª£tModuÀ
(
i
);

633  
SUCCESS
;

634 
	}
}

636 
nv_°s_t
 
	$nv_öô
(
u8
 
r°
)

638 i‡(
r°
)

641 
	`nv_ª£tAŒ
();

643  
NV_SUCC
;

644 
	}
}

646 
nv_°s_t
 
	$nv_ª£tToFa˘‹yNew
()

648 #i‡
NV_ENABLE


649 i‡(!
	`nv_Á¸ŸyNewR°FœgCheck
())

651 
	`nv_Á¸ŸyNewR°FœgSë
();

654 
	`f‹óch
 (
i
, 
NV_MAX_MODULS
)

656 i‡(
i
 !
NV_MODULE_NWK_FRAME_COUNT
)

658 
	`nv_ª£tModuÀ
(
i
);

662 
	`nv_Á¸ŸyNewR°FœgCÀ¨
();

664  
SUCCESS
;

665 
	}
}

667 
boﬁ
 
	$nv_Á¸ŸyNewR°FœgCheck
()

669 
u8
 
Êag
 = 
ITEM_FIELD_IDLE
;

670 
	`Êash_ªad
(
CFG_FACTORY_RST_CNT
, 1, &
Êag
);

672  ((
Êag
 =0xffË? 
FALSE
 : 
TRUE
);

673 
	}
}

675 
	$nv_Á¸ŸyNewR°FœgSë
()

677 
u8
 
Êag
 = 
ITEM_FIELD_VALID
;

678 
	`Êash_wrôe
(
CFG_FACTORY_RST_CNT
, 1, &
Êag
);

679 
	}
}

681 
	$nv_Á¸ŸyNewR°FœgCÀ¨
()

683 
	`Êash_îa£
(
CFG_FACTORY_RST_CNT
);

684 
	}
}

	@proj/drivers/drv_nv.h

24 #¥agm®
⁄˚


89 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

90 
	#FLASH_TLNK_FLAG_OFFSET
 8

	)

91 #ñi‡
deföed
(
MCU_CORE_B91
)

92 
	#FLASH_TLNK_FLAG_OFFSET
 32

	)

102 
	#FLASH_ADDR_OF_MAC_ADDR_512K
 0x76000

	)

103 
	#FLASH_ADDR_OF_F_CFG_INFO_512K
 0x77000

	)

105 
	#FLASH_ADDR_0F_MAC_ADDR_1M
 0xFF000

	)

106 
	#FLASH_ADDR_OF_F_CFG_INFO_1M
 0xFE000

	)

109 
u32
 
g_u32MacFœshAddr
;

110 
u32
 
g_u32CfgFœshAddr
;

112 
	#MAC_BASE_ADD
 (
g_u32MacFœshAddr
)

	)

113 
	#FACTORY_CFG_BASE_ADD
 (
g_u32CfgFœshAddr
)

	)

120 
	#CFG_MAC_ADDRESS
 (
MAC_BASE_ADD
)

	)

123 
	#CFG_TELINK_USB_ID
 (
MAC_BASE_ADD
 + 0x40)

	)

126 
	#CFG_FREQUENCY_OFFSET
 (
FACTORY_CFG_BASE_ADD
)

	)

131 
	#CFG_TP_GAIN
 (
FACTORY_CFG_BASE_ADD
 + 0x42)

	)

134 
	#CFG_32K_COUNTER_CALIBRATION
 (
FACTORY_CFG_BASE_ADD
 + 0x80)

	)

137 
	#CFG_ADC_CALIBRATION
 (
FACTORY_CFG_BASE_ADD
 + 0xC0)

	)

140 
	#CFG_24M_CRYSTAL_CALIBRATION
 (
FACTORY_CFG_BASE_ADD
 + 0x100)

	)

143 
	#CFG_T_SENSOR_CALIBRATION
 (
FACTORY_CFG_BASE_ADD
 + 0x140)

	)

146 
	#CFG_FIRMWARE_ENCRYPTION
 (
FACTORY_CFG_BASE_ADD
 + 0x180)

	)

152 
	#CFG_VDD_F_CALIBRATION
 (
FACTORY_CFG_BASE_ADD
 + 0x1C0)

	)

159 #i‡
FLASH_CAP_SIZE_1M


160 
	#CFG_PRE_INSTALL_CODE
 (0xFD000)

	)

162 
	#CFG_PRE_INSTALL_CODE
 (0x78000)

	)

170 #i‡
FLASH_CAP_SIZE_1M


171 
	#CFG_FACTORY_RST_CNT
 (0xFC000)

	)

173 
	#CFG_FACTORY_RST_CNT
 (0x79000)

	)

179 #i‡!
deföed
(
BOOT_LOADER_MODE
) || (BOOT_LOADER_MODE == 0)

180 #i‡
FLASH_CAP_SIZE_1M


181 
	#NV_BASE_ADDRESS
 (0x80000)

	)

183 
	#NV_BASE_ADDRESS
 (0x34000)

	)

184 
	#NV_BASE_ADDRESS2
 (0x7A000)

	)

187 #i‡
FLASH_CAP_SIZE_1M


188 
	#NV_BASE_ADDRESS
 (0xE6000)

	)

190 
	#NV_BASE_ADDRESS
 (0x6A000)

	)

191 
	#NV_BASE_ADDRESS2
 (0x7A000)

	)

199 
	#FLASH_ADDR_OF_APP_FW
 
APP_IMAGE_ADDR


	)

205 #i‡!
deföed
(
BOOT_LOADER_MODE
) || (BOOT_LOADER_MODE == 0)

206 #i‡
FLASH_CAP_SIZE_1M


208 
	#FLASH_OTA_IMAGE_MAX_SIZE
 ((
NV_BASE_ADDRESS
 - 
FLASH_ADDR_OF_APP_FW
Ë/ 2)

	)

211 
	#FLASH_OTA_IMAGE_MAX_SIZE
 (
NV_BASE_ADDRESS
 - 
FLASH_ADDR_OF_APP_FW
)

	)

214 
	#FLASH_ADDR_OF_OTA_IMAGE
 (0x40000)

	)

218 
	#FLASH_OTA_IMAGE_MAX_SIZE
 ((
NV_BASE_ADDRESS
 - 
FLASH_ADDR_OF_APP_FW
Ë/ 2)

	)

221 
	#FLASH_ADDR_OF_OTA_IMAGE
 (
FLASH_ADDR_OF_APP_FW
 + 
FLASH_OTA_IMAGE_MAX_SIZE
)

	)

226 #i‡
DUAL_MODE


229 
	mTYPE_TLK_MESH
 = 0x000000A3,

230 
	mTYPE_SIG_MESH
 = 0x0000003A,

231 
	mTYPE_TLK_BLE_SDK
 = 0x000000C3,

232 
	mTYPE_TLK_ZIGBEE
 = 0x0000003C,

233 
	mTYPE_DUAL_MODE_STANDBY
 = 0x00000065,

234 
	mTYPE_DUAL_MODE_RECOVER
 = 0x00000056,

235 }
	tãlök_sdk_ty≥_t
;

237 
	#CFG_TELINK_SDK_TYPE
 (0x73000)

	)

238 
	#CFG_TELINK_SIG_MESH_CRC
 (0x73040)

	)

239 
	#CFG_TELINK_SIG_MESH_CODE_4K
 (0x75000)

	)

240 
	#CFG_TELINK_DUAL_MODE_ENABLE
 (0x76080)

	)

251 
u16
 
	mu£dFœg
;

252 
u8
 
	midName
;

253 
u8
 
	m›Se˘
;

254 }
	tnv_£˘_öfo_t
;

257 
u32
 
	moff£t
;

258 
u16
 
	msize
;

259 
u8
 
	môemId
;

260 
u8
 
	mu£dSèã
;

261 }
	tnv_öfo_idx_t
;

265 
u32
 
	mcheckSum
;

266 
u16
 
	msize
;

267 
u8
 
	môemId
;

268 
u8
 
	mu£d
;

269 }
	tôemHdr_t
;

272 
u16
 
	m›Index
;

273 
u8
 
	m›Se˘
;

274 }
	tôemI‚o_t
;

293 
	mNV_MODULE_ZB_INFO
 = 0,

294 
	mNV_MODULE_ADDRESS_TABLE
 = 1,

295 
	mNV_MODULE_APS
 = 2,

296 
	mNV_MODULE_ZCL
 = 3,

297 
	mNV_MODULE_NWK_FRAME_COUNT
 = 4,

298 
	mNV_MODULE_OTA
 = 5,

299 
	mNV_MODULE_APP
 = 6,

300 
	mNV_MODULE_KEYPAIR
 = 7,

301 
	mNV_MAX_MODULS


302 }
	tnv_moduÀ_t
;

305 
	mNV_ITEM_ID_INVALID
 = 0,

307 
	mNV_ITEM_ZB_INFO
 = 1,

308 
	mNV_ITEM_ADDRESS_FOR_NEIGHBOR
,

309 
	mNV_ITEM_ADDRESS_FOR_BIND
,

310 
	mNV_ITEM_APS_SSIB
,

311 
	mNV_ITEM_APS_GROUP_TABLE
,

312 
	mNV_ITEM_APS_BINDING_TABLE
,

314 
	mNV_ITEM_NWK_FRAME_COUNT
,

316 
	mNV_ITEM_SS_KEY_PAIR
,

318 
	mNV_ITEM_OTA_HDR_SERVERINFO
,

319 
	mNV_ITEM_OTA_CODE
,

321 
	mNV_ITEM_ZCL_REPORT
 = 0x20,

322 
	mNV_ITEM_ZCL_ON_OFF
,

323 
	mNV_ITEM_ZCL_LEVEL
,

324 
	mNV_ITEM_ZCL_COLOR_CTRL
,

325 
	mNV_ITEM_ZCL_SCENE_TABLE
,

326 
	mNV_ITEM_ZCL_GP_PROXY_TABLE
,

327 
	mNV_ITEM_ZCL_GP_SINK_TABLE
,

328 
	mNV_ITEM_ZCL_WWAH_APS_AUTH_INFO
,

329 
	mNV_ITEM_ZCL_WWAH_APS_ACKS_INFO
,

330 
	mNV_ITEM_ZCL_WWAH_USE_TC_CLUSTER_INFO
,

332 
	mNV_ITEM_APP_SIMPLE_DESC
,

333 
	mNV_ITEM_APP_POWER_CNT
,

335 
	mNV_ITEM_ID_MAX
 = 0xFF,

336 }
	tnv_ôem_t
;

339 
	mNV_SUCC
,

340 
	mNV_INVALID_MODULS
 = 1,

341 
	mNV_INVALID_ID
 ,

342 
	mNV_ITEM_NOT_FOUND
,

343 
	mNV_NOT_ENOUGH_SAPCE
,

344 
	mNV_ITEM_LEN_NOT_MATCH
,

345 
	mNV_CHECK_SUM_ERROR
,

346 
	mNV_ENABLE_PROTECT_ERROR
,

347 
	mNV_NO_MEDIA


348 } 
	tnv_°s_t
;

351 
	#FLASH_PAGE_SIZE
 256

	)

352 
	#FLASH_SECTOR_SIZE
 4096

353 

	)

354 
	#NV_SECTOR_VALID
 0x5A5A

	)

355 
	#NV_SECTOR_INVALID
 0x5050

	)

356 
	#NV_SECTOR_IDLE
 0xFFFF

	)

358 
	#ITEM_FIELD_VALID
 0x5A

	)

359 
	#ITEM_FIELD_INVALID
 0x50

	)

360 
	#ITEM_FIELD_OPERATION
 0xFA

	)

361 
	#ITEM_FIELD_IDLE
 0xFF

	)

364 #i‡
FLASH_CAP_SIZE_1M


365 
	#MODULES_START_ADDR
(
id
Ë(
NV_BASE_ADDRESS
 + 
FLASH_SECTOR_SIZE
 * (2 * id))

	)

366 
	#NV_SECTOR_SIZE
(
id
Ë((id =
NV_MODULE_KEYPAIR
Ë? (4 * 
FLASH_SECTOR_SIZE
Ë: FLASH_SECTOR_SIZE)

	)

367 
	#MODULE_INFO_SIZE
(
id
Ë((id =
NV_MODULE_OTA
 || id =
NV_MODULE_KEYPAIR
 || id =
NV_MODULE_ADDRESS_TABLE
Ë? ((id =NV_MODULE_KEYPAIRË? (12*
FLASH_PAGE_SIZE
Ë: (4*FLASH_PAGE_SIZE)Ë: (2*FLASH_PAGE_SIZE))

	)

369 
	#MODULES_START_ADDR
(
id
Ë((id < 6Ë? (
NV_BASE_ADDRESS
 + 
FLASH_SECTOR_SIZE
 * (2 * id)Ë: (
NV_BASE_ADDRESS2
 + FLASH_SECTOR_SIZE * (2 * (id-6))))

	)

370 
	#NV_SECTOR_SIZE
(
id
Ë((id =
NV_MODULE_KEYPAIR
Ë? (2 * 
FLASH_SECTOR_SIZE
Ë: FLASH_SECTOR_SIZE)

	)

371 
	#MODULE_INFO_SIZE
(
id
Ë((id =
NV_MODULE_OTA
 || id =
NV_MODULE_KEYPAIR
 || id =
NV_MODULE_ADDRESS_TABLE
Ë? (4*
FLASH_PAGE_SIZE
Ë: (2*FLASH_PAGE_SIZE))

	)

374 
	#MODULE_SECTOR_NUM
 (2)

	)

376 
	#MODULE_IDX_SIZE
(
id
Ë(
	`MODULE_INFO_SIZE
(idË- (
nv_£˘_öfo_t
))

	)

377 
	#MODULE_SECT_START
(
id
, 
£˘No
Ë(
	`MODULES_START_ADDR
(idË+ se˘Nÿ* (
	`NV_SECTOR_SIZE
(id)))

	)

378 
	#MODULE_SECT_END
(
id
, 
£˘No
Ë(
	`MODULES_START_ADDR
(idË+ (£˘Nÿ+ 1Ë* (
	`NV_SECTOR_SIZE
(id)))

	)

379 
	#MODULE_IDX_START
(
id
, 
£˘No
Ë(
	`MODULE_SECT_START
(id, se˘NoË+ (
nv_£˘_öfo_t
))

	)

380 
	#MODULE_IDX_NUM
(
id
Ë(
	`MODULE_IDX_SIZE
(idË/ ((
nv_öfo_idx_t
)))

	)

381 
	#MODULE_CONTEXT_START
(
id
, 
£˘No
, 
Àn
Ë(
	`MODULE_SECT_START
(id, se˘NoË+ 
	`MODULE_INFO_SIZE
(id))

	)

382 
	#ITEM_TOTAL_LEN
(
Àn
Ë÷í + (
ôemHdr_t
))

	)

383 
	#FRAMECOUNT_PAYLOAD_START
(
›Se˘
Ë(((
	`MODULE_SECT_START
(
NV_MODULE_NWK_FRAME_COUNT
, opSe˘Ë+ (
nv_£˘_öfo_t
)Ë+ 0x03Ë& (~0x03))

	)

384 
	#FRAMECOUNT_NUM_PER_SECT
(Ë((((
FLASH_SECTOR_SIZE
 - (
nv_£˘_öfo_t
)Ë& (~0x03))Ë/ 4)

	)

389 
nv_°s_t
 
nv_ª£tAŒ
();

390 
nv_°s_t
 
nv_ª£tModuÀ
(
u8
 
moduÀs
);

391 
nv_°s_t
 
nv_ÊashWrôeNew
(
u8
 
sögÀ
, 
u16
 
id
, u8 
ôemId
, u16 
Àn
, u8 *
buf
);

392 
nv_°s_t
 
nv_ÊashRódNew
(
u8
 
sögÀ
, u8 
id
, u8 
ôemId
, 
u16
 
Àn
, u8 *
buf
);

393 
nv_°s_t
 
nv_ôemDñëeByIndex
(
u8
 
id
, u8 
ôemId
, u8 
›Se˘
, 
u16
 
›Idx
);

394 
nv_°s_t
 
nv_ÊashRódByIndex
(
u8
 
id
, u8 
ôemId
, u8 
›Se˘
, 
u16
 
›Idx
, u16 
Àn
, u8 *
buf
);

395 
nv_°s_t
 
nv_ª£tToFa˘‹yNew
();

396 
boﬁ
 
nv_Á¸ŸyNewR°FœgCheck
();

397 
nv_Á¸ŸyNewR°FœgSë
();

398 
nv_Á¸ŸyNewR°FœgCÀ¨
();

399 
nv_°s_t
 
nv_nwkFømeCou¡SaveToFœsh
(
u32
 
‰ameCou¡
);

400 
nv_°s_t
 
nv_nwkFømeCou¡FromFœsh
(
u32
 *
‰ameCou¡
);

	@proj/drivers/drv_pm.c

24 
	~"../é_comm⁄.h
"

26 #i‡
deföed
(
__PROJECT_TL_BOOT_LOADER__
Ë|| deföed(
__PROJECT_TL_SNIFFER__
)

27 
	#RF_RECOVERY
()

	)

29 
	~"zb_comm⁄.h
"

34 
	#RF_RECOVERY
(Ëdo{ \

	)

35 
u8
 
	gvÆue
; \

36 
u8
 
	gÀn
; \

37 
ZB_RADIO_INIT
(); \

38 
é_zbMacAârGë
(
MAC_PHY_ATTR_CURRENT_CHANNEL
, &
vÆue
, &
Àn
); \

39 
ZB_TRANSCEIVER_SET_CHANNEL
(
vÆue
); \

43 
	#PM_FC_SET_FLAG
 0x5A

	)

44 
	#PM_FC_CLR_FLAG
 0x00

	)

46 #i‡
	`deföed
(
MCU_CORE_826x
)

47 
	#PM_ANA_REG_FRAME_COUNTER_FLAG
 
DEEP_ANA_REG0


	)

48 
	#PM_ANA_REG_FRAME_COUNTER
 
DEEP_ANA_REG4


	)

49 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

50 
	#PM_ANA_REG_FRAME_COUNTER_FLAG
 
DEEP_ANA_REG0


	)

51 
	#PM_ANA_REG_FRAME_COUNTER
 
DEEP_ANA_REG6


	)

52 #ñi‡
	`deföed
(
MCU_CORE_B91
)

53 
	#PM_ANA_REG_FRAME_COUNTER_FLAG
 
PM_ANA_REG_POWER_ON_CLR_BUF1


	)

54 
	#PM_ANA_REG_FRAME_COUNTER
 
PM_ANA_REG_POWER_ON_CLR_BUF2


	)

57 
u32
 
¥evSÀïTick
 = 0;

60 
u32
 
	$drv_pm_¶ìpTime_gë
()

62 
u32
 
¶ìpTime
 = 0;

63 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

64 
¶ìpTime
 = (
	`pm_gë_32k_tick
(Ë- 
¥evSÀïTick
) / 32;

65 #ñi‡
	`deföed
(
MCU_CORE_B91
)

66 
¶ìpTime
 = (
	`˛ock_gë_32k_tick
(Ë- 
¥evSÀïTick
) / 32;

68  
¶ìpTime
;

69 
	}
}

71 
	$drv_pm_dìpSÀï_‰ameC¡_£t
(
u32
 
‰ameCou¡î
)

73 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

74 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER_FLAG
, 
PM_FC_SET_FLAG
);

76 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER
, 
‰ameCou¡î
);

77 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER
 + 1, 
‰ameCou¡î
 >> 8);

78 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER
 + 2, 
‰ameCou¡î
 >> 16);

79 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER
 + 3, 
‰ameCou¡î
 >> 24);

80 #ñi‡
	`deföed
(
MCU_CORE_B91
)

81 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER_FLAG
, 
PM_FC_SET_FLAG
);

83 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER
, 
‰ameCou¡î
);

84 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER
 + 1, 
‰ameCou¡î
 >> 8);

85 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER
 + 2, 
‰ameCou¡î
 >> 16);

86 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER
 + 3, 
‰ameCou¡î
 >> 24);

88 
	}
}

90 
u32
 
	$drv_pm_dìpSÀï_‰ameC¡_gë
()

92 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

93 
	`™Æog_wrôe
(
PM_ANA_REG_FRAME_COUNTER_FLAG
, 
PM_FC_CLR_FLAG
);

94  ((
	`™Æog_ªad
(
PM_ANA_REG_FRAME_COUNTER
+3) << 24) | (analog_read(PM_ANA_REG_FRAME_COUNTER+2) << 16) | (analog_read(PM_ANA_REG_FRAME_COUNTER+1) << 8) |ánalog_read(PM_ANA_REG_FRAME_COUNTER) );

95 #ñi‡
	`deföed
(
MCU_CORE_B91
)

96 
	`™Æog_wrôe_ªg8
(
PM_ANA_REG_FRAME_COUNTER_FLAG
, 
PM_FC_CLR_FLAG
);

97  ((
	`™Æog_ªad_ªg8
(
PM_ANA_REG_FRAME_COUNTER
+3) << 24) | (analog_read_reg8(PM_ANA_REG_FRAME_COUNTER+2) << 16) | (analog_read_reg8(PM_ANA_REG_FRAME_COUNTER+1) << 8) |ánalog_read_reg8(PM_ANA_REG_FRAME_COUNTER) );

99 
	}
}

101 
boﬁ
 
	$drv_pm_dìpSÀï_Êag_gë
()

103 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

104  ((
	`pm_gë_mcu_°©us
(Ë=
MCU_STATUS_DEEP_BACK
Ë&& (
	`™Æog_ªad
(
PM_ANA_REG_FRAME_COUNTER_FLAG
Ë=
PM_FC_SET_FLAG
));

105 #ñi‡
	`deföed
(
MCU_CORE_B91
)

106  ((
g_pm_°©us_öfo
.
mcu_°©us
 =
MCU_STATUS_DEEP_BACK
Ë&& (
	`™Æog_ªad_ªg8
(
PM_ANA_REG_FRAME_COUNTER_FLAG
Ë=
PM_FC_SET_FLAG
));

108 
	}
}

110 
	$drv_pm_¶ìp
(
drv_pm_¶ìp_mode_e
 
mode
, 
drv_pm_wakeup_§c_e
 
§c
, 
u32
 
duøti⁄Ms
)

112 #i‡
	`deföed
(
MCU_CORE_826x
)

113 
u8
 
¶ìp_mode
 = 
SUSPEND_MODE
;

114 
WakeupSrc_Ty≥Def
 
§cTy≥
 = 0;

116 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

117 
¶ìp_mode
 = 
SUSPEND_MODE
;

118 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

119 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

124 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

125 
§cTy≥
 |
WAKEUP_SRC_PAD
;

127 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

128 
§cTy≥
 |
WAKEUP_SRC_TIMER
;

131 
¥evSÀïTick
 = 
	`pm_gë_32k_tick
();

133 
	`pm_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
	`˛ock_time
(Ë+ 
duøti⁄Ms
*1000*
S_TIMER_CLOCK_1US
);

135 
	`drv_pm_wakeupTimeUpd©e
();

136 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

137 
SÀïMode_Ty≥Def
 
¶ìp_mode
 = 
SUSPEND_MODE
;

138 
SÀïWakeupSrc_Ty≥Def
 
§cTy≥
 = 0;

140 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

141 
¶ìp_mode
 = 
SUSPEND_MODE
;

142 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

143 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

144 }if(
mode
 =
PM_SLEEP_MODE_DEEP_WITH_RETENTION
){

145 
¶ìp_mode
 = 
DEEPSLEEP_MODE_RET_SRAM_LOW32K
;

150 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

151 
§cTy≥
 |
PM_WAKEUP_PAD
;

153 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

154 
§cTy≥
 |
PM_WAKEUP_TIMER
;

157 
¥evSÀïTick
 = 
	`pm_gë_32k_tick
();

159 
	`˝u_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
	`˛ock_time
(Ë+ 
duøti⁄Ms
*1000*
S_TIMER_CLOCK_1US
);

161 
	`drv_pm_wakeupTimeUpd©e
();

163 
	`RF_RECOVERY
();

164 #ñi‡
	`deföed
(
MCU_CORE_B91
)

165 
pm_¶ìp_mode_e
 
¶ìp_mode
 = 
SUSPEND_MODE
;

166 
pm_¶ìp_wakeup_§c_e
 
§cTy≥
 = 0;

168 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

169 
¶ìp_mode
 = 
SUSPEND_MODE
;

170 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

171 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

172 }if(
mode
 =
PM_SLEEP_MODE_DEEP_WITH_RETENTION
){

173 
¶ìp_mode
 = 
DEEPSLEEP_MODE_RET_SRAM_LOW64K
;

178 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

179 
§cTy≥
 |
PM_WAKEUP_PAD
;

181 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

182 
§cTy≥
 |
PM_WAKEUP_TIMER
;

185 
¥evSÀïTick
 = 
	`˛ock_gë_32k_tick
();

187 
	`pm_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
PM_TICK_STIMER_16M
, 
	`˛ock_time
(Ë+ 
duøti⁄Ms
*1000*
S_TIMER_CLOCK_1US
);

189 
	`drv_pm_wakeupTimeUpd©e
();

191 
	`RF_RECOVERY
();

193 
	}
}

195 
	$drv_pm_l⁄gSÀï
(
drv_pm_¶ìp_mode_e
 
mode
, 
drv_pm_wakeup_§c_e
 
§c
, 
u32
 
duøti⁄Ms
)

197 #i‡
	`deföed
(
MCU_CORE_826x
)

198 
u8
 
¶ìp_mode
 = 
SUSPEND_MODE
;

199 
WakeupSrc_Ty≥Def
 
§cTy≥
 = 0;

201 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

202 
¶ìp_mode
 = 
SUSPEND_MODE
;

203 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

204 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

209 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

210 
§cTy≥
 |
WAKEUP_SRC_PAD
;

212 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

213 
§cTy≥
 |
WAKEUP_SRC_TIMER
;

216 
¥evSÀïTick
 = 
	`pm_gë_32k_tick
();

218 
	`pm_l⁄g_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
duøti⁄Ms
 * 32);

220 
	`drv_pm_wakeupTimeUpd©e
();

221 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

222 
SÀïMode_Ty≥Def
 
¶ìp_mode
 = 
SUSPEND_MODE
;

223 
SÀïWakeupSrc_Ty≥Def
 
§cTy≥
 = 0;

225 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

226 
¶ìp_mode
 = 
SUSPEND_MODE
;

227 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

228 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

229 }if(
mode
 =
PM_SLEEP_MODE_DEEP_WITH_RETENTION
){

230 
¶ìp_mode
 = 
DEEPSLEEP_MODE_RET_SRAM_LOW32K
;

235 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

236 
§cTy≥
 |
PM_WAKEUP_PAD
;

238 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

239 
§cTy≥
 |
PM_WAKEUP_TIMER
;

242 
¥evSÀïTick
 = 
	`pm_gë_32k_tick
();

244 
	`pm_l⁄g_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
duøti⁄Ms
 * 32);

246 
	`drv_pm_wakeupTimeUpd©e
();

248 
	`RF_RECOVERY
();

249 #ñi‡
	`deföed
(
MCU_CORE_B91
)

250 
pm_¶ìp_mode_e
 
¶ìp_mode
 = 
SUSPEND_MODE
;

251 
pm_¶ìp_wakeup_§c_e
 
§cTy≥
 = 0;

253 if(
mode
 =
PM_SLEEP_MODE_SUSPEND
){

254 
¶ìp_mode
 = 
SUSPEND_MODE
;

255 }if(
mode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

256 
¶ìp_mode
 = 
DEEPSLEEP_MODE
;

257 }if(
mode
 =
PM_SLEEP_MODE_DEEP_WITH_RETENTION
){

258 
¶ìp_mode
 = 
DEEPSLEEP_MODE_RET_SRAM_LOW64K
;

263 if(
§c
 & 
PM_WAKEUP_SRC_PAD
){

264 
§cTy≥
 |
PM_WAKEUP_PAD
;

266 if(
§c
 & 
PM_WAKEUP_SRC_TIMER
){

267 
§cTy≥
 |
PM_WAKEUP_TIMER
;

270 
¥evSÀïTick
 = 
	`˛ock_gë_32k_tick
();

272 
	`pm_¶ìp_wakeup
(
¶ìp_mode
, 
§cTy≥
, 
PM_TICK_32K
, 
duøti⁄Ms
 * 32);

274 
	`drv_pm_wakeupTimeUpd©e
();

276 
	`RF_RECOVERY
();

278 
	}
}

281 
	$pm_wakeup_∑d_cfg
(
u32
 
pö
, 
drv_pm_wakeup_Àvñ_e
 
pﬁ
, 
í
)

283 #i‡
	`deföed
(
MCU_CORE_826x
)

284 
	`PM_PadSë
(
pö
, 
pﬁ
, 
í
);

285 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

286 
	`˝u_£t_gpio_wakeup
(
pö
, 
pﬁ
, 
í
);

287 #ñi‡
	`deföed
(
MCU_CORE_B91
)

288 
	`pm_£t_gpio_wakeup
(
pö
, 
pﬁ
, 
í
);

290 
	}
}

292 
u8
 
	$drv_pm_wakeupPöVÆid
(
drv_pm_pöCfg_t
 *
pöCfg
, 
u32
 
pöNum
)

294 
drv_pm_pöCfg_t
 *
p
 = 
pöCfg
;

296 
u32
 
i
 = 0; i < 
pöNum
; i++){

297 if((
p
->
wakeupLevñ
 =
PM_WAKEUP_LEVEL_HIGH
Ë&& 
	`drv_gpio_ªad
’->
wakeupPö
)){

298  
SUCCESS
;

301 if((
p
->
wakeupLevñ
 =
PM_WAKEUP_LEVEL_LOW
Ë&& !
	`drv_gpio_ªad
’->
wakeupPö
)){

302  
SUCCESS
;

304 
p
++;

306  
FAILURE
;

307 
	}
}

309 
	$drv_pm_wakeupPöC⁄fig
(
drv_pm_pöCfg_t
 *
pöCfg
, 
u32
 
pöNum
)

311 
drv_pm_pöCfg_t
 *
p
 = 
pöCfg
;

313 
u32
 
i
 = 0; i < 
pöNum
; i++){

314 
	`pm_wakeup_∑d_cfg
(
p
->
wakeupPö
,Ö->
wakeupLevñ
, 1);

315 
p
++;

317 
	}
}

319 
	$drv_pm_lowPowîE¡î
()

321 
drv_pm_wakeup_§c_e
 
wakeupSrc
 = 
PM_WAKEUP_SRC_PAD
;

322 
u32
 
¶ìpTime
 = 0;

323 
boﬁ
 
l⁄gSÀï
 = 0;

325 #i‡!
	`deföed
(
__PROJECT_TL_BOOT_LOADER__
Ë&& !deföed(
__PROJECT_TL_SNIFFER__
)

326 if(
	`é_°ackBusy
(Ë|| !
	`zb_isTaskD⁄e
()){

331 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

333 
ev_timî_evít_t
 *
timîEvt
 = 
	`ev_timî_√¨e°Gë
();

334 if(
timîEvt
){

335 
wakeupSrc
 |
PM_WAKEUP_SRC_TIMER
;

336 
¶ìpTime
 = 
timîEvt
->
timeout
;

339 #i‡
	`deföed
(
MCU_CORE_826x
)

340 
drv_pm_¶ìp_mode_e
 
¶ìpMode
 = (
wakeupSrc
 & 
PM_WAKEUP_SRC_TIMER
Ë? 
PM_SLEEP_MODE_SUSPEND
 : 
PM_SLEEP_MODE_DEEPSLEEP
;

341 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

342 
drv_pm_¶ìp_mode_e
 
¶ìpMode
 = (
wakeupSrc
 & 
PM_WAKEUP_SRC_TIMER
Ë? 
PM_SLEEP_MODE_DEEP_WITH_RETENTION
 : 
PM_SLEEP_MODE_DEEPSLEEP
;

345 if(
¶ìpTime
){

346 if(
¶ìpTime
 > 
PM_NORMAL_SLEEP_MAX
){

347 
l⁄gSÀï
 = 1;

349 
l⁄gSÀï
 = 0;

353 #i‡!
	`deföed
(
__PROJECT_TL_BOOT_LOADER__
Ë&& !deföed(
__PROJECT_TL_SNIFFER__
)

354 
	`rf_∑ShutDown
();

355 if(
¶ìpMode
 =
PM_SLEEP_MODE_DEEPSLEEP
){

356 
	`drv_pm_dìpSÀï_‰ameC¡_£t
(
	`ss_outgoögFømeC¡Gë
());

360 if(!
l⁄gSÀï
){

361 
	`drv_pm_¶ìp
(
¶ìpMode
, 
wakeupSrc
, 
¶ìpTime
);

363 
	`drv_pm_l⁄gSÀï
(
¶ìpMode
, 
wakeupSrc
, 
¶ìpTime
);

366 
	`drv_ª°‹e_úq
(
r
);

367 
	}
}

369 
	$drv_pm_wakeupTimeUpd©e
()

371 
u32
 
¶ìpTime
 = 
	`drv_pm_¶ìpTime_gë
();

372 if(
¶ìpTime
){

373 
	`ev_timî_upd©e
(
¶ìpTime
);

374 
	`ev_timî_£tPªvSysTick
(
	`˛ock_time
());

376 
	}
}

	@proj/drivers/drv_pm.h

24 #¥agm®
⁄˚


30 
	mPM_SLEEP_MODE_SUSPEND
,

31 
	mPM_SLEEP_MODE_DEEPSLEEP
,

32 
	mPM_SLEEP_MODE_DEEP_WITH_RETENTION
,

34 
	mPM_SLEEP_MODE_MCU_STALL
,

35 }
	tdrv_pm_¶ìp_mode_e
;

38 
	mPM_WAKEUP_SRC_PAD
 = 
BIT
(0),

39 
	mPM_WAKEUP_SRC_TIMER
 = 
BIT
(1),

40 }
	tdrv_pm_wakeup_§c_e
;

43 
	mPM_WAKEUP_LEVEL_LOW
,

44 
	mPM_WAKEUP_LEVEL_HIGH
,

45 }
	tdrv_pm_wakeup_Àvñ_e
;

48 
u32
 
	mwakeupPö
;

49 
drv_pm_wakeup_Àvñ_e
 
	mwakeupLevñ
;

50 }
	tdrv_pm_pöCfg_t
;

52 #i‡
deföed
(
MCU_CORE_826x
)

53 
	#PM_CLOCK_INIT
(Ëdo{ 
	`rc_32k_ˇl
(); }0)

	)

55 
	#PM_NORMAL_SLEEP_MAX
 (100 * 1000)

56 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

	)

57 
	#PM_CLOCK_INIT
(Ëdo{ \

	)

59 
˛ock_32k_öô
(
CLK_32K_RC
); \

60 
rc_32k_ˇl
(); \

61 
pm_£À˘_öã∫Æ_32k_rc
(); \

64 
	#PM_NORMAL_SLEEP_MAX
 (230 * 1000)

65 #ñi‡
	`deföed
(
MCU_CORE_B91
)

	)

71 
	#PM_CLOCK_INIT
(Ëdo{ \

	)

72 
	`˛ock_ˇl_24m_rc
(); \

74 
	`˛ock_32k_öô
(
CLK_32K_RC
); \

75 
	`˛ock_ˇl_32k_rc
(); \

76 
	}

	$}whûe
(0)

78 
	#PM_NORMAL_SLEEP_MAX
 (230 * 1000)

80 

	)

82 
	`drv_pm_dìpSÀï_‰ameC¡_£t
(
u32
 
‰ameCou¡î
);

83 
u32
 
	`drv_pm_dìpSÀï_‰ameC¡_gë
();

84 
boﬁ
 
	`drv_pm_dìpSÀï_Êag_gë
();

86 
	`drv_pm_wakeupPöC⁄fig
(
drv_pm_pöCfg_t
 *
pöCfg
, 
u32
 
pöNum
);

87 
u8
 
	`drv_pm_wakeupPöVÆid
(
drv_pm_pöCfg_t
 *
pöCfg
, 
u32
 
pöNum
);

89 
	`drv_pm_¶ìp
(
drv_pm_¶ìp_mode_e
 
mode
, 
drv_pm_wakeup_§c_e
 
§c
, 
u32
 
duøti⁄Ms
);

90 
	`drv_pm_l⁄gSÀï
(
drv_pm_¶ìp_mode_e
 
mode
, 
drv_pm_wakeup_§c_e
 
§c
, 
u32
 
duøti⁄Ms
);

92 
	`drv_pm_lowPowîE¡î
();

93 
	`drv_pm_wakeupTimeUpd©e
();

	@proj/drivers/drv_putchar.c

24 
	~"drv_putch¨.h
"

27 #i‡
UART_PRINTF_MODE


28 
_©åibuã_øm_code_
 
	$so·_u¨t_putc
(
byã
)

30 
u8
 
j
 = 0;

31 
u32
 
t1
 = 0, 
t2
 = 0;

33 
u8
 
tmp_bô0
 = 
TX_PIN_OUTPUT_REG
 & (~(
DEBUG_INFO_TX_PIN
 & 0xff));

34 
u8
 
tmp_bô1
 = 
TX_PIN_OUTPUT_REG
 | (
DEBUG_INFO_TX_PIN
 & 0xff);

36 
u8
 
bô
[10] = {0};

37 
bô
[0] = 
tmp_bô0
;

38 
bô
[1] = (
byã
 & 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

39 
bô
[2] = ((
byã
 >> 1Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

40 
bô
[3] = ((
byã
 >> 2Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

41 
bô
[4] = ((
byã
 >> 3Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

42 
bô
[5] = ((
byã
 >> 4Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

43 
bô
[6] = ((
byã
 >> 5Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

44 
bô
[7] = ((
byã
 >> 6Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

45 
bô
[8] = ((
byã
 >> 7Ë& 0x01Ë? 
tmp_bô1
 : 
tmp_bô0
;

46 
bô
[9] = 
tmp_bô1
;

48 
t1
 = 
	`˛ock_time
();

49 
j
 = 0; j < 10; j++){

50 
t2
 = 
t1
;

52 
t1
 - 
t2
 < 
BIT_INTERVAL
){

53 
t1
 = 
	`˛ock_time
();

56 
TX_PIN_OUTPUT_REG
 = 
bô
[
j
];

59 
	}
}

61 #ñi‡
USB_PRINTF_MODE


63 
	#USB_PRINT_TIMEOUT
 10

64 

	)

65 
	$usb_putc
(
c
)

67 
i
 = 0;

68 
i
 ++ < 
USB_PRINT_TIMEOUT
){

69 if(!(
ªg_usb_ï8_fifo_mode
 & 
FLD_USB_ENP8_FULL_FLAG
)){

70 
ªg_usb_ï8_d©
 = 
c
;

71  
c
;

75 
	}
}

77 
	$hw_usb_putc
(
c
)

79 if(
ªg_usb_ho°_c⁄n
){

80  
	`usb_putc
(
c
);

83 
	}
}

87 
	$drv_putch¨
(
byã
)

89 #i‡
UART_PRINTF_MODE


90 
	`so·_u¨t_putc
(
byã
);

91 #ñi‡
USB_PRINTF_MODE


92 
	`hw_usb_putc
(
byã
);

94 
	}
}

	@proj/drivers/drv_putchar.h

32 #¥agm®
⁄˚


34 
	~"../é_comm⁄.h
"

37 #i‡
deföed
(
MCU_CORE_826x
)

38 #i‚def 
BAUDRATE


39 
	#BAUDRATE
 2000000

41 
	#BIT_INTERVAL
 (
CLOCK_SYS_CLOCK_HZ
 / 
BAUDRATE
)

	)

42 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

43 #i‚def 
BAUDRATE


44 
	#BAUDRATE
 1000000

46 
	#BIT_INTERVAL
 ((16*1000*1000Ë/ 
BAUDRATE
)

	)

49 #i‡
UART_PRINTF_MODE


50 #ifde‡
DEBUG_INFO_TX_PIN


51 
	#TX_PIN_OUTPUT_REG
 
	`ªg_gpio_out
(
DEBUG_INFO_TX_PIN
)

	)

53 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

54 
	#DEBUG_TX_PIN_INIT
(Ëdo{ \

	)

55 
gpio_£t_func
(
DEBUG_INFO_TX_PIN
, 
AS_GPIO
); \

56 
gpio_£t_ouçut_í
(
DEBUG_INFO_TX_PIN
, 1); \

57 
gpio_£tup_up_down_ªsi°‹
(
DEBUG_INFO_TX_PIN
, 
PM_PIN_PULLUP_1M
); \

58 
gpio_wrôe
(
DEBUG_INFO_TX_PIN
, 1); \

60 #ñi‡
	`deföed
(
MCU_CORE_B91
)

61 
	#DEBUG_TX_PIN_INIT
(Ëdo{ \

	)

62 
	`gpio_fun˘i⁄_í
(
DEBUG_INFO_TX_PIN
); \

63 
	`gpio_£t_ouçut
(
DEBUG_INFO_TX_PIN
, 1); \

64 
	`gpio_£t_up_down_ªs
(
DEBUG_INFO_TX_PIN
, 
GPIO_PIN_PULLUP_1M
); \

65 
	`gpio_£t_high_Àvñ
(
DEBUG_INFO_TX_PIN
); \

66 
	}

	$}whûe
(0)

73 
	`drv_putch¨
(
byã
);

	@proj/drivers/drv_pwm.c

24 
	~"../é_comm⁄.h
"

26 
	$drv_pwm_öô
(){

27 #i‡
	`deföed
(
MCU_CORE_826x
)

28 
	`pwm_Inô
(0);

29 #ñi‡
	`deföed
(
MCU_CORE_B91
)

30 
	`pwm_£t_˛k
(0);

32 
	}
}

34 
	$drv_pwm_cfg
(
u8
 
pwmId
, 
u16
 
cmp_tick
, u16 
cy˛e_tick
){

35 #i‡
	`deföed
(
MCU_CORE_826x
)

36 
	`pwm_O≥n
(
pwmId
, 
NORMAL
, 0, 
cmp_tick
, 
cy˛e_tick
, 0x2fff);

37 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

38 
	`pwm_£t_mode
(
pwmId
, 
PWM_NORMAL_MODE
);

39 
	`pwm_£t_pha£
(
pwmId
, 0);

40 
	`pwm_£t_cy˛e_™d_duty
(
pwmId
, 
cy˛e_tick
, 
cmp_tick
);

41 #ñi‡
	`deföed
(
MCU_CORE_B91
)

42 
	`pwm_£t_tcmp
(
pwmId
, 
cmp_tick
);

43 
	`pwm_£t_tmax
(
pwmId
, 
cy˛e_tick
);

45 
	}
}

	@proj/drivers/drv_pwm.h

24 #¥agm®
⁄˚


26 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

27 
	#PWM_CLOCK_SOURCE
 
CLOCK_SYS_CLOCK_HZ


	)

28 #ñi‡
deföed
(
MCU_CORE_B91
)

29 
	#PWM_CLOCK_SOURCE
 (
sys_˛k
.
p˛k
 * 1000 * 1000)

	)

33 #i‡
deföed
(
MCU_CORE_826x
)

34 
	#drv_pwm_°¨t
(
pwmId
Ë
	`pwm_Sèπ
’wmId)

	)

35 
	#drv_pwm_°›
(
pwmId
Ë
	`pwm_St›
’wmId)

	)

36 
	#drv_pwm_övît
(
pwmId
Ë
	`pwm_Invît
’wmId)

	)

37 
	#drv_pwm_n_övît
(
pwmId
Ë
	`pwm_INVInvît
’wmId)

	)

38 #ñi‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

39 
	#drv_pwm_°¨t
(
pwmId
Ë
	`pwm_°¨t
’wmId)

	)

40 
	#drv_pwm_°›
(
pwmId
Ë
	`pwm_°›
’wmId)

	)

41 
	#drv_pwm_övît
(
pwmId
Ë
	`pwm_ªvît
’wmId)

	)

42 
	#drv_pwm_n_övît
(
pwmId
Ë
	`pwm_n_ªvît
’wmId)

	)

43 #ñi‡
deföed
(
MCU_CORE_B91
)

44 
	#drv_pwm_°¨t
(
pwmId
Ë
	`pwm_°¨t
’wmId)

	)

45 
	#drv_pwm_°›
(
pwmId
Ë
	`pwm_°›
’wmId)

	)

46 
	#drv_pwm_övît
(
pwmId
Ë
	`pwm_övît_í
’wmId)

	)

47 
	#drv_pwm_n_övît
(
pwmId
Ë
	`pwm_n_övît_í
’wmId)

	)

50 
drv_pwm_öô
();

52 
drv_pwm_cfg
(
u8
 
pwmId
, 
u16
 
cmp_tick
, u16 
cy˛e_tick
);

	@proj/drivers/drv_radio.h

24 #¥agm®
⁄˚


26 #i‡
deföed
(
MCU_CORE_826x
)

31 
	#ZB_RADIO_RESET
(Ë
	`RF_ª£t
()

	)

34 
	#ZB_RADIO_TRX_SWITCH
(
mode
, 
chn
Ë
	`RF_TrxSèãSë
(mode, chn)

	)

37 
	#ZB_RADIO_TX_POWER_SET
(
Àvñ
Ë
	`RF_PowîLevñSë
÷evñ)

	)

40 
	#ZB_RADIO_MODE_MAX_GAIN
(Ë
	`RF_SëGaöM™uÆMax
()

	)

43 
	#ZB_RADIO_MODE_AUTO_GAIN
(Ë
	`RF_SëAgc
()

	)

46 
	#ZB_RADIO_RSSI_GET
(Ë
	`RF_GëRssi
()

	)

49 
	#ZB_RADIO_TX_START
(
txBuf
Ë
	`RF_TxPkt
—xBuf)

	)

52 
	#ZB_RADIO_TX_DONE
 
	`RF_TxFöish
()

	)

55 
	#ZB_RADIO_TX_DONE_CLR
 
	`RF_TxFöishCÀ¨Fœg
()

	)

58 
	#ZB_RADIO_RX_DONE_CLR
 
	`RF_RxFöishCÀ¨Fœg
()

	)

61 
	#ZB_RADIO_TX_ENABLE
 
RFDMA_TX_ENABLE


	)

64 
	#ZB_RADIO_TX_DISABLE
 
RFDMA_TX_DISABLE


	)

67 
	#ZB_RADIO_RX_ENABLE
 
RFDMA_RX_ENABLE


	)

70 
	#ZB_RADIO_RX_DISABLE
 
RFDMA_RX_DISABLE


	)

73 
	#ZB_RADIO_IRQ_MASK_CLR
 
	`úq_˛r_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

76 
	#ZB_RADIO_IRQ_MASK_SET
 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

79 
	#ZB_RADIO_TRX_STA_GET
(Ë
	`RF_TrxSèãGë
()

	)

82 
	#ZB_RADIO_RX_BUF_SET
(
addr
Ë
	`RF_rx_buf„r_ªc⁄fig
◊ddr)

	)

85 
	#ZB_RADIO_RX_BUF_CLEAR
(
p
Ëdo{ \

	)

86 
	gp
[12] = 0; \

87 *((
	gu32
*)
	gp
) = 0; \

91 
	#ZB_RADIO_TRX_CFG
(
Àn
Ëdo{ \

	)

92 
	`RF_rx_cfg
(
Àn
, 0); \

93 
	`dma_úq_dißbÀ
(
FLD_DMA_CHN_RF_RX
 | 
FLD_DMA_CHN_RF_TX
); \

94 
	`rf_úq_íabÀ
(
FLD_RF_IRQ_RX
 | 
FLD_RF_IRQ_TX
);\

95 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
); \

96 
	}

	$}whûe
(0)

98 
	#ZB_RADIO_DMA_HDR_BUILD
(
pBuf
, 
Àn
Ëdo{ \

	)

99 
u8
 *
p
 = 
pBuf
; \

100 
p
[0] = 
Àn
 + 1; \

101 
p
[1] = 0; \

102 
p
[2] = 0; \

103 
p
[3] = 0; \

104 
	}

	$}whûe
(0)

107 
	#ZB_RADIO_ACTUAL_PAYLOAD_LEN
(
p
Ë
	`RF_GET_PKT_PAYLOAD_LEN
’)

	)

110 
	#ZB_RADIO_CRC_OK
(
p
Ë
	`RF_PACKET_CRC_OK
’)

	)

113 
	#ZB_RADIO_PACKET_LENGTH_OK
(
p
Ë
	`RF_PACKET_LENGTH_OK
’)

	)

116 
	#ZB_TIMESTAMP_ENABLE


	)

119 
	#ZB_RADIO_TIMESTAMP_GET
(
p
Ë
	`RF_GET_TIMESTAMP
’)

	)

121 
	#ZB_RADION_PKT_RSSI_GET
(
p
Ë
	`RF_GET_PKT_RSSI
’)

	)

124 
	#ZB_RADIO_TX_HDR_LEN
 5

	)

127 
	#ZB_RADIO_RX_HDR_LEN
 13

	)

130 
	#ZB_TX_WAIT_US
 120

	)

133 
	#ZB_RADIO_TX_0DBM
 
RF_POWER_m0P6dBm


	)

136 
	#ZB_RADIO_INIT
(Ëdo{ \

	)

137 
	`RF_Inô
(
RF_OSC_12M
, 
RF_MODE_ZIGBEE_250K
); \

138 
	`RF_ˇl
(
CFG_TP_GAIN
, 
CFG_FREQUENCY_OFFSET
); \

139 
	}

	$}whûe
(0)

142 
	#ZB_TIMER_INIT
(Ë
	`drv_hwTmr_öô
(
TIMER_IDX_3
, 
TIMER_MODE_SCLK
)

	)

144 
	#ZB_RADIO_RSSI_TO_LQI
(
mode
, 
rssi
, 
lqi
Ëdo{ \

	)

145 
s16
 
möEd
 = -106; \

146 
s16
 
maxEd
 = -58; \

147 if(
mode
 =
RF_GAIN_MODE_AUTO
){ \

148 
maxEd
 = -6; \

150 if(
rssi
 > 
maxEd
){rssi = maxEd;} \

151 if(
rssi
 < 
möEd
){rssi = minEd;} \

152 
lqi
 = 255*(
rssi
 - 
möEd
)/(
maxEd
 - minEd); \

153 
	}

	$}whûe
(0)

155 #ñi‡
	`deföed
(
MCU_CORE_8258
)

160 
	#ZB_RADIO_RESET
()

	)

163 
	#ZB_RADIO_TRX_SWITCH
(
mode
, 
chn
Ë
	`rf_åx_°©e_£t
(mode, chn)

	)

166 
	#ZB_RADIO_TX_POWER_SET
(
Àvñ
Ë
	`rf_£t_powî_Àvñ_ödex
÷evñ)

	)

169 
	#ZB_RADIO_MODE_MAX_GAIN
()

	)

172 
	#ZB_RADIO_MODE_AUTO_GAIN
()

	)

175 
	#ZB_RADIO_RSSI_GET
(Ë
	`rf_rssi_gë_154
()

	)

178 
	#ZB_RADIO_TX_START
(
txBuf
Ë
	`rf_tx_pkt
—xBuf)

	)

181 
	#ZB_RADIO_TX_DONE
 
	`rf_tx_föish
()

	)

184 
	#ZB_RADIO_TX_DONE_CLR
 
	`rf_tx_föish_˛ór_Êag
()

	)

187 
	#ZB_RADIO_RX_DONE
 
	`rf_rx_föish
()

	)

190 
	#ZB_RADIO_RX_DONE_CLR
 
	`rf_rx_föish_˛ór_Êag
()

	)

193 
	#ZB_RADIO_TX_ENABLE
 
RFDMA_TX_ENABLE


	)

196 
	#ZB_RADIO_TX_DISABLE
 
RFDMA_TX_DISABLE


	)

199 
	#ZB_RADIO_RX_ENABLE
 
RFDMA_RX_ENABLE


	)

202 
	#ZB_RADIO_RX_DISABLE
 
RFDMA_RX_DISABLE


	)

205 
	#ZB_RADIO_IRQ_MASK_CLR
 
	`úq_˛r_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

208 
	#ZB_RADIO_IRQ_MASK_SET
 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

211 
	#ZB_RADIO_TRX_STA_GET
(Ë
	`rf_åx_°©e_gë
()

	)

214 
	#ZB_RADIO_RX_BUF_SET
(
addr
Ë
	`rf_rx_buf„r_ªc⁄fig
◊ddr)

	)

217 
	#ZB_RADIO_RX_BUF_CLEAR
(
p
Ëdo{ \

	)

218 
p
[0] = 0; \

219 
p
[4] = 0; \

220 
	}

	$}whûe
(0)

223 
	#ZB_RADIO_TRX_CFG
(
size
Ëdo{ \

	)

224 
	`rf_rx_cfg
(
size
, 0); \

225 
	`dma_úq_dißbÀ
(
FLD_DMA_CHN_RF_RX
 | 
FLD_DMA_CHN_RF_TX
); \

226 
	`rf_úq_íabÀ
(
FLD_RF_IRQ_RX
 | 
FLD_RF_IRQ_TX
); \

227 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
); \

228 
	}

	$}whûe
(0)

230 
	#ZB_RADIO_DMA_HDR_BUILD
(
pBuf
, 
Àn
Ëdo{ \

	)

231 
u8
 *
p
 = 
pBuf
; \

232 
p
[0] = 
Àn
 + 1; \

233 
p
[1] = 0; \

234 
p
[2] = 0; \

235 
p
[3] = 0; \

236 
	}

	$}whûe
(0)

239 
	#ZB_RADIO_TX_HDR_LEN
 5

	)

242 
	#ZB_RADIO_RX_HDR_LEN
 5

	)

245 
	#ZB_TX_WAIT_US
 120

	)

248 
	#ZB_RADIO_ACTUAL_PAYLOAD_LEN
(
p
Ë
	`RF_ZIGBEE_PACKET_PAYLOAD_LENGTH_GET
’)

	)

251 
	#ZB_RADIO_CRC_OK
(
p
Ë
	`RF_ZIGBEE_PACKET_CRC_OK
’)

	)

254 
	#ZB_RADIO_PACKET_LENGTH_OK
(
p
Ë
	`RF_ZIGBEE_PACKET_LENGTH_OK
’)

	)

257 
	#ZB_TIMESTAMP_ENABLE
 do{ \

	)

258 
	`REG_ADDR8
(0x430Ë|
	`BIT
(1);\

259 
	}

	$}whûe
(0)

262 
	#ZB_RADIO_TIMESTAMP_GET
(
p
Ë
	`RF_ZIGBEE_PACKET_TIMESTAMP_GET
’)

	)

264 
	#ZB_RADION_PKT_RSSI_GET
(
p
Ë
	`RF_ZIGBEE_PACKET_RSSI_GET
’)

	)

267 
	#ZB_RADIO_TX_0DBM
 
RF_POWER_INDEX_P0p04dBm


	)

270 
	#ZB_RADIO_INIT
(Ëdo{ \

	)

271 
	`rf_drv_öô
(
RF_MODE_ZIGBEE_250K
); \

272 
	`rf_drv_ˇp
(
CFG_FREQUENCY_OFFSET
); \

273 
	}

	$}whûe
(0)

276 
	#ZB_TIMER_INIT
(Ë
	`drv_hwTmr_öô
(
TIMER_IDX_3
, 
TIMER_MODE_SCLK
)

	)

278 
	#ZB_RADIO_RSSI_TO_LQI
(
mode
, 
rssi
, 
lqi
Ëdo{ \

	)

279 ()
mode
; \

280 
s16
 
möEd
 = -99; \

281 
s16
 
maxEd
 = -15; \

282 if(
rssi
 > 
maxEd
){rssi = maxEd;} \

283 if(
rssi
 < 
möEd
){rssi = minEd;} \

284 
lqi
 = 255*(
rssi
 - 
möEd
)/(
maxEd
 - minEd); \

285 
	}

	$}whûe
(0)

287 #ñi‡
	`deföed
(
MCU_CORE_8278
)

292 
	#ZB_RADIO_RESET
()

	)

295 
	#ZB_RADIO_TRX_SWITCH
(
mode
, 
chn
Ë
	`rf_åx_°©e_£t
(mode, chn)

	)

298 
	#ZB_RADIO_TX_POWER_SET
(
Àvñ
Ë
	`rf_£t_powî_Àvñ_ödex
÷evñ)

	)

301 
	#ZB_RADIO_MODE_MAX_GAIN
()

	)

304 
	#ZB_RADIO_MODE_AUTO_GAIN
()

	)

307 
	#ZB_RADIO_RSSI_GET
(Ë
	`rf_rssi_gë_154
()

	)

310 
	#ZB_RADIO_TX_START
(
txBuf
Ë
	`rf_tx_pkt
—xBuf)

	)

313 
	#ZB_RADIO_TX_DONE
 
	`rf_tx_föish
()

	)

316 
	#ZB_RADIO_TX_DONE_CLR
 
	`rf_tx_föish_˛ór_Êag
()

	)

319 
	#ZB_RADIO_RX_DONE
 
	`rf_rx_föish
()

	)

322 
	#ZB_RADIO_RX_DONE_CLR
 
	`rf_rx_föish_˛ór_Êag
()

	)

325 
	#ZB_RADIO_TX_ENABLE
 
RFDMA_TX_ENABLE


	)

328 
	#ZB_RADIO_TX_DISABLE
 
RFDMA_TX_DISABLE


	)

331 
	#ZB_RADIO_RX_ENABLE
 
RFDMA_RX_ENABLE


	)

334 
	#ZB_RADIO_RX_DISABLE
 
RFDMA_RX_DISABLE


	)

337 
	#ZB_RADIO_IRQ_MASK_CLR
 
	`úq_˛r_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

340 
	#ZB_RADIO_IRQ_MASK_SET
 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
)

	)

343 
	#ZB_RADIO_TRX_STA_GET
(Ë
	`rf_åx_°©e_gë
()

	)

346 
	#ZB_RADIO_RX_BUF_SET
(
addr
Ë
	`rf_rx_buf„r_ªc⁄fig
◊ddr)

	)

349 
	#ZB_RADIO_RX_BUF_CLEAR
(
p
Ëdo{ \

	)

350 
p
[0] = 0; \

351 
p
[4] = 0; \

352 
	}

	$}whûe
(0)

355 
	#ZB_RADIO_TRX_CFG
(
size
Ëdo{ \

	)

356 
	`rf_rx_cfg
(
size
, 0); \

357 
	`dma_úq_dißbÀ
(
FLD_DMA_CHN_RF_RX
 | 
FLD_DMA_CHN_RF_TX
); \

358 
	`rf_úq_íabÀ
(
FLD_RF_IRQ_RX
 | 
FLD_RF_IRQ_TX
); \

359 
	`úq_£t_mask
(
FLD_IRQ_ZB_RT_EN
); \

360 
	}

	$}whûe
(0)

362 
	#ZB_RADIO_DMA_HDR_BUILD
(
pBuf
, 
Àn
Ëdo{ \

	)

363 
u8
 *
p
 = 
pBuf
; \

364 
p
[0] = 
Àn
 + 1; \

365 
p
[1] = 0; \

366 
p
[2] = 0; \

367 
p
[3] = 0; \

368 
	}

	$}whûe
(0)

371 
	#ZB_RADIO_TX_HDR_LEN
 5

	)

374 
	#ZB_RADIO_RX_HDR_LEN
 5

	)

377 
	#ZB_TX_WAIT_US
 120

	)

380 
	#ZB_RADIO_ACTUAL_PAYLOAD_LEN
(
p
Ë
	`RF_ZIGBEE_PACKET_PAYLOAD_LENGTH_GET
’)

	)

383 
	#ZB_RADIO_CRC_OK
(
p
Ë
	`RF_ZIGBEE_PACKET_CRC_OK
’)

	)

386 
	#ZB_RADIO_PACKET_LENGTH_OK
(
p
Ë
	`RF_ZIGBEE_PACKET_LENGTH_OK
’)

	)

389 
	#ZB_TIMESTAMP_ENABLE
 do{ \

	)

390 
	`REG_ADDR8
(0x430Ë|
	`BIT
(1);\

391 
	}

	$}whûe
(0)

394 
	#ZB_RADIO_TIMESTAMP_GET
(
p
Ë
	`RF_ZIGBEE_PACKET_TIMESTAMP_GET
’)

	)

396 
	#ZB_RADION_PKT_RSSI_GET
(
p
Ë
	`RF_ZIGBEE_PACKET_RSSI_GET
’)

	)

399 
	#ZB_RADIO_TX_0DBM
 
RF_POWER_INDEX_P0p52dBm


	)

402 
	#ZB_RADIO_INIT
(Ëdo{ \

	)

403 
	`rf_drv_öô
(
RF_MODE_ZIGBEE_250K
); \

404 
	`rf_drv_ˇp
(
CFG_FREQUENCY_OFFSET
); \

405 
	}

	$}whûe
(0)

408 
	#ZB_TIMER_INIT
(Ë
	`drv_hwTmr_öô
(
TIMER_IDX_3
, 
TIMER_MODE_SCLK
)

	)

410 
	#ZB_RADIO_RSSI_TO_LQI
(
mode
, 
rssi
, 
lqi
Ëdo{ \

	)

411 ()
mode
; \

412 
s16
 
möEd
 = -99; \

413 
s16
 
maxEd
 = -15; \

414 if(
rssi
 > 
maxEd
){rssi = maxEd;} \

415 if(
rssi
 < 
möEd
){rssi = minEd;} \

416 
lqi
 = 255*(
rssi
 - 
möEd
)/(
maxEd
 - minEd); \

417 
	}

	$}whûe
(0)

419 #ñi‡
	`deföed
(
MCU_CORE_B91
)

424 
	#ZB_RADIO_RESET
()

	)

427 
	#ZB_RADIO_TRX_SWITCH
(
mode
, 
chn
Ë
	`rf_£t_åx_°©e
(mode, chn)

	)

430 
	#ZB_RADIO_TX_POWER_SET
(
Àvñ
Ë
	`rf_£t_powî_Àvñ_ödex
÷evñ)

	)

433 
	#ZB_RADIO_MODE_MAX_GAIN
()

	)

436 
	#ZB_RADIO_MODE_AUTO_GAIN
()

	)

439 
	#ZB_RADIO_RSSI_GET
(Ë
	`rf_gë_rssi
()

	)

442 
	#ZB_RADIO_TX_START
(
txBuf
Ë
	`rf_tx_pkt
—xBuf)

	)

445 
	#ZB_RADIO_TX_DONE
 
	`rf_gë_úq_°©us
(
FLD_RF_IRQ_TX
)

	)

448 
	#ZB_RADIO_TX_DONE_CLR
 
	`rf_˛r_úq_°©us
(
FLD_RF_IRQ_TX
)

	)

451 
	#ZB_RADIO_RX_DONE
 
	`rf_gë_úq_°©us
(
FLD_RF_IRQ_RX
)

	)

454 
	#ZB_RADIO_RX_DONE_CLR
 
	`rf_˛r_úq_°©us
(
FLD_RF_IRQ_RX
)

	)

457 
	#ZB_RADIO_TX_ENABLE


	)

460 
	#ZB_RADIO_TX_DISABLE


	)

463 
	#ZB_RADIO_RX_ENABLE
 
	`dma_chn_í
(
DMA1
)

464 

	)

466 
	#ZB_RADIO_RX_DISABLE
 
	`dma_chn_dis
(
DMA1
)

467 

	)

469 
	#ZB_RADIO_IRQ_MASK_CLR
 
	`rf_˛r_úq_mask
(
FLD_RF_IRQ_TX
)

	)

472 
	#ZB_RADIO_IRQ_MASK_SET
 
	`rf_£t_úq_mask
(
FLD_RF_IRQ_TX
)

	)

475 
	#ZB_RADIO_TRX_STA_GET
(Ë
	`rf_gë_åx_°©e
()

	)

478 
	#ZB_RADIO_RX_BUF_SET
(
addr
Ë
	`rf_£t_rx_buf„r
◊ddr)

	)

481 
	#ZB_RADIO_RX_BUF_CLEAR
(
p
Ëdo{ \

	)

482 
p
[0] = 0; \

483 
p
[4] = 0; \

484 
	}

	$}whûe
(0)

487 
	#ZB_RADIO_TRX_CFG
(
size
Ëdo{ \

	)

488 
	`rf_£t_rx_maxÀn
(
size
); \

489 
	`rf_£t_rx_dma_c⁄fig
(); \

490 
	`rf_£t_rx_dma_fifo_num
(0); \

491 
	`rf_£t_rx_dma_fifo_size
(
size
); \

492 
	`rf_£t_tx_dma_c⁄fig
(); \

493 
	`rf_£t_tx_dma_fifo_num
(1); \

494 
	`rf_£t_tx_dma_fifo_size
(128); \

495 
	`rf_£t_úq_mask
(
FLD_RF_IRQ_RX
|
FLD_RF_IRQ_TX
); \

496 
	`∂ic_öãºu±_íabÀ
(
IRQ15_ZB_RT
); \

497 
	}

	$}whûe
(0)

499 
	#ZB_RADIO_DMA_HDR_BUILD
(
pBuf
, 
Àn
Ëdo{ \

	)

500 
u8
 *
p
 = 
pBuf
; \

501 
u32
 
txLí
 = 
	`rf_tx_∑ckë_dma_Àn
(
Àn
 + 1); \

502 
p
[3] = (
txLí
 >> 24) & 0xFF; \

503 
p
[2] = (
txLí
 >> 16) & 0xFF; \

504 
p
[1] = (
txLí
 >> 8) & 0xFF; \

505 
p
[0] = 
txLí
 & 0xFF; \

506 
	}

	$}whûe
(0)

509 
	#ZB_RADIO_TX_HDR_LEN
 5

	)

512 
	#ZB_RADIO_RX_HDR_LEN
 5

	)

515 
	#ZB_TX_WAIT_US
 85

	)

518 
	#ZB_RADIO_ACTUAL_PAYLOAD_LEN
(
p
Ë
	`rf_zigbì_gë_∑ylﬂd_Àn
’)

	)

521 
	#ZB_RADIO_CRC_OK
(
p
Ë
	`rf_zigbì_∑ckë_¸c_ok
’)

	)

524 
	#ZB_RADIO_PACKET_LENGTH_OK
(
p
Ë
	`rf_zigbì_∑ckë_Àngth_ok
’)

	)

527 
	#ZB_TIMESTAMP_ENABLE


	)

530 
	#ZB_RADIO_TIMESTAMP_GET
(
p
Ë–p[
	`rf_zigbì_dma_rx_off£t_time_°amp
’)] | \

	)

531 
p
[
	`rf_zigbì_dma_rx_off£t_time_°amp
(p)+1] | \

532 
p
[
	`rf_zigbì_dma_rx_off£t_time_°amp
(p)+2] | \

533 
p
[
	`rf_zigbì_dma_rx_off£t_time_°amp
(p)+3] )

535 
	#ZB_RADION_PKT_RSSI_GET
(
p
Ë’[
	`rf_zigbì_dma_rx_off£t_rssi
’)])

	)

539 
	#ZB_RADIO_TX_0DBM
 
RF_POWER_INDEX_P0p01dBm


	)

542 
	#ZB_RADIO_INIT
(Ëdo{ \

	)

543 
	`rf_mode_öô
(); \

544 
	`rf_£t_zigbì_250K_mode
(); \

545 
	}

	$}whûe
(0)

548 
	#ZB_TIMER_INIT
(Ë
	`drv_hwTmr_öô
(
TIMER_IDX_3
, 
TIMER_MODE_SCLK
)

	)

550 
	#ZB_RADIO_RSSI_TO_LQI
(
mode
, 
rssi
, 
lqi
Ëdo{ \

	)

551 ()
mode
; \

552 
s16
 
möEd
 = -99; \

553 
s16
 
maxEd
 = -15; \

554 if(
rssi
 > 
maxEd
){rssi = maxEd;} \

555 if(
rssi
 < 
möEd
){rssi = minEd;} \

556 
lqi
 = 255*(
rssi
 - 
möEd
)/(
maxEd
 - minEd); \

557 
	}

	$}whûe
(0)

	@proj/drivers/drv_spi.c

24 
	~"../é_comm⁄.h
"

26 #i‡
deföed
(
MCU_CORE_B91
)

27 
p•i_c¢_pö_def_e
 
	gdrv_cs_pö
;

37 
	$drv_•i_ma°î_öô
(
u32
 
•iClock
, 
drv_•i_mode_ty≥_def
 
mode
)

39 
u8
 
divClock
 = (u8)(
SPI_CLOCK_SOURCE
 / (2 * 
•iClock
) - 1);

41 #if 
	`deföed
(
MCU_CORE_826x
)

42 
	`SPI_Ma°îInô
(
divClock
, 
mode
);

43 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

44 
	`•i_ma°î_öô
(
divClock
, 
mode
);

45 #ñi‡
	`deföed
(
MCU_CORE_B91
)

49 
	`•i_ma°î_öô
(
PSPI_MODULE
, 
divClock
, 
mode
);

50 
	`•i_ma°î_c⁄fig
(
PSPI_MODULE
, 
SPI_NOMAL
);

52 
	}
}

59 
	$drv_•i_¶ave_öô
(
drv_•i_mode_ty≥_def
 
mode
)

61 #if 
	`deföed
(
MCU_CORE_826x
)

62 
	`SPI_SœveInô
(0, 
mode
);

63 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

64 
	`•i_¶ave_öô
(0, 
mode
);

65 #ñi‡
	`deföed
(
MCU_CORE_B91
)

66 
	`•i_¶ave_öô
(
PSPI_MODULE
, 
mode
);

68 
	}
}

75 #if 
deföed
(
MCU_CORE_826x
)

76 
	$drv_•i_ma°î_pö_£À˘
(
SPI_PöTy≥Def
 
pöGroup
)

78 
	`SPI_Ma°îPöSñe˘
(
pöGroup
);

79 
	}
}

80 #ñi‡
deföed
(
MCU_CORE_8258
)

81 
	$drv_•i_ma°î_pö_£À˘
(
SPI_GPIO_GroupTy≥Def
 
pöGroup
)

83 
	`•i_ma°î_gpio_£t
(
pöGroup
);

84 
	}
}

85 #ñi‡
deföed
(
MCU_CORE_8278
)

86 
	$drv_•i_ma°î_pö_£À˘
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
)

88 
	`•i_ma°î_gpio_£t
(
s˛k_pö
, 
cs_pö
, 
sdo_pö
, 
sdi_pö
);

89 
	}
}

90 #ñi‡
deföed
(
MCU_CORE_B91
)

91 
	$drv_•i_ma°î_pö_£À˘
(
p•i_˛k_pö_def_e
 
s˛k_pö
, 
p•i_c¢_pö_def_e
 
cs_pö
, 
p•i_mosi_io0_pö_def_e
 
mosi_pö
, 
p•i_miso_io1_pö_def_e
 
miso_pö
)

93 
p•i_pö_c⁄fig_t
 
p•i_pö_c⁄fig
;

95 
p•i_pö_c⁄fig
.
p•i_˛k_pö
 = 
s˛k_pö
;

96 
p•i_pö_c⁄fig
.
p•i_c¢_pö
 = 
cs_pö
;

97 
p•i_pö_c⁄fig
.
p•i_mosi_io0_pö
 = 
mosi_pö
;

98 
p•i_pö_c⁄fig
.
p•i_miso_io1_pö
 = 
miso_pö
;

100 
drv_cs_pö
 = 
cs_pö
;

102 
	`p•i_£t_pö
(&
p•i_pö_c⁄fig
);

103 
	}
}

111 #if 
deföed
(
MCU_CORE_826x
)

112 
	$drv_•i_¶ave_pö_£À˘
(
SPI_PöTy≥Def
 
pöGroup
)

114 
	`SPI_SœvePöSñe˘
(
pöGroup
);

115 
	}
}

116 #ñi‡
deföed
(
MCU_CORE_8258
)

117 
	$drv_•i_¶ave_pö_£À˘
(
SPI_GPIO_GroupTy≥Def
 
pöGroup
)

119 
	`•i_¶ave_gpio_£t
(
pöGroup
);

120 
	}
}

121 #ñi‡
deföed
(
MCU_CORE_8278
)

122 
	$drv_•i_¶ave_pö_£À˘
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
)

124 
	`•i_¶ave_gpio_£t
(
s˛k_pö
, 
cs_pö
, 
sdo_pö
, 
sdi_pö
);

125 
	}
}

126 #ñi‡
deföed
(
MCU_CORE_B91
)

127 
	$drv_•i_¶ave_pö_£À˘
(
p•i_˛k_pö_def_e
 
s˛k_pö
, 
p•i_c¢_pö_def_e
 
cs_pö
, 
p•i_mosi_io0_pö_def_e
 
mosi_pö
, 
p•i_miso_io1_pö_def_e
 
miso_pö
)

129 
p•i_pö_c⁄fig_t
 
p•i_pö_c⁄fig
;

131 
p•i_pö_c⁄fig
.
p•i_˛k_pö
 = 
s˛k_pö
;

132 
p•i_pö_c⁄fig
.
p•i_c¢_pö
 = 
cs_pö
;

133 
p•i_pö_c⁄fig
.
p•i_mosi_io0_pö
 = 
mosi_pö
;

134 
p•i_pö_c⁄fig
.
p•i_miso_io1_pö
 = 
miso_pö
;

136 
drv_cs_pö
 = 
cs_pö
;

138 
	`p•i_£t_pö
(&
p•i_pö_c⁄fig
);

139 
	}
}

153 
	$drv_•i_wrôe
(
u8
 *
cmd
, 
cmdLí
, u8 *
d©a
, 
d©aLí
, 
u32
 
csPö
)

155 #if 
	`deföed
(
MCU_CORE_826x
)

156 
	`SPI_Wrôe
(
cmd
, 
cmdLí
, 
d©a
, 
d©aLí
, 
csPö
);

157 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

158 
	`•i_wrôe
(
cmd
, 
cmdLí
, 
d©a
, 
d©aLí
, 
csPö
);

159 #ñi‡
	`deföed
(
MCU_CORE_B91
)

160 
u8
 *
pBuf
 = (u8 *)
	`ev_buf_Æloˇã
(
cmdLí
 + 
d©aLí
);

161 if(
pBuf
){

162 if(
drv_cs_pö
 !
csPö
){

163 
	`p•i_cs_pö_dis
(
drv_cs_pö
);

164 
	`p•i_cs_pö_í
(
csPö
);

165 
drv_cs_pö
 = 
csPö
;

168 
u8
 *
pD©a
 = 
pBuf
;

170 
	`mem˝y
(
pD©a
, 
cmd
, 
cmdLí
);

171 
pD©a
 +
cmdLí
;

172 
	`mem˝y
(
pD©a
, 
d©a
, 
d©aLí
);

173 
pD©a
 +
d©aLí
;

175 
	`•i_ma°î_wrôe
(
PSPI_MODULE
, 
pBuf
, 
cmdLí
 + 
d©aLí
);

177 
	`ev_buf_‰ì
(
pBuf
);

180 
	}
}

194 
	$drv_•i_ªad
(
u8
 *
cmd
, 
cmdLí
, u8 *
d©a
, 
d©aLí
, 
u32
 
csPö
)

196 #if 
	`deföed
(
MCU_CORE_826x
)

197 
	`SPI_Ród
(
cmd
, 
cmdLí
, 
d©a
, 
d©aLí
, 
csPö
);

198 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

199 
	`•i_ªad
(
cmd
, 
cmdLí
, 
d©a
, 
d©aLí
, 
csPö
);

200 #ñi‡
	`deföed
(
MCU_CORE_B91
)

201 if(
drv_cs_pö
 !
csPö
){

202 
	`p•i_cs_pö_dis
(
drv_cs_pö
);

203 
	`p•i_cs_pö_í
(
csPö
);

204 
drv_cs_pö
 = 
csPö
;

206 
	`•i_ma°î_wrôe_ªad
(
PSPI_MODULE
, 
cmd
, 
cmdLí
, 
d©a
, 
d©aLí
);

208 
	}
}

	@proj/drivers/drv_spi.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

28 
	#SPI_CLOCK_SOURCE
 
CLOCK_SYS_CLOCK_HZ


	)

29 #ñi‡
deföed
(
MCU_CORE_B91
)

31 
	#SPI_CLOCK_SOURCE
 (
sys_˛k
.
p˛k
 * 1000 * 1000)

	)

38 
	mSPI_MODE_0
 = 0,

39 
	mSPI_MODE_2
,

40 
	mSPI_MODE_1
,

41 
	mSPI_MODE_3
,

42 }
	tdrv_•i_mode_ty≥_def
;

53 
drv_•i_ma°î_öô
(
u32
 
•iClock
, 
drv_•i_mode_ty≥_def
 
mode
);

60 
drv_•i_¶ave_öô
(
drv_•i_mode_ty≥_def
 
mode
);

67 #if 
deföed
(
MCU_CORE_826x
)

68 
drv_•i_ma°î_pö_£À˘
(
SPI_PöTy≥Def
 
pöGroup
);

69 #ñi‡
deföed
(
MCU_CORE_8258
)

70 
drv_•i_ma°î_pö_£À˘
(
SPI_GPIO_GroupTy≥Def
 
pöGroup
);

71 #ñi‡
deföed
(
MCU_CORE_8278
)

72 
drv_•i_ma°î_pö_£À˘
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
);

73 #ñi‡
deföed
(
MCU_CORE_B91
)

74 
drv_•i_ma°î_pö_£À˘
(
p•i_˛k_pö_def_e
 
s˛k_pö
, 
p•i_c¢_pö_def_e
 
cs_pö
, 
p•i_mosi_io0_pö_def_e
 
mosi_pö
, 
p•i_miso_io1_pö_def_e
 
miso_pö
);

82 #if 
deföed
(
MCU_CORE_826x
)

83 
drv_•i_¶ave_pö_£À˘
(
SPI_PöTy≥Def
 
pöGroup
);

84 #ñi‡
deföed
(
MCU_CORE_8258
)

85 
drv_•i_¶ave_pö_£À˘
(
SPI_GPIO_GroupTy≥Def
 
pöGroup
);

86 #ñi‡
deföed
(
MCU_CORE_8278
)

87 
drv_•i_¶ave_pö_£À˘
(
SPI_GPIO_S˛kTy≥Def
 
s˛k_pö
, 
SPI_GPIO_CsTy≥Def
 
cs_pö
, 
SPI_GPIO_SdoTy≥Def
 
sdo_pö
, 
SPI_GPIO_SdiTy≥Def
 
sdi_pö
);

88 #ñi‡
deföed
(
MCU_CORE_B91
)

89 
drv_•i_¶ave_pö_£À˘
(
p•i_˛k_pö_def_e
 
s˛k_pö
, 
p•i_c¢_pö_def_e
 
cs_pö
, 
p•i_mosi_io0_pö_def_e
 
mosi_pö
, 
p•i_miso_io1_pö_def_e
 
miso_pö
);

103 
drv_•i_wrôe
(
u8
 *
cmd
, 
cmdLí
, u8 *
d©a
, 
d©aLí
, 
u32
 
csPö
);

116 
drv_•i_ªad
(
u8
 *
cmd
, 
cmdLí
, u8 *
d©a
, 
d©aLí
, 
u32
 
csPö
);

	@proj/drivers/drv_timer.c

24 
	~"../é_comm⁄.h
"

27 
	#TIMER_SAFE_BOUNDARY_IN_US
(
v
Ë(10 * v)

	)

28 
	#TIMER_OVERFLOW_VALUE
 (0xFFFFFFFE)

	)

33 
ext_˛k_t
 
	mexpúeInfo
;

34 
timîCb_t
 
	mcb
;

35 *
	m¨g
;

40 
u32
 
	m°©us
:2;

41 
u32
 
	mª£rved
:30;

42 }
	mbf
;

43 
u32
 
	mbyãVÆ
;

44 }
	mÊags
;

45 }
	thwTmr_öfo_t
;

48 
hwTmr_öfo_t
 
	mtimîInfo
[
TIMER_NUM
];

49 }
	thwTmr_˘æ_t
;

52 
hwTmr_˘æ_t
 
	ghwTmr_v¨s
;

55 
	$hwTimîInô
(
u8
 
tmrIdx
, u8 
mode
)

57 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

58 if(
tmrIdx
 < 
TIMER_IDX_3
){

59 
	`timî_£t_mode
(
tmrIdx
, 
mode
);

60 
	`timî_úq_íabÀ
(
tmrIdx
);

62 
	`°imî_úq_íabÀ
();

64 #ñi‡
	`deföed
(
MCU_CORE_B91
)

65 if(
tmrIdx
 < 
TIMER_IDX_3
){

66 
	`timî_£t_mode
(
tmrIdx
, 
mode
);

67 if(
tmrIdx
 =
TIMER_IDX_0
){

68 
	`∂ic_öãºu±_íabÀ
(
IRQ4_TIMER0
);

69 }if(
tmrIdx
 =
TIMER_IDX_1
){

70 
	`∂ic_öãºu±_íabÀ
(
IRQ3_TIMER1
);

73 
	`∂ic_öãºu±_íabÀ
(
IRQ1_SYSTIMER
);

76 
	}
}

78 
	$hwTimîSë
(
u8
 
tmrIdx
, 
u32
 
tick
)

81 if(
tmrIdx
 < 
TIMER_IDX_3
){

82 
	`timî_£t_öô_tick
(
tmrIdx
, 0);

83 
	`timî_£t_ˇp_tick
(
tmrIdx
, 
tick
);

85 
	`°imî_£t_úq_ˇ±uª
(
tick
 + 
	`˛ock_time
());

87 
	}
}

89 
	$hwTimîSèπ
(
u8
 
tmrIdx
)

91 if(
tmrIdx
 < 
TIMER_IDX_3
){

92 
	`timî_°¨t
(
tmrIdx
);

94 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

95 
	`°imî_£t_úq_mask
();

96 #ñi‡
	`deföed
(
MCU_CORE_B91
)

97 
	`°imî_£t_úq_mask
(
FLD_SYSTEM_IRQ
);

100 
	}
}

102 
	$hwTimîSt›
(
u8
 
tmrIdx
)

104 if(
tmrIdx
 < 
TIMER_IDX_3
){

105 
	`timî_°›
(
tmrIdx
);

107 #i‡
	`deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

108 
	`°imî_˛r_úq_mask
();

109 #ñi‡
	`deföed
(
MCU_CORE_B91
)

110 
	`°imî_˛r_úq_mask
(
FLD_SYSTEM_IRQ
);

113 
	}
}

116 
hw_timî_°s_t
 
	$hwTmr_£tAbs
(
u8
 
tmrIdx
, 
ext_˛k_t
 *
absTimî
, 
timîCb_t
 
func
, *
¨g
)

118 
hwTmr_öfo_t
 *
pTimî
 = &
hwTmr_v¨s
.
timîInfo
[
tmrIdx
];

121 if(
TIMER_IDLE
 !
pTimî
->
Êags
.
bf
.
°©us
){

122  
HW_TIMER_IS_RUNNING
;

125 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

128 
pTimî
->
expúeInfo
.
high
 = 
absTimî
->high;

129 
pTimî
->
expúeInfo
.
low
 = 
absTimî
->low;

130 
pTimî
->
cb
 = 
func
;

131 
pTimî
->
¨g
 =árg;

133 
pTimî
->
Êags
.
bf
.
°©us
 =ÖTimî->
expúeInfo
.
high
 ? 
TIMER_WOF
 : 
TIMER_WTO
;

136 if(!
pTimî
->
expúeInfo
.
high
 &&ÖTimî->expúeInfo.
low
 < 
	`TIMER_SAFE_BOUNDARY_IN_US
(
	`TIMER_TICK_1US_GET
(
tmrIdx
))){

137 
	`drv_ª°‹e_úq
(
r
);

138 
	`mem£t
(
pTimî
, 0, (
hwTmr_öfo_t
));

139 if(
func
){

140 
	`func
(
¨g
);

142  
HW_TIMER_SUCC
;

144 
	`hwTimîSë
(
tmrIdx
, 
pTimî
->
expúeInfo
.
high
 ? 
TIMER_OVERFLOW_VALUE
 :ÖTimî->expúeInfo.
low
);

145 
	`hwTimîSèπ
(
tmrIdx
);

148 
	`drv_ª°‹e_úq
(
r
);

150  
HW_TIMER_SUCC
;

151 
	}
}

153 
	$drv_hwTmr_úq_¥o˚ss
(
u8
 
tmrIdx
)

155 
hwTmr_öfo_t
 *
pTimî
 = &
hwTmr_v¨s
.
timîInfo
[
tmrIdx
];

157 if(
TIMER_WTO
 =
pTimî
->
Êags
.
bf
.
°©us
){

159 if(
pTimî
->
cb
){

160 
t
;

162 
t
 = 
pTimî
->
	`cb
’Timî->
¨g
);

164 if(
t
 < 0){

165 
	`hwTimîSt›
(
tmrIdx
);

166 
	`mem£t
(
pTimî
, 0, (
hwTmr_öfo_t
));

168 if(
t
 != 0){

169 
pTimî
->
expúeInfo
.
low
 = 
t
 * 
	`TIMER_TICK_1US_GET
(
tmrIdx
);

172 
	`hwTimîSë
(
tmrIdx
, 
pTimî
->
expúeInfo
.
high
 ? 
TIMER_OVERFLOW_VALUE
 :ÖTimî->expúeInfo.
low
);

176 if(--
pTimî
->
expúeInfo
.
high
){

177 
	`hwTimîSë
(
tmrIdx
, 
TIMER_OVERFLOW_VALUE
);

179 
	`hwTimîSë
(
tmrIdx
, 
pTimî
->
expúeInfo
.
low
);

181 
pTimî
->
Êags
.
bf
.
°©us
 = 
TIMER_WTO
;

184 
	}
}

186 
	$hwTimîInfoRe£t
(
u8
 
tmrIdx
)

188 
	`mem£t
((
u8
*)&
hwTmr_v¨s
.
timîInfo
[
tmrIdx
], 0, (
hwTmr_öfo_t
));

189 
	}
}

191 
	$drv_hwTmr_öô
(
u8
 
tmrIdx
, u8 
mode
)

193 if(
tmrIdx
 >
TIMER_NUM
){

197 
	`hwTimîInfoRe£t
(
tmrIdx
);

198 
	`hwTimîInô
(
tmrIdx
, 
mode
);

199 
	}
}

201 
	$drv_hwTmr_ˇn˚l
(
u8
 
tmrIdx
)

203 if(
tmrIdx
 >
TIMER_NUM
){

207 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

209 
	`hwTimîSt›
(
tmrIdx
);

211 
hwTmr_öfo_t
 *
pTimî
 = &
hwTmr_v¨s
.
timîInfo
[
tmrIdx
];

212 
	`mem£t
(
pTimî
, 0, (
hwTmr_öfo_t
));

214 
	`drv_ª°‹e_úq
(
r
);

215 
	}
}

217 
hw_timî_°s_t
 
	$drv_hwTmr_£t
(
u8
 
tmrIdx
, 
u32
 
t_us
, 
timîCb_t
 
func
, *
¨g
)

219 if(
tmrIdx
 >
TIMER_NUM
){

220  
HW_TIMER_INVALID
;

223 
ext_˛k_t
 
t
;

224 
t
.
high
 = 0;

225 
t
.
low
 = 
t_us
 * 
	`TIMER_TICK_1US_GET
(
tmrIdx
);

227  
	`hwTmr_£tAbs
(
tmrIdx
, &
t
, 
func
, 
¨g
);

228 
	}
}

232 
	$drv_timî_úq0_h™dÀr
()

234 
	`drv_hwTmr_úq_¥o˚ss
(
TIMER_IDX_0
);

235 
	}
}

237 
	$drv_timî_úq1_h™dÀr
()

239 
	`drv_hwTmr_úq_¥o˚ss
(
TIMER_IDX_1
);

240 
	}
}

242 
	$drv_timî_úq3_h™dÀr
()

244 
	`drv_hwTmr_úq_¥o˚ss
(
TIMER_IDX_3
);

245 
	}
}

	@proj/drivers/drv_timer.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

28 
	#S_TIMER_CLOCK_1US
 
sysTimîPîUs


	)

29 
	#H_TIMER_CLOCK_1US
 (
CLOCK_SYS_CLOCK_HZ
 / 1000000)

	)

30 #ñi‡
deföed
(
MCU_CORE_B91
)

31 
	#S_TIMER_CLOCK_1US
 
sysTimîPîUs


	)

32 
	#H_TIMER_CLOCK_1US
 (
sys_˛k
.
p˛k
)

	)

34 
	#˛ock_time
(Ë
	`°imî_gë_tick
()

	)

35 
	#WaôUs
(
us
Ë
	`dñay_us
(us)

	)

36 
	#WaôMs
(
ms
Ë
	`dñay_ms
(ms)

	)

39 
	#TIMER_TICK_1US_GET
(
idx
Ë((idx < 
TIMER_IDX_3
Ë? 
H_TIMER_CLOCK_1US
 : 
S_TIMER_CLOCK_1US
)

	)

44 
	#TIMER_IDX_0
 0

45 
	#TIMER_IDX_1
 1

46 
	#TIMER_IDX_2
 2

47 
	#TIMER_IDX_3
 3

48 
	#TIMER_NUM
 4

49 

	)

54 
	#TIMER_MODE_SCLK
 0

55 
	#TIMER_MODE_GPIO
 1

	)

56 
	#TIMER_MODE_WIDTH_GPIO
 2

	)

57 
	#TIMER_MODE_TICK_MODE
 3

	)

62 
	#TIMER_IDLE
 0

63 
	#TIMER_WOF
 1

64 
	#TIMER_WTO
 2

65 

	)

71 
u32
 
	mlow
;

72 
u32
 
	mhigh
;

73 }
	text_˛k_t
;

78 
	ehw_timî_°s_e
{

79 
	mHW_TIMER_SUCC
 = 0,

80 
	mHW_TIMER_IS_RUNNING
 = 1,

81 
	mHW_TIMER_INVALID
,

82 }
	thw_timî_°s_t
;

87 (*
	ttimîCb_t
)(*
	tp
);

98 
	`drv_hwTmr_öô
(
u8
 
tmrIdx
, u8 
mode
);

110 
hw_timî_°s_t
 
	`drv_hwTmr_£t
(
u8
 
tmrIdx
, 
u32
 
t_us
, 
timîCb_t
 
func
, *
¨g
);

119 
	`drv_hwTmr_ˇn˚l
(
u8
 
tmrIdx
);

128 
	`drv_timî_úq0_h™dÀr
();

129 
	`drv_timî_úq1_h™dÀr
();

130 
	`drv_timî_úq3_h™dÀr
();

	@proj/drivers/drv_uart.c

24 
	~"../é_comm⁄.h
"

26 #i‡
deföed
(
MCU_CORE_B91
)

27 
	#UART_IDX
 
UART0


	)

28 
	#UART_DMA_CHANNEL_RX
 
DMA2


	)

29 
	#UART_DMA_CHANNEL_TX
 
DMA3


	)

31 
u8
 *
	gpU¨tRxBuf
 = 
NULL
;

32 
u32
 
	gu¨tRxBufLí
 = 0;

34 
	#UART_RCV_DMA_LEN_FIX
(Ëdo{ \

	)

35 
u32
 
	grcvD©aLí
 = 
u¨t_gë_dma_ªv_d©a_Àn
(
UART_IDX
, 
UART_DMA_CHANNEL_RX
); \

36 if(
	gpU¨tRxBuf
){ \

37 
	gpU¨tRxBuf
[0] = (
u8
)(
rcvD©aLí
); \

38 
	gpU¨tRxBuf
[1] = (
u8
)(
rcvD©aLí
 >> 8); \

39 
	gpU¨tRxBuf
[2] = (
u8
)(
rcvD©aLí
 >> 16); \

40 
	gpU¨tRxBuf
[3] = (
u8
)(
rcvD©aLí
 >> 24); \

44 
u8
 
	`u¨t_dma_£nd
(u8 *
pBuf
);

47 
drv_u¨t_t
 
myU¨tDrivî
 = {

48 .
°©us
 = 
UART_STA_IDLE
,

49 .
ªcvCb
 = 
NULL
,

50 #if 
	`deföed
(
MCU_CORE_826x
)

51 .
£nd
 = 
u¨t_pktSíd
,

52 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

53 .
£nd
 = 
u¨t_dma_£nd
,

55 
	}
};

57 
u8
 *
	gu¨tDrvTxBuf
 = 
NULL
;

59 
	$drv_u¨t_öô
(
u32
 
baudøã
, 
u8
 *
rxBuf
, 
u16
 
rxBufLí
, 
u¨t_úq_ˇŒback
 
u¨tRecvCb
)

61 
myU¨tDrivî
.
°©us
 = 
UART_STA_IDLE
;

62 
myU¨tDrivî
.
ªcvCb
 = 
u¨tRecvCb
;

64 if(
u¨tDrvTxBuf
){

65 
	`ev_buf_‰ì
(
u¨tDrvTxBuf
);

66 
u¨tDrvTxBuf
 = 
NULL
;

69 #if 
	`deföed
(
MCU_CORE_826x
)

70 
	`u¨t_Re£t
();

71 
	`u¨t_Inô
(
baudøã
, 1, 1, 
NOCONTROL
);

73 
	`u¨t_RecBuffInô
(
rxBuf
, 
rxBufLí
);

74 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

75 
	`u¨t_ªcbuff_öô
(
rxBuf
, 
rxBufLí
);

76 
	`u¨t_ª£t
();

78 
	`u¨t_öô_baudøã
(
baudøã
, 
UART_CLOCK_SOURCE
, 
PARITY_NONE
, 
STOP_BIT_ONE
);

81 
	`u¨t_dma_íabÀ
(1, 1);

82 
	`úq_£t_mask
(
FLD_IRQ_DMA_EN
);

83 
	`dma_chn_úq_íabÀ
(
FLD_DMA_CHN_UART_RX
 | 
FLD_DMA_CHN_UART_TX
, 1);

84 
	`u¨t_úq_íabÀ
(0, 0);

85 #ñi‡
	`deföed
(
MCU_CORE_B91
)

86 
u16
 
div
 = 0;

87 
u8
 
bwpc
 = 0;

89 
pU¨tRxBuf
 = 
rxBuf
;

90 
u¨tRxBufLí
 = 
rxBufLí
;

92 
	`u¨t_ª£t
(
UART_IDX
);

94 
	`u¨t_ˇl_div_™d_bwpc
(
baudøã
, 
UART_CLOCK_SOURCE
, &
div
, &
bwpc
);

95 
	`u¨t_£t_dma_rx_timeout
(
UART_IDX
, 
bwpc
, 12, 
UART_BW_MUL1
);

96 
	`u¨t_öô
(
UART_IDX
, 
div
, 
bwpc
, 
UART_PARITY_NONE
, 
UART_STOP_BIT_ONE
);

98 
	`dma_˛r_úq_mask
(
UART_DMA_CHANNEL_TX
, 
TC_MASK
 | 
ABT_MASK
 | 
ERR_MASK
);

99 
	`dma_˛r_úq_mask
(
UART_DMA_CHANNEL_RX
, 
TC_MASK
 | 
ABT_MASK
 | 
ERR_MASK
);

100 
	`u¨t_£t_tx_dma_c⁄fig
(
UART_IDX
, 
UART_DMA_CHANNEL_TX
);

101 
	`u¨t_£t_rx_dma_c⁄fig
(
UART_IDX
, 
UART_DMA_CHANNEL_RX
);

103 
	`u¨t_ª˚ive_dma
(
UART_IDX
, 
pU¨tRxBuf
 + 4, 
u¨tRxBufLí
);

105 
	`u¨t_˛r_tx_d⁄e
(
UART_IDX
);

106 
	`u¨t_˛r_úq_mask
(
UART_IDX
, 
UART_RX_IRQ_MASK
 | 
UART_TX_IRQ_MASK
 | 
UART_TXDONE_MASK
 | 
UART_RXDONE_MASK
);

107 
	`u¨t_£t_úq_mask
(
UART_IDX
, 
UART_RXDONE_MASK
 | 
UART_TXDONE_MASK
);

108 
	`∂ic_öãºu±_íabÀ
((
UART_IDX
 =
UART0
Ë? 
IRQ19_UART0
 : 
IRQ18_UART1
);

110 
	}
}

112 
	$drv_u¨t_pö_£t
(
u32
 
txPö
, u32 
rxPö
)

114 #if 
	`deföed
(
MCU_CORE_826x
)

115 
	`gpio_£t_func
(
txPö
, 
AS_UART
);

116 
	`gpio_£t_func
(
rxPö
, 
AS_UART
);

117 
	`gpio_£t_ouçut_í
(
txPö
, 1);

118 
	`gpio_£t_öput_í
(
txPö
, 0);

119 
	`gpio_£t_ouçut_í
(
rxPö
, 0);

120 
	`gpio_£t_öput_í
(
rxPö
, 1);

121 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

122 
	`u¨t_gpio_£t
(
txPö
, 
rxPö
);

123 #ñi‡
	`deföed
(
MCU_CORE_B91
)

124 
	`u¨t_£t_pö
(
txPö
, 
rxPö
);

126 
	}
}

128 
	$drv_u¨t_rx_úq_h™dÀr
()

130 #i‡
	`deföed
(
MCU_CORE_B91
)

131 
boﬁ
 
u¨tRxEº
 = 0;

133 if((
	`u¨t_gë_úq_°©us
(
UART_IDX
, 
UART_RX_ERR
))){

134 
u¨tRxEº
 = 1;

137 
	`UART_RCV_DMA_LEN_FIX
();

140 
	`u¨t_˛r_úq_°©us
(
UART_IDX
, 
UART_CLR_RX
);

143 
	`u¨t_ª˚ive_dma
(
UART_IDX
, 
pU¨tRxBuf
 + 4, 
u¨tRxBufLí
);

145 if(
u¨tRxEº
){

150 if(
myU¨tDrivî
.
ªcvCb
){

151 
myU¨tDrivî
.
	`ªcvCb
();

153 
	}
}

155 
	$drv_u¨t_tx_úq_h™dÀr
()

157 #i‡
	`deföed
(
MCU_CORE_B91
)

158 
	`u¨t_˛r_tx_d⁄e
(
UART_IDX
);

161 if(
u¨tDrvTxBuf
){

162 
	`ev_buf_‰ì
(
u¨tDrvTxBuf
);

163 
u¨tDrvTxBuf
 = 
NULL
;

165 
myU¨tDrivî
.
°©us
 = 
UART_STA_TX_DONE
;

166 
	}
}

168 #i‡
deföed
(
MCU_CORE_B91
)

169 
u8
 
	$u¨t_dma_£nd
(
u8
 *
pBuf
)

171 
u32
 
Àn
 = 
	`BUILD_U32
(
pBuf
[0],ÖBuf[1],ÖBuf[2],ÖBuf[3]);

173  
	`u¨t_£nd_dma
(
UART_IDX
, 
pBuf
 + 4, 
Àn
);

174 
	}
}

177 
boﬁ
 
	$u¨t_tx_d⁄e
()

179  ((
myU¨tDrivî
.
°©us
 =
UART_STA_TX_DONE
Ë? 
TRUE
 : 
FALSE
);

180 
	}
}

182 
boﬁ
 
	$u¨t_is_idñ
()

184  ((
myU¨tDrivî
.
°©us
 =
UART_STA_IDLE
Ë? 
TRUE
 : 
FALSE
);

185 
	}
}

187 
u8
 
	$drv_u¨t_tx_°¨t
(
u8
 *
d©a
, 
u32
 
Àn
)

189 if(!
	`u¨t_is_idñ
()){

190 !
	`u¨t_tx_d⁄e
());

193 if(!
u¨tDrvTxBuf
){

194 
u¨tDrvTxBuf
 = (
u8
 *)
	`ev_buf_Æloˇã
(
Àn
 + 4);

195 if(
u¨tDrvTxBuf
){

196 
myU¨tDrivî
.
°©us
 = 
UART_STA_TX_DOING
;

197 
u¨tDrvTxBuf
[0] = (
u8
)(
Àn
);

198 
u¨tDrvTxBuf
[1] = (
u8
)(
Àn
 >> 8);

199 
u¨tDrvTxBuf
[2] = (
u8
)(
Àn
 >> 16);

200 
u¨tDrvTxBuf
[3] = (
u8
)(
Àn
 >> 24);

201 
	`mem˝y
(
u¨tDrvTxBuf
 + 4, 
d©a
, 
Àn
);

202 if(
myU¨tDrivî
.
£nd
){

203 !
myU¨tDrivî
.
	`£nd
(
u¨tDrvTxBuf
));

209 
	}
}

211 
	$drv_u¨t_ex˚±i⁄Pro˚ss
()

213 #if 
	`deföed
(
MCU_CORE_826x
)

214 
	`u¨t_Eº‹CLR
();

215 #ñi‡
	`deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

216 if(
	`u¨t_is_∑rôy_îr‹
()){

217 
	`u¨t_˛ór_∑rôy_îr‹
();

219 #ñi‡
	`deföed
(
MCU_CORE_B91
)

222 
	}
}

	@proj/drivers/drv_uart.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

28 
	#UART_CLOCK_SOURCE
 
CLOCK_SYS_CLOCK_HZ


	)

29 #ñi‡
deföed
(
MCU_CORE_B91
)

31 
	#UART_CLOCK_SOURCE
 (
sys_˛k
.
p˛k
 * 1000 * 1000)

	)

35 
	mUART_STA_IDLE
,

36 
	mUART_STA_TX_DOING
,

37 
	mUART_STA_TX_DONE
,

38 
	mUART_STA_RX_DONE
,

41 (*
	tu¨t_úq_ˇŒback
)();

42 
	$u8
 (*
	tu¨t_d©a_£nd
)(
	tu8
 *
	td©a
);

45 
u¨t_úq_ˇŒback
 
ªcvCb
;

46 
u¨t_d©a_£nd
 
£nd
;

47 vﬁ©ûê
u8
 
°©us
;

48 }
	tdrv_u¨t_t
;

59 
	`drv_u¨t_pö_£t
(
u32
 
txPö
, u32 
rxPö
);

71 
	`drv_u¨t_öô
(
u32
 
baudR©e
, 
u8
 *
rxBuf
, 
u16
 
rxBufLí
, 
u¨t_úq_ˇŒback
 
u¨tRecvCb
);

77 
	`drv_u¨t_rx_úq_h™dÀr
();

83 
	`drv_u¨t_tx_úq_h™dÀr
();

93 
u8
 
	`drv_u¨t_tx_°¨t
(u8 *
d©a
, 
u32
 
Àn
);

99 
	`drv_u¨t_ex˚±i⁄Pro˚ss
();

	@proj/drivers/drv_usb.h

24 #¥agm®
⁄˚


26 #i‡
deföed
(
MCU_CORE_826x
Ë|| deföed(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
)

28 
ölöe
 
u8
 
	$usb_is_úq_ª£t
(){

29  
ªg_úq_§c
 & 
FLD_IRQ_USB_RST_EN
;

30 
	}
}

32 
ölöe
 
	$usb_˛ór_úq_ª£t
(){

33 
ªg_úq_§c
 = 
FLD_IRQ_USB_RST_EN
;

34 
	}
}

36 #ñi‡
deföed
(
MCU_CORE_B91
)

38 
ölöe
 
u8
 
	$usb_is_úq_ª£t
() {

39  
ªg_usb_úq_mask
 & 
USB_IRQ_RESET_STATUS
;

40 
	}
}

42 
ölöe
 
	$usb_˛ór_úq_ª£t
() {

43 
ªg_usb_úq_mask
 |
USB_IRQ_RESET_STATUS
;

44 
	}
}

46 
ölöe
 
	$usb_edp_í
() {

47 
	`usbhw_£t_ïs_í
–
FLD_USB_EDP8_EN
 |

48 
FLD_USB_EDP1_EN
 |

49 
FLD_USB_EDP2_EN
 |

50 
FLD_USB_EDP3_EN
 |

51 
FLD_USB_EDP4_EN
 |

52 
FLD_USB_EDP5_EN
 |

53 
FLD_USB_EDP6_EN
 |

54 
FLD_USB_EDP7_EN
 );

55 
	`usbhw_£t_úq_mask
(
USB_IRQ_RESET_MASK
 | 
USB_IRQ_SUSPEND_MASK
);

56 
	}
}

	@proj/drivers/usb/app/usbcdc.c

24 
	~"usbcdc.h
"

26 #i‡(
USB_CDC_ENABLE
)

28 
cdc_˘æ_t
 
	gcdc_vs
;

29 
cdc_˘æ_t
 *
	gcdc_v
 = &
cdc_vs
;

31 
USB_CœssInfo_CDC_Devi˚_t
 
	gVútuÆSîül_CDC_I¡îÁ˚
 =

37 
CDC_TX_EPNUM
,

38 
CDC_TXRX_EPSIZE
,

39 
Ál£
,

41 
CDC_RX_EPNUM
,

42 
CDC_TXRX_EPSIZE
,

43 
Ál£
,

45 
CDC_NOTIFICATION_EPNUM
,

46 
CDC_NOTIFICATION_EPSIZE
,

47 
Ál£
,

51 
USB_CœssInfo_CDC_Devi˚_t
 *
	gCDCI¡îÁ˚Info
 = &
VútuÆSîül_CDC_I¡îÁ˚
;

54 
	$usbcdc_wrôe32
(
u32
 
vÆue
)

56 
	`usbhw_wrôe_˘æ_ï_d©a
(
vÆue
 & 0xff);

57 
	`usbhw_wrôe_˘æ_ï_d©a
((
vÆue
 >> 8) & 0xff);

58 
	`usbhw_wrôe_˘æ_ï_d©a
((
vÆue
 >> 16) & 0xff);

59 
	`usbhw_wrôe_˘æ_ï_d©a
((
vÆue
 >> 24) & 0xff);

60 
	}
}

62 
	$usbcdc_ªad32
(
u32
 *
vÆue
)

64 
u32
 
ãmp
 = 0;

65 *
vÆue
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

67 
ãmp
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

68 *
vÆue
 = (
ãmp
 << 8) | (*value);

69 
ãmp
 = 0;

71 
ãmp
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

72 *
vÆue
 = (
ãmp
 << 16) | (*value);

73 
ãmp
 = 0;

75 
ãmp
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

76 *
vÆue
 = (
ãmp
 << 24) | (*value);

77 
	}
}

88 
	$usbcdc_¥o˚ssC⁄åﬁReque°
(
u8
 
bReque°
, 
u16
 
wVÆue
, u16 
wIndex
, u16 
wLígth
)

90 if(
wIndex
 !
CDCI¡îÁ˚Info
->
C⁄fig
.
C⁄åﬁI¡îÁ˚Numbî
)

93 
bReque°
){

94 
CDC_REQ_GëLöeEncodög
:

95 
	`usbcdc_wrôe32
(
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
BaudR©eBPS
);

96 
	`usbhw_wrôe_˘æ_ï_d©a
(
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
Ch¨F‹m©
);

97 
	`usbhw_wrôe_˘æ_ï_d©a
(
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
P¨ôyTy≥
);

98 
	`usbhw_wrôe_˘æ_ï_d©a
(
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
D©aBôs
);

100 
CDC_REQ_SëLöeEncodög
:

101 
	`usbcdc_ªad32
(&
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
BaudR©eBPS
);

102 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
Ch¨F‹m©
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

103 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
P¨ôyTy≥
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

104 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
D©aBôs
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

106 
CDC_REQ_SëC⁄åﬁLöeSèã
:

107 
CDCI¡îÁ˚Info
->
Sèã
.
C⁄åﬁLöeSèãs
.
Ho°ToDevi˚
 = 
wVÆue
;

109 
CDC_REQ_SídBªak
:

112 
	}
}

115 
u8
 
	$usbcdc_isAvaûabÀ
()

117  (
cdc_v
->
txBuf
 =
NULL
);

118 
	}
}

120 
u8
 
	$usbcdc_isTxBusy
()

122  
	`usbhw_is_ï_busy
(
CDC_TX_EPNUM
);

123 
	}
}

130 
	$usbcdc_öô
()

133 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
BaudR©eBPS
 = 115200;

134 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
Ch¨F‹m©
 = 
CDC_LINEENCODING_O√St›Bô
;

135 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
P¨ôyTy≥
 = 
CDC_PARITY_N⁄e
;

136 
CDCI¡îÁ˚Info
->
Sèã
.
LöeEncodög
.
D©aBôs
 = 8;

138 
cdc_v
->
œ°Index
 = 0;

139 
	}
}

146 
	$usbcdc_£tRxBuf
(
u8
 *
buf
)

148 
cdc_v
->
rxBuf
 = 
buf
;

149 
	}
}

157 
	$usbcdc_£tCb
(
cdc_h™dÀrFn_t
 
rxFunc
, cdc_h™dÀrFn_à
txCb
)

159 
cdc_v
->
rxCb
 = 
rxFunc
;

160 
cdc_v
->
txCb
 =ÅxCb;

161 
	}
}

163 
s32
 
	$usbcdc_ªcvTimeoutCb
(*
¨g
)

165 
u8
 *
p
;

167 
cdc_v
->
œ°Index
 = 0;

170 
p
 = 
cdc_v
->
rxBuf
;

171 
cdc_v
->
rxBuf
 = 
NULL
;

174 if(
cdc_v
->
rxCb
){

175 
cdc_v
->
	`rxCb
(
p
);

178 
cdc_v
->
timî
 = 
NULL
;

180 
	}
}

182 
	$usbcdc_ªcvD©a
()

184 
u8
 
i
;

185 
u8
 *
p
;

186 
u8
 
Àn
;

187 
u8
 
fEnd
 = 0;

190 if(!
cdc_v
->
rxBuf
){

194 if(
cdc_v
->
timî
){

195 
	`TL_ZB_TIMER_CANCEL
(&
cdc_v
->
timî
);

198 
Àn
 = 
	`ªg_usb_ï_±r
(
CDC_RX_EPNUM
 & 0x07);

199 
fEnd
 = (
Àn
 =
CDC_TXRX_EPSIZE
) ? 0 : 1;

200 
	`usbhw_ª£t_ï_±r
(
CDC_RX_EPNUM
);

202 
i
 = 0; i < 
Àn
; i++){

203 
cdc_v
->
rxBuf
[cdc_v->
œ°Index
++] = 
	`usbhw_ªad_ï_d©a
(
CDC_RX_EPNUM
);

206 if(
fEnd
){

207 
cdc_v
->
œ°Index
 = 0;

210 
p
 = 
cdc_v
->
rxBuf
;

211 
cdc_v
->
rxBuf
 = 
NULL
;

214 if(
cdc_v
->
rxCb
){

215 
cdc_v
->
	`rxCb
(
p
);

218 
cdc_v
->
timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
usbcdc_ªcvTimeoutCb
, 
NULL
, 20);

220 
	}
}

227 
u8
 
	$usbcdc_£ndBulkD©a
()

229 
u16
 
Àn
;

232 if(
	`usbhw_is_ï_busy
(
CDC_TX_EPNUM
)){

238 
Àn
 = (
cdc_v
->
ÀnToSíd
 > 
CDC_TXRX_EPSIZE
) ? CDC_TXRX_EPSIZE : cdc_v->lenToSend;

239 
cdc_v
->
ÀnToSíd
 -
Àn
;

241 if(
Àn
 == 0){

245 
	`ªg_usb_ï_±r
(
CDC_TX_EPNUM
) = 0;

248 
	`f‹óch
(
i
, 
Àn
){

249 
	`ªg_usb_ï_d©
(
CDC_TX_EPNUM
Ë
cdc_v
->
txBuf
->
d©a
[cdc_v->
œ°SídIndex
++];

253 
	`ªg_usb_ï_˘æ
(
CDC_TX_EPNUM
Ë
FLD_EP_DAT_ACK
;

254 
u16
 
t
 = 0;

255 
	`usbhw_is_ï_busy
(
CDC_TX_EPNUM
)){

256 if(
t
++ > 10000){

257 
	`ªg_usb_ï_˘æ
(
CDC_TX_EPNUM
) &= 0xfe;

262 if(
cdc_v
->
ÀnToSíd
 == 0){

263 
cdc_v
->
ÀnToSíd
 = 0;

264 
cdc_v
->
œ°SídIndex
 = 0;

266 if(
cdc_v
->
txCb
){

268 
cdc_v
->
	`txCb
((
u8
 *)cdc_v->
txBuf
);

271 
cdc_v
->
txBuf
 = 
NULL
;

274  
Àn
;

275 
	}
}

283 
usbcdc_°s_t
 
	$usbcdc_£ndD©a
(
usbcdc_txBuf_t
 *
txBuf
)

285 if(
cdc_v
->
txBuf
){

286  
USB_CDC_BUSY
;

290 
cdc_v
->
ÀnToSíd
 = 
txBuf
->
Àn
;

291 
cdc_v
->
txBuf
 =ÅxBuf;

292 
cdc_v
->
œ°SídIndex
 = 0;

295 
	`usbcdc_£ndBulkD©a
();

297 
	`usbhw_d©a_ï_ack
(
CDC_RX_EPNUM
);

299  
USB_CDC_SUCCESS
;

300 
	}
}

302 
u8
 
	$usbWrôeByã
(
u8
 
byã
){

303 if(
	`usbhw_is_ï_busy
(
CDC_TX_EPNUM
)){

307 
	`ªg_usb_ï_±r
(
CDC_TX_EPNUM
) = 0;

308 
	`ªg_usb_ï_d©
(
CDC_TX_EPNUM
Ë
byã
;

310 
	`ªg_usb_ï_˘æ
(
CDC_TX_EPNUM
Ë
FLD_EP_DAT_ACK
;

311 
u16
 
t
 = 0;

312 
	`usbhw_is_ï_busy
(
CDC_TX_EPNUM
)){

313 if(
t
++ > 10000){

314 
	`ªg_usb_ï_˘æ
(
CDC_TX_EPNUM
) &= 0xfe;

318 
	}
}

320 
	$usbcdc_d©aH™dÀr
()

322 
u32
 
úq
 = 
	`usbhw_gë_ïs_úq
();

324 if(
úq
 & 
	`BIT
((
CDC_RX_EPNUM
 & 0x07))){

325 
	`usbhw_˛r_ïs_úq
(
	`BIT
((
CDC_RX_EPNUM
 & 0x07)));

327 
	`usbcdc_ªcvD©a
();

329 
	`usbhw_d©a_ï_ack
(
CDC_RX_EPNUM
);

332 if(
úq
 & 
	`BIT
((
CDC_TX_EPNUM
 & 0x07))){

333 
	`usbhw_˛r_ïs_úq
(
	`BIT
((
CDC_TX_EPNUM
 & 0x07)));

335 if(
	`usbcdc_£ndBulkD©a
()){

336 
	`usbhw_d©a_ï_ack
(
CDC_RX_EPNUM
);

339 
	}
}

	@proj/drivers/usb/app/usbcdc.h

24 #¥agm®
⁄˚


26 
	~"../usbdesc.h
"

29 #i‡
deföed
(
__˝lu•lus
)

34 (*
cdc_h™dÀrFn_t
)(
	tu8
 *
	tpD©a
);

37 
u16
 
Àn
;

38 
u8
 
d©a
[1];

39 } 
	tusbcdc_txBuf_t
;

42 
u8
 *
rxBuf
;

43 
usbcdc_txBuf_t
 *
txBuf
;

46 
ev_timî_evít_t
 *
timî
;

48 
cdc_h™dÀrFn_t
 
rxCb
;

49 
cdc_h™dÀrFn_t
 
txCb
;

51 
u16
 
ÀnToSíd
;

52 
u16
 
œ°SídIndex
;

53 
u8
 
œ°Index
;

54 } 
	tcdc_˘æ_t
;

56 
	eusbcdc_°s_e
 {

57 
USB_CDC_SUCCESS
 = 0,

58 
USB_CDC_BUSY
 = 1,

59 
USB_CDC_MULTIBLOCK
,

60 } 
	tusbcdc_°s_t
;

72 
usbcdc_¥o˚ssC⁄åﬁReque°
(
u8
 
bReque°
, 
u16
 
wVÆue
, u16 
wIndex
, u16 
wLígth
);

79 
usbcdc_d©aH™dÀr
();

86 
usbcdc_öô
();

94 
usbcdc_£tCb
(
cdc_h™dÀrFn_t
 
rxFunc
, cdc_h™dÀrFn_à
txCb
);

101 
usbcdc_£tRxBuf
(
u8
 *
buf
);

108 
u8
 
usbWrôeByã
(u8 
byã
);

116 
usbcdc_°s_t
 
usbcdc_£ndD©a
(
usbcdc_txBuf_t
 *
txBuf
);

123 
u8
 
usbcdc_isAvaûabÀ
();

130 
u8
 
usbcdc_isTxBusy
();

135 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/app/usbkb.c

24 
	~"usbkb.h
"

26 #i‡(
MODULE_KEYBOARD_ENABLE
)

28 
u8
 
	$usbkb_hid_ªp‹t_n‹mÆ
(
u8
 
˘æ_key
, u8 *
keycode
){

29 if(
	`usbhw_is_ï_busy
(
USB_EDP_KEYBOARD_IN
))

32 
	`ªg_usb_ï_±r
(
USB_EDP_KEYBOARD_IN
) = 0;

35 
	`ªg_usb_ï_d©
(
USB_EDP_KEYBOARD_IN
Ë
˘æ_key
;

36 
	`ªg_usb_ï_d©
(
USB_EDP_KEYBOARD_IN
) = 0;

37 
	`f‹óch
(
i
, 
KEYBOARD_REPORT_KEY_MAX
){

38 
	`ªg_usb_ï_d©
(
USB_EDP_KEYBOARD_IN
Ë
keycode
[
i
];

40 
	`ªg_usb_ï_˘æ
(
USB_EDP_KEYBOARD_IN
Ë
FLD_EP_DAT_ACK
;

42 
	}
}

	@proj/drivers/usb/app/usbkb.h

24 #¥agm®
⁄˚


26 
	~"usbkb_i.h
"

29 #i‡
deföed
(
__˝lu•lus
)

33 
	#KEYBOARD_REPORT_KEY_MAX
 6

	)

36 
u8
 
usbkb_hid_ªp‹t_n‹mÆ
(u8 
˘æ_key
, u8 *
keycode
);

40 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/app/usbkb_i.h

24 #¥agm®
⁄˚


26 
	~"../usbdesc.h
"

28 #i‡(
USB_KEYBOARD_ENABLE
)

36 c⁄° 
USB_Des¸ùt‹_HIDRï‹t_D©©y≥_t
 
	gkeybﬂrd_ªp‹t_desc
[] = {

37 
HID_DESCRIPTOR_KEYBOARD
(
KEYBOARD_REPORT_KEY_MAX
),

40 
ölöe
 
u8
 *
	$usbkb_gë_ªp‹t_desc
(){

41  (
u8
 *)(
keybﬂrd_ªp‹t_desc
);

42 
	}
}

44 
ölöe
 
u16
 
	$usbkb_gë_ªp‹t_desc_size
(){

45  (
u16
)((
keybﬂrd_ªp‹t_desc
));

46 
	}
}

	@proj/drivers/usb/app/usbmouse.c

24 
	~"usbmou£.h
"

26 #i‡(
USB_MOUSE_ENABLE
)

28 
u8
 
	$usbmou£_hid_ªp‹t
(
u8
 
ªp‹t_id
, u8 *
d©a
, 
˙t
){

29 if(!
ªg_usb_ho°_c⁄n
){

30 
	`ªg_usb_ï_˘æ
(
USB_EDP_MOUSE
) = 0;

34 if(
	`usbhw_is_ï_busy
(
USB_EDP_MOUSE
))

37 
	`ªg_usb_ï_±r
(
USB_EDP_MOUSE
) = 0;

40 
u8
 
usb_mou£_ªp‹t_¥Ÿo
;

42 if(!
usb_mou£_ªp‹t_¥Ÿo
){

43 
	`ªg_usb_ï_d©
(
USB_EDP_MOUSE
Ë
d©a
[0];

44 
	`ªg_usb_ï_d©
(
USB_EDP_MOUSE
Ë
d©a
[1];

45 
	`ªg_usb_ï_d©
(
USB_EDP_MOUSE
Ë
d©a
[2];

47 
	`ªg_usb_ï_d©
(
USB_EDP_MOUSE
Ë
ªp‹t_id
;

48 
	`f‹óch
(
i
, 
˙t
){

49 
	`ªg_usb_ï_d©
(
USB_EDP_MOUSE
Ë
d©a
[
i
];

53 
	`ªg_usb_ï_˘æ
(
USB_EDP_MOUSE
Ë
FLD_EP_DAT_ACK
;

56 
	}
}

	@proj/drivers/usb/app/usbmouse.h

24 #¥agm®
⁄˚


26 
	~"usbmou£_i.h
"

29 #i‡
deföed
(
__˝lu•lus
)

35 
u8
 
usbmou£_hid_ªp‹t
(u8 
ªp‹t_id
, u8 *
d©a
, 
˙t
);

38 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/app/usbmouse_i.h

24 #¥agm®
⁄˚


26 
	~"../usbdesc.h
"

28 #i‡(
USB_MOUSE_ENABLE
)

41 c⁄° 
USB_Des¸ùt‹_HIDRï‹t_D©©y≥_t
 
	gmou£_ªp‹t_desc
[] = {

45 0x85, 
USB_HID_MOUSE
,

82 #i‡(
ONEKEY_WEB
==0)

87 0x85,
USB_HID_KB_MEDIA
,

92 #i‡
CHIP_EOP_ERROR


105 0x85,
USB_HID_KB_SYS
,

121 
HID_RI_USAGE_PAGE
(8, 0x01),

132 
HID_RI_END_COLLECTION
(0),

135 
ölöe
 
u8
 *
	$usbmou£_gë_ªp‹t_desc
(){

136  (
u8
 *)(
mou£_ªp‹t_desc
);

137 
	}
}

139 
ölöe
 
u16
 
	$usbmou£_gë_ªp‹t_desc_size
(){

140  (
u16
)((
mou£_ªp‹t_desc
));

141 
	}
}

	@proj/drivers/usb/app/usbvendor.c

24 
	~"usbvíd‹.h
"

26 #i‡(
USB_VENDOR_ENABLE
)

28 
hidvíd‹_˘æ_t
 
	ghidvíd‹_vs
;

29 
hidvíd‹_˘æ_t
 *
	ghidvíd‹_v
 = &
hidvíd‹_vs
;

37 
	$hidvíd‹_öô
()

39 
hidvíd‹_v
->
œ°Index
 = 0;

40 
	}
}

42 
u8
 
	$hidvíd‹_isAvaûabÀ
()

44  (
hidvíd‹_v
->
txBuf
 =
NULL
);

45 
	}
}

47 
u8
 
	$hidvíd‹_isTxBusy
()

49  
	`usbhw_is_ï_busy
(
USB_EDP_HID_VENDOR_IN
);

50 
	}
}

57 
	$hidvíd‹_£tRxBuf
(
u8
 *
buf
)

59 
hidvíd‹_v
->
rxBuf
 = 
buf
;

60 
	}
}

68 
	$hidvíd‹_£tCb
(
hidvíd‹_h™dÀrFn_t
 
rxFunc
, hidvíd‹_h™dÀrFn_à
txCb
)

70 
hidvíd‹_v
->
rxCb
 = 
rxFunc
;

71 
hidvíd‹_v
->
txCb
 =ÅxCb;

72 
	}
}

74 
s32
 
	$hidvíd‹_ªcvTimeoutCb
(*
¨g
)

76 
u8
 *
p
;

78 
hidvíd‹_v
->
œ°Index
 = 0;

81 
p
 = 
hidvíd‹_v
->
rxBuf
;

82 
hidvíd‹_v
->
rxBuf
 = 
NULL
;

85 if(
hidvíd‹_v
->
rxCb
){

86 
hidvíd‹_v
->
	`rxCb
(
p
);

89 
hidvíd‹_v
->
timî
 = 
NULL
;

91 
	}
}

93 
	$hidvíd‹_ªcvD©a
()

95 
u8
 
i
;

96 
u8
 *
p
;

97 
u8
 
Àn
;

98 
u8
 
fEnd
 = 0;

101 if(!
hidvíd‹_v
->
rxBuf
){

105 if(
hidvíd‹_v
->
timî
){

106 
	`TL_ZB_TIMER_CANCEL
(&
hidvíd‹_v
->
timî
);

109 
Àn
 = 
	`ªg_usb_ï_±r
(
USB_EDP_HID_VENDOR_OUT
 & 0x07);

110 
fEnd
 = (
Àn
 =
HID_VENDOR_TXRX_EPSIZE
) ? 0 : 1;

111 
	`usbhw_ª£t_ï_±r
(
USB_EDP_HID_VENDOR_OUT
);

113 
i
 = 0; i < 
Àn
; i++){

114 
hidvíd‹_v
->
rxBuf
[hidvíd‹_v->
œ°Index
++] = 
	`usbhw_ªad_ï_d©a
(
USB_EDP_HID_VENDOR_OUT
);

117 if(
fEnd
){

118 
hidvíd‹_v
->
œ°Index
 = 0;

121 
p
 = 
hidvíd‹_v
->
rxBuf
;

122 
hidvíd‹_v
->
rxBuf
 = 
NULL
;

125 if(
hidvíd‹_v
->
rxCb
){

126 
hidvíd‹_v
->
	`rxCb
(
p
);

129 
hidvíd‹_v
->
timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
hidvíd‹_ªcvTimeoutCb
, 
NULL
, 20);

131 
	}
}

138 
u8
 
	$hidvíd‹_£ndD©a
()

140 
u16
 
Àn
;

143 if(
	`usbhw_is_ï_busy
(
USB_EDP_HID_VENDOR_IN
)){

149 
Àn
 = (
hidvíd‹_v
->
ÀnToSíd
 > 
HID_VENDOR_TXRX_EPSIZE
) ? HID_VENDOR_TXRX_EPSIZE : hidvendor_v->lenToSend;

150 
hidvíd‹_v
->
ÀnToSíd
 -
Àn
;

152 if(
Àn
 == 0){

156 
	`ªg_usb_ï_±r
(
USB_EDP_HID_VENDOR_IN
) = 0;

159 
	`f‹óch
(
i
, 
Àn
){

160 
	`ªg_usb_ï_d©
(
USB_EDP_HID_VENDOR_IN
Ë
hidvíd‹_v
->
txBuf
->
d©a
[hidvíd‹_v->
œ°SídIndex
++];

164 
	`ªg_usb_ï_˘æ
(
USB_EDP_HID_VENDOR_IN
Ë
FLD_EP_DAT_ACK
;

165 
u16
 
t
 = 0;

166 
	`usbhw_is_ï_busy
(
USB_EDP_HID_VENDOR_IN
)){

167 if(
t
++ > 10000){

168 
	`ªg_usb_ï_˘æ
(
USB_EDP_HID_VENDOR_IN
) &= 0xfe;

173 if(
hidvíd‹_v
->
ÀnToSíd
 == 0){

174 
hidvíd‹_v
->
ÀnToSíd
 = 0;

175 
hidvíd‹_v
->
œ°SídIndex
 = 0;

177 if(
hidvíd‹_v
->
txCb
){

179 
hidvíd‹_v
->
	`txCb
((
u8
 *)hidvíd‹_v->
txBuf
);

182 
hidvíd‹_v
->
txBuf
 = 
NULL
;

185  
Àn
;

186 
	}
}

194 
hidvíd‹_°s_t
 
	$hidvíd‹_ªp‹tD©a
(
hidvíd‹_txBuf_t
 *
txBuf
)

196 if(
hidvíd‹_v
->
txBuf
){

197  
HID_VENDOR_BUSY
;

201 
hidvíd‹_v
->
ÀnToSíd
 = 
txBuf
->
Àn
;

202 
hidvíd‹_v
->
txBuf
 =ÅxBuf;

203 
hidvíd‹_v
->
œ°SídIndex
 = 0;

206 
	`hidvíd‹_£ndD©a
();

208 
	`usbhw_d©a_ï_ack
(
USB_EDP_HID_VENDOR_OUT
);

210  
HID_VENDOR_SUCCESS
;

211 
	}
}

213 
	$hidvíd‹_d©aH™dÀr
()

215 
u32
 
úq
 = 
	`usbhw_gë_ïs_úq
();

217 if(
úq
 & 
	`BIT
((
USB_EDP_HID_VENDOR_OUT
 & 0x07))){

218 
	`usbhw_˛r_ïs_úq
(
	`BIT
((
USB_EDP_HID_VENDOR_OUT
 & 0x07)));

220 
	`hidvíd‹_ªcvD©a
();

222 
	`usbhw_d©a_ï_ack
(
USB_EDP_HID_VENDOR_OUT
);

225 if(
úq
 & 
	`BIT
((
USB_EDP_HID_VENDOR_IN
 & 0x07))){

226 
	`usbhw_˛r_ïs_úq
(
	`BIT
((
USB_EDP_HID_VENDOR_IN
 & 0x07)));

228 if(
	`hidvíd‹_£ndD©a
()){

229 
	`usbhw_d©a_ï_ack
(
USB_EDP_HID_VENDOR_OUT
);

232 
	}
}

	@proj/drivers/usb/app/usbvendor.h

24 #¥agm®
⁄˚


26 
	~"usbvíd‹_i.h
"

29 #i‡
deföed
(
__˝lu•lus
)

34 (*
hidvíd‹_h™dÀrFn_t
)(
	tu8
 *
	tpD©a
);

37 
u16
 
Àn
;

38 
u8
 
d©a
[1];

39 } 
	thidvíd‹_txBuf_t
;

42 
u8
 *
rxBuf
;

43 
hidvíd‹_txBuf_t
 *
txBuf
;

46 
ev_timî_evít_t
 *
timî
;

48 
hidvíd‹_h™dÀrFn_t
 
rxCb
;

49 
hidvíd‹_h™dÀrFn_t
 
txCb
;

51 
u16
 
ÀnToSíd
;

52 
u16
 
œ°SídIndex
;

53 
u8
 
œ°Index
;

54 } 
	thidvíd‹_˘æ_t
;

56 
	ehidvíd‹_°s_e
 {

57 
HID_VENDOR_SUCCESS
 = 0,

58 
HID_VENDOR_BUSY
 = 1,

59 
HID_VENDOR_MULTIBLOCK
,

60 } 
	thidvíd‹_°s_t
;

67 
hidvíd‹_d©aH™dÀr
();

74 
hidvíd‹_öô
();

82 
hidvíd‹_£tCb
(
hidvíd‹_h™dÀrFn_t
 
rxFunc
, hidvíd‹_h™dÀrFn_à
txCb
);

89 
hidvíd‹_£tRxBuf
(
u8
 *
buf
);

97 
hidvíd‹_°s_t
 
hidvíd‹_ªp‹tD©a
(
hidvíd‹_txBuf_t
 *
txBuf
);

104 
u8
 
hidvíd‹_isAvaûabÀ
();

111 
u8
 
hidvíd‹_isTxBusy
();

114 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/app/usbvendor_i.h

24 #¥agm®
⁄˚


26 
	~"../usbdesc.h
"

28 #i‡(
USB_VENDOR_ENABLE
)

30 c⁄° 
u8
 
	gvíd‹_ªp‹t_desc
[] = {

31 
HID_DESCRIPTOR_VENDOR
(1, 4, 0, 1, 64),

34 
ölöe
 
u8
 *
	$usbvíd‹_gë_ªp‹t_desc
(){

35  (
u8
*)(
víd‹_ªp‹t_desc
);

36 
	}
}

38 
ölöe
 
u16
 
	$usbvíd‹_gë_ªp‹t_desc_size
(){

39  (
u16
)((
víd‹_ªp‹t_desc
));

40 
	}
}

	@proj/drivers/usb/usb.c

24 
	~"usbdesc.h
"

25 
	~"usb.h
"

26 
	~"usb_comm⁄.h
"

28 #i‡(
MODULE_USB_ENABLE
)

30 
USB_Reque°_Hódî_t
 
	gc⁄åﬁ_ªque°
;

31 
u8
 *
	gg_ª•⁄£
 = 0;

32 
u16
 
	gg_ª•⁄£_Àn
 = 0;

33 
u8
 
	gg_°Æl
 = 0;

34 
u8
 
	gg_øã
 = 0;

35 
u8
 
	gusb_mou£_ªp‹t_¥Ÿo
 = 0;

36 
u8
 
	gho°_keybﬂrd_°©us
;

39 
	$usb_£nd_ª•⁄£
(){

40 
u16
 
n
;

41 if(
g_ª•⁄£_Àn
 < 8){

42 
n
 = 
g_ª•⁄£_Àn
;

44 
n
 = 8;

46 
g_ª•⁄£_Àn
 -
n
;

48 
	`usbhw_ª£t_˘æ_ï_±r
();

49 
n
-- > 0){

50 
	`usbhw_wrôe_˘æ_ï_d©a
(*
g_ª•⁄£
);

51 ++
g_ª•⁄£
;

53 
	}
}

55 
	$usb_¥ï¨e_desc_d©a
(){

56 
u8
 
vÆue_l
 = (
c⁄åﬁ_ªque°
.
wVÆue
) & 0xff;

57 
u8
 
vÆue_h
 = (
c⁄åﬁ_ªque°
.
wVÆue
 >> 8) & 0xff;

59 
g_ª•⁄£
 = 0;

60 
g_ª•⁄£_Àn
 = 0;

62 
vÆue_h
){

63 
DTYPE_Devi˚
:

64 
g_ª•⁄£
 = 
	`usbdesc_gë_devi˚
();

65 
g_ª•⁄£_Àn
 = (
USB_Des¸ùt‹_Devi˚_t
);

67 
DTYPE_C⁄figuøti⁄
:

68 
g_ª•⁄£
 = 
	`usbdesc_gë_c⁄figuøti⁄
();

69 
g_ª•⁄£_Àn
 = (
USB_Des¸ùt‹_C⁄figuøti⁄_t
);

71 
DTYPE_Såög
:

72 if(
USB_STRING_LANGUAGE
 =
vÆue_l
){

73 
g_ª•⁄£
 = 
	`usbdesc_gë_œnguage
();

74 
g_ª•⁄£_Àn
 = (
LANGUAGE_ID_ENG
);

75 }if(
USB_STRING_VENDOR
 =
vÆue_l
){

76 
g_ª•⁄£
 = 
	`usbdesc_gë_víd‹
();

77 
g_ª•⁄£_Àn
 = (
STRING_VENDOR
);

78 }if(
USB_STRING_PRODUCT
 =
vÆue_l
){

79 
g_ª•⁄£
 = 
	`usbdesc_gë_¥odu˘
();

80 
g_ª•⁄£_Àn
 = (
STRING_PRODUCT
);

81 }if(
USB_STRING_SERIAL
 =
vÆue_l
){

82 
g_ª•⁄£
 = 
	`usbdesc_gë_£rül
();

83 
g_ª•⁄£_Àn
 = (
STRING_SERIAL
);

85 
g_°Æl
 = 1;

89 
g_°Æl
 = 1;

93 if(
c⁄åﬁ_ªque°
.
wLígth
 < 
g_ª•⁄£_Àn
){

94 
g_ª•⁄£_Àn
 = 
c⁄åﬁ_ªque°
.
wLígth
;

96 
	}
}

98 
	$usb_h™dÀ_°d_ötf_ªq
(){

99 
g_ª•⁄£
 = 0;

100 
g_ª•⁄£_Àn
 = 0;

102 
u8
 
vÆue_h
 = (
c⁄åﬁ_ªque°
.
wVÆue
 >> 8) & 0xff;

103 #i‡(
USB_MOUSE_ENABLE
 || 
USB_KEYBOARD_ENABLE
 || 
USB_VENDOR_ENABLE
 || 
USB_SOMATIC_ENABLE
)

104 
u8
 
ödex_l
 = (
c⁄åﬁ_ªque°
.
wIndex
) & 0xff;

107 
vÆue_h
){

108 
HID_DTYPE_HID
:

110 #i‡(
USB_MOUSE_ENABLE
 )

111 if(
ödex_l
 =
USB_INTF_MOUSE
){

113 
g_ª•⁄£
 = 
	`usbdesc_gë_mou£
();

114 
g_ª•⁄£_Àn
 = (
USB_HID_Des¸ùt‹_HID_Mou£_t
);

117 #i‡(
USB_KEYBOARD_ENABLE
)

118 if(
ödex_l
 =
USB_INTF_KEYBOARD
){

120 
g_ª•⁄£
 = 
	`usbdesc_gë_keybﬂrd
();

121 
g_ª•⁄£_Àn
 = (
USB_HID_Des¸ùt‹_HID_Keybﬂrd_t
);

124 #i‡(
USB_VENDOR_ENABLE
)

125 if(
ödex_l
 =
USB_INTF_HID_VENDOR
){

126 
g_ª•⁄£
 = 
	`usbvíd‹_gë_víd‹_desc
();

127 
g_ª•⁄£_Àn
 = (
USB_HID_Des¸ùt‹_HID_Víd‹_t
);

131 
HID_DTYPE_Rï‹t
:

132 #i‡(
USB_MOUSE_ENABLE
)

133 if(
ödex_l
 =
USB_INTF_MOUSE
){

135 
g_ª•⁄£
 = 
	`usbmou£_gë_ªp‹t_desc
();

136 
g_ª•⁄£_Àn
 = 
	`usbmou£_gë_ªp‹t_desc_size
();

139 #i‡(
USB_KEYBOARD_ENABLE
)

140 if(
ödex_l
 =
USB_INTF_KEYBOARD
){

142 
g_ª•⁄£
 = 
	`usbkb_gë_ªp‹t_desc
();

143 
g_ª•⁄£_Àn
 = 
	`usbkb_gë_ªp‹t_desc_size
();

146 #i‡(
USB_VENDOR_ENABLE
)

147 if(
ödex_l
 =
USB_INTF_HID_VENDOR
){

148 
g_ª•⁄£
 = 
	`usbvíd‹_gë_ªp‹t_desc
();

149 
g_ª•⁄£_Àn
 = 
	`usbvíd‹_gë_ªp‹t_desc_size
();

153 
HID_DTYPE_Physiˇl
:

159 if(
c⁄åﬁ_ªque°
.
wLígth
 < 
g_ª•⁄£_Àn
){

160 
g_ª•⁄£_Àn
 = 
c⁄åﬁ_ªque°
.
wLígth
;

162 
	}
}

164 
	$usb_h™dÀ_out_˛ass_ötf_ªq
(
u8
 
d©a_ªque°
){

165 
u8
 
¥›îty
 = 
c⁄åﬁ_ªque°
.
bReque°
;

166 
u8
 
vÆue_l
 = (
c⁄åﬁ_ªque°
.
wVÆue
) & 0xff;

167 
u8
 
vÆue_h
 = (
c⁄åﬁ_ªque°
.
wVÆue
 >> 8) & 0xff;

170 
¥›îty
){

171 
HID_REQ_SëRï‹t
:

172 
vÆue_h
){

173 
HID_REPORT_ITEM_In
:

175 
HID_REPORT_ITEM_Out
:

177 
HID_REPORT_ITEM_Fótuª
:

178 if(
d©a_ªque°
){

179 
ho°_keybﬂrd_°©us
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

182 
HID_REPORT_CUSTOM
:

185 
g_°Æl
 = 1;

189 
HID_REQ_SëIdÀ
:

190 if(
d©a_ªque°
){

191 
g_øã
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

193 
g_øã
 = 
vÆue_h
;

195 
HID_REQ_SëPrŸocﬁ
:

196 if(
d©a_ªque°
){

197 
usb_mou£_ªp‹t_¥Ÿo
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

199 
usb_mou£_ªp‹t_¥Ÿo
 = 
vÆue_l
;

201 #i‡(
USB_CDC_ENABLE
)

202 
CDC_REQ_SëC⁄åﬁLöeSèã
:

203 
CDC_REQ_SëLöeEncodög
:

204 
	`usbcdc_¥o˚ssC⁄åﬁReque°
(
c⁄åﬁ_ªque°
.
bReque°
, c⁄åﬁ_ªque°.
wVÆue
, c⁄åﬁ_ªque°.
wIndex
, c⁄åﬁ_ªque°.
wLígth
);

208 
g_°Æl
 = 1;

211 
	}
}

213 
	$usb_h™dÀ_ö_˛ass_ötf_ªq
(){

214 
u8
 
¥›îty
 = 
c⁄åﬁ_ªque°
.
bReque°
;

218 
¥›îty
){

219 
CDC_REQ_SídEnˇpsuœãdComm™d
:

220 
	`usbhw_wrôe_˘æ_ï_d©a
(0x00);

222 
HID_REQ_GëRï‹t
:

224 
HID_REQ_GëIdÀ
:

225 
	`usbhw_wrôe_˘æ_ï_d©a
(
g_øã
);

227 
HID_REQ_GëPrŸocﬁ
:

228 
	`usbhw_wrôe_˘æ_ï_d©a
(
usb_mou£_ªp‹t_¥Ÿo
);

230 #i‡(
USB_CDC_ENABLE
)

231 
CDC_REQ_GëLöeEncodög
:

232 
	`usbcdc_¥o˚ssC⁄åﬁReque°
(
c⁄åﬁ_ªque°
.
bReque°
, c⁄åﬁ_ªque°.
wVÆue
, c⁄åﬁ_ªque°.
wIndex
, c⁄åﬁ_ªque°.
wLígth
);

236 
g_°Æl
 = 1;

239 
	}
}

241 
	$usb_h™dÀ_ö_˛ass_ídp_ªq
(){

244 
	}
}

246 
	$usb_h™dÀ_out_˛ass_ídp_ªq
(
u8
 
d©a_ªque°
){

248 
	}
}

250 
	$usb_h™dÀ_£t_ötf
(){

252 
	}
}

254 
	$usb_h™dÀ_gë_ötf
(){

256 
	}
}

258 
	$usb_h™dÀ_ªque°
(
u8
 
d©a_ªque°
){

259 
u8
 
bmReque°Ty≥
 = 
c⁄åﬁ_ªque°
.bmRequestType;

260 
u8
 
bReque°
 = 
c⁄åﬁ_ªque°
.bRequest;

262 
	`usbhw_ª£t_˘æ_ï_±r
();

264 
bmReque°Ty≥
){

265 (
REQDIR_DEVICETOHOST
 | 
REQTYPE_STANDARD
 | 
REQREC_DEVICE
):

266 if(
REQ_GëDes¸ùt‹
 =
bReque°
){

267 if(
USB_IRQ_SETUP_REQ
 =
d©a_ªque°
){

268 
	`usb_¥ï¨e_desc_d©a
();

270 
	`usb_£nd_ª•⁄£
();

273 (
REQDIR_DEVICETOHOST
 | 
REQTYPE_STANDARD
 | 
REQREC_INTERFACE
):

274 if(
REQ_GëDes¸ùt‹
 =
bReque°
){

275 if(
USB_IRQ_SETUP_REQ
 =
d©a_ªque°
){

276 
	`usb_h™dÀ_°d_ötf_ªq
();

278 
	`usb_£nd_ª•⁄£
();

279 }if(
REQ_GëI¡îÁ˚
 =
bReque°
){

280 
	`usb_h™dÀ_gë_ötf
();

283 (
REQDIR_HOSTTODEVICE
 | 
REQTYPE_CLASS
 | 
REQREC_INTERFACE
):

284 
	`usb_h™dÀ_out_˛ass_ötf_ªq
(
d©a_ªque°
);

286 (
REQDIR_HOSTTODEVICE
 | 
REQTYPE_CLASS
 | 
REQREC_ENDPOINT
):

287 
	`usb_h™dÀ_out_˛ass_ídp_ªq
(
d©a_ªque°
);

289 (
REQDIR_DEVICETOHOST
 | 
REQTYPE_CLASS
 | 
REQREC_INTERFACE
):

290 
	`usb_h™dÀ_ö_˛ass_ötf_ªq
();

292 (
REQDIR_DEVICETOHOST
 | 
REQTYPE_CLASS
 | 
REQREC_ENDPOINT
):

293 
	`usb_h™dÀ_ö_˛ass_ídp_ªq
();

295 (
REQDIR_HOSTTODEVICE
 | 
REQTYPE_STANDARD
 | 
REQREC_INTERFACE
):

296 if(
REQ_SëI¡îÁ˚
 =
bReque°
){

297 
	`usb_h™dÀ_£t_ötf
();

300 #i‡(
__PROJECT_TL_SNIFFER__
)

301 (
REQDIR_DEVICETOHOST
 | 
REQTYPE_VENDOR
 | 
REQREC_DEVICE
):

302 
	`usbSnif„r_¥o˚ssC⁄åﬁReque°
(
bmReque°Ty≥
, 
d©a_ªque°
, 
bReque°
, 0);

304 (
REQDIR_HOSTTODEVICE
 | 
REQTYPE_VENDOR
 | 
REQREC_DEVICE
):

305 
	`usbSnif„r_¥o˚ssC⁄åﬁReque°
(
bmReque°Ty≥
, 
d©a_ªque°
, 
bReque°
, 
c⁄åﬁ_ªque°
.
wIndex
);

309 
g_°Æl
 = 1;

312 
	}
}

314 
	$usb_h™dÀ_˘l_ï_£tup
(){

315 
	`usbhw_ª£t_˘æ_ï_±r
();

316 
c⁄åﬁ_ªque°
.
bmReque°Ty≥
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

317 
c⁄åﬁ_ªque°
.
bReque°
 = 
	`usbhw_ªad_˘æ_ï_d©a
();

318 
c⁄åﬁ_ªque°
.
wVÆue
 = 
	`usbhw_ªad_˘æ_ï_u16
();

319 
c⁄åﬁ_ªque°
.
wIndex
 = 
	`usbhw_ªad_˘æ_ï_u16
();

320 
c⁄åﬁ_ªque°
.
wLígth
 = 
	`usbhw_ªad_˘æ_ï_u16
();

321 
g_°Æl
 = 0;

322 
	`usb_h™dÀ_ªque°
(
USB_IRQ_SETUP_REQ
);

323 if(
g_°Æl
){

324 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_DAT_STALL
);

326 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_DAT_ACK
);

328 
	}
}

330 
	$usb_h™dÀ_˘l_ï_d©a
(){

331 
	`usbhw_ª£t_˘æ_ï_±r
();

332 
g_°Æl
 = 0;

333 
	`usb_h™dÀ_ªque°
(
USB_IRQ_DATA_REQ
);

334 if(
g_°Æl
){

335 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_DAT_STALL
);

337 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_DAT_ACK
);

339 
	}
}

341 
	$usb_h™dÀ_˘l_ï_°©us
(){

342 if(
g_°Æl
){

343 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_STA_STALL
);

345 
	`usbhw_wrôe_˘æ_ï_˘æ
(
FLD_EP_STA_ACK
);

347 
	}
}

354 
	$usb_h™dÀ_úq
(){

355 
u32
 
úq
 = 
	`usbhw_gë_˘æ_ï_úq
();

357 if(
úq
 & 
FLD_CTRL_EP_IRQ_SETUP
){

358 
	`usbhw_˛r_˘æ_ï_úq
(
FLD_CTRL_EP_IRQ_SETUP
);

359 
	`usb_h™dÀ_˘l_ï_£tup
();

361 if(
úq
 & 
FLD_CTRL_EP_IRQ_DATA
){

362 
	`usbhw_˛r_˘æ_ï_úq
(
FLD_CTRL_EP_IRQ_DATA
);

363 
	`usb_h™dÀ_˘l_ï_d©a
();

365 if(
úq
 & 
FLD_CTRL_EP_IRQ_STA
){

366 
	`usbhw_˛r_˘æ_ï_úq
(
FLD_CTRL_EP_IRQ_STA
);

367 
	`usb_h™dÀ_˘l_ï_°©us
();

369 if(
	`usb_is_úq_ª£t
()){

370 
usb_mou£_ªp‹t_¥Ÿo
 = 1;

371 
	`usb_˛ór_úq_ª£t
();

372 
i
 = 0; i < 8; i++){

373 
	`ªg_usb_ï_˘æ
(
i
) = 0;

375 #i‡(
USB_CDC_ENABLE
)

376 
	`usbhw_d©a_ï_ack
(
CDC_RX_EPNUM
);

380 #i‡(
__PROJECT_TL_SNIFFER__
)

381 
g_°Æl
 = 0;

384 #i‡(
USB_CDC_ENABLE
)

385 
g_°Æl
 = 0;

386 
	`usbcdc_d©aH™dÀr
();

389 #i‡(
USB_VENDOR_ENABLE
)

390 
	`hidvíd‹_d©aH™dÀr
();

392 
	}
}

394 
	$usb_öô_öãºu±
(){

395 
	`usbhw_íabÀ_m™uÆ_öãºu±
(
FLD_CTRL_EP_AUTO_STD
 | 
FLD_CTRL_EP_AUTO_DESC
);

397 #i‡(
USB_CDC_ENABLE
)

399 
	`usbhw_˛r_ïs_úq_mask
(
	`BIT
(
CDC_TX_EPNUM
 & 0x07Ë| BIT(
CDC_RX_EPNUM
 & 0x07));

400 
	`usbhw_d©a_ï_ack
(
CDC_RX_EPNUM
);

403 #i‡(
USB_VENDOR_ENABLE
)

405 
	`usbhw_˛r_ïs_úq_mask
(
	`BIT
(
USB_EDP_HID_VENDOR_IN
 & 0x07Ë| BIT(
USB_EDP_HID_VENDOR_OUT
 & 0x07));

406 
	`usbhw_d©a_ï_ack
(
USB_EDP_HID_VENDOR_OUT
);

408 
	}
}

415 
	$usb_öô
(){

417 
	`usb_öô_öãºu±
();

418 
	}
}

	@proj/drivers/usb/usb.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

32 
USB_TIME_BEFORE_ALLOW_SUSPEND
 = (3000*1000),

36 
USB_IRQ_SETUP_REQ
 = 0,

37 
USB_IRQ_DATA_REQ
,

42 
USB_REPORT_NO_EVENT
 = 0xf0,

43 
USB_REPORT_RELEASE
 = 0xff,

51 
usb_öô
();

58 
usb_h™dÀ_úq
();

62 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usb_common.h

24 #¥agm®
⁄˚


26 
	~"usb.h
"

28 
	~"≠p/usbcdc.h
"

29 
	~"≠p/usbmou£.h
"

30 
	~"≠p/usbkb.h
"

31 
	~"≠p/usbvíd‹.h
"

32 #i‡(
__PROJECT_TL_SNIFFER__
)

33 
	~"≠p/usb¢if„r.h
"

	@proj/drivers/usb/usbdesc.c

24 
	~"usbdesc.h
"

25 
	~"usb_comm⁄.h
"

27 #i‡(
MODULE_USB_ENABLE
)

34 c⁄° 
USB_Des¸ùt‹_Såög_t
 
	gœnguage_desc
 = {

35 {(
USB_Des¸ùt‹_Hódî_t
Ë+ 2, 
DTYPE_Såög
},

36 {
LANGUAGE_ID_ENG
}

43 c⁄° 
USB_Des¸ùt‹_Såög_t
 
	gvíd‹_desc
 = {

44 {(
USB_Des¸ùt‹_Hódî_t
Ë+ (
STRING_VENDOR
Ë- 2, 
DTYPE_Såög
},

45 {
STRING_VENDOR
}

52 c⁄° 
USB_Des¸ùt‹_Såög_t
 
	g¥odu˘_desc
 = {

53 {(
USB_Des¸ùt‹_Hódî_t
Ë+ (
STRING_PRODUCT
Ë- 2, 
DTYPE_Såög
},

54 {
STRING_PRODUCT
}

60 c⁄° 
USB_Des¸ùt‹_Såög_t
 
	g£rül_desc
 = {

61 {(
USB_Des¸ùt‹_Hódî_t
Ë+ (
STRING_SERIAL
Ë- 2, 
DTYPE_Såög
},

62 {
STRING_SERIAL
}

67 #i‡(
__PROJECT_TL_SNIFFER__
)

68 
USB_Des¸ùt‹_Devi˚_t
 
	gdevi˚_desc
 = 
SNIFFER_DEVICE_DESC
;

70 c⁄° 
USB_Des¸ùt‹_Devi˚_t
 
	gdevi˚_desc
 = {

71 {(
USB_Des¸ùt‹_Devi˚_t
), 
DTYPE_Devi˚
},

75 #i‡(
USB_CDC_ENABLE
)

76 
USB_CSCP_IADDevi˚Cœss
,

77 
USB_CSCP_IADDevi˚Sub˛ass
,

78 
USB_CSCP_IADDevi˚PrŸocﬁ
,

80 
USB_CSCP_NoDevi˚Cœss
,

81 
USB_CSCP_NoDevi˚Sub˛ass
,

82 
USB_CSCP_NoDevi˚PrŸocﬁ
,

86 
ID_VENDOR
,

87 
ID_PRODUCT
,

88 
ID_VERSION
,

89 
USB_STRING_VENDOR
,

90 
USB_STRING_PRODUCT
,

91 
USB_STRING_SERIAL
,

98 c⁄° 
USB_Des¸ùt‹_C⁄figuøti⁄_t
 
	gc⁄figuøti⁄_desc
 = {

100 {(
USB_Des¸ùt‹_C⁄figuøti⁄_Hódî_t
), 
DTYPE_C⁄figuøti⁄
},

101 (
USB_Des¸ùt‹_C⁄figuøti⁄_t
),

102 
USB_INTF_MAX
,

104 
NO_DESCRIPTOR
,

105 
USB_CONFIG_ATTR_RESERVED
,

106 
USB_CONFIG_POWER_MA
(50)

109 #i‡(
USB_CDC_ENABLE
)

112 {(
USB_Des¸ùt‹_I¡îÁ˚_Assocüti⁄_t
), 
DTYPE_I¡îÁ˚Assocüti⁄
},

113 
USB_INTF_CDC_CCI
,

115 
CDC_CSCP_CDCCœss
,

116 
CDC_CSCP_ACMSub˛ass
,

117 
CDC_CSCP_ATComm™dPrŸocﬁ
,

118 
NO_DESCRIPTOR


123 {(
USB_Des¸ùt‹_I¡îÁ˚_t
), 
DTYPE_I¡îÁ˚
},

124 
USB_INTF_CDC_CCI
,

127 
CDC_CSCP_CDCCœss
,

128 
CDC_CSCP_ACMSub˛ass
,

129 
CDC_CSCP_ATComm™dPrŸocﬁ
,

130 
NO_DESCRIPTOR


137 {(
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆHódî_t
), 
DTYPE_CSI¡îÁ˚
},

138 
CDC_DSUBTYPE_CSI¡îÁ˚_Hódî
,

144 {(
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆACM_t
), 
DTYPE_CSI¡îÁ˚
},

145 
CDC_DSUBTYPE_CSI¡îÁ˚_ACM
,

151 {(
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆUni⁄_t
), 
DTYPE_CSI¡îÁ˚
},

152 
CDC_DSUBTYPE_CSI¡îÁ˚_Uni⁄
,

153 
USB_INTF_CDC_CCI
,

154 
USB_INTF_CDC_DCI
,

159 {(
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆUni⁄_t
), 
DTYPE_CSI¡îÁ˚
},

160 
CDC_DSUBTYPE_CSI¡îÁ˚_CÆlM™agemít
,

162 
USB_INTF_CDC_DCI
,

167 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

168 (
ENDPOINT_DIR_IN
 | 
CDC_NOTIFICATION_EPNUM
),

169 (
EP_TYPE_INTERRUPT
 | 
ENDPOINT_ATTR_NO_SYNC
 | 
ENDPOINT_USAGE_DATA
),

170 
CDC_NOTIFICATION_EPSIZE
,

176 {(
USB_Des¸ùt‹_I¡îÁ˚_t
), 
DTYPE_I¡îÁ˚
},

177 
USB_INTF_CDC_DCI
,

180 
CDC_CSCP_CDCD©aCœss
,

181 
CDC_CSCP_NoD©aSub˛ass
,

182 
CDC_CSCP_NoD©aPrŸocﬁ
,

183 
NO_DESCRIPTOR


188 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

189 (
ENDPOINT_DIR_OUT
 | 
CDC_RX_EPNUM
),

190 (
EP_TYPE_BULK
 | 
ENDPOINT_ATTR_NO_SYNC
 | 
ENDPOINT_USAGE_DATA
),

191 
CDC_TXRX_EPSIZE
,

197 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

198 (
ENDPOINT_DIR_IN
 | 
CDC_TX_EPNUM
),

199 (
EP_TYPE_BULK
 | 
ENDPOINT_ATTR_NO_SYNC
 | 
ENDPOINT_USAGE_DATA
),

200 
CDC_TXRX_EPSIZE
,

206 #i‡(
USB_MOUSE_ENABLE
)

209 {(
USB_Des¸ùt‹_I¡îÁ˚_t
), 
DTYPE_I¡îÁ˚
},

210 
USB_INTF_MOUSE
,

213 
HID_CSCP_HIDCœss
,

214 
HID_CSCP_BoŸSub˛ass
,

215 
HID_CSCP_Mou£BoŸPrŸocﬁ
,

216 
NO_DESCRIPTOR


222 {(
USB_HID_Des¸ùt‹_HID_t
), 
HID_DTYPE_HID
},

224 
USB_HID_COUNTRY_US
,

226 
HID_DTYPE_Rï‹t
,

227 {(
mou£_ªp‹t_desc
), 0x00},

231 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

232 
ENDPOINT_DIR_IN
 | 
USB_EDP_MOUSE
,

233 
EP_TYPE_INTERRUPT
,

239 #i‡(
USB_KEYBOARD_ENABLE
)

242 {(
USB_Des¸ùt‹_I¡îÁ˚_t
), 
DTYPE_I¡îÁ˚
},

243 
USB_INTF_KEYBOARD
,

246 
HID_CSCP_HIDCœss
,

247 
HID_CSCP_BoŸSub˛ass
,

248 
HID_CSCP_KeybﬂrdBoŸPrŸocﬁ
,

249 
NO_DESCRIPTOR


255 {(
USB_HID_Des¸ùt‹_HID_t
), 
HID_DTYPE_HID
},

257 
USB_HID_COUNTRY_US
,

259 
HID_DTYPE_Rï‹t
,

260 {(
keybﬂrd_ªp‹t_desc
), 0x00},

264 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

265 
ENDPOINT_DIR_IN
 | 
USB_EDP_KEYBOARD_IN
,

266 
EP_TYPE_INTERRUPT
,

273 #i‡(
USB_VENDOR_ENABLE
)

276 {(
USB_Des¸ùt‹_I¡îÁ˚_t
), 
DTYPE_I¡îÁ˚
},

277 
USB_INTF_HID_VENDOR
,

280 
HID_CSCP_HIDCœss
,

281 
HID_CSCP_N⁄BoŸSub˛ass
,

282 
HID_CSCP_N⁄BoŸPrŸocﬁ
,

283 
NO_DESCRIPTOR


290 {(
USB_HID_Des¸ùt‹_HID_t
), 
HID_DTYPE_HID
},

292 
USB_HID_COUNTRY_US
,

294 
HID_DTYPE_Rï‹t
,

295 {(
víd‹_ªp‹t_desc
), 0x00}

300 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

301 (
ENDPOINT_DIR_IN
 | 
USB_EDP_HID_VENDOR_IN
),

302 
EP_TYPE_INTERRUPT
,

303 
HID_VENDOR_TXRX_EPSIZE
,

309 {(
USB_Des¸ùt‹_Endpoöt_t
), 
DTYPE_Endpoöt
},

310 (
ENDPOINT_DIR_OUT
 | 
USB_EDP_HID_VENDOR_OUT
),

311 
EP_TYPE_INTERRUPT
,

312 
HID_VENDOR_TXRX_EPSIZE
,

318 #i‡(
__PROJECT_TL_SNIFFER__
)

319 
SNIFFER_INTERFACE
,

320 
SNIFFER_ENDPOINT
,

324 
u8
 *
	$usbdesc_gë_œnguage
(){

325  (
u8
 *)(&
œnguage_desc
);

326 
	}
}

328 
u8
 *
	$usbdesc_gë_víd‹
(){

329  (
u8
 *)(&
víd‹_desc
);

330 
	}
}

332 
u8
 *
	$usbdesc_gë_¥odu˘
(){

333  (
u8
 *)(&
¥odu˘_desc
);

334 
	}
}

336 
u8
 *
	$usbdesc_gë_£rül
(){

337  (
u8
 *)(&
£rül_desc
);

338 
	}
}

340 
u8
 *
	$usbdesc_gë_devi˚
(){

341  (
u8
 *)(&
devi˚_desc
);

342 
	}
}

344 
u8
 *
	$usbdesc_gë_c⁄figuøti⁄
(){

345  (
u8
 *)(&
c⁄figuøti⁄_desc
);

346 
	}
}

348 #i‡(
USB_MOUSE_ENABLE
)

349 
u8
 *
	$usbdesc_gë_mou£
(){

350  (
u8
 *)(&
c⁄figuøti⁄_desc
.
mou£_des¸ùt‹
);

351 
	}
}

354 #i‡(
USB_KEYBOARD_ENABLE
)

355 
u8
 *
	$usbdesc_gë_keybﬂrd
(){

356  (
u8
 *)(&
c⁄figuøti⁄_desc
.
keybﬂrd_des¸ùt‹
);

357 
	}
}

360 #i‡(
USB_VENDOR_ENABLE
)

361 
u8
 *
	$usbvíd‹_gë_víd‹_desc
(){

362  (
u8
 *)(&
c⁄figuøti⁄_desc
.
víd‹_des¸ùt‹
);

363 
	}
}

	@proj/drivers/usb/usbdesc.h

24 #¥agm®
⁄˚


27 
	~"é_comm⁄.h
"

28 
	~"usb°d/usb°d.h
"

31 #i‡
deföed
(
__˝lu•lus
)

35 #i‚de‡
STRING_VENDOR


36 
	#STRING_VENDOR
 
L
"Tñök"

	)

38 #i‚de‡
STRING_PRODUCT


39 
	#STRING_PRODUCT
 
L
"TñökUSBD⁄gÀ"

	)

41 #i‚de‡
STRING_SERIAL


42 
	#STRING_SERIAL
 
L
"TLSR82xx"

	)

44 #i‚de‡
ID_VENDOR


45 
	#ID_VENDOR
 0x248A

	)

47 #i‚de‡
ID_VERSION


48 
	#ID_VERSION
 0x0100

	)

50 #i‚de‡
ID_PRODUCT_BASE


51 
	#ID_PRODUCT_BASE
 0x8800

	)

53 #i‚de‡
USB_PRINTER_ENABLE


54 
	#USB_PRINTER_ENABLE
 0

	)

56 #i‚de‡
USB_SPEAKER_ENABLE


57 
	#USB_SPEAKER_ENABLE
 0

	)

59 #i‚de‡
USB_MIC_ENABLE


60 
	#USB_MIC_ENABLE
 0

	)

62 #i‚de‡
USB_MOUSE_ENABLE


63 
	#USB_MOUSE_ENABLE
 0

	)

65 #i‚de‡
USB_KEYBOARD_ENABLE


66 
	#USB_KEYBOARD_ENABLE
 0

	)

68 #i‚de‡
USB_SOMATIC_ENABLE


69 
	#USB_SOMATIC_ENABLE
 0

	)

71 #i‚de‡
USB_CDC_ENABLE


72 
	#USB_CDC_ENABLE
 0

	)

74 #i‚de‡
USB_VENDOR_ENABLE


75 
	#USB_VENDOR_ENABLE
 0

	)

77 #i‚de‡
ID_PRODUCT


78 
	#ID_PRODUCT
 (
ID_PRODUCT_BASE
 | (
USB_PRINTER_ENABLE
?(1<<0):0Ë| (
USB_SPEAKER_ENABLE
?(1<<1):0Ë| (
USB_MIC_ENABLE
?(1<<2):0Ë| \

	)

79 (
USB_MOUSE_ENABLE
?(1<<3):0Ë| (
USB_KEYBOARD_ENABLE
?(1<<4):0Ë| (
USB_SOMATIC_ENABLE
?(1<<5):0Ë| (
USB_CDC_ENABLE
?(1<<6):0) | \

80 (
USB_VENDOR_ENABLE
?(1<<7):0))

85 #i‡(
USB_CDC_ENABLE
)

86 
USB_INTF_CDC_CCI
,

87 
USB_INTF_CDC_DCI
,

90 #i‡(
USB_KEYBOARD_ENABLE
)

91 
USB_INTF_KEYBOARD
,

94 #i‡(
USB_MOUSE_ENABLE
)

95 
USB_INTF_MOUSE
,

98 #i‡(
USB_VENDOR_ENABLE
)

99 
USB_INTF_HID_VENDOR
,

102 #i‡(
__PROJECT_TL_SNIFFER__
)

103 
USB_INTF_SNIFFER
,

106 
USB_INTF_MAX
,

107 } 
	tUSB_INTF_ID_E
;

109 #i‡(
USB_CDC_ENABLE
)

111 #i‚de‡
CDC_NOTIFICATION_EPNUM


112 
	#CDC_NOTIFICATION_EPNUM
 2

	)

115 #i‚de‡
CDC_TX_EPNUM


116 
	#CDC_TX_EPNUM
 
USB_EDP_CDC_IN


118 

	)

119 #i‚de‡
CDC_RX_EPNUM


120 
	#CDC_RX_EPNUM
 
USB_EDP_CDC_OUT


122 

	)

123 
	#CDC_NOTIFICATION_EPSIZE
 8

	)

125 
	#CDC_TXRX_EPSIZE
 64

	)

128 #i‡(
USB_VENDOR_ENABLE
)

130 
	#USB_EDP_HID_VENDOR_IN
 4

	)

132 
	#USB_EDP_HID_VENDOR_OUT
 5

	)

134 
	#HID_VENDOR_TXRX_EPSIZE
 64

	)

137 #i‡(
__PROJECT_TL_SNIFFER__
)

138 
	#SNIFFER_TX_EPNUM
 3

	)

139 
	#SNIFFER_TX_EPSIZE
 64

	)

143 
USB_AUDIO_FORMAT_UNKNOWN
 = 0,

144 
USB_AUDIO_FORMAT_PCM
,

145 
USB_AUDIO_FORMAT_ADPCM
,

146 
USB_AUDIO_FORMAT_IEEE_FLOAT
,

147 
USB_AUDIO_FORMAT_IBM_CVSD
,

148 
USB_AUDIO_FORMAT_ALAW
,

149 
USB_AUDIO_FORMAT_MULAW
,

150 
USB_AUDIO_FORMAT_WMAVOICE9
,

151 
USB_AUDIO_FORMAT_OKI_ADPCM
,

152 
USB_AUDIO_FORMAT_DVI_ADPCM
,

153 
USB_AUDIO_FORMAT_IMA_ADPCM
,

154 
USB_AUDIO_FORMAT_MEDIASPACE_ADPCM
,

155 
USB_AUDIO_FORMAT_SIERRA_ADPCM
,

156 
USB_AUDIO_FORMAT_G723_ADPCM
,

157 
USB_AUDIO_FORMAT_DIGISTD
,

158 
USB_AUDIO_FORMAT_DIGIFIX
,

159 
USB_AUDIO_FORMAT_DIALOGIC_OKI_ADPCM
,

160 
USB_AUDIO_FORMAT_MEDIAVISION_ADPCM
,

161 
USB_AUDIO_FORMAT_YAMAHA_ADPCM
,

162 
USB_AUDIO_FORMAT_SONARC
,

163 
USB_AUDIO_FORMAT_DSPGROUP_TRUESPEECH
,

164 
USB_AUDIO_FORMAT_ECHOSC1
,

165 
USB_AUDIO_FORMAT_AUDIOFILE_AF36
,

166 
USB_AUDIO_FORMAT_APTX
,

167 
USB_AUDIO_FORMAT_AUDIOFILE_AF10
,

168 
USB_AUDIO_FORMAT_DOLBY_AC2
,

169 
USB_AUDIO_FORMAT_GSM610
,

170 
USB_AUDIO_FORMAT_MSNAUDIO
,

171 
USB_AUDIO_FORMAT_ANTEX_ADPCME
,

172 
USB_AUDIO_FORMAT_CONTROL_RES_VQLPC
,

173 
USB_AUDIO_FORMAT_DIGIREAL
,

174 
USB_AUDIO_FORMAT_DIGIADPCM
,

175 
USB_AUDIO_FORMAT_CONTROL_RES_CR10
,

176 
USB_AUDIO_FORMAT_NMS_VBXADPCM
,

177 
USB_AUDIO_FORMAT_CS_IMAADPCM
,

178 
USB_AUDIO_FORMAT_ECHOSC3
,

179 
USB_AUDIO_FORMAT_ROCKWELL_ADPCM
,

180 
USB_AUDIO_FORMAT_ROCKWELL_DIGITALK
,

181 
USB_AUDIO_FORMAT_XEBEC
,

182 
USB_AUDIO_FORMAT_G721_ADPCM
,

183 
USB_AUDIO_FORMAT_G728_CELP
,

184 
USB_AUDIO_FORMAT_MPEG
,

185 
USB_AUDIO_FORMAT_MPEGLAYER3
,

186 
USB_AUDIO_FORMAT_CIRRUS
,

187 
USB_AUDIO_FORMAT_ESPCM
,

188 
USB_AUDIO_FORMAT_VOXWARE
,

189 
USB_AUDIO_FORMAT_WAVEFORMAT_CANOPUS_ATRAC
,

190 
USB_AUDIO_FORMAT_G726_ADPCM
,

191 
USB_AUDIO_FORMAT_G722_ADPCM
,

192 
USB_AUDIO_FORMAT_DSAT
,

193 
USB_AUDIO_FORMAT_DSAT_DISPLAY
,

194 
USB_AUDIO_FORMAT_SOFTSOUND
,

195 
USB_AUDIO_FORMAT_RHETOREX_ADPCM
,

196 
USB_AUDIO_FORMAT_MSAUDIO1
,

197 
USB_AUDIO_FORMAT_WMAUDIO2
,

198 
USB_AUDIO_FORMAT_WMAUDIO3
,

199 
USB_AUDIO_FORMAT_WMAUDIO_LOSSLESS
,

200 
USB_AUDIO_FORMAT_CREATIVE_ADPCM
,

201 
USB_AUDIO_FORMAT_CREATIVE_FASTSPEECH8
,

202 
USB_AUDIO_FORMAT_CREATIVE_FASTSPEECH10
,

203 
USB_AUDIO_FORMAT_QUARTERDECK
,

204 
USB_AUDIO_FORMAT_FM_TOWNS_SND
,

205 
USB_AUDIO_FORMAT_BTV_DIGITAL
,

206 
USB_AUDIO_FORMAT_OLIGSM
,

207 
USB_AUDIO_FORMAT_OLIADPCM
,

208 
USB_AUDIO_FORMAT_OLICELP
,

209 
USB_AUDIO_FORMAT_OLISBC
,

210 
USB_AUDIO_FORMAT_OLIOPR
,

211 
USB_AUDIO_FORMAT_LH_CODEC
,

212 
USB_AUDIO_FORMAT_NORRIS
,

216 
USB_HID_COUNTRY_NONE
 = 0,

217 
USB_HID_COUNTRY_ARABIC
,

218 
USB_HID_COUNTRY_BELGIAN
,

219 
USB_HID_COUNTRY_CANADA_BI
,

220 
USB_HID_COUNTRY_CANADA_FR
,

221 
USB_HID_COUNTRY_CZECH_REPUBLIC
,

222 
USB_HID_COUNTRY_DANISH
,

223 
USB_HID_COUNTRY_FINNISH
,

224 
USB_HID_COUNTRY_FRENCH
,

225 
USB_HID_COUNTRY_GERMAN
,

226 
USB_HID_COUNTRY_GREEK
,

227 
USB_HID_COUNTRY_HEBREW
,

228 
USB_HID_COUNTRY_HUNGARY
,

229 
USB_HID_COUNTRY_INTERNATIONAL_ISO
,

230 
USB_HID_COUNTRY_ITALIAN
,

231 
USB_HID_COUNTRY_JAPAN_KATAKANA
,

232 
USB_HID_COUNTRY_KOREAN
,

233 
USB_HID_COUNTRY_LATIN_AMERICAN
,

234 
USB_HID_COUNTRY_NETHERLANDS
,

235 
USB_HID_COUNTRY_NORWEGIAN
,

236 
USB_HID_COUNTRY_PERSIAN
,

237 
USB_HID_COUNTRY_POLAND
,

238 
USB_HID_COUNTRY_PORTUGUESE
,

239 
USB_HID_COUNTRY_RUSSIA
,

240 
USB_HID_COUNTRY_SLOVAKIA
,

241 
USB_HID_COUNTRY_SPANISH
,

242 
USB_HID_COUNTRY_SWEDISH
,

243 
USB_HID_COUNTRY_SWISS_FRENCH
,

244 
USB_HID_COUNTRY_SWISS_GERMAN
,

245 
USB_HID_COUNTRY_SWITZERLAND
,

246 
USB_HID_COUNTRY_TAIWAN
,

247 
USB_HID_COUNTRY_TURKISH_Q
,

248 
USB_HID_COUNTRY_UK
,

249 
USB_HID_COUNTRY_US
,

250 
USB_HID_COUNTRY_YUGOSLAVIA
,

251 
USB_HID_COUNTRY_TURKISH_F
,

255 
USB_STRING_LANGUAGE
 = 0,

256 
USB_STRING_VENDOR
,

257 
USB_STRING_PRODUCT
,

258 
USB_STRING_SERIAL
,

260 
USB_STRING_MS_OS
 = 0xee,

264 
USB_HID_Des¸ùt‹_HID_t
 
audio_hid
;

265 
USB_Des¸ùt‹_Endpoöt_t
 
audio_ö_ídpoöt
;

266 } 
	tUSB_HID_Des¸ùt‹_HID_Audio_t
;

269 
USB_HID_Des¸ùt‹_HID_t
 
mou£_hid
;

270 
USB_Des¸ùt‹_Endpoöt_t
 
mou£_ö_ídpoöt
;

271 } 
	tUSB_HID_Des¸ùt‹_HID_Mou£_t
;

274 
USB_HID_Des¸ùt‹_HID_t
 
keybﬂrd_hid
;

275 
USB_Des¸ùt‹_Endpoöt_t
 
keybﬂrd_ö_ídpoöt
;

276 } 
	tUSB_HID_Des¸ùt‹_HID_Keybﬂrd_t
;

279 
USB_HID_Des¸ùt‹_HID_t
 
som©ic_hid
;

280 
USB_Des¸ùt‹_Endpoöt_t
 
som©ic_ö_ídpoöt
;

281 
USB_Des¸ùt‹_Endpoöt_t
 
som©ic_out_ídpoöt
;

282 } 
	tUSB_HID_Des¸ùt‹_HID_Som©ic_t
;

285 
USB_HID_Des¸ùt‹_HID_t
 
víd‹_hid
;

286 
USB_Des¸ùt‹_Endpoöt_t
 
víd‹_ö_ídpoöt
;

287 
USB_Des¸ùt‹_Endpoöt_t
 
víd‹_out_ídpoöt
;

288 } 
	tUSB_HID_Des¸ùt‹_HID_Víd‹_t
;

292 
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆHódî_t
 
CDC_Fun˘i⁄Æ_Hódî
;

293 
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆACM_t
 
CDC_Fun˘i⁄Æ_ACM
;

294 
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆUni⁄_t
 
CDC_Fun˘i⁄Æ_Uni⁄
;

295 
USB_CDC_Des¸ùt‹_Fun˘i⁄ÆUni⁄_t
 
CDC_Fun˘i⁄Æ_CÆlM™agemít
;

296 
USB_Des¸ùt‹_Endpoöt_t
 
CDC_NŸifiˇti⁄Endpoöt
;

299 
USB_Des¸ùt‹_I¡îÁ˚_t
 
CDC_DCI_I¡îÁ˚
;

300 
USB_Des¸ùt‹_Endpoöt_t
 
CDC_D©aOutEndpoöt
;

301 
USB_Des¸ùt‹_Endpoöt_t
 
CDC_D©aInEndpoöt
;

302 } 
	tUSB_CDC_Des¸ùt‹_t
;

306 
USB_Des¸ùt‹_C⁄figuøti⁄_Hódî_t
 
C⁄fig
;

308 #i‡(
USB_CDC_ENABLE
)

310 
USB_Des¸ùt‹_I¡îÁ˚_Assocüti⁄_t
 
cdc_üd
;

312 
USB_Des¸ùt‹_I¡îÁ˚_t
 
cdc_öãrÁ˚
;

313 
USB_CDC_Des¸ùt‹_t
 
cdc_des¸ùt‹
;

316 #i‡(
USB_MOUSE_ENABLE
)

318 
USB_Des¸ùt‹_I¡îÁ˚_t
 
mou£_öãrÁ˚
;

319 
USB_HID_Des¸ùt‹_HID_Mou£_t
 
mou£_des¸ùt‹
;

322 #i‡(
USB_KEYBOARD_ENABLE
)

324 
USB_Des¸ùt‹_I¡îÁ˚_t
 
keybﬂrd_öãrÁ˚
;

325 
USB_HID_Des¸ùt‹_HID_Keybﬂrd_t
 
keybﬂrd_des¸ùt‹
;

328 #i‡(
USB_VENDOR_ENABLE
)

330 
USB_Des¸ùt‹_I¡îÁ˚_t
 
víd‹_öãrÁ˚
;

331 
USB_HID_Des¸ùt‹_HID_Víd‹_t
 
víd‹_des¸ùt‹
;

334 #i‡(
__PROJECT_TL_SNIFFER__
)

335 
USB_Des¸ùt‹_I¡îÁ˚_t
 
¢if„r_öãrÁ˚
;

336 
USB_Des¸ùt‹_Endpoöt_t
 
¢if„r_ídpoöt
;

338 } 
	tUSB_Des¸ùt‹_C⁄figuøti⁄_t
;

342 
u8
 *
usbdesc_gë_œnguage
();

343 
u8
 *
usbdesc_gë_víd‹
();

344 
u8
 *
usbdesc_gë_¥odu˘
();

345 
u8
 *
usbdesc_gë_£rül
();

346 
u8
 *
usbdesc_gë_devi˚
();

347 
u8
 *
usbdesc_gë_c⁄figuøti⁄
();

349 #i‡(
USB_MOUSE_ENABLE
)

350 
u8
 *
usbdesc_gë_mou£
();

352 #i‡(
USB_KEYBOARD_ENABLE
)

353 
u8
 *
usbdesc_gë_keybﬂrd
();

355 #i‡(
USB_VENDOR_ENABLE
)

356 
u8
 *
usbvíd‹_gë_víd‹_desc
();

360 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/AudioClassCommon.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"bô.h
"

29 
	~"StdDes¸ùt‹s.h
"

32 #i‡
deföed
(
__˝lu•lus
)

40 
	#AUDIO_CHANNEL_LEFT_FRONT
 
	`BIT
(0)

	)

43 
	#AUDIO_CHANNEL_RIGHT_FRONT
 
	`BIT
(1)

	)

46 
	#AUDIO_CHANNEL_CENTER_FRONT
 
	`BIT
(2)

	)

49 
	#AUDIO_CHANNEL_LOW_FREQ_ENHANCE
 
	`BIT
(3)

	)

52 
	#AUDIO_CHANNEL_LEFT_SURROUND
 
	`BIT
(4)

	)

55 
	#AUDIO_CHANNEL_RIGHT_SURROUND
 
	`BIT
(5)

	)

58 
	#AUDIO_CHANNEL_LEFT_OF_CENTER
 
	`BIT
(6)

	)

61 
	#AUDIO_CHANNEL_RIGHT_OF_CENTER
 
	`BIT
(7)

	)

64 
	#AUDIO_CHANNEL_SURROUND
 
	`BIT
(8)

	)

67 
	#AUDIO_CHANNEL_SIDE_LEFT
 
	`BIT
(9)

	)

70 
	#AUDIO_CHANNEL_SIDE_RIGHT
 
	`BIT
(10)

	)

73 
	#AUDIO_CHANNEL_TOP
 
	`BIT
(11)

	)

79 
	#AUDIO_FEATURE_MUTE
 
	`BIT
(0)

	)

82 
	#AUDIO_FEATURE_VOLUME
 
	`BIT
(1)

	)

85 
	#AUDIO_FEATURE_BASS
 
	`BIT
(2)

	)

88 
	#AUDIO_FEATURE_MID
 
	`BIT
(3)

	)

91 
	#AUDIO_FEATURE_TREBLE
 
	`BIT
(4)

	)

94 
	#AUDIO_FEATURE_GRAPHIC_EQUALIZER
 
	`BIT
(5)

	)

97 
	#AUDIO_FEATURE_AUTOMATIC_GAIN
 
	`BIT
(6)

	)

100 
	#AUDIO_FEATURE_DELAY
 
	`BIT
(7)

	)

103 
	#AUDIO_FEATURE_BASS_BOOST
 
	`BIT
(8)

	)

106 
	#AUDIO_FEATURE_BASS_LOUDNESS
 
	`BIT
(9)

	)

112 
	#AUDIO_TERMINAL_UNDEFINED
 0x0100

	)

115 
	#AUDIO_TERMINAL_STREAMING
 0x0101

	)

118 
	#AUDIO_TERMINAL_VENDOR
 0x01FF

	)

121 
	#AUDIO_TERMINAL_IN_UNDEFINED
 0x0200

	)

124 
	#AUDIO_TERMINAL_IN_MIC
 0x0201

	)

127 
	#AUDIO_TERMINAL_IN_DESKTOP_MIC
 0x0202

	)

130 
	#AUDIO_TERMINAL_IN_PERSONAL_MIC
 0x0203

	)

133 
	#AUDIO_TERMINAL_IN_OMNIDIR_MIC
 0x0204

	)

136 
	#AUDIO_TERMINAL_IN_MIC_ARRAY
 0x0205

	)

139 
	#AUDIO_TERMINAL_IN_PROCESSING_MIC
 0x0206

	)

142 
	#AUDIO_TERMINAL_IN_OUT_UNDEFINED
 0x0300

	)

145 
	#AUDIO_TERMINAL_OUT_SPEAKER
 0x0301

	)

148 
	#AUDIO_TERMINAL_OUT_HEADPHONES
 0x0302

	)

151 
	#AUDIO_TERMINAL_OUT_HEAD_MOUNTED
 0x0303

	)

154 
	#AUDIO_TERMINAL_OUT_DESKTOP
 0x0304

	)

157 
	#AUDIO_TERMINAL_OUT_ROOM
 0x0305

	)

160 
	#AUDIO_TERMINAL_OUT_COMMUNICATION
 0x0306

	)

163 
	#AUDIO_TERMINAL_OUT_LOWFREQ
 0x0307

	)

170 
	#AUDIO_SAMPLE_FREQ
(
‰eq
Ë{ \

	)

171 .
Byã1
 = ((
u32
)
‰eq
 & 0xFF), \

172 .
Byã2
 = (((
u32
)
‰eq
 >> 8) & 0xFF), \

173 .
Byã3
 = (((
u32
)
‰eq
 >> 16) & 0xFF) \

179 
	#AUDIO_EP_FULL_PACKETS_ONLY
 
	`BIT
(7)

	)

184 
	#AUDIO_EP_ACCEPTS_SMALL_PACKETS
 (0 << 7)

	)

189 
	#AUDIO_EP_SAMPLE_FREQ_CONTROL
 
	`BIT
(0)

	)

194 
	#AUDIO_EP_PITCH_CONTROL
 
	`BIT
(1)

	)

200 
	eAudio_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


202 
AUDIO_CSCP_AudioCœss
 = 0x01,

205 
AUDIO_CSCP_C⁄åﬁSub˛ass
 = 0x01,

208 
AUDIO_CSCP_C⁄åﬁPrŸocﬁ
 = 0x00,

211 
AUDIO_CSCP_AudioSåómögSub˛ass
 = 0x02,

214 
AUDIO_CSCP_MIDISåómögSub˛ass
 = 0x03,

217 
AUDIO_CSCP_SåómögPrŸocﬁ
 = 0x00,

223 
	eAudio_CSI¡îÁ˚_AC_SubTy≥s_t


225 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Hódî
 = 0x01,

226 
AUDIO_DSUBTYPE_CSI¡îÁ˚_I≈utTîmöÆ
 = 0x02,

227 
AUDIO_DSUBTYPE_CSI¡îÁ˚_OuçutTîmöÆ
 = 0x03,

228 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Mixî
 = 0x04,

229 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Sñe˘‹
 = 0x05,

230 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Fótuª
 = 0x06,

231 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Pro˚ssög
 = 0x07,

232 
AUDIO_DSUBTYPE_CSI¡îÁ˚_Exãnsi⁄
 = 0x08,

236 
	eAudio_CSI¡îÁ˚_AS_SubTy≥s_t


238 
AUDIO_DSUBTYPE_CSI¡îÁ˚_GíîÆ
 = 0x01,

239 
AUDIO_DSUBTYPE_CSI¡îÁ˚_F‹m©Ty≥
 = 0x02,

240 
AUDIO_DSUBTYPE_CSI¡îÁ˚_F‹m©S≥cific
 = 0x03,

244 
	eAudio_CSEndpoöt_SubTy≥s_t


246 
AUDIO_DSUBTYPE_CSEndpoöt_GíîÆ
 = 0x01,

250 
	eAudio_CœssReque°s_t


252 
AUDIO_REQ_SëCuºít
 = 0x01,

253 
AUDIO_REQ_SëMöimum
 = 0x02,

254 
AUDIO_REQ_SëMaximum
 = 0x03,

255 
AUDIO_REQ_SëResﬁuti⁄
 = 0x04,

256 
AUDIO_REQ_SëMem‹y
 = 0x05,

257 
AUDIO_REQ_GëCuºít
 = 0x81,

258 
AUDIO_REQ_GëMöimum
 = 0x82,

259 
AUDIO_REQ_GëMaximum
 = 0x83,

260 
AUDIO_REQ_GëResﬁuti⁄
 = 0x84,

261 
AUDIO_REQ_GëMem‹y
 = 0x85,

262 
AUDIO_REQ_GëSètus
 = 0xFF,

268 
	eAudio_EndpoötC⁄åﬁs_t


270 
AUDIO_EPCONTROL_Sam∂ögFªq
 = 0x01,

271 
AUDIO_EPCONTROL_Pôch
 = 0x02,

287 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

288 
u8
 
Subty≥
;

292 
u8
 
TîmöÆID
;

293 
u16
 
TîmöÆTy≥
;

294 
u8
 
AssocüãdOuçutTîmöÆ
;

297 
u8
 
TŸÆCh™√ls
;

298 
u16
 
Ch™√lC⁄fig
;

300 
u8
 
Ch™√lSåIndex
;

301 
u8
 
TîmöÆSåIndex
;

302 }
	tUSB_Audio_Des¸ùt‹_I≈utTîmöÆ_t
;

317 
u8
 
bLígth
;

318 
u8
 
bDes¸ùt‹Ty≥
;

322 
u8
 
bDes¸ùt‹Subty≥
;

325 
u8
 
bTîmöÆID
;

326 
u16
 
wTîmöÆTy≥
;

327 
u8
 
bAssocTîmöÆ
;

330 
u8
 
bNrCh™√ls
;

331 
u16
 
wCh™√lC⁄fig
;

333 
u8
 
iCh™√lNames
;

334 
u8
 
iTîmöÆ
;

335 }
	tUSB_Audio_StdDes¸ùt‹_I≈utTîmöÆ_t
;

349 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

350 
u8
 
Subty≥
;

354 
u8
 
TîmöÆID
;

355 
u16
 
TîmöÆTy≥
;

356 
u8
 
AssocüãdI≈utTîmöÆ
;

359 
u8
 
Sour˚ID
;

361 
u8
 
TîmöÆSåIndex
;

362 }
	tUSB_Audio_Des¸ùt‹_OuçutTîmöÆ_t
;

377 
u8
 
bLígth
;

378 
u8
 
bDes¸ùt‹Ty≥
;

382 
u8
 
bDes¸ùt‹Subty≥
;

385 
u8
 
bTîmöÆID
;

386 
u16
 
wTîmöÆTy≥
;

387 
u8
 
bAssocTîmöÆ
;

390 
u8
 
bSour˚ID
;

392 
u8
 
iTîmöÆ
;

393 }
	tUSB_Audio_StdDes¸ùt‹_OuçutTîmöÆ_t
;

407 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

408 
u8
 
Subty≥
;

412 
u8
 
ACS≥cifiˇti⁄
[2];

413 
u8
 
TŸÆLígth
[2];

415 
u8
 
InCﬁÀ˘i⁄
;

416 
u8
 
I¡îÁ˚Numbî
;

417 }
	tUSB_Audio_Des¸ùt‹_I¡îÁ˚_AC_t
;

422 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

423 
u8
 
Subty≥
;

427 
u8
 
ACS≥cifiˇti⁄
[2];

428 
u8
 
TŸÆLígth
[2];

430 
u8
 
InCﬁÀ˘i⁄
;

431 
u8
 
I¡îÁ˚Numbî_•ókî
;

432 
u8
 
I¡îÁ˚Numbî_mic
;

433 }
	tUSB_Audio_Des¸ùt‹_I¡îÁ˚_AC_TL_t
;

448 
u8
 
bLígth
;

449 
u8
 
bDes¸ùt‹Ty≥
;

453 
u8
 
bDes¸ùt‹Subty≥
;

457 
u8
 
bcdADC
[2];

458 
u8
 
wTŸÆLígth
[2];

460 
u8
 
bInCﬁÀ˘i⁄
;

461 
u8
 
bI¡îÁ˚Numbîs
;

462 }
	tUSB_Audio_StdDes¸ùt‹_I¡îÁ˚_AC_t
;

476 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

477 
u8
 
Subty≥
;

481 
u8
 
UnôID
;

482 
u8
 
Sour˚ID
;

484 
u8
 
C⁄åﬁSize
;

485 
u8
 
Ch™√lC⁄åﬁs
[3];

487 
u8
 
FótuªUnôSåIndex
;

488 }
	tUSB_Audio_Des¸ùt‹_FótuªUnô_t
;

493 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

494 
u8
 
Subty≥
;

498 
u8
 
UnôID
;

499 
u8
 
Sour˚ID
;

501 
u8
 
C⁄åﬁSize
;

502 
u8
 
Ch™√lC⁄åﬁs
[2];

504 
u8
 
FótuªUnôSåIndex
;

505 }
	tUSB_Audio_Des¸ùt‹_FótuªUnô_Mic_t
;

520 
u8
 
bLígth
;

521 
u8
 
bDes¸ùt‹Ty≥
;

525 
u8
 
bDes¸ùt‹Subty≥
;

529 
u8
 
bUnôID
;

530 
u8
 
bSour˚ID
;

532 
u8
 
bC⁄åﬁSize
;

533 
u8
 
bmaC⁄åﬁs
[3];

535 
u8
 
iFótuª
;

536 }
	tUSB_Audio_StdDes¸ùt‹_FótuªUnô_t
;

549 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

550 
u8
 
Subty≥
;

554 
u8
 
TîmöÆLök
;

556 
u8
 
FømeDñay
;

557 
u8
 
AudioF‹m©
[2];

558 }
	tUSB_Audio_Des¸ùt‹_I¡îÁ˚_AS_t
;

572 
u8
 
bLígth
;

573 
u8
 
bDes¸ùt‹Ty≥
;

577 
u8
 
bDes¸ùt‹Subty≥
;

581 
u8
 
bTîmöÆLök
;

583 
u8
 
bDñay
;

584 
u16
 
wF‹m©Tag
;

585 }
	tUSB_Audio_StdDes¸ùt‹_I¡îÁ˚_AS_t
;

602 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

603 
u8
 
Subty≥
;

607 
u8
 
F‹m©Ty≥
;

608 
u8
 
Ch™√ls
;

610 
u8
 
SubFømeSize
;

611 
u8
 
BôResﬁuti⁄
;

613 
u8
 
TŸÆDis¸ëeSam∂eR©es
;

618 }
	tUSB_Audio_Des¸ùt‹_F‹m©_t
;

629 
u8
 
Byã1
;

630 
u8
 
Byã2
;

631 
u8
 
Byã3
;

632 }
	tUSB_Audio_Sam∂eFªq_t
;

650 
u8
 
bLígth
;

651 
u8
 
bDes¸ùt‹Ty≥
;

655 
u8
 
bDes¸ùt‹Subty≥
;

659 
u8
 
bF‹m©Ty≥
;

660 
u8
 
bNrCh™√ls
;

662 
u8
 
bSubFømeSize
;

663 
u8
 
bBôResﬁuti⁄
;

665 
u8
 
bSam∂eFªquícyTy≥
;

670 }
	tUSB_Audio_StdDes¸ùt‹_F‹m©_t
;

683 
USB_Des¸ùt‹_Endpoöt_t
 
Endpoöt
;

685 
u8
 
Re‰esh
;

686 
u8
 
SyncEndpoötNumbî
;

687 }
	tUSB_Audio_Des¸ùt‹_SåómEndpoöt_Std_t
;

701 
u8
 
bLígth
;

702 
u8
 
bDes¸ùt‹Ty≥
;

705 
u8
 
bEndpoötAddªss
;

708 
u8
 
bmAâribuãs
;

711 
u16
 
wMaxPackëSize
;

714 
u8
 
bI¡îvÆ
;

718 
u8
 
bRe‰esh
;

719 
u8
 
bSynchAddªss
;

720 }
	tUSB_Audio_StdDes¸ùt‹_SåómEndpoöt_Std_t
;

734 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

735 
u8
 
Subty≥
;

739 
u8
 
Aâribuãs
;

741 
u8
 
LockDñayUnôs
;

742 
u8
 
LockDñay
[2];

743 }
	tUSB_Audio_Des¸ùt‹_SåómEndpoöt_Spc_t
;

758 
u8
 
bLígth
;

759 
u8
 
bDes¸ùt‹Ty≥
;

763 
u8
 
bDes¸ùt‹Subty≥
;

767 
u8
 
bmAâribuãs
;

769 
u8
 
bLockDñayUnôs
;

770 
u16
 
wLockDñay
;

771 }
	tUSB_Audio_StdDes¸ùt‹_SåómEndpoöt_Spc_t
;

774 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/CDCClassCommon.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"bô.h
"

29 
	~"StdDes¸ùt‹s.h
"

32 #i‡
deföed
(
__˝lu•lus
)

44 
	#CDC_CONTROL_LINE_OUT_DTR
 
	`BIT
(0)

	)

49 
	#CDC_CONTROL_LINE_OUT_RTS
 
	`BIT
(1)

	)

54 
	#CDC_CONTROL_LINE_IN_DCD
 
	`BIT
(0)

	)

59 
	#CDC_CONTROL_LINE_IN_DSR
 
	`BIT
(1)

	)

64 
	#CDC_CONTROL_LINE_IN_BREAK
 
	`BIT
(2)

	)

69 
	#CDC_CONTROL_LINE_IN_RING
 
	`BIT
(3)

	)

74 
	#CDC_CONTROL_LINE_IN_FRAMEERROR
 
	`BIT
(4)

	)

79 
	#CDC_CONTROL_LINE_IN_PARITYERROR
 
	`BIT
(5)

	)

84 
	#CDC_CONTROL_LINE_IN_OVERRUNERROR
 
	`BIT
(6)

	)

94 
	#CDC_FUNCTIONAL_DESCRIPTOR
(
D©aSize
Ë\

	)

97 
USB_Des¸ùt‹_Hódî_t
 
Hódî
; \

98 
u8
 
SubTy≥
; \

99 
u8
 
D©a
[
D©aSize
]; \

106 
	eCDC_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


108 
CDC_CSCP_CDCCœss
 = 0x02,

111 
CDC_CSCP_NoS≥cificSub˛ass
 = 0x00,

114 
CDC_CSCP_ACMSub˛ass
 = 0x02,

117 
CDC_CSCP_ATComm™dPrŸocﬁ
 = 0x01,

120 
CDC_CSCP_NoS≥cificPrŸocﬁ
 = 0x00,

123 
CDC_CSCP_Víd‹S≥cificPrŸocﬁ
 = 0xFF,

126 
CDC_CSCP_CDCD©aCœss
 = 0x0A,

129 
CDC_CSCP_NoD©aSub˛ass
 = 0x00,

132 
CDC_CSCP_NoD©aPrŸocﬁ
 = 0x00,

138 
	eCDC_CœssReque°s_t


140 
CDC_REQ_SídEnˇpsuœãdComm™d
 = 0x00,

141 
CDC_REQ_GëEnˇpsuœãdRe•⁄£
 = 0x01,

142 
CDC_REQ_SëLöeEncodög
 = 0x20,

143 
CDC_REQ_GëLöeEncodög
 = 0x21,

144 
CDC_REQ_SëC⁄åﬁLöeSèã
 = 0x22,

145 
CDC_REQ_SídBªak
 = 0x23,

149 
	eCDC_CœssNŸifiˇti⁄s_t


151 
CDC_NOTIF_SîülSèã
 = 0x20,

159 
	eCDC_Des¸ùt‹Subty≥s_t


161 
CDC_DSUBTYPE_CSI¡îÁ˚_Hódî
 = 0x00,

162 
CDC_DSUBTYPE_CSI¡îÁ˚_CÆlM™agemít
 = 0x01,

163 
CDC_DSUBTYPE_CSI¡îÁ˚_ACM
 = 0x02,

164 
CDC_DSUBTYPE_CSI¡îÁ˚_Dúe˘Löe
 = 0x03,

165 
CDC_DSUBTYPE_CSI¡îÁ˚_Tñïh⁄eRögî
 = 0x04,

166 
CDC_DSUBTYPE_CSI¡îÁ˚_Tñïh⁄eCÆl
 = 0x05,

167 
CDC_DSUBTYPE_CSI¡îÁ˚_Uni⁄
 = 0x06,

168 
CDC_DSUBTYPE_CSI¡îÁ˚_Cou¡rySñe˘i⁄
 = 0x07,

169 
CDC_DSUBTYPE_CSI¡îÁ˚_Tñïh⁄eOpModes
 = 0x08,

170 
CDC_DSUBTYPE_CSI¡îÁ˚_USBTîmöÆ
 = 0x09,

171 
CDC_DSUBTYPE_CSI¡îÁ˚_Nëw‹kCh™√l
 = 0x0A,

172 
CDC_DSUBTYPE_CSI¡îÁ˚_PrŸocﬁUnô
 = 0x0B,

173 
CDC_DSUBTYPE_CSI¡îÁ˚_Exãnsi⁄Unô
 = 0x0C,

174 
CDC_DSUBTYPE_CSI¡îÁ˚_Mu…iCh™√l
 = 0x0D,

175 
CDC_DSUBTYPE_CSI¡îÁ˚_CAPI
 = 0x0E,

176 
CDC_DSUBTYPE_CSI¡îÁ˚_Ethî√t
 = 0x0F,

177 
CDC_DSUBTYPE_CSI¡îÁ˚_ATM
 = 0x10,

181 
	eCDC_LöeEncodögF‹m©s_t


183 
CDC_LINEENCODING_O√St›Bô
 = 0,

184 
CDC_LINEENCODING_O√AndAHÆfSt›Bôs
 = 1,

185 
CDC_LINEENCODING_TwoSt›Bôs
 = 2,

189 
	eCDC_LöeEncodögP¨ôy_t


191 
CDC_PARITY_N⁄e
 = 0,

192 
CDC_PARITY_Odd
 = 1,

193 
CDC_PARITY_Eví
 = 2,

194 
CDC_PARITY_M¨k
 = 3,

195 
CDC_PARITY_S∑˚
 = 4,

211 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

212 
u8
 
Subty≥
;

215 
u16
 
CDCS≥cifiˇti⁄
;

220 } 
	tUSB_CDC_Des¸ùt‹_Fun˘i⁄ÆHódî_t
;

235 
u8
 
bFun˘i⁄Lígth
;

236 
u8
 
bDes¸ùt‹Ty≥
;

239 
u8
 
bDes¸ùt‹SubTy≥
;

242 
u16
 
bcdCDC
;

246 } 
	tUSB_CDC_StdDes¸ùt‹_Fun˘i⁄ÆHódî_t
;

259 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

260 
u8
 
Subty≥
;

263 
u8
 
C≠abûôõs
;

267 } 
	tUSB_CDC_Des¸ùt‹_Fun˘i⁄ÆACM_t
;

281 
u8
 
bFun˘i⁄Lígth
;

282 
u8
 
bDes¸ùt‹Ty≥
;

285 
u8
 
bDes¸ùt‹SubTy≥
;

288 
u8
 
bmC≠abûôõs
;

292 } 
	tUSB_CDC_StdDes¸ùt‹_Fun˘i⁄ÆACM_t
;

305 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

306 
u8
 
Subty≥
;

309 
u8
 
Ma°îI¡îÁ˚Numbî
;

310 
u8
 
SœveI¡îÁ˚Numbî
;

311 } 
	tUSB_CDC_Des¸ùt‹_Fun˘i⁄ÆUni⁄_t
;

325 
u8
 
bFun˘i⁄Lígth
;

326 
u8
 
bDes¸ùt‹Ty≥
;

329 
u8
 
bDes¸ùt‹SubTy≥
;

332 
u8
 
bMa°îI¡îÁ˚
;

333 
u8
 
bSœveI¡îÁ˚0
;

334 } 
	tUSB_CDC_StdDes¸ùt‹_Fun˘i⁄ÆUni⁄_t
;

345 
u32
 
BaudR©eBPS
;

346 
u8
 
Ch¨F‹m©
;

349 
u8
 
P¨ôyTy≥
;

352 
u8
 
D©aBôs
;

353 } 
	tCDC_LöeEncodög_t
;

356 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/CDCClassDevice.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"CDCCœssComm⁄.h
"

31 #i‡
deföed
(
__˝lu•lus
)

47 
u8
 
C⁄åﬁI¡îÁ˚Numbî
;

49 
u8
 
D©aINEndpoötNumbî
;

50 
u16
 
D©aINEndpoötSize
;

51 
boﬁ
 
D©aINEndpoötDoubÀB™k
;

53 
u8
 
D©aOUTEndpoötNumbî
;

54 
u16
 
D©aOUTEndpoötSize
;

55 
boﬁ
 
D©aOUTEndpoötDoubÀB™k
;

57 
u8
 
NŸifiˇti⁄EndpoötNumbî
;

58 
u16
 
NŸifiˇti⁄EndpoötSize
;

59 
boﬁ
 
NŸifiˇti⁄EndpoötDoubÀB™k
;

60 } 
C⁄fig
;

67 
u16
 
Ho°ToDevi˚
;

70 
u16
 
Devi˚ToHo°
;

74 } 
C⁄åﬁLöeSèãs
;

76 
CDC_LöeEncodög_t
 
LöeEncodög
;

80 } 
Sèã
;

83 } 
	tUSB_CœssInfo_CDC_Devi˚_t
;

87 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/HIDClassCommon.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"bô.h
"

29 
	~"StdDes¸ùt‹s.h
"

32 #i‡
deföed
(
__˝lu•lus
)

40 
	#HID_KEYBOARD_MODIFIER_LEFTCTRL
 
	`BIT
(0)

	)

43 
	#HID_KEYBOARD_MODIFIER_LEFTSHIFT
 
	`BIT
(1)

	)

46 
	#HID_KEYBOARD_MODIFIER_LEFTALT
 
	`BIT
(2)

	)

49 
	#HID_KEYBOARD_MODIFIER_LEFTGUI
 
	`BIT
(3)

	)

52 
	#HID_KEYBOARD_MODIFIER_RIGHTCTRL
 
	`BIT
(4)

	)

55 
	#HID_KEYBOARD_MODIFIER_RIGHTSHIFT
 
	`BIT
(5)

	)

58 
	#HID_KEYBOARD_MODIFIER_RIGHTALT
 
	`BIT
(6)

	)

61 
	#HID_KEYBOARD_MODIFIER_RIGHTGUI
 
	`BIT
(7)

	)

67 
	#HID_KEYBOARD_LED_NUMLOCK
 
	`BIT
(0)

	)

70 
	#HID_KEYBOARD_LED_CAPSLOCK
 
	`BIT
(1)

	)

73 
	#HID_KEYBOARD_LED_SCROLLLOCK
 
	`BIT
(2)

	)

76 
	#HID_KEYBOARD_LED_KATANA
 
	`BIT
(3)

	)

81 
	#HID_KEYBOARD_SC_ERROR_ROLLOVER
 0x01

	)

82 
	#HID_KEYBOARD_SC_POST_FAIL
 0x02

	)

83 
	#HID_KEYBOARD_SC_ERROR_UNDEFINED
 0x03

	)

84 
	#HID_KEYBOARD_SC_A
 0x04

	)

85 
	#HID_KEYBOARD_SC_B
 0x05

	)

86 
	#HID_KEYBOARD_SC_C
 0x06

	)

87 
	#HID_KEYBOARD_SC_D
 0x07

	)

88 
	#HID_KEYBOARD_SC_E
 0x08

	)

89 
	#HID_KEYBOARD_SC_F
 0x09

	)

90 
	#HID_KEYBOARD_SC_G
 0x0A

	)

91 
	#HID_KEYBOARD_SC_H
 0x0B

	)

92 
	#HID_KEYBOARD_SC_I
 0x0C

	)

93 
	#HID_KEYBOARD_SC_J
 0x0D

	)

94 
	#HID_KEYBOARD_SC_K
 0x0E

	)

95 
	#HID_KEYBOARD_SC_L
 0x0F

	)

96 
	#HID_KEYBOARD_SC_M
 0x10

	)

97 
	#HID_KEYBOARD_SC_N
 0x11

	)

98 
	#HID_KEYBOARD_SC_O
 0x12

	)

99 
	#HID_KEYBOARD_SC_P
 0x13

	)

100 
	#HID_KEYBOARD_SC_Q
 0x14

	)

101 
	#HID_KEYBOARD_SC_R
 0x15

	)

102 
	#HID_KEYBOARD_SC_S
 0x16

	)

103 
	#HID_KEYBOARD_SC_T
 0x17

	)

104 
	#HID_KEYBOARD_SC_U
 0x18

	)

105 
	#HID_KEYBOARD_SC_V
 0x19

	)

106 
	#HID_KEYBOARD_SC_W
 0x1A

	)

107 
	#HID_KEYBOARD_SC_X
 0x1B

	)

108 
	#HID_KEYBOARD_SC_Y
 0x1C

	)

109 
	#HID_KEYBOARD_SC_Z
 0x1D

	)

110 
	#HID_KEYBOARD_SC_1_AND_EXCLAMATION
 0x1E

	)

111 
	#HID_KEYBOARD_SC_2_AND_AT
 0x1F

	)

112 
	#HID_KEYBOARD_SC_3_AND_HASHMARK
 0x20

	)

113 
	#HID_KEYBOARD_SC_4_AND_DOLLAR
 0x21

	)

114 
	#HID_KEYBOARD_SC_5_AND_PERCENTAGE
 0x22

	)

115 
	#HID_KEYBOARD_SC_6_AND_CARET
 0x23

	)

116 
	#HID_KEYBOARD_SC_7_AND_AND_AMPERSAND
 0x24

	)

117 
	#HID_KEYBOARD_SC_8_AND_ASTERISK
 0x25

	)

118 
	#HID_KEYBOARD_SC_9_AND_OPENING_PARENTHESIS
 0x26

	)

119 
	#HID_KEYBOARD_SC_0_AND_CLOSING_PARENTHESIS
 0x27

	)

120 
	#HID_KEYBOARD_SC_ENTER
 0x28

	)

121 
	#HID_KEYBOARD_SC_ESCAPE
 0x29

	)

122 
	#HID_KEYBOARD_SC_BACKSPACE
 0x2A

	)

123 
	#HID_KEYBOARD_SC_TAB
 0x2B

	)

124 
	#HID_KEYBOARD_SC_SPACE
 0x2C

	)

125 
	#HID_KEYBOARD_SC_MINUS_AND_UNDERSCORE
 0x2D

	)

126 
	#HID_KEYBOARD_SC_EQUAL_AND_PLUS
 0x2E

	)

127 
	#HID_KEYBOARD_SC_OPENING_BRACKET_AND_OPENING_BRACE
 0x2F

	)

128 
	#HID_KEYBOARD_SC_CLOSING_BRACKET_AND_CLOSING_BRACE
 0x30

	)

129 
	#HID_KEYBOARD_SC_BACKSLASH_AND_PIPE
 0x31

	)

130 
	#HID_KEYBOARD_SC_NON_US_HASHMARK_AND_TILDE
 0x32

	)

131 
	#HID_KEYBOARD_SC_SEMICOLON_AND_COLON
 0x33

	)

132 
	#HID_KEYBOARD_SC_APOSTROPHE_AND_QUOTE
 0x34

	)

133 
	#HID_KEYBOARD_SC_GRAVE_ACCENT_AND_TILDE
 0x35

	)

134 
	#HID_KEYBOARD_SC_COMMA_AND_LESS_THAN_SIGN
 0x36

	)

135 
	#HID_KEYBOARD_SC_DOT_AND_GREATER_THAN_SIGN
 0x37

	)

136 
	#HID_KEYBOARD_SC_SLASH_AND_QUESTION_MARK
 0x38

	)

137 
	#HID_KEYBOARD_SC_CAPS_LOCK
 0x39

	)

138 
	#HID_KEYBOARD_SC_F1
 0x3A

	)

139 
	#HID_KEYBOARD_SC_F2
 0x3B

	)

140 
	#HID_KEYBOARD_SC_F3
 0x3C

	)

141 
	#HID_KEYBOARD_SC_F4
 0x3D

	)

142 
	#HID_KEYBOARD_SC_F5
 0x3E

	)

143 
	#HID_KEYBOARD_SC_F6
 0x3F

	)

144 
	#HID_KEYBOARD_SC_F7
 0x40

	)

145 
	#HID_KEYBOARD_SC_F8
 0x41

	)

146 
	#HID_KEYBOARD_SC_F9
 0x42

	)

147 
	#HID_KEYBOARD_SC_F10
 0x43

	)

148 
	#HID_KEYBOARD_SC_F11
 0x44

	)

149 
	#HID_KEYBOARD_SC_F12
 0x45

	)

150 
	#HID_KEYBOARD_SC_PRINT_SCREEN
 0x46

	)

151 
	#HID_KEYBOARD_SC_SCROLL_LOCK
 0x47

	)

152 
	#HID_KEYBOARD_SC_PAUSE
 0x48

	)

153 
	#HID_KEYBOARD_SC_INSERT
 0x49

	)

154 
	#HID_KEYBOARD_SC_HOME
 0x4A

	)

155 
	#HID_KEYBOARD_SC_PAGE_UP
 0x4B

	)

156 
	#HID_KEYBOARD_SC_DELETE
 0x4C

	)

157 
	#HID_KEYBOARD_SC_END
 0x4D

	)

158 
	#HID_KEYBOARD_SC_PAGE_DOWN
 0x4E

	)

159 
	#HID_KEYBOARD_SC_RIGHT_ARROW
 0x4F

	)

160 
	#HID_KEYBOARD_SC_LEFT_ARROW
 0x50

	)

161 
	#HID_KEYBOARD_SC_DOWN_ARROW
 0x51

	)

162 
	#HID_KEYBOARD_SC_UP_ARROW
 0x52

	)

163 
	#HID_KEYBOARD_SC_NUM_LOCK
 0x53

	)

164 
	#HID_KEYBOARD_SC_KEYPAD_SLASH
 0x54

	)

165 
	#HID_KEYBOARD_SC_KEYPAD_ASTERISK
 0x55

	)

166 
	#HID_KEYBOARD_SC_KEYPAD_MINUS
 0x56

	)

167 
	#HID_KEYBOARD_SC_KEYPAD_PLUS
 0x57

	)

168 
	#HID_KEYBOARD_SC_KEYPAD_ENTER
 0x58

	)

169 
	#HID_KEYBOARD_SC_KEYPAD_1_AND_END
 0x59

	)

170 
	#HID_KEYBOARD_SC_KEYPAD_2_AND_DOWN_ARROW
 0x5A

	)

171 
	#HID_KEYBOARD_SC_KEYPAD_3_AND_PAGE_DOWN
 0x5B

	)

172 
	#HID_KEYBOARD_SC_KEYPAD_4_AND_LEFT_ARROW
 0x5C

	)

173 
	#HID_KEYBOARD_SC_KEYPAD_5
 0x5D

	)

174 
	#HID_KEYBOARD_SC_KEYPAD_6_AND_RIGHT_ARROW
 0x5E

	)

175 
	#HID_KEYBOARD_SC_KEYPAD_7_AND_HOME
 0x5F

	)

176 
	#HID_KEYBOARD_SC_KEYPAD_8_AND_UP_ARROW
 0x60

	)

177 
	#HID_KEYBOARD_SC_KEYPAD_9_AND_PAGE_UP
 0x61

	)

178 
	#HID_KEYBOARD_SC_KEYPAD_0_AND_INSERT
 0x62

	)

179 
	#HID_KEYBOARD_SC_KEYPAD_DOT_AND_DELETE
 0x63

	)

180 
	#HID_KEYBOARD_SC_NON_US_BACKSLASH_AND_PIPE
 0x64

	)

181 
	#HID_KEYBOARD_SC_POWER
 0x66

	)

182 
	#HID_KEYBOARD_SC_EQUAL_SIGN
 0x67

	)

183 
	#HID_KEYBOARD_SC_F13
 0x68

	)

184 
	#HID_KEYBOARD_SC_F14
 0x69

	)

185 
	#HID_KEYBOARD_SC_F15
 0x6A

	)

186 
	#HID_KEYBOARD_SC_F16
 0x6B

	)

187 
	#HID_KEYBOARD_SC_F17
 0x6C

	)

188 
	#HID_KEYBOARD_SC_F18
 0x6D

	)

189 
	#HID_KEYBOARD_SC_F19
 0x6E

	)

190 
	#HID_KEYBOARD_SC_F20
 0x6F

	)

191 
	#HID_KEYBOARD_SC_F21
 0x70

	)

192 
	#HID_KEYBOARD_SC_F22
 0x71

	)

193 
	#HID_KEYBOARD_SC_F23
 0x72

	)

194 
	#HID_KEYBOARD_SC_F24
 0x73

	)

195 
	#HID_KEYBOARD_SC_EXECUTE
 0x74

	)

196 
	#HID_KEYBOARD_SC_HELP
 0x75

	)

197 
	#HID_KEYBOARD_SC_MANU
 0x76

	)

198 
	#HID_KEYBOARD_SC_SELECT
 0x77

	)

199 
	#HID_KEYBOARD_SC_STOP
 0x78

	)

200 
	#HID_KEYBOARD_SC_AGAIN
 0x79

	)

201 
	#HID_KEYBOARD_SC_UNDO
 0x7A

	)

202 
	#HID_KEYBOARD_SC_CUT
 0x7B

	)

203 
	#HID_KEYBOARD_SC_COPY
 0x7C

	)

204 
	#HID_KEYBOARD_SC_PASTE
 0x7D

	)

205 
	#HID_KEYBOARD_SC_FIND
 0x7E

	)

206 
	#HID_KEYBOARD_SC_MUTE
 0x7F

	)

207 
	#HID_KEYBOARD_SC_VOLUME_UP
 0x80

	)

208 
	#HID_KEYBOARD_SC_VOLUME_DOWN
 0x81

	)

209 
	#HID_KEYBOARD_SC_LOCKING_CAPS_LOCK
 0x82

	)

210 
	#HID_KEYBOARD_SC_LOCKING_NUM_LOCK
 0x83

	)

211 
	#HID_KEYBOARD_SC_LOCKING_SCROLL_LOCK
 0x84

	)

212 
	#HID_KEYBOARD_SC_KEYPAD_COMMA
 0x85

	)

213 
	#HID_KEYBOARD_SC_KEYPAD_EQUAL_SIGN
 0x86

	)

214 
	#HID_KEYBOARD_SC_INTERNATIONAL1
 0x87

	)

215 
	#HID_KEYBOARD_SC_INTERNATIONAL2
 0x88

	)

216 
	#HID_KEYBOARD_SC_INTERNATIONAL3
 0x89

	)

217 
	#HID_KEYBOARD_SC_INTERNATIONAL4
 0x8A

	)

218 
	#HID_KEYBOARD_SC_INTERNATIONAL5
 0x8B

	)

219 
	#HID_KEYBOARD_SC_INTERNATIONAL6
 0x8C

	)

220 
	#HID_KEYBOARD_SC_INTERNATIONAL7
 0x8D

	)

221 
	#HID_KEYBOARD_SC_INTERNATIONAL8
 0x8E

	)

222 
	#HID_KEYBOARD_SC_INTERNATIONAL9
 0x8F

	)

223 
	#HID_KEYBOARD_SC_LANG1
 0x90

	)

224 
	#HID_KEYBOARD_SC_LANG2
 0x91

	)

225 
	#HID_KEYBOARD_SC_LANG3
 0x92

	)

226 
	#HID_KEYBOARD_SC_LANG4
 0x93

	)

227 
	#HID_KEYBOARD_SC_LANG5
 0x94

	)

228 
	#HID_KEYBOARD_SC_LANG6
 0x95

	)

229 
	#HID_KEYBOARD_SC_LANG7
 0x96

	)

230 
	#HID_KEYBOARD_SC_LANG8
 0x97

	)

231 
	#HID_KEYBOARD_SC_LANG9
 0x98

	)

232 
	#HID_KEYBOARD_SC_ALTERNATE_ERASE
 0x99

	)

233 
	#HID_KEYBOARD_SC_SISREQ
 0x9A

	)

234 
	#HID_KEYBOARD_SC_CANCEL
 0x9B

	)

235 
	#HID_KEYBOARD_SC_CLEAR
 0x9C

	)

236 
	#HID_KEYBOARD_SC_PRIOR
 0x9D

	)

237 
	#HID_KEYBOARD_SC_RETURN
 0x9E

	)

238 
	#HID_KEYBOARD_SC_SEPARATOR
 0x9F

	)

239 
	#HID_KEYBOARD_SC_OUT
 0xA0

	)

240 
	#HID_KEYBOARD_SC_OPER
 0xA1

	)

241 
	#HID_KEYBOARD_SC_CLEAR_AND_AGAIN
 0xA2

	)

242 
	#HID_KEYBOARD_SC_CRSEL_ANDPROPS
 0xA3

	)

243 
	#HID_KEYBOARD_SC_EXSEL
 0xA4

	)

244 
	#HID_KEYBOARD_SC_KEYPAD_00
 0xB0

	)

245 
	#HID_KEYBOARD_SC_KEYPAD_000
 0xB1

	)

246 
	#HID_KEYBOARD_SC_THOUSANDS_SEPARATOR
 0xB2

	)

247 
	#HID_KEYBOARD_SC_DECIMAL_SEPARATOR
 0xB3

	)

248 
	#HID_KEYBOARD_SC_CURRENCY_UNIT
 0xB4

	)

249 
	#HID_KEYBOARD_SC_CURRENCY_SUB_UNIT
 0xB5

	)

250 
	#HID_KEYBOARD_SC_KEYPAD_OPENING_PARENTHESIS
 0xB6

	)

251 
	#HID_KEYBOARD_SC_KEYPAD_CLOSING_PARENTHESIS
 0xB7

	)

252 
	#HID_KEYBOARD_SC_KEYPAD_OPENING_BRACE
 0xB8

	)

253 
	#HID_KEYBOARD_SC_KEYPAD_CLOSING_BRACE
 0xB9

	)

254 
	#HID_KEYBOARD_SC_KEYPAD_TAB
 0xBA

	)

255 
	#HID_KEYBOARD_SC_KEYPAD_BACKSPACE
 0xBB

	)

256 
	#HID_KEYBOARD_SC_KEYPAD_A
 0xBC

	)

257 
	#HID_KEYBOARD_SC_KEYPAD_B
 0xBD

	)

258 
	#HID_KEYBOARD_SC_KEYPAD_C
 0xBE

	)

259 
	#HID_KEYBOARD_SC_KEYPAD_D
 0xBF

	)

260 
	#HID_KEYBOARD_SC_KEYPAD_E
 0xC0

	)

261 
	#HID_KEYBOARD_SC_KEYPAD_F
 0xC1

	)

262 
	#HID_KEYBOARD_SC_KEYPAD_XOR
 0xC2

	)

263 
	#HID_KEYBOARD_SC_KEYPAD_CARET
 0xC3

	)

264 
	#HID_KEYBOARD_SC_KEYPAD_PERCENTAGE
 0xC4

	)

265 
	#HID_KEYBOARD_SC_KEYPAD_LESS_THAN_SIGN
 0xC5

	)

266 
	#HID_KEYBOARD_SC_KEYPAD_GREATER_THAN_SIGN
 0xC6

	)

267 
	#HID_KEYBOARD_SC_KEYPAD_AMP
 0xC7

	)

268 
	#HID_KEYBOARD_SC_KEYPAD_AMP_AMP
 0xC8

	)

269 
	#HID_KEYBOARD_SC_KEYPAD_PIPE
 0xC9

	)

270 
	#HID_KEYBOARD_SC_KEYPAD_PIPE_PIPE
 0xCA

	)

271 
	#HID_KEYBOARD_SC_KEYPAD_COLON
 0xCB

	)

272 
	#HID_KEYBOARD_SC_KEYPAD_HASHMARK
 0xCC

	)

273 
	#HID_KEYBOARD_SC_KEYPAD_SPACE
 0xCD

	)

274 
	#HID_KEYBOARD_SC_KEYPAD_AT
 0xCE

	)

275 
	#HID_KEYBOARD_SC_KEYPAD_EXCLAMATION_SIGN
 0xCF

	)

276 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_STORE
 0xD0

	)

277 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_RECALL
 0xD1

	)

278 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_CLEAR
 0xD2

	)

279 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_ADD
 0xD3

	)

280 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_SUBTRACT
 0xD4

	)

281 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_MULTIPLY
 0xD5

	)

282 
	#HID_KEYBOARD_SC_KEYPAD_MEMORY_DIVIDE
 0xD6

	)

283 
	#HID_KEYBOARD_SC_KEYPAD_PLUS_AND_MINUS
 0xD7

	)

284 
	#HID_KEYBOARD_SC_KEYPAD_CLEAR
 0xD8

	)

285 
	#HID_KEYBOARD_SC_KEYPAD_CLEAR_ENTRY
 0xD9

	)

286 
	#HID_KEYBOARD_SC_KEYPAD_BINARY
 0xDA

	)

287 
	#HID_KEYBOARD_SC_KEYPAD_OCTAL
 0xDB

	)

288 
	#HID_KEYBOARD_SC_KEYPAD_DECIMAL
 0xDC

	)

289 
	#HID_KEYBOARD_SC_KEYPAD_HEXADECIMAL
 0xDD

	)

290 
	#HID_KEYBOARD_SC_LEFT_CONTROL
 0xE0

	)

291 
	#HID_KEYBOARD_SC_LEFT_SHIFT
 0xE1

	)

292 
	#HID_KEYBOARD_SC_LEFT_ALT
 0xE2

	)

293 
	#HID_KEYBOARD_SC_LEFT_GUI
 0xE3

	)

294 
	#HID_KEYBOARD_SC_RIGHT_CONTROL
 0xE4

	)

295 
	#HID_KEYBOARD_SC_RIGHT_SHIFT
 0xE5

	)

296 
	#HID_KEYBOARD_SC_RIGHT_ALT
 0xE6

	)

297 
	#HID_KEYBOARD_SC_RIGHT_GUI
 0xE7

	)

327 
	#HID_DESCRIPTOR_JOYSTICK
(
NumAxis
, 
MöAxisVÆ
, 
MaxAxisVÆ
, 
MöPhysiˇlVÆ
, 
MaxPhysiˇlVÆ
, 
Buâ⁄s
Ë\

	)

328 
HID_RI_USAGE_PAGE
(8, 0x01), \

329 
HID_RI_USAGE
(8, 0x04), \

330 
HID_RI_COLLECTION
(8, 0x01), \

331 
HID_RI_USAGE
(8, 0x01), \

332 
HID_RI_COLLECTION
(8, 0x00), \

333 
HID_RI_USAGE_MINIMUM
(8, 0x30), \

334 
HID_RI_USAGE_MAXIMUM
(8, (0x30 + (
NumAxis
 - 1))), \

335 
HID_RI_LOGICAL_MINIMUM
(16, 
MöAxisVÆ
), \

336 
HID_RI_LOGICAL_MAXIMUM
(16, 
MaxAxisVÆ
), \

337 
HID_RI_PHYSICAL_MINIMUM
(16, 
MöPhysiˇlVÆ
), \

338 
HID_RI_PHYSICAL_MAXIMUM
(16, 
MaxPhysiˇlVÆ
), \

339 
HID_RI_REPORT_COUNT
(8, 
NumAxis
), \

340 
HID_RI_REPORT_SIZE
(8, ((((
MöAxisVÆ
 >-0xFFË&& (
MaxAxisVÆ
 <= 0xFF)) ? 8 : 16))), \

341 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
), \

342 
HID_RI_END_COLLECTION
(0), \

343 
HID_RI_USAGE_PAGE
(8, 0x09), \

344 
HID_RI_USAGE_MINIMUM
(8, 0x01), \

345 
HID_RI_USAGE_MAXIMUM
(8, 
Buâ⁄s
), \

346 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

347 
HID_RI_LOGICAL_MAXIMUM
(8, 0x01), \

348 
HID_RI_REPORT_SIZE
(8, 0x01), \

349 
HID_RI_REPORT_COUNT
(8, 
Buâ⁄s
), \

350 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
), \

351 
HID_RI_REPORT_SIZE
(8, (8 - (
Buâ⁄s
 % 8))), \

352 
HID_RI_REPORT_COUNT
(8, 0x01), \

353 
HID_RI_INPUT
(8, 
HID_IOF_CONSTANT
), \

354 
HID_RI_END_COLLECTION
(0)

372 
	#HID_DESCRIPTOR_KEYBOARD
(
MaxKeys
Ë\

	)

373 
HID_RI_USAGE_PAGE
(8, 0x01), \

374 
HID_RI_USAGE
(8, 0x06), \

375 
HID_RI_COLLECTION
(8, 0x01), \

376 
HID_RI_USAGE_PAGE
(8, 0x07), \

377 
HID_RI_USAGE_MINIMUM
(8, 0xE0), \

378 
HID_RI_USAGE_MAXIMUM
(8, 0xE7), \

379 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

380 
HID_RI_LOGICAL_MAXIMUM
(8, 0x01), \

381 
HID_RI_REPORT_COUNT
(8, 0x08), \

382 
HID_RI_REPORT_SIZE
(8, 0x01), \

383 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
), \

384 
HID_RI_INPUT
(8, 
HID_IOF_CONSTANT
 | 
HID_IOF_VARIABLE
), \

385 
HID_RI_REPORT_COUNT
(8, 0x05), \

386 
HID_RI_USAGE_PAGE
(8, 0x08), \

387 
HID_RI_USAGE_MINIMUM
(8, 0x01), \

388 
HID_RI_USAGE_MAXIMUM
(8, 0x05), \

389 
HID_RI_OUTPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
 | 
HID_IOF_NON_VOLATILE
), \

390 
HID_RI_REPORT_COUNT
(8, 0x01), \

391 
HID_RI_REPORT_SIZE
(8, 0x03), \

392 
HID_RI_OUTPUT
(8, 
HID_IOF_CONSTANT
), \

393 
HID_RI_REPORT_COUNT
(8, 0x06), \

394 
HID_RI_REPORT_SIZE
(8, 0x08), \

395 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

397 
HID_RI_USAGE_PAGE
(8, 0x07), \

398 
HID_RI_USAGE_MINIMUM
(8, 0x00), \

400 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_ARRAY
 | 
HID_IOF_ABSOLUTE
), \

401 
HID_RI_END_COLLECTION
(0)

433 
	#HID_DESCRIPTOR_MOUSE
(
MöAxisVÆ
, 
MaxAxisVÆ
, 
MöPhysiˇlVÆ
, 
MaxPhysiˇlVÆ
, 
Buâ⁄s
, 
AbsﬁuãCo‹ds
Ë\

	)

434 
HID_RI_USAGE_PAGE
(8, 0x01), \

435 
HID_RI_USAGE
(8, 0x02), \

436 
HID_RI_COLLECTION
(8, 0x01), \

437 
HID_RI_USAGE
(8, 0x01), \

438 
HID_RI_COLLECTION
(8, 0x00), \

439 
HID_RI_USAGE_PAGE
(8, 0x09), \

440 
HID_RI_USAGE_MINIMUM
(8, 0x01), \

441 
HID_RI_USAGE_MAXIMUM
(8, 
Buâ⁄s
), \

442 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

443 
HID_RI_LOGICAL_MAXIMUM
(8, 0x01), \

444 
HID_RI_REPORT_COUNT
(8, 
Buâ⁄s
), \

445 
HID_RI_REPORT_SIZE
(8, 0x01), \

446 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
), \

447 
HID_RI_REPORT_COUNT
(8, 0x01), \

448 
HID_RI_REPORT_SIZE
(8, (8 - (
Buâ⁄s
 % 8))), \

449 
HID_RI_INPUT
(8, 
HID_IOF_CONSTANT
), \

450 
HID_RI_USAGE_PAGE
(8, 0x01), \

451 
HID_RI_USAGE
(8, 0x30), \

452 
HID_RI_USAGE
(8, 0x31), \

453 
HID_RI_LOGICAL_MINIMUM
(16, 
MöAxisVÆ
), \

454 
HID_RI_LOGICAL_MAXIMUM
(16, 
MaxAxisVÆ
), \

455 
HID_RI_PHYSICAL_MINIMUM
(16, 
MöPhysiˇlVÆ
), \

456 
HID_RI_PHYSICAL_MAXIMUM
(16, 
MaxPhysiˇlVÆ
), \

457 
HID_RI_REPORT_COUNT
(8, 0x02), \

458 
HID_RI_REPORT_SIZE
(8, ((((
MöAxisVÆ
 >-0xFFË&& (
MaxAxisVÆ
 <= 0xFF)) ? 8 : 16))), \

459 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | (
AbsﬁuãCo‹ds
 ? 
HID_IOF_ABSOLUTE
 : 
HID_IOF_RELATIVE
)), \

460 
HID_RI_END_COLLECTION
(0), \

461 
HID_RI_END_COLLECTION
(0)

474 
	#HID_DESCRIPTOR_VENDOR
(
Víd‹PageNum
, 
CﬁÀ˘i⁄Ußge
, 
D©aINUßge
, 
D©aOUTUßge
, 
NumByãs
Ë\

	)

475 
HID_RI_USAGE_PAGE
(16, (0xFF00 | 
Víd‹PageNum
)), \

476 
HID_RI_USAGE
(8, 
CﬁÀ˘i⁄Ußge
), \

477 
HID_RI_COLLECTION
(8, 0x01), \

478 
HID_RI_USAGE
(8, 
D©aINUßge
), \

479 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

480 
HID_RI_LOGICAL_MAXIMUM
(8, 0xFF), \

481 
HID_RI_REPORT_SIZE
(8, 0x08), \

482 
HID_RI_REPORT_COUNT
(8, 
NumByãs
), \

483 
HID_RI_INPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
), \

484 
HID_RI_USAGE
(8, 
D©aOUTUßge
), \

485 
HID_RI_LOGICAL_MINIMUM
(8, 0x00), \

486 
HID_RI_LOGICAL_MAXIMUM
(8, 0xFF), \

487 
HID_RI_REPORT_SIZE
(8, 0x08), \

488 
HID_RI_REPORT_COUNT
(8, 
NumByãs
), \

489 
HID_RI_OUTPUT
(8, 
HID_IOF_DATA
 | 
HID_IOF_VARIABLE
 | 
HID_IOF_ABSOLUTE
 | 
HID_IOF_NON_VOLATILE
), \

490 
HID_RI_END_COLLECTION
(0)

497 
	eHID_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


499 
HID_CSCP_HIDCœss
 = 0x03,

502 
HID_CSCP_N⁄BoŸSub˛ass
 = 0x00,

505 
HID_CSCP_BoŸSub˛ass
 = 0x01,

508 
HID_CSCP_N⁄BoŸPrŸocﬁ
 = 0x00,

511 
HID_CSCP_KeybﬂrdBoŸPrŸocﬁ
 = 0x01,

514 
HID_CSCP_Mou£BoŸPrŸocﬁ
 = 0x02,

520 
	eHID_CœssReque°s_t


522 
HID_REQ_GëRï‹t
 = 0x01,

523 
HID_REQ_GëIdÀ
 = 0x02,

524 
HID_REQ_GëPrŸocﬁ
 = 0x03,

525 
HID_REQ_SëRï‹t
 = 0x09,

526 
HID_REQ_SëIdÀ
 = 0x0A,

527 
HID_REQ_SëPrŸocﬁ
 = 0x0B,

531 
	eHID_Des¸ùt‹Ty≥s_t


533 
HID_DTYPE_HID
 = 0x21,

534 
HID_DTYPE_Rï‹t
 = 0x22,

535 
HID_DTYPE_Physiˇl
 = 0x23,

539 
	eHID_Rï‹tIãmTy≥s_t


541 
HID_REPORT_ITEM_In
 = 0,

542 
HID_REPORT_ITEM_Out
 = 1,

543 
HID_REPORT_ITEM_Fótuª
 = 2,

544 
HID_REPORT_CUSTOM
 = 3,

558 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

560 
u16
 
HIDS≥c
;

561 
u8
 
Cou¡ryCode
;

563 
u8
 
TŸÆRï‹tDes¸ùt‹s
;

565 
u8
 
HIDRï‹tTy≥
;

566 
u8
 
HIDRï‹tLígth
[2];

567 }
	tUSB_HID_Des¸ùt‹_HID_t
;

581 
u8
 
bLígth
;

582 
u8
 
bDes¸ùt‹Ty≥
;

586 
u16
 
bcdHID
;

587 
u8
 
bCou¡ryCode
;

589 
u8
 
bNumDes¸ùt‹s
;

591 
u8
 
bDes¸ùt‹Ty≥2
;

592 
u8
 
wDes¸ùt‹Lígth
[2];

593 }
	tUSB_HID_StdDes¸ùt‹_HID_t
;

601 
u8
 
Buâ⁄
;

602 
s8
 
X
;

603 
s8
 
Y
;

604 }
	tUSB_Mou£Rï‹t_D©a_t
;

612 
u8
 
Modifõr
;

615 
u8
 
Re£rved
;

616 
u8
 
KeyCode
[6];

617 }
	tUSB_KeybﬂrdRï‹t_D©a_t
;

620 
u8
 
	tUSB_Des¸ùt‹_HIDRï‹t_D©©y≥_t
;

623 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/HIDClassDevice.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

30 #i‡
deföed
(
__˝lu•lus
)

46 
	susbhid_c⁄fig_t


48 
u8
 
I¡îÁ˚Numbî
;

50 
u8
 
Rï‹tINEndpoötNumbî
;

51 
u16
 
Rï‹tINEndpoötSize
;

52 
boﬁ
 
Rï‹tINEndpoötDoubÀB™k
;

54 * 
PªvRï‹tINBuf„r
;

66 
u8
 
PªvRï‹tINBuf„rSize
;

72 } 
	tusbhid_c⁄fig_t
;

75 
	susbhid_°©e_t


77 
boﬁ
 
UsögRï‹tPrŸocﬁ
;

78 
u16
 
PªvFømeNum
;

79 
u16
 
IdÀCou¡
;

80 
u16
 
IdÀMSRemaöög
;

82 } 
	tusbhid_°©e_t
;

88 } 
USB_CœssInfo_HID_Devi˚_t
;

92 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/HIDReportData.h

24 #¥agm®
⁄˚


27 #i‡!
deföed
(
__DOXYGEN__
)

29 
	#HID_RI_DATA_SIZE_MASK
 0x03

	)

30 
	#HID_RI_TYPE_MASK
 0x0C

	)

31 
	#HID_RI_TAG_MASK
 0xF0

	)

33 
	#HID_RI_TYPE_MAIN
 0x00

	)

34 
	#HID_RI_TYPE_GLOBAL
 0x04

	)

35 
	#HID_RI_TYPE_LOCAL
 0x08

	)

37 
	#HID_RI_DATA_BITS_0
 0x00

	)

38 
	#HID_RI_DATA_BITS_8
 0x01

	)

39 
	#HID_RI_DATA_BITS_16
 0x02

	)

40 
	#HID_RI_DATA_BITS_32
 0x03

	)

41 
	#HID_RI_DATA_BITS
(
D©aBôs
Ë
HID_RI_DATA_BITS_
 ## 
	)
DataBits

43 
	#_HID_RI_ENCODE_0
(
D©a
)

	)

44 
	#_HID_RI_ENCODE_8
(
D©a
Ë, (D©®& 0xFF)

	)

45 
	#_HID_RI_ENCODE_16
(
D©a
Ë
	`_HID_RI_ENCODE_8
(D©aË_HID_RI_ENCODE_8(D©®>> 8)

	)

46 
	#_HID_RI_ENCODE_32
(
D©a
Ë
	`_HID_RI_ENCODE_16
(D©aË_HID_RI_ENCODE_16(D©®>> 16)

	)

47 
	#_HID_RI_ENCODE
(
D©aBôs
, ...Ë
_HID_RI_ENCODE_
 ## 
	`D©aBôs
(
__VA_ARGS__
)

	)

49 
	#_HID_RI_ENTRY
(
Ty≥
, 
Tag
, 
D©aBôs
, ...Ë(Ty≥ | Tag | 
	`HID_RI_DATA_BITS
(D©aBôs)Ë
	`_HID_RI_ENCODE
(D©aBôs, (
__VA_ARGS__
))

	)

56 
	#HID_IOF_CONSTANT
 (1 << 0)

	)

57 
	#HID_IOF_DATA
 (0 << 0)

	)

58 
	#HID_IOF_VARIABLE
 (1 << 1)

	)

59 
	#HID_IOF_ARRAY
 (0 << 1)

	)

60 
	#HID_IOF_RELATIVE
 (1 << 2)

	)

61 
	#HID_IOF_ABSOLUTE
 (0 << 2)

	)

62 
	#HID_IOF_WRAP
 (1 << 3)

	)

63 
	#HID_IOF_NO_WRAP
 (0 << 3)

	)

64 
	#HID_IOF_NON_LINEAR
 (1 << 4)

	)

65 
	#HID_IOF_LINEAR
 (0 << 4)

	)

66 
	#HID_IOF_NO_PREFERRED_STATE
 (1 << 5)

	)

67 
	#HID_IOF_PREFERRED_STATE
 (0 << 5)

	)

68 
	#HID_IOF_NULLSTATE
 (1 << 6)

	)

69 
	#HID_IOF_NO_NULL_POSITION
 (0 << 6)

	)

70 
	#HID_IOF_VOLATILE
 (1 << 7)

	)

71 
	#HID_IOF_NON_VOLATILE
 (0 << 7)

	)

72 
	#HID_IOF_BUFFERED_BYTES
 (1 << 8)

	)

73 
	#HID_IOF_BITFIELD
 (0 << 8)

	)

78 
	#HID_RI_INPUT
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_MAIN
 , 0x80, D©aBôs, 
__VA_ARGS__
)

	)

79 
	#HID_RI_OUTPUT
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_MAIN
 , 0x90, D©aBôs, 
__VA_ARGS__
)

	)

80 
	#HID_RI_COLLECTION
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_MAIN
 , 0xA0, D©aBôs, 
__VA_ARGS__
)

	)

81 
	#HID_RI_FEATURE
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_MAIN
 , 0xB0, D©aBôs, 
__VA_ARGS__
)

	)

82 
	#HID_RI_END_COLLECTION
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_MAIN
 , 0xC0, D©aBôs, 
__VA_ARGS__
)

	)

83 
	#HID_RI_USAGE_PAGE
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x00, D©aBôs, 
__VA_ARGS__
)

	)

84 
	#HID_RI_LOGICAL_MINIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x10, D©aBôs, 
__VA_ARGS__
)

	)

85 
	#HID_RI_LOGICAL_MAXIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x20, D©aBôs, 
__VA_ARGS__
)

	)

86 
	#HID_RI_PHYSICAL_MINIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x30, D©aBôs, 
__VA_ARGS__
)

	)

87 
	#HID_RI_PHYSICAL_MAXIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x40, D©aBôs, 
__VA_ARGS__
)

	)

88 
	#HID_RI_UNIT_EXPONENT
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x50, D©aBôs, 
__VA_ARGS__
)

	)

89 
	#HID_RI_UNIT
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x60, D©aBôs, 
__VA_ARGS__
)

	)

90 
	#HID_RI_REPORT_SIZE
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x70, D©aBôs, 
__VA_ARGS__
)

	)

91 
	#HID_RI_REPORT_ID
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x80, D©aBôs, 
__VA_ARGS__
)

	)

92 
	#HID_RI_REPORT_COUNT
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0x90, D©aBôs, 
__VA_ARGS__
)

	)

93 
	#HID_RI_PUSH
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0xA0, D©aBôs, 
__VA_ARGS__
)

	)

94 
	#HID_RI_POP
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_GLOBAL
, 0xB0, D©aBôs, 
__VA_ARGS__
)

	)

95 
	#HID_RI_USAGE
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_LOCAL
 , 0x00, D©aBôs, 
__VA_ARGS__
)

	)

96 
	#HID_RI_USAGE_MINIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_LOCAL
 , 0x10, D©aBôs, 
__VA_ARGS__
)

	)

97 
	#HID_RI_USAGE_MAXIMUM
(
D©aBôs
, ...Ë
	`_HID_RI_ENTRY
(
HID_RI_TYPE_LOCAL
 , 0x20, D©aBôs, 
__VA_ARGS__
)

	)

	@proj/drivers/usb/usbstd/MassStorageClassCommon.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"StdDes¸ùt‹s.h
"

31 #i‡
deföed
(
__˝lu•lus
)

35 #¥agm®
∑ck
(1)

39 
	#MS_CBW_SIGNATURE
 0x43425355UL

	)

42 
	#MS_CSW_SIGNATURE
 0x53425355UL

	)

45 
	#MS_COMMAND_DIR_DATA_OUT
 (0 << 7)

	)

48 
	#MS_COMMAND_DIR_DATA_IN
 (1 << 7)

	)

53 
	#SCSI_CMD_INQUIRY
 0x12

	)

56 
	#SCSI_CMD_REQUEST_SENSE
 0x03

	)

59 
	#SCSI_CMD_TEST_UNIT_READY
 0x00

	)

62 
	#SCSI_CMD_READ_CAPACITY_10
 0x25

	)

65 
	#SCSI_CMD_SEND_DIAGNOSTIC
 0x1D

	)

68 
	#SCSI_CMD_PREVENT_ALLOW_MEDIUM_REMOVAL
 0x1E

	)

71 
	#SCSI_CMD_WRITE_10
 0x2A

	)

74 
	#SCSI_CMD_READ_10
 0x28

	)

77 
	#SCSI_CMD_WRITE_6
 0x0A

	)

80 
	#SCSI_CMD_READ_6
 0x08

	)

83 
	#SCSI_CMD_VERIFY_10
 0x2F

	)

86 
	#SCSI_CMD_MODE_SENSE_6
 0x1A

	)

89 
	#SCSI_CMD_MODE_SENSE_10
 0x5A

	)

95 
	#SCSI_SENSE_KEY_GOOD
 0x00

	)

98 
	#SCSI_SENSE_KEY_RECOVERED_ERROR
 0x01

	)

101 
	#SCSI_SENSE_KEY_NOT_READY
 0x02

	)

104 
	#SCSI_SENSE_KEY_MEDIUM_ERROR
 0x03

	)

107 
	#SCSI_SENSE_KEY_HARDWARE_ERROR
 0x04

	)

110 
	#SCSI_SENSE_KEY_ILLEGAL_REQUEST
 0x05

	)

115 
	#SCSI_SENSE_KEY_UNIT_ATTENTION
 0x06

	)

118 
	#SCSI_SENSE_KEY_DATA_PROTECT
 0x07

	)

121 
	#SCSI_SENSE_KEY_BLANK_CHECK
 0x08

	)

124 
	#SCSI_SENSE_KEY_VENDOR_SPECIFIC
 0x09

	)

127 
	#SCSI_SENSE_KEY_COPY_ABORTED
 0x0A

	)

130 
	#SCSI_SENSE_KEY_ABORTED_COMMAND
 0x0B

	)

133 
	#SCSI_SENSE_KEY_VOLUME_OVERFLOW
 0x0D

	)

136 
	#SCSI_SENSE_KEY_MISCOMPARE
 0x0E

	)

142 
	#SCSI_ASENSE_NO_ADDITIONAL_INFORMATION
 0x00

	)

145 
	#SCSI_ASENSE_LOGICAL_UNIT_NOT_READY
 0x04

	)

148 
	#SCSI_ASENSE_INVALID_FIELD_IN_CDB
 0x24

	)

153 
	#SCSI_ASENSE_NOT_READY_TO_READY_CHANGE
 0x28

	)

156 
	#SCSI_ASENSE_WRITE_PROTECTED
 0x27

	)

159 
	#SCSI_ASENSE_FORMAT_ERROR
 0x31

	)

162 
	#SCSI_ASENSE_INVALID_COMMAND
 0x20

	)

165 
	#SCSI_ASENSE_LOGICAL_BLOCK_ADDRESS_OUT_OF_RANGE
 0x21

	)

168 
	#SCSI_ASENSE_MEDIUM_NOT_PRESENT
 0x3A

	)

174 
	#SCSI_ASENSEQ_NO_QUALIFIER
 0x00

	)

177 
	#SCSI_ASENSEQ_FORMAT_COMMAND_FAILED
 0x01

	)

182 
	#SCSI_ASENSEQ_INITIALIZING_COMMAND_REQUIRED
 0x02

	)

185 
	#SCSI_ASENSEQ_OPERATION_IN_PROGRESS
 0x07

	)

192 
	eMS_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


194 
MS_CSCP_MassSt‹ageCœss
 = 0x08,

197 
MS_CSCP_SCSITøn•¨ítSub˛ass
 = 0x06,

201 
MS_CSCP_BulkO∆yTøn•‹tPrŸocﬁ
 = 0x50,

207 
	eMS_CœssReque°s_t


209 
MS_REQ_GëMaxLUN
 = 0xFE,

212 
MS_REQ_MassSt‹ageRe£t
 = 0xFF,

218 
	eMS_Comm™dSètusCodes_t


220 
MS_SCSI_COMMAND_Pass
 = 0,

221 
MS_SCSI_COMMAND_Faû
 = 1,

224 
MS_SCSI_COMMAND_Pha£Eº‹
 = 2,

236 
u32
 
Sig«tuª
;

237 
u32
 
Tag
;

238 
u32
 
D©aTøns„rLígth
;

239 
u8
 
Fœgs
;

240 
u8
 
LUN
;

241 
u8
 
SCSIComm™dLígth
;

242 
u8
 
SCSIComm™dD©a
[16];

243 } 
	tMS_Comm™dBlockWøµî_t
;

253 
u32
 
Sig«tuª
;

254 
u32
 
Tag
;

255 
u32
 
D©aTøns„rResidue
;

256 
u8
 
Sètus
;

257 } 
	tMS_Comm™dSètusWøµî_t
;

268 
u8
 
Re•⁄£Code
;

270 
u8
 
SegmítNumbî
;

272 
u8
 
Sí£Key
 : 4;

273 
u8
 
Re£rved
 : 1;

274 
u8
 
ILI
 : 1;

275 
u8
 
EOM
 : 1;

276 
u8
 
FûeM¨k
 : 1;

278 
u8
 
Inf‹m©i⁄
[4];

279 
u8
 
Addôi⁄ÆLígth
;

280 
u8
 
CmdS≥cificInf‹m©i⁄
[4];

281 
u8
 
Addôi⁄ÆSí£Code
;

282 
u8
 
Addôi⁄ÆSí£QuÆifõr
;

283 
u8
 
FõldRïœ˚abÀUnôCode
;

284 
u8
 
Sí£KeyS≥cific
[3];

285 } 
	tSCSI_Reque°_Sí£_Re•⁄£_t
;

297 
u8
 
Devi˚Ty≥
 : 5;

298 
u8
 
PîùhîÆQuÆifõr
 : 3;

300 
u8
 
Re£rved
 : 7;

301 
u8
 
RemovabÀ
 : 1;

303 
u8
 
Vîsi⁄
;

305 
u8
 
Re•⁄£D©aF‹m©
 : 4;

306 
u8
 
Re£rved2
 : 1;

307 
u8
 
N‹mACA
 : 1;

308 
u8
 
TrmTsk
 : 1;

309 
u8
 
AERC
 : 1;

311 
u8
 
Addôi⁄ÆLígth
;

312 
u8
 
Re£rved3
[2];

314 
u8
 
So·Re£t
 : 1;

315 
u8
 
CmdQue
 : 1;

316 
u8
 
Re£rved4
 : 1;

317 
u8
 
Löked
 : 1;

318 
u8
 
Sync
 : 1;

319 
u8
 
WideBus16Bô
 : 1;

320 
u8
 
WideBus32Bô
 : 1;

321 
u8
 
RñAddr
 : 1;

323 
u8
 
Víd‹ID
[8];

324 
u8
 
Produ˘ID
[16];

325 
u8
 
Revisi⁄ID
[4];

326 } 
	tSCSI_Inquúy_Re•⁄£_t
;

328 #¥agm®
∑ck
()

331 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/PrinterClassCommon.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

28 
	~"bô.h
"

31 #i‡
deföed
(
__˝lu•lus
)

40 
	#PRNT_PORTSTATUS_NOTERROR
 
	`BIT
(3)

	)

43 
	#PRNT_PORTSTATUS_SELECT
 
	`BIT
(4)

	)

46 
	#PRNT_PORTSTATUS_PAPEREMPTY
 
	`BIT
(5)

	)

53 
	ePRNT_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


55 
PRNT_CSCP_PröãrCœss
 = 0x07,

58 
PRNT_CSCP_PröãrSub˛ass
 = 0x01,

61 
PRNT_CSCP_Bidúe˘i⁄ÆPrŸocﬁ
 = 0x02,

67 
	ePRNT_CœssReque°s_t


69 
PRNT_REQ_GëDevi˚ID
 = 0x00,

73 
PRNT_REQ_GëP‹tSètus
 = 0x01,

76 
PRNT_REQ_So·Re£t
 = 0x02,

82 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/StdDescriptors.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

30 #i‡
deföed
(
__˝lu•lus
)

40 
	#NO_DESCRIPTOR
 0

	)

46 
	#USB_CONFIG_POWER_MA
(
mA
Ë((mAË>> 1)

	)

53 
	#USB_STRING_LEN
(
UnicodeCh¨s
Ë((
USB_Des¸ùt‹_Hódî_t
Ë+ ((UnicodeCh¨sË<< 1))

	)

58 
	#LANGUAGE_ID_ENG
 0x0409

	)

65 
	#USB_CONFIG_ATTR_RESERVED
 0x80

	)

70 
	#USB_CONFIG_ATTR_SELFPOWERED
 0x40

	)

77 
	#USB_CONFIG_ATTR_REMOTEWAKEUP
 0x20

	)

87 
	#ENDPOINT_ATTR_NO_SYNC
 (0 << 2)

	)

94 
	#ENDPOINT_ATTR_ASYNC
 (1 << 2)

	)

101 
	#ENDPOINT_ATTR_ADAPTIVE
 (2 << 2)

	)

108 
	#ENDPOINT_ATTR_SYNC
 (3 << 2)

	)

118 
	#ENDPOINT_USAGE_DATA
 (0 << 4)

	)

125 
	#ENDPOINT_USAGE_FEEDBACK
 (1 << 4)

	)

132 
	#ENDPOINT_USAGE_IMPLICIT_FEEDBACK
 (2 << 4)

	)

137 
	eUSB_Des¸ùt‹Ty≥s_t


139 
DTYPE_Devi˚
 = 0x01,

140 
DTYPE_C⁄figuøti⁄
 = 0x02,

141 
DTYPE_Såög
 = 0x03,

142 
DTYPE_I¡îÁ˚
 = 0x04,

143 
DTYPE_Endpoöt
 = 0x05,

144 
DTYPE_Devi˚QuÆifõr
 = 0x06,

145 
DTYPE_Othî
 = 0x07,

146 
DTYPE_I¡îÁ˚Powî
 = 0x08,

147 
DTYPE_I¡îÁ˚Assocüti⁄
 = 0x0B,

148 
DTYPE_CSI¡îÁ˚
 = 0x24,

149 
DTYPE_CSEndpoöt
 = 0x25,

153 
	eUSB_Des¸ùt‹_CœssSub˛assPrŸocﬁ_t


155 
USB_CSCP_NoDevi˚Cœss
 = 0x00,

158 
USB_CSCP_NoDevi˚Sub˛ass
 = 0x00,

161 
USB_CSCP_NoDevi˚PrŸocﬁ
 = 0x00,

164 
USB_CSCP_Víd‹S≥cificCœss
 = 0xFF,

167 
USB_CSCP_Víd‹S≥cificSub˛ass
 = 0xFF,

170 
USB_CSCP_Víd‹S≥cificPrŸocﬁ
 = 0xFF,

173 
USB_CSCP_IADDevi˚Cœss
 = 0xEF,

176 
USB_CSCP_IADDevi˚Sub˛ass
 = 0x02,

179 
USB_CSCP_IADDevi˚PrŸocﬁ
 = 0x01,

196 
u8
 
Size
;

197 
u8
 
Ty≥
;

200 }
	tUSB_Des¸ùt‹_Hódî_t
;

213 
u8
 
bLígth
;

214 
u8
 
bDes¸ùt‹Ty≥
;

217 }
	tUSB_StdDes¸ùt‹_Hódî_t
;

230 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

232 
u16
 
USBS≥cifiˇti⁄
;

233 
u8
 
Cœss
;

234 
u8
 
SubCœss
;

235 
u8
 
PrŸocﬁ
;

237 
u8
 
Endpoöt0Size
;

239 
u16
 
Víd‹ID
;

240 
u16
 
Produ˘ID
;

241 
u16
 
Rñó£Numbî
;

243 
u8
 
M™uÁ˘uªrSåIndex
;

249 
u8
 
Produ˘SåIndex
;

253 
u8
 
SîülNumSåIndex
;

265 
u8
 
NumbîOfC⁄figuøti⁄s
;

268 }
	tUSB_Des¸ùt‹_Devi˚_t
;

281 
u8
 
bLígth
;

282 
u8
 
bDes¸ùt‹Ty≥
;

285 
u16
 
bcdUSB
;

286 
u8
 
bDevi˚Cœss
;

287 
u8
 
bDevi˚SubCœss
;

288 
u8
 
bDevi˚PrŸocﬁ
;

289 
u8
 
bMaxPackëSize0
;

290 
u16
 
idVíd‹
;

291 
u16
 
idProdu˘
;

292 
u16
 
bcdDevi˚
;

293 
u8
 
iM™uÁ˘uªr
;

299 
u8
 
iProdu˘
;

303 
u8
 
iSîülNumbî
;

315 
u8
 
bNumC⁄figuøti⁄s
;

318 }
	tUSB_StdDes¸ùt‹_Devi˚_t
;

329 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

331 
u16
 
USBS≥cifiˇti⁄
;

332 
u8
 
Cœss
;

333 
u8
 
SubCœss
;

334 
u8
 
PrŸocﬁ
;

336 
u8
 
Endpoöt0Size
;

337 
u8
 
NumbîOfC⁄figuøti⁄s
;

340 
u8
 
Re£rved
;

341 }
	tUSB_Des¸ùt‹_Devi˚QuÆifõr_t
;

352 
u8
 
bLígth
;

353 
u8
 
bDes¸ùt‹Ty≥
;

356 
u16
 
bcdUSB
;

357 
u8
 
bDevi˚Cœss
;

358 
u8
 
bDevi˚SubCœss
;

359 
u8
 
bDevi˚PrŸocﬁ
;

360 
u8
 
bMaxPackëSize0
;

361 
u8
 
bNumC⁄figuøti⁄s
;

364 
u8
 
bRe£rved
;

365 }
	tUSB_StdDes¸ùt‹_Devi˚QuÆifõr_t
;

378 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

380 
u16
 
TŸÆC⁄figuøti⁄Size
;

383 
u8
 
TŸÆI¡îÁ˚s
;

385 
u8
 
C⁄figuøti⁄Numbî
;

386 
u8
 
C⁄figuøti⁄SåIndex
;

388 
u8
 
C⁄figAâribuãs
;

392 
u8
 
MaxPowîC⁄sum±i⁄
;

396 }
	tUSB_Des¸ùt‹_C⁄figuøti⁄_Hódî_t
;

409 
u8
 
bLígth
;

410 
u8
 
bDes¸ùt‹Ty≥
;

413 
u16
 
wTŸÆLígth
;

416 
u8
 
bNumI¡îÁ˚s
;

417 
u8
 
bC⁄figuøti⁄VÆue
;

418 
u8
 
iC⁄figuøti⁄
;

419 
u8
 
bmAâribuãs
;

422 
u8
 
bMaxPowî
;

426 }
	tUSB_StdDes¸ùt‹_C⁄figuøti⁄_Hódî_t
;

439 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

441 
u8
 
I¡îÁ˚Numbî
;

442 
u8
 
A…î«ãSëtög
;

447 
u8
 
TŸÆEndpoöts
;

449 
u8
 
Cœss
;

450 
u8
 
SubCœss
;

451 
u8
 
PrŸocﬁ
;

453 
u8
 
I¡îÁ˚SåIndex
;

454 }
	tUSB_Des¸ùt‹_I¡îÁ˚_t
;

467 
u8
 
bLígth
;

468 
u8
 
bDes¸ùt‹Ty≥
;

471 
u8
 
bI¡îÁ˚Numbî
;

472 
u8
 
bA…î«ãSëtög
;

477 
u8
 
bNumEndpoöts
;

478 
u8
 
bI¡îÁ˚Cœss
;

479 
u8
 
bI¡îÁ˚SubCœss
;

480 
u8
 
bI¡îÁ˚PrŸocﬁ
;

481 
u8
 
iI¡îÁ˚
;

484 }
	tUSB_StdDes¸ùt‹_I¡îÁ˚_t
;

503 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

505 
u8
 
Fú°I¡îÁ˚Index
;

506 
u8
 
TŸÆI¡îÁ˚s
;

508 
u8
 
Cœss
;

509 
u8
 
SubCœss
;

510 
u8
 
PrŸocﬁ
;

512 
u8
 
IADSåIndex
;

515 }
	tUSB_Des¸ùt‹_I¡îÁ˚_Assocüti⁄_t
;

535 
u8
 
bLígth
;

536 
u8
 
bDes¸ùt‹Ty≥
;

539 
u8
 
bFú°I¡îÁ˚
;

540 
u8
 
bI¡îÁ˚Cou¡
;

541 
u8
 
bFun˘i⁄Cœss
;

542 
u8
 
bFun˘i⁄SubCœss
;

543 
u8
 
bFun˘i⁄PrŸocﬁ
;

544 
u8
 
iFun˘i⁄
;

547 }
	tUSB_StdDes¸ùt‹_I¡îÁ˚_Assocüti⁄_t
;

560 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

562 
u8
 
EndpoötAddªss
;

565 
u8
 
Aâribuãs
;

568 
u16
 
EndpoötSize
;

571 
u8
 
PﬁlögI¡îvÆMS
;

574 }
	tUSB_Des¸ùt‹_Endpoöt_t
;

588 
u8
 
bLígth
;

589 
u8
 
bDes¸ùt‹Ty≥
;

592 
u8
 
bEndpoötAddªss
;

595 
u8
 
bmAâribuãs
;

598 
u16
 
wMaxPackëSize
;

601 
u8
 
bI¡îvÆ
;

604 }
	tUSB_StdDes¸ùt‹_Endpoöt_t
;

621 #i‚de‡
__GNUC__


622 #¥agm®
w¨nög
(
push
)

623 #¥agm®
w¨nög
(
dißbÀ
:4200)

628 
USB_Des¸ùt‹_Hódî_t
 
Hódî
;

629 
wch¨_t
 
UnicodeSåög
[];

641 }
	tUSB_Des¸ùt‹_Såög_t
;

661 
u8
 
bLígth
;

662 
u8
 
bDes¸ùt‹Ty≥
;

665 
wch¨_t
 
bSåög
[];

674 }
	tUSB_StdDes¸ùt‹_Såög_t
;

676 #i‚de‡
__GNUC__


677 #¥agm®
w¨nög
(
p›
)

691 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/StdRequestType.h

24 #¥agm®
⁄˚


27 
	~"ty≥s.h
"

30 #i‡
deföed
(
__˝lu•lus
)

41 
	#CONTROL_REQTYPE_DIRECTION
 0x80

	)

48 
	#CONTROL_REQTYPE_TYPE
 0x60

	)

56 
	#CONTROL_REQTYPE_RECIPIENT
 0x1F

	)

64 
	#REQDIR_HOSTTODEVICE
 (0 << 7)

	)

70 
	#REQDIR_DEVICETOHOST
 (1 << 7)

	)

79 
	#REQTYPE_STANDARD
 (0 << 5)

	)

85 
	#REQTYPE_CLASS
 (1 << 5)

	)

91 
	#REQTYPE_VENDOR
 (2 << 5)

	)

100 
	#REQREC_DEVICE
 (0 << 0)

	)

107 
	#REQREC_INTERFACE
 (1 << 0)

	)

114 
	#REQREC_ENDPOINT
 (2 << 0)

	)

121 
	#REQREC_OTHER
 (3 << 0)

	)

123 
	#FEATURE_SELFPOWERED_ENABLED
 (1 << 0)

	)

124 
	#FEATURE_REMOTE_WAKEUP_ENABLED
 (1 << 1)

	)

136 
u8
 
bmReque°Ty≥
;

137 
u8
 
bReque°
;

138 
u16
 
wVÆue
;

139 
u16
 
wIndex
;

140 
u16
 
wLígth
;

141 }
	tUSB_Reque°_Hódî_t
;

150 
	eUSB_C⁄åﬁ_Reque°_t


152 
REQ_GëSètus
 = 0,

156 
REQ_CÀ¨Fótuª
 = 1,

160 
REQ_SëFótuª
 = 3,

164 
REQ_SëAddªss
 = 5,

168 
REQ_GëDes¸ùt‹
 = 6,

172 
REQ_SëDes¸ùt‹
 = 7,

175 
REQ_GëC⁄figuøti⁄
 = 8,

179 
REQ_SëC⁄figuøti⁄
 = 9,

183 
REQ_GëI¡îÁ˚
 = 10,

186 
REQ_SëI¡îÁ˚
 = 11,

189 
REQ_SynchFøme
 = 12,

197 
	eUSB_Fótuª_Sñe˘‹s_t


199 
FEATURE_SEL_EndpoötHÆt
 = 0x00,

204 
FEATURE_SEL_Devi˚RemŸeWakeup
 = 0x01,

209 
FEATURE_SEL_Te°Mode
 = 0x02,

216 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/USBController.h

24 #¥agm®
⁄˚


27 #i‡
deföed
(
__˝lu•lus
)

37 
	#ENDPOINT_DIR_MASK
 0x80

	)

42 
	#ENDPOINT_DIR_OUT
 0x00

	)

47 
	#ENDPOINT_DIR_IN
 0x80

	)

55 
	#EP_TYPE_MASK
 0x03

	)

61 
	#EP_TYPE_CONTROL
 0x00

	)

67 
	#EP_TYPE_ISOCHRONOUS
 0x01

	)

73 
	#EP_TYPE_BULK
 0x02

	)

79 
	#EP_TYPE_INTERRUPT
 0x03

	)

93 
	#EP_SYNC_TYPE_NO_SYNC
 0

	)

94 
	#EP_SYNC_TYPE_ASYN
 1

	)

95 
	#EP_SYNC_TYPE_ADAPTIVE
 2

	)

96 
	#EP_SYNC_TYPE_SYNC
 3

	)

98 
	#EP_USAGE_TYPE_DATA
 0

	)

99 
	#EP_USAGE_TYPE_FEEDBACK
 1

	)

100 
	#EP_USAGE_TYPE_FEEDBACK_DATA
 2

	)

101 
	#EP_USAGE_TYPE_RSV
 3

	)

106 #i‡
deföed
(
__˝lu•lus
)

	@proj/drivers/usb/usbstd/usbstd.h

24 #¥agm®
⁄˚


27 
	~"AudioCœssComm⁄.h
"

28 
	~"CDCCœssComm⁄.h
"

29 
	~"CDCCœssDevi˚.h
"

30 
	~"HIDCœssComm⁄.h
"

31 
	~"HIDCœssDevi˚.h
"

32 
	~"HIDRï‹tD©a.h
"

33 
	~"PröãrCœssComm⁄.h
"

34 
	~"StdReque°Ty≥.h
"

35 
	~"StdDes¸ùt‹s.h
"

36 
	~"USBC⁄åﬁÀr.h
"

	@proj/os/ev.c

24 
	~"../é_comm⁄.h
"

25 
	~"ev.h
"

27 
sys_ex˚±i⁄_cb_t
 
	gg_sysEx˚±CÆlbak
 = 
NULL
;

30 vﬁ©ûê
u16
 
	gT_evtEx˚±
[4] = {0};

31 
u8
 
	$sys_ex˚±i⁄Po°
(
u16
 
löe
, 
u8
 
evt
)

33 
T_evtEx˚±
[0] = 
löe
;

34 
T_evtEx˚±
[1] = 
evt
;

37 if(
g_sysEx˚±CÆlbak
){

38 
	`g_sysEx˚±CÆlbak
();

42 
	}
}

44 
	$sys_°ackSètusCheck
()

46 
u32
 
_íd_bss_
;

47 
u8
 *
°ackEnd
 = (u8*)&
_íd_bss_
;

48 
u8
 
°ackOvîÊown
 = 0;

49 
s32
 
i
 = 0; i < 4; i++){

50 if(
°ackEnd
[
i
] != 0xff){

52 
°ackOvîÊown
 = 1;

57 if(
°ackOvîÊown
){

58 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_STACK_OVERFLOWN
);

60 
	}
}

62 
	$sys_ex˚±H™dÀrRegi°î
(
sys_ex˚±i⁄_cb_t
 
cb
)

64 
g_sysEx˚±CÆlbak
 = 
cb
;

65 
	}
}

67 
	$ev_maö
()

69 
	`ev_timî_¥o˚ss
();

70 
	`ev_pﬁl_¥o˚ss
();

73 
	}
}

	@proj/os/ev.h

24 #¥agm®
⁄˚


28 
	mSYS_EXCEPTTION_COMMON_MEM_ACCESS
 = 0,

29 
	mSYS_EXCEPTTION_COMMON_TIMER_EVEVT
,

30 
	mSYS_EXCEPTTION_COMMON_BUFFER_OVERFLOWN
,

31 
	mSYS_EXCEPTTION_COMMON_STACK_OVERFLOWN
,

32 
	mSYS_EXCEPTTION_COMMON_PARAM_ERROR
,

33 
	mSYS_EXCEPTTION_COMMON_TASK_POST
,

35 
	mSYS_EXCEPTTION_ZB_BUFFER_OVERFLOWN
 = 0x10,

36 
	mSYS_EXCEPTTION_ZB_BUFFER_EXCEPTION_FREE_OVERFLON
,

37 
	mSYS_EXCEPTTION_ZB_BUFFER_EXCEPTION_FREE_MULIT
,

38 
	mSYS_EXCEPTTION_ZB_BUFFER_EXCEPTION
,

39 
	mSYS_EXCEPTTION_ZB_TIMER_TASK
,

40 
	mSYS_EXCEPTTION_ZB_TASK_POST
,

42 
	mSYS_EXCEPTTION_ZB_MAC_TX_IRQ
 = 0x20,

43 
	mSYS_EXCEPTTION_ZB_MAC_TX_TIMER
,

44 
	mSYS_EXCEPTTION_ZB_MAC_CSMA
,

45 
	mSYS_EXCEPTTION_ZB_MAC_TRX_TASK
,

47 
	mSYS_EXCEPTTION_ZB_NWK_ADDR_IDX
 = 0x30,

48 
	mSYS_EXCEPTTION_ZB_NWK_BRC_INFO
,

49 
	mSYS_EXCEPTTION_ZB_NWK_GET_ENTRY
,

50 
	mSYS_EXCEPTTION_ZB_NWK_NEIGHBOR_TABLE
,

51 
	mSYS_EXCEPTTION_ZB_NWK_ROUTE_TABLE
,

52 
	mSYS_EXCEPTTION_ZB_NWK_LINK_STA_MEM_ALLOC_FAIL
,

54 
	mSYS_EXCEPTTION_ZB_SS_KEY_INDEX
 = 0x40,

56 
	mSYS_EXCEPTTION_ZB_APS_PARAM
 = 0x50,

57 
	mSYS_EXCEPTTION_ZB_APS_FRAGMENT_TRANS
,

58 
	mSYS_EXCEPTTION_ZB_APS_FRAGMENT_RCV
,

60 
	mSYS_EXCEPTTION_ZB_ZCL_ENTRY
 = 0x60,

62 
	mSYS_EXCEPTTION_EV_BUFFER_OVERFLOWN
 = 0x70,

63 
	mSYS_EXCEPTTION_EV_BUFFER_EXCEPTION_FREE_OVERFLON
,

64 
	mSYS_EXCEPTTION_EV_BUFFER_EXCEPTION_FREE_MULIT
,

65 
	mSYS_EXCEPTTION_EV_TASK_POST
,

68 (*
	tsys_ex˚±i⁄_cb_t
)();

70 
	`sys_ex˚±H™dÀrRegi°î
(
sys_ex˚±i⁄_cb_t
 
cb
);

72 
u8
 
	`sys_ex˚±i⁄Po°
(
u16
 
löe
, u8 
evt
);

73 
	#ZB_EXCEPTION_POST
(
evt
Ë
	`sys_ex˚±i⁄Po°
(
__LINE__
,Évt)

	)

76 
	`ev_maö
();

	@proj/os/ev_buffer.c

24 
	~"../é_comm⁄.h
"

25 
	~"ev_buf„r.h
"

28 
	#DEFAULT_BUFFER_GROUP_NUM
 4

	)

32 
mem_poﬁ_t
 *
	mqHód
;

33 
u16
 
	msize
;

34 
u8
 
	mavaûBufNum
;

35 
u8
 
	mª£rved
;

36 } 
	tev_buf_groups_t
;

39 
	sbufm_v¨s
 {

40 
ev_buf_groups_t
 
	mbufGroups
[
DEFAULT_BUFFER_GROUP_NUM
];

41 } 
	tev_buf_v¨s_t
;

44 
ev_buf_v¨s_t
 
	gev_buf_vs
;

45 
ev_buf_v¨s_t
 *
	gev_buf_v
 = &
ev_buf_vs
;

48 
MEMPOOL_DECLARE
(
size_0_poﬁ
, 
size_0_mem
, 
BUFFER_GROUP_0
, 
BUFFER_NUM_IN_GROUP0
);

49 
MEMPOOL_DECLARE
(
size_1_poﬁ
, 
size_1_mem
, 
BUFFER_GROUP_1
, 
BUFFER_NUM_IN_GROUP1
);

50 
MEMPOOL_DECLARE
(
size_2_poﬁ
, 
size_2_mem
, 
BUFFER_GROUP_2
, 
BUFFER_NUM_IN_GROUP2
);

51 
MEMPOOL_DECLARE
(
size_3_poﬁ
, 
size_3_mem
, 
BUFFER_GROUP_3
, 
BUFFER_NUM_IN_GROUP3
);

63 
u8
 
	$ev_buf_isExi°ed
(
u8
 
ödex
, 
mem_block_t
 *
block
)

65 
mem_poﬁ_t
 *
poﬁ
 = (mem_poﬁ_à*)
ev_buf_v
->
bufGroups
[
ödex
].
qHód
;

66 
mem_block_t
 *
curBlock
 = 
poﬁ
->
‰ì_li°
;

68 
curBlock
){

69 if(
block
 =
curBlock
){

70  
TRUE
;

72 
curBlock
 = curBlock->
√xt_block
;

75  
FALSE
;

76 
	}
}

78 
u8
 *
	$ev_buf_ªåiveMempoﬁHódî
(
u8
 *
pd
)

80  
pd
 - (
	`OFFSETOF
(
ev_bufIãm_t
, 
d©a
Ë- OFFSETOF(
mem_block_t
, data));

81 
	}
}

93 
	$ev_buf_ª£t
()

95 
u16
 
size
[
DEFAULT_BUFFER_GROUP_NUM
] = {
BUFFER_GROUP_0
, 
BUFFER_GROUP_1
, 
BUFFER_GROUP_2
, 
BUFFER_GROUP_3
};

96 
mem_poﬁ_t
 *
memPoﬁ
[
DEFAULT_BUFFER_GROUP_NUM
] = {&
size_0_poﬁ
, &
size_1_poﬁ
, &
size_2_poﬁ
, &
size_3_poﬁ
};

97 
u8
 *
mem
[
DEFAULT_BUFFER_GROUP_NUM
] = {
size_0_mem
, 
size_1_mem
, 
size_2_mem
, 
size_3_mem
};

98 
u8
 
buffC¡
[
DEFAULT_BUFFER_GROUP_NUM
] = {
BUFFER_NUM_IN_GROUP0
, 
BUFFER_NUM_IN_GROUP1
, 
BUFFER_NUM_IN_GROUP2
, 
BUFFER_NUM_IN_GROUP3
};

100 
	`mem£t
((
u8
 *)
ev_buf_v
, 0, (
ev_buf_v¨s_t
));

103 
u8
 
i
 = 0; i < 
DEFAULT_BUFFER_GROUP_NUM
; i++){

104 
ev_buf_v
->
bufGroups
[
i
].
avaûBufNum
 = 
buffC¡
[i];

105 
ev_buf_v
->
bufGroups
[
i
].
qHód
 = 
	`mempoﬁ_öô
(
memPoﬁ
[i], 
mem
[i], 
size
[i], 
buffC¡
[i]);

106 
ev_buf_v
->
bufGroups
[
i
].
size
 = size[i];

108 
	}
}

119 
	$ev_buf_öô
()

121 
	`ev_buf_ª£t
();

122 
	}
}

137 #i‡
EV_BUFFER_DEBUG


138 
u8
 *
	$my_ev_buf_Æloˇã
(
u16
 
size
, u16 
löe
)

140 
u8
 *
	$ev_buf_Æloˇã
(
u16
 
size
)

143 if((
size
 =0Ë|| (sizê> 
MAX_BUFFER_SIZE
)){

145  
NULL
;

147 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

148 
u8
 
ödex
 = 
U8_MAX
;

151 
u8
 
i
 = 0; i < 
DEFAULT_BUFFER_GROUP_NUM
; i++){

152 if((
size
 <
ev_buf_v
->
bufGroups
[
i
].sizê- 
	`OFFSETOF
(
ev_bufIãm_t
, 
d©a
)Ë&&Év_buf_v->bufGroups[i].
avaûBufNum
){

153 
ödex
 = 
i
;

157 if((
ödex
 =
U8_MAX
 ) || (!
ev_buf_v
->
bufGroups
[ödex].
avaûBufNum
)){

159 
	`drv_ª°‹e_úq
(
r
);

160  
NULL
;

162 
u8
 *
ãmp
 = (u8 *)
	`mempoﬁ_Æloc
(
ev_buf_v
->
bufGroups
[
ödex
].
qHód
);

163 if(!
ãmp
){

164 
	`drv_ª°‹e_úq
(
r
);

165  
NULL
;

167 
ev_buf_v
->
bufGroups
[
ödex
].
avaûBufNum
--;

169 
ev_bufIãm_t
 *
pNewBuf
 = (ev_bufIãm_à*)(
ãmp
 - 4);

170 
pNewBuf
->
groupIndex
 = 
ödex
;

171 #i‡
EV_BUFFER_DEBUG


172 
pNewBuf
->
löe
 =Üine;

173 
pNewBuf
->
Êag
 = 0xfe;

175 
	`drv_ª°‹e_úq
(
r
);

176  
pNewBuf
->
d©a
;

177 
	}
}

179 
u8
 *
	$l⁄g_ev_buf_gë
(){

180  
	`ev_buf_Æloˇã
(
MAX_BUFFER_SIZE
);

181 
	}
}

192 #i‡
EV_BUFFER_DEBUG


193 vﬁ©ûê
u32
 
	gT_DBG_evFªeBuf
 = 0;

194 vﬁ©ûê
u16
 
	gT_DBG_evFªeBufLöe
 = 0;

195 
buf_°s_t
 
	$my_ev_buf_‰ì
(
u8
 *
pBuf
, 
u16
 
löe
)

197 
buf_°s_t
 
	$ev_buf_‰ì
(
u8
 *
pBuf
)

200 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

202 if(!
	`is_ev_buf
(
pBuf
)){

203 #i‡
EV_BUFFER_DEBUG


204 
T_DBG_evFªeBuf
 = (
u32
)
pBuf
;

205 
T_DBG_evFªeBufLöe
 = 
löe
;

208 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_EV_BUFFER_EXCEPTION_FREE_OVERFLON
);

211 
ev_bufIãm_t
 *
pDñBuf
 = 
	`ev_buf_gëHód
(
pBuf
);

214 if(
	`ev_buf_isExi°ed
(
pDñBuf
->
groupIndex
, (
mem_block_t
 *)pDelBuf)){

216 #i‡
EV_BUFFER_DEBUG


217 
T_DBG_evFªeBuf
 = (
u32
)
pBuf
;

218 
T_DBG_evFªeBufLöe
 = 
löe
;

221 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_EV_BUFFER_EXCEPTION_FREE_MULIT
);

223 
	`drv_ª°‹e_úq
(
r
);

224  
BUFFER_DUPLICATE_FREE
;

227 
	`mempoﬁ_‰ì
(
ev_buf_v
->
bufGroups
[
pDñBuf
->
groupIndex
].
qHód
, 
	`ev_buf_ªåiveMempoﬁHódî
(
pBuf
));

228 
ev_buf_v
->
bufGroups
[
pDñBuf
->
groupIndex
].
avaûBufNum
++;

230 #i‡
EV_BUFFER_DEBUG


231 
pDñBuf
->
löe
 =Üine;

232 
pDñBuf
->
Êag
 = 0xff;

235 
	`drv_ª°‹e_úq
(
r
);

236  
BUFFER_SUCC
;

237 
	}
}

248 
ev_bufIãm_t
 *
	$ev_buf_gëHód
(
u8
 *
pd
)

250  (
ev_bufIãm_t
 *)(
pd
 - 
	`OFFSETOF
”v_bufIãm_t, 
d©a
));

251 
	}
}

263 
u8
 *
	$ev_buf_gëTaû
(
u8
 *
pd
, 
off£tToTaû
)

265 
u32
 
ödex
;

266 
u16
 
size
[
DEFAULT_BUFFER_GROUP_NUM
] = {
BUFFER_GROUP_0
, 
BUFFER_GROUP_1
, 
BUFFER_GROUP_2
};

268 
	`mem˝y
((
u8
*)&
ödex
, 
pd
 - 4, 4);

269 
	`as£π
((
ödex
 < 3) && (index >= 0));

270  (
u8
*)(
pd
 - 8 + 
size
[
ödex
] - 
off£tToTaû
);

271 
	}
}

273 
u8
 
	$is_ev_buf
(*
¨g
){

274 if–((
u32
)
¨g
 >(u32)(
size_0_mem
) && (u32)arg <= ((u32)(size_0_mem) + (size_0_mem))) ||

275 ((
u32
)
¨g
 >(u32)(
size_1_mem
) && (u32)arg <= ((u32)(size_1_mem) + (size_1_mem))) ||

276 ((
u32
)
¨g
 >(u32)(
size_2_mem
) && (u32)arg <= ((u32)(size_2_mem) + (size_2_mem))) ||

277 ((
u32
)
¨g
 >(u32)(
size_3_mem
) && (u32)arg <= ((u32)(size_3_mem) + (size_3_mem))) ){

281 
	}
}

283 
u16
 
	$ev_buf_gëFªeMaxSize
()

285 
u16
 
size
 = 0;

287 
u8
 
i
 = 0; i < 
DEFAULT_BUFFER_GROUP_NUM
; i++){

288 if(
ev_buf_v
->
bufGroups
[
i
].
avaûBufNum
){

289 if((
ev_buf_v
->
bufGroups
[
i
].
size
 - 
	`OFFSETOF
(
ev_bufIãm_t
, 
d©a
)) > size){

290 
size
 = 
ev_buf_v
->
bufGroups
[
i
].sizê- 
	`OFFSETOF
(
ev_bufIãm_t
, 
d©a
);

295  
size
;

296 
	}
}

	@proj/os/ev_buffer.h

24 #¥agm®
⁄˚


32 
	#EV_BUFFER_DEBUG
 0

	)

47 
	#BUFFER_GROUP_0
 24

	)

48 
	#BUFFER_GROUP_1
 60

	)

49 
	#BUFFER_GROUP_2
 150

	)

50 
	#BUFFER_GROUP_3
 1024

	)

51 
	#MAX_BUFFER_SIZE
 
BUFFER_GROUP_3


	)

58 
	#BUFFER_NUM_IN_GROUP0
 8

	)

59 
	#BUFFER_NUM_IN_GROUP1
 8

	)

60 
	#BUFFER_NUM_IN_GROUP2
 8

	)

61 
	#BUFFER_NUM_IN_GROUP3
 1

	)

67 
	#SMALL_BUFFER
 (
BUFFER_GROUP_0
 - 8)

	)

68 
	#LARGE_BUFFER
 (
BUFFER_GROUP_3
 - 8)

	)

83 
	sev_bufIãm
 {

84 
ev_bufIãm
 *
	m√xt
;

85 #i‡
EV_BUFFER_DEBUG


86 
u8
 
	mgroupIndex
;

87 
u8
 
	mÊag
;

88 
u16
 
	mlöe
;

90 
u32
 
	mgroupIndex
;

92 
u8
 
	md©a
[1];

93 } 
	tev_bufIãm_t
;

98 
	ebuf_°s_e
 {

100 
	mBUFFER_SUCC
,

101 
	mBUFFER_INVALID_PARAMETER
 = 1,

102 
	mBUFFER_DUPLICATE_FREE


103 } 
	tbuf_°s_t
;

120 
ev_buf_ª£t
();

129 
ev_buf_öô
();

141 #i‡
EV_BUFFER_DEBUG


142 
u8
 *
my_ev_buf_Æloˇã
(
u16
 
size
, u16 
löe
);

143 
	#ev_buf_Æloˇã
(
size
Ë
	`my_ev_buf_Æloˇã
(size, 
__LINE__
)

	)

145 
u8
 *
ev_buf_Æloˇã
(
u16
 
size
);

155 #i‡
EV_BUFFER_DEBUG


156 
buf_°s_t
 
my_ev_buf_‰ì
(
u8
 *
pBuf
, 
u16
 
löe
);

157 
	#ev_buf_‰ì
(
pBuf
Ë
	`my_ev_buf_‰ì
’Buf, 
__LINE__
)

	)

159 
buf_°s_t
 
ev_buf_‰ì
(
u8
 *
pBuf
);

169 
ev_bufIãm_t
 *
ev_buf_gëHód
(
u8
 *
pd
);

178 
u8
 
is_ev_buf
(*
¨g
);

180 
u16
 
ev_buf_gëFªeMaxSize
();

182 
u8
 *
l⁄g_ev_buf_gë
();

	@proj/os/ev_poll.c

24 
	~"../é_comm⁄.h
"

25 
	~"ev_pﬁl.h
"

28 
ev_pﬁl_t
 
	gev_pﬁl
[
EV_POLL_MAX
];

39 
	$ev_⁄_pﬁl
(
ev_pﬁl_e
 
e
, 
ev_pﬁl_ˇŒback_t
 
cb
)

41 
ev_pﬁl
[
e
].
cb
 = cb;

42 
ev_pﬁl
[
e
].
vÆid
 = 1;

43 
	}
}

52 
	$ev_íabÀ_pﬁl
(
ev_pﬁl_e
 
e
)

54 
ev_pﬁl
[
e
].
vÆid
 = 1;

55 
	}
}

64 
	$ev_dißbÀ_pﬁl
(
ev_pﬁl_e
 
e
)

66 
ev_pﬁl
[
e
].
vÆid
 = 0;

67 
	}
}

76 
	$ev_pﬁl_¥o˚ss
(){

77 
u8
 
i
 = 0; i < 
EV_POLL_MAX
; i++){

78 if(
ev_pﬁl
[
i
].
vÆid
){

79 
ev_pﬁl
[
i
].
	`cb
();

82 
	}
}

	@proj/os/ev_poll.h

24 #¥agm®
⁄˚


31 (*
	tev_pﬁl_ˇŒback_t
)();

36 
	sev_pﬁl_s
 {

37 
ev_pﬁl_ˇŒback_t
 
cb
;

38 
u32
 
vÆid
;

39 } 
	tev_pﬁl_t
;

42 
ev_pﬁl_t
 
ev_pﬁl
[];

51 
	`ev_pﬁl_¥o˚ss
();

61 
	`ev_⁄_pﬁl
(
ev_pﬁl_e
 
e
, 
ev_pﬁl_ˇŒback_t
 
cb
);

70 
	`ev_íabÀ_pﬁl
(
ev_pﬁl_e
 
e
);

79 
	`ev_dißbÀ_pﬁl
(
ev_pﬁl_e
 
e
);

89 
	#EV_SCHEDULE_POLL
(
e
, 
èsk
Ë(
	`ev_⁄_pﬁl
”,Åask))

	)

	@proj/os/ev_queue.c

24 
	~"../é_comm⁄.h
"

39 
ev_queue_°s_t
 
	$ev_queue_øwPush
–
ev_queue_t
* 
q
, 
queue_ôem_t
* 
√wEÀmít
 )

41 
queue_ôem_t
* 
¥evious
;

42 
queue_ôem_t
* 
cuºít
;

44 i‡(
NULL
 =
q
 || NULL =
√wEÀmít
) {

45  
QUEUE_INVALID_PARAMETER
;

48 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

51 i‡(
NULL
==
q
->
hód
) {

52 
q
->
hód
 = 
√wEÀmít
;

53 
q
->
èû
 = 
√wEÀmít
;

54 
√wEÀmít
->
√xt
 = 
NULL
;

55 
q
->
curNum
++;

56 
	`drv_ª°‹e_úq
(
r
);

57  (
ev_queue_°s_t
)
SUCCESS
;

60 
¥evious
 = 
NULL
;

61 
cuºít
 = 
q
->
hód
;

63 i‡(
NULL
 =
q
->
¥iFunc
) {

64 
q
->
èû
->
√xt
 = 
√wEÀmít
;

65 
√wEÀmít
->
√xt
 = 
NULL
;

66 
q
->
èû
 = 
√wEÀmít
;

68 
cuºít
!=
NULL
) {

70 if(
q
->
	`¥iFunc
((
¨g_t
)(
√wEÀmít
)Ë< q->¥iFunc(◊rg_t)(
cuºít
))) {

73 
¥evious
 = 
cuºít
;

74 
cuºít
 = cuºít->
√xt
;

78 if(
NULL
==
¥evious
) {

79 
q
->
hód
 = 
√wEÀmít
;

81 
¥evious
->
√xt
 = 
√wEÀmít
;

83 
√wEÀmít
->
√xt
 = 
cuºít
;

84 i‡(
NULL
==
cuºít
){

85 
q
->
èû
 = 
√wEÀmít
;

88 
q
->
curNum
++;

90 
	`drv_ª°‹e_úq
(
r
);

91  (
ev_queue_°s_t
)
SUCCESS
;

92 
	}
}

103 
queue_ôem_t
* 
	$ev_queue_øwP›
(
ev_queue_t
* 
q
)

105 
queue_ôem_t
* 
ﬁdHód
;

107 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

109 
ﬁdHód
 = 
q
->
hód
;

110 i‡(
NULL
!=
ﬁdHód
){

111 i‡(
ﬁdHód
 =
q
->
èû
) {

112 
q
->
èû
 = 
NULL
;

115 
q
->
hód
 = 
ﬁdHód
->
√xt
;

116 
q
->
curNum
--;

119 i‡–
q
->
curNum
 == 0 ) {

120 
q
->
hód
 = q->
èû
 = 
NULL
;

122 
	`drv_ª°‹e_úq
(
r
);

123  
ﬁdHód
;

124 
	}
}

136 
ev_queue_°s_t
 
	$ev_queue_øwDñëe
(
ev_queue_t
* 
q
, 
queue_ôem_t
* 
dñEÀmít
)

138 
queue_ôem_t
* 
¥evious
;

139 
queue_ôem_t
* 
cuºít
;

141 i‡(
NULL
 =
q
 || NULL =
dñEÀmít
) {

142  
QUEUE_INVALID_PARAMETER
;

145 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

147 i‡(
NULL
 =
q
->
hód
) {

148 
	`drv_ª°‹e_úq
(
r
);

149  
QUEUE_EMPTY
;

152 i‡(
q
->
hód
 =
dñEÀmít
) {

153 
q
->
hód
 = q->hód->
√xt
;

154 i‡(
NULL
 =
q
->
hód
){

155 
q
->
èû
 = 
NULL
;

157 
q
->
curNum
--;

158 
	`drv_ª°‹e_úq
(
r
);

159  (
ev_queue_°s_t
)
SUCCESS
;

163 
¥evious
 = 
NULL
;

164 
cuºít
 = 
q
->
hód
;

166 
cuºít
 !
dñEÀmít
 && current) {

167 
¥evious
 = 
cuºít
;

168 
cuºít
 = cuºít->
√xt
;

171 i‡(
cuºít
) {

173 
¥evious
->
√xt
 = 
cuºít
->next;

174 i‡(
NULL
 =
cuºít
->
√xt
) {

175 
q
->
èû
 = 
¥evious
;

177 
q
->
curNum
--;

181 
	`drv_ª°‹e_úq
(
r
);

182  
QUEUE_NOT_FOUND
;

186 
	`drv_ª°‹e_úq
(
r
);

187  (
ev_queue_°s_t
)
SUCCESS
;

188 
	}
}

203 
ev_queue_°s_t
 
	$ev_queue_öô
–
ev_queue_t
 *
q
, 
ev_¥iFunc_t
 
¥iFunc
)

205 i‡(
NULL
 =
q
) {

206  
QUEUE_INVALID_PARAMETER
;

209 
	`mem£t
((
u8
*)
q
, 0 , (
ev_queue_t
));

210 
q
->
¥iFunc
 =ÖriFunc;

211  (
ev_queue_°s_t
)
SUCCESS
;

212 
	}
}

225 
ev_queue_°s_t
 
	$ev_queue_push
–
ev_queue_t
* 
q
, 
u8
* 
∑ylﬂd
 )

227 
queue_ôem_t
* 
√wEÀmít
;

228 
√wEÀmít
 = (
queue_ôem_t
*)
	`ev_buf_gëHód
(
∑ylﬂd
);

229  
	`ev_queue_øwPush
(
q
, 
√wEÀmít
);

230 
	}
}

242 
u8
* 
	$ev_queue_p›
–
ev_queue_t
* 
q
 )

244 
queue_ôem_t
* 
⁄eIãm
 = 
	`ev_queue_øwP›
(
q
);

246 i‡(
NULL
==
⁄eIãm
) {

247  
NULL
;

249  ((
ev_bufIãm_t
*)
⁄eIãm
)->
d©a
;

251 
	}
}

263 
ev_queue_°s_t
 
	$ev_queue_dñëe
–
ev_queue_t
* 
q
, 
u8
* 
∑ylﬂd
 )

265 
queue_ôem_t
* 
dñEÀmít
 = (queue_ôem_t*)
	`ev_buf_gëHód
(
∑ylﬂd
);

266  
	`ev_queue_øwDñëe
(
q
, 
dñEÀmít
);

267 
	}
}

279 
ev_queue_°s_t
 
	$ev_queue_‰ìQ
–
ev_queue_t
 *
q
 )

281 
u8
 *
buf„r_±r
;

282 i‡(
NULL
 =
q
) {

283  
QUEUE_INVALID_PARAMETER
;

286 
NULL
 !(
buf„r_±r
 = 
	`ev_queue_p›
(
q
))) {

287 
	`ev_buf_‰ì
(
buf„r_±r
);

290  (
ev_queue_°s_t
)
SUCCESS
;

291 
	}
}

	@proj/os/ev_queue.h

24 #¥agm®
⁄˚


44 
	$u32
 (*
	tev_¥iFunc_t
)(
	t¨g_t
);

49 
	squeue_ôem
 {

50 
queue_ôem
 *
√xt
;

51 
u8
 
d©a
[1];

52 } 
	tqueue_ôem_t
;

58 
	s¥iQueue
 {

59 
queue_ôem_t
 *
hód
;

60 
queue_ôem_t
 *
èû
;

61 
ev_¥iFunc_t
 
¥iFunc
;

62 
u32
 
curNum
;

63 } 
	tev_queue_t
;

68 
	eev_queue_°s_e
 {

70 
QUEUE_SUCC
 = 0,

71 
QUEUE_INVALID_PARAMETER
 = 1,

72 
QUEUE_EMPTY
,

73 
QUEUE_NOT_FOUND
,

74 
QUEUE_OVERFLOW
,

75 } 
	tev_queue_°s_t
;

94 
ev_queue_°s_t
 
	`ev_queue_öô
–
ev_queue_t
 *
q
, 
ev_¥iFunc_t
 
¥iFunc
);

105 
ev_queue_°s_t
 
	`ev_queue_push
–
ev_queue_t
* 
q
, 
u8
* 
∑ylﬂd
 );

115 
u8
* 
	`ev_queue_p›
–
ev_queue_t
* 
q
 );

126 
ev_queue_°s_t
 
	`ev_queue_dñëe
–
ev_queue_t
* 
q
, 
u8
* 
∑ylﬂd
 );

136 
ev_queue_°s_t
 
	`ev_queue_‰ìQ
–
ev_queue_t
* 
q
);

148 
ev_queue_°s_t
 
	`ev_queue_øwPush
–
ev_queue_t
* 
q
, 
queue_ôem_t
* 
ñemít
 );

160 
ev_queue_°s_t
 
	`ev_queue_øwDñëe
(
ev_queue_t
* 
q
, 
queue_ôem_t
* 
ñemít
);

170 
queue_ôem_t
* 
	`ev_queue_øwP›
(
ev_queue_t
* 
q
);

	@proj/os/ev_timer.c

24 
	~"../é_comm⁄.h
"

25 
	~"ev_timî.h
"

28 
ev_timî_evít_t
 *
	mtimî_hód
;

29 
ev_timî_evít_t
 *
	mtimî_√¨e°
;

31 
ev_timî_evít_poﬁ_t
 
	mtimîEvítPoﬁ
;

32 }
	tev_timî_˘æ_t
;

34 
u8
 
	gg_ev_timî_maxNum
 = 
TIMER_EVENT_NUM
;

35 
ev_timî_˘æ_t
 
	gev_timî
;

37 
u32
 
	g¥evSysTick
 = 0;

38 
u32
 
	gªmSysTick
 = 0;

40 
	$ev_timî_öô
()

42 
	`mem£t
((
u8
 *)&
ev_timî
, 0, (ev_timer));

43 
	}
}

45 
	$ev_timî_£tPªvSysTick
(
u32
 
tick
)

47 
¥evSysTick
 = 
tick
;

48 
	}
}

50 
ev_timî_evít_t
 *
	$ev_timî_√¨e°Gë
()

52  
ev_timî
.
timî_√¨e°
;

53 
	}
}

55 
ev_timî_evít_t
 *
	$ev_timî_‰ìGë
()

57 if(
ev_timî
.
timîEvítPoﬁ
.
u£d_num
 >
g_ev_timî_maxNum
){

58  
NULL
;

61 
u8
 
i
 = 0; i < 
g_ev_timî_maxNum
; i++){

62 if(
ev_timî
.
timîEvítPoﬁ
.
evt
[
i
].
u£d
 == 0){

63 
ev_timî
.
timîEvítPoﬁ
.
evt
[
i
].
u£d
 = 1;

64 
ev_timî
.
timîEvítPoﬁ
.
u£d_num
++;

65  &
ev_timî
.
timîEvítPoﬁ
.
evt
[
i
];

69  
NULL
;

70 
	}
}

72 
	$ev_timî_poﬁDñUpd©e
(
ev_timî_evít_t
 *
evt
)

74 
evt
->
isRu¬ög
 = 0;

75 
evt
->
curSysTick
 = 0;

77 if(((
u32
)
evt
 >(u32)&
ev_timî
.
timîEvítPoﬁ
.evt[0]) &&

78 ((
u32
)
evt
 <(u32)&
ev_timî
.
timîEvítPoﬁ
.evt[
g_ev_timî_maxNum
 - 1]) &&

79 (
evt
->
u£d
)){

80 
evt
->
u£d
 = 0;

81 
ev_timî
.
timîEvítPoﬁ
.
u£d_num
--;

83 
	}
}

85 
	$ev_timî_√¨e°Upd©e
()

87 
ev_timî_evít_t
 *
timîEvt
 = 
ev_timî
.
timî_hód
;

89 
ev_timî
.
timî_√¨e°
 =Év_timî.
timî_hód
;

91 
timîEvt
){

92 if(
timîEvt
->
timeout
 < 
ev_timî
.
timî_√¨e°
->timeout){

93 
ev_timî
.
timî_√¨e°
 = 
timîEvt
;

95 
timîEvt
 =ÅimîEvt->
√xt
;

97 
	}
}

99 
boﬁ
 
	$ev_timî_íough
()

101 if(
ev_timî
.
timîEvítPoﬁ
.
u£d_num
 < 
TIMER_EVENT_ENOUGH_NUM
){

102  
TRUE
;

104  
FALSE
;

105 
	}
}

107 
boﬁ
 
	$ev_timî_exi°
(
ev_timî_evít_t
 *
evt
)

109 
ev_timî_evít_t
 *
timîEvt
 = 
ev_timî
.
timî_hód
;

111 
timîEvt
){

112 if(
timîEvt
 =
evt
){

113  
TRUE
;

115 
timîEvt
 =ÅimîEvt->
√xt
;

117  
FALSE
;

118 
	}
}

120 
	$ev_⁄_timî
(
ev_timî_evít_t
 *
evt
, 
u32
 
timeout
)

122 if(!
evt
){

123 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_TIMER_EVEVT
);

127 
evt
->
≥riod
 = 
timeout
;

129 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

131 
ev_timî_evít_t
 *
out
 = 
NULL
;

133 
	`LIST_EXIST
(
ev_timî
.
timî_hód
, 
evt
, 
out
);

134 if(
out
){

135 
out
->
timeout
 = 
evt
->
≥riod
;

137 if(
evt
->
isRu¬ög
 == 0){

138 
evt
->
curSysTick
 = 
	`˛ock_time
();

140 
evt
->
timeout
 =Évt->
≥riod
;

141 
	`LIST_ADD
(
ev_timî
.
timî_hód
, 
evt
);

144 
	`ev_timî_√¨e°Upd©e
();

146 
	`drv_ª°‹e_úq
(
r
);

147 
	}
}

149 
	$ev_un⁄_timî
(
ev_timî_evít_t
 *
evt
)

151 if(!
evt
){

152 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_TIMER_EVEVT
);

156 
ev_timî_evít_t
 *
out
 = 
NULL
;

157 
	`LIST_EXIST
(
ev_timî
.
timî_hód
, 
evt
, 
out
);

158 if(!
out
){

162 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

164 
	`ev_timî_poﬁDñUpd©e
(
evt
);

166 
	`LIST_DELETE
(
ev_timî
.
timî_hód
, 
evt
);

168 
	`ev_timî_√¨e°Upd©e
();

170 
	`drv_ª°‹e_úq
(
r
);

171 
	}
}

173 
ev_timî_evít_t
 *
	$ev_timî_add
(
ev_timî_ˇŒback_t
 
func
, *
¨g
, 
u32
 
timeout
)

175 
ev_timî_evít_t
 *
timîEvt
 = 
	`ev_timî_‰ìGë
();

176 if(!
timîEvt
){

177 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_COMMON_TIMER_EVEVT
);

178  
NULL
;

181 
timîEvt
->
cb
 = 
func
;

182 
timîEvt
->
d©a
 = 
¨g
;

184 
	`ev_⁄_timî
(
timîEvt
, 
timeout
);

186  
timîEvt
;

187 
	}
}

189 
ev_timî_evít_t
 *
	$ev_timî_èskPo°
(
ev_timî_ˇŒback_t
 
func
, *
¨g
, 
u32
 
t_ms
)

191 
ev_timî_evít_t
 *
timîEvt
 = 
NULL
;

193 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

195 
timîEvt
 = 
	`ev_timî_add
(
func
, 
¨g
, 
t_ms
);

197 
	`drv_ª°‹e_úq
(
r
);

199  
timîEvt
;

200 
	}
}

202 
u8
 
	$ev_timî_èskC™˚l
(
ev_timî_evít_t
 **
evt
)

204 
u8
 
ªt
 = 
NO_TIMER_AVAIL
;

205 
ev_timî_evít_t
 *
timîEvt
 = *
evt
;

207 if(!
timîEvt
 || !timîEvt->
u£d
){

208  
ªt
;

211 
	`ev_un⁄_timî
(
timîEvt
);

213 *
evt
 = 
NULL
;

215  
SUCCESS
;

216 
	}
}

218 
	$ev_timî_upd©e
(
u32
 
upd©eTime
)

220 
u32
 
upd©eTimeMs
 = 0;

221 
u32
 
curSysTick
 = 
	`˛ock_time
();

223 if(
upd©eTime
 == 0){

227 
u32
 
r
 = 
	`drv_dißbÀ_úq
();

229 
ev_timî_evít_t
 *
timîEvt
 = 
ev_timî
.
timî_hód
;

231 
timîEvt
){

232 if(
timîEvt
->
isRu¬ög
){

234 
upd©eTimeMs
 = 
upd©eTime
;

237 
upd©eTimeMs
 = (
curSysTick
 - 
timîEvt
->curSysTickË/ (
S_TIMER_CLOCK_1US
 * 1000);

239 
timîEvt
->
isRu¬ög
 = 1;

242 if(
timîEvt
->
timeout
 > 
upd©eTimeMs
){

243 
timîEvt
->
timeout
 -
upd©eTimeMs
;

245 
timîEvt
->
timeout
 = 0;

248 
timîEvt
 =ÅimîEvt->
√xt
;

251 
	`drv_ª°‹e_úq
(
r
);

252 
	}
}

254 
	$ev_timî_execuãCB
()

256 
ev_timî_evít_t
 *
timîEvt
 = 
ev_timî
.
timî_hód
;

257 
ev_timî_evít_t
 *
¥ev_hód
 = 
timîEvt
;

259 
timîEvt
){

260 if(
timîEvt
->
timeout
 == 0){

261 
s32
 
t
 = 
timîEvt
->
	`cb
—imîEvt->
d©a
);

263 if(
t
 < 0){

264 
	`ev_un⁄_timî
(
timîEvt
);

265 }if(
t
 == 0){

266 
timîEvt
->
timeout
 =ÅimîEvt->
≥riod
;

268 
timîEvt
->
≥riod
 = (
u32
)
t
;

269 
timîEvt
->
timeout
 =ÅimîEvt->
≥riod
;

272 if(
¥ev_hód
 !
ev_timî
.
timî_hód
){

273 
timîEvt
 = 
ev_timî
.
timî_hód
;

274 
¥ev_hód
 = 
timîEvt
;

276 
timîEvt
 =ÅimîEvt->
√xt
;

279 
timîEvt
 =ÅimîEvt->
√xt
;

283 
	`ev_timî_√¨e°Upd©e
();

284 
	}
}

286 
	$ev_timî_¥o˚ss
()

288 
u32
 
upd©eTime
 = 0;

289 
u32
 
sysTicks
 = 0;

290 
u32
 
cuºSysTick
 = 
	`˛ock_time
();

292 if(
cuºSysTick
 !
¥evSysTick
){

293 
sysTicks
 = (
u32
)(
cuºSysTick
 - 
¥evSysTick
);

296 
¥evSysTick
 = 
cuºSysTick
;

298 
upd©eTime
 = 
sysTicks
 / (
S_TIMER_CLOCK_1US
 * 1000);

299 
ªmSysTick
 +
sysTicks
 % (
S_TIMER_CLOCK_1US
 * 1000);

301 
upd©eTime
 +
ªmSysTick
 / (
S_TIMER_CLOCK_1US
 * 1000);

302 
ªmSysTick
 =ÑemSysTick % (
S_TIMER_CLOCK_1US
 * 1000);

305 if(
upd©eTime
){

306 
	`ev_timî_upd©e
(
upd©eTime
);

307 
	`ev_timî_execuãCB
();

310 
	}
}

	@proj/os/ev_timer.h

24 #¥agm®
⁄˚


30 
	#TIMER_EVENT_NUM
 (24)

	)

31 
	#TIMER_EVENT_ENOUGH_NUM
 (
TIMER_EVENT_NUM
 - 4)

	)

36 (*
	tev_timî_ˇŒback_t
)(*
	td©a
);

41 
	sev_timî_evít_t
 {

42 
ev_timî_evít_t
 *
√xt
;

44 
ev_timî_ˇŒback_t
 
cb
;

45 *
d©a
;

46 
u32
 
timeout
;

47 
u32
 
≥riod
;

48 
u32
 
curSysTick
;

49 
u8
 
ªsv
[2];

50 
u8
 
isRu¬ög
;

51 
u8
 
u£d
;

52 } 
	tev_timî_evít_t
;

54 
	sev_timî_evít_poﬁ_s
 {

55 
ev_timî_evít_t
 
evt
[
TIMER_EVENT_NUM
];

56 
u32
 
u£d_num
;

57 } 
	tev_timî_evít_poﬁ_t
;

60 
boﬁ
 
	`ev_timî_íough
();

61 
	`ev_timî_upd©e
(
u32
 
upd©eTime
);

62 
	`ev_timî_£tPªvSysTick
(
u32
 
tick
);

71 
	`ev_timî_öô
();

80 
	`ev_timî_¥o˚ss
();

89 
ev_timî_evít_t
 *
	`ev_timî_√¨e°Gë
();

99 
boﬁ
 
	`ev_timî_exi°
(
ev_timî_evít_t
 *
evt
);

109 
	`ev_⁄_timî
(
ev_timî_evít_t
 *
evt
, 
u32
 
timeout
);

118 
	`ev_un⁄_timî
(
ev_timî_evít_t
 *
evt
);

131 
ev_timî_evít_t
 *
	`ev_timî_èskPo°
(
ev_timî_ˇŒback_t
 
func
, *
¨g
, 
u32
 
t_ms
);

132 
	#TL_ZB_TIMER_SCHEDULE
(
cb
, 
¨g
, 
timeout
Ë(
	`ev_timî_èskPo°
((cb), (¨g), (timeout)))

	)

141 
u8
 
	`ev_timî_èskC™˚l
(
ev_timî_evít_t
 **
evt
);

142 
	#TL_ZB_TIMER_CANCEL
(
evt
Ë(
	`ev_timî_èskC™˚l
”vt))

	)

	@proj/tl_common.h

32 #¥agm®
⁄˚


35 
	~"≠p_cfg.h
"

36 
	~"∂©f‹m.h
"

38 
	~"comm⁄/ty≥s.h
"

39 
	~"comm⁄/compûî.h
"

40 
	~"comm⁄/°©ic_as£π.h
"

41 
	~"comm⁄/as£π.h
"

42 
	~"comm⁄/bô.h
"

43 
	~"comm⁄/utûôy.h
"

44 
	~"comm⁄/uéi°.h
"

45 
	~"comm⁄/li°.h
"

46 
	~"comm⁄/°rög.h
"

47 
	~"comm⁄/éPrötf.h
"

48 
	~"comm⁄/mempoﬁ.h
"

50 
	~"os/ev_pﬁl.h
"

51 
	~"os/ev_buf„r.h
"

52 
	~"os/ev_queue.h
"

53 
	~"os/ev_timî.h
"

54 
	~"os/ev.h
"

56 
	~"drivîs/drv_hw.h
"

57 
	~"drivîs/drv_ødio.h
"

58 
	~"drivîs/drv_gpio.h
"

59 
	~"drivîs/drv_adc.h
"

60 
	~"drivîs/drv_Êash.h
"

61 
	~"drivîs/drv_i2c.h
"

62 
	~"drivîs/drv_•i.h
"

63 
	~"drivîs/drv_pwm.h
"

64 
	~"drivîs/drv_u¨t.h
"

65 
	~"drivîs/drv_pm.h
"

66 
	~"drivîs/drv_timî.h
"

67 
	~"drivîs/drv_keybﬂrd.h
"

68 
	~"drivîs/drv_nv.h
"

69 
	~"drivîs/drv_putch¨.h
"

70 
	~"drivîs/drv_usb.h
"

72 
	#LOG_ENABLE


73 #ifde‡
LOG_ENABLE


	)

74 
	#LOG
(
fmt
, ...Ë
	`¥ötf
("[%s:%d] " fmà"\n",
__FUNCTION__
, 
__LINE__
, ##
__VA_ARGS__
)

75 #ñ£

	)

76 
	#LOG
(
fmt
, ...)

	)

	@zbhci/uart/hci_uart.c

24 
	~"é_comm⁄.h
"

26 #i‡(
ZBHCI_EN
 && 
ZBHCI_UART
)

27 
	~"zb_èsk_queue.h
"

28 
	~"../zbhci.h
"

30 
	#UART_TX_BUF_SIZE
 64

	)

31 
	#UART_RX_BUF_SIZE
 64

	)

36 
u32
 
	md©aLí
;

37 
u8
 
	md©aPaylﬂd
[1];

38 }
	tu¨t_rxD©a_t
;

40 
__©åibuã__
((
	$Æig√d
(4))Ë
u8
 
u¨tTxBuf
[
UART_TX_BUF_SIZE
] = {0
	}
};

41 
__©åibuã__
((
	$Æig√d
(4))Ë
u8
 
u¨tRxBuf
[
UART_RX_BUF_SIZE
] = {0
	}
};

43 
	$u¨t_d©a_h™dÀr
(*
¨g
){

49 
u8
 
ªt
[4] = {0,0,0,0};

50 
u8
 
°
 = 
SUCCESS
;

52 
u¨t_rxD©a_t
 *
rxD©a
 = (u¨t_rxD©a_à*)
u¨tRxBuf
;

53 
zbhci_msg_t
 *
msg
 = (zbhci_msg_à*)(
rxD©a
->
d©aPaylﬂd
);

55 if(
rxD©a
->
d©aLí
 == 0){

56 
°
 = 
ZBHCI_MSG_STATUS_UART_EXCEPT
;

59 if(
rxD©a
->
d©aLí
 > (
UART_RX_BUF_SIZE
 - 4)){

60 
°
 = 
ZBHCI_MSG_STATUS_MSG_OVERFLOW
;

63 if(
°
 =
SUCCESS
){

64 if(
msg
->
°¨tFœg
 =
ZBHCI_MSG_START_FLAG
){

65 
msg
->
msgTy≥16H
 = 
rxD©a
->
d©aPaylﬂd
[1];

66 
msg
->
msgTy≥16L
 = 
rxD©a
->
d©aPaylﬂd
[2];

67 
msg
->
msgLí16H
 = 
rxD©a
->
d©aPaylﬂd
[3];

68 
msg
->
msgLí16L
 = 
rxD©a
->
d©aPaylﬂd
[4];

71 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

72 if((
pktLí
 + 
ZBHCI_MSG_HDR_LEN
Ë=
rxD©a
->
d©aLí
){

74 if(
rxD©a
->
d©aPaylﬂd
[rxD©a->
d©aLí
 - 1] !
ZBHCI_MSG_END_FLAG
){

75 
°
 = 
ZBHCI_MSG_STATUS_ERROR_END_CHAR
;

78 
°
 = 
ZBHCI_MSG_STATUS_BAD_MSG
;

81 
°
 = 
ZBHCI_MSG_STATUS_ERROR_START_CHAR
;

85 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

86 
u16
 
msgTy≥
 = (
msg
->
msgTy≥16H
<<8Ë+ msg->
msgTy≥16L
;

88 if(
°
 =
SUCCESS
){

89 
u8
 
¸c8
 = 
	`¸c8CÆcuœã
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

90 if((
msgTy≥
 =
ZBHCI_CMD_OTA_START_REQUEST
Ë|| (msgTy≥ =
ZBHCI_CMD_OTA_BLOCK_RESPONSE
)){

91 if(
¸c8
 !
msg
->
checkSum
){

92 
°
 = 
ZBHCI_MSG_STATUS_CRC_ERROR
;

97 if(
°
 =
SUCCESS
){

98 
rxD©a
->
d©aLí
 = 0;

100 
	`zbhciCmdH™dÀr
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

102 
rxD©a
->
d©aLí
 = 0;

104 if((
°
 =
ZBHCI_MSG_STATUS_UART_EXCEPT
Ë|| (° =
ZBHCI_MSG_STATUS_MSG_OVERFLOW
Ë|| (° =
ZBHCI_MSG_STATUS_ERROR_START_CHAR
)){

105 
msg
->
msgTy≥16H
 = 0xff;

106 
msg
->
msgTy≥16L
 = 0xff;

109 
ªt
[0] = 
msg
->
msgTy≥16H
;

110 
ªt
[1] = 
msg
->
msgTy≥16L
;

111 
ªt
[2] = 
°
;

112 
ªt
[3] = 0;

114 
	`zbhciTx
(
ZBHCI_CMD_ACKNOWLEDGE
, 4, 
ªt
);

116 
	}
}

118 
	$u¨tRcvH™dÀr
(){

120 
	`TL_SCHEDULE_TASK
(
u¨t_d©a_h™dÀr
, 
u¨tRxBuf
);

121 
	}
}

123 
	$u¨t_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
)

125 
n
;

126 
u8
 
¸c8
 = 
	`¸c8CÆcuœã
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

128 
u8
 *
p
 = 
u¨tTxBuf
;

129 *
p
++ = 0x55;

130 *
p
++ = (
u16Ty≥
 >> 8) & 0xff;

131 *
p
++ = (
u16Ty≥
 >> 0) & 0xff;

132 *
p
++ = (
u16Lígth
 >> 8) & 0xff;

133 *
p
++ = (
u16Lígth
 >> 0) & 0xff;

134 *
p
++ = 
¸c8
;

135 
n
 = 0;Ç < 
u16Lígth
;Ç++)

137 *
p
++ = 
pu8D©a
[
n
];

139 *
p
++ = 0xAA;

141 
	`drv_u¨t_tx_°¨t
(
u¨tTxBuf
, 
p
 - uartTxBuf);

142 
	}
}

145 
	$hci_u¨t_öô
(){

146 
	`UART_PIN_CFG
();

147 
	`drv_u¨t_öô
(115200, 
u¨tRxBuf
, 
UART_RX_BUF_SIZE
, 
u¨tRcvH™dÀr
);

148 
	}
}

	@zbhci/usbCDC/zbhci_usb_cdc.c

24 
	~"é_comm⁄.h
"

26 #i‡(
ZBHCI_EN
 && 
ZBHCI_USB_CDC
)

27 
	~"drivîs/usb/usb_comm⁄.h
"

28 
	~"zb_èsk_queue.h
"

29 
	~"../zbhci.h
"

32 
	#RX_NDATA_LEN
 7

	)

33 
	#GET_RXPACKETLEN
(
±r
Ë((’å)[3] << 8Ë| (’å)[4]))

	)

35 
	#RX_BUF_LEN
 64

36 
	#TX_BUF_LEN
 64

37 

	)

38 
ev_queue_t
 
	gusbcdc_txPídögQ
;

41 
	$usb_cdc_£nd
(
usbcdc_txBuf_t
 *
pTxBuf
){

42 if(
	`usbcdc_isAvaûabÀ
()){

43 
	`usbcdc_£ndD©a
(
pTxBuf
);

45 
	`ev_queue_push
(&
usbcdc_txPídögQ
, (
u8
*)
pTxBuf
);

47 
	}
}

49 
	$usbcdc_d©a_h™dÀr
(*
¨g
){

54 
u8
 
ªt
[4] = {0,0,0,0};

55 
u8
 
°
 = 
SUCCESS
;

57 
u8
 *
p
 = 
¨g
;

58 
u8
 
Àn
 = 
	`GET_RXPACKETLEN
(
p
Ë+ 
RX_NDATA_LEN
;

59 
u8
 
ídCh¨
 = *(
p
 + 
Àn
 - 1);

61 
zbhci_msg_t
 *
msg
 = (zbhci_msg_à*)
¨g
;

63 if(
msg
->
°¨tFœg
 =
ZBHCI_MSG_START_FLAG
){

65 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

66 if((
pktLí
 + 
ZBHCI_MSG_HDR_LEN
Ë< 
RX_BUF_LEN
){

68 if(
ídCh¨
 !
ZBHCI_MSG_END_FLAG
){

69 
°
 = 
ZBHCI_MSG_STATUS_ERROR_END_CHAR
;

72 
°
 = 
ZBHCI_MSG_STATUS_MSG_OVERFLOW
;

75 
°
 = 
ZBHCI_MSG_STATUS_ERROR_START_CHAR
;

78 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

79 
u16
 
msgTy≥
 = (
msg
->
msgTy≥16H
<<8Ë+ msg->
msgTy≥16L
;

81 if(
°
 =
SUCCESS
){

82 
u8
 
¸c8
 = 
	`¸c8CÆcuœã
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

83 if((
msgTy≥
 =
ZBHCI_CMD_OTA_START_REQUEST
Ë|| (msgTy≥ =
ZBHCI_CMD_OTA_BLOCK_RESPONSE
)){

84 if(
¸c8
 !
msg
->
checkSum
){

85 
°
 = 
ZBHCI_MSG_STATUS_CRC_ERROR
;

90 if(
°
 =
SUCCESS
){

91 
	`zbhciCmdH™dÀr
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

94 if((
°
 =
ZBHCI_MSG_STATUS_UART_EXCEPT
Ë|| (° =
ZBHCI_MSG_STATUS_MSG_OVERFLOW
Ë|| (° =
ZBHCI_MSG_STATUS_ERROR_START_CHAR
)){

95 
msg
->
msgTy≥16H
 = 0xff;

96 
msg
->
msgTy≥16L
 = 0xff;

99 
ªt
[0] = 
msg
->
msgTy≥16H
;

100 
ªt
[1] = 
msg
->
msgTy≥16L
;

101 
ªt
[2] = 
°
;

102 
ªt
[3] = 0;

104 
	`zbhciTx
(
ZBHCI_CMD_ACKNOWLEDGE
, 4, 
ªt
);

107 
	`ev_buf_‰ì
((
u8
 *)
¨g
);

108 
	}
}

110 
	$usbcdc_rxCb
(
u8
 *
pD©a
){

111 
	`TL_SCHEDULE_TASK
(
usbcdc_d©a_h™dÀr
, 
pD©a
);

114 
u8
 *
pBuf
 = 
	`ev_buf_Æloˇã
(
RX_BUF_LEN
);

115 if(!
pBuf
){

118 
	`mem£t
(
pBuf
, 0, 
RX_BUF_LEN
);

119 
	`usbcdc_£tRxBuf
(
pBuf
);

120 
	}
}

122 
	$usbcdc_txFöishCb
(
u8
 *
pD©a
){

124 
	`ev_buf_‰ì
(
pD©a
);

127 if(
usbcdc_txPídögQ
.
curNum
){

128 
usbcdc_txBuf_t
 *
pTxBuf
 = (usbcdc_txBuf_à*)
	`ev_queue_p›
(&
usbcdc_txPídögQ
);

129 
	`usb_cdc_£nd
(
pTxBuf
);

131 
	}
}

133 
	$usb_cdc_öô
(){

135 
	`usbcdc_öô
();

138 
	`usbcdc_£tCb
(
usbcdc_rxCb
, 
usbcdc_txFöishCb
);

141 
u8
 *
pBuf
 = 
	`ev_buf_Æloˇã
(
RX_BUF_LEN
);

142 if(!
pBuf
){

145 
	`mem£t
(
pBuf
, 0, 
RX_BUF_LEN
);

146 
	`usbcdc_£tRxBuf
(
pBuf
);

149 
	`ev_queue_öô
(&
usbcdc_txPídögQ
, 
NULL
);

150 
	}
}

152 
zbhciTx_e
 
	$usb_cdc_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
){

153 if(
u16Lígth
 > 
TX_BUF_LEN
){

154  
ZBHCI_TX_TOO_LONG
;

157 
usbcdc_txBuf_t
 *
pTxBuf
 = (usbcdc_txBuf_à*)
	`ev_buf_Æloˇã
((
u16
Ë+ 
u16Lígth
 + 7);

158 if(!
pTxBuf
){

159  
ZBHCI_TX_FAILED
;

162 
pTxBuf
->
Àn
 = 
u16Lígth
 + 7;

163 
u8
 *
p
 = 
pTxBuf
->
d©a
;

165 *
p
++ = 0x55;

166 *
p
++ = (
u16Ty≥
 >> 8) & 0xff;

167 *
p
++ = (
u16Ty≥
 >> 0) & 0xff;

168 *
p
++ = (
u16Lígth
 >> 8) & 0xff;

169 *
p
++ = (
u16Lígth
 >> 0) & 0xff;

170 *
p
++ = 
	`¸c8CÆcuœã
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

171 
u16
 
n
 = 0;Ç < 
u16Lígth
;Ç++){

172 *
p
++ = 
pu8D©a
[
n
];

174 *
p
++ = 0xAA;

176 
	`usb_cdc_£nd
(
pTxBuf
);

178  
ZBHCI_TX_SUCCESS
;

179 
	}
}

	@zbhci/usbHID/zbhci_usb_hid.c

24 
	~"é_comm⁄.h
"

26 #i‡(
ZBHCI_EN
 && 
ZBHCI_USB_HID
)

27 
	~"drivîs/usb/usb_comm⁄.h
"

28 
	~"zb_èsk_queue.h
"

29 
	~"../zbhci.h
"

32 
	#RX_NDATA_LEN
 7

	)

33 
	#GET_RXPACKETLEN
(
±r
Ë((’å)[3] << 8Ë| (’å)[4]))

	)

35 
	#RX_BUF_LEN
 64

36 
	#TX_BUF_LEN
 64

37 

	)

38 
ev_queue_t
 
	ghidvíd‹_txPídögQ
;

41 
	$hidvíd‹_£nd
(
hidvíd‹_txBuf_t
 *
pTxBuf
){

42 if(
	`hidvíd‹_isAvaûabÀ
()){

43 
	`hidvíd‹_ªp‹tD©a
(
pTxBuf
);

45 
	`ev_queue_push
(&
hidvíd‹_txPídögQ
, (
u8
*)
pTxBuf
);

47 
	}
}

49 
	$hidvíd‹_d©a_h™dÀr
(*
¨g
){

54 
u8
 
ªt
[4] = {0,0,0,0};

55 
u8
 
°
 = 
SUCCESS
;

57 
u8
 *
p
 = 
¨g
;

58 
u8
 
Àn
 = 
	`GET_RXPACKETLEN
(
p
Ë+ 
RX_NDATA_LEN
;

59 
u8
 
ídCh¨
 = *(
p
 + 
Àn
 - 1);

61 
zbhci_msg_t
 *
msg
 = (zbhci_msg_à*)
¨g
;

63 if(
msg
->
°¨tFœg
 =
ZBHCI_MSG_START_FLAG
){

65 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

66 if((
pktLí
 + 
ZBHCI_MSG_HDR_LEN
Ë< 
RX_BUF_LEN
){

68 if(
ídCh¨
 !
ZBHCI_MSG_END_FLAG
){

69 
°
 = 
ZBHCI_MSG_STATUS_ERROR_END_CHAR
;

72 
°
 = 
ZBHCI_MSG_STATUS_MSG_OVERFLOW
;

75 
°
 = 
ZBHCI_MSG_STATUS_ERROR_START_CHAR
;

78 if(
°
 =
SUCCESS
){

79 
u16
 
pktLí
 = (
msg
->
msgLí16H
 << 8Ë| msg->
msgLí16L
;

80 
u16
 
msgTy≥
 = (
msg
->
msgTy≥16H
<<8Ë+ msg->
msgTy≥16L
;

81 
u8
 
¸c8
 = 
	`¸c8CÆcuœã
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

82 if((
msgTy≥
 =
ZBHCI_CMD_OTA_START_REQUEST
Ë|| (msgTy≥ =
ZBHCI_CMD_OTA_BLOCK_RESPONSE
)){

83 if(
¸c8
 !
msg
->
checkSum
){

84 
°
 = 
ZBHCI_MSG_STATUS_CRC_ERROR
;

89 if(
°
 =
SUCCESS
){

90 
	`zbhciCmdH™dÀr
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

92 if((
°
 =
ZBHCI_MSG_STATUS_UART_EXCEPT
Ë|| (° =
ZBHCI_MSG_STATUS_MSG_OVERFLOW
Ë|| (° =
ZBHCI_MSG_STATUS_ERROR_START_CHAR
)){

93 
msg
->
msgTy≥16H
 = 0xff;

94 
msg
->
msgTy≥16L
 = 0xff;

97 
ªt
[0] = 
msg
->
msgTy≥16H
;

98 
ªt
[1] = 
msg
->
msgTy≥16L
;

99 
ªt
[2] = 
°
;

100 
ªt
[3] = 0;

102 
	`zbhciTx
(
ZBHCI_CMD_ACKNOWLEDGE
, 4, 
ªt
);

105 
	`ev_buf_‰ì
((
u8
 *)
¨g
);

106 
	}
}

108 
	$hidvíd‹_rxCb
(
u8
 *
pD©a
){

109 
	`TL_SCHEDULE_TASK
(
hidvíd‹_d©a_h™dÀr
, 
pD©a
);

112 
u8
 *
pBuf
 = 
	`ev_buf_Æloˇã
(
RX_BUF_LEN
);

113 if(!
pBuf
){

116 
	`mem£t
(
pBuf
, 0, 
RX_BUF_LEN
);

117 
	`hidvíd‹_£tRxBuf
(
pBuf
);

118 
	}
}

120 
	$hidvíd‹_txFöishCb
(
u8
 *
pD©a
){

122 
	`ev_buf_‰ì
(
pD©a
);

125 if(
hidvíd‹_txPídögQ
.
curNum
){

126 
hidvíd‹_txBuf_t
 *
pTxBuf
 = (hidvíd‹_txBuf_à*)
	`ev_queue_p›
(&
hidvíd‹_txPídögQ
);

127 
	`hidvíd‹_£nd
(
pTxBuf
);

129 
	}
}

131 
	$usb_hid_öô
(){

133 
	`hidvíd‹_öô
();

136 
	`hidvíd‹_£tCb
(
hidvíd‹_rxCb
, 
hidvíd‹_txFöishCb
);

139 
u8
 *
pBuf
 = 
	`ev_buf_Æloˇã
(
RX_BUF_LEN
);

140 if(!
pBuf
){

143 
	`mem£t
(
pBuf
, 0, 
RX_BUF_LEN
);

144 
	`hidvíd‹_£tRxBuf
(
pBuf
);

147 
	`ev_queue_öô
(&
hidvíd‹_txPídögQ
, 
NULL
);

148 
	}
}

150 
zbhciTx_e
 
	$usb_hid_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
){

151 if(
u16Lígth
 > 
TX_BUF_LEN
){

152  
ZBHCI_TX_TOO_LONG
;

155 
hidvíd‹_txBuf_t
 *
pTxBuf
 = (hidvíd‹_txBuf_à*)
	`ev_buf_Æloˇã
((
u16
Ë+ 
u16Lígth
 + 7);

156 if(!
pTxBuf
){

157  
ZBHCI_TX_FAILED
;

160 
pTxBuf
->
Àn
 = 
u16Lígth
 + 7;

161 
u8
 *
p
 = 
pTxBuf
->
d©a
;

163 *
p
++ = 0x55;

164 *
p
++ = (
u16Ty≥
 >> 8) & 0xff;

165 *
p
++ = (
u16Ty≥
 >> 0) & 0xff;

166 *
p
++ = (
u16Lígth
 >> 8) & 0xff;

167 *
p
++ = (
u16Lígth
 >> 0) & 0xff;

168 *
p
++ = 
	`¸c8CÆcuœã
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

169 
u16
 
n
 = 0;Ç < 
u16Lígth
;Ç++){

170 *
p
++ = 
pu8D©a
[
n
];

172 *
p
++ = 0xAA;

174 
	`hidvíd‹_£nd
(
pTxBuf
);

176  
ZBHCI_TX_SUCCESS
;

177 
	}
}

	@zbhci/usbPrint/hci_usbPrint.c

24 
	~"é_comm⁄.h
"

26 #i‡(
ZBHCI_EN
 && 
ZBHCI_USB_PRINT
)

27 
	~"../zbhci.h
"

29 
u32
 
	gusb_¥öt_öbuf
[64/4];

30 
u32
 
	gusb_¥öt_outbuf
[64/4];

33 
u8
 
	m°©us
;

34 
u8
 
	m∑ylﬂd
[1];

35 }
	tusbPrötCmd_t
;

38 
	mUSB_PRINT_CMD_IDLE
 = 0,

39 
	mUSB_PRINT_CMD_INVALID
 = 0x03,

40 
	mUSB_PRINT_CMD_AF_FROM_APP
 = 0x09,

41 
	mUSB_PRINT_CMD_AF_FROM_STACK
,

44 
	$usb_¥öt_öô
(){

45 
u16
 
usbDevi˚Id
 = *((u16 *)
CFG_TELINK_USB_ID
);

46 
	`wrôe_ªg8
(0x74, 0x53);

48 #ifde‡
CHIP_8269


49 
	`wrôe_ªg16
(0x7e, 
usbDevi˚Id
 ^ 0x01);

51 
	`wrôe_ªg16
(0x7e, 
usbDevi˚Id
);

53 
	`wrôe_ªg8
(0x74, 0);

55 
	`wrôe_ªg16
(0x8004, (
u16
)
usb_¥öt_öbuf
);

56 
	`wrôe_ªg16
(0x8006, (
u16
)
usb_¥öt_outbuf
);

57 
	}
}

59 
u8
 
	$usb_¥öt_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
){

60 
n
;

61 
u8
 
¸c8
 = 
	`¸c8CÆcuœã
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

63 
u8
 *
p
 = 
usb_¥öt_outbuf
;

64 *
p
++ = 0x55;

65 *
p
++ = (
u16Ty≥
 >> 8) & 0xff;

66 *
p
++ = (
u16Ty≥
 >> 0) & 0xff;

67 *
p
++ = (
u16Lígth
 >> 8) & 0xff;

68 *
p
++ = (
u16Lígth
 >> 0) & 0xff;

69 *
p
++ = 
¸c8
;

70 
n
 = 0;Ç < 
u16Lígth
;Ç++)

72 *
p
++ = 
pu8D©a
[
n
];

74 *
p
++ = 0xAA;

75  
ZBHCI_TX_SUCCESS
;

76 
	}
}

78 
	$usb_¥öt_èsk
(){

79 
zbhci_msg_t
 *
msg
 = (zbhci_msg_à*)
usb_¥öt_öbuf
;

80 if(
msg
->
°¨tFœg
 =
ZBHCI_MSG_START_FLAG
){

81 
u16
 
pLí
 = (
msg
->
msgLí16H
<<8Ë+ msg->
msgLí16L
;

82 
u16
 
msgTy≥
 = (
msg
->
msgTy≥16H
<<8Ë+ msg->
msgTy≥16L
;

83 #i‡
ZB_TEST_ENABLE


84 
	`zbhciPro˚ssIncommögSîülCmd
(
msgTy≥
, 
pLí
, 
msg
->
pD©a
);

86 
	`zbhciCmdH™dÀr
(
msgTy≥
, 
pktLí
, 
msg
->
pD©a
);

88 
msg
->
°¨tFœg
 = 0;

90 
	}
}

	@zbhci/zbhci.c

24 
	~"é_comm⁄.h
"

26 #i‡
ZBHCI_EN


27 
	~"zbhci.h
"

28 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


29 
	~"drivîs/usb/usb_comm⁄.h
"

45 #i‡
ZBHCI_USB_PRINT


46 
usb_¥öt_öô
();

47 
u8
 
usb_¥öt_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, u8 *
pu8D©a
);

48 
usb_¥öt_èsk
();

49 #ñi‡
ZBHCI_USB_CDC


50 
usb_cdc_öô
();

51 
zbhciTx_e
 
usb_cdc_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
);

52 #ñi‡
ZBHCI_USB_HID


53 
usb_hid_öô
();

54 
zbhciTx_e
 
usb_hid_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
);

55 #ñi‡
ZBHCI_UART


56 
hci_u¨t_öô
();

57 
u¨t_txMsg
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
);

65 
u8
 
	$¸c8CÆcuœã
(
u16
 
ty≥
, u16 
Àngth
, 
u8
 *
d©a
){

66 
n
;

67 
u8
 
¸c8
;

69 
¸c8
 = (
ty≥
 >> 0) & 0xff;

70 
¸c8
 ^(
ty≥
 >> 8) & 0xff;

71 
¸c8
 ^(
Àngth
 >> 0) & 0xff;

72 
¸c8
 ^(
Àngth
 >> 8) & 0xff;

74 
n
 = 0;Ç < 
Àngth
;Ç++) {

75 
¸c8
 ^
d©a
[
n
];

78  
¸c8
;

79 
	}
}

86 
zbhciTx_e
 
	$zbhciTx
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
){

87 #i‡
ZBHCI_USB_PRINT


88  
	`usb_¥öt_txMsg
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

89 #ñi‡
ZBHCI_USB_CDC


90  
	`usb_cdc_txMsg
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

91 #ñi‡
ZBHCI_UART


92 
	`u¨t_txMsg
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

93  
ZBHCI_TX_SUCCESS
;

94 #ñi‡
ZBHCI_USB_HID


95  
	`usb_hid_txMsg
(
u16Ty≥
, 
u16Lígth
, 
pu8D©a
);

96 #ñi‡
ZBHCI_SPI


98 #ñi‡
ZBHCI_I2C


101  
ZBHCI_TX_FAILED
;

102 
	}
}

104 
	$zbhciInô
(){

105 #i‡
ZBHCI_USB_PRINT
 || 
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


107 
	`HW_USB_CFG
();

108 #i‡
ZBHCI_USB_PRINT


109 
	`usb_¥öt_öô
();

111 #ñi‡
ZBHCI_USB_CDC


112 
	`usb_cdc_öô
();

113 #ñi‡
ZBHCI_USB_HID


114 
	`usb_hid_öô
();

116 
	`usb_öô
();

117 #ñi‡
ZBHCI_UART


118 
	`hci_u¨t_öô
();

119 #ñi‡
ZBHCI_SPI


121 #ñi‡
ZBHCI_I2C


124 
	}
}

126 
	$zbhciTask
(){

127 #i‡
ZBHCI_USB_PRINT


128 
	`usb_¥öt_èsk
();

129 #ñi‡
ZBHCI_USB_CDC
 || 
ZBHCI_USB_HID


130 
	`usb_h™dÀ_úq
();

131 #ñi‡
ZBHCI_UART


133 
	`drv_u¨t_ex˚±i⁄Pro˚ss
();

134 #ñi‡
ZBHCI_SPI


136 #ñi‡
ZBHCI_I2C


139 
	}
}

	@zbhci/zbhci.h

24 #i‚de‡
ZBHCI_H


25 
	#ZBHCI_H


	)

37 
	#ZBHCI_MSG_STATUS_ERROR_START_CHAR
 0xE0

	)

38 
	#ZBHCI_MSG_STATUS_MSG_OVERFLOW
 0xE1

	)

39 
	#ZBHCI_MSG_STATUS_ERROR_END_CHAR
 0xE2

	)

40 
	#ZBHCI_MSG_STATUS_BAD_MSG
 0xE3

	)

41 
	#ZBHCI_MSG_STATUS_UART_EXCEPT
 0xE4

	)

42 
	#ZBHCI_MSG_STATUS_CRC_ERROR
 0xE5

	)

44 
	#ZBHCI_MSG_START_FLAG
 0x55

	)

45 
	#ZBHCI_MSG_END_FLAG
 0xAA

	)

46 
	#ZBHCI_MSG_HDR_LEN
 0x07

	)

48 
	#HCI_OTA_BLOCK_SIZE_MAX
 40

	)

49 
	#HCI_OTA_BLOCK_INTERVAL_NORMAL
 10

	)

50 
	#HCI_OTA_BLOCK_REQUEST_RETRY_INTERVAL
 5*100

	)

51 
	#HCI_OTA_BLOCK_REQUEST_RETRY_CNT_MAX
 5

	)

54 
	mZBHCI_GET_MAC_ADDR_MODE
,

55 
	mZBHCI_NORMAL_MODE


56 }
	tw‹kögMode_e
;

59 
	mZBHCI_CMD_BDB_COMMISSION_FORMATION
 = 0x0001,

60 
	mZBHCI_CMD_BDB_COMMISSION_STEER
 ,

61 
	mZBHCI_CMD_BDB_COMMISSION_TOUCHLINK
 ,

62 
	mZBHCI_CMD_BDB_COMMISSION_FINDBIND
 ,

63 
	mZBHCI_CMD_BDB_FACTORY_RESET
 ,

64 
	mZBHCI_CMD_BDB_PRE_INSTALL_CODE
 ,

65 
	mZBHCI_CMD_BDB_CHANNEL_SET
,

66 
	mZBHCI_CMD_BDB_DONGLE_WORKING_MODE_SET
,

67 
	mZBHCI_CMD_BDB_NODE_DELETE
,

68 
	mZBHCI_CMD_BDB_TX_POWER_SET
,

69 
	mZBHCI_CMD_ACKNOWLEDGE
 = 0x8000,

71 
	mZBHCI_CMD_DISCOVERY_NWK_ADDR_REQ
 = 0x0010,

72 
	mZBHCI_CMD_DISCOVERY_IEEE_ADDR_REQ
 ,

73 
	mZBHCI_CMD_DISCOVERY_NODE_DESC_REQ
 ,

74 
	mZBHCI_CMD_DISCOVERY_SIMPLE_DESC_REQ
 ,

75 
	mZBHCI_CMD_DISCOVERY_MATCH_DESC_REQ
 ,

76 
	mZBHCI_CMD_DISCOVERY_ACTIVE_EP_REQ
 ,

78 
	mZBHCI_CMD_DISCOVERY_NWK_ADDR_RSP
 = 0x8010,

79 
	mZBHCI_CMD_DISCOVERY_IEEE_ADDR_RSP
 ,

80 
	mZBHCI_CMD_DISCOVERY_NODE_DESC_RSP
 ,

81 
	mZBHCI_CMD_DISCOVERY_SIMPLE_DESC_RSP
 ,

82 
	mZBHCI_CMD_DISCOVERY_MATCH_DESC_RSP
 ,

83 
	mZBHCI_CMD_DISCOVERY_ACTIVE_EP_RSP
 ,

85 
	mZBHCI_CMD_BINDING_REQ
 = 0x0020,

86 
	mZBHCI_CMD_UNBINDING_REQ
 ,

88 
	mZBHCI_CMD_BINDING_RSP
 = 0x8020,

89 
	mZBHCI_CMD_UNBINDING_RSP
 ,

91 
	mZBHCI_CMD_MGMT_LQI_REQ
 = 0x0030,

92 
	mZBHCI_CMD_MGMT_BIND_REQ
 ,

93 
	mZBHCI_CMD_MGMT_LEAVE_REQ
 ,

94 
	mZBHCI_CMD_MGMT_DIRECT_JOIN_REQ
 ,

95 
	mZBHCI_CMD_MGMT_PERMIT_JOIN_REQ
 ,

96 
	mZBHCI_CMD_MGMT_NWK_UPDATE_REQ
 ,

98 
	mZBHCI_CMD_MGMT_LQI_RSP
 = 0x8030,

99 
	mZBHCI_CMD_MGMT_BIND_RSP
 ,

100 
	mZBHCI_CMD_MGMT_LEAVE_RSP
 ,

101 
	mZBHCI_CMD_MGMT_DIRECT_JOIN_RSP
 ,

102 
	mZBHCI_CMD_MGMT_PERMIT_JOIN_RSP
 ,

103 
	mZBHCI_CMD_MGMT_NWK_UPDATE_RSP
 ,

105 
	mZBHCI_CMD_NODES_JOINED_GET_REQ
 = 0x0040,

106 
	mZBHCI_CMD_NODES_TOGLE_TEST_REQ
 = 0x0041,

107 
	mZBHCI_CMD_TXRX_PERFORMANCE_TEST_REQ
 = 0x0042,

108 
	mZBHCI_CMD_AF_DATA_SEND_TEST_REQ
 = 0x0044,

109 
	mZBHCI_CMD_GET_LOCAL_NWK_INFO_REQ
 = 0x0045,

111 
	mZBHCI_CMD_NODES_JOINED_GET_RSP
 = 0x8040,

112 
	mZBHCI_CMD_NODES_TOGLE_TEST_RSP
 = 0x8041,

113 
	mZBHCI_CMD_TXRX_PERFORMANCE_TEST_RSP
 = 0x8042,

114 
	mZBHCI_CMD_NODES_DEV_ANNCE_IND
 = 0x8043,

115 
	mZBHCI_CMD_AF_DATA_SEND_TEST_RSP
 = 0x8044,

116 
	mZBHCI_CMD_GET_LOCAL_NWK_INFO_RSP
 = 0x8045,

118 
	mZBHCI_CMD_ZCL_ATTR_READ
 = 0x0100,

119 
	mZBHCI_CMD_ZCL_ATTR_WRITE
 ,

120 
	mZBHCI_CMD_ZCL_CONFIG_REPORT
 ,

121 
	mZBHCI_CMD_ZCL_READ_REPORT_CFG
 ,

123 
	mZBHCI_CMD_ZCL_ATTR_READ_RSP
 = 0x8100,

124 
	mZBHCI_CMD_ZCL_ATTR_WRITE_RSP
 ,

125 
	mZBHCI_CMD_ZCL_CONFIG_REPORT_RSP
 ,

126 
	mZBHCI_CMD_ZCL_READ_REPORT_CFG_RSP
 ,

127 
	mZBHCI_CMD_ZCL_REPORT_MSG_RCV
,

128 
	mZBHCI_CMD_ZCL_DEFAULT_RSP
,

130 
	mZBHCI_CMD_ZCL_BASIC
 = 0x0110,

131 
	mZBHCI_CMD_ZCL_BASIC_RESET
 = 0x0110,

133 
	mZBHCI_CMD_ZCL_GROUP
 = 0x0120,

134 
	mZBHCI_CMD_ZCL_GROUP_ADD
 = 0x0120,

135 
	mZBHCI_CMD_ZCL_GROUP_VIEW
,

136 
	mZBHCI_CMD_ZCL_GROUP_GET_MEMBERSHIP
,

137 
	mZBHCI_CMD_ZCL_GROUP_REMOVE
,

138 
	mZBHCI_CMD_ZCL_GROUP_REMOVE_ALL
,

139 
	mZBHCI_CMD_ZCL_GROUP_ADD_IF_IDENTIFY
,

141 
	mZBHCI_CMD_ZCL_GROUP_ADD_RSP
 = 0x8120,

142 
	mZBHCI_CMD_ZCL_GROUP_VIEW_RSP
,

143 
	mZBHCI_CMD_ZCL_GROUP_GET_MEMBERSHIP_RSP
,

144 
	mZBHCI_CMD_ZCL_GROUP_REMOVE_RSP
,

146 
	mZBHCI_CMD_ZCL_IDENTIFY
 = 0x0130,

147 
	mZBHCI_CMD_ZCL_IDENTIFY_QUERY
,

149 
	mZBHCI_CMD_ZCL_IDENTIFY_QUERY_RSP
 = 0x8131,

151 
	mZBHCI_CMD_ZCL_ONOFF
 = 0x0140,

152 
	mZBHCI_CMD_ZCL_ONOFF_ON
 = 0x0140,

153 
	mZBHCI_CMD_ZCL_ONOFF_OFF
,

154 
	mZBHCI_CMD_ZCL_ONOFF_TOGGLE
,

156 
	mZBHCI_CMD_ZCL_LEVEL
 = 0x0150,

157 
	mZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL
 = 0x0150,

158 
	mZBHCI_CMD_ZCL_LEVEL_MOVE
,

159 
	mZBHCI_CMD_ZCL_LEVEL_STEP
,

160 
	mZBHCI_CMD_ZCL_LEVEL_STOP
,

161 
	mZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL_WITHONOFF
,

162 
	mZBHCI_CMD_ZCL_LEVEL_MOVE_WITHONOFF
,

163 
	mZBHCI_CMD_ZCL_LEVEL_STEP_WITHONOFF
,

164 
	mZBHCI_CMD_ZCL_LEVEL_STOP_WITHONOFF
,

166 
	mZBHCI_CMD_ZCL_SCENE
 = 0x0160,

167 
	mZBHCI_CMD_ZCL_SCENE_ADD
 = 0x0160,

168 
	mZBHCI_CMD_ZCL_SCENE_VIEW
,

169 
	mZBHCI_CMD_ZCL_SCENE_REMOVE
,

170 
	mZBHCI_CMD_ZCL_SCENE_REMOVE_ALL
,

171 
	mZBHCI_CMD_ZCL_SCENE_STORE
,

172 
	mZBHCI_CMD_ZCL_SCENE_RECALL
,

173 
	mZBHCI_CMD_ZCL_SCENE_GET_MEMBERSHIP
,

175 
	mZBHCI_CMD_ZCL_SCENE_ADD_RSP
 = 0x8160,

176 
	mZBHCI_CMD_ZCL_SCENE_VIEW_RSP
,

177 
	mZBHCI_CMD_ZCL_SCENE_REMOVE_RSP
,

178 
	mZBHCI_CMD_ZCL_SCENE_REMOVE_ALL_RSP
,

179 
	mZBHCI_CMD_ZCL_SCENE_STORE_RSP
,

180 
	mZBHCI_CMD_ZCL_SCENE_GET_MEMBERSHIP_RSP
 = 0x8166,

182 
	mZBHCI_CMD_ZCL_COLOR
 = 0x0170,

183 
	mZBHCI_CMD_ZCL_COLOR_MOVE2HUE
 = 0x0170,

184 
	mZBHCI_CMD_ZCL_COLOR_MOVE2COLOR
,

185 
	mZBHCI_CMD_ZCL_COLOR_MOVE2SAT
,

186 
	mZBHCI_CMD_ZCL_COLOR_MOVE2TEMP
,

188 
	mZBHCI_CMD_ZCL_IAS_ZONE
 = 0x0180,

190 
	mZBHCI_CMD_ZCL_OTA_IMAGE_NOTIFY
 = 0x0190,

192 
	mZBHCI_CMD_DATA_CONFIRM
 = 0x8200,

193 
	mZBHCI_CMD_MAC_ADDR_IND
 = 0x8201,

194 
	mZBHCI_CMD_NODE_LEAVE_IND
 = 0x8202,

196 
	mZBHCI_CMD_OTA_START_REQUEST
 = 0x0210,

197 
	mZBHCI_CMD_OTA_BLOCK_RESPONSE
 = 0x0211,

199 
	mZBHCI_CMD_OTA_START_RESPONSE
 = 0x8210,

200 
	mZBHCI_CMD_OTA_BLOCK_REQUEST
 = 0x8211,

201 
	mZBHCI_CMD_OTA_END_STATUS
 = 0x8212,

202 }
	tãHCI_MsgTy≥
;

207 
	mZBHCI_MSG_STATUS_SUCCESS
,

208 
	mZBHCI_MSG_STATUS_INCORRECT_PARAMETERS
,

209 
	mZBHCI_MSG_STATUS_UNHANDLED_COMMAND
,

210 
	mZBHCI_MSG_STATUS_BUSY
,

211 
	mZBHCI_MSG_STATUS_NO_MEMORY
,

212 
	mZBHCI_MSG_STATUS_STACK_ALREADY_STARTED
,

213 }
	tzbhci_msgSètus_e
;

216 
	mZBHCI_OTA_SUCCESS
,

217 
	mZBHCI_OTA_GET_BLOCK_TIMEOUT
,

218 
	mZBHCI_OTA_IN_PROGRESS
,

219 
	mZBHCI_OTA_INCORRECT_OFFSET
,

220 
	mZBHCI_OTA_FILE_OVERSIZE
,

221 }
	tzbhci_Ÿa_°©us_e
;

224 
	mZBHCI_TX_SUCCESS
,

225 
	mZBHCI_TX_BUFFERFULL
,

226 
	mZBHCI_TX_BUSY
,

227 
	mZBHCI_TX_FAILED
,

228 
	mZBHCI_TX_TOO_LONG
,

229 }
	tzbhciTx_e
;

232 
	mZBHCI_ADDRMODE_BOUND
,

233 
	mZBHCI_ADDRMODE_GROUP
,

234 
	mZBHCI_ADDRMODE_SHORT
,

235 
	mZBHCI_ADDRMODE_IEEE
,

236 
	mZBHCI_ADDRMODE_BRC
,

237 
	mZBHCI_ADDRMODE_BOUNDNOACK
,

238 
	mZBHCI_ADDRMODE_SHORTNOACK
,

239 
	mZBHCI_ADDRMODE_IEEENOACK


240 }
	tzbhciTxMode_e
;

242 
	#ZB_LEBESWAP
(
±r
,
Àn
Ë\

	)

243 
	gi
=0; i<(
	gÀn
>>1);i++){ \

244 
	gãmp
 = 
±r
[
Àn
 - 
i
 - 1]; \

245 
	g±r
[
Àn
 - 
i
 - 1] = 
±r
[i]; \

246 
	g±r
[
i
] = 
ãmp
; \

250 
	#ZB_IEEE_ADDR_REVERT
(
èr
,
addr
Ë\

	)

251 
	gi
=0; i<
	gEXT_ADDR_LEN
;i++){ \

252 (
	gèr
)[
i
]=(
addr
)[
EXT_ADDR_LEN
 - i - 1]; \

255 
	#ZB_LINK_KEY_REVERT
(
èr
,
addr
Ë\

	)

256 
	gi
=0; i<
	gSEC_KEY_LEN
;i++){ \

257 (
	gèr
)[
i
]=(
addr
)[
SEC_KEY_LEN
 - i - 1]; \

260 
	#ZB_16BIT_REVERT
(
èr
,
addr
Ë\

	)

261 
	gi
=0; i<2;i++){ \

262 (
	gèr
)[
i
]=(
addr
)[2 - i - 1]; \

265 
	#ZB_LEBESWAPU16
(
u16VÆue
Ë(u16VÆuê(u16VÆue>>8)|(u16VÆue<<8))

	)

269 
u8
 
	m°¨tFœg
;

270 
u8
 
	mmsgTy≥16H
;

271 
u8
 
	mmsgTy≥16L
;

272 
u8
 
	mmsgLí16H
;

273 
u8
 
	mmsgLí16L
;

274 
u8
 
	mcheckSum
;

275 
u8
 
	mpD©a
[1];

276 }
	tzbhci_msg_t
;

279 
u16
 
	mcmdId
;

280 
u16
 
	mªsv
;

281 
u8
 
	m∑ylﬂd
[1];

282 }
	tzbhci_cmdH™dÀr_t
;

290 
u16
 
	m°¨tIndex
;

291 }
	tzbhci_mgmt_nodesJoöed_ªq_t
;

299 
u16
 
	mtŸÆC¡
;

300 
u16
 
	m°¨tIndex
;

301 
u8
 
	mli°C¡
;

302 
u8
 
	m°©us
;

303 }
	tzbhci_mgmt_nodesJoöed_r•_hdr_t
;

306 
zbhci_mgmt_nodesJoöed_r•_hdr_t
 
	mhdr
;

307 
addrExt_t
 
	mmacAddrLi°
[6];

308 }
	tzbhci_mgmt_nodesJoöed_r•_t
;

316 
u16
 
	md°Addr
;

317 
u8
 
	m§cEp
;

318 
u8
 
	md°Ep
;

319 
u16
 
	m£ndC¡
;

320 
u8
 
	möãrvÆ
;

321 
u8
 
	mtxPowîSë
;

322 
u8
 
	m∑ylﬂd
[6];

323 }
	ttxrx_≥rf‹m˚_ã°_ªq_t
;

326 
u16
 
	md°Addr
;

327 
u16
 
	m£ndC¡
;

328 
u16
 
	mackC¡
;

329 }
	ttxrx_≥rf‹m˚_ã°_r•_t
;

332 
u16
 
	md°Addr
;

333 
u8
 
	m§cEp
;

334 
u8
 
	md°Ep
;

335 
u16
 
	m˛u°îId
;

336 
u16
 
	md©aLí
;

337 
u8
 
	m∑ylﬂd
[];

338 }
	tzbhci_afD©aSíd_ªq_t
;

341 
u16
 
	m§cAddr
;

342 
u8
 
	m§cEp
;

343 
u8
 
	md°Ep
;

344 
u16
 
	m˛u°îId
;

345 
u16
 
	md©aLí
;

346 
u8
 
	m∑ylﬂd
[];

347 }
	tzbhci_afD©aSíd_r•_t
;

350 
addrExt_t
 
	mmacAddr
;

351 }
	tzbhci_mgmt_nodeDñëeReq_t
;

354 
u16
 
	mtŸÆC¡
;

355 
addrExt_t
 
	mmacAddr
;

356 }
	tzbhci_nodeLóveInd_t
;

359 
u16
 
	md°Addr
;

360 
u8
 
	m§cEp
;

361 
u8
 
	md°Ep
;

362 
u16
 
	m˛u°îId
;

363 
u8
 
	m°©us
;

364 
u8
 
	m≠sC¡
;

365 }
	tzbhci_≠p_d©a_c⁄fúm_t
;

368 
ev_timî_evít_t
 *
	m≥rf‹ma˚Te°TmrEvt
;

369 
u16
 
	m£ndTŸÆC¡
;

370 
u16
 
	m£ndSuc˚ssC¡
;

371 
u16
 
	mrcvTŸÆC¡
;

372 
u16
 
	md°Addr
;

373 
u8
 
	md°Ep
;

374 
u8
 
	md©aApsC¡
;

375 
u8
 
	m≥rf‹ma˚Te°
;

376 }
	tzbhci_afTe°Req_t
;

379 
u32
 
	mŸa_Êash_addr_°¨t
;

380 
u32
 
	mŸa_fûe_tŸÆ_size
;

381 
u32
 
	mŸa_fûe_off£t
;

382 
u8
 
	mŸa_¥o˚ss_°¨t
;

383 
u8
 
	mblock_£nd_˙t
;

384 }
	thci_Ÿa_öfo_t
;

386 
zbhci_afTe°Req_t
 
g_afTe°Req
;

389 
u8
 
¸c8CÆcuœã
(
u16
 
ty≥
, u16 
Àngth
, u8 *
d©a
);

390 
zbhciCmdH™dÀr
(
u16
 
msgTy≥
, u16 
msgLí
, 
u8
 *
p
);

391 
zbhciAµD©aSídC⁄fúmPush
(*
¨g
);

392 
zbhciAµNodeLóveIndPush
(*
¨g
);

393 
zbhciAfD©aPîf‹m™˚Resu…Push
();

394 
zbhciAfD©aRcvIndPush
(*
¨g
);

395 
zbhciAfD©aCnfPush
(*
¨g
);

396 
boﬁ
 
zbhciMacAddrGëPush
(
addrExt_t
 
devExtAddr
);

398 
zbhciTx_e
 
zbhciTx
(
u16
 
u16Ty≥
, u16 
u16Lígth
, 
u8
 *
pu8D©a
);

399 
zbhciInô
();

400 
zbhciTask
();

	@zbhci/zbhciCmdProcess.c

24 
	~"z˛_ö˛ude.h
"

25 
	~"Ÿa.h
"

26 
	~"zbhci.h
"

28 #i‡
ZBHCI_EN


38 
u16
 
	mèrgëAddr
;

39 
addrExt_t
 
	mmacAddr
;

40 
u8
 
	m≠sC¡
;

41 
u8
 
	mªjoö
;

42 } 
	tzb_hciCmdInfo_t
;

47 
zb_hciCmdInfo_t
 
	gg_hciCmd
;

49 
zbhci_afTe°Req_t
 
	gg_afTe°Req
;

51 #i‡
ZB_COORDINATOR_ROLE


52 
ev_timî_evít_t
 *
	gg_nodeTe°Timî
 = 
NULL
;

55 
hci_Ÿa_öfo_t
 
	gŸa_öfo
 = {0};

56 
ev_timî_evít_t
 *
	gg_hciOèTimî
 = 
NULL
;

61 
w‹kögMode_e
 
	gzbhciW‹kögMode
 = 
ZBHCI_NORMAL_MODE
;

66 
zbhci_z˛IdítifyCmdH™dÀ
(*
¨g
);

67 
zbhci_z˛OnoffCmdH™dÀ
(*
¨g
);

68 
zbhci_z˛LevñCålCmdH™dÀ
(*
¨g
);

69 
zbhci_z˛Cﬁ‹CålCmdH™dÀ
(*
¨g
);

70 
zbhci_˛u°îGroupH™dÀ
(*
¨g
);

71 
zbhci_˛u°îS˚√H™dÀ
(*
¨g
);

72 
zbhci_˛u°îOTAH™dÀ
(*
¨g
);

73 
zbhci_˛u°îBasicH™dÀ
(*
¨g
);

74 
zbhci_˛u°îComm⁄CmdH™dÀ
(*
¨g
);

75 
zbhci_˛u°îOTAH™dÀ
(*
¨g
);

80 
u8
 
	$zbhciResﬁveAddrR•Msg
(
zdo_õì_addr_ª•_t
 *
r•
)

82 
u8
 
Àn
 = 
	`OFFSETOF
(
zdo_õì_addr_ª•_t
, 
num_assoc_dev
);

83 
	`ZB_LEBESWAP
(
r•
->
õì_addr_ªmŸe
, 
EXT_ADDR_LEN
);

84 
	`ZB_LEBESWAP
(((
u8
 *)&
r•
->
nwk_addr_ªmŸe
), 2);

85 
u8
 
i
 = 0; (ò< 
r•
->
num_assoc_dev
Ë&& (ò< 
MAX_RSPNUM
); i++)

87 i‡(
i
 == 0)

89 
Àn
++;

91 
	`ZB_LEBESWAPU16
(
r•
->
nwk_addr_assoc_dev_l°
[
i
]);

92 
Àn
 += 2;

94  
Àn
;

95 
	}
}

97 
	$zbhciNwkAddrR•MsgPush
(*
¨g
)

99 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

100 
zdo_nwk_addr_ª•_t
 *
r•
 = (zdo_nwk_addr_ª•_à*)
p
->
zpdu
;

102 i‡(
p
->
Àngth
 =
	`OFFSETOF
(
zdo_nwk_addr_ª•_t
, 
num_assoc_dev
))

104 
r•
->
num_assoc_dev
 = 0;

106 
	`zbhciResﬁveAddrR•Msg
(
r•
);

108 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

109 
u8
 
i
 = 0;

110 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

111 
i
 += 2;

112 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

113 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_NWK_ADDR_RSP
, 
p
->
Àngth
 + 2, 
±r
);

115 
	`ev_buf_‰ì
(
±r
);

116 
	}
}

118 
	$zbhciIìeAddrR•MsgPush
(*
¨g
)

120 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

121 
zdo_õì_addr_ª•_t
 *
r•
 = (zdo_õì_addr_ª•_à*)
p
->
zpdu
;

123 i‡(
p
->
Àngth
 =
	`OFFSETOF
(
zdo_nwk_addr_ª•_t
, 
num_assoc_dev
))

125 
r•
->
num_assoc_dev
 = 0;

127 
	`zbhciResﬁveAddrR•Msg
(
r•
);

129 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

130 
u8
 
i
 = 0;

131 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

132 
i
 += 2;

133 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

134 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_IEEE_ADDR_RSP
, 
p
->
Àngth
 + 2, 
±r
);

136 
	`ev_buf_‰ì
(
±r
);

137 
	}
}

139 
	$zbhciM©chDescR•Push
(*
¨g
)

141 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

142 
zdo_m©ch_des¸ùt‹_ª•_t
 *
r•
 = (zdo_m©ch_des¸ùt‹_ª•_à*)
p
->
zpdu
;

143 
	`ZB_LEBESWAP
(((
u8
 *)&
r•
->
nwk_addr_öãª°
), 2);

145 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

146 
u8
 
i
 = 0;

147 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

148 
i
 += 2;

149 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

151 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_MATCH_DESC_RSP
, 
p
->
Àngth
 + 2, 
±r
);

153 
	`ev_buf_‰ì
(
±r
);

154 
	}
}

156 
	$zbhciA˘iveEpR•MsgPush
(*
¨g
)

158 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

159 
zdo_a˘ive_ï_ª•_t
 *
r•
 = (zdo_a˘ive_ï_ª•_à*)
p
->
zpdu
;

160 
	`ZB_LEBESWAPU16
(
r•
->
nwk_addr_öãª°
);

162 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

163 
u8
 
i
 = 0;

164 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

165 
i
 += 2;

166 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

168 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_ACTIVE_EP_RSP
, 
p
->
Àngth
 + 2, 
±r
);

170 
	`ev_buf_‰ì
(
±r
);

171 
	}
}

173 
	$zbhciNodeDescR•MsgPush
(*
¨g
)

175 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

176 
zdo_node_des¸ùt_ª•_t
 *
r•
 = (zdo_node_des¸ùt_ª•_à*)
p
->
zpdu
;

177 
	`ZB_LEBESWAP
(((
u8
 *)&
r•
->
nwk_addr_öãª°
), 2);

179 
u8
 
mcL
 = 
r•
->
node_des¸ùt‹
.
mcL8
;

180 
r•
->
node_des¸ùt‹
.
mcL8
 =Ñ•->node_des¸ùt‹.
mcH8
;

181 
r•
->
node_des¸ùt‹
.
mcH8
 = 
mcL
;

183 
	`ZB_LEBESWAP
(((
u8
 *)&(
r•
->
node_des¸ùt‹
.
max_ö_å_size
)), 2);

184 
	`ZB_LEBESWAP
(((
u8
 *)&(
r•
->
node_des¸ùt‹
.
max_out_å_size
)), 2);

186 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

187 
u8
 
i
 = 0;

188 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

189 
i
 += 2;

190 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

192 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_NODE_DESC_RSP
, 
p
->
Àngth
 + 2, 
±r
);

194 
	`ev_buf_‰ì
(
±r
);

195 
	}
}

197 
	$zbhciSim∂eDescR•MsgPush
(*
¨g
)

199 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

200 
zdo_sim∂e_des¸ùt‹_ª•_t
 *
r•
 = (zdo_sim∂e_des¸ùt‹_ª•_à*)
p
->
zpdu
;

202 
	`ZB_LEBESWAP
(((
u8
 *)&(
r•
->
nwk_addr_öãª°
)), 2);

204 i‡(
r•
->
°©us
 =
ZDO_SUCCESS
 &&Ñ•->
Àngth
)

206 
	`ZB_LEBESWAP
(((
u8
 *)&(
r•
->
sim∂e_des¸ùt‹
.
≠p_¥ofûe_id
)), 2);

207 
	`ZB_LEBESWAP
(((
u8
 *)&(
r•
->
sim∂e_des¸ùt‹
.
≠p_dev_id
)), 2);

208 
u8
 *
li°Info
 = 
r•
->
sim∂e_des¸ùt‹
.listInfo;

209 
u8
 
öClu°îNum
 = *
li°Info
++;

210 
u8
 
i
 = 0; i < 
öClu°îNum
; i++)

212 
	`ZB_LEBESWAP
(
li°Info
, 2);

213 
li°Info
 += 2;

216 
u8
 
outClu°îNum
 = *
li°Info
++;

217 
u8
 
i
 = 0; i < 
outClu°îNum
; i++)

219 
	`ZB_LEBESWAP
(
li°Info
, 2);

220 
li°Info
 += 2;

223 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

224 
u8
 
i
 = 0;

225 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

226 
i
 += 2;

227 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

229 
	`zbhciTx
(
ZBHCI_CMD_DISCOVERY_SIMPLE_DESC_RSP
, 
p
->
Àngth
 + 2, 
±r
);

231 
	`ev_buf_‰ì
(
±r
);

232 
	}
}

234 
	$zbhciBödR•Push
(*
¨g
)

236 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

237 
zdo_böd_ª•_t
 *
r•
 = (zdo_böd_ª•_à*)
p
->
zpdu
;

239 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
((
zdo_böd_ª•_t
) + 2);

240 
u8
 
i
 = 0;

241 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

242 
i
 += 2;

243 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, (
zdo_böd_ª•_t
));

245 
	`zbhciTx
(
ZBHCI_CMD_BINDING_RSP
, (
zdo_böd_ª•_t
Ë+ 2, 
±r
);

247 
	`ev_buf_‰ì
(
±r
);

248 
	}
}

250 
	$zbhciUnbödR•Push
(*
¨g
)

252 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

253 
zdo_unböd_ª•_t
 *
r•
 = (zdo_unböd_ª•_à*)
p
->
zpdu
;

255 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
((
zdo_böd_ª•_t
) + 2);

256 
u8
 
i
 = 0;

257 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

258 
i
 += 2;

259 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, (
zdo_unböd_ª•_t
));

261 
	`zbhciTx
(
ZBHCI_CMD_UNBINDING_RSP
, (
zdo_unböd_ª•_t
Ë+ 2, 
±r
);

263 
	`ev_buf_‰ì
(
±r
);

264 
	}
}

266 
	$zbhciMgmtLqiR•MsgPush
(*
¨g
)

268 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

269 
zdo_mgmt_lqi_ª•_t
 *
r•
 = (zdo_mgmt_lqi_ª•_à*)
p
->
zpdu
;

270 
u8
 
num
 = 
r•
->
√ighb‹_tbl_l°_˙t
;

271 
s32
 
i
 = 0; i < 
num
; i++)

273 
u8
 *
addr
 = 
r•
->
√ighb‹_tbl_l°
[
i
].
ext_addr
;

274 
	`ZB_LEBESWAP
(
addr
, 8);

276 
addr
 = 
r•
->
√ighb‹_tbl_l°
[
i
].
ext_∑n_id
;

277 
	`ZB_LEBESWAP
(
addr
, 8);

279 
addr
 = (
u8
 *)(&
r•
->
√ighb‹_tbl_l°
[
i
].
√tw‹k_addr
);

280 
	`ZB_LEBESWAP
(
addr
, 2);

283 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

284 
u8
 
i
 = 0;

285 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

286 
i
 += 2;

287 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

289 
	`zbhciTx
(
ZBHCI_CMD_MGMT_LQI_RSP
, 
p
->
Àngth
 + 2, 
±r
);

291 
	`ev_buf_‰ì
(
±r
);

292 
	}
}

294 
	$zbhciMgmtBödR•MsgPush
(*
¨g
)

296 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

297 
zdo_mgmt_böd_ª•_t
 *
r•
 = (zdo_mgmt_böd_ª•_à*)
p
->
zpdu
;

298 
u8
 
num
 = 
r•
->
böd_tbl_l°_˙t
;

300 
s32
 
n
 = 0;Ç < 
num
;Ç++)

302 
	`ZB_LEBESWAP
((
r•
->
böd_tbl_l°
[
n
].
§c_addr
), 8);

303 
u8
 
cidH
 = 
r•
->
böd_tbl_l°
[
n
].
cid16_h
;

304 
u8
 
cidL
 = 
r•
->
böd_tbl_l°
[
n
].
cid16_l
;

305 
r•
->
böd_tbl_l°
[
n
].
cid16_l
 = 
cidH
;

306 
r•
->
böd_tbl_l°
[
n
].
cid16_h
 = 
cidL
;

308 i‡(
r•
->
böd_tbl_l°
[
n
].
d°_addr_mode
 == 0x01)

310 
	`ZB_LEBESWAP
(((
u8
 *)&
r•
->
böd_tbl_l°
[
n
].
d°_group_addr
), 2);

314 
	`ZB_LEBESWAP
((
r•
->
böd_tbl_l°
[
n
].
d°_ext_addr
), 8);

318 
u8
 *
±r
 = 
	`ev_buf_Æloˇã
(
p
->
Àngth
 + 2);

319 
u8
 
i
 = 0;

320 
	`COPY_U16TOBUFFER_BE
(
±r
, 
p
->
§c_addr
);

321 
i
 += 2;

322 
	`mem˝y
(&
±r
[
i
], (
u8
 *)
r•
, 
p
->
Àngth
);

324 
	`zbhciTx
(
ZBHCI_CMD_MGMT_BIND_RSP
, 
p
->
Àngth
 + 2, 
±r
);

326 
	`ev_buf_‰ì
(
±r
);

327 
	}
}

329 
	$zbhciMgmtLóveR•MsgPush
(*
¨g
)

331 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

332 
zdo_mgmt_Àave_ª•_t
 *
r•
 = (zdo_mgmt_Àave_ª•_à*)
p
->
zpdu
;

333 i‡(
g_hciCmd
.
≠sC¡
 =
r•
->
£q_num
)

335 i‡(!
g_hciCmd
.
ªjoö
)

337 
	`zdo_∆meF‹gëDev
(
g_hciCmd
.
macAddr
, g_hciCmd.
ªjoö
);

340 
u8
 
¨øy
[16] = {0};

341 
u8
 *
pBuf
 = 
¨øy
;

343 *
pBuf
++ = 
	`HI_UINT16
(
p
->
§c_addr
);

344 *
pBuf
++ = 
	`LO_UINT16
(
p
->
§c_addr
);

345 *
pBuf
++ = 
r•
->
£q_num
;

346 *
pBuf
++ = 
r•
->
°©us
;

347 
	`mem˝y
(
pBuf
, 
g_hciCmd
.
macAddr
, 8);

348 
	`ZB_LEBESWAP
(
pBuf
, 8);

349 
pBuf
 += 8;

350 *
pBuf
++ = 
g_hciCmd
.
ªjoö
;

352 
	`zbhciTx
(
ZBHCI_CMD_MGMT_LEAVE_RSP
, 
pBuf
 - 
¨øy
,árray);

354 
	}
}

356 
s32
 
	$rxtx_≥rf‹m™˚_ªsu…_°¨t
(*
¨g
)

358 
txrx_≥rf‹m˚_ã°_r•_t
 
r•
;

360 
	`COPY_BUFFERTOU16_BE
(
r•
.
d°Addr
, (
u8
 *)&
g_afTe°Req
.dstAddr);

361 
	`COPY_BUFFERTOU16_BE
(
r•
.
£ndC¡
, (
u8
 *)&
g_afTe°Req
.
£ndTŸÆC¡
);

362 
	`COPY_BUFFERTOU16_BE
(
r•
.
ackC¡
, (
u8
 *)&
g_afTe°Req
.
rcvTŸÆC¡
);

364 
	`zbhciTx
(
ZBHCI_CMD_TXRX_PERFORMANCE_TEST_RSP
, (
txrx_≥rf‹m˚_ã°_r•_t
), (
u8
 *)&
r•
);

366 
	`mem£t
((
u8
 *)&
g_afTe°Req
, 0, (
zbhci_afTe°Req_t
));

368 
g_afTe°Req
.
≥rf‹ma˚Te°TmrEvt
 = 
NULL
;

370 
	}
}

372 
	$zbhciAfD©aPîf‹m™˚Resu…Push
()

374 #i‡
AF_TEST_ENABLE


375 i‡(!
g_afTe°Req
.
≥rf‹ma˚Te°
)

380 
g_afTe°Req
.
rcvTŸÆC¡
++;

382 i‡(
g_afTe°Req
.
≥rf‹ma˚Te°TmrEvt
)

384 
	`TL_ZB_TIMER_CANCEL
(&
g_afTe°Req
.
≥rf‹ma˚Te°TmrEvt
);

386 
g_afTe°Req
.
≥rf‹ma˚Te°TmrEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
rxtx_≥rf‹m™˚_ªsu…_°¨t
, 
NULL
, 1000);

388 
	}
}

390 
	$zbhciAfD©aRcvIndPush
(*
¨g
)

392 #i‡
AF_TEST_ENABLE


393 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_à*)
¨g
;

395 i‡(
g_afTe°Req
.
≥rf‹ma˚Te°
)

400 
zbhci_afD©aSíd_r•_t
 *
pR•
 = (zbhci_afD©aSíd_r•_à*)
	`ev_buf_Æloˇã
((zbhci_afD©aSíd_r•_tË+ 
pApsdeInd
->
asduLí
);

401 i‡(
pR•
)

403 
	`COPY_BUFFERTOU16_BE
(
pR•
->
˛u°îId
, (
u8
 *)&(
pApsdeInd
->
ödInfo
.
˛u°î_id
));

404 
pR•
->
§cAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

405 
pR•
->
§cEp
 = 
pApsdeInd
->
ödInfo
.
§c_ï
;

406 
pR•
->
d°Ep
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

407 
pR•
->
d©aLí
 = 
pApsdeInd
->
asduLí
;

408 i‡(
pApsdeInd
->
asduLí
)

410 
	`mem˝y
(
pR•
->
∑ylﬂd
, 
pApsdeInd
->
asdu
,ÖApsdeInd->
asduLí
);

413 
	`zbhciTx
(
ZBHCI_CMD_AF_DATA_SEND_TEST_RSP
, (
zbhci_afD©aSíd_r•_t
Ë+ 
pApsdeInd
->
asduLí
, (
u8
 *)
pR•
);

415 
	`ev_buf_‰ì
((
u8
 *)
pR•
);

418 
	}
}

420 
	$zbhciAfD©aCnfPush
(*
¨g
)

422 #i‡
AF_TEST_ENABLE


423 
≠sdeD©aC⁄f_t
 *
pApsD©aCnf
 = (≠sdeD©aC⁄f_à*)
¨g
;

425 i‡((
pApsD©aCnf
->
d°Endpoöt
 =
g_afTe°Req
.
d°Ep
) &&

426 (
pApsD©aCnf
->
d°Addr
.
addr_sh‹t
 =
g_afTe°Req
.dstAddr) &&

427 (
pApsD©aCnf
->
°©us
 =
APS_STATUS_SUCCESS
))

429 
g_afTe°Req
.
£ndSuc˚ssC¡
++;

432 
	}
}

434 
	$zbhciAµD©aSídC⁄fúmPush
(*
¨g
)

436 
≠sdeD©aC⁄f_t
 *
pApsD©aCnf
 = (≠sdeD©aC⁄f_à*)
¨g
;

438 
zbhci_≠p_d©a_c⁄fúm_t
 *
c⁄f
 = (zbhci_≠p_d©a_c⁄fúm_à*)
	`ev_buf_Æloˇã
((zbhci_app_data_confirm_t));

439 i‡(
c⁄f
)

441 #i‡
ZB_COORDINATOR_ROLE


443 if(
g_nodeTe°Timî
){

444 
g_afTe°Req
.
£ndTŸÆC¡
++;

445 if(
pApsD©aCnf
->
°©us
 =
SUCCESS
){

446 
g_afTe°Req
.
£ndSuc˚ssC¡
++;

448 if(
g_afTe°Req
.
£ndTŸÆC¡
 >= 100){

449 
txrx_≥rf‹m˚_ã°_r•_t
 
r•
;

450 
	`COPY_BUFFERTOU16_BE
(
r•
.
d°Addr
, (
u8
 *)&
g_afTe°Req
.dstAddr);

451 
	`COPY_BUFFERTOU16_BE
(
r•
.
£ndC¡
, (
u8
 *)&
g_afTe°Req
.
£ndTŸÆC¡
);

452 
	`COPY_BUFFERTOU16_BE
(
r•
.
ackC¡
, (
u8
 *)&
g_afTe°Req
.
£ndSuc˚ssC¡
);

454 
	`zbhciTx
(
ZBHCI_CMD_TXRX_PERFORMANCE_TEST_RSP
, (
txrx_≥rf‹m˚_ã°_r•_t
), (
u8
 *)&
r•
);

455 
	`mem£t
((
u8
 *)&
g_afTe°Req
, 0, (
zbhci_afTe°Req_t
));

460 
u16
 
d°NwkAddr
 = 
pApsD©aCnf
->
d°Addr
.
addr_sh‹t
;

461 i‡(
pApsD©aCnf
->
d°AddrMode
 =
APS_LONG_DSTADDR_WITHEP
)

463 
u16
 
idx
 = 0;

464 
	`é_zbSh‹tAddrByExtAddr
(&
d°NwkAddr
, 
pApsD©aCnf
->
d°Addr
.
addr_l⁄g
, (
u16
 *)&
idx
);

466 
	`COPY_BUFFERTOU16_BE
(
c⁄f
->
d°Addr
, (
u8
 *)&
d°NwkAddr
);

467 
c⁄f
->
d°Ep
 = 
pApsD©aCnf
->
d°Endpoöt
;

468 
c⁄f
->
§cEp
 = 
pApsD©aCnf
->
§cEndpoöt
;

469 
	`COPY_BUFFERTOU16_BE
(
c⁄f
->
˛u°îId
, (
u8
 *)&
pApsD©aCnf
->clusterId);

470 
c⁄f
->
°©us
 = 
pApsD©aCnf
->status;

471 
c⁄f
->
≠sC¡
 = 
pApsD©aCnf
->apsCnt;

473 
	`zbhciTx
(
ZBHCI_CMD_DATA_CONFIRM
, (
zbhci_≠p_d©a_c⁄fúm_t
), (
u8
 *)
c⁄f
);

477 
	`ev_buf_‰ì
((
u8
 *)
c⁄f
);

479 
	}
}

481 
boﬁ
 
	$zbhciMacAddrGëPush
(
addrExt_t
 
devExtAddr
)

483 i‡(
zbhciW‹kögMode
 =
ZBHCI_GET_MAC_ADDR_MODE
)

485 
	`zbhciTx
(
ZBHCI_CMD_MAC_ADDR_IND
, 
EXT_ADDR_LEN
, (
u8
 *)
devExtAddr
);

486  
FALSE
;

488  
TRUE
;

489 
	}
}

491 
	$zbhciAµNodeLóveIndPush
(*
¨g
)

493 
zbhci_nodeLóveInd_t
 *
öd
 = (zbhci_nodeLóveInd_à*)
¨g
;

494 
	`ZB_LEBESWAPU16
(
öd
->
tŸÆC¡
);

495 
	`ZB_LEBESWAP
((
öd
->
macAddr
), 8);

496 
	`zbhciTx
(
ZBHCI_CMD_NODE_LEAVE_IND
, (
zbhci_nodeLóveInd_t
), (
u8
 *)
öd
);

497 
	}
}

499 
	$m©ch_desc_ªq_h™dÀr
(*
¨g
)

501 
u8
 *
±r
 = 
¨g
;

503 
u16
 
èrgëAddr
;

504 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
±r
);

505 
±r
 += 2;

507 
u8
 
öNum
 = 
±r
[4];

508 
u8
 
outNum
 = 
±r
[5];

510 
zdo_m©ch_des¸ùt‹_ªq_t
 *
ªq
 = (zdo_m©ch_des¸ùt‹_ªq_à*)
	`ev_buf_Æloˇã
(6 + (
öNum
 + 
outNum
) * 2);

511 i‡(
ªq
)

513 
u8
 
i
 = 0;

514 
	`COPY_BUFFERTOU16_BE
(
ªq
->
nwk_addr_öãª°
, 
±r
);

515 
±r
 += 2;

516 
	`COPY_BUFFERTOU16_BE
(
ªq
->
¥ofûe_id
, 
±r
);

517 
±r
 += 2;

518 
ªq
->
num_ö_˛u°îs
 = 
öNum
;

519 
ªq
->
num_out_˛u°îs
 = 
outNum
;

520 
±r
 += 2;

521 
i
 < 
ªq
->
num_ö_˛u°îs
)

523 
	`COPY_BUFFERTOU16_BE
(
ªq
->
˛u°î_li°
[
i
], 
±r
);

524 
±r
 += 2;

525 
i
++;

528 
i
 = 0;

529 
i
 < 
ªq
->
num_out_˛u°îs
)

531 
	`COPY_BUFFERTOU16_BE
(
ªq
->
˛u°î_li°
[
i
 +Ñeq->
num_ö_˛u°îs
], 
±r
);

532 
±r
 += 2;

533 
i
++;

536 
u8
 
¢
 = 0;

537 
	`zb_zdoM©chDescReq
(
èrgëAddr
, 
ªq
, &
¢
, 
zbhciM©chDescR•Push
);

538 
	`ev_buf_‰ì
((
u8
 *)
ªq
);

540 
	}
}

542 
	$zbhci_bdbCmdH™dÀr
(*
¨g
)

544 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

545 
u16
 
cmdID
 = 
cmdInfo
->
cmdId
;

546 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

548 i‡(
cmdID
 =
ZBHCI_CMD_BDB_COMMISSION_FORMATION
)

550 
	`bdb_√tw‹kF‹m©i⁄Sèπ
();

552 i‡(
cmdID
 =
ZBHCI_CMD_BDB_COMMISSION_STEER
)

554 
	`bdb_√tw‹kSãîSèπ
();

556 i‡(
cmdID
 =
ZBHCI_CMD_BDB_COMMISSION_TOUCHLINK
)

558 
	`bdb_√tw‹kTouchLökSèπ
(
p
[0]);

560 i‡(
cmdID
 =
ZBHCI_CMD_BDB_COMMISSION_FINDBIND
)

562 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

564 
	`bdb_födAndBödSèπ
(
p
[0]);

567 i‡(
cmdID
 =
ZBHCI_CMD_BDB_FACTORY_RESET
)

569 
	`zb_ª£tDevi˚2FN
();

571 i‡(
cmdID
 =
ZBHCI_CMD_BDB_PRE_INSTALL_CODE
)

573 
u8
 
ö°ÆlCode
[
SEC_KEY_LEN
] = {0};

574 
addrExt_t
 
devi˚_addªss
;

576 
	`ZB_IEEE_ADDR_REVERT
(
devi˚_addªss
, &
p
[0]);

577 
	`mem˝y
(
ö°ÆlCode
, &
p
[8], 
SEC_KEY_LEN
);

579 
	`bdb_¥eIn°ÆlCodeAdd
(
devi˚_addªss
, 
ö°ÆlCode
);

581 i‡(
cmdID
 =
ZBHCI_CMD_BDB_CHANNEL_SET
)

583 
	`zb_≠sCh™√lMaskSë
((1 << 
p
[0]));

585 i‡(
cmdID
 =
ZBHCI_CMD_BDB_DONGLE_WORKING_MODE_SET
)

587 
zbhciW‹kögMode
 = 
p
[0];

589 i‡(
cmdID
 =
ZBHCI_CMD_BDB_NODE_DELETE
)

591 
zbhci_mgmt_nodeDñëeReq_t
 
dñNodeAddr
;

592 
	`ZB_IEEE_ADDR_REVERT
(
dñNodeAddr
.
macAddr
, &
p
[0]);

594 
	`zdo_∆meF‹gëDev
(
dñNodeAddr
.
macAddr
, 0);

596 i‡(
cmdID
 =
ZBHCI_CMD_BDB_TX_POWER_SET
)

599 
	`rf_£tTxPowî
(
p
[0]);

602 
	`ev_buf_‰ì
(
¨g
);

603 
	}
}

605 
	$zbhci_discovîyCmdH™dÀr
(*
¨g
)

607 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

608 
u16
 
cmdID
 = 
cmdInfo
->
cmdId
;

609 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

611 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_NWK_ADDR_REQ
)

613 
u8
 
¢
 = 0;

614 
zdo_nwk_addr_ªq_t
 
ªq
;

615 
u16
 
èrgëAddr
;

616 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

617 
	`ZB_IEEE_ADDR_REVERT
(
ªq
.
õì_addr_öãª°
, 
p
 + 2);

618 
ªq
.
ªq_ty≥
 = 
p
[10];

619 
ªq
.
°¨t_ödex
 = 
p
[11];

620 
	`zb_zdoNwkAddrReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciNwkAddrR•MsgPush
);

622 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_IEEE_ADDR_REQ
)

624 
u8
 
¢
 = 0;

625 
zdo_õì_addr_ªq_t
 
ªq
;

626 
u16
 
èrgëAddr
;

627 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

628 
	`COPY_BUFFERTOU16_BE
(
ªq
.
nwk_addr_öãª°
, 
p
 + 2);

629 
ªq
.
ªq_ty≥
 = 
p
[4];

630 
ªq
.
°¨t_ödex
 = 
p
[5];

631 
	`zb_zdoIìeAddrReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciIìeAddrR•MsgPush
);

633 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_NODE_DESC_REQ
)

635 
zdo_node_des¸ùt‹_ªq_t
 
ªq
;

636 
u16
 
èrgëAddr
;

637 
u8
 
¢
 = 0;

638 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

639 
	`COPY_BUFFERTOU16_BE
(
ªq
.
nwk_addr_öãª°
, 
p
 + 2);

640 
	`zb_zdoNodeDescReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciNodeDescR•MsgPush
);

642 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_SIMPLE_DESC_REQ
)

644 
zdo_sim∂e_des¸ùt‹_ªq_t
 
ªq
;

645 
u16
 
èrgëAddr
;

646 
u8
 
¢
 = 0;

647 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

648 
	`COPY_BUFFERTOU16_BE
(
ªq
.
nwk_addr_öãª°
, 
p
 + 2);

649 
ªq
.
ídpoöt
 = 
p
[4];

650 
	`zb_zdoSim∂eDescReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciSim∂eDescR•MsgPush
);

652 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_MATCH_DESC_REQ
)

654 
	`m©ch_desc_ªq_h™dÀr
(
p
);

656 i‡(
cmdID
 =
ZBHCI_CMD_DISCOVERY_ACTIVE_EP_REQ
)

658 
u8
 
¢
 = 0;

659 
zdo_a˘ive_ï_ªq_t
 
ªq
;

660 
u16
 
èrgëAddr
;

661 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

662 
	`COPY_BUFFERTOU16_BE
(
ªq
.
nwk_addr_öãª°
, 
p
 + 2);

663 
	`zb_zdoA˘iveEpReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciA˘iveEpR•MsgPush
);

666 
	`ev_buf_‰ì
(
¨g
);

667 
	}
}

669 
	$zbhci_mgmtCmdH™dÀr
(*
¨g
)

671 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

672 
u16
 
cmdID
 = 
cmdInfo
->
cmdId
;

673 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

674 
u16
 
èrgëAddr
;

676 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_LQI_REQ
)

678 
u8
 
¢
 = 0;

679 
zdo_mgmt_lqi_ªq_t
 
ªq
;

680 
u16
 
d°Addr
;

681 
	`COPY_BUFFERTOU16_BE
(
d°Addr
, 
p
);

682 
ªq
.
°¨t_ödex
 = 
p
[2];

683 
	`zb_mgmtLqiReq
(
d°Addr
, &
ªq
, &
¢
, 
zbhciMgmtLqiR•MsgPush
);

685 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_BIND_REQ
)

687 
u8
 
¢
 = 0;

688 
zdo_mgmt_böd_ªq_t
 
ªq
;

689 
u16
 
d°Addr
 = (
p
[0] << 8) |Ö[1];

690 
ªq
.
°¨t_ödex
 = 
p
[2];

691 
	`zb_mgmtBödReq
(
d°Addr
, &
ªq
, &
¢
, 
zbhciMgmtBödR•MsgPush
);

693 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_LEAVE_REQ
)

695 
u8
 
¢
;

696 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

698 
zdo_mgmt_Àave_ªq_t
 
ªq
;

699 
	`ZB_IEEE_ADDR_REVERT
(
ªq
.
devi˚_addr
, 
p
 + 2);

700 
ªq
.
Ã_bôfõlds
.
ªjoö
 = 
p
[10];

701 
ªq
.
Ã_bôfõlds
.
ªmove_chûdªn
 = 
p
[11];

702 
ªq
.
Ã_bôfõlds
.
ª£rved
 = 0;

703 
g_hciCmd
.
ªjoö
 = 
ªq
.
Ã_bôfõlds
.rejoin;

704 
	`zb_mgmtLóveReq
(
èrgëAddr
, &
ªq
, &
¢
, 
zbhciMgmtLóveR•MsgPush
);

705 
g_hciCmd
.
≠sC¡
 = 
¢
;

706 
	`mem˝y
(
g_hciCmd
.
macAddr
, 
ªq
.
devi˚_addr
, 8);

708 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_DIRECT_JOIN_REQ
)

711 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_PERMIT_JOIN_REQ
)

713 
u8
 
¢
 = 0;

714 
	`COPY_BUFFERTOU16_BE
(
èrgëAddr
, 
p
);

715 
	`zb_mgmtPîmôJoöReq
(
èrgëAddr
, 
p
[2],Ö[3], &
¢
, 
NULL
);

717 i‡(
cmdID
 =
ZBHCI_CMD_MGMT_NWK_UPDATE_REQ
)

719 
u8
 
¢
 = 0;

720 
u16
 
d°Addr
;

721 
zdo_mgmt_nwk_upd©e_ªq_t
 
ªq
;

722 
	`COPY_BUFFERTOU16_BE
(
d°Addr
, 
p
);

723 
	`COPY_BUFFERTOU16_BE
(
ªq
.
nwk_m™agî_addr
, &
p
[2]);

724 
	`COPY_BUFFERTOU32_BE
(
ªq
.
sˇn_ch
, &
p
[4]);

725 
ªq
.
sˇn_duøti⁄
 = 
p
[8];

726 
ªq
.
sˇn_˙t
 = 
p
[9];

727 
	`zb_mgmtNwkUpd©eReq
(
d°Addr
, &
ªq
, &
¢
);

730 
	`ev_buf_‰ì
(
¨g
);

731 
	}
}

733 
	$zbhci_bödCmdH™dÀr
(*
¨g
)

735 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

736 
u16
 
cmdID
 = 
cmdInfo
->
cmdId
;

737 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

739 
zdo_böd_ªq_t
 
ªq
;

740 
u8
 *
±r
 = 
p
;

742 
	`ZB_IEEE_ADDR_REVERT
(
ªq
.
§c_addr
, 
±r
);

743 
±r
 +
EXT_ADDR_LEN
;

744 
ªq
.
§c_ídpoöt
 = *
±r
++;

746 
ªq
.
cid16_h
 = *
±r
++;

747 
ªq
.
cid16_l
 = *
±r
++;

748 
ªq
.
d°_addr_mode
 = *
±r
++;

750 i‡(
ªq
.
d°_addr_mode
 == 0x3)

752 
	`ZB_IEEE_ADDR_REVERT
(
ªq
.
d°_ext_addr
, 
±r
);

753 
±r
 +
EXT_ADDR_LEN
;

754 
ªq
.
d°_ídpoöt
 = *
±r
++;

758 
	`COPY_BUFFERTOU16_BE
(
ªq
.
d°_group_addr
, 
±r
);

759 
±r
 += 2;

762 
boﬁ
 
bödOrUnböd
 = (
cmdID
 =
ZBHCI_CMD_BINDING_REQ
) ? 1 : 0;

763 
u8
 
¢
 = 0;

764 i‡(
bödOrUnböd
)

766 
	`zb_zdoBödUnbödReq
(
bödOrUnböd
, &
ªq
, &
¢
, 
zbhciBödR•Push
);

770 
	`zb_zdoBödUnbödReq
(
bödOrUnböd
, &
ªq
, &
¢
, 
zbhciUnbödR•Push
);

773 
	`ev_buf_‰ì
(
¨g
);

774 
	}
}

776 
s32
 
	$node_toggÀ_uniˇ°_ã°
(*
¨g
)

778 
u32
 
mode
 = (u32)
¨g
;

780 
u16
 
°¨tIdx
 = 0;

781 
u32
 
⁄Off
 = 0;

783 
ss_dev_∑ú_£t_t
 
keyPaú
;

785 
ôemI‚o_t
 
ôemInfo
;

786 
	`TL_SETSTRUCTCONTENT
(
ôemInfo
, 0);

788 i‡(
NV_SUCC
 !
	`nv_ÊashRódNew
(0, 
NV_MODULE_KEYPAIR
, 
ITEM_FIELD_IDLE
, (
ss_dev_∑ú_£t_t
), (
u8
 *)&
ôemInfo
))

790 
g_nodeTe°Timî
 = 
NULL
;

794 
ïInfo_t
 
d°EpInfo
;

795 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

797 
d°EpInfo
.
d°AddrMode
 = 
APS_LONG_DSTADDR_WITHEP
;

798 
d°EpInfo
.
d°Ep
 = 1;

799 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

800 
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

802 
u16
 
i
 = 0;

803 
i
 = 
°¨tIdx
; i <
ôemInfo
.
›Index
; i++)

805 i‡(
NV_SUCC
 =
	`nv_ÊashRódByIndex
(
NV_MODULE_KEYPAIR
, 
NV_ITEM_SS_KEY_PAIR
, 
ôemInfo
.
›Se˘
, 
i
, (
ss_dev_∑ú_£t_t
), (
u8
 *)&
keyPaú
))

807 
°¨tIdx
 = 
i
 + 1;

809 
	`ZB_IEEE_ADDR_COPY
(
d°EpInfo
.
d°Addr
.
extAddr
, 
keyPaú
.
devi˚_addªss
);

811 i‡(
⁄Off
)

813 
	`z˛_⁄Off_⁄Cmd
(0x01, &
d°EpInfo
, 
FALSE
);

817 
	`z˛_⁄Off_offCmd
(0x01, &
d°EpInfo
, 
FALSE
);

824 i‡(
i
 >
ôemInfo
.
›Index
)

826 
	`zbhciTx
(
ZBHCI_CMD_NODES_TOGLE_TEST_RSP
, 0, 
NULL
);

828 
°¨tIdx
 = 0;

829 
⁄Off
 ^= 1;

831 i‡(
mode
 >= 2)

833 
g_nodeTe°Timî
 = 
NULL
;

839 
	}
}

841 
s32
 
	$node_toggÀ_brﬂdˇ°_ã°
(*
¨g
)

844 
u32
 
⁄Off
 = 0;

846 
u8
 
§cEp
 = 1;

847 
ïInfo_t
 
d°EpInfo
;

848 
	`mem£t
(&
d°EpInfo
, 0, (
ïInfo_t
));

850 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

851 
d°EpInfo
.
d°Ep
 = 1;

852 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 0xffff;

853 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

854 
d°EpInfo
.
txO±i⁄s
 = 0;

855 
d°EpInfo
.
ødius
 = 0;

858 i‡(
⁄Off
)

860 
	`z˛_⁄Off_⁄Cmd
(
§cEp
, &
d°EpInfo
, 0);

864 
	`z˛_⁄Off_offCmd
(
§cEp
, &
d°EpInfo
, 0);

866 
⁄Off
 ^= 1;

868 
	}
}

870 
s32
 
	$rxtx_≥rf‹m™˚_ã°
(*
¨g
)

872 
txrx_≥rf‹m˚_ã°_ªq_t
 *
txrxTe°
 = (txrx_≥rf‹m˚_ã°_ªq_à*)
¨g
;

873 
ïInfo_t
 
d°EpInfo
;

874 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

876 
u16
 
d°Addr
 = 0xffff;

877 
	`COPY_BUFFERTOU16_BE
(
d°Addr
, ((
u8
 *)&(
txrxTe°
->dstAddr)));

879 
u16
 
tŸÆNum
 = 0;

880 
	`COPY_BUFFERTOU16_BE
(
tŸÆNum
, ((
u8
 *)&(
txrxTe°
->
£ndC¡
)));

882 i‡(
g_afTe°Req
.
£ndTŸÆC¡
 >
tŸÆNum
)

884 
	`ev_buf_‰ì
((
u8
 *)
¨g
);

888 
u8
 
d©aLí
 = 50;

889 
u8
 *
pBuf
 = (u8 *)
	`ev_buf_Æloˇã
(
d©aLí
);

890 i‡(
pBuf
)

892 
g_afTe°Req
.
£ndTŸÆC¡
++;

893 
g_afTe°Req
.
d°Addr
 = dstAddr;

894 
g_afTe°Req
.
d°Ep
 = 
txrxTe°
->dstEp;

896 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

897 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = dstAddr;

898 
d°EpInfo
.
d°Ep
 = 
txrxTe°
->dstEp;

899 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

900 
d°EpInfo
.
ødius
 = 0;

902 
u8
 *
pD©a
 = 
pBuf
;

904 *
pD©a
++ = 
	`LO_UINT16
(
g_afTe°Req
.
£ndTŸÆC¡
);

905 *
pD©a
++ = 
	`HI_UINT16
(
g_afTe°Req
.
£ndTŸÆC¡
);

907 
u8
 
i
 = 0; i < 
d©aLí
 - 2; i++)

909 *
pD©a
++ = 
i
;

912 
	`af_d©aSíd
(
txrxTe°
->
§cEp
, &
d°EpInfo
, 
ZCL_CLUSTER_TELINK_SDK_TEST_REQ
, 
d©aLí
, 
pBuf
, &
g_afTe°Req
.
d©aApsC¡
);

914 
	`ev_buf_‰ì
(
pBuf
);

917  (
txrxTe°
->
öãrvÆ
 * 10);

918 
	}
}

920 
s32
 
	$zbhci_nodeM™ageCmdH™dÀr
(*
¨g
)

922 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

923 
u16
 
cmdID
 = 
cmdInfo
->
cmdId
;

924 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

925 
u8
 
Àn
 = 0;

927 i‡(
cmdID
 =
ZBHCI_CMD_NODES_JOINED_GET_REQ
)

929 #i‡
ZB_COORDINATOR_ROLE


930 
u16
 
°¨tIdx
 = (
p
[0] << 8) +Ö[1];

932 
u8
 
bufFªe
 = 0;

933 
zbhci_mgmt_nodesJoöed_r•_hdr_t
 
hdr
;

934 
zbhci_mgmt_nodesJoöed_r•_t
 *
r•
 = (zbhci_mgmt_nodesJoöed_r•_à*)
	`ev_buf_Æloˇã
((zbhci_mgmt_nodesJoined_rsp_t));

935 i‡(
r•
)

937 
u8
 
vÆid˙t
 = 0;

938 
u16
 
tŸÆC¡
 = 
	`ss_nodeMacAddrFromdevKeyPaú
(
°¨tIdx
, 6, &
vÆid˙t
, 
r•
->
macAddrLi°
);

940 
addrExt_t
 *
pMacAddr
 = 
r•
->
macAddrLi°
;

941 
s32
 
i
 = 0; i < 
vÆid˙t
; i++)

943 
	`ZB_LEBESWAP
(((
u8
 *)
pMacAddr
), 8);

944 
pMacAddr
++;

947 
r•
->
hdr
.
°©us
 = 
ZBHCI_MSG_STATUS_SUCCESS
;

948 
	`COPY_BUFFERTOU16_BE
(
r•
->
hdr
.
tŸÆC¡
, (
u8
 *)&totalCnt);

949 
	`COPY_BUFFERTOU16_BE
(
r•
->
hdr
.
°¨tIndex
, (
u8
 *)&
°¨tIdx
);

950 
r•
->
hdr
.
li°C¡
 = 
vÆid˙t
;

951 
Àn
 = 
	`OFFSETOF
(
zbhci_mgmt_nodesJoöed_r•_t
, 
macAddrLi°
Ë+ (
addrExt_t
Ë* 
vÆid˙t
;

952 
bufFªe
 = 1;

956 
hdr
.
li°C¡
 = 0;

957 
hdr
.
°¨tIndex
 = 
°¨tIdx
;

958 
hdr
.
°©us
 = 
ZBHCI_MSG_STATUS_NO_MEMORY
;

959 
Àn
 = (
zbhci_mgmt_nodesJoöed_r•_hdr_t
);

960 
r•
 = (
zbhci_mgmt_nodesJoöed_r•_t
 *)&
hdr
;

963 
	`zbhciTx
(
ZBHCI_CMD_NODES_JOINED_GET_RSP
, 
Àn
, (
u8
 *)
r•
);

965 i‡(
bufFªe
)

967 
	`ev_buf_‰ì
((
u8
 *)
r•
);

971 i‡(
cmdID
 =
ZBHCI_CMD_NODES_TOGLE_TEST_REQ
)

973 #i‡
ZB_COORDINATOR_ROLE


974 
u32
 
mode
 = *
p
;

975 
u8
 
öãrvÆ
 = *(
p
 + 1);

977 i‡(
g_nodeTe°Timî
)

979 
	`TL_ZB_TIMER_CANCEL
(&
g_nodeTe°Timî
);

981 i‡(
öãrvÆ
 != 0)

983 i‡(
mode
)

985 
g_nodeTe°Timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
node_toggÀ_uniˇ°_ã°
, (*)
mode
, (
u32
)
öãrvÆ
 * 10);

989 
g_nodeTe°Timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
node_toggÀ_brﬂdˇ°_ã°
, 
NULL
, (
u32
)
öãrvÆ
 * 10);

994 i‡(
cmdID
 =
ZBHCI_CMD_TXRX_PERFORMANCE_TEST_REQ
)

996 #i‡
AF_TEST_ENABLE


997 i‡(!
g_afTe°Req
.
≥rf‹ma˚Te°
)

999 
	`mem£t
((
u8
 *)&
g_afTe°Req
, 0, (
zbhci_afTe°Req_t
));

1000 
g_afTe°Req
.
≥rf‹ma˚Te°
 = 1;

1001 
txrx_≥rf‹m˚_ã°_ªq_t
 *
txrxTe°
 = (txrx_≥rf‹m˚_ã°_ªq_à*)
	`ev_buf_Æloˇã
((txrx_performce_test_req_t));

1002 i‡(
txrxTe°
)

1004 
	`mem˝y
(
txrxTe°
, 
p
, (
txrx_≥rf‹m˚_ã°_ªq_t
));

1005 
	`TL_ZB_TIMER_SCHEDULE
(
rxtx_≥rf‹m™˚_ã°
, 
txrxTe°
, 10);

1010 i‡(
cmdID
 =
ZBHCI_CMD_AF_DATA_SEND_TEST_REQ
)

1012 #i‡
AF_TEST_ENABLE


1013 
u16
 
d©aLí
 = 0;

1014 
	`COPY_BUFFERTOU16_BE
(
d©aLí
, (
u8
 *)&
p
[6]);

1015 
zbhci_afD©aSíd_ªq_t
 *
pAfD©aSídReq
 = (zbhci_afD©aSíd_ªq_à*)
	`ev_buf_Æloˇã
((zbhci_afD©aSíd_ªq_tË+ 
d©aLí
);

1016 i‡(
pAfD©aSídReq
)

1018 
	`mem˝y
((
u8
 *)
pAfD©aSídReq
, 
p
, (
zbhci_afD©aSíd_ªq_t
));

1019 
	`mem˝y
(
pAfD©aSídReq
->
∑ylﬂd
, &
p
[(
zbhci_afD©aSíd_ªq_t
)], 
d©aLí
);

1021 
u16
 
˛u°îId
 = 0;

1022 
ïInfo_t
 
d°EpInfo
;

1023 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

1025 
d°EpInfo
.
d°Ep
 = 
pAfD©aSídReq
->dstEp;

1026 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

1027 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1028 
	`COPY_BUFFERTOU16_BE
(
d°EpInfo
.
d°Addr
.
sh‹tAddr
, (
u8
 *)&(
pAfD©aSídReq
->dstAddr));

1029 
	`COPY_BUFFERTOU16_BE
(
˛u°îId
, (
u8
 *)&(
pAfD©aSídReq
->clusterId));

1031 
u8
 
≠sC¡
 = 0;

1032 
	`af_d©aSíd
(
pAfD©aSídReq
->
§cEp
, &
d°EpInfo
, 
˛u°îId
, 
d©aLí
,ÖAfD©aSídReq->
∑ylﬂd
, &
≠sC¡
);

1034 
	`ev_buf_‰ì
((
u8
 *)
pAfD©aSídReq
);

1038 i‡(
cmdID
 =
ZBHCI_CMD_GET_LOCAL_NWK_INFO_REQ
)

1040 
u8
 
ãmp
[64] = {0};

1041 
u8
 *
pBuf
 = 
ãmp
;

1042 *
pBuf
++ = 
	`af_nodeDevTy≥Gë
();

1043 *
pBuf
++ = 
	`af_nodeMacC≠abûôyGë
();

1044 *
pBuf
++ = 
g_bdbAârs
.
nodeIsOnANëw‹k
;

1046 
	`COPY_U16TOBUFFER_BE
(
pBuf
, 
	`NIB_PAN_ID
());

1047 
pBuf
 += 2;

1049 
	`ZB_IEEE_ADDR_REVERT
(
pBuf
, 
	`NWK_NIB
().
extPANId
);

1050 
pBuf
 += 8;

1052 
	`COPY_U16TOBUFFER_BE
(
pBuf
, 
	`NIB_NETWORK_ADDRESS
());

1053 
pBuf
 += 2;

1055 
	`ZB_IEEE_ADDR_REVERT
(
pBuf
, 
	`NIB_IEEE_ADDRESS
());

1056 
pBuf
 += 8;

1058 
	`zbhciTx
(
ZBHCI_CMD_GET_LOCAL_NWK_INFO_RSP
, (
u8
)(
pBuf
 - 
ãmp
),Åemp);

1061 
	`ev_buf_‰ì
(
¨g
);

1064 
	}
}

1066 
	$hci_£nd_Ÿa_°¨t_r•⁄£
(
u8
 
°©us
)

1068 
u8
 
¨øy
[16] = {0};

1069 
u8
 *
pBuf
 = 
¨øy
;

1070 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
);

1071 
pBuf
 += 4;

1072 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
);

1073 
pBuf
 += 4;

1074 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_fûe_off£t
);

1075 
pBuf
 += 4;

1076 *
pBuf
++ = 
°©us
;

1077 
	`zbhciTx
(
ZBHCI_CMD_OTA_START_RESPONSE
, 
pBuf
 - 
¨øy
,árray);

1078 
	}
}

1079 
	$u¨t_£nd_Ÿa_block_ªque°
()

1081 
u8
 
¨øy
[8] = {0};

1082 
u8
 *
pBuf
 = 
¨øy
;

1083 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_fûe_off£t
);

1084 
pBuf
 += 4;

1085 
u8
 
√xt_block_Àn
 = 0;

1086 i‡(
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
 - oè_öfo.
Ÿa_fûe_off£t
 >
HCI_OTA_BLOCK_SIZE_MAX
)

1088 
√xt_block_Àn
 = 
HCI_OTA_BLOCK_SIZE_MAX
;

1092 
√xt_block_Àn
 = 
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
 - oè_öfo.
Ÿa_fûe_off£t
;

1094 *
pBuf
++ = 
√xt_block_Àn
;

1095 
	`zbhciTx
(
ZBHCI_CMD_OTA_BLOCK_REQUEST
, 
pBuf
 - 
¨øy
,árray);

1096 
	}
}

1097 
	$u¨t_£nd_Ÿa_íd
(
u8
 
°©us
)

1099 
u8
 
¨øy
[12] = {0};

1100 
u8
 *
pBuf
 = 
¨øy
;

1101 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
);

1102 
pBuf
 += 4;

1103 
	`COPY_U32TOBUFFER_BE
(
pBuf
, 
Ÿa_öfo
.
Ÿa_fûe_off£t
);

1104 
pBuf
 += 4;

1105 *
pBuf
++ = 
°©us
;

1106 
	`zbhciTx
(
ZBHCI_CMD_OTA_END_STATUS
, (
pBuf
 - 
¨øy
),árray);

1107 i‡(
°©us
 !
ZBHCI_OTA_SUCCESS
)

1109 
u16
 
£˘‹NumU£d
 = 
Ÿa_öfo
.
Ÿa_fûe_off£t
 / 
FLASH_SECTOR_SIZE
 + 1;

1110 
u16
 
i
 = 0; i < 
£˘‹NumU£d
; i++)

1112 
	`Êash_îa£
(
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
 + 
i
 * 
FLASH_SECTOR_SIZE
);

1115 
	`mem£t
(&
Ÿa_öfo
, 0, (
hci_Ÿa_öfo_t
));

1116 
	}
}

1117 
s32
 
	$ªcv_Ÿa_block_ª•⁄£_cb
(*
¨g
)

1119 i‡(
Ÿa_öfo
.
block_£nd_˙t
++ < 
HCI_OTA_BLOCK_REQUEST_RETRY_CNT_MAX
)

1121 
	`u¨t_£nd_Ÿa_block_ªque°
();

1122  
HCI_OTA_BLOCK_REQUEST_RETRY_INTERVAL
;

1126 
	`u¨t_£nd_Ÿa_íd
(
ZBHCI_OTA_GET_BLOCK_TIMEOUT
);

1129 
	}
}

1131 
	$zbhci_u¨tOTAH™dÀ
(*
¨g
)

1133 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

1134 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

1135 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

1136 i‡(
cmdId
 =
ZBHCI_CMD_OTA_START_REQUEST
)

1138 
u8
 
°¨t_°©us
 = 
ZBHCI_OTA_SUCCESS
;

1139 i‡(
Ÿa_öfo
.
Ÿa_¥o˚ss_°¨t
 == 0)

1141 
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
 = (
	`mcuBoŸAddrGë
()Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

1142 
	`COPY_BUFFERTOU32_BE
(
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
, 
p
);

1143 i‡(
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
 <
FLASH_OTA_IMAGE_MAX_SIZE
)

1145 
Ÿa_öfo
.
Ÿa_fûe_off£t
 = 0;

1146 
Ÿa_öfo
.
Ÿa_¥o˚ss_°¨t
 = 1;

1147 
u16
 
£˘‹NumU£d
 = 
Ÿa_öfo
.
Ÿa_fûe_tŸÆ_size
 / 
FLASH_SECTOR_SIZE
 + 1;

1148 
u16
 
i
 = 0; i < 
£˘‹NumU£d
; i++)

1150 
	`Êash_îa£
(
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
 + 
i
 * 
FLASH_SECTOR_SIZE
);

1152 
Ÿa_öfo
.
block_£nd_˙t
 = 0;

1153 
g_hciOèTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ªcv_Ÿa_block_ª•⁄£_cb
, 
NULL
, 
HCI_OTA_BLOCK_INTERVAL_NORMAL
);

1157 
°¨t_°©us
 = 
ZBHCI_OTA_FILE_OVERSIZE
;

1162 
°¨t_°©us
 = 
ZBHCI_OTA_IN_PROGRESS
;

1164 
	`hci_£nd_Ÿa_°¨t_r•⁄£
(
°¨t_°©us
);

1166 i‡(
cmdId
 =
ZBHCI_CMD_OTA_BLOCK_RESPONSE
)

1168 
u32
 
ªcv_off£t
 = 0;

1169 
u8
 *
±r
 = 
p
;

1170 
u8
 
°©us
 = *
±r
++;

1171 i‡(
°©us
 !
ZBHCI_OTA_SUCCESS
)

1173 i‡(
g_hciOèTimî
)

1175 
	`TL_ZB_TIMER_CANCEL
(&
g_hciOèTimî
);

1177 i‡(
°©us
 !
ZBHCI_OTA_SUCCESS
)

1179 
u16
 
£˘‹NumU£d
 = 
Ÿa_öfo
.
Ÿa_fûe_off£t
 / 
FLASH_SECTOR_SIZE
 + 1;

1180 
u16
 
i
 = 0; i < 
£˘‹NumU£d
; i++)

1182 
	`Êash_îa£
(
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
 + 
i
 * 
FLASH_SECTOR_SIZE
);

1185 
	`mem£t
(&
Ÿa_öfo
, 0, (
hci_Ÿa_öfo_t
));

1188 
	`COPY_BUFFERTOU32_BE
(
ªcv_off£t
, 
±r
);

1189 
±r
 += 4;

1190 
u8
 
block_Àn
 = *
±r
++;

1191 i‡(
ªcv_off£t
 =
Ÿa_öfo
.
Ÿa_fûe_off£t
)

1193 i‡(
g_hciOèTimî
)

1195 
	`TL_ZB_TIMER_CANCEL
(&
g_hciOèTimî
);

1197 
	`Êash_wrôe
(
Ÿa_öfo
.
Ÿa_Êash_addr_°¨t
 + 
ªcv_off£t
, 
block_Àn
, 
±r
);

1198 
Ÿa_öfo
.
Ÿa_fûe_off£t
 +
block_Àn
;

1199 i‡(
Ÿa_öfo
.
Ÿa_fûe_off£t
 < oè_öfo.
Ÿa_fûe_tŸÆ_size
)

1201 
Ÿa_öfo
.
block_£nd_˙t
 = 0;

1202 
g_hciOèTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ªcv_Ÿa_block_ª•⁄£_cb
, 
NULL
, 
HCI_OTA_BLOCK_INTERVAL_NORMAL
);

1204 i‡(
Ÿa_öfo
.
Ÿa_fûe_off£t
 =Ÿa_öfo.
Ÿa_fûe_tŸÆ_size
)

1206 
	`u¨t_£nd_Ÿa_íd
(
ZBHCI_OTA_SUCCESS
);

1210 
	`u¨t_£nd_Ÿa_íd
(
ZBHCI_OTA_INCORRECT_OFFSET
);

1214 
	`ev_buf_‰ì
(
¨g
);

1215 
	}
}

1216 
	$zbhciCmdH™dÀr
(
u16
 
msgTy≥
, u16 
msgLí
, 
u8
 *
p
)

1218 
u8
 
ªt
[4] = {0, 0, 0, 0};

1219 
u8
 
£qNum
 = 0;

1220 
u8
 
°
 = 0;

1222 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = (zbhci_cmdH™dÀr_à*)
	`ev_buf_Æloˇã
(
msgLí
 + 4);

1223 i‡(
cmdInfo
)

1225 
cmdInfo
->
cmdId
 = 
msgTy≥
;

1226 
	`mem˝y
(
cmdInfo
->
∑ylﬂd
, 
p
, 
msgLí
);

1227 
msgTy≥
)

1229 
ZBHCI_CMD_BDB_COMMISSION_FORMATION
:

1230 
ZBHCI_CMD_BDB_COMMISSION_STEER
:

1231 
ZBHCI_CMD_BDB_COMMISSION_TOUCHLINK
:

1232 
ZBHCI_CMD_BDB_COMMISSION_FINDBIND
:

1233 
ZBHCI_CMD_BDB_FACTORY_RESET
:

1234 
ZBHCI_CMD_BDB_PRE_INSTALL_CODE
:

1235 
ZBHCI_CMD_BDB_CHANNEL_SET
:

1236 
ZBHCI_CMD_BDB_DONGLE_WORKING_MODE_SET
:

1237 
ZBHCI_CMD_BDB_NODE_DELETE
:

1238 
ZBHCI_CMD_BDB_TX_POWER_SET
:

1239 
	`TL_SCHEDULE_TASK
(
zbhci_bdbCmdH™dÀr
, 
cmdInfo
);

1242 
ZBHCI_CMD_DISCOVERY_NWK_ADDR_REQ
:

1243 
ZBHCI_CMD_DISCOVERY_IEEE_ADDR_REQ
:

1244 
ZBHCI_CMD_DISCOVERY_NODE_DESC_REQ
:

1245 
ZBHCI_CMD_DISCOVERY_SIMPLE_DESC_REQ
:

1246 
ZBHCI_CMD_DISCOVERY_MATCH_DESC_REQ
:

1247 
ZBHCI_CMD_DISCOVERY_ACTIVE_EP_REQ
:

1248 
	`TL_SCHEDULE_TASK
(
zbhci_discovîyCmdH™dÀr
, 
cmdInfo
);

1251 
ZBHCI_CMD_BINDING_REQ
:

1252 
ZBHCI_CMD_UNBINDING_REQ
:

1253 
	`TL_SCHEDULE_TASK
(
zbhci_bödCmdH™dÀr
, 
cmdInfo
);

1256 
ZBHCI_CMD_MGMT_LQI_REQ
:

1257 
ZBHCI_CMD_MGMT_BIND_REQ
:

1258 
ZBHCI_CMD_MGMT_LEAVE_REQ
:

1259 
ZBHCI_CMD_MGMT_DIRECT_JOIN_REQ
:

1260 
ZBHCI_CMD_MGMT_PERMIT_JOIN_REQ
:

1261 
ZBHCI_CMD_MGMT_NWK_UPDATE_REQ
:

1262 
	`TL_SCHEDULE_TASK
(
zbhci_mgmtCmdH™dÀr
, 
cmdInfo
);

1265 
ZBHCI_CMD_NODES_JOINED_GET_REQ
:

1266 
ZBHCI_CMD_NODES_TOGLE_TEST_REQ
:

1267 
ZBHCI_CMD_TXRX_PERFORMANCE_TEST_REQ
:

1268 
ZBHCI_CMD_AF_DATA_SEND_TEST_REQ
:

1269 
ZBHCI_CMD_GET_LOCAL_NWK_INFO_REQ
:

1270 
	`TL_ZB_TIMER_SCHEDULE
(
zbhci_nodeM™ageCmdH™dÀr
, 
cmdInfo
, 100);

1273 
ZBHCI_CMD_ZCL_ATTR_READ
:

1274 
ZBHCI_CMD_ZCL_ATTR_WRITE
:

1275 
ZBHCI_CMD_ZCL_CONFIG_REPORT
:

1276 
ZBHCI_CMD_ZCL_READ_REPORT_CFG
:

1277 
	`TL_SCHEDULE_TASK
(
zbhci_˛u°îComm⁄CmdH™dÀ
, 
cmdInfo
);

1280 
ZBHCI_CMD_ZCL_BASIC_RESET
:

1281 
	`TL_SCHEDULE_TASK
(
zbhci_˛u°îBasicH™dÀ
, 
cmdInfo
);

1284 
ZBHCI_CMD_ZCL_GROUP_ADD
:

1285 
ZBHCI_CMD_ZCL_GROUP_VIEW
:

1286 
ZBHCI_CMD_ZCL_GROUP_GET_MEMBERSHIP
:

1287 
ZBHCI_CMD_ZCL_GROUP_REMOVE
:

1288 
ZBHCI_CMD_ZCL_GROUP_REMOVE_ALL
:

1289 
ZBHCI_CMD_ZCL_GROUP_ADD_IF_IDENTIFY
:

1290 
	`TL_SCHEDULE_TASK
(
zbhci_˛u°îGroupH™dÀ
, 
cmdInfo
);

1293 
ZBHCI_CMD_ZCL_IDENTIFY
:

1294 
ZBHCI_CMD_ZCL_IDENTIFY_QUERY
:

1295 
	`TL_SCHEDULE_TASK
(
zbhci_z˛IdítifyCmdH™dÀ
, 
cmdInfo
);

1298 
ZBHCI_CMD_ZCL_ONOFF_ON
:

1299 
ZBHCI_CMD_ZCL_ONOFF_OFF
:

1300 
ZBHCI_CMD_ZCL_ONOFF_TOGGLE
:

1301 
	`TL_SCHEDULE_TASK
(
zbhci_z˛OnoffCmdH™dÀ
, 
cmdInfo
);

1304 
ZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL
:

1305 
ZBHCI_CMD_ZCL_LEVEL_MOVE
:

1306 
ZBHCI_CMD_ZCL_LEVEL_STEP
:

1307 
ZBHCI_CMD_ZCL_LEVEL_STOP
:

1308 
ZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL_WITHONOFF
:

1309 
ZBHCI_CMD_ZCL_LEVEL_MOVE_WITHONOFF
:

1310 
ZBHCI_CMD_ZCL_LEVEL_STEP_WITHONOFF
:

1311 
ZBHCI_CMD_ZCL_LEVEL_STOP_WITHONOFF
:

1312 
	`TL_SCHEDULE_TASK
(
zbhci_z˛LevñCålCmdH™dÀ
, 
cmdInfo
);

1315 
ZBHCI_CMD_ZCL_SCENE_ADD
:

1316 
ZBHCI_CMD_ZCL_SCENE_VIEW
:

1317 
ZBHCI_CMD_ZCL_SCENE_REMOVE
:

1318 
ZBHCI_CMD_ZCL_SCENE_REMOVE_ALL
:

1319 
ZBHCI_CMD_ZCL_SCENE_STORE
:

1320 
ZBHCI_CMD_ZCL_SCENE_RECALL
:

1321 
ZBHCI_CMD_ZCL_SCENE_GET_MEMBERSHIP
:

1322 
	`TL_SCHEDULE_TASK
(
zbhci_˛u°îS˚√H™dÀ
, 
cmdInfo
);

1325 
ZBHCI_CMD_ZCL_COLOR_MOVE2HUE
:

1326 
ZBHCI_CMD_ZCL_COLOR_MOVE2COLOR
:

1327 
ZBHCI_CMD_ZCL_COLOR_MOVE2SAT
:

1328 
ZBHCI_CMD_ZCL_COLOR_MOVE2TEMP
:

1329 
	`TL_SCHEDULE_TASK
(
zbhci_z˛Cﬁ‹CålCmdH™dÀ
, 
cmdInfo
);

1332 
ZBHCI_CMD_ZCL_OTA_IMAGE_NOTIFY
:

1333 
	`TL_SCHEDULE_TASK
(
zbhci_˛u°îOTAH™dÀ
, 
cmdInfo
);

1336 
ZBHCI_CMD_OTA_START_REQUEST
:

1337 
ZBHCI_CMD_OTA_BLOCK_RESPONSE
:

1338 
	`TL_SCHEDULE_TASK
(
zbhci_u¨tOTAH™dÀ
, 
cmdInfo
);

1342 
	`ev_buf_‰ì
((
u8
 *)
cmdInfo
);

1343 
°
 = 
ZBHCI_MSG_STATUS_UNHANDLED_COMMAND
;

1349 
°
 = 
ZBHCI_MSG_STATUS_NO_MEMORY
;

1352 
	`COPY_U16TOBUFFER_BE
(
ªt
, 
msgTy≥
);

1353 
ªt
[2] = 
°
;

1354 
ªt
[3] = 
£qNum
;

1355 
	`zbhciTx
(
ZBHCI_CMD_ACKNOWLEDGE
, 4, 
ªt
);

1356 
	}
}

	@zbhci/zbhci_zclHandler.c

24 
	~"z˛_ö˛ude.h
"

25 
	~"Ÿa.h
"

26 
	~"zbhci.h
"

27 #i‡
ZB_TEST_ENABLE


28 
	~"zbhci_ã°ˇ£.h
"

32 #i‡
ZBHCI_EN


33 c⁄° 
zbhciTxMode_e
 
	gzbhciC⁄vîtSë
[] = {

34 
APS_DSTADDR_EP_NOTPRESETNT
,

35 
APS_SHORT_GROUPADDR_NOEP
,

36 
APS_SHORT_DSTADDR_WITHEP
,

37 
APS_LONG_DSTADDR_WITHEP
,

38 
APS_SHORT_DSTADDR_WITHEP
,

39 
APS_DSTADDR_EP_NOTPRESETNT
,

40 
APS_SHORT_DSTADDR_WITHEP
,

41 
APS_LONG_DSTADDR_WITHEP


45 
	$zbhciTxClu°îCmdAddrResﬁve
(
ïInfo_t
 *
d°EpInfo
, 
u8
 *
§cEp
, u8 **
∑ylﬂd
){

46 
	`mem£t
((
u8
 *)
d°EpInfo
,0,(*dstEpInfo));

48 
zbhciTxMode_e
 
≠sTxMode
 = **
∑ylﬂd
;

49 (*
∑ylﬂd
)++;

51 if((
≠sTxMode
 < 
ZBHCI_ADDRMODE_BRC
Ë&& (≠sTxModê!
ZBHCI_ADDRMODE_GROUP
)){

52 
d°EpInfo
->
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

54 
d°EpInfo
->
¥ofûeId
 = 0x0104;

55 
d°EpInfo
->
d°AddrMode
 = 
zbhciC⁄vîtSë
[
≠sTxMode
];

56 if(
d°EpInfo
->
d°AddrMode
 =
APS_LONG_DSTADDR_WITHEP
){

57 
	`ZB_IEEE_ADDR_REVERT
(
d°EpInfo
->
d°Addr
.
extAddr
,*
∑ylﬂd
);

58 (*
∑ylﬂd
Ë+
EXT_ADDR_LEN
;

59 }if(
d°EpInfo
->
d°AddrMode
 =
APS_DSTADDR_EP_NOTPRESETNT
){

62 }if(
d°EpInfo
->
d°AddrMode
 =
APS_SHORT_GROUPADDR_NOEP
 || d°EpInfo->d°AddrModê=
APS_SHORT_DSTADDR_WITHEP
){

63 
	`COPY_BUFFERTOU16_BE
(
d°EpInfo
->
d°Addr
.
sh‹tAddr
, *
∑ylﬂd
);

64 (*
∑ylﬂd
Ë+(
u16
);

66 *
§cEp
 = **
∑ylﬂd
;

67 (*
∑ylﬂd
)++;

69 if(
d°EpInfo
->
d°AddrMode
 =
APS_LONG_DSTADDR_WITHEP
 || d°EpInfo->d°AddrModê=
APS_SHORT_DSTADDR_WITHEP
){

70 
d°EpInfo
->
d°Ep
 = **
∑ylﬂd
;

71 (*
∑ylﬂd
)++;

73 
	}
}

80 
	$zbhci_z˛IdítifyCmdH™dÀ
(*
¨g
){

81 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

82 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

83 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

85 
ïInfo_t
 
d°EpInfo
;

86 
u8
 
§cEp
;

87 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

89 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
pCmd
);

91 
°©us_t
 
°a
 = 
ZCL_STA_FAILURE
;

92 if(
cmdId
 =
ZBHCI_CMD_ZCL_IDENTIFY
){

93 
u16
 
idítifyTime
;

95 
	`COPY_BUFFERTOU16_BE
(
idítifyTime
, 
pCmd
);

96 
u32
 
m™uCode
 = 0;

97 
°a
 = 
	`z˛_idítify_idítifyCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
idítifyTime
, 
m™uCode
);

98 }if(
cmdId
 =
ZBHCI_CMD_ZCL_IDENTIFY_QUERY
){

99 
°a
 = 
	`z˛_idítify_idítifyQuîyCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
);

102 
	`ev_buf_‰ì
(
¨g
);

103 
	}
}

112 
	$zbhci_z˛OnoffCmdH™dÀ
(*
¨g
){

113 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

114 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

115 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

117 
u8
 *
±r
 = 
p
;

118 
ïInfo_t
 
d°EpInfo
;

119 
u8
 
§cEp
;

120 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

122 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
±r
);

124 
°©us_t
 
°a
 = 
ZCL_STA_FAILURE
;

125 if(
cmdId
 =
ZBHCI_CMD_ZCL_ONOFF_ON
){

126 
°a
 = 
	`z˛_⁄Off_⁄Cmd
(
§cEp
, &
d°EpInfo
, 0);

127 }if(
cmdId
 =
ZBHCI_CMD_ZCL_ONOFF_OFF
){

128 
°a
 = 
	`z˛_⁄Off_offCmd
(
§cEp
, &
d°EpInfo
, 0);

129 }if(
cmdId
 =
ZBHCI_CMD_ZCL_ONOFF_TOGGLE
){

130 
°a
 = 
	`z˛_⁄Off_toggÀCmd
(
§cEp
, &
d°EpInfo
, 0);

133 
	`ev_buf_‰ì
(
¨g
);

134 
	}
}

143 
	$zbhci_z˛LevñCålCmdH™dÀ
(*
¨g
){

144 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

145 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

146 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

148 
u8
 *
±r
 = 
p
;

149 
ïInfo_t
 
d°EpInfo
;

150 
u8
 
§cEp
;

151 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

153 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
±r
);

155 
°©us_t
 
°a
 = 
ZCL_STA_FAILURE
;

156 
cmdId
){

157 
ZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL
:

158 
ZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL_WITHONOFF
:

160 
u8
 
Àvñ
 = 
±r
[0];

161 
u16
 
å™sTime
;

162 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[1]);

164 
moveToLvl_t
 
move2Levñ
;

165 
move2Levñ
.
Àvñ
 =Üevel;

166 
move2Levñ
.
å™sôi⁄Time
 = 
å™sTime
;

167 
move2Levñ
.
›tPª£¡
 = 0;

169 if(
cmdId
 =
ZBHCI_CMD_ZCL_LEVEL_MOVE2LEVEL
){

170 
°a
 = 
	`z˛_Àvñ_move2ÀvñCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2Levñ
);

172 
°a
 = 
	`z˛_Àvñ_move2ÀvñWôhOnOffCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2Levñ
);

177 
ZBHCI_CMD_ZCL_LEVEL_MOVE
:

178 
ZBHCI_CMD_ZCL_LEVEL_MOVE_WITHONOFF
:

180 
move_t
 
move
;

181 
move
.
moveMode
 = 
±r
[0];

182 
move
.
øã
 = 
±r
[1];

183 
move
.
›tPª£¡
 = 0;

185 if(
cmdId
 =
ZBHCI_CMD_ZCL_LEVEL_MOVE
){

186 
°a
 = 
	`z˛_Àvñ_moveCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move
);

188 
°a
 = 
	`z˛_Àvñ_moveWôhOnOffCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move
);

193 
ZBHCI_CMD_ZCL_LEVEL_STEP
:

194 
ZBHCI_CMD_ZCL_LEVEL_STEP_WITHONOFF
:

196 
u8
 
°ïMode
 = 
±r
[0];

197 
u8
 
°ïSize
 = 
±r
[1];

198 
u16
 
å™sTime
;

199 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[2]);

201 
°ï_t
 
°ï
;

202 
°ï
.
°ïMode
 = stepMode;

203 
°ï
.
°ïSize
 = stepSize;

204 
°ï
.
å™sôi⁄Time
 = 
å™sTime
;

205 
°ï
.
›tPª£¡
 = 0;

207 if(
cmdId
 =
ZBHCI_CMD_ZCL_LEVEL_STEP
){

208 
°a
 = 
	`z˛_Àvñ_°ïCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
°ï
);

210 
°a
 = 
	`z˛_Àvñ_°ïWôhOnOffCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
°ï
);

215 
ZBHCI_CMD_ZCL_LEVEL_STOP
:

216 
ZBHCI_CMD_ZCL_LEVEL_STOP_WITHONOFF
:

218 
°›_t
 
°›
;

219 
°›
.
›tPª£¡
 = 0;

221 if(
cmdId
 =
ZBHCI_CMD_ZCL_LEVEL_STOP
){

222 
°a
 = 
	`z˛_Àvñ_°›Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
°›
);

224 
°a
 = 
	`z˛_Àvñ_°›WôhOnOffCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
°›
);

233 
	`ev_buf_‰ì
(
¨g
);

234 
	}
}

237 
	$zbhci_z˛Cﬁ‹CålCmdH™dÀ
(*
¨g
){

238 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

239 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

240 
u8
 *
p
 = 
cmdInfo
->
∑ylﬂd
;

242 
u8
 *
±r
 = 
p
;

243 
ïInfo_t
 
d°EpInfo
;

244 
u8
 
§cEp
;

245 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

247 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
±r
);

249 
cmdId
){

250 
ZBHCI_CMD_ZCL_COLOR_MOVE2HUE
:

252 
u8
 
hue
 = 
±r
[0];

253 
u8
 
dúe˘i⁄
 = 
±r
[1];

254 
u16
 
å™sTime
;

255 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[2]);

257 
z˛_cﬁ‹CålMoveToHueCmd_t
 
move2Hue
;

258 
move2Hue
.
hue
 = hue;

259 
move2Hue
.
dúe˘i⁄
 = direction;

260 
move2Hue
.
å™sôi⁄Time
 = 
å™sTime
;

261 
move2Hue
.
›tPª£¡
 = 0;

263 
	`z˛_lightCﬁ‹Cål_move2hueCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2Hue
);

267 
ZBHCI_CMD_ZCL_COLOR_MOVE2COLOR
:

269 
u16
 
cﬁ‹X
;

270 
u16
 
cﬁ‹Y
;

271 
u16
 
å™sTime
;

273 
	`COPY_BUFFERTOU16_BE
(
cﬁ‹X
, &
±r
[0]);

274 
	`COPY_BUFFERTOU16_BE
(
cﬁ‹Y
, &
±r
[2]);

275 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[4]);

277 
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 
move2Cﬁ‹
;

278 
move2Cﬁ‹
.
cﬁ‹X
 = colorX;

279 
move2Cﬁ‹
.
cﬁ‹Y
 = colorY;

280 
move2Cﬁ‹
.
å™sôi⁄Time
 = 
å™sTime
;

281 
move2Cﬁ‹
.
›tPª£¡
 = 0;

283 
	`z˛_lightCﬁ‹Cål_move2cﬁ‹Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2Cﬁ‹
);

287 
ZBHCI_CMD_ZCL_COLOR_MOVE2SAT
:

289 
u8
 
ßtuøti⁄
 = 
±r
[0];

290 
u16
 
å™sTime
;

291 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[1]);

293 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 
move2S©
;

294 
move2S©
.
ßtuøti⁄
 = saturation;

295 
move2S©
.
å™sôi⁄Time
 = 
å™sTime
;

296 
move2S©
.
›tPª£¡
 = 0;

298 
	`z˛_lightCﬁ‹Cål_move2ßtuøti⁄Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2S©
);

302 
ZBHCI_CMD_ZCL_COLOR_MOVE2TEMP
:

304 
u16
 
cﬁ‹Tem≥øtuª
;

305 
u16
 
å™sTime
;

307 
	`COPY_BUFFERTOU16_BE
(
cﬁ‹Tem≥øtuª
, &
±r
[0]);

308 
	`COPY_BUFFERTOU16_BE
(
å™sTime
, &
±r
[2]);

310 
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 
move2Cﬁ‹Temp
;

311 
move2Cﬁ‹Temp
.
cﬁ‹Tem≥øtuª
 = colorTemperature;

312 
move2Cﬁ‹Temp
.
å™sôi⁄Time
 = 
å™sTime
;

313 
move2Cﬁ‹Temp
.
›tPª£¡
 = 0;

315 
	`z˛_lightCﬁ‹Cål_move2cﬁ‹Tem≥øtuªCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
move2Cﬁ‹Temp
);

322 
	`ev_buf_‰ì
(
¨g
);

323 
	}
}

332 
	$zbhci_˛u°îGroupH™dÀ
(*
¨g
){

333 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

334 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

335 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

337 
ïInfo_t
 
d°EpInfo
;

338 
u8
 
§cEp
;

339 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

341 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
pCmd
);

343 
°©us_t
 
°a
 = 
ZCL_STA_FAILURE
;

344 if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_ADD
){

345 
u16
 
groupID
;

346 
	`COPY_BUFFERTOU16_BE
(
groupID
, 
pCmd
);

347 
pCmd
 += 2;

348 
u8
 
groupName
[8];

349 
	`mem˝y
(
groupName
, 
pCmd
, 8);

350 
°a
 = 
	`z˛_group_addCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
groupID
, 
groupName
);

352 }if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_VIEW
){

353 
u16
 
groupID
;

354 
	`COPY_BUFFERTOU16_BE
(
groupID
, 
pCmd
);

355 
°a
 = 
	`z˛_group_võwCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
groupID
);

356 }if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_GET_MEMBERSHIP
){

357 
u8
 
groupC¡
 = *
pCmd
;

358 
pCmd
++;

359 
u16
 
groupLi°
[8];

360 
i
 = 0;

361 
i
 = 0; i < 
groupC¡
 && i < 8; i++){

362 
	`COPY_BUFFERTOU16_BE
(
groupLi°
[
i
], 
pCmd
);

363 
pCmd
 += 2;

365 
groupC¡
 = 
i
;

366 
°a
 = 
	`z˛_group_gëMembîshùCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
groupC¡
, 
groupLi°
);

367 }if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_REMOVE
){

368 
u16
 
groupID
;

369 
	`COPY_BUFFERTOU16_BE
(
groupID
, 
pCmd
);

370 
°a
 = 
	`z˛_group_ªmoveCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
groupID
);

371 }if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_REMOVE_ALL
){

372 
°a
 = 
	`z˛_group_ªmoveAŒCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
);

373 }if(
cmdId
 =
ZBHCI_CMD_ZCL_GROUP_ADD_IF_IDENTIFY
){

374 
u16
 
groupID
;

375 
	`COPY_BUFFERTOU16_BE
(
groupID
, 
pCmd
);

376 
pCmd
 += 2;

378 
u8
 
groupName
[8];

379 
	`mem˝y
(
groupName
, 
pCmd
, 8);

380 
°a
 = 
	`z˛_group_addIfIdítifyCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
groupID
, 
groupName
);

383 
	`ev_buf_‰ì
(
¨g
);

384 
	}
}

393 
	$zbhci_˛u°îS˚√H™dÀ
(*
¨g
){

394 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

395 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

396 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

398 
ïInfo_t
 
d°EpInfo
;

399 
u8
 
§cEp
;

400 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

402 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
pCmd
);

404 
°©us_t
 
°a
 = 
ZCL_STA_FAILURE
;

405 
cmdId
){

406 
ZBHCI_CMD_ZCL_SCENE_ADD
:

408 
addS˚√_t
 *
pAddS˚√
 = (addS˚√_à*)
	`ev_buf_Æloˇã
((addScene_t));

409 if(!
pAddS˚√
){

410 
°a
 = 
RET_NO_MEMORY
;

414 
	`COPY_BUFFERTOU16_BE
(
pAddS˚√
->
s˚√
.
groupId
, 
pCmd
);

415 
pCmd
 += 2;

416 
pAddS˚√
->
s˚√
.
s˚√Id
 = *
pCmd
++;

417 
	`COPY_BUFFERTOU16_BE
(
pAddS˚√
->
s˚√
.
å™sTime
, 
pCmd
);

418 
pCmd
 += 2;

419 
u8
 
«meLí
 = *
pCmd
++;

420 
pAddS˚√
->
s˚√
.
s˚√Name
[0] = (
«meLí
 > (
ZCL_MAX_SCENE_NAME_LEN
 - 1)) ? (ZCL_MAX_SCENE_NAME_LEN - 1) :ÇameLen;

421 
	`mem˝y
(&
pAddS˚√
->
s˚√
.
s˚√Name
[1], 
pCmd
,ÖAddScene->scene.sceneName[0]);

422 
pCmd
 +
«meLí
;

423 
pAddS˚√
->
s˚√
.
extFõldLí
 = *
pCmd
++;

424 if(
pAddS˚√
->
s˚√
.
extFõldLí
){

425 
pAddS˚√
->
s˚√
.
extFõldLí
 = (pAddS˚√->s˚√.extFõldLí > 
ZCL_MAX_SCENE_EXT_FIELD_SIZE
) ? ZCL_MAX_SCENE_EXT_FIELD_SIZE

426 : 
pAddS˚√
->
s˚√
.
extFõldLí
;

427 
	`mem˝y
(
pAddS˚√
->
s˚√
.
extFõld
, 
pCmd
,ÖAddS˚√->s˚√.
extFõldLí
);

430 
°a
 = 
	`z˛_s˚√_addS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, 
pAddS˚√
);

432 
	`ev_buf_‰ì
((
u8
 *)
pAddS˚√
);

435 
ZBHCI_CMD_ZCL_SCENE_VIEW
:

437 
võwS˚√_t
 
võwS˚√
;

439 
	`COPY_BUFFERTOU16_BE
(
võwS˚√
.
groupId
, 
pCmd
);

440 
pCmd
 += 2;

441 
võwS˚√
.
s˚√Id
 = *
pCmd
++;

443 
°a
 = 
	`z˛_s˚√_võwS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
võwS˚√
);

446 
ZBHCI_CMD_ZCL_SCENE_REMOVE
:

448 
ªmoveS˚√_t
 
ªmoveS˚√
;

450 
	`COPY_BUFFERTOU16_BE
(
ªmoveS˚√
.
groupId
, 
pCmd
);

451 
pCmd
 += 2;

452 
ªmoveS˚√
.
s˚√Id
 = *
pCmd
++;

454 
°a
 = 
	`z˛_s˚√_ªmoveS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
ªmoveS˚√
);

457 
ZBHCI_CMD_ZCL_SCENE_REMOVE_ALL
:

459 
ªmoveAŒS˚√_t
 
ªmoveAŒS˚√
;

461 
	`COPY_BUFFERTOU16_BE
(
ªmoveAŒS˚√
.
groupId
, 
pCmd
);

462 
pCmd
 += 2;

464 
°a
 = 
	`z˛_s˚√_ªmoveAŒS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
ªmoveAŒS˚√
);

467 
ZBHCI_CMD_ZCL_SCENE_STORE
 :

469 
°‹eS˚√_t
 
°‹eS˚√
;

471 
	`COPY_BUFFERTOU16_BE
(
°‹eS˚√
.
groupId
, 
pCmd
);

472 
pCmd
 += 2;

473 
°‹eS˚√
.
s˚√Id
 = *
pCmd
++;

475 
°a
 = 
	`z˛_s˚√_°‹eS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
°‹eS˚√
);

478 
ZBHCI_CMD_ZCL_SCENE_RECALL
:

480 
ªˇŒS˚√_t
 
ªˇŒS˚√
;

482 
	`COPY_BUFFERTOU16_BE
(
ªˇŒS˚√
.
groupId
, 
pCmd
);

483 
pCmd
 += 2;

484 
ªˇŒS˚√
.
s˚√Id
 = *
pCmd
++;

485 
ªˇŒS˚√
.
å™sTime
 = 0;

487 
°a
 = 
	`z˛_s˚√_ªˇŒS˚√Cmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
ªˇŒS˚√
);

490 
ZBHCI_CMD_ZCL_SCENE_GET_MEMBERSHIP
:

492 
gëS˚√Memshù_t
 
gëS˚√Memshù
;

494 
	`COPY_BUFFERTOU16_BE
(
gëS˚√Memshù
.
groupId
, 
pCmd
);

495 
pCmd
 += 2;

497 
°a
 = 
	`z˛_s˚√_gëS˚√MemshùCmd
(
§cEp
, &
d°EpInfo
, 
FALSE
, &
gëS˚√Memshù
);

504 
	`ev_buf_‰ì
(
¨g
);

505 
	}
}

507 
	$cu°_Ÿa_°¨t_ªq
(
ïInfo_t
 *
d°EpInfo
,
u8
 
§cEp
,u8 **
∑ylﬂd
)

509 
u32
 
image_Àngth
;

510 
Ÿa_hdrFõlds_t
 
Ÿa_hdr
;

511 
u32
 
Ÿa_°¨t_addr
 = 0;

512 if(
	`mcuBoŸAddrGë
() == 0)

514 
Ÿa_°¨t_addr
 = 
FLASH_ADDR_OF_OTA_IMAGE
;

518 
Ÿa_°¨t_addr
 = 0;

521 
	`Êash_ªad
(
Ÿa_°¨t_addr
,(
Ÿa_hdrFõlds_t
),(
u8
*)&
Ÿa_hdr
);

522 
image_Àngth
 = 
Ÿa_hdr
.
tŸÆImageSize
;

524 
Ÿa_imageNŸify_t
 
ö
;

525 
ö
.
∑ylﬂdTy≥
 = **
∑ylﬂd
;

526 (*
∑ylﬂd
) ++;

527 
ö
.
imageTy≥
 = 
Ÿa_hdr
.imageType;

528 
ö
.
m™uCode
 = 
Ÿa_hdr
.
m™uÁ˘uªrCode
;

529 
ö
.
√wFûeVî
 = 
Ÿa_hdr
.
fûeVî
;

530 
ö
.
quîyJôãr
 = **
∑ylﬂd
;

532 
	`z˛_Ÿa_imageNŸifyCmdSíd
(
§cEp
, 
d°EpInfo
, 
FALSE
, &
ö
);

534 
	}
}

536 
	$zbhci_˛u°îOTAH™dÀ
(*
¨g
){

537 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

539 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

541 
ïInfo_t
 
d°EpInfo
;

542 
u8
 
§cEp
;

543 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

545 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
pCmd
);

547 
	`cu°_Ÿa_°¨t_ªq
(&
d°EpInfo
,
§cEp
,&
pCmd
);

549 
	`ev_buf_‰ì
(
¨g
);

550 
	}
}

552 vﬁ©ûê
°©us_t
 
	gbasic_°©us
 = 0;

553 
	$zbhci_˛u°îBasicH™dÀ
(*
¨g
){

554 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

555 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

557 
ïInfo_t
 
d°EpInfo
;

558 
u8
 
§cEp
;

559 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

561 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
,&
§cEp
,&
pCmd
);

563 
basic_°©us
 = 
	`z˛_basic_ª£tFa˘‹yD·Cmd
(
§cEp
,&
d°EpInfo
,
FALSE
);

564 
	`ev_buf_‰ì
(
¨g
);

565 
	}
}

567 
	$zbhci_˛u°îComm⁄CmdH™dÀ
(*
¨g
){

568 
zbhci_cmdH™dÀr_t
 *
cmdInfo
 = 
¨g
;

569 
u16
 
cmdId
 = 
cmdInfo
->cmdId;

570 
u8
 *
pCmd
 = 
cmdInfo
->
∑ylﬂd
;

572 
ïInfo_t
 
d°EpInfo
;

573 
u8
 
§cEp
;

574 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

576 
	`zbhciTxClu°îCmdAddrResﬁve
(&
d°EpInfo
, &
§cEp
, &
pCmd
);

578 
d°EpInfo
.
¥ofûeId
 = 
pCmd
[1] | (pCmd[0] << 8);

579 
pCmd
 += 2;

581 
u8
 
dú
 = *
pCmd
;

582 
pCmd
++;

583 
u16
 
˛u°îId
 = 
pCmd
[1] | (pCmd[0] << 8);

584 
pCmd
 += 2;

585 
u8
 
numAâr
 = *
pCmd
++;

587 if(
cmdId
 =
ZBHCI_CMD_ZCL_ATTR_READ
){

588 
z˛RódCmd_t
 *
pRódCmd
 = (z˛RódCmd_à*)
	`ev_buf_Æloˇã
((z˛RódCmd_tË+ 
numAâr
 * (
u16
));

589 if(
pRódCmd
){

590 
pRódCmd
->
numAâr
 =ÇumAttr;

592 
u8
 
i
 = 0; i < 
numAâr
; i++){

593 
pRódCmd
->
©åID
[
i
] = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

594 
pCmd
 += 2;

597 
	`z˛_£ndRódCmd
(
§cEp
, &
d°EpInfo
, 
˛u°îId
, 
TRUE
, 
dú
, 
pRódCmd
);

599 
	`ev_buf_‰ì
((
u8
 *)
pRódCmd
);

601 }if(
cmdId
 =
ZBHCI_CMD_ZCL_ATTR_WRITE
){

602 
u16
 
d©aLí
 = 0;

603 
u16
 
©åD©aLí
 = 0;

604 
u8
 *
pBuf
 = 
pCmd
;

606 
u8
 
i
 = 0; i < 
numAâr
; i++){

607 
pBuf
 += 2;

609 
u8
 
d©aTy≥
 = *
pBuf
++;

610 
©åD©aLí
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pBuf
);

611 
pBuf
 +
©åD©aLí
;

613 
d©aLí
 +
©åD©aLí
;

616 
z˛WrôeCmd_t
 *
pWrôeCmd
 = (z˛WrôeCmd_à*)
	`ev_buf_Æloˇã
((z˛WrôeCmd_tË+ 
numAâr
 * (
z˛WrôeRec_t
Ë+ 
d©aLí
);

617 if(
pWrôeCmd
){

619 
pBuf
 = (
u8
 *)
pWrôeCmd
 + (
z˛WrôeCmd_t
Ë+ 
numAâr
 * (
z˛WrôeRec_t
);

621 
pWrôeCmd
->
numAâr
 =ÇumAttr;

623 
z˛WrôeRec_t
 *
pWrôeRec
 = 
NULL
;

624 
u8
 
i
 = 0; i < 
numAâr
; i++){

625 
pWrôeRec
 = &(
pWrôeCmd
->
©åLi°
[
i
]);

627 
pWrôeRec
->
©åID
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

628 
pCmd
 += 2;

629 
pWrôeRec
->
d©aTy≥
 = *
pCmd
++;

630 
©åD©aLí
 = 
	`z˛_gëAârSize
(
pWrôeRec
->
d©aTy≥
, 
pCmd
);

631 
	`mem˝y
(
pBuf
, 
pCmd
, 
©åD©aLí
);

632 if–(
pWrôeRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_LONG_CHAR_STR
Ë&& (pWrôeRec->d©aTy≥ !
ZCL_DATA_TYPE_LONG_OCTET_STR
) &&

633 (
pWrôeRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_CHAR_STR
Ë&& (pWrôeRec->d©aTy≥ !
ZCL_DATA_TYPE_OCTET_STR
) &&

634 (
pWrôeRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_STRUCT
) ){

635 
	`ZB_LEBESWAP
(
pBuf
, 
©åD©aLí
);

637 
pWrôeRec
->
©åD©a
 = 
pBuf
;

639 
pBuf
 +
©åD©aLí
;

640 
pCmd
 +
©åD©aLí
;

643 
	`z˛_£ndWrôeCmd
(
§cEp
, &
d°EpInfo
, 
˛u°îId
, 
TRUE
, 
dú
, 
pWrôeCmd
);

645 
	`ev_buf_‰ì
((
u8
 *)
pWrôeCmd
);

647 }if(
cmdId
 =
ZBHCI_CMD_ZCL_CONFIG_REPORT
){

648 
u16
 
d©aLí
 = 0;

649 
u16
 
ªp‹tCh™geLí
 = 0;

650 
u8
 *
pBuf
 = 
pCmd
;

652 
u8
 
i
 = 0; i < 
numAâr
; i++){

653 
u8
 
dúe˘i⁄
 = *
pBuf
++;

654 
pBuf
 += 2;

656 if(
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
){

657 
u8
 
d©aTy≥
 = *
pBuf
++;

658 
pBuf
 += 4;

660 if(
	`z˛_™ÆogD©aTy≥
(
d©aTy≥
)){

661 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
d©aTy≥
);

662 
pBuf
 +
ªp‹tCh™geLí
;

663 
d©aLí
 +
ªp‹tCh™geLí
;

665 
pBuf
++;

668 
pBuf
 += 2;

672 
z˛CfgRï‹tCmd_t
 *
pCfgRï‹tCmd
 = (z˛CfgRï‹tCmd_à*)
	`ev_buf_Æloˇã
((z˛CfgRï‹tCmd_tË+ 
numAâr
 * (
z˛CfgRï‹tRec_t
Ë+ 
d©aLí
);

673 if(
pCfgRï‹tCmd
){

675 
pBuf
 = (
u8
 *)
pCfgRï‹tCmd
 + (
z˛CfgRï‹tCmd_t
Ë+ 
numAâr
 * (
z˛CfgRï‹tRec_t
);

677 
pCfgRï‹tCmd
->
numAâr
 =ÇumAttr;

679 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
 = 
NULL
;

680 
u8
 
i
 = 0; i < 
numAâr
; i++){

681 
pCfgRï‹tRec
 = &(
pCfgRï‹tCmd
->
©åLi°
[
i
]);

683 
pCfgRï‹tRec
->
dúe˘i⁄
 = *
pCmd
++;

684 
pCfgRï‹tRec
->
©åID
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

685 
pCmd
 += 2;

686 if(
pCfgRï‹tRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
){

687 
pCfgRï‹tRec
->
d©aTy≥
 = *
pCmd
++;

688 
pCfgRï‹tRec
->
möRï‹tI¡
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

689 
pCmd
 += 2;

690 
pCfgRï‹tRec
->
maxRï‹tI¡
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

691 
pCmd
 += 2;

692 if(
	`z˛_™ÆogD©aTy≥
(
pCfgRï‹tRec
->
d©aTy≥
)){

693 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
pCfgRï‹tRec
->
d©aTy≥
);

694 
	`mem˝y
(
pBuf
, 
pCmd
, 
ªp‹tCh™geLí
);

695 if–(
pCfgRï‹tRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_LONG_CHAR_STR
Ë&& (pCfgRï‹tRec->d©aTy≥ !
ZCL_DATA_TYPE_LONG_OCTET_STR
) &&

696 (
pCfgRï‹tRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_CHAR_STR
Ë&& (pCfgRï‹tRec->d©aTy≥ !
ZCL_DATA_TYPE_OCTET_STR
) &&

697 (
pCfgRï‹tRec
->
d©aTy≥
 !
ZCL_DATA_TYPE_STRUCT
) ){

698 
	`ZB_LEBESWAP
(
pBuf
, 
ªp‹tCh™geLí
);

700 
pCfgRï‹tRec
->
ªp‹èbÀCh™ge
 = 
pBuf
;

702 
pBuf
 +
ªp‹tCh™geLí
;

703 
pCmd
 +
ªp‹tCh™geLí
;

706 
pCfgRï‹tRec
->
timeoutPîiod
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

707 
pCmd
 += 2;

711 
	`z˛_£ndCfgRï‹tCmd
(
§cEp
, &
d°EpInfo
, 
˛u°îId
, 
TRUE
, 
dú
, 
pCfgRï‹tCmd
);

713 
	`ev_buf_‰ì
((
u8
 *)
pCfgRï‹tCmd
);

715 }if(
cmdId
 =
ZBHCI_CMD_ZCL_READ_REPORT_CFG
){

716 
z˛RódRï‹tCfgCmd_t
 *
pRódRï‹tCfgCmd
 = (z˛RódRï‹tCfgCmd_à*)
	`ev_buf_Æloˇã
((z˛RódRï‹tCfgCmd_tË+ 
numAâr
 * (
z˛RódRï‹tCfgRec_t
));

717 if(
pRódRï‹tCfgCmd
){

718 
pRódRï‹tCfgCmd
->
numAâr
 =ÇumAttr;

720 
z˛RódRï‹tCfgRec_t
 *
pRódRï‹tCfgRec
 = 
NULL
;

721 
u8
 
i
 = 0; i < 
numAâr
; i++){

722 
pRódRï‹tCfgRec
 = &(
pRódRï‹tCfgCmd
->
©åLi°
[
i
]);

724 
pRódRï‹tCfgRec
->
dúe˘i⁄
 = *
pCmd
++;

725 
pRódRï‹tCfgRec
->
©åID
 = 
	`BUILD_U16
(
pCmd
[1],ÖCmd[0]);

726 
pCmd
 += 2;

729 
	`z˛_£ndRódRï‹tCfgCmd
(
§cEp
, &
d°EpInfo
, 
˛u°îId
, 
TRUE
, 
dú
, 
pRódRï‹tCfgCmd
);

731 
	`ev_buf_‰ì
((
u8
 *)
pRódRï‹tCfgCmd
);

735 
	`ev_buf_‰ì
(
¨g
);

736 
	}
}

	@zigbee/af/zb_af.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

28 #i‡
deföed
 
ZB_COORDINATOR_ROLE
 && (ZB_COORDINATOR_ROLE == 1)

29 
	#LOGICAL_TYPE
 
DEVICE_TYPE_COORDINATOR


	)

30 
	#SERVER_MASK
 (
ND_SERVER_MASK_REV21
 | 
ND_SERVER_MASK_PRIMARY_TRUST_CENTER
 | 
ND_SERVER_MASK_NETWORK_MANAGER
)

	)

31 
	#MAC_CAPABILITY_FLAGS
 (
MAC_CAP_DEVICE_TYPE_FFD
 | 
MAC_CAP_POWER_SOURCE_MAINS
 | 
MAC_CAP_RX_ON_WHEN_IDLE
 | 
MAC_CAP_ALLOCATE_ADDRESS
 | 
MAC_CAP_ALTERNATE_PAN_COORDINATOR
)

	)

32 #ñi‡
deföed
 
ZB_ROUTER_ROLE
 && (ZB_ROUTER_ROLE == 1)

33 
	#LOGICAL_TYPE
 
DEVICE_TYPE_ROUTER


	)

34 
	#SERVER_MASK
 (
ND_SERVER_MASK_REV21
)

	)

35 
	#MAC_CAPABILITY_FLAGS
 (
MAC_CAP_DEVICE_TYPE_FFD
 | 
MAC_CAP_POWER_SOURCE_MAINS
 | 
MAC_CAP_RX_ON_WHEN_IDLE
 | 
MAC_CAP_ALLOCATE_ADDRESS
)

	)

36 #ñi‡
deföed
 
ZB_ED_ROLE
 && (ZB_ED_ROLE == 1)

37 
	#LOGICAL_TYPE
 
DEVICE_TYPE_END_DEVICE


	)

38 
	#SERVER_MASK
 (
ND_SERVER_MASK_REV21
)

	)

39 #i‡
ZB_MAC_RX_ON_WHEN_IDLE


40 
	#MAC_CAPABILITY_FLAGS
 (
MAC_CAP_DEVICE_TYPE_RFD
 | 
MAC_CAP_RX_ON_WHEN_IDLE
 | 
MAC_CAP_ALLOCATE_ADDRESS
)

	)

42 
	#MAC_CAPABILITY_FLAGS
 (
MAC_CAP_DEVICE_TYPE_RFD
 | 
MAC_CAP_ALLOCATE_ADDRESS
)

	)

48 
node_des¸ùt‹_t
 
	gndt
 = {

49 .
logiˇl_ty≥
 = 
LOGICAL_TYPE
,

50 .
	g£rvî_mask
 = 
SERVER_MASK
,

51 .
	gmac_ˇ∑bûôy_Êag
 = 
MAC_CAPABILITY_FLAGS
,

52 .
	gcom∂ex_des¸ùt‹_ava
 = 
FALSE
,

53 .
	gu£r_des¸ùt‹_ava
 = 
FALSE
,

54 .
	gª£rved
 = 0,

55 .
	g≠s_Êag
 = 0,

56 .
	g‰eq_b™d
 = 
NODE_FREQ_2400
,

57 .
	gmax_buff_size
 = 
AF_NSDU_MAX_LEN
,

58 .
	gmax_ö_å_size
 = 
AF_NSDU_MAX_LEN
,

59 .
	gmax_out_å_size
 = 
AF_NSDU_MAX_LEN
,

60 .
	gmcL8
 = (
MANUFACTURER_CODE_TELINK
 & 0xff),

61 .
	gmcH8
 = ((
MANUFACTURER_CODE_TELINK
 >> 8) & 0xff),

65 
powî_des¸ùt‹_t
 
	gpdt
 = {

66 #i‡
deföed
 (
ZB_ROUTER_ROLE
Ë&& (ZB_ROUTER_ROLE =
TRUE
)

67 .
cuºít_powî_mode
 = 
POWER_MODE_RECEIVER_SYNCRONIZED_WHEN_ON_IDLE
,

68 .
	gavaûabÀ_powî_sour˚s
 = 
POWER_SRC_MAINS_POWER
,

69 .
	gcuºít_powî_sour˚
 = 
POWER_SRC_MAINS_POWER
,

70 .
	gcuºít_powî_sour˚_Àvñ
 = 
POWER_LEVEL_PERCENT_100
,

71 #ñi‡
deföed
 (
ZB_ED_ROLE
Ë&& (ZB_ED_ROLE =
TRUE
)

72 .
	gcuºít_powî_mode
 = 
POWER_MODE_RECEIVER_COMES_PERIODICALLY
,

73 .
	gavaûabÀ_powî_sour˚s
 = 
POWER_SRC_RECHARGEABLE_BATTERY
,

74 .
	gcuºít_powî_sour˚
 = 
POWER_SRC_RECHARGEABLE_BATTERY
,

75 .
	gcuºít_powî_sour˚_Àvñ
 = 
POWER_LEVEL_PERCENT_66
,

83 
af_ídpoöt_des¸ùt‹_t
 
	g´d
[
MAX_ACTIVE_EP_NUMBER
];

84 
af_ídpoöt_des¸ùt‹_t
 
	gzdo_ïDesc
;

87 
u8
 
	gavaûabÀ_a˘ive_ï_num
 = 0;

98 
_CODE_AF_
 
	$af_öô
(){

99 
avaûabÀ_a˘ive_ï_num
 = 0;

101 
	`mem£t
((
u8
 *)
´d
, 0, (aed));

102 
	`mem£t
((
u8
 *)&
zdo_ïDesc
, 0, (zdo_epDesc));

103 
	}
}

112 
_CODE_AF_
 
	$af_powîDes¸ùt‹Së
(
powî_des¸ùt‹_t
 *
vÆue
){

113 
	`mem˝y
((
u8
 *)&
pdt
, 
vÆue
, (*value));

114 
	}
}

123 
_CODE_AF_
 
	$af_powîDescPowîModeUpd©e
(
powî_mode_t
 
mode
){

124 #i‡
	`deföed
 (
ZB_ED_ROLE
Ë&& (ZB_ED_ROLE =
TRUE
)

125 
pdt
.
cuºít_powî_mode
 = 
mode
;

127 
	}
}

136 
_CODE_AF_
 
	$af_nodeDes¸ùt‹Së
(
node_des¸ùt‹_t
 *
vÆue
){

137 
	`mem˝y
((
u8
 *)&
ndt
, 
vÆue
, (*value));

138 
	}
}

147 
_CODE_AF_
 
	$af_nodeDescM™uCodeUpd©e
(
u16
 
m™uCode
){

148 
ndt
.
mcL8
 = 
	`LO_UINT16
(
m™uCode
);

149 
ndt
.
mcH8
 = 
	`HI_UINT16
(
m™uCode
);

150 
	}
}

159 
_CODE_AF_
 
	$af_nodeDescRxOnWhíIdÀUpd©e
(
boﬁ
 
íabÀ
){

160 if(
íabÀ
){

161 
ndt
.
mac_ˇ∑bûôy_Êag
 |
	`BIT
(3);

163 
ndt
.
mac_ˇ∑bûôy_Êag
 &~
	`BIT
(3);

165 
	}
}

174 
_CODE_AF_
 
	$af_nodeDescSèckRevisi⁄Së
(
u8
 
ªvisi⁄
){

175 
ndt
.
£rvî_mask
 &= (~(0x7f << 9));

176 
ndt
.
£rvî_mask
 |(
ªvisi⁄
 << 9);

177 
	}
}

186 
_CODE_AF_
 
u8
 
	$af_nodeDescSèckRevisi⁄Gë
(){

187  ((
u8
)((
ndt
.
£rvî_mask
 & 0xfe00) >> 9));

188 
	}
}

197 
_CODE_AF_
 
u8
 
	$af_nodeMacC≠abûôyGë
(){

198  
ndt
.
mac_ˇ∑bûôy_Êag
;

199 
	}
}

208 
_CODE_AF_
 
devi˚_ty≥_t
 
	$af_nodeDevTy≥Gë
(){

209  
ndt
.
logiˇl_ty≥
;

210 
	}
}

220 
_CODE_AF_
 
u8
 
	$af_sim∂eDes¸ùt‹C›y
(
u8
 *
d°
, 
af_sim∂e_des¸ùt‹_t
 *
sd
){

221 
u8
 *
±r
 = 
d°
;

223 *
±r
++ = 
sd
->
ídpoöt
;

224 
	`COPY_U16TOBUFFER
(
±r
, 
sd
->
≠p_¥ofûe_id
);

225 
±r
 += 2;

226 
	`COPY_U16TOBUFFER
(
±r
, 
sd
->
≠p_dev_id
);

227 
±r
 += 2;

229 *
±r
 = 0;

230 *
±r
++ = 
sd
->
≠p_dev_vî
 & 0x0f;

231 *
±r
++ = 
sd
->
≠p_ö_˛u°î_cou¡
;

233 
u8
 
c›yLí
 = 
sd
->
≠p_ö_˛u°î_cou¡
 * 2;

234 
	`mem˝y
(
±r
, 
sd
->
≠p_ö_˛u°î_l°
, 
c›yLí
);

235 
±r
 +
c›yLí
;

237 *
±r
++ = 
sd
->
≠p_out_˛u°î_cou¡
;

238 
c›yLí
 = 
sd
->
≠p_out_˛u°î_cou¡
 * 2;

239 
	`mem˝y
(
±r
, 
sd
->
≠p_out_˛u°î_l°
, 
c›yLí
);

240 
±r
 +
c›yLí
;

242  (
u8
)(
±r
 - 
d°
);

243 
	}
}

252 
_CODE_AF_
 
	$af_nodeDes¸ùt‹C›y
(
node_des¸ùt‹_t
 *
d°
){

253 
	`mem˝y
((
u8
 *)
d°
, (u8 *)&
ndt
, (ndt));

254 
	}
}

263 
_CODE_AF_
 
	$af_powîDes¸ùt‹C›y
(
powî_des¸ùt‹_t
 *
d°
){

264 
	`mem˝y
((
u8
 *)
d°
, (u8 *)&
pdt
, (pdt));

265 
	}
}

278 
_CODE_AF_
 
u8
 
	$af_avaûabÀEpNumGë
(){

279  
avaûabÀ_a˘ive_ï_num
;

280 
	}
}

289 
_CODE_AF_
 
af_ídpoöt_des¸ùt‹_t
 *
	$af_ïDes¸ùt‹Gë
(){

290  
´d
;

291 
	}
}

300 
_CODE_AF_
 
af_ídpoöt_des¸ùt‹_t
 *
	$af_zdoSim∂eDes¸ùt‹Gë
(){

301  &
zdo_ïDesc
;

302 
	}
}

311 
_CODE_AF_
 
af_sim∂e_des¸ùt‹_t
 *
	$af_sim∂eDescGë
(
u8
 
ï
){

312 
u8
 
i
 = 0; i < 
avaûabÀ_a˘ive_ï_num
; i++){

313 if(
´d
[
i
].
ï
 ==Ép){

314  
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
;

318  
NULL
;

319 
	}
}

321 
_CODE_AF_
 
boﬁ
 
	$af_¥ofûeM©chedLoˇl
(
u16
 
¥ofûeID
, 
u8
 
ï
){

322 if((
ï
 =
ZDO_EP
Ë&& (
¥ofûeID
 =
ZDO_PROFILE_ID
)){

323  
TRUE
;

326 if((
ï
 !
ZDO_EP
Ë&& (
¥ofûeID
 =
LL_PROFILE_ID
)){

327  
TRUE
;

330 
u8
 
i
 = 0; i < 
avaûabÀ_a˘ive_ï_num
; i++){

331 if(((
´d
[
i
].
ï
 ==Ép) || (ep == 0xFF)) &&

332 ((
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
 =
¥ofûeID
Ë|| (¥ofûeID =
WILDCARD_PROFILE_ID
))){

333  
TRUE
;

337  
FALSE
;

338 
	}
}

340 
_CODE_AF_
 
boﬁ
 
	$af_˛u°îM©chedLoˇl
(
u16
 
˛u°îID
, 
u8
 
ï
){

341 
u8
 
i
 = 0; i < 
avaûabÀ_a˘ive_ï_num
; i++){

342 if(
´d
[
i
].
ï
 ==Ép){

343 
u8
 
j
 = 0; j < 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_ö_˛u°î_cou¡
; j++){

344 if(
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_ö_˛u°î_l°
[
j
] =
˛u°îID
){

345  
TRUE
;

349 
u8
 
j
 = 0; j < 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_out_˛u°î_cou¡
; j++){

350 if(
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_out_˛u°î_l°
[
j
] =
˛u°îID
){

351  
TRUE
;

356  
FALSE
;

357 
	}
}

359 
_CODE_AF_
 
boﬁ
 
	$af_˛suãrIdM©ched
(
u16
 
˛u°îID
, 
af_sim∂e_des¸ùt‹_t
 *
pSim∂eDesc
){

360 if(!
pSim∂eDesc
){

361  
FALSE
;

364 
u8
 
i
 = 0; i < 
pSim∂eDesc
->
≠p_ö_˛u°î_cou¡
; i++){

365 if(
˛u°îID
 =
pSim∂eDesc
->
≠p_ö_˛u°î_l°
[
i
]){

366  
TRUE
;

370 
u8
 
i
 = 0; i < 
pSim∂eDesc
->
≠p_out_˛u°î_cou¡
; i++){

371 if(
˛u°îID
 =
pSim∂eDesc
->
≠p_out_˛u°î_l°
[
i
]){

372  
TRUE
;

376  
FALSE
;

377 
	}
}

379 
_CODE_AF_
 
boﬁ
 
	$af_¥ofûeIdM©ched
(
u16
 
¥ofûeID
, 
af_sim∂e_des¸ùt‹_t
 *
pSim∂eDesc
){

380 if(!
pSim∂eDesc
){

381  
FALSE
;

384 if((
¥ofûeID
 =0xFFFFË|| (¥ofûeID =
pSim∂eDesc
->
≠p_¥ofûe_id
)){

385  
TRUE
;

387  
FALSE
;

389 
	}
}

401 
_CODE_AF_
 
boﬁ
 
	$af_ídpoötRegi°î
(
u8
 
ï
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂e_desc
, 
af_ídpoöt_cb_t
 
rx_cb
, 
af_d©aCnf_cb_t
 
˙fCb
)

403 if(
ï
 =
ZDO_EP
){

404 
zdo_ïDesc
.
ï
 =Ép;

405 
zdo_ïDesc
.
c‹ª•⁄d_sim∂e_desc
 = 
sim∂e_desc
;

406 
zdo_ïDesc
.
cb_˙f
 = 
˙fCb
;

407 
zdo_ïDesc
.
cb_rx
 = 
rx_cb
;

408  
TRUE
;

411 
u8
 
i
 = 0; i < 
MAX_ACTIVE_EP_NUMBER
; i++){

412 if(
´d
[
i
].
ï
 ==Ép){

413  
FALSE
;

417 if(
avaûabÀ_a˘ive_ï_num
 < 
MAX_ACTIVE_EP_NUMBER
){

418 
´d
[
avaûabÀ_a˘ive_ï_num
].
ï
 =Ép;

419 
´d
[
avaûabÀ_a˘ive_ï_num
].
c‹ª•⁄d_sim∂e_desc
 = 
sim∂e_desc
;

420 
´d
[
avaûabÀ_a˘ive_ï_num
].
cb_˙f
 = 
˙fCb
;

421 
´d
[
avaûabÀ_a˘ive_ï_num
++].
cb_rx
 = 
rx_cb
;

423  
FALSE
;

425  
TRUE
;

426 
	}
}

428 
_CODE_AF_
 
boﬁ
 
	$af_ídpoötUƒegi°î
(
u8
 
ï
){

429 
u8
 
i
 = 0; i < 
avaûabÀ_a˘ive_ï_num
; i++){

430 if(
´d
[
i
].
ï
 ==Ép){

431 
	`TL_SETSTRUCTCONTENT
(
´d
[
i
], 0);

432 if((
i
 + 1Ë!
avaûabÀ_a˘ive_ï_num
){

433 
	`mem˝y
((
u8
 *)&
´d
[
i
], (u8 *)&´d[ò+ 1], ◊ed[i]Ë* (
avaûabÀ_a˘ive_ï_num
 - i));

435 
avaûabÀ_a˘ive_ï_num
--;

436  
TRUE
;

439  
FALSE
;

440 
	}
}

	@zigbee/af/zb_af.h

24 #i‚de‡
ZB_AF_H


25 
	#ZB_AF_H


	)

28 
	#ZDO_PROFILE_ID
 0x0000

	)

29 
	#HA_PROFILE_ID
 0x0104

	)

30 
	#LL_PROFILE_ID
 0xC05E

	)

31 
	#GP_PROFILE_ID
 0xA1E0

	)

32 
	#WILDCARD_PROFILE_ID
 0xFFFF

	)

34 
	#ZDO_EP
 0

	)

35 
	#AF_BROADCAST_EP
 0xFF

	)

37 
	#MAX_ACTIVE_EP_NUMBER
 8

	)

39 
	#INVALID_CMP_RESULT
 0xFF

	)

45 
	#DEV_TYPE_COORDINATOR
 0

	)

46 
	#DEV_TYPE_ROUTER
 1

	)

47 
	#DEV_TYPE_ENDDEVICE
 2

	)

51 
	#AF_NSDU_MAX_LEN
 (
MAX_PHY_FRM_SIZE
 - (
ZB_MAC_FRAME_HEADER
 + 
ZB_NWK_FRAME_HEADER
 + 
ZB_APS_FRAME_HEADER
))

	)

54 
	#NODE_FREQ_800
 0x01

55 
	#NODE_FREQ_900
 0x04

56 
	#NODE_FREQ_2400
 0x08

57 

	)

60 
	mDEVICE_TYPE_COORDINATOR
 = 
DEV_TYPE_COORDINATOR
,

61 
	mDEVICE_TYPE_ROUTER
 = 
DEV_TYPE_ROUTER
,

62 
	mDEVICE_TYPE_END_DEVICE
 = 
DEV_TYPE_ENDDEVICE


63 }
	tdevi˚_ty≥_t
;

67 
	mMAC_CAP_DEVICE_TYPE_RFD
 = 0x00,

68 
	mMAC_CAP_ALTERNATE_PAN_COORDINATOR
 = 0x01,

69 
	mMAC_CAP_DEVICE_TYPE_FFD
 = 0x02,

70 
	mMAC_CAP_POWER_SOURCE_MAINS
 = 0x04,

71 
	mMAC_CAP_RX_ON_WHEN_IDLE
 = 0x08,

72 
	mMAC_CAP_SECURITY_CAPABLE
 = 0x40,

73 
	mMAC_CAP_ALLOCATE_ADDRESS
 = 0x80

78 
	mND_SERVER_MASK_NO_SERVER
 = 0x0000,

79 
	mND_SERVER_MASK_PRIMARY_TRUST_CENTER
 = 0x0001,

80 
	mND_SERVER_MASK_BACKUP_TRUST_CENTER
 = 0x0002,

81 
	mND_SERVER_MASK_PRIMARY_BINDING_TABLE_CACHE
 = 0x0004,

82 
	mND_SERVER_MASK_BACKUP_BINDING_TABLE_CACHE
 = 0x0008,

83 
	mND_SERVER_MASK_PRIMARY_DISCOVERY_CACHE
 = 0x0010,

84 
	mND_SERVER_MASK_BACKUP_DISCOVERY_CACHE
 = 0x0020,

85 
	mND_SERVER_MASK_NETWORK_MANAGER
 = 0x0040,

86 
	mND_SERVER_MASK_REV22
 = (22 << 9),

87 
	mND_SERVER_MASK_REV21
 = (21 << 9),

88 
	mND_SERVER_MASK_REV20
 = (20 << 9)

99 
devi˚_ty≥_t
 
	mlogiˇl_ty≥
:3;

104 
u8
 
	mcom∂ex_des¸ùt‹_ava
:1;

109 
u8
 
	mu£r_des¸ùt‹_ava
:1;

110 
u8
 
	mª£rved
:3;

114 
u8
 
	m≠s_Êag
:3;

123 
u8
 
	m‰eq_b™d
:5;

128 
u8
 
	mmac_ˇ∑bûôy_Êag
;

132 
u8
 
	mmcL8
;

133 
u8
 
	mmcH8
;

139 
u8
 
	mmax_buff_size
;

146 
u16
 
	mmax_ö_å_size
;

151 
u16
 
	m£rvî_mask
;

158 
u16
 
	mmax_out_å_size
;

164 
u8
 
	mdesc_ˇ∑bûôy_fõld
;

165 }
	tnode_des¸ùt‹_t
;

170 
	mPOWER_MODE_RECEIVER_SYNCRONIZED_WHEN_ON_IDLE
 = 0,

171 
	mPOWER_MODE_RECEIVER_COMES_PERIODICALLY
 = 1,

172 
	mPOWER_MODE_RECEIVER_COMES_WHEN_STIMULATED
 = 2

173 }
	tpowî_mode_t
;

177 
	mPOWER_SRC_MAINS_POWER
 = 0x1,

178 
	mPOWER_SRC_RECHARGEABLE_BATTERY
 = 0x2,

179 
	mPOWER_SRC_DISPOSABLE_BATTERY
 = 0x4,

180 }
	tpowî_sour˚_t
;

184 
	mPOWER_LEVEL_CRITICAL_0
 = 0,

185 
	mPOWER_LEVEL_PERCENT_33
 = 4,

186 
	mPOWER_LEVEL_PERCENT_66
 = 8,

187 
	mPOWER_LEVEL_PERCENT_100
 = 0xC

188 }
	tpowî_sour˚_Àvñ_t
;

191 
powî_mode_t
 
	mcuºít_powî_mode
:4;

192 
powî_sour˚_t
 
	mavaûabÀ_powî_sour˚s
:4;

193 
powî_sour˚_t
 
	mcuºít_powî_sour˚
:4;

194 
powî_sour˚_Àvñ_t
 
	mcuºít_powî_sour˚_Àvñ
:4;

195 }
	tpowî_des¸ùt‹_t
;

203 
u16
 
	m≠p_¥ofûe_id
;

204 
u16
 
	m≠p_dev_id
;

206 
u8
 
	mídpoöt
;

207 
u8
 
	m≠p_dev_vî
:4;

208 
u8
 
	mª£rved
:4;

209 
u8
 
	m≠p_ö_˛u°î_cou¡
;

210 
u8
 
	m≠p_out_˛u°î_cou¡
;

212 
u16
 *
	m≠p_ö_˛u°î_l°
;

213 
u16
 *
	m≠p_out_˛u°î_l°
;

214 }
	taf_sim∂e_des¸ùt‹_t
;

220 
é_zb_addr_t
 
	md°Addr
;

222 
u16
 
	m¥ofûeId
;

223 
u16
 
	mÆüsSrcAddr
;

225 
boﬁ
 
	mu£Alüs
;

226 
u8
 
	mÆüsSeqNum
;

227 
u8
 
	md°AddrMode
;

228 
u8
 
	md°Ep
;

230 
≠s_tx_›ti⁄s
 
	mtxO±i⁄s
;

231 
u8
 
	mødius
;

232 }
	tïInfo_t
;

237 (*
	taf_ídpoöt_cb_t
)(*
	tp
);

238 (*
	taf_d©aCnf_cb_t
)(*
	tp
);

241 
af_ídpoöt_cb_t
 
cb_rx
;

242 
af_d©aCnf_cb_t
 
cb_˙f
;

243 
af_sim∂e_des¸ùt‹_t
 *
c‹ª•⁄d_sim∂e_desc
;

244 
u8
 
ï
;

245 
u8
 
rsv
[3];

246 }
	taf_ídpoöt_des¸ùt‹_t
;

258 
	`af_öô
();

267 
	`af_powîDes¸ùt‹Së
(
powî_des¸ùt‹_t
 *
vÆue
);

276 
	`af_powîDescPowîModeUpd©e
(
powî_mode_t
 
mode
);

285 
	`af_nodeDes¸ùt‹Së
(
node_des¸ùt‹_t
 *
vÆue
);

294 
	`af_nodeDescM™uCodeUpd©e
(
u16
 
m™uCode
);

303 
	`af_nodeDescRxOnWhíIdÀUpd©e
(
boﬁ
 
íabÀ
);

312 
	`af_nodeDescSèckRevisi⁄Së
(
u8
 
ªvisi⁄
);

321 
u8
 
	`af_nodeDescSèckRevisi⁄Gë
();

330 
u8
 
	`af_nodeMacC≠abûôyGë
();

339 
devi˚_ty≥_t
 
	`af_nodeDevTy≥Gë
();

350 
u8
 
	`af_sim∂eDes¸ùt‹C›y
(u8 *
d°
, 
af_sim∂e_des¸ùt‹_t
 *
sd
);

359 
	`af_nodeDes¸ùt‹C›y
(
node_des¸ùt‹_t
 *
d°
);

368 
	`af_powîDes¸ùt‹C›y
(
powî_des¸ùt‹_t
 *
d°
);

377 
u8
 
	`af_avaûabÀEpNumGë
();

386 
af_ídpoöt_des¸ùt‹_t
 *
	`af_ïDes¸ùt‹Gë
();

395 
af_ídpoöt_des¸ùt‹_t
 *
	`af_zdoSim∂eDes¸ùt‹Gë
();

404 
af_sim∂e_des¸ùt‹_t
 *
	`af_sim∂eDescGë
(
u8
 
ï
);

415 
boﬁ
 
	`af_¥ofûeM©chedLoˇl
(
u16
 
¥ofûeID
, 
u8
 
ï
);

426 
boﬁ
 
	`af_˛u°îM©chedLoˇl
(
u16
 
˛u°îID
, 
u8
 
ï
);

437 
boﬁ
 
	`af_˛suãrIdM©ched
(
u16
 
˛u°îID
, 
af_sim∂e_des¸ùt‹_t
 *
pSim∂eDesc
);

448 
boﬁ
 
	`af_¥ofûeIdM©ched
(
u16
 
¥ofûeID
, 
af_sim∂e_des¸ùt‹_t
 *
pSim∂eDesc
);

462 
boﬁ
 
	`af_ídpoötRegi°î
(
u8
 
ï
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂e_desc
, 
af_ídpoöt_cb_t
 
rx_cb
, 
af_d©aCnf_cb_t
 
˙fCb
);

471 
boﬁ
 
	`af_ídpoötUƒegi°î
(
u8
 
ï
);

485 
u8
 
	`af_d©aSíd
(u8 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
cmdPldLí
, u8 *
cmdPld
, u8 *
≠sC¡
);

494 
	`af_d©aCnfH™dÀr
(*
¨g
);

503 
	`af_≠s_d©a_íåy
(*
¨g
);

512 
	`af_≠s_d©a_‰agmít_íåy
(*
¨g
);

	@zigbee/aps/aps_api.h

24 #i‚de‡
APS_API_H


25 
	#APS_API_H


	)

28 
	#APS_EP_NUM_IN_GROUP_TBL
 8

	)

29 
	#APS_GROUP_NAME_LEN
 16

	)

31 #i‚de‡
APS_BINDING_TABLE_NUM


32 
	#APS_BINDING_TABLE_NUM
 8

34 

	)

35 #i‚de‡
APS_GROUP_TABLE_NUM


36 
	#APS_GROUP_TABLE_NUM
 4

38 

	)

39 
	#APS_PARENT_ANNOUNCE_BASE_TIMER
 10

40 
	#APS_PARENT_ANNOUNCE_JITTER_MAX
 10

41 

	)

43 
	mAPS_STATUS_SUCCESS
 = 0x00,

45 
	mAPS_STATUS_ASDU_TOO_LONG
 = 0xa0,

46 
	mAPS_STATUS_DEFRAG_DEFERRED
 = 0xa1,

47 
	mAPS_STATUS_DEFRAG_UNSUPPORTED
 = 0xa2,

48 
	mAPS_STATUS_ILLEGAL_REQUEST
 = 0xa3,

49 
	mAPS_STATUS_INVALID_BINDING
 = 0xa4,

50 
	mAPS_STATUS_INVALID_GROUP
 = 0xa5,

51 
	mAPS_STATUS_INVALID_PARAMETER
 = 0xa6,

52 
	mAPS_STATUS_NO_ACK
 = 0xa7,

53 
	mAPS_STATUS_NO_BOUND_DEVICE
 = 0xa8,

54 
	mAPS_STATUS_NO_SHORT_ADDRESS
 = 0xa9,

55 
	mAPS_STATUS_NOT_SUPPORTED
 = 0xaa,

56 
	mAPS_STATUS_SECURED_LINK_KEY
 = 0xab,

57 
	mAPS_STATUS_SECURED_NWK_KEY
 = 0xac,

58 
	mAPS_STATUS_SECURITY_FAIL
 = 0xad,

59 
	mAPS_STATUS_TABLE_FULL
 = 0xae,

60 
	mAPS_STATUS_UNSECURED
 = 0xaf,

61 
	mAPS_STATUS_UNSUPPORTED_ATTRIBUTE
 = 0xb0,

62 
	mAPS_STATUS_HANDLE_BACKING
 = 0xb1,

63 
	mAPS_STATUS_SHORT_ADDR_REQUESTING
 = 0xb2,

65 
	mAPS_STATUS_DUPLICATE_ENTRY
 = 0xb8,

67 
	mAPS_STATUS_INTERNAL_BUF_FULL
 = 0xb9

68 }
	t≠s_°©us_t
;

73 
u16
 
	md°_group_addr
;

76 
addrExt_t
 
	md°_ext_addr
;

77 
u16
 
	md°_sh‹t_addr
;

81 
u8
 
	md°_ídpoöt
;

83 }
	t≠s_addªss_t
;

91 
	mAPS_TX_OPT_SECURITY_ENABLED
 = 
BIT
(0),

92 
	mAPS_TX_OPT_DISABLE_NWK_KEY
 = 
BIT
(1),

93 
	mAPS_TX_OPT_ACK_TX
 = 
BIT
(2),

94 
	mAPS_TX_OPT_FRAG_PERMITTED
 = 
BIT
(3),

95 
	mAPS_TX_OPT_INCLUDE_NONCE
 = 
BIT
(4),

96 
	mAPS_TX_OPT_UNICAST_SKIP_ROUTING
 = 
BIT
(5),

97 
	mAPS_TX_OPT_INTRA_PAN
 = 
BIT
(7)

98 }
	t≠s_tx_›ti⁄s
;

101 
	mAPS_DSTADDR_EP_NOTPRESETNT
 = 0x00,

102 
	mAPS_SHORT_GROUPADDR_NOEP
,

103 
	mAPS_SHORT_DSTADDR_WITHEP
,

104 
	mAPS_LONG_DSTADDR_WITHEP
,

105 }
	t≠s_d°_addr_mode
;

108 
	mAPS_SHORT_SRCADDR_WITHEP
 = 0x02,

109 
	mAPS_LONG_SRCADDR_WITHEP
,

110 
	mAPS_LONG_SRCADDR_NOEP


111 }
	t≠s_§c_addr_mode
;

114 
	mAPS_CMD_HANDLE_TRANSPORT_KEY
 = 0x40,

115 
	mAPS_CMD_HANDLE_TXKEYCMD_RELAY
,

116 
	mAPS_CMD_HANDLE_UPDATE_DEVICE
,

117 
	mAPS_CMD_HANDLE_REMOVE_DEVICE
,

118 
	mAPS_CMD_HANDLE_REQUEST_KEY
,

119 
	mAPS_CMD_HANDLE_SWITCH_KEY
,

120 
	mAPS_CMD_HANDLE_VERIFY_KEY
,

121 
	mAPS_CMD_HANDLE_CONFIRM_KEY
,

122 
	mAPS_CMD_HANDLE_CMD_TUNNEL
,

123 
	mAPS_CMD_HANDLE_DEVICE_ANNOUNCE
,

124 
	mAPS_CMD_HANDLE_NWK_KEY
,

125 
	mAPS_CMD_HANDLE_ACK


126 }
	t≠s_h™dÀ_e
;

140 
u8
 *
	masdu
;

144 
u16
 
	m¥ofûe_id
;

147 
u16
 
	m˛u°î_id
;

151 
u8
 
	m§c_ídpoöt
;

157 
u8
 
	masdu_Àngth
;

161 
≠s_tx_›ti⁄s
 
	mtx_›ti⁄s
;

164 
u8
 
	mødius
;

174 
≠s_d°_addr_mode
 
	md°_addr_mode
;

175 
boﬁ
 
	míabÀNWK£curôy
;

176 
u8
 
	mh™dÀ
;

177 
u8
 
	m≠sC¡
;

179 
≠s_addªss_t
 
	m≠s_addr
;

181 
boﬁ
 
	mu£Alüs
;

182 
u16
 
	mÆüsSrcAddr
;

183 
u8
 
	mÆüsSeqNum
;

185 
u8
 
	mextFømeCål
;

186 
u8
 
	mblockNum
;

187 }
	t≠s_d©a_ªq_t
;

190 
	mSECURITY_IN_APSLAYER
 = 
BIT
(0),

191 
	mSECURITY_IN_NWKLAYER
 = 
BIT
(1)

192 }
	t£curôy_wôh_e
;

205 
u8
 
	md°_addr_mode
;

207 
u8
 
	md°_ï
;

211 
u16
 
	md°_addr
;

218 
u8
 
	m§c_addr_mode
;

219 
u8
 
	m§c_ï
;

221 
u16
 
	m¥ofûe_id
;

223 
u16
 
	m˛u°î_id
;

225 
u16
 
	masduLígth
;

226 
u8
 *
	masdu
;

228 
u32
 
	mrx_tick
;

234 
u16
 
	m§c_sh‹t_addr
;

235 
u8
 
	m§c_ext_addr
[8];

238 
u16
 
	m§cMacAddr
;

241 
u8
 
	m°©us
;

252 
£curôy_wôh_e
 
	m£curôy_°©us
;

254 
u8
 
	mlqi
;

255 
s8
 
	mrssi
;

256 
u8
 
	m≠s_cou¡î
;

257 } 
	t≠s_d©a_öd_t
;

262 
u16
 
	maddr_sh‹t
;

263 
addrExt_t
 
	maddr_l⁄g
;

264 }
	md°Addr
;

266 
u8
 
	md°AddrMode
;

267 
u8
 
	md°Endpoöt
;

268 
u8
 
	m§cEndpoöt
;

269 
u8
 
	m°©us
;

271 
u32
 
	mtx_time
;

273 
u8
 
	mh™dÀ
;

274 
u8
 
	m≠sC¡
;

275 
u16
 
	m˛u°îId
;

276 }
	t≠sdeD©aC⁄f_t
;

280 
addrExt_t
 
	mext_§c_addr
;

282 
u8
 
	m§c_ï
;

283 
u8
 
	mcid16_l
;

284 
u8
 
	mcid16_h
;

285 
u8
 
	md°_addr_mode
;

289 
addrExt_t
 
	md°_ext_addr
;

292 
u8
 
	md°_ï
;

294 
u16
 
	md°_group_addr
;

296 }
	t≠s_me_böd_ªq_t
;

298 
≠s_me_böd_ªq_t
 
	t≠s_me_unböd_ªq_t
;

303 
u16
 
	mgroup_addr
;

304 
u8
 
	mï
;

305 }
	t≠s_add_group_ªq_t
;

307 
≠s_add_group_ªq_t
 
	t≠s_dñëe_group_ªq_t
;

313 
u16
 
	mgroup_addr
;

314 
u8
 
	mídpoöts
[
APS_EP_NUM_IN_GROUP_TBL
];

315 
u8
 
	mn_ídpoöts
;

316 
u8
 
	mgroup_«me
[
APS_GROUP_NAME_LEN
];

317 
u8
 
	mrsv
;

318 }
	t≠s_group_tbl_ít_t
;

320 
	#APS_BIND_DST_ADDR_GROUP
 0

	)

321 
	#APS_BIND_DST_ADDR_LONG
 1

	)

324 
≠s_addªss_t
 
	m≠s_addr
;

325 
≠s_d°_addr_mode
 
	md°_addr_mode
;

326 }
	tböd_d°_li°
;

329 
u8
 *
	mtxD©a
;

330 
u8
 
	mtxC¡
;

331 
u8
 
	mtŸÆC¡
;

332 
u8
 
	mªsv
[2];

333 
böd_d°_li°
 
	mli°
[
APS_BINDING_TABLE_NUM
];

334 }
	tböd_d°_li°_tbl
;

338 
u16
 
	m¥ofûe_id
;

339 
u16
 
	mdevi˚_id
;

341 
u16
 
	m˛u°î_id
;

342 
u16
 
	m§c_addr_ªf
;

344 
u8
 
	m§c_ï
;

345 
u8
 
	mu£d
;

346 
u16
 
	md°_tbl_idx
;

347 }
	t≠s_böd_§c_tbl_t
;

350 
u16
 
	md°_addr
;

351 
u8
 
	md°_íd
;

352 
u8
 
	mª£rved
;

353 }
	t≠s_böd_l⁄g_d°_addr_t
;

356 
u8
 
	md°_addr_mode
;

358 
u8
 
	mu£d
;

359 
u16
 
	m§c_èbÀ_ödex
;

362 
u16
 
	mgroup_addr
;

363 
≠s_böd_l⁄g_d°_addr_t
 
	ml⁄g_addr
;

365 }
	t≠s_böd_d°_èbÀ_t
;

368 
u8
 
	m§cTblIdx
;

369 
u8
 
	md°TblIdx
;

370 }
	tboundTblM≠Li°_t
;

373 
≠s_böd_§c_tbl_t
 
	m§c_èbÀ
;

374 
≠s_böd_d°_èbÀ_t
 
	md°_èbÀ
;

375 }
	t≠s_böd_tbl_t
 ;

378 
u8
 
	m§c_n_ñemíts
;

379 
u8
 
	md°_n_ñemíts
;

380 
u8
 
	mbound_˙t
;

381 
u8
 
	mªsv
;

382 
≠s_böd_tbl_t
 
	mèbÀ
[
APS_BINDING_TABLE_NUM
];

383 
boundTblM≠Li°_t
 
	mBoudLi°
[
APS_BINDING_TABLE_NUM
 * APS_BINDING_TABLE_NUM];

384 }
	t≠s_bödög_èbÀ_t
 
	t_©åibuã_Æig√d_
(4);

387 
u32
 
	m≠s_ch™√l_mask
;

388 
addrExt_t
 
	m≠s_u£_ext_∑nid
;

390 
boﬁ
 
	m≠s_desig«ãd_co‹dö©‹
;

391 
u8
 
	m≠s_∑ª¡_™noun˚_timî
;

392 
u8
 
	m≠s_n⁄membî_ødius
;

393 
u8
 
	m≠s_öãr‰ame_dñay
;

394 
u8
 
	m≠s_max_wödow_size
;

395 
u8
 
	m≠s_‰agmít_∑ylﬂd_size
;

397 
u8
 
	m≠s_u£_ö£cuª_joö
:1;

398 
u8
 
	m≠s_authítiˇãd
:1;

399 
u8
 
	m≠s_upd©eDevi˚_hﬁdApsSecurôy
:1;

400 
u8
 
	m≠s_zdo_ª°ri˘ed_mode
:1;

401 
u8
 
	m≠s_ª£rved
:4;

402 }
	t≠s_pib_©åibuãs_t
;

404 (*
	t≠sD©aIndCb_t
)(*
	tp
);

406 
u16
 
GROUP_MESSAGE_SEND_ADDRESS
;

407 
u8
 
APS_INTERFRAME_DELAY
;

408 
u8
 
APS_MAX_WINDOW_SIZE
;

409 
u8
 
APS_FRAGMEMT_PAYLOAD_SIZE
;

410 
u8
 
APS_BINDING_TABLE_SIZE
;

411 
u8
 
APS_GROUP_TABLE_SIZE
;

412 
u8
 
APS_MAX_FRAME_RETRIES
;

413 
u8
 
APS_ACK_EXPIRY
;

414 
≠s_bödög_èbÀ_t
 
≠s_bödög_tbl
;

415 
≠s_group_tbl_ít_t
 
≠s_group_tbl
[];

416 
≠s_pib_©åibuãs_t
 
≠s_ib
;

418 
	#APS_IB
(Ë
≠s_ib


	)

420 
	#ZB_SET_UPDATE_DEVICE_APS_SEC_HOLD
(
v
Ë(
≠s_ib
.
≠s_upd©eDevi˚_hﬁdApsSecurôy
 = v)

	)

431 
≠s_°©us_t
 
	`≠sSëChnMsk
(
u32
 
chnMask
);

440 
	`≠s_öô
();

450 
u8
 
	`≠s_gë_cuºít_cou¡î_vÆue
();

460 
u8
 
	`≠s_gë_cou¡î_vÆue
();

463 
≠s_°©us_t
 
	`≠s_me_böd_ªq
(
≠s_me_böd_ªq_t
 *
amr
);

465 
≠s_°©us_t
 
	`≠s_me_unböd_ªq
(
≠s_me_unböd_ªq_t
 *
amr
);

467 
≠s_°©us_t
 
	`≠s_£¨ch_d°_‰om_böd_tbl
(
≠s_d©a_ªq_t
 *
≠§eq
, 
böd_d°_li°_tbl
 *
bödLi°
);

477 
≠s_bödög_èbÀ_t
 *
	`≠s_bödögTblGë
();

487 
u8
 
	`≠s_bödögTblNum
();

497 
	`≠s_dñëe_böd_by_d°
(
u16
 
d°_addr_ªf
);

507 
	`≠s_bödögTab_˛ór
();

518 
u8
 
	`≠s_groupTblNvInô
();

528 
	`≠s_groupTblRe£t
();

538 
≠s_°©us_t
 
	`≠s_me_group_add_ªq
(
≠s_add_group_ªq_t
 *
ªq
);

550 
≠s_group_tbl_ít_t
 *
	`≠s_group_£¨ch
(
u16
 
groupAddr
, 
u8
 
ídpoöt
);

562 
	`≠s_group_li°_gë
(
u8
 *
cou¡î
, 
u16
 *
group_li°
);

572 
≠s_°©us_t
 
	`≠s_me_group_dñëe_ªq
(
≠s_dñëe_group_ªq_t
 *
ªq
);

582 
≠s_°©us_t
 
	`≠s_me_group_dñëe_Æl_ªq
(
u8
 
ï
);

592 
u8
 
	`≠s_group_íåy_num_gë
();

602 
	`≠s_öô_group_num_£t
();

612 
≠s_group_tbl_ít_t
 *
	`≠s_group_£¨ch_by_addr
(
u16
 
group_addr
);

624 
u8
 *
	`≠s_group_ï_öfo_gë
(
u16
 
group_addr
, u8 *
ïNum
);

627 
	`é_≠sD©aIndRegi°î
(
≠sD©aIndCb_t
 
cb
);

641 
u8
 
	`≠sD©aReque°
(
≠s_d©a_ªq_t
 *
d©aReq
, u8 *
asdu
, u8 
Àngth
);

642 
u8
 
	`≠sD©aFøgmítReque°
(
≠s_d©a_ªq_t
 *
d©aReq
, u8 *
asdu
, 
u16
 
Àngth
);

	@zigbee/aps/aps_group.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

26 
	#APS_GROUP_EP_INVALID
 0xff

	)

27 
	#APS_INVALID_GRP_ADDR
 0xffff

	)

29 
u8
 
	g≠s_group_íåy_num
 = 0;

31 
_CODE_APS_
 
	$≠s_groupTblSave2Fœsh
(*
¨g
)

33 #i‡
NV_ENABLE


34 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_APS
, 
NV_ITEM_APS_GROUP_TABLE
, 
APS_GROUP_TABLE_SIZE
 * (
≠s_group_tbl_ít_t
), (
u8
 *)
≠s_group_tbl
);

36 
	}
}

38 
_CODE_APS_
 
u8
 
	$≠s_groupTblNvInô
()

40 
u8
 
ªt
 = 
NV_ITEM_NOT_FOUND
;

41 #i‡
NV_ENABLE


42 
ªt
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_APS
, 
NV_ITEM_APS_GROUP_TABLE
, 
APS_GROUP_TABLE_SIZE
 * (
≠s_group_tbl_ít_t
), (
u8
 *)
≠s_group_tbl
);

44  
ªt
;

45 
	}
}

47 
_CODE_APS_
 
≠s_group_tbl_ít_t
 *
	$≠s_group_£¨ch_by_addr
(
u16
 
group_addr
)

49 
u8
 
i
 = 0;

50 
u8
 
ödex
 = 0;

51 
u8
 
födEm±y
 = 
FALSE
;

53 i‡(
group_addr
 =
APS_INVALID_GRP_ADDR
)

55 
födEm±y
 = 
TRUE
;

57 
i
 < 
≠s_group_íåy_num
)

59 i‡(
≠s_group_tbl
[
ödex
].
group_addr
 =
APS_INVALID_GRP_ADDR
)

61 i‡(
födEm±y
)

63  &
≠s_group_tbl
[
ödex
];

67 
ödex
++;

71 i‡(
≠s_group_tbl
[
ödex
].
group_addr
 == group_addr)

73  &
≠s_group_tbl
[
ödex
];

75 
i
++;

76 
ödex
++;

79 i‡(
födEm±y
)

81 
ödex
 < 
APS_GROUP_TABLE_SIZE
)

83 i‡(
≠s_group_tbl
[
ödex
].
group_addr
 =
APS_INVALID_GRP_ADDR
)

85  &
≠s_group_tbl
[
ödex
];

87 
ödex
++;

90  
NULL
;

91 
	}
}

93 
_CODE_APS_
 
u8
 *
	$≠s_group_ï_öfo_gë
(
u16
 
group_addr
, 
u8
 *
ïNum
)

95 
≠s_group_tbl_ít_t
 *
ít
 = 
	`≠s_group_£¨ch_by_addr
(
group_addr
);

96 i‡(
ít
)

98 *
ïNum
 = 
ít
->
n_ídpoöts
;

99  (&
ít
->
ídpoöts
[0]);

102  
NULL
;

103 
	}
}

105 
_CODE_APS_
 
u8
 *
	$≠s_group_ï_föd
(
≠s_group_tbl_ít_t
 *
íåy
, 
u8
 
ídpoöt
)

107 
u8
 
i
 = 0;

108 
u8
 
ödex
 = 0;

109 
u8
 
födEm±y
 = 
FALSE
;

111 i‡(
ídpoöt
 =
APS_GROUP_EP_INVALID
)

113 
födEm±y
 = 
TRUE
;

116 
i
 < 
íåy
->
n_ídpoöts
)

118 i‡(
íåy
->
ídpoöts
[
ödex
] =
APS_GROUP_EP_INVALID
)

120 i‡(
födEm±y
)

122  &
íåy
->
ídpoöts
[
ödex
];

126 
ödex
++;

130 i‡(
íåy
->
ídpoöts
[
ödex
] =
ídpoöt
)

132  &
íåy
->
ídpoöts
[
ödex
];

134 
i
++;

135 
ödex
++;

138 i‡(
födEm±y
)

140 
ödex
 < 
APS_EP_NUM_IN_GROUP_TBL
)

142 i‡(
íåy
->
ídpoöts
[
ödex
] =
APS_GROUP_EP_INVALID
)

144  &
íåy
->
ídpoöts
[
ödex
];

146 
ödex
++;

150  
NULL
;

151 
	}
}

153 
_CODE_APS_
 
≠s_group_tbl_ít_t
 *
	$≠s_group_£¨ch
(
u16
 
groupAddr
, 
u8
 
ídpoöt
)

155 
≠s_group_tbl_ít_t
 *
pE¡ry
;

156 
u8
 *
pEndpoöt
;

158 
pE¡ry
 = 
	`≠s_group_£¨ch_by_addr
(
groupAddr
);

159 i‡(
pE¡ry
 =
NULL
)

161  
NULL
;

164 
pEndpoöt
 = 
	`≠s_group_ï_föd
(
pE¡ry
, 
ídpoöt
);

165 i‡(
pEndpoöt
 =
NULL
)

167  
NULL
;

170  
pE¡ry
;

171 
	}
}

180 
_CODE_APS_
 
≠s_°©us_t
 
	$≠s_me_group_add_ªq
(
≠s_add_group_ªq_t
 *
ªq
)

182 
≠s_°©us_t
 
°©us
 = 
APS_STATUS_SUCCESS
;

183 
≠s_group_tbl_ít_t
 *
pE¡ry
;

184 
u8
 *
pEndpoöt
;

185 i‡((
ªq
->
ï
 < 0x01) || (req->ep > 0xfe))

187 
°©us
 = 
APS_STATUS_INVALID_PARAMETER
;

188  
°©us
;

190 
pE¡ry
 = 
	`≠s_group_£¨ch_by_addr
(
ªq
->
group_addr
);

191 i‡(
pE¡ry
)

194 
pEndpoöt
 = 
	`≠s_group_ï_föd
(
pE¡ry
, 
ªq
->
ï
);

195 i‡(
pEndpoöt
 =
NULL
)

197 
pEndpoöt
 = 
	`≠s_group_ï_föd
(
pE¡ry
, 
APS_GROUP_EP_INVALID
);

198 i‡(
pEndpoöt
 =
NULL
)

200  
APS_STATUS_TABLE_FULL
;

204 *
pEndpoöt
 = 
ªq
->
ï
;

205 
pE¡ry
->
n_ídpoöts
++;

210  
APS_STATUS_DUPLICATE_ENTRY
;

215 
pE¡ry
 = 
	`≠s_group_£¨ch_by_addr
(
APS_INVALID_GRP_ADDR
);

216 i‡(
pE¡ry
 =
NULL
)

218  
APS_STATUS_TABLE_FULL
;

220 
pE¡ry
->
group_addr
 = 
ªq
->group_addr;

221 
pE¡ry
->
ídpoöts
[0] = 
ªq
->
ï
;

222 
pE¡ry
->
n_ídpoöts
++;

223 
≠s_group_íåy_num
++;

226 i‡(
APS_STATUS_SUCCESS
 =
°©us
)

228 
	`TL_SCHEDULE_TASK
(
≠s_groupTblSave2Fœsh
, 
NULL
);

231  
°©us
;

232 
	}
}

234 
_CODE_APS_
 
≠s_°©us_t
 
	$≠s_me_group_dñëe_ªq
(
≠s_dñëe_group_ªq_t
 *
ªq
)

236 
≠s_°©us_t
 
°©us
 = 
APS_STATUS_SUCCESS
;

237 
≠s_group_tbl_ít_t
 *
pE¡ry
;

238 
u8
 *
pEndpoöt
;

239 i‡((
ªq
->
ï
 < 0x01) || (req->ep > 0xfe))

241 
°©us
 = 
APS_STATUS_INVALID_PARAMETER
;

242  
°©us
;

244 
pE¡ry
 = 
	`≠s_group_£¨ch_by_addr
(
ªq
->
group_addr
);

246 i‡(
pE¡ry
 =
NULL
)

248  
APS_STATUS_INVALID_GROUP
;

250 
pEndpoöt
 = 
	`≠s_group_ï_föd
(
pE¡ry
, 
ªq
->
ï
);

251 i‡(
pEndpoöt
 =
NULL
)

253  
APS_STATUS_INVALID_GROUP
;

255 *
pEndpoöt
 = 
APS_GROUP_EP_INVALID
;

256 
pE¡ry
->
n_ídpoöts
--;

257 i‡(
pE¡ry
->
n_ídpoöts
 == 0)

260 
pE¡ry
->
group_addr
 = 
APS_INVALID_GRP_ADDR
;

261 
≠s_group_íåy_num
--;

264 i‡(
APS_STATUS_SUCCESS
 =
°©us
)

266 
	`TL_SCHEDULE_TASK
(
≠s_groupTblSave2Fœsh
, 
NULL
);

268  
°©us
;

269 
	}
}

271 
_CODE_APS_
 
	$≠s_groupTblRe£t
()

273 
≠s_group_íåy_num
 = 0;

274 
u8
 
i
 = 0; i < 
APS_GROUP_TABLE_SIZE
; i++)

276 
≠s_group_tbl
[
i
].
group_addr
 = 
APS_INVALID_GRP_ADDR
;

277 
≠s_group_tbl
[
i
].
n_ídpoöts
 = 0;

278 
u8
 
j
 = 0; j < 
APS_EP_NUM_IN_GROUP_TBL
; j++)

280 
≠s_group_tbl
[
i
].
ídpoöts
[
j
] = 
APS_GROUP_EP_INVALID
;

283 
	}
}

285 
_CODE_APS_
 
≠s_°©us_t
 
	$≠s_me_group_dñëe_Æl_ªq
(
u8
 
ï
)

287 
≠s_°©us_t
 
°©us
 = 
APS_STATUS_SUCCESS
;

288 
≠s_group_tbl_ít_t
 *
pE¡ry
;

289 
u8
 *
pEndpoöt
;

290 
u8
 
i
 = 0;

291 
u8
 
ödex
 = 0;

292 i‡((
ï
 < 0x01) || (ep > 0xfe))

294 
°©us
 = 
APS_STATUS_INVALID_PARAMETER
;

295  
°©us
;

298 
i
 <
≠s_group_íåy_num
)

301 i‡(
≠s_group_tbl
[
ödex
].
group_addr
 =
APS_INVALID_GRP_ADDR
)

303 
ödex
++;

304 i‡(
ödex
 >
APS_GROUP_TABLE_SIZE
)

306 
i
++;

307 
ödex
 = 0;

311 
pE¡ry
 = &
≠s_group_tbl
[
ödex
];

312 
pEndpoöt
 = 
	`≠s_group_ï_föd
(
pE¡ry
, 
ï
);

314 i‡(
pEndpoöt
)

316 *
pEndpoöt
 = 
APS_GROUP_EP_INVALID
;

317 
pE¡ry
->
n_ídpoöts
--;

321 i‡(
pE¡ry
->
n_ídpoöts
 == 0)

325 
pE¡ry
->
group_addr
 = 
APS_INVALID_GRP_ADDR
;

326 
≠s_group_íåy_num
--;

330 
ödex
++;

331 
i
++;

334 
	`≠s_groupTblRe£t
();

335 
	`TL_SCHEDULE_TASK
(
≠s_groupTblSave2Fœsh
, 
NULL
);

336  
°©us
;

337 
	}
}

339 
_CODE_APS_
 
u8
 
	$≠s_group_íåy_num_gë
()

341  
≠s_group_íåy_num
;

342 
	}
}

344 
_CODE_APS_
 
	$≠s_group_li°_gë
(
u8
 *
cou¡î
, 
u16
 *
group_li°
)

346 
u8
 
i
 = 0;

348 i‡(!
cou¡î
 || !
group_li°
)

352 *
cou¡î
 = 0;

353 
i
 < 
APS_GROUP_TABLE_SIZE
)

355 i‡(
≠s_group_tbl
[
i
].
group_addr
 !
APS_INVALID_GRP_ADDR
)

357 
group_li°
[(*
cou¡î
)++] = 
≠s_group_tbl
[
i
].
group_addr
;

359 
i
++;

361 
	}
}

363 
_CODE_APS_
 
	$≠s_öô_group_num_£t
()

365 
u8
 
i
 = 0; i < 
APS_GROUP_TABLE_SIZE
; i++)

367 i‡(
≠s_group_tbl
[
i
].
group_addr
 !
APS_INVALID_GRP_ADDR
)

369 
≠s_group_íåy_num
++;

372 
	}
}

	@zigbee/bdb/bdb.c

27 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

28 
	~"../z˛/z˛_ö˛ude.h
"

29 
	~"../z˛/zŒ_commissi⁄ög/z˛_zŒ_commissi⁄ög_öã∫Æ.h
"

30 
	~"ö˛udes/bdb.h
"

37 
u8
 
	md°AddrMode
;

42 
addrExt_t
 
	md°ExtAddr
;

43 
u8
 
	md°Ep
;

45 
u16
 
	md°GroupId
;

46 } 
	md°Addr
;

47 } 
	tzdo_böd_d°Addr_t
;

52 
bdb_˘x_t
 
	gg_bdbCtx
 = {0};

57 
	#BDB_COMMISSION_TIME_INTV
 5

58 

	)

59 
	#BDB_TOUCHLINK_CAP_EN
(Ë(
g_bdbAârs
.
nodeCommissi⁄ögC≠abûôy
 & 
BDB_NODE_COMMISSION_CAP_TOUCHLINK
)

	)

61 
	#POLY
 0x8408

	)

66 
bdb_èsk
(*
¨g
);

67 
bdb_commissi⁄ögInfoSave
(*
¨g
);

68 
bdb_bödög
(
zdo_böd_d°Addr_t
 *
pD°Addr
, 
u8
 
˛u°îNum
, 
u16
 *
˛u°îLi°
);

69 
bdb_födögAndBödög
(
födBödD°_t
 *
pD°Info
);

70 
bdb_sim∂eDescReqSíd
(*
¨g
);

71 
u8
 
bdb_commissi⁄ögFödBöd
();

72 
u8
 
bdb_commissi⁄ögNëw‹kF‹m©i⁄
();

73 
u8
 
bdb_commissi⁄ögNëw‹kSãî
();

74 
u8
 
bdb_t›LevñCommissi⁄ög
(u8 
rﬁe
);

75 
u8
 
bdb_t›LevñCommissi⁄gC⁄fúm
();

76 
bdb_ªåõveTcLökKeyTimîSt›
();

77 
bdb_touchLökCÆlback
(
u8
 
°©us
, *
¨g
);

78 
bdb_commssi⁄UtûôyCÆlback
(
u8
 
cmd
, *
¨g
);

80 
bdb_touchLökPªCfg
(
u8
 
ídpoöt
, 
bdb_commissi⁄Sëtög_t
 *
£âög
, c⁄° 
z˛_touchlökAµCÆlbacks_t
 *
éCb
);

81 
bdb_co‹dö©‹Sèπ
();

82 
bdb_rouãrSèπ
();

83 
bdb_ídDevi˚Sèπ
(
u8
 
ªpowî
);

84 
bdb_outgoögFømeCou¡Upd©e
(
u8
 
ªpowî
);

85 
bdb_sˇnCfg
(
u32
 
ch™Mask
, 
u8
 
duøti⁄
);

86 
bdb_Á˘‹yNewDevCfg
(
u8
 
touchLökEn
, u8 
ch™
);

91 c⁄° 
bdb_©åTbl_t
 
	gg_bdbAârTbl
[] = {

92 {
OFFSETOF
(
bdb_©å_t
, 
¥im¨yCh™√lSë
), 4},

93 {
OFFSETOF
(
bdb_©å_t
, 
£c⁄d¨yCh™√lSë
), 4},

94 {
OFFSETOF
(
bdb_©å_t
, 
commissi⁄ögGroupId
), 2},

95 {
OFFSETOF
(
bdb_©å_t
, 
commissi⁄ögMode
), 1},

96 {
OFFSETOF
(
bdb_©å_t
, 
commissi⁄ögSètus
), 1},

97 {
OFFSETOF
(
bdb_©å_t
, 
joöögNodeEui64
), 8},

98 {
OFFSETOF
(
bdb_©å_t
, 
joöögNodeNewTCLökKey
), 16},

99 {
OFFSETOF
(
bdb_©å_t
, 
nodeCommissi⁄ögC≠abûôy
), 1},

100 {
OFFSETOF
(
bdb_©å_t
, 
joöU£sIn°ÆlCodeKey
), 1},

101 {
OFFSETOF
(
bdb_©å_t
, 
nodeIsOnANëw‹k
), 1},

102 {
OFFSETOF
(
bdb_©å_t
, 
nodeJoöLökKeyTy≥
), 1},

103 {
OFFSETOF
(
bdb_©å_t
, 
tcRequúeKeyExch™ge
), 1},

104 {
OFFSETOF
(
bdb_©å_t
, 
sˇnDuøti⁄
), 1},

105 {
OFFSETOF
(
bdb_©å_t
, 
tcLökKeyExch™geAâem±s
), 1},

106 {
OFFSETOF
(
bdb_©å_t
, 
tcLökKeyExch™geAâem±sMax
), 1},

107 {
OFFSETOF
(
bdb_©å_t
, 
tcLökKeyExch™geMëhod
), 1},

108 {
OFFSETOF
(
bdb_©å_t
, 
tcNodeJoöTimeout
), 1},

111 c⁄° 
bdb_©å_t
 
	gg_bdbAârsD·
 = {

112 .
¥im¨yCh™√lSë
 = 
BDBC_TL_PRIMARY_CHANNEL_SET
,

113 .
	g£c⁄d¨yCh™√lSë
 = 
BDBC_TL_SECONDARY_CHANNEL_SET
,

114 .
	gcommissi⁄ögGroupId
 = 0xffff,

115 .
	gcommissi⁄ögSètus
 = 
BDB_COMMISSION_STA_SUCCESS
,

116 .
	gcommissi⁄ögMode
.
	g√tw‹kSãî
 = 1,

117 .
	gnodeJoöLökKeyTy≥
 = 
LINKKEY_TYPE_TC
,

118 .
	gtcRequúeKeyExch™ge
 = 1,

119 .
	gsˇnDuøti⁄
 = 3,

120 .
	gtcLökKeyExch™geAâem±sMax
 = 
BDBC_REC_SAME_NETWROK_RETRY_ATTEMPTS
,

121 .
	gtcLökKeyExch™geMëhod
 = 
TCKEY_EXCHANGE_METHOD_APSRK
,

122 .
	gtcNodeJoöTimeout
 = 0x0f,

125 c⁄° 
z˛_touchlökAµCÆlbacks_t
 
	gbdb_touchlökCb
 = {
bdb_touchLökCÆlback
, 
bdb_commssi⁄UtûôyCÆlback
};

140 
_CODE_BDB_
 
	$bdb_commissi⁄ögInfoSave
(*
¨g
)

142 #i‡
NV_ENABLE


143 
	`nv_nwkFømeCou¡SaveToFœsh
(
ss_ib
.
outgoögFømeCou¡î
);

144 
	`zdo_ssInfoSaveToFœsh
();

145 
	`zb_öfo_ßve
(
NULL
);

148 
	`nwk_∑ª¡NodeInfoSt‹e
();

150 
g_bdbCtx
.
Á˘‹yNew
 = 0;

151 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 1;

152 
	}
}

163 
_CODE_BDB_
 
födBödQ_t
 *
	$queueInô
()

165 
födBödQ_t
 *
pFödBödQ
 = (födBödQ_à*)
	`ev_buf_Æloˇã
((findBindQ_t));

167 i‡(
pFödBödQ
)

169 
pFödBödQ
->
‰⁄t
 = 0;

170 
pFödBödQ
->
ª¨
 = 0;

173  
pFödBödQ
;

174 
	}
}

176 
	$queueCÀ¨
(
födBödQ_t
 *
pFödBödQ
)

178 i‡(
pFödBödQ
)

180 
	`ev_buf_‰ì
((
u8
 *)
pFödBödQ
);

181 
g_bdbCtx
.
pFödBödQ
 = 
NULL
;

183 
	}
}

194 
_CODE_BDB_
 
boﬁ
 
	$isQueueEm±y
(
födBödQ_t
 *
pFödBödQ
)

196 i‡(!
pFödBödQ
)

198  
TRUE
;

201 i‡(
pFödBödQ
->
‰⁄t
 =pFödBödQ->
ª¨
)

203  
TRUE
;

207  
FALSE
;

209 
	}
}

220 
_CODE_BDB_
 
boﬁ
 
	$isQueueFuŒ
(
födBödQ_t
 *
pFödBödQ
)

222 i‡(((
pFödBödQ
->
ª¨
 + 1Ë% 
FIND_BIND_QUEUE_SIZE
Ë=pFödBödQ->
‰⁄t
)

224  
TRUE
;

228  
FALSE
;

230 
	}
}

242 
_CODE_BDB_
 
boﬁ
 
	$queuePush
(
födBödQ_t
 *
pFödBödQ
, 
födBödD°_t
 
d°Info
)

244 i‡(
	`isQueueFuŒ
(
pFödBödQ
))

246  
FALSE
;

249 
pFödBödQ
->
ª¨
 = (pFödBödQ->ª¨ + 1Ë% 
FIND_BIND_QUEUE_SIZE
;

250 
pFödBödQ
->
födBödD°Info
[pFödBödQ->
ª¨
].
addr
 = 
d°Info
.addr;

251 
pFödBödQ
->
födBödD°Info
[pFödBödQ->
ª¨
].
ídpoöt
 = 
d°Info
.endpoint;

253  
TRUE
;

254 
	}
}

266 
_CODE_BDB_
 
boﬁ
 
	$queueP›
(
födBödQ_t
 *
pFödBödQ
, 
födBödD°_t
 *
pD°Info
)

268 i‡(
	`isQueueEm±y
(
pFödBödQ
))

270  
FALSE
;

273 
pFödBödQ
->
‰⁄t
 = (pFödBödQ->‰⁄à+ 1Ë% 
FIND_BIND_QUEUE_SIZE
;

274 
pD°Info
->
addr
 = 
pFödBödQ
->
födBödD°Info
[pFödBödQ->
‰⁄t
].addr;

275 
pD°Info
->
ídpoöt
 = 
pFödBödQ
->
födBödD°Info
[pFödBödQ->
‰⁄t
].endpoint;

277  
TRUE
;

278 
	}
}

291 
_CODE_BDB_
 
boﬁ
 
	$queueHódGë
(
födBödQ_t
 *
pFödBödQ
, 
födBödD°_t
 *
pD°Info
)

293 if(
	`isQueueEm±y
(
pFödBödQ
)){

294  
FALSE
;

297 
pD°Info
->
addr
 = 
pFödBödQ
->
födBödD°Info
[’FödBödQ->
‰⁄t
 + 1Ë% 
FIND_BIND_QUEUE_SIZE
].addr;

298 
pD°Info
->
ídpoöt
 = 
pFödBödQ
->
födBödD°Info
[’FödBödQ->
‰⁄t
 + 1Ë% 
FIND_BIND_QUEUE_SIZE
].endpoint;

300  
TRUE
;

301 
	}
}

304 
	$bdb_födBödR°
()

306 
	`queueCÀ¨
(
g_bdbCtx
.
pFödBödQ
);

307 
	`mem£t
((
u8
 *)&
g_bdbCtx
.
födD°Info
, 0, (
födBödD°_t
));

308 
	`mem£t
((
u8
 *)&
g_bdbCtx
.
bödD°Info
, 0, (
födBödD°_t
));

309 
	}
}

322 
_CODE_BDB_
 
	$bdb_bödög
(
zdo_böd_d°Addr_t
 *
pD°Addr
, 
u8
 
˛u°îNum
, 
u16
 *
˛u°îLi°
)

324 
zdo_böd_ªq_t
 
ªq
;

325 
	`mem£t
(&
ªq
, 0, (
zdo_böd_ªq_t
));

326 
u8
 
bödSètus
 = 
ZDO_SUCCESS
;

328 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
§c_addr
, 
	`NIB_IEEE_ADDRESS
());

329 
ªq
.
§c_ídpoöt
 = 
g_bdbCtx
.
sim∂eDesc
->
ídpoöt
;

330 
ªq
.
d°_addr_mode
 = 
pD°Addr
->
d°AddrMode
;

331 i‡(
ªq
.
d°_addr_mode
 =
LONG_EXADDR_DSTENDPOINT
)

333 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
d°_ext_addr
, 
pD°Addr
->
d°Addr
.
d°ExtAddr
);

334 
ªq
.
d°_ídpoöt
 = 
pD°Addr
->
d°Addr
.
d°Ep
;

336 i‡(
ªq
.
d°_addr_mode
 =
SHORT_GROUPADDR_NODSTENDPOINT
)

338 
ªq
.
d°_group_addr
 = 
pD°Addr
->
d°Addr
.
d°GroupId
;

341 
u8
 
i
 = 0; i < 
˛u°îNum
; i++)

343 
ªq
.
cid16_l
 = 
˛u°îLi°
[
i
];

344 
ªq
.
cid16_h
 = 
˛u°îLi°
[
i
] >> 8;

346 
u8
 
¢
 = 0;

347 
bödSètus
 = 
	`zb_zdoBödUnbödReq
(
TRUE
, &
ªq
, &
¢
, 
NULL
);

348 i‡(
bödSètus
 =
ZDO_TABLE_FULL
)

350 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_BINDING_TABLE_FULL
);

351 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_FINDORBIND_FINISH
;

352 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

357 
	`ev_buf_‰ì
((
u8
 *)
g_bdbCtx
.
m©chClu°îLi°
);

358 
g_bdbCtx
.
m©chClu°îNum
 = 0;

359 
g_bdbCtx
.
m©chClu°îLi°
 = 
NULL
;

361 i‡(
bödSètus
 =
ZDO_SUCCESS
)

363 i‡(
g_bdbCtx
.
bdbAµCb
 && g_bdbCtx.bdbAµCb->
bdbFödBödSuc˚ssCb
)

365 
g_bdbCtx
.
bdbAµCb
->
	`bdbFödBödSuc˚ssCb
(&g_bdbCtx.
bödD°Info
);

369 i‡(
bödSètus
 !
ZDO_TABLE_FULL
)

371 
	`TL_SCHEDULE_TASK
(
bdb_sim∂eDescReqSíd
, 
NULL
);

373 
	}
}

384 
_CODE_BDB_
 
	$bdb_õìAddrRe•
(*
¨g
)

386 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

387 
zdo_õì_addr_ª•_t
 *
ª•
 = (zdo_õì_addr_ª•_à*)
p
->
zpdu
;

389 i‡(
ª•
->
°©us
 =
ZDO_SUCCESS
)

391 
zdo_böd_d°Addr_t
 
bödD°Addr
;

392 
	`mem£t
((
u8
 *)&
bödD°Addr
, 0, (
zdo_böd_d°Addr_t
));

394 
bödD°Addr
.
d°AddrMode
 = 
APS_LONG_DSTADDR_WITHEP
;

395 
bödD°Addr
.
d°Addr
.
d°Ep
 = 
g_bdbCtx
.
bödD°Info
.
ídpoöt
;

396 
	`ZB_IEEE_ADDR_COPY
(
bödD°Addr
.
d°Addr
.
d°ExtAddr
, 
ª•
->
õì_addr_ªmŸe
);

398 
	`bdb_bödög
(&
bödD°Addr
, 
g_bdbCtx
.
m©chClu°îNum
, g_bdbCtx.
m©chClu°îLi°
);

400 
	}
}

411 
_CODE_BDB_
 
	$bdb_födögAndBödög
(
födBödD°_t
 *
pD°Info
)

413 
zdo_böd_d°Addr_t
 
bödD°Addr
;

414 
	`mem£t
((
u8
 *)&
bödD°Addr
, 0, (
zdo_böd_d°Addr_t
));

416 #ifde‡
ZCL_GROUP


417 i‡(
g_bdbAârs
.
commissi⁄ögGroupId
 != 0xFFFF)

419 
ïInfo_t
 
d°EpInfo
;

420 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

422 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

423 
d°EpInfo
.
d°Ep
 = 
pD°Info
->
ídpoöt
;

424 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pD°Info
->
addr
;

425 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

426 
d°EpInfo
.
txO±i⁄s
 = 0;

427 
d°EpInfo
.
ødius
 = 0;

429 
u8
 
groupName
[8] = {0};

430 
	`z˛_group_addCmd
(
g_bdbCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
FALSE
, 
g_bdbAârs
.
commissi⁄ögGroupId
, 
groupName
);

432 
bödD°Addr
.
d°AddrMode
 = 
APS_SHORT_GROUPADDR_NOEP
;

433 
bödD°Addr
.
d°Addr
.
d°GroupId
 = 
g_bdbAârs
.
commissi⁄ögGroupId
;

435 
	`bdb_bödög
(&
bödD°Addr
, 
g_bdbCtx
.
m©chClu°îNum
, g_bdbCtx.
m©chClu°îLi°
);

440 
addrExt_t
 
d°ExtAddr
;

441 
	`ZB_IEEE_ADDR_ZERO
(
d°ExtAddr
);

443 
u8
 
extAddrGŸ
 = 
	`zb_addªss_õì_by_sh‹t
(
pD°Info
->
addr
, 
d°ExtAddr
);

445 i‡((
extAddrGŸ
 !
SUCCESS
Ë|| (”xtAddrGŸ =SUCCESSË&& 
	`ZB_IEEE_ADDR_IS_ZERO
(
d°ExtAddr
)))

447 
zdo_õì_addr_ªq_t
 
õìAddrReq
;

448 
u8
 
¢
 = 0;

449 
	`mem£t
(&
õìAddrReq
, 0, (
zdo_õì_addr_ªq_t
));

451 
õìAddrReq
.
nwk_addr_öãª°
 = 
pD°Info
->
addr
;

452 
õìAddrReq
.
ªq_ty≥
 = 
ZDO_ADDR_REQ_SINGLE_RESP
;

454 
	`zb_zdoIìeAddrReq
(
pD°Info
->
addr
, &
õìAddrReq
, &
¢
, 
bdb_õìAddrRe•
);

458 
bödD°Addr
.
d°AddrMode
 = 
APS_LONG_DSTADDR_WITHEP
;

459 
bödD°Addr
.
d°Addr
.
d°Ep
 = 
pD°Info
->
ídpoöt
;

460 
	`ZB_IEEE_ADDR_COPY
(
bödD°Addr
.
d°Addr
.
d°ExtAddr
, dstExtAddr);

462 
	`bdb_bödög
(&
bödD°Addr
, 
g_bdbCtx
.
m©chClu°îNum
, g_bdbCtx.
m©chClu°îLi°
);

465 
	}
}

476 
_CODE_BDB_
 
	$bdb_Sim∂eDescRe•
(*
¨g
)

478 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

479 
zdo_sim∂e_des¸ùt‹_ª•_t
 *
simpDescRe•
 = (zdo_sim∂e_des¸ùt‹_ª•_à*)
p
->
zpdu
;

481 i‡(
simpDescRe•
->
°©us
 =
SUCCESS
)

483 i‡(
g_bdbCtx
.
m©chClu°îLi°
 || g_bdbCtx.
m©chClu°îNum
)

488 i‡(
g_bdbCtx
.
idítifyTimî
)

490 
	`TL_ZB_TIMER_CANCEL
(&
g_bdbCtx
.
idítifyTimî
);

493 
u8
 *
pClu°îLi°Info
 = 
simpDescRe•
->
sim∂e_des¸ùt‹
.
li°Info
;

494 
u8
 
öClu°îNum
 = *
pClu°îLi°Info
++;

496 i‡(
öClu°îNum
)

498 
g_bdbCtx
.
m©chClu°îLi°
 = (
u16
 *)
	`ev_buf_Æloˇã
((u16Ë* 
öClu°îNum
);

499 i‡(
g_bdbCtx
.
m©chClu°îLi°
)

501 
u8
 
i
 = 0; i < 
g_bdbCtx
.
˛u°îNum
; i++)

503 
u8
 *
pClu°îLi°Info_ãmp
 = 
pClu°îLi°Info
;

504 
u8
 
j
 = 0; j < 
öClu°îNum
; j++)

506 
u16
 
˛u°îId
 = 
	`BUILD_U16
(
pClu°îLi°Info_ãmp
[0],ÖClusterListInfo_temp[1]);

507 i‡(
g_bdbCtx
.
˛u°îLi°
[
i
] =
˛u°îId
)

509 
g_bdbCtx
.
m©chClu°îLi°
[g_bdbCtx.
m©chClu°îNum
++] = 
˛u°îId
;

511 
pClu°îLi°Info_ãmp
 += 2;

515 i‡(
g_bdbCtx
.
m©chClu°îNum
)

517 
g_bdbCtx
.
bödD°Info
.
addr
 = 
simpDescRe•
->
nwk_addr_öãª°
;

518 
g_bdbCtx
.
bödD°Info
.
ídpoöt
 = 
simpDescRe•
->
sim∂e_des¸ùt‹
.endpoint;

520 
	`bdb_födögAndBödög
(&
g_bdbCtx
.
bödD°Info
);

527 
	`TL_SCHEDULE_TASK
(
bdb_sim∂eDescReqSíd
, 
NULL
);

528 
	}
}

539 
_CODE_BDB_
 
	$bdb_commissi⁄ögFödBödSim∂eDescReq
()

541 i‡(
	`BDB_STATE_GET
(Ë=
BDB_STATE_COMMISSIONING_FINDORBIND
 && 
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_INITIATOR
)

543 
zdo_sim∂e_des¸ùt‹_ªq_t
 
ªq
;

544 
u8
 
¢
 = 0;

545 
	`mem£t
(&
ªq
, 0, (
zdo_sim∂e_des¸ùt‹_ªq_t
));

547 
ªq
.
ídpoöt
 = 
g_bdbCtx
.
födD°Info
.endpoint;

548 
ªq
.
nwk_addr_öãª°
 = 
g_bdbCtx
.
födD°Info
.
addr
;

550 
	`zb_zdoSim∂eDescReq
(
g_bdbCtx
.
födD°Info
.
addr
, &
ªq
, &
¢
, 
bdb_Sim∂eDescRe•
);

552 
	}
}

563 
_CODE_BDB_
 
s32
 
	$bdb_sim∂eDescReqTimeoutCb
(*
¨g
)

565 
	`TL_SCHEDULE_TASK
(
bdb_sim∂eDescReqSíd
, 
NULL
);

567 
g_bdbCtx
.
idítifyTimî
 = 
NULL
;

570 
	}
}

581 
_CODE_BDB_
 
	$bdb_sim∂eDescReqSíd
(*
¨g
)

583 i‡(
	`queueP›
(
g_bdbCtx
.
pFödBödQ
, &g_bdbCtx.
födD°Info
))

585 i‡(
g_bdbCtx
.
idítifyTimî
)

587 
	`TL_ZB_TIMER_CANCEL
(&
g_bdbCtx
.
idítifyTimî
);

590 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_FINDORBIND_SIMPLE_DESC_REQ
;

591 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

593 
u32
 
sim∂eDescReqTimeout
 = 5000;

594 #ifde‡
ZB_ED_ROLE


595 i‡(
	`zb_gëPﬁlR©e
())

597 
sim∂eDescReqTimeout
 = 
	`zb_gëPﬁlR©e
() * 3;

601 
g_bdbCtx
.
idítifyTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_sim∂eDescReqTimeoutCb
, 
NULL
, 
sim∂eDescReqTimeout
);

606 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

607 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_FINDORBIND_FINISH
;

608 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

610 
	}
}

621 
_CODE_BDB_
 
s32
 
	$bdb_födBödIdítifyQuîyTimeout
(*
¨g
)

623 i‡(
	`isQueueEm±y
(
g_bdbCtx
.
pFödBödQ
))

627 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_NO_IDENTIFY_QUERY_RESPONSE
);

628 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_FINDORBIND_FINISH
;

629 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

633 
	`TL_SCHEDULE_TASK
(
bdb_sim∂eDescReqSíd
, 
NULL
);

636 
g_bdbCtx
.
idítifyTimî
 = 
NULL
;

639 
	}
}

650 
_CODE_BDB_
 
s32
 
	$bdb_födBödIdítifyTimeout
(*
¨g
)

652 
u32
 
timîIdítifyC¡
 = 0;

654 
u16
 
idítifyTime
 = 0;

655 
u16
 
©åLí
 = 0;

657 i‡(
	`z˛_gëAârVÆ
(
g_bdbCtx
.
sim∂eDesc
->
ídpoöt
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_ATTRID_IDENTIFY_TIME
, &
©åLí
, (
u8
 *)&
idítifyTime
Ë!
ZCL_STA_SUCCESS
)

659 
g_bdbCtx
.
idítifyTimî
 = 
NULL
;

663 i‡(
idítifyTime
 =0 || 
timîIdítifyC¡
++ >
BDBC_MIN_COMMISSIONING_TIME
 / 
BDB_COMMISSION_TIME_INTV
)

665 
timîIdítifyC¡
 = 0;

668 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

669 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_FINDORBIND_FINISH
;

670 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

672 
g_bdbCtx
.
idítifyTimî
 = 
NULL
;

676 
	}
}

687 
_CODE_BDB_
 
u8
 
	$bdb_commissi⁄ögFödBöd
()

689 i‡(
g_bdbAârs
.
commissi⁄ögMode
.
födOrBöd
)

691 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

694 i‡(
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_TARGET
)

701 i‡(!
g_bdbCtx
.
idítifyTimî
)

703 
g_bdbCtx
.
idítifyTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_födBödIdítifyTimeout
, 
NULL
, 
BDB_COMMISSION_TIME_INTV
 * 1000);

706 i‡(
g_bdbCtx
.
bdbAµCb
->
bdbIdítifyCb
)

708 
g_bdbCtx
.
bdbAµCb
->
	`bdbIdítifyCb
(g_bdbCtx.
sim∂eDesc
->
ídpoöt
, 
	`NIB_NETWORK_ADDRESS
(), 
BDBC_MIN_COMMISSIONING_TIME
);

713 
ïInfo_t
 
d°EpInfo
;

714 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

716 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

717 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 0xffff;

718 
d°EpInfo
.
d°Ep
 = 0xff;

719 
d°EpInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

721 
	`z˛_idítify_idítifyQuîyCmd
(
g_bdbCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
TRUE
);

723 
u32
 
idítifyQuîyRcvTimeout
 = 5000;

724 #ifde‡
ZB_ED_ROLE


725 i‡(
	`zb_gëPﬁlR©e
())

727 
idítifyQuîyRcvTimeout
 = 
	`zb_gëPﬁlR©e
() * 3;

732 i‡(!
g_bdbCtx
.
idítifyTimî
)

734 
g_bdbCtx
.
idítifyTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_födBödIdítifyQuîyTimeout
, 
NULL
, 
idítifyQuîyRcvTimeout
);

737  
BDB_STATE_COMMISSIONING_FINDORBIND
;

740  
BDB_STATE_IDLE
;

741 
	}
}

752 
_CODE_BDB_
 
u8
 
	$bdb_commissi⁄ögNëw‹kF‹m©i⁄
()

754 
u8
 
bdbF‹m©i⁄
 = 
BDB_STATE_IDLE
;

755 i‡(!
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kF‹m©i⁄
)

757  
	`bdb_commissi⁄ögFödBöd
();

761 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

763  
	`bdb_commissi⁄ögFödBöd
();

767 #i‡
ZB_ROUTER_ROLE


768 
u32
 
sˇnCh™√ls
 = 
≠s_ib
.
≠s_ch™√l_mask
;

771 
	`zb_nwkF‹m©i⁄
(
sˇnCh™√ls
, 
g_bdbAârs
.
sˇnDuøti⁄
);

773 
bdbF‹m©i⁄
 = 1;

774  
BDB_STATE_COMMISSIONING_NETWORK_FORMATION
;

779  
bdbF‹m©i⁄
;

780 
	}
}

791 
_CODE_BDB_
 
	$bdb_mgmtPîmôJoöögC⁄fúm
(*
¨g
)

793 #i‡
ZB_ROUTER_ROLE


795 #i‡
ZB_COORDINATOR_ROLE


796 
	`zb_∆mePîmôJoöögReque°
(
BDBC_MIN_COMMISSIONING_TIME
);

798 
	`zb_∆mePîmôJoöögReque°
(
BDBC_MIN_COMMISSIONING_TIME
);

803 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

804 i‡(
	`BDB_STATE_GET
(Ë=
BDB_STATE_COMMISSIONING_NETWORK_STEER
)

806 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_FINISH
;

807 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

809 i‡(
	`BDB_STATE_GET
(Ë=
BDB_STATE_COMMISSIONING_NETWORK_FORMATION
)

811 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_FORMATION_FINISH
;

812 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

815 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

817 
	`bdb_commissi⁄ögInfoSave
(
NULL
);

819 
	}
}

830 
_CODE_BDB_
 
	$bdb_mgmtPîmôJoöögTrig
(*
¨g
)

832 
u8
 
¢
 = 0;

833 
	`zb_mgmtPîmôJoöReq
(0xfffc, 
BDBC_MIN_COMMISSIONING_TIME
, 0x01, &
¢
, 
NULL
);

834 
	`TL_SCHEDULE_TASK
(
bdb_mgmtPîmôJoöögC⁄fúm
, 
NULL
);

835 
	}
}

846 
_CODE_BDB_
 
	$bdb_ªåõveTcLökKeyTimîSt›
()

848 i‡(
g_bdbCtx
.
ªåõveTcLkKeyTimî
)

850 
	`TL_ZB_TIMER_CANCEL
(&
g_bdbCtx
.
ªåõveTcLkKeyTimî
);

852 
	}
}

863 
_CODE_BDB_
 
	$bdb_ªåõveTcLökKeyD⁄e
(
u8
 
°©us
)

866 
u32
 
evt
 = 
BDB_EVT_IDLE
;

867 
	`bdb_ªåõveTcLökKeyTimîSt›
();

868 i‡(
°©us
 =
BDB_COMMISSION_STA_SUCCESS
)

870 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 1;

871 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_PERMITJOIN
;

875 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 0;

876 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_FINISH
;

879 
	`BDB_STATUS_SET
(
°©us
);

880 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

881 
	}
}

892 
_CODE_BDB_
 
	$bdb_nodeDescRe•H™dÀr
(*
¨g
)

894 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

895 
zdo_node_des¸ùt_ª•_t
 *
r•
 = (zdo_node_des¸ùt_ª•_à*)
p
->
zpdu
;

899 i‡((
r•
->
°©us
 =
ZDO_SUCCESS
))

901 
u8
 
°ackRev
 = (
r•
->
node_des¸ùt‹
.
£rvî_mask
 >> 9) & 0x3f;

902 i‡(
°ackRev
 >= 21)

904 
ss_≠smeReque°KeyReq_t
 
ªque°Key
;

905 
	`TL_SETSTRUCTCONTENT
(
ªque°Key
, 0);

907 
ªque°Key
.
keyTy≥
 = 
SS_KEYREQ_TYPE_TCLK
;

908 
ªque°Key
.
d°Addr
.
sh‹tAddr
 = 0x0000;

909 
ªque°Key
.
d°AddrMode
 = 
ZB_ADDR_16BIT_DEV_OR_BROADCAST
;

911 i‡(
	`zb_≠smeReque°KeyReq
(&
ªque°Key
Ë=
RET_OK
)

913 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 0;

923 
	`bdb_ªåõveTcLökKeyD⁄e
(
BDB_COMMISSION_STA_SUCCESS
);

924 
	}
}

935 
_CODE_BDB_
 
s32
 
	$bdb_ªåõveTcLökKeyTimeout
(*
¨g
)

937 i‡(
g_bdbAârs
.
tcLökKeyExch™geAâem±s
++ < g_bdbAârs.
tcLökKeyExch™geAâem±sMax
)

940 
u8
 
¢
 = 0;

941 
zdo_node_des¸ùt‹_ªq_t
 
ªq
;

942 
ªq
.
nwk_addr_öãª°
 = 0x0000;

943 
	`zb_zdoNodeDescReq
(0x0000, &
ªq
, &
¢
, 
bdb_nodeDescRe•H™dÀr
);

948 i‡(!
	`zb_isDevi˚JoöedNwk
())

950 
g_bdbAârs
.
tcLökKeyExch™geAâem±s
 = 0;

951 
g_bdbCtx
.
ªåõveTcLkKeyTimî
 = 
NULL
;

953 
	`bdb_ªåõveTcLökKeyD⁄e
(
BDB_COMMISSION_STA_TCLK_EX_FAILURE
);

957 
∆me_Àave_ªq_t
 
ªq
;

958 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
devi˚Addr
, 
g_zbMacPib
.
extAddªss
);

959 
ªq
.
ªjoö
 = 0;

960 
ªq
.
ªmoveChûdªn
 = 0;

961 i‡(!
g_bdbCtx
.
ÀaveDoög
)

963 i‡(
RET_OK
 =
	`zb_∆meLóveReq
(&
ªq
))

965 
g_bdbCtx
.
ÀaveDoög
 = 1;

970 
	}
}

981 
_CODE_BDB_
 
s32
 
	$bdb_ªåõveTcLökKeySèπ
(*
¨g
)

983 i‡(
g_bdbAârs
.
tcLökKeyExch™geMëhod
 =
TCKEY_EXCHANGE_METHOD_APSRK
)

986 
u8
 
¢
 = 0;

987 
zdo_node_des¸ùt‹_ªq_t
 
ªq
;

988 
ªq
.
nwk_addr_öãª°
 = 0x0000;

989 
	`zb_zdoNodeDescReq
(0x0000, &
ªq
, &
¢
, 
bdb_nodeDescRe•H™dÀr
);

992 
g_bdbCtx
.
ÀaveDoög
 = 0;

993 
g_bdbAârs
.
tcLökKeyExch™geAâem±s
 = 0;

994 
g_bdbAârs
.
tcLökKeyExch™geAâem±sMax
 = 3;

995 i‡(!
g_bdbCtx
.
ªåõveTcLkKeyTimî
)

997 
g_bdbCtx
.
ªåõveTcLkKeyTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_ªåõveTcLökKeyTimeout
, 
NULL
, 
BDBC_TC_LINK_KEY_EXCHANGE_TIMEOUT
 * 1000);

1002 
	`bdb_ªåõveTcLökKeyD⁄e
(
BDB_COMMISSION_STA_SUCCESS
);

1006 
	}
}

1017 
_CODE_BDB_
 
	$bdb_√tw‹kSãîN⁄Fa˘‹yNew
()

1020 
	`bdb_mgmtPîmôJoöögTrig
(
NULL
);

1021 
	}
}

1024 
	$bdb_nwkDiscCnfCb
()

1026 
u8
 
addNebNum
 = 
g_zb_√ighb‹Tbl
.
addôi⁄Neighb‹Num
;

1028 
	`¥ötf
("discCnfCb:áddNebNum = %d\n", 
addNebNum
);

1030 
u8
 
i
 = 0; i < 6; i++){

1031 
	`¥ötf
("======idx = %d======\n", 
i
);

1032 
	`¥ötf
("add∏%x,Ö™Id = %x\n", 
g_zb_√ighb‹Tbl
.
addôi⁄Neighb‹Tbl
[
i
].
sh‹tAddr
, g_zb_√ighb‹Tbl.addôi⁄Neighb‹Tbl[i].
∑nId
);

1033 
	`¥ötf
("≥rmô = %x, dïth = %d\n", 
g_zb_√ighb‹Tbl
.
addôi⁄Neighb‹Tbl
[
i
].
≥rmôJoöög
, g_zb_√ighb‹Tbl.addôi⁄Neighb‹Tbl[i].
dïth
);

1035 
	}
}

1047 
_CODE_BDB_
 
	$bdb_√tw‹kSãîFa˘‹yNew
()

1050 
u32
 
sˇnCh™√ls
 = 
≠s_ib
.
≠s_ch™√l_mask
;

1053 
∆me_nwkDisc_ªq_t
 
ªq
;

1054 
ªq
.
sˇnCh™√ls
 = scanChannels;

1055 
ªq
.
sˇnDuøti⁄
 = 
g_bdbAârs
.scanDuration;

1057 
	`zdo_nwk_discovîy_Sèπ
(&
ªq
, 
NULL
);

1058 
	}
}

1069 
_CODE_BDB_
 
u8
 
	$bdb_commissi⁄ögNëw‹kSãî
()

1071 
u8
 
°©us
 = 
BDB_STATE_IDLE
;

1072 i‡(!
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
)

1074 
°©us
 = 
	`bdb_commissi⁄ögNëw‹kF‹m©i⁄
();

1081 
°©us
 = 
BDB_STATE_COMMISSIONING_NETWORK_STEER
;

1082 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

1085 
	`bdb_√tw‹kSãîN⁄Fa˘‹yNew
();

1090 
	`bdb_√tw‹kSãîFa˘‹yNew
();

1093  
°©us
;

1094 
	}
}

1105 
	$bdb_èsk
(*
¨g
)

1107 
u32
 
evt
 = (u32)
¨g
;

1108 
u8
 
°©us
 = 
BDB_STATE_IDLE
;

1109 
u8
 
¢
 = 0;

1111 
	`BDB_STATE_GET
())

1113 
BDB_STATE_INIT
:

1114 
	`BDB_STATE_SET
(
BDB_STATE_IDLE
);

1115 i‡(
evt
 =
BDB_EVT_INIT_DONE
)

1117 i‡(
g_bdbCtx
.
bdbAµCb
->
bdbInôCb
)

1119 
g_bdbCtx
.
bdbAµCb
->
	`bdbInôCb
(g_bdbCtx.
öôResu…
, 
g_bdbAârs
.
nodeIsOnANëw‹k
);

1122 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

1124 
	`nv_nwkFømeCou¡SaveToFœsh
(
ss_ib
.
outgoögFømeCou¡î
);

1126 i‡(
g_bdbCtx
.
öôResu…
 =
BDB_INIT_STATUS_SUCCESS
)

1128 i‡((
	`zdo_ssInfoKeyGë
(Ë!
ss_ib
.
a˘iveSecuªM©îülIndex
) ||

1129 (
g_zbInfo
.
macPib
.
phyCh™√lCur
 !
g_bdbCtx
.
ch™√l
) ||

1130 
g_zbNwkCtx
.
∑ª¡IsCh™ged
)

1132 
g_zbNwkCtx
.
∑ª¡IsCh™ged
 = 0;

1133 
	`TL_SCHEDULE_TASK
(
bdb_commissi⁄ögInfoSave
, 
NULL
);

1136 #i‡
ZB_ROUTER_ROLE


1137 
g_zbNwkCtx
.
joöAc˚±
 = 1;

1140 
	`zb_zdoSídP¨ítA¬˚
();

1145 
g_bdbCtx
.
öôed
 = 0;

1149 
BDB_STATE_IDLE
:

1153 i‡(
evt
 =
BDB_EVT_COMMISSIONING_START
)

1155 i‡(!
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
)

1157 
°©us
 = 
	`bdb_commissi⁄ögNëw‹kSãî
();

1165 i‡(!
g_bdbAârs
.
nodeIsOnANëw‹k
)

1167 
	`ss_£curôyModeSë
(
SS_SEMODE_DISTRIBUTED
);

1169 #i‡((
ROUTER
 || 
END_DEVICE
Ë&& 
TOUCHLINK_SUPPORT
)

1170 i‡(
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_INITIATOR
)

1172 
	`z˛_touchLökSèπ
();

1173 
°©us
 = 
BDB_STATE_COMMISSIONING_TOUCHLINK
;

1178 i‡(
°©us
 =
BDB_STATE_IDLE
)

1181 
g_bdbAârs
.
commissi⁄ögSètus
 = 
BDB_COMMISSION_STA_NO_NETWORK
;

1182 i‡(
g_bdbCtx
.
bdbAµCb
->
bdbcommissi⁄ögCb
)

1184 
g_bdbCtx
.
bdbAµCb
->
	`bdbcommissi⁄ögCb
(
g_bdbAârs
.
commissi⁄ögSètus
, 
NULL
);

1187 
	`BDB_STATE_SET
(
°©us
);

1189 i‡(
evt
 =
BDB_STATE_REJOIN_DONE
)

1191 
	`bdb_t›LevñCommissi⁄gC⁄fúm
();

1195 
BDB_STATE_COMMISSIONING_TOUCHLINK
:

1196 i‡(
evt
 =
BDB_EVT_COMMISSIONING_TOUCHLINK_NO_RESP
)

1201 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 0;

1202 
	`BDB_STATE_SET
(
BDB_STATE_IDLE
);

1203 
g_bdbAârs
.
commissi⁄ögSètus
 = 
	`BDB_STATUS_GET
();

1205 #i‡
ZB_ED_ROLE


1206 
	`bdb_t›LevñCommissi⁄ög
(
BDB_COMMISSIONING_ROLE_INITIATOR
);

1208 
	`bdb_t›LevñCommissi⁄ög
(
BDB_COMMISSIONING_ROLE_TARGET
);

1211 i‡(
evt
 =
BDB_EVT_COMMISSIONING_TOUCHLINK_FINISH
)

1216 i‡(!
	`zb_isDevi˚Fa˘‹yNew
())

1218 
	`bdb_commissi⁄ögInfoSave
(
NULL
);

1221 
	`bdb_t›LevñCommissi⁄gC⁄fúm
();

1222 
	`BDB_STATE_SET
(
BDB_STATE_IDLE
);

1226 
BDB_STATE_COMMISSIONING_NETWORK_STEER
:

1227 i‡(
evt
 =
BDB_EVT_COMMISSIONING_NETWORK_STEER_RETRIEVE_TCLINK_KEY
)

1229 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_ªåõveTcLökKeySèπ
, 
NULL
, 1000);

1231 i‡(
evt
 =
BDB_EVT_COMMISSIONING_NETWORK_STEER_PERMITJOIN
)

1233 #i‡
ZB_ROUTER_ROLE


1234 
g_zbNwkCtx
.
joöAc˚±
 = 1;

1236 
	`zb_mgmtPîmôJoöReq
(0xfffc, 
BDBC_MIN_COMMISSIONING_TIME
, 0x01, &
¢
, 
NULL
);

1237 
	`TL_SCHEDULE_TASK
(
bdb_mgmtPîmôJoöögC⁄fúm
, 
NULL
);

1239 i‡(
evt
 =
BDB_EVT_COMMISSIONING_NETWORK_STEER_FINISH
)

1241 #i‡
ZB_COORDINATOR_ROLE


1242 
	`ss_£curôyModeSë
(
SS_SEMODE_CENTRALIZED
);

1244 i‡((!
g_bdbAârs
.
nodeIsOnANëw‹k
Ë|| (
	`ZB_IEEE_ADDR_IS_INVALID
(
ss_ib
.
åu°_˚¡î_addªss
)))

1246 
	`ss_£curôyModeSë
(
SS_SEMODE_DISTRIBUTED
);

1249 
°©us
 = 
	`bdb_commissi⁄ögNëw‹kF‹m©i⁄
();

1250 i‡(
°©us
 =
BDB_STATE_IDLE
)

1253 
	`bdb_t›LevñCommissi⁄gC⁄fúm
();

1255 
	`BDB_STATE_SET
(
°©us
);

1259 
BDB_STATE_COMMISSIONING_NETWORK_FORMATION
:

1260 i‡(
evt
 =
BDB_EVT_COMMISSIONING_NETWORK_FORMATION_PERMITJOIN
)

1262 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 1;

1263 
	`zb_mgmtPîmôJoöReq
(0xfffc, 
BDBC_MIN_COMMISSIONING_TIME
, 0x01, &
¢
, 
NULL
);

1264 
	`TL_SCHEDULE_TASK
(
bdb_mgmtPîmôJoöögC⁄fúm
, 
NULL
);

1266 i‡(
evt
 =
BDB_EVT_COMMISSIONING_NETWORK_FORMATION_FINISH
)

1268 
°©us
 = 
	`bdb_commissi⁄ögFödBöd
();

1269 i‡(
°©us
 =
BDB_STATE_IDLE
)

1272 
	`bdb_t›LevñCommissi⁄gC⁄fúm
();

1274 
	`BDB_STATE_SET
(
°©us
);

1278 
BDB_STATE_COMMISSIONING_FINDORBIND
:

1279 i‡(
evt
 =
BDB_EVT_COMMISSIONING_FINDORBIND_SIMPLE_DESC_REQ
)

1281 
	`bdb_commissi⁄ögFödBödSim∂eDescReq
();

1283 i‡(
evt
 =
BDB_EVT_COMMISSIONING_FINDORBIND_FINISH
)

1285 
	`bdb_födBödR°
();

1286 
	`bdb_t›LevñCommissi⁄gC⁄fúm
();

1287 
	`BDB_STATE_SET
(
BDB_STATE_IDLE
);

1294 
	}
}

1305 
_CODE_BDB_
 
s32
 
	$bdb_èsk_dñay
(*
¨g
)

1307 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, 
¨g
);

1309 
	}
}

1320 
_CODE_BDB_
 
	$bdb_zdoSèπDevCnf
(
zdo_°¨t_devi˚_c⁄fúm_t
 *
°¨tDevCnf
)

1322 
u32
 
evt
 = 
BDB_EVT_IDLE
;

1323 
u8
 
°©e
 = 
	`BDB_STATE_GET
();

1325 
°©e
)

1327 
BDB_STATE_IDLE
:

1329 i‡(
°¨tDevCnf
->
°©us
 =
SUCCESS
)

1332 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 1;

1333 #i‡
ZB_ROUTER_ROLE


1334 
g_zbNwkCtx
.
joöAc˚±
 = 1;

1336 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

1337 i‡((
	`zdo_ssInfoKeyGë
(Ë!
ss_ib
.
a˘iveSecuªM©îülIndex
) ||

1338 (
g_zbInfo
.
macPib
.
phyCh™√lCur
 !
g_bdbCtx
.
ch™√l
) ||

1339 
g_zbNwkCtx
.
∑ª¡IsCh™ged
)

1341 
g_zbNwkCtx
.
∑ª¡IsCh™ged
 = 0;

1342 
	`TL_SCHEDULE_TASK
(
bdb_commissi⁄ögInfoSave
, 
NULL
);

1347 i‡(
°¨tDevCnf
->
°©us
 =
ZDO_NETWORK_LOST
)

1349 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_PARENT_LOST
);

1354 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_REJOIN_FAILURE
);

1357 
evt
 = 
BDB_STATE_REJOIN_DONE
;

1358 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1361 
BDB_STATE_INIT
:

1362 
evt
 = 
BDB_EVT_INIT_DONE
;

1363 
g_bdbCtx
.
öôResu…
 = 
BDB_INIT_STATUS_SUCCESS
;

1364 i‡(
°¨tDevCnf
->
°©us
 !
SUCCESS
)

1366 
g_bdbCtx
.
öôResu…
 = 
BDB_INIT_STATUS_FAILURE
;

1368 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1371 #i‡((
ROUTER
 || 
END_DEVICE
Ë&& 
TOUCHLINK_SUPPORT
)

1372 
BDB_STATE_COMMISSIONING_TOUCHLINK
:

1373 i‡(
°¨tDevCnf
->
°©us
 =
SUCCESS
)

1375 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 1;

1376 #i‡
ZB_ROUTER_ROLE


1377 
g_zbNwkCtx
.
joöAc˚±
 = 1;

1379 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_touchLökDevSèπIndiˇã
, (*)(
°¨tDevCnf
->
°©us
), 400);

1384 
	`z˛_touchLökDevSèπIndiˇã
((*)(
°¨tDevCnf
->
°©us
));

1389 
BDB_STATE_COMMISSIONING_NETWORK_STEER
:

1390 i‡(
°¨tDevCnf
->
°©us
 =
SUCCESS
)

1393 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 1;

1394 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

1395 i‡(!
	`ZB_IEEE_ADDR_IS_INVALID
(
ss_ib
.
åu°_˚¡î_addªss
Ë&& ss_ib.
£curôyLevñ
)

1397 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_RETRIEVE_TCLINK_KEY
;

1401 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_PERMITJOIN
;

1403 
	`TL_ZB_TIMER_SCHEDULE
(
bdb_èsk_dñay
, (*)
evt
, 200);

1408 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_NO_NETWORK
);

1409 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_STEER_FINISH
;

1410 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1414 
BDB_STATE_COMMISSIONING_NETWORK_FORMATION
:

1415 i‡(
°¨tDevCnf
->
°©us
 =
SUCCESS
)

1417 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 1;

1418 
g_zbNwkCtx
.
joöAc˚±
 = 1;

1421 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

1422 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_FORMATION_PERMITJOIN
;

1424 i‡(
g_bdbCtx
.
bdbAµCb
->
bdbcommissi⁄ögCb
)

1426 
g_bdbCtx
.
bdbAµCb
->
	`bdbcommissi⁄ögCb
(
BDB_COMMISSION_STA_FORMATION_DONE
, 
NULL
);

1433 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_FORMATION_FAILURE
);

1434 
evt
 = 
BDB_EVT_COMMISSIONING_NETWORK_FORMATION_FINISH
;

1436 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1444 
	}
}

1456 
_CODE_BDB_
 
	$bdb_touchLökCÆlback
(
u8
 
°©us
, *
¨g
)

1458 
u32
 
evt
 = 
BDB_EVT_IDLE
;

1459 i‡(
°©us
 =
ZCL_ZLL_TOUCH_LINK_STA_TARGET_START
)

1461 
	`BDB_STATE_SET
(
BDB_STATE_COMMISSIONING_TOUCHLINK
);

1462 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 1;

1463 
g_bdbCtx
.
rﬁe
 = 
BDB_COMMISSIONING_ROLE_TARGET
;

1465 i‡(
°©us
 =
ZCL_ZLL_TOUCH_LINK_STA_NO_SERVER
)

1472 i‡(
	`is_devi˚_Á˘‹y_√w
())

1474 
	`bdb_sˇnCfg
(
g_bdbAârs
.
¥im¨yCh™√lSë
 | g_bdbAârs.
£c⁄d¨yCh™√lSë
, g_bdbAârs.
sˇnDuøti⁄
);

1476 
evt
 = 
BDB_EVT_COMMISSIONING_TOUCHLINK_NO_RESP
;

1478 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_NO_SCAN_RESPONSE
);

1482 
evt
 = 
BDB_EVT_COMMISSIONING_TOUCHLINK_FINISH
;

1484 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_TARGET_FAILURE
);

1489 
evt
 = 
BDB_EVT_COMMISSIONING_TOUCHLINK_FINISH
;

1490 i‡(
°©us
 =
ZCL_ZLL_TOUCH_LINK_STA_SUCC
 || sètu†=
ZCL_ZLL_TOUCH_LINK_STA_EXIST
)

1492 
	`ss_£curôyModeSë
(
SS_SEMODE_DISTRIBUTED
);

1495 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_SUCCESS
);

1500 
	`BDB_STATUS_SET
(
BDB_COMMISSION_STA_TARGET_FAILURE
);

1504 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1505 
	}
}

1517 
_CODE_BDB_
 
	$bdb_commssi⁄UtûôyCÆlback
(
u8
 
cmd
, *
¨g
)

1519 
	}
}

1530 
_CODE_BDB_
 
u8
 
	$bdb_t›LevñCommissi⁄gC⁄fúm
()

1532 
g_bdbAârs
.
commissi⁄ögSètus
 = 
	`BDB_STATUS_GET
();

1534 i‡(
g_bdbCtx
.
idítifyTimî
)

1536 
	`TL_ZB_TIMER_CANCEL
(&
g_bdbCtx
.
idítifyTimî
);

1539 i‡(
g_bdbCtx
.
bdbAµCb
->
bdbcommissi⁄ögCb
)

1541 
g_bdbCtx
.
bdbAµCb
->
	`bdbcommissi⁄ögCb
(
g_bdbAârs
.
commissi⁄ögSètus
, 
NULL
);

1544 i‡(
g_bdbAârs
.
commissi⁄ögSètus
 =
BDB_COMMISSION_STA_SUCCESS
)

1546 
u8
 
Àn
 = 0;

1547 
	`é_zbMacAârGë
(
MAC_PHY_ATTR_CURRENT_CHANNEL
, &
g_bdbCtx
.
ch™√l
, &
Àn
);

1548 #i‡
ZB_COORDINATOR_ROLE


1549 i‡(
g_bdbCtx
.
Á˘‹yNew
 == 1)

1551 
	`bdb_commissi⁄ögInfoSave
(
NULL
);

1552 
g_bdbCtx
.
Á˘‹yNew
 = 0;

1558 #i‡
ZB_ROUTER_ROLE


1559 i‡(
	`BDB_TOUCHLINK_CAP_EN
(Ë&& 
	`is_devi˚_Á˘‹y_√w
())

1564 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
g_bdbCtx
.
ch™√l
);

1565 
	`rf_£tTrxSèã
(
RF_STATE_RX
);

1571 
	}
}

1582 
_CODE_BDB_
 
u8
 
	$bdb_t›LevñCommissi⁄ög
(
u8
 
èrgë
)

1586 i‡(
	`BDB_STATE_GET
(Ë!
BDB_STATE_IDLE
 || 
g_bdbAârs
.
commissi⁄ögSètus
 =
BDB_COMMISSION_STA_IN_PROGRESS
)

1588  
BDB_STATE_COMMISSIONING_BUSY
;

1591 
g_bdbCtx
.
rﬁe
 = 
èrgë
;

1592 
g_bdbAârs
.
commissi⁄ögSètus
 = 
BDB_COMMISSION_STA_IN_PROGRESS
;

1594 
u32
 
evt
 = 
BDB_EVT_COMMISSIONING_START
;

1595 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1597  
BDB_STATE_IDLE
;

1598 
	}
}

1609 
_CODE_BDB_
 
u8
 
	$bdb_√tw‹kF‹m©i⁄Sèπ
()

1611 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 0;

1612 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 0;

1613 
g_bdbAârs
.
commissi⁄ögMode
.
födOrBöd
 = 0;

1614 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kF‹m©i⁄
 = 1;

1616 #i‡
ZB_COORDINATOR_ROLE


1617 
	`ss_£curôyModeSë
(
SS_SEMODE_CENTRALIZED
);

1619 i‡((!
g_bdbAârs
.
nodeIsOnANëw‹k
Ë|| (
	`ZB_IEEE_ADDR_IS_INVALID
(
ss_ib
.
åu°_˚¡î_addªss
)))

1621 
	`ss_£curôyModeSë
(
SS_SEMODE_DISTRIBUTED
);

1625  
	`bdb_t›LevñCommissi⁄ög
(
BDB_COMMISSIONING_ROLE_TARGET
);

1626 
	}
}

1637 
_CODE_BDB_
 
u8
 
	$bdb_√tw‹kSãîSèπ
()

1639 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kF‹m©i⁄
 = 0;

1640 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 0;

1641 
g_bdbAârs
.
commissi⁄ögMode
.
födOrBöd
 = 0;

1642 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 1;

1643  
	`bdb_t›LevñCommissi⁄ög
(
BDB_COMMISSIONING_ROLE_TARGET
);

1644 
	}
}

1655 
_CODE_BDB_
 
u8
 
	$bdb_√tw‹kTouchLökSèπ
(
u8
 
rﬁe
)

1657 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 1;

1658 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kF‹m©i⁄
 = 0;

1659 
g_bdbAârs
.
commissi⁄ögMode
.
födOrBöd
 = 0;

1660 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 1;

1661  
	`bdb_t›LevñCommissi⁄ög
(
rﬁe
);

1662 
	}
}

1673 
_CODE_BDB_
 
u8
 
	$bdb_födAndBödSèπ
(
u8
 
rﬁe
)

1675 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kSãî
 = 0;

1676 
g_bdbAârs
.
commissi⁄ögMode
.
√tw‹kF‹m©i⁄
 = 0;

1677 
g_bdbAârs
.
commissi⁄ögMode
.
touchlök
 = 0;

1678 
g_bdbAârs
.
commissi⁄ögMode
.
födOrBöd
 = 1;

1679  
	`bdb_t›LevñCommissi⁄ög
(
rﬁe
);

1680 
	}
}

1691 
boﬁ
 
	$bdb_isIdÀ
()

1693 i‡(
	`BDB_STATE_GET
(Ë=
BDB_STATE_IDLE
 && 
g_bdbAârs
.
commissi⁄ögSètus
 !
BDB_COMMISSION_STA_IN_PROGRESS
)

1698 
	}
}

1712 
_CODE_BDB_
 
u8
 
	$bdb_öô
(
af_sim∂e_des¸ùt‹_t
 *
sim∂e_desc
, 
bdb_commissi⁄Sëtög_t
 *
£âög
, 
bdb_≠pCb_t
 *
cb
, 
u8
 
ªpowî
)

1714 i‡(
g_bdbCtx
.
öôed
)

1718 
g_bdbCtx
.
öôed
 = 1;

1719 
g_bdbCtx
.
bdbAµCb
 = 
cb
;

1720 
g_bdbCtx
.
sim∂eDesc
 = 
sim∂e_desc
;

1721 
g_bdbCtx
.
commissi⁄Sëtögs
 = 
£âög
;

1722 
g_bdbCtx
.
Á˘‹yNew
 = 
	`zb_isDevi˚Fa˘‹yNew
();

1724 
	`BDB_STATE_SET
(
BDB_STATE_INIT
);

1727 #i‡
SECURITY_ENABLE


1728 i‡(
g_bdbCtx
.
£curôyDißbÀ
)

1730 
	`ss_zdoInô
(
FALSE
);

1734 
	`ss_zdoInô
(
TRUE
);

1737 
	`ss_zdoInô
(
FALSE
);

1741 
	`bdb_lökKeyCfg
(
£âög
, 
g_bdbCtx
.
Á˘‹yNew
);

1744 i‡(
g_bdbCtx
.
Á˘‹yNew
)

1751 #i‡((
ROUTER
 || 
END_DEVICE
Ë&& 
TOUCHLINK_SUPPORT
)

1753 
	`bdb_touchLökPªCfg
(
sim∂e_desc
->
ídpoöt
, 
£âög
, &
bdb_touchlökCb
);

1756 
	`bdb_sˇnCfg
(
g_bdbAârs
.
¥im¨yCh™√lSë
 | g_bdbAârs.
£c⁄d¨yCh™√lSë
, g_bdbAârs.
sˇnDuøti⁄
);

1758 
g_bdbAârs
.
commissi⁄ögSètus
 = 
BDB_COMMISSION_STA_SUCCESS
;

1759 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 
g_bdbCtx
.
Á˘‹yNew
 ? 0 : 1;

1761 i‡(
g_bdbAârs
.
nodeIsOnANëw‹k
)

1764 
	`bdb_outgoögFømeCou¡Upd©e
(
ªpowî
);

1766 #i‡
ZB_COORDINATOR_ROLE


1767 
	`bdb_co‹dö©‹Sèπ
();

1768 #ñi‡
ZB_ROUTER_ROLE


1769 
	`bdb_rouãrSèπ
();

1770 #ñi‡
ZB_ED_ROLE


1771 
	`bdb_ídDevi˚Sèπ
(
ªpowî
);

1777 
	`bdb_Á˘‹yNewDevCfg
(
	`BDB_TOUCHLINK_CAP_EN
(), 
£âög
->
touchlökCh™√l
);

1779 
u32
 
evt
 = 
BDB_EVT_INIT_DONE
;

1780 
	`TL_SCHEDULE_TASK
(
bdb_èsk
, (*)
evt
);

1784 
u8
 
Àn
 = 0;

1785 
	`é_zbMacAârGë
(
MAC_PHY_ATTR_CURRENT_CHANNEL
, &
g_bdbCtx
.
ch™√l
, &
Àn
);

1787 
	}
}

1799 
_CODE_BDB_
 
	$bdb_födBödM©chClu°îSë
(
u8
 
˛u°îNum
, 
u16
 
˛u°îId
[])

1801 
g_bdbCtx
.
˛u°îNum
 = clusterNum;

1802 
g_bdbCtx
.
˛u°îLi°
 = 
˛u°îId
;

1803 
	}
}

1814 
_CODE_BDB_
 
boﬁ
 
	$bdb_addIdítifyA˘iveEpF‹FB
(
födBödD°_t
 
d°Info
)

1816 i‡(
	`BDB_STATE_GET
(Ë=
BDB_STATE_COMMISSIONING_FINDORBIND
 && 
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_INITIATOR
)

1818 i‡(!
g_bdbCtx
.
pFödBödQ
)

1820 
g_bdbCtx
.
pFödBödQ
 = 
	`queueInô
();

1821 i‡(!
g_bdbCtx
.
pFödBödQ
)

1823  
FALSE
;

1827  
	`queuePush
(
g_bdbCtx
.
pFödBödQ
, 
d°Info
);

1830  
FALSE
;

1831 
	}
}

1848 
_CODE_BDB_
 
°©us_t
 
	$bdb_deÁu…Rï‹tögCfg
(
u8
 
ídpoöt
, 
u16
 
¥ofûeID
, u16 
˛u°îID
, u16 
©åID
, u16 
möRï‹tI¡
, u16 
maxRï‹tI¡
, u8 *
ªp‹èbÀCh™ge
)

1850 
z˛CfgRï‹tRec_t
 
cfgRï‹tRec
;

1851 
	`TL_SETSTRUCTCONTENT
(
cfgRï‹tRec
, 0);

1853 
ªp‹tCfgInfo_t
 *
pE¡ry
 = 
	`z˛_ªp‹tCfgInfoE¡ryFöd
(
ídpoöt
, 
˛u°îID
, 
©åID
);

1854 i‡(
pE¡ry
)

1856  
ZCL_STA_DUPLICATE_EXISTS
;

1859 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îID
, 
©åID
);

1860 i‡(!
pAârE¡ry
)

1862  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

1865 
cfgRï‹tRec
.
©åID
 =áttrID;

1866 
cfgRï‹tRec
.
d©aTy≥
 = 
pAârE¡ry
->
ty≥
;

1867 
cfgRï‹tRec
.
dúe˘i⁄
 = 0;

1868 
cfgRï‹tRec
.
möRï‹tI¡
 = minReportInt;

1869 
cfgRï‹tRec
.
maxRï‹tI¡
 = maxReportInt;

1870 
cfgRï‹tRec
.
ªp‹èbÀCh™ge
 =ÑeportableChange;

1872  
	`z˛_c⁄figuªRï‹tög
(
ídpoöt
, 
¥ofûeID
, 
˛u°îID
, &
cfgRï‹tRec
);

1873 
	}
}

1885 
_CODE_BDB_
 
	$bdb_©åSë
(
u8
 
©åId
, u8 *
vÆue
)

1887 i‡(
©åId
 > 
BDB_ATTR_TC_NODE_JOIN_TIMEOUT
 ||áârId < 
BDB_ATTR_PRIMARY_CHANNEL_SET
)

1892 
u8
 
Àn
 = 
g_bdbAârTbl
[
©åId
 - 
BDB_ATTR_PRIMARY_CHANNEL_SET
].len;

1893 
	`mem˝y
((
u8
 *)&
g_bdbAârs
 + 
g_bdbAârTbl
[
©åId
 - 
BDB_ATTR_PRIMARY_CHANNEL_SET
].
off£t
, 
vÆue
, 
Àn
);

1895 
	}
}

1908 
_CODE_BDB_
 
u8
 
	$bdb_©åGë
(
u8
 
©åId
, u8 *
vÆue
, u8 *
Àn
)

1910 i‡(
©åId
 > 
BDB_ATTR_TC_NODE_JOIN_TIMEOUT
 ||áârId < 
BDB_ATTR_PRIMARY_CHANNEL_SET
)

1912  
BDB_COMMISSION_STA_NOT_PERMITTED
;

1914 *
Àn
 = 
g_bdbAârTbl
[
©åId
 - 
BDB_ATTR_PRIMARY_CHANNEL_SET
].len;

1915 
	`mem˝y
(
vÆue
, (
u8
 *)&
g_bdbAârs
 + 
g_bdbAârTbl
[
©åId
 - 
BDB_ATTR_PRIMARY_CHANNEL_SET
].
off£t
, *
Àn
);

1917  
BDB_COMMISSION_STA_SUCCESS
;

1918 
	}
}

1929 
_CODE_BDB_
 
	$é_bdbRe£t
()

1931 
af_sim∂e_des¸ùt‹_t
 *
sd
 = 
g_bdbCtx
.
sim∂eDesc
;

1932 
bdb_≠pCb_t
 *
bcb
 = 
g_bdbCtx
.
bdbAµCb
;

1933 
bdb_commissi⁄Sëtög_t
 *
commissi⁄Së
 = 
g_bdbCtx
.
commissi⁄Sëtögs
;

1934 
g_bdbAârs
.
nodeIsOnANëw‹k
 = 0;

1935 
	`mem£t
((
u8
 *)&
g_bdbCtx
, 0, (g_bdbCtx));

1936 
	`bdb_öô
(
sd
, 
commissi⁄Së
, 
bcb
, 1);

1937 
	}
}

1950 
_CODE_BDB_
 
	$é_bdbRe£t2FN
()

1952 
	`nv_ª£tToFa˘‹yNew
();

1953 
	`zb_ª£t
();

1954 
	`é_bdbRe£t
();

1955 
	}
}

1966 
_CODE_BDB_
 
	$é_bdbAârInô
()

1968 
	`mem˝y
(&
g_bdbAârs
, &
g_bdbAârsD·
, (
bdb_©å_t
));

1969 
	}
}

1971 
_CODE_BDB_
 
u16
 
	$é_bdbIn°ÆlCodeCRC16
(
u8
 *
pIn°ÆlCode
, u8 
Àn
)

1973 
u16
 
¸c
 = 0xffff;

1975 i‡(
Àn
 == 0)

1977  (~
¸c
);

1980 
u8
 
i
;

1981 
u8
 
d©a
;

1985 
i
 = 0, 
d©a
 = 0xf‡& *
pIn°ÆlCode
++; i < 8; i++, data >>= 1)

1987 i‡((
¸c
 & 0x0001Ë^ (
d©a
 & 0x0001))

1989 
¸c
 = (¸¯>> 1Ë^ 
POLY
;

1993 
¸c
 >>= 1;

1996 } --
Àn
);

1998 
¸c
 = ~crc;

2000  
¸c
;

2001 
	}
}

2003 
_CODE_BDB_
 
	$é_bdbU£In°ÆlCode
(
u8
 *
pIn°ÆlCode
, u8 *
pKey
)

2005 
u8
 
tmpBuf
[
SEC_KEY_LEN
 + 2];

2007 
	`mem˝y
((
u8
 *)
tmpBuf
, (u8 *)
pIn°ÆlCode
, 
SEC_KEY_LEN
);

2009 
u16
 
¸c
 = 
	`é_bdbIn°ÆlCodeCRC16
(
pIn°ÆlCode
, 
SEC_KEY_LEN
);

2011 
tmpBuf
[
SEC_KEY_LEN
] = (
u8
)(
¸c
 & 0xff);

2012 
tmpBuf
[
SEC_KEY_LEN
 + 1] = (
u8
)(
¸c
 >> 8);

2014 
	`ss_mmoHash
(
tmpBuf
, 
SEC_KEY_LEN
 + 2, 
pKey
);

2015 
	}
}

2025 
_CODE_BDB_
 
u8
 
	$bdb_¥eIn°ÆlCodeLﬂd
(
u8
 *
keyTy≥
, u8 
dîivedKey
[])

2027 
u8
 
övÆidIn°ÆlCode
[
SEC_KEY_LEN
] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,

2029 
u8
 
ö°ÆlCode
[
SEC_KEY_LEN
];

2031 
	`Êash_ªad
(
CFG_PRE_INSTALL_CODE
, 
SEC_KEY_LEN
, (
u8
 *)
ö°ÆlCode
);

2033 i‡(!
	`memcmp
((
u8
 *)
ö°ÆlCode
, (u8 *)
övÆidIn°ÆlCode
, 
SEC_KEY_LEN
))

2035  
RET_NOT_FOUND
;

2038 
	`é_bdbU£In°ÆlCode
(
ö°ÆlCode
, 
dîivedKey
);

2039 *
keyTy≥
 = 
SS_UNIQUE_LINK_KEY
;

2041  
RET_OK
;

2042 
	}
}

2053 
_CODE_BDB_
 
	$bdb_¥eIn°ÆlCodeAdd
(
addrExt_t
 
õìAddr
, 
u8
 *
pIn°ÆlCode
)

2055 i‡(!
pIn°ÆlCode
 || 
	`ZB_IS_64BIT_ADDR_INVALID
(
õìAddr
Ë|| 
	`ZB_IS_64BIT_ADDR_ZERO
(ieeeAddr))

2060 
ss_dev_∑ú_£t_t
 
keyPaú
;

2062 i‡(
NV_SUCC
 =
	`ss_devKeyPaúFöd
(
õìAddr
, &
keyPaú
))

2067 
	`mem£t
((
u8
 *)&
keyPaú
, 0, (
ss_dev_∑ú_£t_t
));

2069 
	`é_bdbU£In°ÆlCode
(
pIn°ÆlCode
, 
keyPaú
.
lökKey
);

2071 
	`mem˝y
(
keyPaú
.
devi˚_addªss
, 
õìAddr
, 8);

2073 
keyPaú
.
öcomögFømeCou¡î
 = keyPaú.
outgoögFømeCou¡î
 = 0;

2074 
keyPaú
.
≠sLökKeyTy≥
 = 
SS_UNIQUE_LINK_KEY
;

2075 
keyPaú
.
keyAâr
 = 
SS_UNVERIFIED_KEY
;

2077 
	`ss_devKeyPaúSave
(&
keyPaú
);

2078 
	}
}

	@zigbee/bdb/includes/bdb.h

24 #i‚de‡
BDB_H


25 
	#BDB_H


	)

43 
	#BDBC_MAX_SAME_NETWROK_RETRY_ATTEMPTS
 10

44 
	#BDBC_MIN_COMMISSIONING_TIME
 (180)

45 
	#BDBC_REC_SAME_NETWROK_RETRY_ATTEMPTS
 3

46 
	#BDBC_TC_LINK_KEY_EXCHANGE_TIMEOUT
 (5)

47 

	)

54 
	#BDBC_TL_INTRP_TRANSId_LIFETIME
 (8*1000)

55 
	#BDBC_TL_MIN_STARTUP_DELAY_TIME
 (2*1000)

56 
	#BDBC_TL_PRIMARY_CHANNEL_SET
 0x02108800

57 
	#BDBC_TL_RX_WINDOW_DURATION
 (5*1000)

58 
	#BDBC_TL_SCAN_TIME_BASE_DURATION
 250

59 
	#BDBC_TL_SECONDARY_CHANNEL_SET
 (0x07fff800^
BDBC_TL_PRIMARY_CHANNEL_SET
)

60 

	)

62 
	eŒ_devi˚_id
 {

63 
	mLL_DEV_ONOFF_LIGHT
 = 0x0000,

64 
	mLL_DEV_ONOFF_PLUGIN_UNIT
 = 0x0010,

65 
	mLL_DEV_DIMMABLE_LIGHT
 = 0x0100,

66 
	mLL_DEV_DIMMABLE_PLUGIN_UNIT
 = 0x0110,

67 
	mLL_DEV_COLOR_LIGHT
 = 0x0200,

68 
	mLL_DEV_EXTENDED_COLOR_LIGHT
 = 0x0210,

69 
	mLL_DEV_COLOR_TEMPERATURE_LIGHT
 = 0x0220,

70 
	mLL_DEV_COLOR_CONTROLLER
 = 0x0800,

71 
	mLL_DEV_COLOR_SCENE_CONTROLLER
 = 0x0810,

72 
	mLL_DEV_NON_COLOR_CONTROLLER
 = 0x0820,

73 
	mLL_DEV_NON_COLOR_SCENE_CONTROLLER
 = 0x0830,

74 
	mLL_DEV_CONTROL_BRIDGE
 = 0x0840,

75 
	mLL_DEV_ONOFF_SENSOR
 = 0x0850,

79 
	eha_devi˚_id
 {

80 
	mHA_DEV_ONOFF_SWITCH
 = 0x0000,

81 
	mHA_DEV_LEVEL_CTRL_SWITCH
 = 0x0001,

82 
	mHA_DEV_ONOFF_OUTPUT
 = 0x0002,

83 
	mHA_DEV_LEVEL_CTRLABLE_OUTPUT
 = 0x0003,

84 
	mHA_DEV_SCENE_SELECTOR
 = 0x0004,

85 
	mHA_DEV_CONFIG_TOOL
 = 0x0005,

86 
	mHA_DEV_REMOTE_CTRL
 = 0x0006,

87 
	mHA_DEV_COMBINED_INTERFACE
 = 0x0007,

88 
	mHA_DEV_RANGE_EXTENDER
 = 0x0008,

89 
	mHA_DEV_MAINS_PWR_OUTLET
 = 0x0009,

90 
	mHA_DEV_DOOR_LOCK
 = 0x000A,

91 
	mHA_DEV_DOOR_LOCK_CTRLER
 = 0x000B,

92 
	mHA_DEV_SIMPLE_SENSOR
 = 0x000C,

93 
	mHA_DEV_CONSUMPTION_AWARENESS
 = 0x000D,

94 
	mHA_DEV_HOME_GATEWAY
 = 0x0050,

95 
	mHA_DEV_SMART_PLUG
 = 0x0051,

96 
	mHA_DEV_WHITE_GOOD
 = 0x0052,

97 
	mHA_DEV_METER_INTERFACE
 = 0x0053,

99 
	mHA_DEV_ONOFF_LIGHT
 = 0x0100,

100 
	mHA_DEV_DIMMABLE_LIGHT
 = 0x0101,

101 
	mHA_DEV_COLOR_DIMMABLE_LIGHT
 = 0x0102,

102 
	mHA_DEV_ONOFF_LIGHT_SWITCH
 = 0x0103,

103 
	mHA_DEV_DIMMER_SWITCH
 = 0x0104,

104 
	mHA_DEV_COLOR_DIMMER_SWITCH
 = 0x0105,

105 
	mHA_DEV_LIGHT_SENSOR
 = 0x0106,

106 
	mHA_DEV_OCCUPANCY_SENSOR
 = 0x0107,

107 
	mHA_DEV_ONOFF_BALLAST
 = 0x0108,

108 
	mHA_DEV_DIMMABLE_BALLAST
 = 0x0109,

109 
	mHA_DEV_ONOFF_PLUG_IN_UNIT
 = 0x010A,

110 
	mHA_DEV_DIMMANLE_PLUG_IN_UNIT
 = 0x010B,

111 
	mHA_DEV_COLOR_TEMPERATURE_LIGHT
 = 0x010C,

112 
	mHA_DEV_EXTENDED_COLOR_LIGHT
 = 0x010D,

113 
	mHA_DEV_LIGHT_LEVEL_SENSOR
 = 0x010E,

114 
	mHA_DEV_COLOR_CONTROLLER
 = 0x0800,

115 
	mHA_DEV_COLOR_SCENE_CONTROLLER
 = 0x0810,

116 
	mHA_DEV_NON_COLOR_CONTROLLER
 = 0x0820,

117 
	mHA_DEV_NON_COLOR_SCENE_CONTROLLER
 = 0x0830,

118 
	mHA_DEV_CONTROL_BRIDGE
 = 0x0840,

119 
	mHA_DEV_ONOFF_SENSOR
 = 0x0850,

121 
	mHA_DEV_SHADE
 = 0x0200,

122 
	mHA_DEV_SHADE_CTRLER
 = 0x0201,

123 
	mHA_DEV_WINDOW_COVERING_DEVICE
 = 0x0202,

124 
	mHA_DEV_WINDOW_COVERING_CTRLER
 = 0x0203,

126 
	mHA_DEV_HEATING_COOLING_UNIT
 = 0x0300,

127 
	mHA_DEV_THERMOSTAT
 = 0x0301,

128 
	mHA_DEV_TEMPERATURE_SENSOR
 = 0x0302,

129 
	mHA_DEV_PUMP
 = 0x0303,

130 
	mHA_DEV_PUMP_CTRLER
 = 0x0304,

131 
	mHA_DEV_PRESSURE_SENSOR
 = 0x0305,

132 
	mHA_DEV_FLOW_SENSOR
 = 0x0306,

134 
	mHA_DEV_IAS_CIE
 = 0x0400,

135 
	mHA_DEV_IAS_ACE
 = 0x0401,

136 
	mHA_DEV_IAS_ZONE
 = 0x0402,

137 
	mHA_DEV_IAS_WD
 = 0x0403,

145 
	mTCKEY_EXCHANGE_METHOD_APSRK
 = 0,

146 
	mTCKEY_EXCHANGE_METHOD_CBKE
 = 1,

147 
	mTCKEY_EXCHANGE_METHOD_RESV


156 
	mLINKKEY_TYPE_TC
 = 0,

157 
	mLINKKEY_TYPE_GB
 = 1,

158 
	mLINKKEY_TYPE_PRECONFIG
 = 2,

159 
	mLINKKEY_TYPE_TL_PRECONFIG
 =3

170 
	mBDB_COMMISSION_STA_SUCCESS
 = 0,

171 
	mBDB_COMMISSION_STA_IN_PROGRESS
,

172 
	mBDB_COMMISSION_STA_NOT_AA_CAPABLE
,

173 
	mBDB_COMMISSION_STA_NO_NETWORK
,

174 
	mBDB_COMMISSION_STA_TARGET_FAILURE
,

175 
	mBDB_COMMISSION_STA_FORMATION_FAILURE
,

176 
	mBDB_COMMISSION_STA_NO_IDENTIFY_QUERY_RESPONSE
,

177 
	mBDB_COMMISSION_STA_BINDING_TABLE_FULL
,

178 
	mBDB_COMMISSION_STA_NO_SCAN_RESPONSE
,

179 
	mBDB_COMMISSION_STA_NOT_PERMITTED
,

180 
	mBDB_COMMISSION_STA_TCLK_EX_FAILURE
,

182 
	mBDB_COMMISSION_STA_PARENT_LOST
,

183 
	mBDB_COMMISSION_STA_REJOIN_FAILURE
,

184 
	mBDB_COMMISSION_STA_FORMATION_DONE
,

189 
	mBDB_INIT_STATUS_SUCCESS
 = 0,

190 
	mBDB_INIT_STATUS_FAILURE
,

199 
	mBDB_ATTR_PRIMARY_CHANNEL_SET
 = 0x60,

200 
	mBDB_ATTR_SECONDARY_CHANNEL_SET
,

201 
	mBDB_ATTR_COMMISSIONING_GROUP_ID
,

202 
	mBDB_ATTR_COMMISSIONING_MODE
,

203 
	mBDB_ATTR_COMMISSIONING_STATUS
,

204 
	mBDB_ATTR_JOINING_NODE_EUI64
,

205 
	mBDB_ATTR_JOINING_NODE_TC_LNKKEY
,

206 
	mBDB_ATTR_COMMISSIONING_CAP
,

207 
	mBDB_ATTR_JOIN_USE_INSTALL_CODE_KEY
,

208 
	mBDB_ATTR_NODE_IS_ON_NETWORK
,

209 
	mBDB_ATTR_NODE_JOIN_LNKKEY_TYPE
,

210 
	mBDB_ATTR_TC_REQUIRE_KEY_EXCHANGE
,

211 
	mBDB_ATTR_SCAN_DURATION
,

212 
	mBDB_ATTR_TC_LNKKEY_EXCHANGE_ATTEMPT
,

213 
	mBDB_ATTR_TC_LNKKEY_EXCHANGE_ATTEMPT_MAX
,

214 
	mBDB_ATTR_TC_LNKKEY_EXCHANGE_METHOD
,

215 
	mBDB_ATTR_TC_NODE_JOIN_TIMEOUT


220 
	mBDB_STATE_IDLE
 = 0,

221 
	mBDB_STATE_INIT
,

222 
	mBDB_STATE_COMMISSIONING_TOUCHLINK
,

223 
	mBDB_STATE_COMMISSIONING_NETWORK_STEER
,

224 
	mBDB_STATE_COMMISSIONING_NETWORK_FORMATION
,

225 
	mBDB_STATE_COMMISSIONING_FINDORBIND
,

226 
	mBDB_STATE_COMMISSIONING_BUSY
,

227 
	mBDB_STATE_REJOIN_DONE
,

232 
	mBDB_EVT_IDLE
,

233 
	mBDB_EVT_INIT_DONE
,

234 
	mBDB_EVT_COMMISSIONING_START
,

235 
	mBDB_EVT_COMMISSIONING_TOUCHLINK_NO_RESP
,

236 
	mBDB_EVT_COMMISSIONING_TOUCHLINK_FINISH
,

237 
	mBDB_EVT_COMMISSIONING_NETWORK_STEER_PERMITJOIN
,

238 
	mBDB_EVT_COMMISSIONING_NETWORK_STEER_RETRIEVE_TCLINK_KEY
,

239 
	mBDB_EVT_COMMISSIONING_NETWORK_STEER_FINISH
,

240 
	mBDB_EVT_COMMISSIONING_NETWORK_FORMATION_PERMITJOIN
,

241 
	mBDB_EVT_COMMISSIONING_NETWORK_FORMATION_FINISH
,

242 
	mBDB_EVT_COMMISSIONING_FINDORBIND_FINISH
,

243 
	mBDB_EVT_COMMISSIONING_FINDORBIND_SIMPLE_DESC_REQ
,

252 
	mNETWORK_TYPE_DISTRIBUTED
,

253 
	mNETWORK_TYPE_CENTRALIZED
,

261 
	mBDB_COMMISSIONING_ROLE_NONE
 = 0,

262 
	mBDB_COMMISSIONING_ROLE_INITIATOR
,

263 
	mBDB_COMMISSIONING_ROLE_TARGET


271 
u8
 
	moff£t
;

272 
u8
 
	mÀn
;

273 }
	tbdb_©åTbl_t
;

281 
u8
 
	mtouchlök
:1;

282 
u8
 
	m√tw‹kSãî
:1;

283 
u8
 
	m√tw‹kF‹m©i⁄
:1;

284 
u8
 
	mfödOrBöd
:1;

285 
u8
 
	mªsv
:4;

286 }
	tbdb_commissi⁄ögMode_t
;

295 
	mBDB_NODE_COMMISSION_CAP_STEER
 = (1 << 0),

296 
	mBDB_NODE_COMMISSION_CAP_FORMATION
 = (1 << 1),

297 
	mBDB_NODE_COMMISSION_CAP_FINDORBIND
 = (1 << 2),

298 
	mBDB_NODE_COMMISSION_CAP_TOUCHLINK
 = (1 << 3),

299 }
	tbdb_nodeCommissi⁄ögC≠_e
;

308 
u32
 
	m¥im¨yCh™√lSë
;

309 
u32
 
	m£c⁄d¨yCh™√lSë
;

310 
u16
 
	mcommissi⁄ögGroupId
;

311 
bdb_commissi⁄ögMode_t
 
	mcommissi⁄ögMode
;

312 
u8
 
	mcommissi⁄ögSètus
;

313 
addrExt_t
 
	mjoöögNodeEui64
;

314 
u8
 
	mjoöögNodeNewTCLökKey
[16];

315 
bdb_nodeCommissi⁄ögC≠_e
 
	mnodeCommissi⁄ögC≠abûôy
;

316 
u8
 
	mjoöU£sIn°ÆlCodeKey
;

317 
u8
 
	mnodeIsOnANëw‹k
;

318 
u8
 
	mnodeJoöLökKeyTy≥
;

319 
u8
 
	mtcRequúeKeyExch™ge
;

320 
u8
 
	msˇnDuøti⁄
;

321 
u8
 
	mtcLökKeyExch™geAâem±s
;

322 
u8
 
	mtcLökKeyExch™geAâem±sMax
;

323 
u8
 
	mtcLökKeyExch™geMëhod
;

324 
u8
 
	mtcNodeJoöTimeout
;

325 
u8
 
	mªsv
[2];

326 }
	tbdb_©å_t
;

330 
	#FIND_BIND_QUEUE_SIZE
 5

	)

333 
u16
 
	maddr
;

334 
u8
 
	mídpoöt
;

335 
u8
 
	mªsv
;

336 }
	tfödBödD°_t
;

339 
födBödD°_t
 
	mfödBödD°Info
[
FIND_BIND_QUEUE_SIZE
];

340 
u8
 
	m‰⁄t
;

341 
u8
 
	mª¨
;

342 }
	tfödBödQ_t
;

345 (*
	tbdb_öôAµCb_t
)(
	tu8
 
	t°©us
, u8 
	tjoöedNëw‹k
);

346 (*
	tbdb_commissi⁄ögAµCb_t
)(
	tu8
 
	t°©us
, *
	t¨g
);

347 (*
	tbdb_z˛IdítifyCb_t
)(
	tu8
 
	tídpoöt
, 
	tu16
 
	t§cAddr
, u16 
	tidítifyTime
);

348 (*
	tbdb_födBödSuc˚ssCb_t
)(
	tfödBödD°_t
 *
	tpD°Info
);

355 
bdb_öôAµCb_t
 
bdbInôCb
;

356 
bdb_commissi⁄ögAµCb_t
 
bdbcommissi⁄ögCb
;

357 
bdb_z˛IdítifyCb_t
 
bdbIdítifyCb
;

358 
bdb_födBödSuc˚ssCb_t
 
bdbFödBödSuc˚ssCb
;

359 }
	tbdb_≠pCb_t
;

364 
u8
 *
key
;

365 
u8
 
keyTy≥
;

367 }
	tbdb_lökKey_t
;

370 
bdb_lökKey_t
 
tcLökKey
;

374 
bdb_lökKey_t
 
di°ribuãLökKey
;

375 
bdb_lökKey_t
 
touchLökKey
;

376 }
	tbdb_lökKey_öfo_t
;

384 
bdb_lökKey_öfo_t
 
lökKey
;

386 
u8
 
touchlökE«bÀ
;

387 
u8
 
touchlökCh™√l
;

388 
u8
 
touchlökLqiThªshﬁd
;

389 }
	tbdb_commissi⁄Sëtög_t
;

398 
af_sim∂e_des¸ùt‹_t
 *
sim∂eDesc
;

399 
bdb_commissi⁄Sëtög_t
 *
commissi⁄Sëtögs
;

401 
ev_timî_evít_t
 *
idítifyTimî
;

402 
ev_timî_evít_t
 *
ªåõveTcLkKeyTimî
;

404 
bdb_≠pCb_t
 *
bdbAµCb
;

405 
födBödQ_t
 *
pFödBödQ
;

406 
u16
 *
˛u°îLi°
;

407 
u16
 *
m©chClu°îLi°
;

408 
födBödD°_t
 
födD°Info
;

409 
födBödD°_t
 
bödD°Info
;

410 
u8
 
˛u°îNum
;

411 
u8
 
m©chClu°îNum
;

413 
u8
 
√tw‹kTy≥
;

414 
u8
 
°©e
;

415 
u8
 
°©us
;

416 
u8
 
rﬁe
;

417 
u8
 
ch™√l
;

418 
u8
 
öôed
:1;

419 
u8
 
Á˘‹yNew
:1;

420 
u8
 
ÀaveDoög
:1;

421 
u8
 
£curôyDißbÀ
:1;

422 
u8
 
ªsv
:4;

423 
u8
 
öôResu…
;

424 }
	tbdb_˘x_t
;

428 
bdb_©å_t
 
g_bdbAârs
;

429 
bdb_˘x_t
 
g_bdbCtx
;

431 
	#BDB_ATTR
(Ë
g_bdbAârs


	)

433 
	#BDB_SECUIRY_DISABLE_SET
(
v
Ëdo{ \

	)

434 
g_bdbCtx
.
£curôyDißbÀ
 = 
v
; \

435 if(
v
){
ss_ib
.
£curôyLevñ
 = 0;} \

436 {
ss_ib
.
£curôyLevñ
 = 5;} \

437 
	}

	$}whûe
(0)

439 
	#PRE_INSTALL_KEY_ENABLE
(
ty≥
Ëdo{ \

	)

440 
g_bdbAârs
.
joöU£sIn°ÆlCodeKey
 = 1; \

441 
g_bdbAârs
.
nodeJoöLökKeyTy≥
 = 
ty≥
; \

442 
	}

	$}whûe
(0)

445 
	#NODE_COMMISSIONING_CAPABILITY_SET
(
v
Ë
g_bdbAârs
.
nodeCommissi⁄ögC≠abûôy
 = v;

	)

447 
	#BDB_STATE_SET
(
v
Ë
g_bdbCtx
.
°©e
 = 
	)
v

448 
	#BDB_STATE_GET
(Ë
g_bdbCtx
.
°©e


	)

450 
	#BDB_STATUS_SET
(
v
Ë
g_bdbCtx
.
°©us
 = 
	)
v

451 
	#BDB_STATUS_GET
(Ë
g_bdbCtx
.
°©us


	)

453 
	#BDB_ATTR_GROUP_ID_SET
(
v
Ë
g_bdbAârs
.
commissi⁄ögGroupId
 = 
	)
v

465 
u8
 
	`bdb_öô
(
af_sim∂e_des¸ùt‹_t
 *
sim∂e_desc
, 
bdb_commissi⁄Sëtög_t
 *
£âög
, 
bdb_≠pCb_t
 *
cb
, u8 
ªpowî
);

475 
u8
 
	`bdb_√tw‹kF‹m©i⁄Sèπ
();

484 
u8
 
	`bdb_√tw‹kSãîSèπ
();

494 
u8
 
	`bdb_√tw‹kTouchLökSèπ
(u8 
rﬁe
);

505 
u8
 
	`bdb_födAndBödSèπ
(u8 
rﬁe
);

515 
	`bdb_födBödM©chClu°îSë
(
u8
 
˛u°îNum
, 
u16
 
˛u°îId
[]);

524 
boﬁ
 
	`bdb_addIdítifyA˘iveEpF‹FB
(
födBödD°_t
 
d°Info
);

539 
°©us_t
 
	`bdb_deÁu…Rï‹tögCfg
(
u8
 
ídpoöt
, 
u16
 
¥ofûeID
, u16 
˛u°îID
, u16 
©åID
, u16 
möRï‹tI¡
, u16 
maxRï‹tI¡
, u8 *
ªp‹èbÀCh™ge
);

549 
	`bdb_zdoSèπDevCnf
(
zdo_°¨t_devi˚_c⁄fúm_t
 *
°¨tDevCnf
);

558 
	`é_bdbAârInô
();

568 
u8
 
	`bdb_¥eIn°ÆlCodeLﬂd
(u8 *
keyTy≥
, u8 
dîivedKey
[]);

579 
	`bdb_¥eIn°ÆlCodeAdd
(
addrExt_t
 
õìAddr
, 
u8
 *
pIn°ÆlCode
);

588 
	`é_bdbRe£t
();

597 
	`é_bdbRe£t2FN
();

606 
	`bdb_ªåõveTcLökKeyD⁄e
(
u8
 
°©us
);

615 
boﬁ
 
	`bdb_isIdÀ
();

625 
	`bdb_lökKeyCfg
(
bdb_commissi⁄Sëtög_t
 *
£âög
, 
u8
 
isFa˘‹yNew
);

	@zigbee/common/includes/zb_buffer.h

24 #i‚de‡
ZB_BUFFER_H


25 
	#ZB_BUFFER_H


	)

27 
	~"é_comm⁄.h
"

31 
	#ZB_BUFFER_DEBUG
 0

	)

33 #i‡
ZB_BUFFER_DEBUG


34 
	#ZB_BUFF_DBG_NUM
 16

	)

42 
	#TL_RXPRIMITIVEHDR
 32

	)

44 
	#ZB_BUF_SIZE
 (160 + 
TL_RXPRIMITIVEHDR
)

	)

46 #i‚de‡
ZB_BUF_POOL_NUM


47 #i‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

48 
	#ZB_BUF_POOL_NUM
 36

	)

50 #ifde‡
CHIP_8269


51 
	#ZB_BUF_POOL_NUM
 36

	)

53 
	#ZB_BUF_POOL_NUM
 12

	)

64 
u8
 
	mid
;

65 
u8
 
	mh™dÀ
;

66 
s8
 
	mrssi
;

67 
u8
 
	mu£d
:1;

68 
u8
 
	mmacTxFifo
:1;

69 
u8
 
	mÀaveRejoö
:1;

70 
u8
 
	ma˘ive
:1;

71 
u8
 
	m≥ndög
:1;

72 
u8
 
	mªsvHdr
:3;

73 }
	tzb_buf_hdr_t
;

76 
u16
 
	mÆlocLöe
;

77 
u16
 
	m‰ìLöe
;

78 
u8
 
	mh™dÀr
;

79 
u8
 
	m∆meSètus
;

80 
u8
 
	mid
;

81 
u8
 
	mªsv
;

82 }
	tzb_buf_ÆlocInfo_t
;

84 
	szb_buf_s
{

85 
u8
 
	mbuf
[
ZB_BUF_SIZE
];

86 
zb_buf_hdr_t
 
	mhdr
;

87 
zb_buf_s
 *
	m√xt
;

88 
u32
 
	mÆlocC¡
;

89 
u32
 
	m‰ìC¡
;

90 #i‡
ZB_BUFFER_DEBUG


91 
zb_buf_ÆlocInfo_t
 
	mÆlocInfo
[
ZB_BUFF_DBG_NUM
];

93 }
	tzb_buf_t
 ;

96 
zb_buf_t
 *
	mhód
;

97 
u32
 
	mu£dNum
;

98 #i‡
ZB_BUFFER_DEBUG


99 
u32
 
	mrsv_fûl
[2];

101 
zb_buf_t
 
	mpoﬁ
[
ZB_BUF_POOL_NUM
];

102 }
	tzb_buf_poﬁ_t
;

104 
u8
 
RX_ZBBUF_OFFSET
;

105 
u8
 
ZB_BUF_POOL_SIZE
;

106 
zb_buf_poﬁ_t
 
g_mPoﬁ
;

109 
zb_buf_˛ór
(
zb_buf_t
 *
p
);

111 
boﬁ
 
is_zb_buf
(*
p
);

113 *
é_bufInôÆloc
(
zb_buf_t
 *
p
, 
u8
 
size
);

115 
	#TL_BUF_INITIAL_ALLOC
(
p
, 
size
, 
±r
, 
ty≥
Ëdo{ \

	)

116 (
	g±r
Ë(
ty≥
)
é_bufInôÆloc
((
p
), (
size
)); \

119 
	#TL_COPY_BUF
(
d°
, 
§c
Ëdo{ \

	)

120 
	`mem˝y
((
d°
), (
§c
), 
ZB_BUF_SIZE
 + (
zb_buf_hdr_t
) - 1); \

121 
	}

	$}whûe
(0)

127 
	`é_zbBuf„rInô
();

129 
u8
 *
	`é_phyRxBufTozbBuf
(u8 *
p
);

131 
u8
 *
	`é_zbBufToPhyRxBuf
(u8 *
p
);

133 
u8
 *
	`é_gëRxBuf
();

135 
	#TL_RXBUF_TO_INBUF
(
p
Ë
	`é_phyRxBufTozbBuf
’)

	)

136 
	#TL_INBUF_TO_RXBUF
(
p
Ë
	`é_zbBufToPhyRxBuf
’)

	)

139 #i‡
ZB_BUFFER_DEBUG


140 
zb_buf_t
 *
	`my_zb_buf_Æloˇã
(
u16
 
löe
);

141 
u8
 
	`my_zb_buf_‰ì
(
zb_buf_t
 *
buf
, 
u16
 
löe
);

143 
	#zb_buf_Æloˇã
(Ë
	`my_zb_buf_Æloˇã
(
__LINE__
)

	)

144 
	#zb_buf_‰ì
(
x
Ë
	`my_zb_buf_‰ì
(x, 
__LINE__
)

	)

146 
zb_buf_t
 *
	`zb_buf_Æloˇã
();

147 
u8
 
	`zb_buf_‰ì
(
zb_buf_t
 *
buf
);

150 
	#ZB_BUF_FROM_REF
(
ªf
Ë(&
g_mPoﬁ
.
poﬁ
[ªf])

	)

152 
	#ZB_REF_FROM_BUF
(
p
Ë’ - &
g_mPoﬁ
.
poﬁ
[0])

	)

	@zigbee/common/includes/zb_common.h

24 #i‚de‡
ZB_COMMON_H


25 
	#ZB_COMMON_H


	)

30 
	~"é_comm⁄.h
"

32 
	~"zb_c⁄fig.h
"

33 
	~"zb_li°.h
"

34 
	~"zb_buf„r.h
"

35 
	~"zb_èsk_queue.h
"

37 
	~"../../ss/£curôy_£rvi˚.h
"

38 
	~"../../mac/ö˛udes/mac_phy.h
"

39 
	~"../../mac/ö˛udes/mac_åx_≠i.h
"

40 
	~"../../mac/ö˛udes/é_zb_mac.h
"

41 
	~"../../mac/ö˛udes/é_zb_mac_pib.h
"

42 
	~"../../nwk/ö˛udes/nwk_addr_m≠.h
"

43 
	~"../../nwk/ö˛udes/nwk_√ighb‹.h
"

44 
	~"../../nwk/ö˛udes/nwk.h
"

45 
	~"../../nwk/ö˛udes/nwk_nib.h
"

46 
	~"../../nwk/ö˛udes/nwk_˘x.h
"

47 
	~"../../≠s/≠s_≠i.h
"

48 
	~"../../af/zb_af.h
"

49 
	~"../../zdo/zdp.h
"

50 
	~"../../zdo/zdo_≠i.h
"

51 
	~"../../zb≠i/zb_≠i.h
"

52 
	~"../../bdb/ö˛udes/bdb.h
"

53 
	~"../../z˛/zŒ_commissi⁄ög/z˛_touchlök_©å.h
"

54 
	~"../../gp/cGP_°ub.h
"

55 
	~"../../gp/dGP_°ub.h
"

62 
	#_CODE_MAC_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_mac")))

	)

63 
	#_CODE_NWK_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_nwk")))

	)

64 
	#_CODE_APS_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_≠s")))

	)

65 
	#_CODE_AF_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_af")))

	)

66 
	#_CODE_ZDO_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_zdo")))

	)

67 
	#_CODE_SS_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_ss")))

	)

68 
	#_CODE_BDB_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_bdb")))

	)

69 
	#_CODE_ZCL_
 
	`__©åibuã__
((
	`£˘i⁄
(".£˘_z˛")))

	)

71 
	#_CODE_MAC_


	)

72 
	#_CODE_NWK_


	)

73 
	#_CODE_APS_


	)

74 
	#_CODE_AF_


	)

75 
	#_CODE_ZDO_


	)

76 
	#_CODE_SS_


	)

77 
	#_CODE_BDB_


	)

78 
	#_CODE_ZCL_


	)

87 
	ezb_ªt_e
{

89 
	mRET_OK
 = 0,

90 
	mRET_ERROR
 ,

91 
	mRET_BLOCKED
 ,

92 
	mRET_EXIT
 ,

93 
	mRET_BUSY
 ,

94 
	mRET_EOF
 ,

95 
	mRET_OUT_OF_RANGE
 ,

96 
	mRET_EMPTY
 ,

97 
	mRET_CANCELLED
 ,

98 
	mRET_PENDING
 ,

99 
	mRET_NO_MEMORY
 ,

100 
	mRET_INVALID_PARAMETER
 ,

101 
	mRET_OPERATION_FAILED
 ,

102 
	mRET_BUFFER_TOO_SMALL
 ,

103 
	mRET_END_OF_LIST
 ,

104 
	mRET_ALREADY_EXISTS
 ,

105 
	mRET_NOT_FOUND
 ,

106 
	mRET_OVERFLOW
 ,

107 
	mRET_TIMEOUT
 ,

108 
	mRET_NOT_IMPLEMENTED
 ,

109 
	mRET_NO_RESOURCES
 ,

110 
	mRET_UNINITIALIZED
 ,

111 
	mRET_NO_SERVER
 ,

112 
	mRET_INVALID_STATE
 ,

113 
	mRET_DOES_NOT_EXIST
 ,

114 
	mRET_CONNECTION_FAILED
 ,

115 
	mRET_CONNECTION_LOST
 ,

116 
	mRET_CANCELLED_BY_USER
 ,

117 
	mRET_UNAUTHORIZED
 ,

118 
	mRET_CONFLICT
 ,

119 
	mRET_COULD_NOT_OPEN_FILE
 ,

120 
	mRET_NO_MATCH
 ,

121 
	mRET_PROTOCOL_ERROR
 ,

122 
	mRET_VERSION
 ,

123 
	mRET_MALFORMED_ADDRESS
 ,

124 
	mRET_COULD_NOT_READ_FILE
 ,

125 
	mRET_FILE_NOT_FOUND
 ,

126 
	mRET_DIRECTORY_NOT_FOUND
 ,

127 
	mRET_CONVERSION_ERROR
 ,

128 
	mRET_INCOMPATIBLE_TYPES
 ,

129 
	mRET_INCOMPATIBLE_TYPES_IN_COMPARE
 ,

130 
	mRET_INCOMPATIBLE_TYPES_IN_ASSIGNMENT
 ,

131 
	mRET_INCOMPATIBLE_TYPES_IN_EXPRESSION
 ,

132 
	mRET_ILLEGAL_COMPARE_OPERATION
 ,

133 
	mRET_FILE_CORRUPTED
 ,

134 
	mRET_PAGE_NOT_FOUND
 ,

135 
	mRET_FILE_WRITE_ERROR
 ,

136 
	mRET_FILE_READ_ERROR
 ,

137 
	mRET_FILE_PARTIAL_WRITE
 ,

138 
	mRET_TOO_MANY_OPEN_FILES
 ,

139 
	mRET_ILLEGAL_REQUEST
 ,

140 
	mRET_INVALID_BINDING
 ,

141 
	mRET_INVALID_GROUP
 ,

142 
	mRET_TABLE_FULL
 ,

143 
	mRET_NO_ACK
 ,

144 
	mRET_ACK_OK
 ,

145 
	mRET_NO_BOUND_DEVICE
 ,

146 
	mRET_BUF_FULL


147 }
	gzb_ªt_t
;

150 
	mSTART_VAR_ID
 = 0,

151 
	mMAC_PIB_ID
,

152 
	mNWK_NIB_ID
,

153 
	mAPS_AIB_ID
,

154 
	mZDO_HANDLE_ID
,

155 
	mPIB_NUM
,

159 
	mADDR_MAP_ID
 = 0,

160 
	mADDR_MAP_CTRL_ID
,

161 
	mNWK_NEIGHBOR_ID
,

162 
	mNWK_NEIGHBOR_CTRL_ID
,

163 
	mAPS_BINDING_ID
,

164 
	mAPS_BINDING_CTRL_ID
,

165 
	mAPS_GROUP_ID
,

166 
	mAPS_GROUP_CTRL_ID
,

167 
	mTAB_NUM
,

171 
	mREJOIN_INSECURITY
,

172 
	mREJOIN_SECURITY


175 
	#TL_ZB_PROFILE_ID
 1

	)

176 
	#TL_RETURN_INVALID
 0xff

	)

179 
	#ZB_TRANSCEIVER_ALL_CHANNELS_MASK
 0x07FFF800

	)

181 
	#ZB_BEACON_INTERVAL_USEC
 15360

	)

183 
	#TL_SUPERFRAMETIME_TO_US
(
n
Ë“ * 
ZB_BEACON_INTERVAL_USEC
)

	)

184 
	#TL_TIMEUS_TO_SUPEFRAMETIME
(
t
Ë— / 
ZB_BEACON_INTERVAL_USEC
)

	)

191 
	#ZB_TIME_BEACON_INTERVAL_TO_MSEC
(
t
Ë(
ZB_BEACON_INTERVAL_USEC
 / 100 * (tË/ 10)

	)

198 
	#ZB_MILLISECONDS_TO_BEACON_INTERVAL
(
ms
Ë(((10»* (msË+ 3Ë/ (
ZB_BEACON_INTERVAL_USEC
 / 100)))

	)

203 
	#ZB_TIME_ONE_SECOND
 
	`ZB_MILLISECONDS_TO_BEACON_INTERVAL
(1000)

	)

208 
	#MAGIC_IS_POWER_OF_TWO
(
x
Ë–((xË& ((xË- 1)Ë=0 )

	)

211 
	#APS_ACK_WAIT_DURATION
 (3 * 
ZB_TIME_ONE_SECOND
)

	)

213 
	#APS_POLL_AFTER_REQ_TMO
 10

	)

216 
	#SHORT_ADDR_LEN
 2

217 
	#EXT_ADDR_LEN
 8

218 
	#SRC_ID_LEN
 4

	)

219 
	#SEC_KEY_LEN
 16

	)

221 
	#TL_SETSTRUCTCONTENT
(
s
, 
v
Ë(
	`mem£t
((
u8
 *)&s, v, (s)))

	)

223 
	#COPY_U16TOBUFFER
(
buf
, 
d©a
Ëdo{ \

	)

224 ((((
	gu8
 *)
	gbuf
)[0]Ë((
u8
)
d©a
)); \

225 ((((
	gu8
 *)
	gbuf
)[1]Ë((
u8
)(
d©a
 >> 8))); \

228 
	#COPY_BUFFERTOU16
(
d©a
, 
buf
Ëdo{ \

	)

229 (
d©a
Ë(
buf
)[0] + ((buf)[1] << 8); \

230 
	}

	$}whûe
(0)

232 
	#COPY_U32TOBUFFER
(
buf
, 
d©a
Ëdo{ \

	)

233 ((((
u8
 *)
buf
)[0]Ë((u8)
d©a
)); \

234 ((((
u8
 *)
buf
)[1]Ë((u8)(
d©a
 >> 8))); \

235 ((((
u8
 *)
buf
)[2]Ë((u8)(
d©a
 >> 16))); \

236 ((((
u8
 *)
buf
)[3]Ë((u8)(
d©a
 >> 24))); \

237 
	}

	$}whûe
(0)

239 
	#COPY_U24TOBUFFER
(
buf
, 
d©a
Ëdo{ \

	)

240 ((((
u8
 *)
buf
)[0]Ë((u8)
d©a
)); \

241 ((((
u8
 *)
buf
)[1]Ë((u8)(
d©a
 >> 8))); \

242 ((((
u8
 *)
buf
)[2]Ë((u8)(
d©a
 >> 16))); \

243 
	}

	$}whûe
(0)

245 
	#COPY_BUFFERTOU16_BE
(
d©a
, 
buf
Ëdo{ \

	)

246 (
d©a
Ë(
buf
)[1] + ((buf)[0] << 8); \

247 
	}

	$}whûe
(0)

249 
	#COPY_U16TOBUFFER_BE
(
buf
, 
d©a
Ëdo{ \

	)

250 ((((
u8
 *)
buf
)[0]Ë((u8)(
d©a
 >> 8))); \

251 ((((
u8
 *)
buf
)[1]Ë((u8)
d©a
)); \

252 
	}

	$}whûe
(0)

254 
	#COPY_BUFFERTOU32_BE
(
d©a
, 
buf
Ëdo{ \

	)

255 (
d©a
Ë((
buf
)[0] << 24) + ((buf)[1] << 16) + ((buf)[2] << 8) + ((buf)[3]); \

256 
	}

	$}whûe
(0)

258 
	#COPY_U32TOBUFFER_BE
(
buf
, 
d©a
Ëdo{ \

	)

259 ((((
u8
 *)
buf
)[0]Ë((u8)(
d©a
 >> 24))); \

260 ((((
u8
 *)
buf
)[1]Ë((u8)(
d©a
 >> 16))); \

261 ((((
u8
 *)
buf
)[2]Ë((u8)(
d©a
 >> 8))); \

262 ((((
u8
 *)
buf
)[3]Ë((u8)
d©a
)); \

263 
	}

	$}whûe
(0)

265 
	#ZB_IS_16BYTE_SECURITY_KEY_ZERO
(
key
Ë(!
	`memcmp
((key), 
g_nuŒ_£curôyKey
, 
SEC_KEY_LEN
))

	)

266 
	#ZB_IS_64BIT_ADDR_ZERO
(
addr
Ë(!
	`memcmp
(◊ddr), 
g_zîo_addr
, 
EXT_ADDR_LEN
))

	)

267 
	#ZB_IS_64BIT_ADDR_INVALID
(
addr
Ë(!
	`memcmp
(◊ddr), 
g_övÆid_addr
, 
EXT_ADDR_LEN
))

	)

268 
	#ZB_64BIT_ADDR_ZERO
(
addr
Ë(
	`mem£t
(◊ddr), 0, 
EXT_ADDR_LEN
))

	)

269 
	#ZB_64BIT_ADDR_COPY
(
d°
, 
§c
Ë(
	`mem˝y
(d°, src, 
EXT_ADDR_LEN
))

	)

270 
	#ZB_64BIT_ADDR_CMP
(
⁄e
, 
two
Ë((
boﬁ
)!
	`memcmp
((⁄e), (two), 
EXT_ADDR_LEN
))

	)

272 
	#ZB_EXTPANID_IS_ZERO
 
ZB_IS_64BIT_ADDR_ZERO


	)

273 
	#ZB_EXTPANID_ZERO
 
ZB_64BIT_ADDR_ZERO


	)

274 
	#ZB_EXTPANID_COPY
 
ZB_64BIT_ADDR_COPY


	)

275 
	#ZB_EXTPANID_CMP
 
ZB_64BIT_ADDR_CMP


	)

277 
	#ZB_IEEE_ADDR_IS_ZERO
 
ZB_IS_64BIT_ADDR_ZERO


	)

278 
	#ZB_IEEE_ADDR_IS_INVALID
 
ZB_IS_64BIT_ADDR_INVALID


	)

279 
	#ZB_IEEE_ADDR_ZERO
 
ZB_64BIT_ADDR_ZERO


	)

280 
	#ZB_IEEE_ADDR_INVALID
(
addr
Ë
	`ZB_64BIT_ADDR_COPY
◊ddr, 
g_övÆid_addr
)

	)

281 
	#ZB_IEEE_ADDR_COPY
 
ZB_64BIT_ADDR_COPY


	)

282 
	#ZB_IEEE_ADDR_CMP
 
ZB_64BIT_ADDR_CMP


	)

284 
	#ZB_SEC_KEY_IS_NULL
 
ZB_IS_16BYTE_SECURITY_KEY_ZERO


	)

286 
	#ZB_MAC_FRAME_HEADER
 9

	)

287 
	#ZB_NWK_FRAME_HEADER
 (8 + 
NWK_MAX_SOURCE_ROUTE
 * 2 + 14 + 4)

	)

288 
	#ZB_APS_FRAME_HEADER
 10

	)

300 
	#MAC_CAP_ALTPANCOORD
 
	`BIT
(0)

	)

301 
	#MAC_CAP_DEVTYPE
 
	`BIT
(1)

	)

302 
	#MAC_CAP_POWERSRC
 
	`BIT
(2)

	)

303 
	#MAC_CAP_RXONIDLE
 
	`BIT
(3)

	)

304 
	#MAC_CAP_SECURITYCAP
 
	`BIT
(6)

	)

305 
	#MAC_CAP_ALLOCADDR
 
	`BIT
(7)

	)

308 
é_zb_mac_pib_t
 
macPib
;

309 
nwk_nib_t
 
nwkNib
;

310 
touchlök_©å_t
 
touchlökAâr
;

311 
bdb_©å_t
 
bdbAâr
;

312 }
	tzb_öfo_t
;

314 
zb_öfo_t
 
g_zbInfo
;

317 
	#g_zbMacPib
 
g_zbInfo
.
macPib


	)

318 
	#g_zbNIB
 
g_zbInfo
.
nwkNib


	)

319 
	#g_touchlökAâr
 
g_zbInfo
.
touchlökAâr


	)

320 
	#g_bdbAârs
 
g_zbInfo
.
bdbAâr


	)

323 c⁄° 
é_zb_mac_pib_t
 
macPibDeÁu…
;

324 c⁄° 
nwk_nib_t
 
nwkNibDeÁu…
;

325 c⁄° 
zdo_©åCfg_t
 
zdoCfgAârDeÁu…
;

327 c⁄° 
addrExt_t
 
g_zîo_addr
;

328 c⁄° 
addrExt_t
 
g_övÆid_addr
;

329 c⁄° 
u8
 
g_nuŒ_£curôyKey
[];

330 c⁄° 
u8
 
nwkKeyDeÁu…
[];

331 c⁄° 
u8
 
tcLökKeyCíåÆDeÁu…
[];

332 c⁄° 
u8
 
lökKeyDi°ribuãdCîtifiˇti⁄
[];

333 c⁄° 
u8
 
lökKeyDi°ribuãdMa°î
[];

334 c⁄° 
u8
 
touchLökKeyCîtifiˇti⁄
[];

335 c⁄° 
u8
 
touchLökKeyMa°î
[];

340 
u16
 
numbîOfRe£ts
;

341 
u16
 
≥rsi°ítMem‹yWrôes
;

343 
u32
 
macRxCrcFaû
;

344 
u32
 
macTxCˇFaû
;

345 
u32
 
macRxBˇ°
;

346 
u32
 
macTxBˇ°
;

347 
u32
 
macRxUˇ°
;

348 
u32
 
macTxUˇ°
;

349 
u16
 
macTxUˇ°Rëry
;

350 
u16
 
macTxUˇ°Faû
;

352 
u16
 
nwkTxC¡
;

353 
u16
 
nwkTxEnDe¸y±Faû
;

355 
u16
 
≠sRxBˇ°
;

356 
u16
 
≠sTxBˇ°
;

357 
u16
 
≠sRxUˇ°
;

358 
u16
 
≠sTxUˇ°Suc˚ss
;

359 
u16
 
≠sTxUˇ°Rëry
;

360 
u16
 
≠sTxUˇ°Faû
;

362 
u16
 
rouãDiscInôüãd
;

363 
u16
 
√ighb‹Added
;

364 
u16
 
√ighb‹Removed
;

365 
u16
 
√ighb‹SèÀ
;

366 
u16
 
joöIndiˇti⁄
;

367 
u16
 
chûdMoved
;

369 
u16
 
nwkFCFaûuª
;

370 
u16
 
≠sFCFaûuª
;

371 
u16
 
≠sU«uth‹izedKey
;

372 
u16
 
nwkDe¸y±Faûuªs
;

373 
u16
 
≠sDe¸y±Faûuªs
;

374 
u16
 
∑ckëBuf„rAŒoˇãFaûuªs
;

375 
u16
 
ªœyedUˇ°
;

376 
u16
 
phytoMACqueuñimôªached
;

377 
u16
 
∑ckëVÆid©eDr›Cou¡
;

379 
u8
 
œ°MesßgeLQI
;

380 
s8
 
œ°MesßgeRSSI
;

381 
u8
 
macTxIrqTimeoutC¡
;

382 
u8
 
macTxIrqC¡
;

383 
u8
 
macRxIrqC¡
;

384 
u8
 
phyLígthEº‹
;

385 
u8
 
∑nIdC⁄Êi˘
;

386 
u8
 
∑nIdModifõd
;

387 }
	tsys_dügno°ics_t
;

389 
sys_dügno°ics_t
 
g_sysDügs
;

392 
	#zb_øndom
(Ë((
u16
)
	`drv_u32R™d
())

	)

393 
	#ZB_RANDOM
(Ë
	`zb_øndom
()

	)

395 
u8
 
	`zb_öfo_lﬂd
();

396 
	`zb_öfo_ßve
(*
¨g
);

398 
	`zb_ª£t
();

399 
	`zb_öô
();

401 
	`os_öô
(
u8
 
isRëíti⁄
);

403 
boﬁ
 
	`é_°ackBusy
();

405 #i‡
ZB_ROUTER_ROLE


406 
u32
 
	`brcTønsRec‹dTblSizeGë
();

407 
nwk_brcTønsRec‹dE¡ry_t
 *
	`brcTønsRec‹dE¡ryGë
(
u8
 
idx
);

409 
boundTblM≠Li°_t
 *
	`bödTblM≠Li°Gë
();

410 
u32
 
	`zbBuf„rSizeGë
();

411 
u32
 
	`bödTblSizeGë
();

412 
u32
 
	`√ighb‹TblSizeGë
();

413 
u32
 
	`addrM≠TblSizeGë
();

	@zigbee/common/includes/zb_config.h

24 #i‚de‡
ZB_CONFIG_H


25 
	#ZB_CONFIG_H


	)

28 
	~"é_comm⁄.h
"

37 
	#ZB_STACK_PROFILE
 2

	)

39 
	#ZB_FRAME_TYPE_MASK
 0x03

	)

41 
	#ZB_PROTOCOL_VER_MASK
 0x3c

	)

42 
	#ZB_PROTOCOL_VER_POS
 2

	)

45 
	#ZB_PROTOCOL_VERSION
 2

	)

47 
	#ZB_PROTOCOL_VERSION_GP
 3

	)

51 
	#MAC_FRAME_VERSION
 
MAC_FRAME_IEEE_802_15_4_2003


	)

55 #i‚de‡
ZB_NWK_DISTRIBUTED_ADDRESS_ASSIGN


57 
	#ZB_NWK_STOCHASTIC_ADDRESS_ASSING


	)

66 
	#ZDO_PERMIT_JOIN_DURATION
 0

	)

68 
	#POLL_RATE_QUARTERSECONDS
 250

69 

	)

70 
	#POLL_NO_DATA_MAX_COUNT
 3

	)

75 
	#ZDO_NWK_SCAN_ATTEMPTS
 2

	)

79 
	#ZDO_NWK_TIME_BTWN_SCANS
 100

	)

82 
	#ZDO_NWK_INDIRECT_POLL_RATE
 4 * 
POLL_RATE_QUARTERSECONDS


83 

	)

85 
	#ZDO_MAX_PARENT_THRESHOLD_RETRY
 5

	)

88 
	#ZDO_REJOIN_TIMES
 5

	)

89 
	#ZDO_REJOIN_DURATION
 6

	)

90 
	#ZDO_REJOIN_BACKOFF_TIME
 30

	)

91 
	#ZDO_MAX_REJOIN_BACKOFF_TIME
 90

	)

92 
	#ZDO_REJOIN_BACKOFF_ITERATION
 8

	)

95 #i‡
deföed
(
MCU_CORE_8258
Ë|| deföed(
MCU_CORE_8278
Ë|| deföed(
MCU_CORE_B91
)

96 #i‡
ZB_ROUTER_ROLE


97 #i‡
ZB_COORDINATOR_ROLE


98 
	#NWK_ROUTE_RECORD_TABLE_NUM
 127

100 
	#TL_ZB_NWK_ADDR_MAP_NUM
 128

101 
	#ROUTING_TABLE_NUM
 48

103 #ñi‡
	`deföed
 (
MCU_CORE_826x
)

	)

104 #i‡
ZB_ROUTER_ROLE


105 #i‡
ZB_COORDINATOR_ROLE


106 
	#NWK_ROUTE_RECORD_TABLE_NUM
 64

	)

108 
	#TL_ZB_NWK_ADDR_MAP_NUM
 64

	)

109 
	#ROUTING_TABLE_NUM
 24

	)

114 
	#POLL_RATE
 (4 * 
POLL_RATE_QUARTERSECONDS
)

115 
	#RESPONSE_POLL_RATE
 
POLL_RATE_QUARTERSECONDS


116 
	#QUEUE_POLL_RATE
 
POLL_RATE_QUARTERSECONDS


117 
	#REJOIN_POLL_RATE
 (2 * 
POLL_RATE_QUARTERSECONDS
)

118 

	)

121 
	#CCM_KEY_SIZE
 16

	)

125 
	#SECUR_N_SECUR_MATERIAL
 2

	)

128 
	#ZB_STACK_PROFILE_2007


	)

131 
	#ZB_CCM_M
 4

	)

134 
	#APS_FRAME_SECURITY


	)

136 
	#ZB_SECURITY
 1

	)

139 #i‡
deföed
 (
MCU_CORE_826x
)

140 
	#ZB_DEFAULT_TX_POWER_IDX
 
RF_POWER_7dBm


	)

141 #ñi‡
deföed
(
MCU_CORE_8258
)

142 
	#ZB_DEFAULT_TX_POWER_IDX
 
RF_POWER_INDEX_P10p46dBm


	)

143 #ñi‡
deföed
(
MCU_CORE_8278
)

144 
	#ZB_DEFAULT_TX_POWER_IDX
 
RF_POWER_INDEX_P11p26dBm


	)

145 #ñi‡
deföed
(
MCU_CORE_B91
)

146 
	#ZB_DEFAULT_TX_POWER_IDX
 
RF_POWER_INDEX_P9p11dBm


	)

148 
	#ZB_DEFAULT_TX_POWER_IDX
 0

	)

	@zigbee/common/includes/zb_list.h

24 #i‚de‡
ZB_LIST_H


25 
	#ZB_LIST_H


	)

28 
	mZB_LIST_ACTIVE
,

29 
	mZB_LIST_FREE
,

33 
	#ZB_LIST_ADD
(
li°Name
, 
hód
, 
ñe
Ëdo{ \

	)

34 if(
	gli°Name
 =
ZB_LIST_FREE
){ \

35 (
ñe
)->
‰ìNext
 = 
hód
; \

37 (
	gñe
)->
	ga˘iveNext
 = 
hód
; \

39 
	ghód
 = 
ñe
; \

43 
	#ZB_LIST_DELETE
(
li°Name
, 
hód
, 
ñe
Ëdo{ \

	)

44 
	`__ty≥of
(
hód
Ë
li°
; \

45 
li°
 = 
hód
; \

46 if(
li°Name
 =
ZB_LIST_FREE
){ \

47 if(
ñe
 =
hód
){ \

48 
hód
 = (hód)->
‰ìNext
; \

50 
li°
->
‰ìNext
 && (li°->‰ìNexà!(
ñe
))){ \

51 
li°
 =Üi°->
‰ìNext
; \

53 if(
li°
->
‰ìNext
){ \

54 
li°
->
‰ìNext
 = 
ñe
->freeNext; \

58 if(
ñe
 =
hód
){ \

59 
hód
 = (hód)->
a˘iveNext
; \

61 
li°
->
a˘iveNext
 && (li°->a˘iveNexà!(
ñe
))){ \

62 
li°
 =Üi°->
a˘iveNext
; \

64 if(
li°
->
a˘iveNext
){ \

65 
li°
->
a˘iveNext
 = 
ñe
->activeNext; \

69 
	}

	$}whûe
(0)

	@zigbee/common/includes/zb_task_queue.h

24 #i‚de‡
ZB_TASK_QUEUE_H


25 
	#ZB_TASK_QUEUE_H


	)

29 
	#TL_ZBTASKQ_USERUSE_SIZE
 32

	)

30 
	#TL_ZBTASKQ_STACKUSE_SIZE
 16

	)

33 
	mZB_RET_OK
,

34 
	mZB_RET_OVERFLOW
,

35 }
	gzb_°a_e
;

38 
	mTL_Q_EV_TASK
 = 0,

39 
	mTL_Q_MAC2NWK
,

40 
	mTL_Q_NWK2MAC
,

41 
	mTL_Q_HIGH2NWK
,

42 
	mTL_Q_NWK2HIGH
,

43 
	mTL_Q_TYPE_MAX


55 (*
	té_zb_ˇŒback_t
)(*
	t¨g
);

58 
	sé_zb_èsk_s
{

59 
é_zb_ˇŒback_t
 
éCb
;

60 *
d©a
;

61 }
	té_zb_èsk_t
;

64 
é_zb_èsk_t
 
evt
[
TL_ZBTASKQ_USERUSE_SIZE
];

65 
u8
 
w±r
;

66 
u8
 
Ωå
;

67 }
	té_zbèskq_u£r_t
;

70 
é_zb_èsk_t
 
evt
[
TL_ZBTASKQ_STACKUSE_SIZE
];

71 
u8
 
w±r
;

72 
u8
 
Ωå
;

73 
u8
 
u£d
;

74 
u8
 
ªsv
;

75 }
	té_zbèskq_°ack_t
;

77 
	#TL_QUEUE_HAS_SPACE
(
w±r
, 
Ωå
, 
size
Ë((w±∏-Ñ±rË< (size))

	)

82 
	`zb_sched_öô
();

85 
	`é_zbTaskPro˚duª
();

94 
é_zb_èsk_t
 *
	`é_zbTaskQP›
(
u8
 
idx
,Ål_zb_èsk_à*
èskInfo
);

106 
u8
 
	`é_zbTaskQPush
(u8 
idx
, 
é_zb_èsk_t
 *
èsk
);

110 
u8
 
	`my_é_zbPrimôivePo°
(u8 
œyîQ
, u8 
¥imôive
, *
¨g
, 
u32
 
löe
, *
fûe
);

111 
	#é_zbPrimôivePo°
(
œyîQ
, 
¥imôive
, 
¨g
Ë
	`my_é_zbPrimôivePo°
÷ayîQ,Örimôive,árg, 
__LINE__
, 
__FILE__
)

	)

113 
u8
 
	`é_zbPrimôivePo°
(u8 
œyîQ
, u8 
¥imôive
, *
¨g
);

125 
u8
 
	`é_zbTaskPo°
(
é_zb_ˇŒback_t
 
func
, *
¨g
);

126 
	#TL_SCHEDULE_TASK
 
é_zbTaskPo°


	)

129 
u8
 
	`zb_isTaskD⁄e
();

130 
u8
 
	`é_zbU£rTaskQNum
();

131 
	`£c⁄dClockSt›
();

	@zigbee/common/zb_config.c

27 
	~"ö˛udes/zb_comm⁄.h
"

29 
sys_dügno°ics_t
 
	gg_sysDügs
;

37 
	#DEFAULT_PANID
 
MAC_INVALID_PANID


	)

38 
u16
 
	gTL_ZB_ASSOCJOIN_PERMIT_PANID
 = 
DEFAULT_PANID
;

44 
	#FILTER_PANID
 
MAC_INVALID_PANID


	)

45 
u16
 
	gTL_ZB_ASSOCJOIN_FILTER_PANID
 = 
FILTER_PANID
;

48 
u8
 
	gAPS_INTERFRAME_DELAY
 = 100;

49 
u8
 
	gAPS_MAX_WINDOW_SIZE
 = 1;

50 
u8
 
	gAPS_FRAGMEMT_PAYLOAD_SIZE
 = 64;

53 
u8
 
	gAPS_MAX_FRAME_RETRIES
 = 3;

54 
u8
 
	gAPS_ACK_EXPIRY
 = 2;

57 
u8
 
	gZB_BUF_POOL_SIZE
 = 
ZB_BUF_POOL_NUM
;

58 
zb_buf_poﬁ_t
 
	gg_mPoﬁ
;

61 
u8
 
	gZB_MAC_PENDING_TRANS_QUEUE_SIZE
 = 
ZB_MAC_PENDING_TRANS_QUEUE_NUM
;

62 
u8
 
	gZB_MAC_EXT_EXPEIRY_CNT
 = 
ZB_MAC_INTERNAL_EXPIRY_CNT
;

65 
u8
 
	gNWK_NEIGHBORTBL_ADD_LQITHRESHOLD
 = 0x45;

68 
u32
 
	gNWK_UNAUTH_CHILD_TABLE_LIFE_TIME
 = (5 * 1000);

71 
u32
 
	gTRANSPORT_NETWORK_KEY_WAIT_TIME
 = (2 * 1000);

74 
u8
 
	gNWK_COST_THRESHOLD_ONEHOP
 = 7;

77 
u8
 
	gNWK_NEIGHBOR_SEND_OUTGOING_THRESHOLD
 = 5;

80 
u16
 
	gTL_ZB_NWK_ADDR_MAP_SIZE
 = 
TL_ZB_NWK_ADDR_MAP_NUM
;

81 
é_zb_addr_m≠_t
 
	gg_nwkAddrM≠
;

84 
u8
 
	gTL_ZB_NEIGHBOR_TABLE_SIZE
 = 
TL_ZB_NEIGHBOR_TABLE_NUM
;

85 
u8
 
	gTL_ZB_CHILD_TABLE_SIZE
 = 
TL_ZB_CHILD_TABLE_NUM
;

86 
é_zb_√ighb‹_íåy_t
 
	gg_zb_√ighb‹Tbl
;

89 #i‡
ZB_ROUTER_ROLE


90 
u8
 
	gNWKC_TRANSFAILURE_CNT_THRESHOLD
 = 
TRANSFAILURE_CNT_MAX
;

91 
u8
 
	gNWKC_INITIAL_RREQ_RETRIES
 = 
NWK_INITIAL_RREQ_RETRIES
;

92 
u8
 
	gNWKC_RREQ_RETRIES
 = 
NWK_RREQ_RETRIES
;

93 
u16
 
	gROUTING_TABLE_SIZE
 = 
ROUTING_TABLE_NUM
;

94 #i‡(!
ROUTING_TABLE_NUM
)

95 
nwk_routögTabE¡ry_t
 
	gg_routögTab
[1];

97 
nwk_routögTabE¡ry_t
 
	gg_routögTab
[
ROUTING_TABLE_NUM
];

102 #i‡
ZB_COORDINATOR_ROLE


103 
u16
 
	gNWK_ROUTE_RECORD_TABLE_SIZE
 = 
NWK_ROUTE_RECORD_TABLE_NUM
;

104 #i‡(!
NWK_ROUTE_RECORD_TABLE_NUM
)

105 
nwk_rouãRec‹dTabE¡ry_t
 
	gg_rouãRecTab
[1];

107 
nwk_rouãRec‹dTabE¡ry_t
 
	gg_rouãRecTab
[
NWK_ROUTE_RECORD_TABLE_NUM
];

112 #i‡
ZB_ROUTER_ROLE


113 
boﬁ
 
	gNWK_BRC_PASSIVE_ACK_ENABLE
 = 
TRUE
;

114 
u8
 
	gNWK_BRC_TRANSTBL_SIZE
 = 
NWK_BRC_TRANSTBL_NUM
;

115 
nwk_brcTønsRec‹dE¡ry_t
 
	gg_brcTønsTab
[
NWK_BRC_TRANSTBL_NUM
];

118 #i‡
ZB_ED_ROLE


119 
boﬁ
 
	gAUTO_QUICK_DATA_POLL_ENABLE
 = 
TRUE
;

123 
u8
 
	gAPS_BINDING_TABLE_SIZE
 = 
APS_BINDING_TABLE_NUM
;

124 
≠s_bödög_èbÀ_t
 
	g≠s_bödög_tbl
;

127 
u8
 
	gAPS_GROUP_TABLE_SIZE
 = 
APS_GROUP_TABLE_NUM
;

128 
≠s_group_tbl_ít_t
 
	g≠s_group_tbl
[
APS_GROUP_TABLE_NUM
];

129 
u16
 
	gGROUP_MESSAGE_SEND_ADDRESS
 = 
NWK_BROADCAST_RX_ON_WHEN_IDLE
;

132 
u8
 
	gRX_ZBBUF_OFFSET
 = 
TL_RXPRIMITIVEHDR
;

135 
u8
 
	gMAC_TX_QUEUE_SIZE
 = 
TX_QUEUE_BN
;

136 
tx_d©a_queue
 
	gg_txQueue
[
TX_QUEUE_BN
];

139 
u32
 
	gLONG_UPTIME_THRESHOLD
 = 86400;

144 c⁄° 
u8
 
	gnwkKeyDeÁu…
[] = {0, 0, 0, 0, 0, 0, 0, 0,

147 c⁄° 
u8
 
	gnwkKeyDeÁu…
[] = {0x12, 0x23, 0x34, 0x45, 0x56, 0x67, 0x78, 0x89,

153 c⁄° 
u8
 
	gtcLökKeyCíåÆDeÁu…
[] = {0x5a, 0x69, 0x67, 0x42, 0x65, 0x65, 0x41, 0x6c,

158 c⁄° 
u8
 
	glökKeyDi°ribuãdCîtifiˇti⁄
[] = {0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7,

162 c⁄° 
u8
 
	gtouchLökKeyCîtifiˇti⁄
[] = {0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,

166 c⁄° 
é_zb_mac_pib_t
 
	gmacPibDeÁu…
 = {

167 .
ackWaôDuøti⁄
 = (
ZB_MAC_UNIT_BACKOFF_PERIOD
 + 
ZB_PHY_TURNROUNDTIME
 + 
ZB_PHY_SHR_DURATION
 + (
u16
)(6 * 
ZB_PHY_SYMBOLS_PER_OCTET
)),

168 .
	g‰ameRëryNum
 = 
ZB_MAC_FRAME_RETRIES_MAX
,

169 .
	gå™ß˘i⁄Pîsi°í˚Time
 = 0x01f4,

170 .
	g∑nId
 = 
DEFAULT_PANID
,

171 .
	gsh‹tAddªss
 = 
MAC_SHORT_ADDR_BROADCAST
,

172 .
	gª•WaôTime
 = 
ZB_MAC_WAIT_RESP_TIME_DEFAULT
,

173 .
	gphyCh™√lCur
 = 
DEFAULT_CHANNEL
,

174 .
	gautoReq
 = 0,

175 #i‡
ZB_ED_ROLE


176 .
	gmöBe
 = 0,

178 .
	gmöBe
 = 5,

180 .
	gmaxBe
 = 8,

181 .
	gbóc⁄Ordî
 = 15,

182 .
	gsu≥r‰ameOrdî
 = 0,

183 .
	gmaxCsmaBackoffs
 = 4,

184 .
	gassocüti⁄Pîmô
 = 0,

185 .
	gco‹dSh‹tAddªss
 = 0xffff,

186 #i‡
ZB_ED_ROLE


187 .
	grxOnWhíIdÀ
 = 
ZB_MAC_RX_ON_WHEN_IDLE
,

189 .
	grxOnWhíIdÀ
 = 1,

194 c⁄° 
nwk_nib_t
 
	gnwkNibDeÁu…
 = {

195 #i‡
deföed
 
ZB_NWK_DISTRIBUTED_ADDRESS_ASSIGN
 && deföed 
ZB_ROUTER_ROLE


196 .
maxRouãrs
 = 
NWK_MAX_ROUTERS
,

197 .
	gaddrAŒoc
 = 
NWK_ADDRESS_ALLOC_METHOD_DISTRIBUTED
,

199 .
	gaddrAŒoc
 = 
NWK_ADDRESS_ALLOC_METHOD_STOCHASTIC
,

201 .
	gmaxDïth
 = 
NWK_MAX_DEPTH
,

202 .
	g°ackProfûe
 = 
ZB_STACK_PROFILE
,

203 #ifde‡
ZB_ROUTER_ROLE


204 .
	gmaxChûdªn
 = 
DEFAULT_MAX_CHILDREN
,

205 .
	gmaxBrﬂdˇ°Rërõs
 = 
NWK_MAX_BROADCAST_RETRIES
,

206 .
	g∑ssiveAckTimeout
 = 
NWK_PASSIVE_ACK_TIMEOUT
,

207 .
	gnwkBrﬂdˇ°DñivîyTime
 = 
NWK_BROADCAST_DELIVERY_TIME
,

208 .
	glökSètusPîiod
 = 
ZB_NWK_LINK_STATUS_PEROID_DEFAULT
,

209 .
	grouãrAgeLimô
 = 3,

210 .
	gmaxSour˚Rouã
 = 
NWK_MAX_SOURCE_ROUTE
,

211 .
	gc⁄˚¡øt‹Radius
 = 0,

212 .
	gc⁄˚¡øt‹DiscovîyTime
 = 120,

213 .
	gsymLök
 = 1,

214 .
	gªp‹tC⁄°™tCo°
 = 0,

215 #ifde‡
ZB_COORDINATOR_ROLE


216 .
	gdïth
 = 0,

217 .
	gisC⁄˚¡øt‹
 = 1,

219 .
	gdïth
 = 1,

220 .
	gisC⁄˚¡øt‹
 = 0,

223 .
	gm™agîAddr
 = 0x0000,

224 .
	gÀaveReqAŒowed
 = 1,

225 .
	gu£Mu…iˇ°
 = 0,

226 .
	g∑nId
 = 
DEFAULT_PANID
,

227 .
	gnwkAddr
 = 
NWK_BROADCAST_RESERVED
,

228 .
	guniqueAddr
 = 0,

229 .
	g∑ª¡Info
 = 0,

230 .
	gídDevTimeoutDeÁu…
 = 
NWK_ENDDEV_TIMEOUT_DEFAULT
,

231 .
	gÀaveReqWôhoutRejoöAŒowed
 = 1,

235 c⁄° 
zdo_©åCfg_t
 
	gzdoCfgAârDeÁu…
 = {

236 .
c⁄fig_nwk_ödúe˘PﬁlR©e
 = 0,

237 .
	gc⁄fig_∑ª¡_lök_ªåy_thªshﬁd
 = 
ZDO_MAX_PARENT_THRESHOLD_RETRY
,

238 .
	gc⁄fig_nwk_sˇn_©ãm±s
 = 
ZDO_NWK_SCAN_ATTEMPTS
,

239 .
	gc⁄fig_nwk_time_btwn_sˇns
 = 
ZDO_NWK_TIME_BTWN_SCANS
,

240 .
	gc⁄fig_≥rmô_joö_duøti⁄
 = 
ZDO_PERMIT_JOIN_DURATION
,

241 .
	gc⁄fig_ªjoö_times
 = 
ZDO_REJOIN_TIMES
,

242 .
	gc⁄fig_ªjoö_duøti⁄
 = 
ZDO_REJOIN_DURATION
,

243 .
	gc⁄fig_ªjoö_backoff_time
 = 
ZDO_REJOIN_BACKOFF_TIME
,

244 .
	gc⁄fig_max_ªjoö_backoff_time
 = 
ZDO_MAX_REJOIN_BACKOFF_TIME
,

245 .
	gc⁄fig_ªjoö_backoff_ôî©i⁄
 = 
ZDO_REJOIN_BACKOFF_ITERATION
,

249 #i‡
ZB_ROUTER_ROLE


253 
nwk_brcTønsRec‹dE¡ry_t
 *
	$brcTønsRec‹dE¡ryGë
(
u8
 
idx
){

254  &
g_brcTønsTab
[
idx
];

255 
	}
}

260 
u32
 
	$brcTønsRec‹dTblSizeGë
(){

261  ((
g_brcTønsTab
));

262 
	}
}

268 
boundTblM≠Li°_t
 *
	$bödTblM≠Li°Gë
(){

269  &
≠s_bödög_tbl
.
BoudLi°
[0];

270 
	}
}

275 
u32
 
	$zbBuf„rSizeGë
(){

276  ((
g_mPoﬁ
));

277 
	}
}

282 
u32
 
	$bödTblSizeGë
(){

283  ((
≠s_bödög_èbÀ_t
));

284 
	}
}

289 
u32
 
	$√ighb‹TblSizeGë
(){

290  ((
é_zb_√ighb‹_íåy_t
));

291 
	}
}

296 
u32
 
	$addrM≠TblSizeGë
(){

297  ((
é_zb_addr_m≠_t
));

298 
	}
}

	@zigbee/gp/cGP_stub.h

24 #i‚de‡
CGP_STUB_H


25 
	#CGP_STUB_H


	)

30 
	#GP_APP_ID_SRC_ID
 0x00

	)

31 
	#GP_APP_ID_LPED
 0x01

	)

32 
	#GP_APP_ID_GPD
 0x02

	)

35 
	#GPD_SRC_ID_UNSPECIFIED
 0x00000000

	)

36 
	#GPD_SRC_ID_RESERVED_L
 0xFFFFFFF9

	)

37 
	#GPD_SRC_ID_RESERVED_H
 0xFFFFFFFE

	)

38 
	#GPD_SRC_ID_ALL
 0xFFFFFFFF

	)

41 
	#GP_ENDPOINT_RESERVED_L
 0xF1

	)

42 
	#GP_ENDPOINT_RESERVED_H
 0xFE

	)

43 
	#GP_ENDPOINT_ALL
 0xFF

	)

46 
	#GPD_CMD_ID_IS_INVALID
(
cmdId
Ë(((cmdIdË& 0xF0Ë=0xF0)

	)

53 
	mGP_NWK_FRAME_TYPE_DATA
 = 0,

54 
	mGP_NWK_FRAME_TYPE_MAINTENANCE
 = 1

62 
	mGP_SEC_LEVEL_NO_SECURITY
,

63 
	mGP_SEC_LEVEL_RESERVED
,

64 
	mGP_SEC_LEVEL_4BFC_4BMIC
,

65 
	mGP_SEC_LEVEL_4BFC_4BMIC_ENCRYPTION


73 
	mGP_SEC_SHARED_KEY
,

74 
	mGP_SEC_INDIVIDUAL_KEY
,

82 
u8
 
	m‰ameTy≥
:2;

83 
u8
 
	m¥ŸocﬁVî
:4;

84 
u8
 
	mautoCommissi⁄ög
:1;

85 
u8
 
	mnwkFømeCålExãnsi⁄
:1;

86 }
	tgp_nwkHdrFømeCål_t
;

93 
u8
 
	m≠pId
:3;

94 
u8
 
	m£curôyLevñ
:2;

95 
u8
 
	m£curôyKey
:1;

96 
u8
 
	mrxA·îTx
:1;

97 
u8
 
	mdúe˘i⁄
:1;

98 }
	tgp_extNwkFømeCål_t
;

105 
u32
 
	mgpdSrcId
;

106 
u32
 
	m£cFømeC¡
;

107 
gp_nwkHdrFømeCål_t
 
	mnwkFømeCål
;

108 
gp_extNwkFømeCål_t
 
	mextNwkFømeCål
;

109 
u8
 
	mídpoöt
;

110 }
	tgp_nwkHdr_t
;

121 
u8
 
	mu£CSMACA
:1;

122 
u8
 
	mu£MACACK
:1;

123 
u8
 
	mª£rved
:6;

124 }
	tcgpD©aReq_txO±_t
;

131 
u8
 *
	mgpMpdu
;

132 
u16
 
	m§cP™Id
;

133 
u16
 
	md°P™Id
;

134 
é_zb_addr_t
 
	m§cAddr
;

135 
é_zb_addr_t
 
	md°Addr
;

136 
u8
 
	m§cAddrMode
;

137 
u8
 
	md°AddrMode
;

138 
u8
 
	mgpMpduLí
;

139 
u8
 
	mgpMpduH™dÀ
;

140 
cgpD©aReq_txO±_t
 
	mtxO±i⁄s
;

141 }
	tcgp_d©a_ªq_t
;

148 
u8
 
	m°©us
;

149 
u8
 
	mgpMpduH™dÀ
;

150 }
	tcgp_d©a_˙f_t
;

152 
s32
 
cGp_d©aReq
(*
¨g
);

153 
cGp_d©aCnf
(*
¨g
);

154 
cGp_m˝sD©aInd
(*
¨g
);

	@zigbee/gp/dGP_stub.h

24 #i‚de‡
DGP_STUB_H


25 
	#DGP_STUB_H


	)

30 
	#GP_TX_QUEUE_MAX_NUM
 1

	)

31 
	#GP_DATA_IND_SEC_REQ_TAB_NUM
 4

	)

33 
	#GP_NONCE_SEC_CTRL
 0x05

	)

34 
	#GP_NONCE_SEC_CTRL_OUTGOING_APP_ID_GP
 0xc5

	)

37 
	#GP_TX_OFFSET
 20

39 
	#GP_MAX_TX_OFFSET_VARIATION
 5

41 
	#GP_TX_DURATION
 10

42 

	)

46 
	mGP_HANDLE_MIN
 = 0x70,

47 
	mGP_HANDLE_MAX
 = 0xBE,

48 
	mGP_HANDLE_CHANNEL_CONFIGURATION
 = 0xBF,

50 }
	tgp_h™dÀ_e
;

57 
u8
 *
	mgpMpdu
;

58 
u16
 
	m§cP™Id
;

59 
u16
 
	md°P™Id
;

60 
é_zb_addr_t
 
	m§cAddr
;

61 
é_zb_addr_t
 
	md°Addr
;

62 
u8
 
	m§cAddrMode
;

63 
u8
 
	md°AddrMode
;

64 
s8
 
	mrssi
;

65 
u8
 
	mlqi
;

66 
u8
 
	m£qNum
;

67 
u8
 
	mgpMpduLí
;

68 }
	tdgp_d©a_öd_t
;

77 
	mGP_DATA_IND_STATUS_SEC_SUCCESS
,

78 
	mGP_DATA_IND_STATUS_NO_SECURITY
,

79 
	mGP_DATA_IND_STATUS_CNT_FAILURE
,

80 
	mGP_DATA_IND_STATUS_AUTH_FAILURE
,

81 
	mGP_DATA_IND_STATUS_UNPROCESSED


82 }
	tgpD©aInd_°©us_t
;

89 
	mGP_SEC_KEY_TYPE_NO_KEY
 = 0x00,

90 
	mGP_SEC_KEY_TYPE_NWK_KEY
,

91 
	mGP_SEC_KEY_TYPE_GPD_GROUP_KEY
,

92 
	mGP_SEC_KEY_TYPE_NWK_KEY_DERIVED_GPD_GROUP_KEY
,

93 
	mGP_SEC_KEY_TYPE_OUT_OF_THE_BOX_GPD_KEY
,

94 
	mGP_SEC_KEY_TYPE_DERIVED_INDIVIDUAL_GPD_KEY
 = 0x07,

95 }
	tgpSecKeyTy≥_t
;

102 
u8
 *
	mgpdAsdu
;

103 
u32
 
	m§cId
;

104 
u32
 
	mgpdSecFømeC¡
;

105 
u32
 
	mmic
;

106 
é_zb_addr_t
 
	m§cAddr
;

107 
u16
 
	m§cP™Id
;

108 
boﬁ
 
	mautoCommissi⁄ög
;

109 
boﬁ
 
	mrxA·îTx
;

110 
u8
 
	m°©us
;

111 
s8
 
	mrssi
;

112 
u8
 
	mlqi
;

113 
u8
 
	m£qNum
;

114 
u8
 
	m§cAddrMode
;

115 
u8
 
	m≠pId
;

116 
u8
 
	mgpdfSecurôyLevñ
;

117 
u8
 
	mgpdfKeyTy≥
;

118 
u8
 
	mídpoöt
;

119 
u8
 
	mgpdCmdId
;

120 
u8
 
	mgpdAsduLí
;

121 
u8
 
	m‰ameTy≥
;

122 }
	tgp_d©a_öd_t
;

129 
u8
 
	mu£GpTxQueue
:1;

130 
u8
 
	mu£CSMACA
:1;

131 
u8
 
	mu£MACACK
:1;

132 
u8
 
	mtxFømeTy≥
:2;

133 
u8
 
	mtxOnM©chögEndpoöt
:1;

134 
u8
 
	mª£rved
:2;

135 }
	tgpD©aReq_txO±_t
;

142 
u8
 *
	mgpdAsdu
;

143 
u24
 
	mgpTxQueueE¡ryLi„time
;

144 
gpdId_t
 
	mgpdId
;

145 
gpD©aReq_txO±_t
 
	mtxO±i⁄s
;

146 
boﬁ
 
	ma˘i⁄
;

147 
u8
 
	m≠pId
;

148 
u8
 
	mídpoöt
;

149 
u8
 
	mgpdCmdId
;

150 
u8
 
	mgpdAsduLí
;

151 
u8
 
	mg≥pH™dÀ
;

152 }
	tgp_d©a_ªq_t
;

156 
	mGP_DATA_CNF_STATUS_TX_QUEUE_FULL
,

157 
	mGP_DATA_CNF_STATUS_ENTRY_REPLACED
,

158 
	mGP_DATA_CNF_STATUS_ENTRY_ADDED
,

159 
	mGP_DATA_CNF_STATUS_ENTRY_EXPIRED
,

160 
	mGP_DATA_CNF_STATUS_ENTRY_REMOVED
,

161 
	mGP_DATA_CNF_STATUS_GPDF_SENDING_FINALIZED


162 }
	tgpD©aCnf_°©us_t
;

169 
u8
 
	m°©us
;

170 
u8
 
	mg≥pH™dÀ
;

171 }
	tgp_d©a_˙f_t
;

178 
gpdId_t
 
	mgpdId
;

179 
u32
 
	mgpdSecFømeC¡
;

180 
u8
 
	m≠pId
;

181 
u8
 
	mídpoöt
;

182 
u8
 
	mgpdfSecurôyLevñ
;

183 
u8
 
	mgpdfKeyTy≥
;

184 
u8
 
	mdgpStubH™dÀ
;

185 }
	tgp_£c_ªq_t
;

189 
	mGP_SEC_RSP_STATUS_DROP_FRAME
,

190 
	mGP_SEC_RSP_STATUS_MATCH
,

191 
	mGP_SEC_RSP_STATUS_PASS_UNPROCESSED
,

192 
	mGP_SEC_RSP_STATUS_TX_THEN_DROP
,

193 
	mGP_SEC_RSP_ERROR


194 }
	tgpSecR•_°©us_t
;

201 
gpdId_t
 
	mgpdId
;

202 
u32
 
	mgpdSecFømeC¡
;

203 
u8
 
	m°©us
;

204 
u8
 
	mdgpStubH™dÀ
;

205 
u8
 
	m≠pId
;

206 
u8
 
	mídpoöt
;

207 
u8
 
	mgpdKey
[16];

208 
u8
 
	mgpdfSecurôyLevñ
;

209 
u8
 
	mgpdfKeyTy≥
;

210 }
	tgp_£c_r•_t
;

217 
u8
 *
	mgpdCmdPaylﬂd
;

218 
u8
 
	mgpdCmdId
;

219 }
	tgp_≠pPaylﬂd_t
;

226 
gp_d©a_ªq_t
 *
	mbuf
;

227 
u8
 
	mg≥pH™dÀ
;

228 
u8
 
	mu£d
;

229 }
	tgp_d©a_ªq_≥ndög_t
;

236 
gp_d©a_öd_t
 *
	mbuf
;

237 
u8
 
	mtimeout
;

238 
u8
 
	mdGpStubH™dÀ
;

239 
u8
 
	mgpdfSecKey
:1;

240 
u8
 
	mgpdfSecLevñ
:2;

241 
u8
 
	mu£d
:1;

242 
u8
 
	mª£rved
:4;

243 }
	tgp_d©a_öd_íåy_t
;

246 
	$u8
 (*
	tgpDevi˚A¬oun˚CheckCb_t
)(
	tu16
 
	tsökNwkAddr
, 
	taddrExt_t
 
	tsökIìeAddr
);

251 (*
	tgpD©aCnfCb_t
)(
	tgp_d©a_˙f_t
 
	tgpD©aCnf
);

252 (*
	tgpD©aIndCb_t
)(*
	t¨g
);

253 (*
	tgpSecReqCb_t
)(*
	t¨g
);

257 
gpD©aCnfCb_t
 
gpD©aCnfCb
;

258 
gpD©aIndCb_t
 
gpD©aIndCb
;

259 
gpSecReqCb_t
 
gpSecReqCb
;

260 }
	tgp_ïCb_t
;

264 
gp_d©a_öd_íåy_t
 
g_gpD©aIndSecReqTab
[];

267 
	`gpStubCbInô
(
gp_ïCb_t
 *
cb
);

268 
	`gpTxQueueFªe
();

269 
	`gpD©aIndSecReqE¡ryCÀ¨
(
gp_d©a_öd_íåy_t
 *
pE¡ry
);

270 
u8
 
	`dGpStubH™dÀGë
();

271 
gp_d©a_öd_íåy_t
 *
	`gpD©aIndGë
(
u8
 
h™dÀ
);

273 
	`gpD©aReq
(*
¨g
);

274 
	`gpSecR•
(*
¨g
);

275 
	`dGp_d©aInd
(*
¨g
);

276 
	`cGpD©aCnfH™dÀr
(*
¨g
);

	@zigbee/gp/gp.c

27 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

28 
	~"../z˛/z˛_ö˛ude.h
"

29 
	~"gp.h
"

33 #i‡
GP_SUPPORT_ENABLE


37 c⁄° 
u8
 
	gg_gpSh¨edKey
[
SEC_KEY_LEN
] = 
GP_SHARED_KEY
;

52 
gp_≠pCb_t
 *
	ggpAµCb
 = 
NULL
;

62 
gpCommissi⁄ögWödowTimeoutSt›
();

73 
	$gp_öô
()

76 
	`gpStubInô
();

79 
	`af_ídpoötRegi°î
(
GREEN_POWER_ENDPOINT
, (
af_sim∂e_des¸ùt‹_t
 *)&
gp_sim∂eDesc
, 
z˛_rx_h™dÀr
, 
NULL
);

82 
	`z˛_ªgi°î
(
GREEN_POWER_ENDPOINT
, 
GP_CB_CLUSTER_NUM
, (
z˛_•ecClu°îInfo_t
 *)
g_gpClu°îLi°
);

84 
	`gp_ProxyTabInô
();

86 
	`COPY_U24TOBUFFER
(
z˛GpAâr_gµFunc
, 
GPP_FUNCTIONALITY
);

87 
	`COPY_U24TOBUFFER
(
z˛GpAâr_gµA˘iveFunc
, 
GPP_ACTIVE_FUNCTIONALITY
);

91 
	}
}

102 
	$gp_ªgi°îAµCb
(
gp_≠pCb_t
 *
cb
)

104 
gpAµCb
 = 
cb
;

105 
	}
}

115 
u16
 
	ggpComWödowC¡
 = 0;

116 
	$gpCommissi⁄ögWödowTimeoutSt›
()

120 if(
g_gpCtx
.
commissi⁄ögWödowTimeoutEvt
){

121 
gpComWödowC¡
 = 0;

122 
	`TL_ZB_TIMER_CANCEL
(&
g_gpCtx
.
commissi⁄ögWödowTimeoutEvt
);

124 
	}
}

126 
s32
 
	$gpCommissi⁄ögWödowTimeoutCb
(*
¨g
)

128 
u16
 
timeout
 = (u16)((
u32
)
¨g
);

130 if(++
gpComWödowC¡
 >
timeout
){

131 
gpComWödowC¡
 = 0;

135 
	`gpExôCommissi⁄ögMode
();

138 if(
gpAµCb
 && gpAµCb->
gpCommissi⁄ögModeCb
){

139 
gpAµCb
->
	`gpCommissi⁄ögModeCb
(
g_gpCtx
.
gpInCommMode
);

142 
g_gpCtx
.
commissi⁄ögWödowTimeoutEvt
 = 
NULL
;

147 
	}
}

149 
°©us_t
 
	$gp_¥oxyTabE¡ryUpd©e
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
z˛_gp_∑úögCmd_t
 *
pCmd
)

151 if(
pCmd
->
›ti⁄s
.
bôs
.
addSök
){

152 if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
){

153 if(
	`lwSökAddrLi°Add
(
pE¡ry
, 
pCmd
->
sökIìeAddr
,ÖCmd->
sökNwkAddr
Ë=
FAILURE
){

154  
ZCL_STA_INSUFFICIENT_SPACE
;

156 }if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
){

157 
u16
 
Æüs
 = 
pCmd
->
›ti⁄s
.
bôs
.
assig√dAlüsPª£¡
 ?ÖCmd->
assig√dAlüs
 : 
	`gpAlüsSrcAddrDîived
’Cmd->›ti⁄s.bôs.
≠pId
,ÖCmd->
gpdId
);

158 if(
	`sökGroupLi°Add
(
pE¡ry
, 
pCmd
->
sökGroupID
, 
Æüs
Ë=
FAILURE
){

159  
ZCL_STA_INSUFFICIENT_SPACE
;

161 }if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_DGROUPID
){

162 
pE¡ry
->
›ti⁄s
.
bôs
.
assig√dAlüs
 = 
pCmd
->›ti⁄s.bôs.
assig√dAlüsPª£¡
;

163 
pE¡ry
->
gpdAssig√dAlüs
 = 
pCmd
->
assig√dAlüs
;

166 if(!
pE¡ry
->
u£d
){

167 
pE¡ry
->
u£d
 = 1;

168 
g_gpProxyTab
.
gpProxyTabNum
++;

171 
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 = 
pCmd
->options.bits.appId;

172 
pE¡ry
->
›ti⁄s
.
bôs
.
íåyA˘ive
 = 
TRUE
;

173 
pE¡ry
->
›ti⁄s
.
bôs
.
íåyVÆid
 = 
TRUE
;

174 
pE¡ry
->
›ti⁄s
.
bôs
.
£qNumC≠
 |
pCmd
->›ti⁄s.bôs.
gpdMacSeqNumC≠
;

175 
pE¡ry
->
›ti⁄s
.
bôs
.
lightWeightUniˇ°GPS
 |(
pCmd
->›ti⁄s.bôs.
commMode
 =
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
Ë? 
TRUE
 : 
FALSE
;

176 
pE¡ry
->
›ti⁄s
.
bôs
.
dîivedGroupGPS
 |(
pCmd
->›ti⁄s.bôs.
commMode
 =
GPS_COMM_MODE_GROUP_DGROUPID
Ë? 
TRUE
 : 
FALSE
;

177 
pE¡ry
->
›ti⁄s
.
bôs
.
commGroupGPS
 |(
pCmd
->›ti⁄s.bôs.
commMode
 =
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
Ë? 
TRUE
 : 
FALSE
;

178 
pE¡ry
->
›ti⁄s
.
bôs
.
fú°ToF‹w¨d
 = 
FALSE
;

179 
pE¡ry
->
›ti⁄s
.
bôs
.
öR™ge
 = 
FALSE
;

180 
pE¡ry
->
›ti⁄s
.
bôs
.
gpdFixed
 |
pCmd
->›ti⁄s.bôs.gpdFixed ? 
TRUE
 : 
FALSE
;

181 
pE¡ry
->
›ti⁄s
.
bôs
.
hasAŒUniˇ°Rouãs
 |(
pCmd
->›ti⁄s.bôs.
commMode
 =
GPS_COMM_MODE_FULL_UNICAST
Ë? 
TRUE
 : 
FALSE
;

183 
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
 = (
pCmd
->›ti⁄s.bôs.
£cLevñ
 > 1Ë? 
TRUE
 : 
FALSE
;

184 
pE¡ry
->
›ti⁄s
.
bôs
.
›tsExãnsi⁄
 = 
FALSE
;

185 if(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

186 
pE¡ry
->
gpdId
.
§cId
 = 
pCmd
->gpdId.srcId;

187 }if(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

188 
	`ZB_64BIT_ADDR_COPY
(
pE¡ry
->
gpdId
.
gpdIìeAddr
, 
pCmd
->gpdId.gpdIeeeAddr);

190 
pE¡ry
->
ídpoöt
 = 
pCmd
->endpoint;

192 
pE¡ry
->
£cO±i⁄s
.
bôs
.
£cLevñ
 = 
pCmd
->
›ti⁄s
.bits.secLevel;

193 
pE¡ry
->
£cO±i⁄s
.
bôs
.
£cKeyTy≥
 = 
pCmd
->
›ti⁄s
.bits.secKeyType;

194 
pE¡ry
->
gpdSecFømeC¡
 = 
pCmd
->gpdSecFrameCnt;

195 
	`mem˝y
(
pE¡ry
->
gpdKey
, 
pCmd
->gpdKey, 
SEC_KEY_LEN
);

196 
pE¡ry
->
groupˇ°Radius
 = 
pCmd
->
›ti⁄s
.
bôs
.
groupˇ°RadiusPª£¡
 ?ÖCmd->groupcastRadius :ÖEntry->groupcastRadius;

197 
pE¡ry
->
£¨chC¡
 = 0;

199 if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
){

200 if(
	`lwSökAddrLi°Remove
(
pE¡ry
, 
pCmd
->
sökIìeAddr
,ÖCmd->
sökNwkAddr
Ë=
FAILURE
){

201  
ZCL_STA_NOT_FOUND
;

203 }if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
){

204 if(
	`sökGroupLi°Remove
(
pE¡ry
, 
pCmd
->
sökGroupID
Ë=
FAILURE
){

205  
ZCL_STA_NOT_FOUND
;

209 if((
pE¡ry
->
lwSökC¡
 =0Ë&& (pE¡ry->
sökGroupC¡
 =0Ë&& !pE¡ry->
›ti⁄s
.
bôs
.
dîivedGroupGPS
){

210 
	`gp_¥oxyTabE¡ryCÀ¨
(
pE¡ry
);

214  
ZCL_STA_SUCCESS
;

215 
	}
}

217 
°©us_t
 
	$gp_∑úögUpd©eProxyTab
(
z˛_gp_∑úögCmd_t
 *
pCmd
)

219 
gpProxyTabE¡ry_t
 *
pE¡ry
 = 
	`gp_gëProxyTabByGpdId
(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
,ÖCmd->
gpdId
);

221 if(
pCmd
->
›ti⁄s
.
bôs
.
ªmoveGPD
){

222 if(
pE¡ry
){

223 
	`gp_¥oxyTabE¡ryCÀ¨
(
pE¡ry
);

224  
ZCL_STA_SUCCESS
;

226  
ZCL_STA_NOT_FOUND
;

229 if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_FULL_UNICAST
){

231  
ZCL_STA_INVALID_FIELD
;

234 if(
pCmd
->
›ti⁄s
.
bôs
.
£cLevñ
 =
GP_SEC_LEVEL_RESERVED
){

235  
ZCL_STA_INVALID_FIELD
;

239 if(!
pE¡ry
){

240 if(
pCmd
->
›ti⁄s
.
bôs
.
addSök
){

241 
pE¡ry
 = 
	`gp_¥oxyTabE¡ryFªeGë
();

242 if(!
pE¡ry
){

243  
ZCL_STA_INSUFFICIENT_SPACE
;

246  
ZCL_STA_NOT_FOUND
;

250  
	`gp_¥oxyTabE¡ryUpd©e
(
pE¡ry
, 
pCmd
);

251 
	}
}

262 
°©us_t
 
	$gpPaúögCmdPro˚ss
(
z˛_gp_∑úögCmd_t
 *
pCmd
)

264 
°©us_t
 
°©us
 = 
	`gp_∑úögUpd©eProxyTab
(
pCmd
);

266 if(
°©us
 =
ZCL_STA_SUCCESS
){

269 
	`gpProxyTabUpd©e
();

271 if(
g_gpCtx
.
gpCommissi⁄ögModeO±
.
bôs
.
exôMode
 & 
EXIT_ON_FIRST_PAIRING_SUCCESS
){

272 
	`gpCommissi⁄ögWödowTimeoutSt›
();

273 
	`gpExôCommissi⁄ögMode
();

276 if(
gpAµCb
 && gpAµCb->
gpCommissi⁄ögModeCb
){

277 
gpAµCb
->
	`gpCommissi⁄ögModeCb
(
g_gpCtx
.
gpInCommMode
);

284 if–(
	`NIB_NETWORK_ADDRESS
(Ë=
	`gpAlüsSrcAddrDîived
(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
,ÖCmd->
gpdId
)) ||

285 (
	`NIB_NETWORK_ADDRESS
(Ë=
pCmd
->
assig√dAlüs
) ){

286 
	`é_zbNwkAddrC⁄Êi˘SètusSíd
(
NWK_BROADCAST_RX_ON_WHEN_IDLE
, 
	`NIB_NETWORK_ADDRESS
(), 
TRUE
);

288 
	`NIB_NETWORK_ADDRESS
(Ë
g_zbMacPib
.
sh‹tAddªss
 = 
	`é_zbNwkStocha°icAddrCÆ
();

290 
	`zb_zdoSídDevA¬™˚
();

293  
°©us
;

294 
	}
}

305 
	$gpProxyTabReqCmdPro˚ss
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
z˛_gp_¥oxyTabReqCmd_t
 *
pCmd
)

307 
ïInfo_t
 
d°EpInfo
;

308 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

310 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

311 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

312 
d°EpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

313 
d°EpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

315 
z˛_gp_¥oxyTabR•Cmd_t
 
¥oxyTabR•Cmd
;

316 
	`TL_SETSTRUCTCONTENT
(
¥oxyTabR•Cmd
, 0);

318 
u8
 *
pBuf
 = 
NULL
;

320 
¥oxyTabR•Cmd
.
tŸÆTabE¡rõs
 = 
	`gp_gëProxyTabE¡ryTŸÆNum
();

322 if(
¥oxyTabR•Cmd
.
tŸÆTabE¡rõs
 == 0){

323 
¥oxyTabR•Cmd
.
°©us
 = 
ZCL_STA_NOT_FOUND
;

324 
¥oxyTabR•Cmd
.
°¨tIdx
 = (
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_GPD_ID
Ë? 0xFF :ÖCmd->
ödex
;

325 
¥oxyTabR•Cmd
.
íåõsC¡
 = 0;

326 
¥oxyTabR•Cmd
.
íåõsLí
 = 0;

328 
	`z˛_gp_¥oxyTabÀR•CmdSíd
(
GREEN_POWER_ENDPOINT
, &
d°EpInfo
, 
TRUE
, 
pAddrInfo
->
£qNum
, &
¥oxyTabR•Cmd
);

332 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_GPD_ID
){

333 
gpProxyTabE¡ry_t
 *
pE¡ry
 = 
	`gp_gëProxyTabByGpdId
(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
,ÖCmd->
gpdId
);

334 if(
pE¡ry
){

335 
u8
 
Àn
 = 
	`gp_gëProxyTabE¡ryLí
(
pE¡ry
);

336 
pBuf
 = (
u8
 *)
	`ev_buf_Æloˇã
(
Àn
);

337 if(!
pBuf
){

341 
	`gp_buûdProxyTabE¡ryF‹m©
(
pE¡ry
, 
pBuf
);

343 
¥oxyTabR•Cmd
.
°©us
 = 
ZCL_STA_SUCCESS
;

344 
¥oxyTabR•Cmd
.
°¨tIdx
 = 0xFF;

345 
¥oxyTabR•Cmd
.
íåõsC¡
 = 1;

346 
¥oxyTabR•Cmd
.
íåõsLí
 = 
Àn
;

347 
¥oxyTabR•Cmd
.
¥oxyTabE¡ry
 = 
pBuf
;

349 
¥oxyTabR•Cmd
.
°©us
 = 
ZCL_STA_NOT_FOUND
;

350 
¥oxyTabR•Cmd
.
°¨tIdx
 = 0xFF;

351 
¥oxyTabR•Cmd
.
íåõsC¡
 = 0;

352 
¥oxyTabR•Cmd
.
íåõsLí
 = 0;

354 }if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

355 
¥oxyTabR•Cmd
.
°©us
 = 
ZCL_STA_SUCCESS
;

356 
¥oxyTabR•Cmd
.
°¨tIdx
 = 
pCmd
->
ödex
;

358 
u8
 
íåyLí
 = 0;

359 
u8
 
maxE¡ryLí
 = 0;

360 
u8
 
a˘iveE¡ryC¡
 = 0;

362 
u8
 
i
 = 0; i < 
z˛GpAâr_gµMaxProxyTabE¡rõs
; i++){

363 
maxE¡ryLí
 = 
íåyLí
;

365 if(
g_gpProxyTab
.
gpProxyTab
[
i
].
u£d
){

366 
a˘iveE¡ryC¡
++;

368 if(
pCmd
->
ödex
 <
a˘iveE¡ryC¡
 - 1){

369 
íåyLí
 +
	`gp_gëProxyTabE¡ryLí
(&
g_gpProxyTab
.
gpProxyTab
[
i
]);

371 if(
íåyLí
 >
ZCL_GP_MAX_PROXY_TABLE_ATTR_LEN
){

372 
íåyLí
 = 
maxE¡ryLí
;

375 
¥oxyTabR•Cmd
.
íåõsC¡
++;

381 
a˘iveE¡ryC¡
 = 0;

382 
¥oxyTabR•Cmd
.
íåõsLí
 = 
íåyLí
;

384 
u8
 
íåõsC¡
 = 
¥oxyTabR•Cmd
.entriesCnt;

386 if(
íåyLí
){

387 
pBuf
 = (
u8
 *)
	`ev_buf_Æloˇã
(
íåyLí
);

388 if(!
pBuf
){

392 
u8
 *
±r
 = 
pBuf
;

394 
u8
 
i
 = 0; i < 
z˛GpAâr_gµMaxProxyTabE¡rõs
; i++){

395 if(
g_gpProxyTab
.
gpProxyTab
[
i
].
u£d
){

396 
a˘iveE¡ryC¡
++;

398 if(
pCmd
->
ödex
 <
a˘iveE¡ryC¡
 - 1){

399 if(
íåõsC¡
){

400 
±r
 +
	`gp_buûdProxyTabE¡ryF‹m©
(&
g_gpProxyTab
.
gpProxyTab
[
i
],Ötr);

401 
íåõsC¡
--;

409 
¥oxyTabR•Cmd
.
¥oxyTabE¡ry
 = 
pBuf
;

413 
	`z˛_gp_¥oxyTabÀR•CmdSíd
(
GREEN_POWER_ENDPOINT
, &
d°EpInfo
, 
TRUE
, 
pAddrInfo
->
£qNum
, &
¥oxyTabR•Cmd
);

415 if(
pBuf
){

416 
	`ev_buf_‰ì
(
pBuf
);

418 
	}
}

429 
	$gpProxyCommissi⁄ögModeCmdPro˚ss
(
u16
 
§cAddr
, 
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *
pCmd
)

431 if(
g_gpCtx
.
gpInCommMode
 && (g_gpCtx.
gpCommissi⁄îAddr
 !
§cAddr
)){

439 if(
pCmd
->
›ti⁄s
.
bôs
.
a˘i⁄
){

440 
g_gpCtx
.
gpCommissi⁄ögModeO±
 = 
pCmd
->
›ti⁄s
;

441 
g_gpCtx
.
gpCommissi⁄îAddr
 = 
§cAddr
;

442 
g_gpCtx
.
gpInCommMode
 = 
TRUE
;

444 if(
pCmd
->
›ti⁄s
.
bôs
.
commWödowPª£¡
){

445 
g_gpCtx
.
gpCommissi⁄ögWödow
 = 
pCmd
->
commissi⁄ögWödow
;

448 if(
pCmd
->
›ti⁄s
.
bôs
.
ch™√lPª£¡
){

454 if(!
g_gpCtx
.
commissi⁄ögWödowTimeoutEvt
){

455 
gpComWödowC¡
 = 0;

456 
g_gpCtx
.
commissi⁄ögWödowTimeoutEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
gpCommissi⁄ögWödowTimeoutCb
, (*)((
u32
)g_gpCtx.
gpCommissi⁄ögWödow
), 1000);

458 
gpComWödowC¡
 = 0;

461 
	`gpCommissi⁄ögWödowTimeoutSt›
();

462 
	`gpExôCommissi⁄ögMode
();

466 if(
gpAµCb
 && gpAµCb->
gpCommissi⁄ögModeCb
){

467 
gpAµCb
->
	`gpCommissi⁄ögModeCb
(
g_gpCtx
.
gpInCommMode
);

469 
	}
}

480 
	$gpRe•⁄£CmdPro˚ss
(
z˛_gp_ª•⁄£Cmd_t
 *
pCmd
)

484 
gp_d©a_ªq_t
 
gpD©aReq
;

485 
	`TL_SETSTRUCTCONTENT
(
gpD©aReq
, 0);

487 if(
pCmd
->
ãmpMa°îSh‹tAddr
 =
	`NWK_NIB
().
nwkAddr
){

488 
g_gpCtx
.
fú°ToF‹w¨d
 = 
TRUE
;

489 
gpD©aReq
.
a˘i⁄
 = 
TRUE
;

491 
g_gpCtx
.
fú°ToF‹w¨d
 = 
FALSE
;

492 
gpD©aReq
.
a˘i⁄
 = 
FALSE
;

495 if(
pCmd
->
gpdCmdID
 =
GP_CHANNEL_CONFIGURATION_COMMAND_ID
){

496 
gpD©aReq
.
g≥pH™dÀ
 = 
GP_HANDLE_CHANNEL_CONFIGURATION
;

498 
gpD©aReq
.
g≥pH™dÀ
 = 
	`dGpStubH™dÀGë
();

500 
gpD©aReq
.
txO±i⁄s
.
u£GpTxQueue
 = 1;

501 
gpD©aReq
.
txO±i⁄s
.
txOnM©chögEndpoöt
 = 
pCmd
->
›ti⁄s
.
bôs
.
å™smôOnEndpoötM©ch
;

502 
gpD©aReq
.
≠pId
 = 
pCmd
->
›ti⁄s
.
bôs
.appId;

503 
	`mem˝y
((
u8
 *)&
gpD©aReq
.
gpdId
, (u8 *)&
pCmd
->gpdId, (
gpdId_t
));

504 
gpD©aReq
.
ídpoöt
 = 
pCmd
->endpoint;

505 
gpD©aReq
.
gpdCmdId
 = 
pCmd
->
gpdCmdID
;

506 
gpD©aReq
.
gpdAsduLí
 = 
pCmd
->
∑ylﬂdLí
;

507 
gpD©aReq
.
gpdAsdu
 = 
pCmd
->
pGpdCmdPaylﬂd
;

509 if(
gpD©aReq
.
a˘i⁄
){

510 if(
pCmd
->
gpdCmdID
 =
GP_CHANNEL_CONFIGURATION_COMMAND_ID
){

511 
gpd_ch™√lC⁄figuøti⁄Cmd_∑ylﬂd_t
 
ch™√l
;

512 
	`TL_SETSTRUCTCONTENT
(
ch™√l
, 0);

514 
ch™√l
.ch™√»*(
pCmd
->
pGpdCmdPaylﬂd
);

516 
	`gpSwôchToTønsmôCh™√l
(
ch™√l
, 
pCmd
->
ãmpMa°îTxCh™√l
);

520 
	`gpTønimôGPDF
(&
gpD©aReq
);

521 
	}
}

532 
°©us_t
 
	$z˛_gpCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

534 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

536 if(
pAddrInfo
->
d°Ep
 =
GREEN_POWER_ENDPOINT
){

537 if(
pAddrInfo
->
dúClu°î
 =
ZCL_FRAME_SERVER_CLIENT_DIR
){

538 
cmdId
){

539 
ZCL_CMD_GP_PAIRING
:

540 
°©us
 = 
	`gpPaúögCmdPro˚ss
((
z˛_gp_∑úögCmd_t
 *)
cmdPaylﬂd
);

542 
ZCL_CMD_GP_PROXY_COMMISSIONING_MODE
:

543 
	`gpProxyCommissi⁄ögModeCmdPro˚ss
(
pAddrInfo
->
§cAddr
, (
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *)
cmdPaylﬂd
);

545 
ZCL_CMD_GP_RESPONSE
:

546 
	`gpRe•⁄£CmdPro˚ss
((
z˛_gp_ª•⁄£Cmd_t
 *)
cmdPaylﬂd
);

548 
ZCL_CMD_GP_PROXY_TABLE_REQUEST
:

549 
	`gpProxyTabReqCmdPro˚ss
(
pAddrInfo
, (
z˛_gp_¥oxyTabReqCmd_t
 *)
cmdPaylﬂd
);

552 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

556 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

560  
°©us
;

561 
	}
}

	@zigbee/gp/gp.h

24 #i‚de‡
GP_H


25 
	#GP_H


	)

30 
	#GREEN_POWER_ENDPOINT
 0xF2

31 

	)

33 
	#GP_ZB_PROTOCOL_VERSION
 0x03

	)

36 
	#GP_SHARED_KEY
 { 0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7,\

	)

41 
	#GP_DUPLICATE_TIMEOUT_DEFAULT
 2

42 

	)

44 
	#GPP_COMMISSIONING_WINDOW_DEFAULT
 180

45 

	)

47 
	#GP_TRANSMIT_CHANNEL_TIMEOUT
 5

48 

	)

75 
	#GPP_FUNCTIONALITY
 0x09AC2F

76 

	)

102 
	#GPS_FUNCTIONALITY
 0x09AE2F

103 

	)

105 
	#GPP_ACTIVE_FUNCTIONALITY
 0xFFFFFF

	)

106 
	#GPS_ACTIVE_FUNCTIONALITY
 0xFFFFFF

	)

109 
	#GPP_MAX_PROXY_TABLE_ENTRIES
 0x05

	)

110 
	#GPS_MAX_SINK_TABLE_ENTRIES
 0x05

	)

118 
u8
 
	mch™√l
;

121 
u8
 
	m›î©i⁄Ch™√l
:4;

122 
u8
 
	mbasic
:1;

123 
u8
 
	mª£rved
:3;

124 }
	mbôs
;

125 }
	tgpd_ch™√lC⁄figuøti⁄Cmd_∑ylﬂd_t
;

132 
ïInfo_t
 
	md°EpInfo
;

134 
z˛_gp_nŸifiˇti⁄Cmd_t
 
	mgpNŸifiˇti⁄Cmd
;

135 
z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
 
	mgpCommissi⁄ögNŸifiˇti⁄Cmd
;

137 }
	tgp_nŸi_t
;

142 
	$boﬁ
 (*
	tgpCh™gÀCh™√lReqCb_t
)();

143 (*
	tgpCommissi⁄ögModeCb_t
)(
	tboﬁ
 
	tisCommissi⁄ögMode
);

147 
gpCh™gÀCh™√lReqCb_t
 
gpCh™gÀCh™√lReqCb
;

148 
gpCommissi⁄ögModeCb_t
 
gpCommissi⁄ögModeCb
;

149 }
	tgp_≠pCb_t
;

157 
gpProxyTabE¡ry_t
 
gpProxyTab
[
GPP_MAX_PROXY_TABLE_ENTRIES
];

158 
u8
 
gpProxyTabNum
;

159 }
	tgp_¥oxyTab_t
;

166 
ev_timî_evít_t
 *
å™smôCh™√lTimeoutEvt
;

167 
ev_timî_evít_t
 *
ÆüsC⁄Êi˘TimeoutEvt
;

168 
ev_timî_evít_t
 *
commissi⁄ögWödowTimeoutEvt
;

169 
u16
 
gpAlüsC⁄Êi˘Addr
;

170 
u16
 
gpCommissi⁄îAddr
;

171 
u16
 
gpCommissi⁄ögWödow
;

172 
gpProxyCommModeO±_t
 
gpCommissi⁄ögModeO±
;

173 
u8
 
gpInCommMode
;

174 
u8
 
gpDu∂iˇãTimeout
;

175 
u8
 
gpO≥øti⁄ÆCh™√l
;

176 
boﬁ
 
fú°ToF‹w¨d
;

177 }
	tgp_˘x_t
;

183 
gp_˘x_t
 
g_gpCtx
;

184 
gp_¥oxyTab_t
 
g_gpProxyTab
;

190 
u8
 
z˛GpAâr_gµMaxProxyTabE¡rõs
;

191 
u16
 
z˛GpAâr_˛u°îRev
;

192 
u8
 
z˛GpAâr_¥oxyTabE¡ry
[];

193 
u8
 
z˛GpAâr_gµFunc
[];

194 
u8
 
z˛GpAâr_gµA˘iveFunc
[];

196 
u8
 
z˛GpAâr_gpSh¨edSecKeyTy≥
;

197 
u8
 
z˛GpAâr_gpSh¨edSecKey
[];

198 
u8
 
z˛GpAâr_gpLökKey
[];

200 
u8
 
GP_CB_CLUSTER_NUM
;

201 c⁄° 
z˛_•ecClu°îInfo_t
 
g_gpClu°îLi°
[];

202 c⁄° 
af_sim∂e_des¸ùt‹_t
 
gp_sim∂eDesc
;

206 
	`gp_öô
();

207 
	`gp_ªgi°îAµCb
(
gp_≠pCb_t
 *
cb
);

208 
°©us_t
 
	`z˛_gpCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

210 
	`gpStubInô
();

211 
	`gpExôCommissi⁄ögMode
();

212 
	`gpSwôchToTønsmôCh™√l
(
gpd_ch™√lC⁄figuøti⁄Cmd_∑ylﬂd_t
 
ch™√l
, 
u8
 
ãmpMa°îTxCh™√l
);

213 
u16
 
	`gpAlüsSrcAddrDîived
(
u8
 
≠pId
, 
gpdId_t
 
gpdId
);

214 
	`gpTønimôGPDF
(
gp_d©a_ªq_t
 *
pGpD©aReq
);

217 
	`gp_ProxyTabInô
();

218 
	`gpProxyTabUpd©e
();

219 
	`gp_¥oxyTabE¡ryCÀ¨
(
gpProxyTabE¡ry_t
 *
pE¡ry
);

220 
u8
 
	`gp_gëProxyTabE¡ryTŸÆNum
();

221 
u8
 
	`gp_gëProxyTabE¡ryLí
(
gpProxyTabE¡ry_t
 *
pE¡ry
);

222 
gpProxyTabE¡ry_t
 *
	`gp_¥oxyTabE¡ryFªeGë
();

223 
gpProxyTabE¡ry_t
 *
	`gp_gëProxyTabByGpdId
(
u8
 
≠pId
, 
gpdId_t
 
gpdId
);

224 
u8
 
	`lwSökAddrLi°Add
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
addrExt_t
 
sökIìeAddr
, 
u16
 
sökNwkAddr
);

225 
u8
 
	`lwSökAddrLi°Remove
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
addrExt_t
 
sökIìeAddr
, 
u16
 
sökNwkAddr
);

226 
u8
 
	`sökGroupLi°Add
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
u16
 
sökGroupID
, u16 
Æüs
);

227 
u8
 
	`sökGroupLi°Remove
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
u16
 
sökGroupID
);

228 
u8
 
	`gp_buûdProxyTabE¡ryF‹m©
(
gpProxyTabE¡ry_t
 *
pE¡ry
, u8 *
pBuf
);

	@zigbee/gp/gpEpCfg.c

27 
	~"../z˛/z˛_ö˛ude.h
"

28 
	~"gp.h
"

30 #i‡
GP_SUPPORT_ENABLE


47 c⁄° 
u16
 
	ggp_öClu°îLi°
[] =

56 c⁄° 
u16
 
	ggp_outClu°îLi°
[] =

58 
ZCL_CLUSTER_GEN_GREEN_POWER


65 
	#GP_IN_CLUSTER_NUM
 0

	)

66 
	#GP_OUT_CLUSTER_NUM
 1

	)

71 c⁄° 
af_sim∂e_des¸ùt‹_t
 
	ggp_sim∂eDesc
 =

73 
GP_PROFILE_ID
,

74 
GP_DEVICE_ID_PROXY_BASIC
,

75 
GREEN_POWER_ENDPOINT
,

78 
GP_IN_CLUSTER_NUM
,

79 
GP_OUT_CLUSTER_NUM
,

80 (
u16
 *)
gp_öClu°îLi°
,

81 (
u16
 *)
gp_outClu°îLi°
,

87 
u8
 
	gz˛GpAâr_gµMaxProxyTabE¡rõs
 = 
GPP_MAX_PROXY_TABLE_ENTRIES
;

88 
u16
 
	gz˛GpAâr_˛u°îRev
 = 
GP_CLUSTER_REVISION
;

89 
u8
 
	gz˛GpAâr_¥oxyTabE¡ry
[
ZCL_GP_MAX_PROXY_TABLE_ATTR_LEN
 + 2] = {0x0, 0x0,};

90 
u8
 
	gz˛GpAâr_gµFunc
[3] = {0};

91 
u8
 
	gz˛GpAâr_gµA˘iveFunc
[3] = {0};

92 
u8
 
	gz˛GpAâr_gpSh¨edSecKeyTy≥
 = 0;

93 
u8
 
	gz˛GpAâr_gpSh¨edSecKey
[
SEC_KEY_LEN
] = {0};

94 
u8
 
	gz˛GpAâr_gpLökKey
[
SEC_KEY_LEN
] = 
GP_LINK_KEY
;

97 c⁄° 
z˛AârInfo_t
 
	ggp_©åTbl
[] =

101 { 
ZCL_ATTRID_GP_GPS_MAX_SINK_TABLE_ENTRIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

102 { 
ZCL_ATTRID_GP_SINK_TABLE
, 
ZCL_DATA_TYPE_LONG_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

103 { 
ZCL_ATTRID_GP_GPS_COMMUNICATION_MODE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

104 { 
ZCL_ATTRID_GP_GPS_COMMISSIONING_EXIT_MODE
,
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

105 { 
ZCL_ATTRID_GP_GPS_COMMISSIONING_WINDOW
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

106 { 
ZCL_ATTRID_GP_GPS_SECURITY_LEVEL
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

107 { 
ZCL_ATTRID_GP_GPS_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

108 { 
ZCL_ATTRID_GP_GPS_ACTIVE_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

111 { 
ZCL_ATTRID_GP_GPP_MAX_PROXY_TABLE_ENTRIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµMaxProxyTabE¡rõs
 },

112 { 
ZCL_ATTRID_GP_PROXY_TABLE
, 
ZCL_DATA_TYPE_LONG_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_¥oxyTabE¡ry
 },

113 { 
ZCL_ATTRID_GP_GPP_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµFunc
 },

114 { 
ZCL_ATTRID_GP_GPP_ACTIVE_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµA˘iveFunc
 },

116 { 
ZCL_ATTRID_GP_SHARED_SECURITY_KEY_TYPE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpSh¨edSecKeyTy≥
 },

117 { 
ZCL_ATTRID_GP_SHARED_SECURITY_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpSh¨edSecKey
 },

118 { 
ZCL_ATTRID_GP_LINK_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpLökKey
 },

119 { 
ZCL_ATTRID_GP_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_˛u°îRev
 },

121 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

124 
	#ZCL_GP_ATTR_NUM
 (
gp_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

130 c⁄° 
z˛_•ecClu°îInfo_t
 
	gg_gpClu°îLi°
[] =

132 {
ZCL_CLUSTER_GEN_GREEN_POWER
, 
MANUFACTURER_CODE_NONE
, 
ZCL_GP_ATTR_NUM
, 
gp_©åTbl
, 
z˛_gp_ªgi°î
, 
z˛_gpCb
},

135 
u8
 
	gGP_CB_CLUSTER_NUM
 = ((
g_gpClu°îLi°
)/(g_gpClusterList[0]));

	@zigbee/gp/gp_proxyTab.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

25 
	~"../z˛/z˛_ö˛ude.h
"

26 
	~"gp.h
"

28 #i‡
GP_SUPPORT_ENABLE


30 
gp_¥oxyTab_t
 
	gg_gpProxyTab
;

32 
z˛GpProxyTabAârUpd©e
();

34 
	$gp_¥oxyTabSave2Fœsh
(*
¨g
)

36 #i‡
NV_ENABLE


37 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_GP_PROXY_TABLE
, (
gp_¥oxyTab_t
), (
u8
 *)&
g_gpProxyTab
);

39 
	}
}

41 
nv_°s_t
 
	$gp_¥oxyTabRe°‹eFromFœsh
()

43 
u8
 
ªt
 = 
NV_SUCC
;

45 #i‡
NV_ENABLE


46 
ªt
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_GP_PROXY_TABLE
, (
gp_¥oxyTab_t
), (
u8
 *)&
g_gpProxyTab
);

49  
ªt
;

50 
	}
}

52 
	$gp_¥oxyTabE¡ryCÀ¨
(
gpProxyTabE¡ry_t
 *
pE¡ry
)

54 i‡(
pE¡ry
->
u£d
)

56 
	`mem£t
((
u8
 *)
pE¡ry
, 0, (*pEntry));

57 
g_gpProxyTab
.
gpProxyTabNum
--;

59 
	}
}

61 
	$gp_ProxyTabInô
()

63 i‡(
	`gp_¥oxyTabRe°‹eFromFœsh
(Ë=
NV_SUCC
)

65 
	`z˛GpProxyTabAârUpd©e
();

69 
	`mem£t
((
u8
 *)&
g_gpProxyTab
, 0, (
gp_¥oxyTab_t
));

71 
	}
}

73 
u8
 
	$gp_gëProxyTabE¡ryTŸÆNum
()

75  
g_gpProxyTab
.
gpProxyTabNum
;

76 
	}
}

78 
u8
 
	$gp_gëProxyTabE¡ryLí
(
gpProxyTabE¡ry_t
 *
pE¡ry
)

80 
u8
 
íåyLí
 = 2;

82 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
)

84 
íåyLí
 += 4;

86 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
)

88 
íåyLí
 +
EXT_ADDR_LEN
;

89 
íåyLí
 += 1;

92 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
assig√dAlüs
)

94 
íåyLí
 +(
u16
);

97 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
)

99 
íåyLí
 +(
u8
);

102 i‡((
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
Ë|| (pE¡ry->›ti⁄s.bôs.
£qNumC≠
))

104 
íåyLí
 +(
u32
);

107 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
)

109 
íåyLí
 +
SEC_KEY_LEN
;

112 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
lightWeightUniˇ°GPS
)

114 
íåyLí
 +(
pE¡ry
->
lwSökC¡
) ? 1 : 0;

115 
u8
 
i
 = 0; i < 
pE¡ry
->
lwSökC¡
; i++)

117 
íåyLí
 += 10;

121 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
commGroupGPS
)

123 
íåyLí
 +(
pE¡ry
->
sökGroupC¡
) ? 1 : 0;

124 
u8
 
i
 = 0; i < 
pE¡ry
->
sökGroupC¡
; i++)

126 
íåyLí
 += 4;

130 
íåyLí
 +(
u8
);

132 i‡(!
pE¡ry
->
›ti⁄s
.
bôs
.
íåyA˘ive
 || !pE¡ry->›ti⁄s.bôs.
íåyVÆid
)

134 
íåyLí
 +(
u8
);

137  
íåyLí
;

138 
	}
}

140 
u8
 
	$gp_buûdProxyTabE¡ryF‹m©
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
u8
 *
pBuf
)

142 
u8
 *
±r
 = 
pBuf
;

145 *
±r
++ = 
	`LO_UINT16
(
pE¡ry
->
›ti⁄s
.
›ts
);

146 *
±r
++ = 
	`HI_UINT16
(
pE¡ry
->
›ti⁄s
.
›ts
);

149 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
)

151 *
±r
++ = 
	`U32_BYTE0
(
pE¡ry
->
gpdId
.
§cId
);

152 *
±r
++ = 
	`U32_BYTE1
(
pE¡ry
->
gpdId
.
§cId
);

153 *
±r
++ = 
	`U32_BYTE2
(
pE¡ry
->
gpdId
.
§cId
);

154 *
±r
++ = 
	`U32_BYTE3
(
pE¡ry
->
gpdId
.
§cId
);

156 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
)

158 
	`ZB_64BIT_ADDR_COPY
(
±r
, 
pE¡ry
->
gpdId
.
gpdIìeAddr
);

159 
±r
 +
EXT_ADDR_LEN
;

160 *
±r
++ = 
pE¡ry
->
ídpoöt
;

164 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
assig√dAlüs
)

166 *
±r
++ = 
	`LO_UINT16
(
pE¡ry
->
gpdAssig√dAlüs
);

167 *
±r
++ = 
	`HI_UINT16
(
pE¡ry
->
gpdAssig√dAlüs
);

171 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
)

173 *
±r
++ = 
pE¡ry
->
£cO±i⁄s
.
›ts
;

177 i‡((
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
Ë|| (pE¡ry->›ti⁄s.bôs.
£qNumC≠
))

179 *
±r
++ = 
	`U32_BYTE0
(
pE¡ry
->
gpdSecFømeC¡
);

180 *
±r
++ = 
	`U32_BYTE1
(
pE¡ry
->
gpdSecFømeC¡
);

181 *
±r
++ = 
	`U32_BYTE2
(
pE¡ry
->
gpdSecFømeC¡
);

182 *
±r
++ = 
	`U32_BYTE3
(
pE¡ry
->
gpdSecFømeC¡
);

186 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
£cU£
)

188 
	`mem˝y
(
±r
, 
pE¡ry
->
gpdKey
, 
SEC_KEY_LEN
);

189 
±r
 +
SEC_KEY_LEN
;

193 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
lightWeightUniˇ°GPS
)

195 *
±r
++ = 
pE¡ry
->
lwSökC¡
;

196 
u8
 
i
 = 0; i < 
pE¡ry
->
lwSökC¡
; i++)

198 
	`ZB_64BIT_ADDR_COPY
(
±r
, 
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökIìeAddr
);

199 
±r
 +
EXT_ADDR_LEN
;

200 *
±r
++ = 
	`LO_UINT16
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
);

201 *
±r
++ = 
	`HI_UINT16
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
);

206 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
commGroupGPS
)

208 *
±r
++ = 
pE¡ry
->
sökGroupC¡
;

209 
u8
 
i
 = 0; i < 
pE¡ry
->
sökGroupC¡
; i++)

211 *
±r
++ = 
	`LO_UINT16
(
pE¡ry
->
sökGroupLi°
[
i
].
groupId
);

212 *
±r
++ = 
	`HI_UINT16
(
pE¡ry
->
sökGroupLi°
[
i
].
groupId
);

213 *
±r
++ = 
	`LO_UINT16
(
pE¡ry
->
sökGroupLi°
[
i
].
Æüs
);

214 *
±r
++ = 
	`HI_UINT16
(
pE¡ry
->
sökGroupLi°
[
i
].
Æüs
);

219 *
±r
++ = 
pE¡ry
->
groupˇ°Radius
;

222 i‡(!
pE¡ry
->
›ti⁄s
.
bôs
.
íåyA˘ive
 || !pE¡ry->›ti⁄s.bôs.
íåyVÆid
)

224 *
±r
++ = 
pE¡ry
->
£¨chC¡
;

227  (
±r
 - 
pBuf
);

228 
	}
}

230 
gpProxyTabE¡ry_t
 *
	$gp_gëProxyTabByGpdId
(
u8
 
≠pId
, 
gpdId_t
 
gpdId
)

232 
gpProxyTabE¡ry_t
 *
pE¡ry
 = 
NULL
;

234 i‡(
g_gpProxyTab
.
gpProxyTabNum
 == 0)

236  
NULL
;

239 
u8
 
i
 = 0; i < 
z˛GpAâr_gµMaxProxyTabE¡rõs
; i++)

241 
pE¡ry
 = &
g_gpProxyTab
.
gpProxyTab
[
i
];

242 i‡(
pE¡ry
->
u£d
)

244 i‡(
pE¡ry
->
›ti⁄s
.
bôs
.
≠pId
 ==áppId)

246 i‡((
≠pId
 =
GP_APP_ID_SRC_ID
Ë&& !
	`memcmp
((
u8
 *)&
gpdId
.
§cId
, (u8 *)&
pE¡ry
->gpdId.§cId, 
SRC_ID_LEN
))

248  
pE¡ry
;

250 i‡((
≠pId
 =
GP_APP_ID_GPD
Ë&& !
	`memcmp
((
u8
 *)&
gpdId
.
gpdIìeAddr
, (u8 *)&
pE¡ry
->gpdId.gpdIìeAddr, 
EXT_ADDR_LEN
))

252  
pE¡ry
;

258  
NULL
;

259 
	}
}

261 
gpProxyTabE¡ry_t
 *
	$gp_¥oxyTabE¡ryFªeGë
()

263 
gpProxyTabE¡ry_t
 *
pE¡ry
 = 
NULL
;

265 i‡(
g_gpProxyTab
.
gpProxyTabNum
 >
z˛GpAâr_gµMaxProxyTabE¡rõs
)

267  
NULL
;

270 
u8
 
i
 = 0; i < 
z˛GpAâr_gµMaxProxyTabE¡rõs
; i++)

272 
pE¡ry
 = &
g_gpProxyTab
.
gpProxyTab
[
i
];

273 i‡(!
pE¡ry
->
u£d
)

275 
pE¡ry
->
gpdSecFømeC¡
 = 0xffffffff;

276 
pE¡ry
->
groupˇ°Radius
 = 0xff;

277  
pE¡ry
;

281  
NULL
;

282 
	}
}

284 
u8
 
	$lwSökAddrLi°Add
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
addrExt_t
 
sökIìeAddr
, 
u16
 
sökNwkAddr
)

286 i‡(
pE¡ry
->
lwSökC¡
 == 0)

289 
	`ZB_64BIT_ADDR_COPY
(
pE¡ry
->
lightweightSökAddrLi°
[0].
sökIìeAddr
, sinkIeeeAddr);

290 
pE¡ry
->
lightweightSökAddrLi°
[0].
sökNwkAddr
 = sinkNwkAddr;

291 
pE¡ry
->
lwSökC¡
++;

292  
SUCCESS
;

296 
u8
 
i
 = 0; i < 
pE¡ry
->
lwSökC¡
; i++)

298 i‡(
	`ZB_64BIT_ADDR_CMP
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökIìeAddr
, sinkIeeeAddr) &&

299 (
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
 == sinkNwkAddr))

302  
SUCCESS
;

306 i‡(
pE¡ry
->
lwSökC¡
 < 
PROXY_LIGHTWEIGHT_SINK_ADDR_LIST_NUM
)

308 
	`ZB_64BIT_ADDR_COPY
(
pE¡ry
->
lightweightSökAddrLi°
[pE¡ry->
lwSökC¡
].
sökIìeAddr
, sinkIeeeAddr);

309 
pE¡ry
->
lightweightSökAddrLi°
[pE¡ry->
lwSökC¡
].
sökNwkAddr
 = sinkNwkAddr;

310 
pE¡ry
->
lwSökC¡
++;

311  
SUCCESS
;

315  
FAILURE
;

316 
	}
}

318 
u8
 
	$lwSökAddrLi°Remove
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
addrExt_t
 
sökIìeAddr
, 
u16
 
sökNwkAddr
)

320 i‡(
pE¡ry
->
lwSökC¡
)

322 
u8
 
i
 = 0; i < 
pE¡ry
->
lwSökC¡
; i++)

324 i‡(
	`ZB_64BIT_ADDR_CMP
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökIìeAddr
, sinkIeeeAddr) &&

325 (
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
 == sinkNwkAddr))

328 i‡(
i
 =(
pE¡ry
->
lwSökC¡
 - 1))

330 
	`ZB_64BIT_ADDR_ZERO
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökIìeAddr
);

331 
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
 = 0;

335 
	`ZB_64BIT_ADDR_COPY
(
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökIìeAddr
,ÖE¡ry->lightweightSökAddrLi°[pE¡ry->
lwSökC¡
 - 1].sinkIeeeAddr);

336 
pE¡ry
->
lightweightSökAddrLi°
[
i
].
sökNwkAddr
 =ÖE¡ry->lightweightSökAddrLi°[pE¡ry->
lwSökC¡
 - 1].sinkNwkAddr;

338 
	`ZB_64BIT_ADDR_ZERO
(
pE¡ry
->
lightweightSökAddrLi°
[pE¡ry->
lwSökC¡
 - 1].
sökIìeAddr
);

339 
pE¡ry
->
lightweightSökAddrLi°
[pE¡ry->
lwSökC¡
 - 1].
sökNwkAddr
 = 0;

341 
pE¡ry
->
lwSökC¡
--;

343  
SUCCESS
;

348  
FAILURE
;

349 
	}
}

351 
u8
 
	$sökGroupLi°Add
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
u16
 
sökGroupID
, u16 
Æüs
)

353 i‡(
pE¡ry
->
sökGroupC¡
 == 0)

356 
pE¡ry
->
sökGroupLi°
[0].
groupId
 = 
sökGroupID
;

357 
pE¡ry
->
sökGroupLi°
[0].
Æüs
 =álias;

358 
pE¡ry
->
sökGroupC¡
++;

359  
SUCCESS
;

363 
u8
 
i
 = 0; i < 
pE¡ry
->
sökGroupC¡
; i++)

365 i‡(
pE¡ry
->
sökGroupLi°
[
i
].
groupId
 =
sökGroupID
)

368 
pE¡ry
->
sökGroupLi°
[
i
].
Æüs
 =álias;

369  
SUCCESS
;

373 i‡(
pE¡ry
->
sökGroupC¡
 < 
PROXY_SINK_GROUP_LIST_NUM
)

375 
pE¡ry
->
sökGroupLi°
[pE¡ry->
sökGroupC¡
].
groupId
 = 
sökGroupID
;

376 
pE¡ry
->
sökGroupLi°
[pE¡ry->
sökGroupC¡
].
Æüs
 =álias;

377 
pE¡ry
->
sökGroupC¡
++;

378  
SUCCESS
;

382  
FAILURE
;

383 
	}
}

385 
u8
 
	$sökGroupLi°Remove
(
gpProxyTabE¡ry_t
 *
pE¡ry
, 
u16
 
sökGroupID
)

387 i‡(
pE¡ry
->
sökGroupC¡
)

389 
u8
 
i
 = 0; i < 
pE¡ry
->
sökGroupC¡
; i++)

391 i‡(
pE¡ry
->
sökGroupLi°
[
i
].
groupId
 =
sökGroupID
)

394 i‡(
i
 =(
pE¡ry
->
sökGroupC¡
 - 1))

396 
pE¡ry
->
sökGroupLi°
[
i
].
groupId
 = 0;

397 
pE¡ry
->
sökGroupLi°
[
i
].
Æüs
 = 0;

401 
pE¡ry
->
sökGroupLi°
[
i
].
groupId
 =ÖE¡ry->sökGroupLi°[pE¡ry->
sökGroupC¡
 - 1].groupId;

402 
pE¡ry
->
sökGroupLi°
[
i
].
Æüs
 =ÖE¡ry->sökGroupLi°[pE¡ry->
sökGroupC¡
 - 1].alias;

404 
pE¡ry
->
sökGroupLi°
[pE¡ry->
sökGroupC¡
 - 1].
groupId
 = 0;

405 
pE¡ry
->
sökGroupLi°
[pE¡ry->
sökGroupC¡
 - 1].
Æüs
 = 0;

407 
pE¡ry
->
sökGroupC¡
--;

409  
SUCCESS
;

414  
FAILURE
;

415 
	}
}

417 
	$z˛GpProxyTabAârUpd©e
()

419 
u8
 *
pBuf
 = 
z˛GpAâr_¥oxyTabE¡ry
;

421 i‡(
g_gpProxyTab
.
gpProxyTabNum
 == 0)

424 *
pBuf
++ = 0;

425 *
pBuf
++ = 0;

429 
u8
 
íåyLí
 = 0;

430 
u8
 
maxE¡ryLí
 = 0;

431 
u8
 
íåyC¡
 = 0;

433 
u8
 
i
 = 0; i < 
z˛GpAâr_gµMaxProxyTabE¡rõs
; i++)

435 
maxE¡ryLí
 = 
íåyLí
;

437 i‡(
g_gpProxyTab
.
gpProxyTab
[
i
].
u£d
)

439 
íåyLí
 +
	`gp_gëProxyTabE¡ryLí
(&
g_gpProxyTab
.
gpProxyTab
[
i
]);

441 i‡(
íåyLí
 >
ZCL_GP_MAX_PROXY_TABLE_ATTR_LEN
)

443 
íåyLí
 = 
maxE¡ryLí
;

448 
íåyC¡
++;

453 *
pBuf
++ = 
	`LO_UINT16
(
íåyLí
);

455 *
pBuf
++ = 0;

457 
u8
 
i
 = 0; i < 
íåyC¡
; i++)

459 i‡(
g_gpProxyTab
.
gpProxyTab
[
i
].
u£d
)

461 
pBuf
 +
	`gp_buûdProxyTabE¡ryF‹m©
(&
g_gpProxyTab
.
gpProxyTab
[
i
],ÖBuf);

465 
	}
}

467 
	$gpProxyTabUpd©e
()

469 
	`z˛GpProxyTabAârUpd©e
();

472 
	`TL_SCHEDULE_TASK
(
gp_¥oxyTabSave2Fœsh
, 
NULL
);

473 
	}
}

	@zigbee/mac/includes/mac_phy.h

24 #i‚de‡
MAC_PHY_H


25 
	#MAC_PHY_H


	)

31 
	#RF_PKT_BUFF_LEN
 (144)

32 

	)

33 
	#CCA_THRESHOLD
 (-70)

	)

34 
	#RSSI_PASS_THRESHOLD
 (-30)

	)

40 
	mRF_SUCC
,

41 
	mRF_CSMA_FAILURE
,

45 
	mRF_RX_OFF
,

46 
	mRF_RX_ON
,

50 
	mCCA_ED_ONLY
,

51 
	mCCA_CS_ONLY
,

52 
	mCCA_ED_AND_CS
,

53 
	mCCA_ED_OR_CS
,

57 
	mRF_STATE_TX
 = 0,

58 
	mRF_STATE_RX
,

59 
	mRF_STATE_ED
,

60 
	mRF_STATE_OFF
,

67 
	mSUCC
,

68 
	mRF_BLACK_LIST_FULL
,

69 
	mRF_BLACK_LIST_NO_MEMBER
,

77 
	mRF_ID_CHANNEL
 = 0x00,

78 
	mRF_ID_TX_POWER
,

79 
	mRF_ID_RX_ONOFF
,

80 
	mRF_ID_GENERAL_END
 = 0x9F,

83 
	mRF_ID_ZIGBEE
 = 0xA0,

84 
	mRF_ID_MAC_SHORT_ADDR
,

85 
	mRF_ID_MAC_EXT_ADDR
,

86 
	mRF_ID_MAC_PANID
,

87 
	mRF_ID_MAC_FRAME_PENDING
,

88 
	mRF_ID_MAC_PAN_COORD
,

89 
	mRF_ID_MAC_RECV_START
,

90 
	mRF_ID_BECON_RECV
,

92 
	mRF_ID_BLE
 = 0xB0,

99 
	mPHY_CCA_IDLE
 = 0x04,

100 
	mPHY_CCA_TRX_OFF
 = 0x03,

101 
	mPHY_CCA_BUSY
 = 0x00,

102 }
	tphy_cˇSts_t
;

108 
u32
 
	mdmaLí
;

109 
u8
 
	mrssi
;

110 
u8
 
	mr£vîd
[7];

111 
u8
 
	m∑ylﬂdLí
;

112 
u8
 
	m∑ylﬂd
[1];

113 }
	trf_ªcvPkt_t
;

119 
u32
 
	mdmaLí
;

120 
u8
 
	mrfLí
;

121 
u8
 
	m∑ylﬂd
[1];

122 }
	trf_£ndPkt_t
;

128 
u8
 *
	mpsdu
;

129 
u32
 
	mtimeSèmp
;

130 
s8
 
	mrssi
;

131 
u8
 
	mpsduLí
;

132 }
	trx_buf_t
;

135 
u8
 
g_zb_txPowîSë
;

152 
rf_ª£t
();

154 
	#mac_phyRec⁄fig
(Ë
	`rf_ª£t
();

	)

165 
rf_öô
();

176 
rf_£tRxBuf
(
u8
 *
pBuf
);

187 
u8
 
rf_TrxSèãGë
();

198 
rf_£tTrxSèã
(
u8
 
°©e
);

209 
rf_£tCh™√l
(
u8
 
chn
);

220 
u8
 
rf_gëCh™√l
();

231 
rf_£tTxPowî
(
u8
 
txPowî
);

242 
u8
 
rf_gëLqi
(
s8
 
rssi
);

253 
rf_°¨tED
();

264 
u8
 
rf_°›ED
();

275 
u8
 
rf_≥rf‹mCCA
();

277 
rf802154_tx_ªady
(
u8
 *
buf
, u8 
Àn
);

278 
rf802154_tx
();

291 
rf_∑Inô
(
u32
 
TXEN_pö
, u32 
RXEN_pö
);

292 
rf_∑ShutDown
();

	@zigbee/mac/includes/mac_trx_api.h

24 #i‚de‡
MAC_TRX_API_H


25 
	#MAC_TRX_API_H


	)

31 
	#MAC_A_NUM_SUPERFRAME_SLOTS
 16

	)

36 
	#MAC_A_BASE_SLOT_DURATION
 3

	)

38 #ifde‡
WIN32


39 
	#MAC_A_BASE_SUPERFRAME_DURATION
 (
MAC_A_BASE_SLOT_DURATION
 * 
MAC_A_NUM_SUPERFRAME_SLOTS
)

	)

41 
	#MAC_A_BASE_SUPERFRAME_DURATION
 (
MAC_A_BASE_SLOT_DURATION
 * 
MAC_A_NUM_SUPERFRAME_SLOTS
)

	)

44 
	#MAC_MIN_HDR_LEN
 3

	)

45 
	#MAC_MAX_HDR_LEN
 23

	)

50 
	#MAC_FCF_FRAME_TYPE_MASK
 0x0007

	)

51 
	#MAC_FCF_SEC_ENABLED_MASK
 0x0008

	)

52 
	#MAC_FCF_FRAME_PENDING_MASK
 0x0010

	)

53 
	#MAC_FCF_ACK_REQUEST_MASK
 0x0020

	)

54 
	#MAC_FCF_INTRA_PAN_MASK
 0x0040

	)

55 
	#MAC_FCF_DST_ADDR_MODE_MASK
 0x0C00

	)

56 
	#MAC_FCF_FRAME_VERSION_MASK
 0x3000

	)

57 
	#MAC_FCF_SRC_ADDR_MODE_MASK
 0xC000

	)

62 
	#MAC_FCF_FIELD_LEN
 2

	)

63 
	#MAC_SEQ_NUM_FIELD_LEN
 1

	)

64 
	#MAC_PAN_ID_FIELD_LEN
 2

	)

65 
	#MAC_EXT_ADDR_FIELD_LEN
 8

	)

66 
	#MAC_SHORT_ADDR_FIELD_LEN
 2

	)

67 
	#MAC_FCS_FIELD_LEN
 2

	)

72 
	#MAC_FRAME_TYPE_BEACON
 0

	)

73 
	#MAC_FRAME_TYPE_DATA
 1

	)

74 
	#MAC_FRAME_TYPE_ACK
 2

	)

75 
	#MAC_FRAME_TYPE_COMMAND
 3

	)

76 
	#MAC_FRAME_TYPE_MAX_VALID
 
MAC_FRAME_TYPE_COMMAND


	)

81 
	#MAC_FCF_FRAME_TYPE_POS
 0

	)

82 
	#MAC_FCF_SEC_ENABLED_POS
 3

	)

83 
	#MAC_FCF_FRAME_PENDING_POS
 4

	)

84 
	#MAC_FCF_ACK_REQUEST_POS
 5

	)

85 
	#MAC_FCF_INTRA_PAN_POS
 6

	)

86 
	#MAC_FCF_DST_ADDR_MODE_POS
 10

	)

87 
	#MAC_FCF_FRAME_VERSION_POS
 12

	)

88 
	#MAC_FCF_SRC_ADDR_MODE_POS
 14

	)

92 
	#MAC_CAP_GET_DEVICE_TYPE
(
c
Ë((¯>> 1Ë& 1)

	)

93 
	#MAC_CAP_GET_RXON_WHEN_IDLE
(
c
Ë((¯>> 3Ë& 1)

	)

95 
	#TX_QUEUE_BN
 16

	)

99 
	mRX_BUSY
 = 
BIT
(0),

100 
	mTX_BUSY
 = 
BIT
(1),

101 
	mTX_ACKPACKET
 = 
BIT
(2),

102 
	mRX_WAITINGACK
 = 
BIT
(3),

103 
	mRX_DATAPENDING
 = 
BIT
(4),

104 
	mTX_UNDERWAY
 = 
BIT
(5)

105 }
	trf_åxds_°_e
;

108 
	mMAC_TX_IDLE
,

109 
	mMAC_TX_CSMA
,

110 
	mMAC_TX_UNDERWAY
,

111 
	mMAC_TX_WAIT_ACK
,

112 
	mMAC_TX_RETRY
,

113 
	mMAC_TX_TIME_OUT
,

114 
	mMAC_TX_DONE
,

115 }
	tmac_txSèã_t
;

118 
	mMAC_TX_EV_NEW_DATA
,

119 
	mMAC_TX_EV_CSMA_IDLE
,

120 
	mMAC_TX_EV_CSMA_BUSY
,

121 
	mMAC_TX_EV_SEND_SUCC
,

122 
	mMAC_TX_EV_SEND_FAIL
,

123 
	mMAC_TX_EV_ACK_RECV
,

124 
	mMAC_TX_EV_ACK_RETRY
,

125 
	mMAC_TX_EV_NO_ACK
,

126 
	mMAC_TX_EV_HAVE_PENDING_DATA
,

127 }
	tmac_txEvt_t
;

133 
u8
 
	mfAck
:4;

134 
u8
 
	mfFømePídög
:4;

135 
u8
 
	mpsduLí
;

136 
u8
 
	m˙fSètus
;

137 
u8
 
	m£qNum
;

138 
u8
 *
	mbuf
;

139 
u8
 *
	mtxD©a
;

140 *
	m≥ndögLi°
;

141 }
	tmac_gíFøme_t
;

143 
mac_gíFøme_t
 
	ttx_d©a_queue
;

148 
u8
 
MAC_TX_QUEUE_SIZE
;

149 
tx_d©a_queue
 
g_txQueue
[];

150 vﬁ©ûê
u8
 
rf_busyFœg
;

161 
mac_åxInô
();

171 
mac_åiggî_tx
(*
¨g
);

187 
u8
 *
zb_macD©aFûãr
(u8 *
macPld
, u8 
Àn
, u8 *
√edDr›
, u8 *
ackPkt
);

207 
zb_macD©aRecvH™dî
(
u8
 *
rxBuf
, u8 *
d©a
, u8 
Àn
, u8 
ackPkt
, 
u32
 
time°amp
, 
s8
 
rssi
);

217 
zb_macD©aSídH™dî
();

219 
u8
 
é_zbMacHdrSize
(
u16
 
‰ameCål
);

220 
boﬁ
 
é_zbMacSèãBusy
();

221 
u8
 
mac_gëTrxSèã
();

	@zigbee/mac/includes/tl_zb_mac.h

24 #i‚de‡
TL_ZB_MAC_H


25 
	#TL_ZB_MAC_H


	)

36 
	#MAX_PHY_FRM_SIZE
 127

	)

41 
	#MAC_SHORT_ADDR_MAX
 0xFFF7

	)

42 
	#MAC_PAN_ID_BROADCAST
 0xFFFF

	)

43 
	#MAC_ADDR_USE_EXT
 0xFFFE

44 
	#MAC_SHORT_ADDR_BROADCAST
 0xFFFF

45 
	#MAC_SHORT_ADDR_NONE
 0xFFFF

46 

	)

50 
	#MAC_KEY_SOURCE_MAX_LEN
 8

	)

55 
	#MAX_ED_SCAN_RESULTS_SUPPORTED
 16

	)

60 
	#MAX_PAN_DESC_SUPPORTED
 6

	)

63 #ifde‡
ZB_MAC_SECURITY


64 
	#MAC_SECUR_LEV5_KEYID1_AUX_HDR_SIZE
 6

	)

66 
	#MAC_SECUR_LEV5_KEYID1_AUX_HDR_SIZE
 0

	)

69 
	#ZB_MAC_SECURITY_LEVEL
 5

	)

70 
	#ZB_MAC_KEY_ID_MODE
 1

	)

72 
	#ZB_TURN_OFF_ORDER
 15

	)

74 
	#ZB_MAC_SHORT_ADDR_NOT_ALLOCATED
 0xFFFE

	)

79 
	#ZB_MAX_SCAN_DURATION_VALUE
 200

	)

82 
	#ZB_MAC_PENDING_TRANS_QUEUE_NUM
 6

	)

84 
	#ZB_MAC_INTERNAL_EXPIRY_CNT
 0

	)

87 
	#TL_ZB_MAC_CHANNEL_START
 11

	)

88 
	#TL_ZB_MAC_CHANNEL_NUM
 16

	)

89 
	#TL_ZB_MAC_CHANNEL_STOP
 (
TL_ZB_MAC_CHANNEL_START
 + 
TL_ZB_MAC_CHANNEL_NUM
 - 1)

	)

91 
	#MAGIC_ROUND_TO_4
(
a
Ë((◊Ë+ ((4)-1)Ë& -(4))

	)

98 
	#MAC_MCPS_DATA_REQ
 0x40

99 
	#MAC_MCPS_DATA_CNF
 0x41

100 
	#MAC_MCPS_DATA_IND
 0x42

101 
	#MAC_MCPS_PURGE_REQ
 0x43

102 
	#MAC_MCPS_PURGE_CNF
 0x44

103 
	#MAC_MLME_ASSOCIATE_REQ
 0x45

104 
	#MAC_MLME_ASSOCIATE_CNF
 0x46

105 
	#MAC_MLME_ASSOCIATE_IND
 0x47

106 
	#MAC_MLME_ASSOCIATE_RES
 0x48

107 
	#MAC_MLME_DISASSOCIATE_REQ
 0x49

108 
	#MAC_MLME_DISASSOCIATE_CNF
 0x4a

109 
	#MAC_MLME_DISASSOCIATE_IND
 0x4b

110 
	#MAC_MLME_BEACON_NOTIFY_IND
 0x4c

111 
	#MAC_MLME_GET_REQ
 0x4d

112 
	#MAC_MLME_GET_CNF
 0x4e

113 
	#MAC_MLME_ORPHAN_IND
 0x4f

114 
	#MAC_MLME_ORPHAN_RES
 0x50

115 
	#MAC_MLME_RESET_REQ
 0x51

116 
	#MAC_MLME_RESET_CNF
 0x52

117 
	#MAC_MLME_RX_ENABLE_REQ
 0x53

118 
	#MAC_MLME_RX_ENABLE_CNF
 0x54

119 
	#MAC_MLME_SCAN_REQ
 0x55

120 
	#MAC_MLME_SCAN_CNF
 0x56

121 
	#MAC_MLME_COMM_STATUS_IND
 0x57

122 
	#MAC_MLME_SET_REQ
 0x58

123 
	#MAC_MLME_SET_CNF
 0x59

124 
	#MAC_MLME_START_REQ
 0x5a

125 
	#MAC_MLME_START_CNF
 0x5b

126 
	#MAC_MLME_SYNC_LOSS_IND
 0x5c

127 
	#MAC_MLME_POLL_REQ
 0x5d

128 
	#MAC_MLME_POLL_CNF
 0x5e

129 
	#MAC_MLME_SCAN_COMPLETE
 0x5f

130 
	#MAC_MLME_BEACON_REQ_CMD
 0x60

131 
	#MAC_MLME_DATA_REQ_CMD
 0x61

132 
	#MAC_MLME_ASSO_RSP_CNF
 0x62

133 
	#MAC_MLME_POLL_IND
 0x63

134 

	)

138 
	#MAC_FCF_ACK_REQ_BIT
 0x20

	)

139 
	#MAC_FCF_INTRA_PAN_BIT
 0x40

	)

140 
	#MAC_FCF_DST_ADDR_BIT
 0x0c

	)

141 
	#MAC_FCF_SRC_ADDR_BIT
 0xc0

	)

142 
	#MAC_FCF_FRAME_TYPE
 0x07

	)

144 
	emac_‰ame_vîsi⁄_e
{

145 
	mMAC_FRAME_IEEE_802_15_4_2003
 = 0,

146 
	mMAC_FRAME_IEEE_802_15_4
 = 1

149 
	ezb_addr_mode_e
{

150 
	mZB_ADDR_NO_ADDR
 = 0,

151 
	mZB_ADDR_16BIT_MULTICAST
 = 1,

155 
	mZB_ADDR_16BIT_GROUP
 = 1,

156 
	mZB_ADDR_16BIT_DEV_OR_BROADCAST
 = 2,

159 
	mZB_ADDR_64BIT_DEV
 = 3

160 }
	tzb_addr_mode_t
;

166 
	mMAC_DEV_UNDEFINED
,

167 
	mMAC_DEV_FFD
,

168 
	mMAC_DEV_RFD


174 
	emac_tx_›ti⁄s_bôs_e
{

175 
	mMAC_TX_OPTION_ACKNOWLEDGED_BIT
 = 1,

176 
	mMAC_TX_OPTION_GTS_CAP_BIT
 = 2,

177 
	mMAC_TX_OPTION_INDIRECT_TRANSMISSION_BIT
 = 4,

178 
	mMAC_TX_OPTION_USE_CSMA_BIT
 = 8,

184 
	emac_‰ame_ty≥_e
{

185 
	mMAC_FRAME_BEACON
 = 0,

186 
	mMAC_FRAME_DATA
 = 1,

187 
	mMAC_FRAME_ACKNOWLEDGMENT
 = 2,

188 
	mMAC_FRAME_COMMAND
 = 3,

189 
	mMAC_FRAME_RESERVED1
 = 4,

190 
	mMAC_FRAME_RESERVED2
 = 5,

191 
	mMAC_FRAME_RESERVED3
 = 6,

192 
	mMAC_FRAME_RESERVED4
 = 7

201 
	mMAC_PHY_ATTR_CURRENT_CHANNEL
 = 0x00,

202 
	mMAC_PHY_ATTR_MODE_CCA
 = 0x03,

203 
	mMAC_PHY_ATTR_CURRENT_PAGE
 = 0x04,

205 
	mMAC_PIB_ATTRIBUTE_START
 = 0x40,

206 
	mMAC_ATTR_ACK_WAIT_DURATION
 = 0x40,

207 
	mMAC_ATTR_ASSOCIATION_PERMIT
 = 0x41,

208 
	mMAC_ATTR_AUTO_REQUEST
 = 0x42,

209 
	mMAC_ATTR_BATTERY_LIFE_EXT
 = 0x43,

210 
	mMAC_ATTR_BATTERY_LIFE_EXT_PERIODS
 = 0x44,

211 
	mMAC_ATTR_BEACON_PAYLOAD
 = 0x45,

212 
	mMAC_ATTR_BEACON_PAYLOAD_LENGTH
 = 0x46,

213 
	mMAC_ATTR_BEACON_ORDER
 = 0x47,

214 
	mMAC_ATTR_BEACON_TX_TIME
 = 0x48,

215 
	mMAC_ATTR_BSN
 = 0x49,

216 
	mMAC_ATTR_COORDINATOR_EXTENDED_ADDRESS
 = 0x4A,

217 
	mMAC_ATTR_OORDINATOR_SHORT_ADDRESS
 = 0x4B,

218 
	mMAC_ATTR_DSN
 = 0x4C,

219 
	mMAC_ATTR_GTS_PERMIT
 = 0x4D,

220 
	mMAC_ATTR_MAX_CSMA_BACKOFFS
 = 0x4E,

221 
	mMAC_ATTR_MIN_BE
 = 0x4F,

222 
	mMAC_ATTR_PAN_ID
 = 0x50,

223 
	mMAC_ATTR_PROMISCUOUS_MODE
 = 0x51,

224 
	mMAC_ATTR_RX_ON_WHEN_IDLE
 = 0x52,

225 
	mMAC_ATTR_SHORT_ADDRESS
 = 0x53,

226 
	mMAC_ATTR_SUPERFRAME_ORDER
 = 0x54,

227 
	mMAC_ATTR_TRANSACTION_PERSISTENCE_TIME
 = 0x55,

228 
	mMAC_ATTR_PAN_COORDASSOCIATED
 = 0x56,

229 
	mMAC_ATTR_MAX_BE
 = 0x57,

230 
	mMAC_ATTR_MAX_FRAME_TOTAL_WAIT_TIME
 = 0x58,

231 
	mMAC_ATTR_MAX_FRAME_RETRIES
 = 0x59,

232 
	mMAC_ATTR_RESPONSE_WAIT_TIME
 = 0x5A,

233 
	mMAC_ATTR_SYNC_SYMBOL_OFFSET
 = 0x5B,

234 
	mMAC_ATTR_TIMESTAMP_SUPPORTED
 = 0x5C,

235 
	mMAC_ATTR_SECURITY_ENABLED
 = 0x5D,

237 
	mMAC_CONST_EXT_ADDR
 = 0x5E,

238 
	mMAC_TX_POWER
 = 0x5F,

239 
	mMAC_PIB_ATTRIBUTE_STOP
 = 0x5F ,

248 
	emac_comm™d_‰ame_id
{

249 
	mMAC_CMD_ASSOCIATION_REQUEST
 = 1,

250 
	mMAC_CMD_ASSOCIATION_RESPONSE
,

251 
	mMAC_CMD_DISASSOCIATION_NOTIFICATION
,

252 
	mMAC_CMD_DATA_REQUEST
,

253 
	mMAC_CMD_PAN_ID_CONFLICT_NOTIFICATION
,

254 
	mMAC_CMD_ORPHAN_NOTIFICATION
,

255 
	mMAC_CMD_BEACON_REQUEST
,

256 
	mMAC_CMD_COORDINATOR_REALIGNMENT
,

257 
	mMAC_CMD_GTS_REQUEST
,

259 
	mMAC_CMD_TELINK_BASE
 = 0xA0,

260 
	mMAC_CMD_TELINK_OTA
,

264 
	mZB_MAC_STATE_NORMAL
 = 0,

265 
	mZB_MAC_STATE_ED_SCAN
,

266 
	mZB_MAC_STATE_ACTIVE_SCAN
,

267 
	mZB_MAC_STATE_ORPHAN_SCAN
,

268 
	mZB_MAC_STATE_PASSIVE_SCAN
,

269 
	mZB_MAC_STATE_INDIRECT_DATA
,

273 
	mMAC_SUCCESS
 = 0x00,

274 
	mMAC_STA_PAN_AT_CAPACITY
 = 0x01,

275 
	mMAC_STA_PAN_ACCESS_DENIED
 = 0x02,

276 
	mMAC_STA_AUTOACK_PENDING_ALL_ON
 = 0xFE,

277 
	mMAC_STA_AUTOACK_PENDING_ALL_OFF
 = 0xFF,

278 
	mMAC_STA_BEACON_LOSS
 = 0xE0,

279 
	mMAC_STA_CHANNEL_ACCESS_FAILURE
 = 0xE1,

280 
	mMAC_STA_COUNTER_ERROR
 = 0xDB,

281 
	mMAC_STA_DENIED
 = 0xE2,

282 
	mMAC_STA_DISABLE_TRX_FAILURE
 = 0xE3,

283 
	mMAC_STA_FRAME_TOO_LONG
 = 0xE5,

284 
	mMAC_STA_IMPROPER_KEY_TYPE
 = 0xDC,

285 
	mMAC_STA_IMPROPER_SECURITY_LEVEL
 = 0xDD,

286 
	mMAC_STA_INVALID_ADDRESS
 = 0xF5,

287 
	mMAC_STA_INVALID_GTS
 = 0xE6,

288 
	mMAC_STA_INVALID_HANDLE
 = 0xE7,

289 
	mMAC_STA_INVALID_INDEX
 = 0xF9,

290 
	mMAC_STA_INVALID_PARAMETER
 = 0xE8,

291 
	mMAC_STA_LIMIT_REACHED
 = 0xFA,

292 
	mMAC_STA_NO_ACK
 = 0xE9,

293 
	mMAC_STA_NO_BEACON
 = 0xEA,

294 
	mMAC_STA_NO_DATA
 = 0xEB,

295 
	mMAC_STA_NO_SHORT_ADDRESS
 = 0xEC,

296 
	mMAC_STA_ON_TIME_TOO_LONG
 = 0xF6,

297 
	mMAC_STA_OUT_OF_CAP
 = 0xED,

298 
	mMAC_STA_PAN_ID_CONFLICT
 = 0xEE,

299 
	mMAC_STA_PAST_TIME
 = 0xF7,

300 
	mMAC_STA_READ_ONLY
 = 0xFB,

301 
	mMAC_STA_REALIGNMENT_GOT
 = 0xEF,

302 
	mMAC_STA_IN_SCAN_DOING
 = 0xFC,

303 
	mMAC_STA_SECURITY_ERROR
 = 0xE4,

304 
	mMAC_STA_SUPERFRAME_OVERLAP
 = 0xFD,

305 
	mMAC_STA_TRACKING_OFF
 = 0xF8,

306 
	mMAC_STA_TRANSACTION_EXPIRED
 = 0xF0,

307 
	mMAC_STA_TRANSACTION_OVERFLOW
 = 0xF1,

308 
	mMAC_STA_TX_ACTIVE
 = 0xF2,

309 
	mMAC_STA_KEY_UNAVAILABLE
 = 0xF3,

310 
	mMAC_STA_UNSUPPORTED_ATTRIBUTE
 = 0xF4,

311 
	mMAC_STA_UNSUPPORTED_LEGACY
 = 0xDE,

312 
	mMAC_STA_UNSUPPORTED_SECURITY
 = 0xDF,

313 
	mMAC_STA_UNSUPPORTED
 = 0x18,

314 
	mMAC_STA_BAD_STATE
 = 0x19,

315 
	mMAC_STA_NO_RESOURCES
 = 0x1A,

317 
	mMAC_STA_FRAME_PENDING
 = 0x20,

319 
	mMAC_TX_ABORTED
 = 0x1D,

320 }
	tmac_°s_t
;

331 
	ezb_mac_sˇn_ty≥_e
{

332 
	mED_SCAN
 = 0,

333 
	mACTIVE_SCAN
 = 1,

334 
	mPASSIVE_SCAN
 = 2,

335 
	mORPHAN_SCAN
 = 3

339 
	mZB_MAC_DISASSOCIATE_REASON_RESV
 = 0,

340 
	mZB_MAC_DISASSOCIATE_REASON_COORD2DEV
 = 1,

341 
	mZB_MAC_DISASSOCIATE_REASON_DEV
 = 2,

346 
u8
 
	mÆtP™Co‹d
: 1;

347 
u8
 
	mdevTy≥
: 1;

348 
u8
 
	mpowîSrc
: 1;

349 
u8
 
	mrcvOnWhíIdÀ
: 1;

350 
u8
 
	mª£rved
: 2;

351 
u8
 
	m£cuC≠abûôy
: 1;

352 
u8
 
	mÆlocAddr
: 1;

353 }
	tˇ∑bûôy_öfo_t
;

359 
u8
 
	mkeySour˚
[
MAC_KEY_SOURCE_MAX_LEN
];

360 
u8
 
	m£curôyLevñ
;

361 
u8
 
	mkeyIdMode
;

362 
u8
 
	mkeyIndex
;

363 } 
	tmac_£c_t
;

369 
u32
 
	mtime°amp
;

371 
u16
 
	mco‹dP™Id
;

372 
u16
 
	msu≥r‰ameS≥c
;

374 
addr_t
 
	mco‹dAddr
;

375 
mac_£c_t
 
	m£c
;

376 
u8
 
	mlogiˇlCh™√l
;

378 
u8
 
	mch™√lPage
;

379 
u8
 
	mgtsPîmô
;

380 
u8
 
	mlökQuÆôy
;

382 
u8
 
	m£curôyFaûuª
;

383 
u8
 
	mrsv
[3];

384 }
	tmac_∑nDesc_t
;

390 
addr_t
 
	m§cAddr
;

391 
u16
 
	md°P™Id
;

392 
addr_t
 
	md°Addr
;

393 
u8
 
	mmsduLígth
;

394 
u8
 *
	mmsdu
;

395 
u8
 
	mmsduH™dÀ
;

396 
u8
 
	mtxO±i⁄s
;

397 
u8
 
	m£curôyLevñ
;

398 
u8
 
	mkeyIdMode
;

399 
u64
 
	mkeySour˚
;

400 
u8
 
	mkeyIndex
;

401 }
	tzb_ms˝_d©a_ªq_t
;

407 
u32
 
	mtime°amp
;

408 
u8
 *
	mmsdu
;

409 
u8
 
	mmsduH™dÀ
;

410 
u8
 
	m°©us
;

411 
u16
 
	mmacD°Addr
;

412 
s8
 
	mrssi
;

413 
u8
 
	mlqi
;

414 }
	tzb_ms˝_d©a_c⁄f_t
;

420 
u32
 
	mtime°amp
;

421 
u8
 *
	mmsdu
;

422 
u64
 
	mKeySour˚
;

423 
u16
 
	m§cP™Id
;

424 
u16
 
	md°P™Id
;

425 
addr_t
 
	m§cAddr
;

426 
u8
 
	mmsduLígth
;

427 
addr_t
 
	md°Addr
;

428 
u8
 
	mmpduLökQuÆôy
;

429 
u8
 
	md¢
;

430 
u8
 
	m£curôyLevñ
;

431 
u8
 
	mkeyIdMode
;

432 
u8
 
	mkeyIndex
;

433 }
	tzb_ms˝_d©a_öd_t
;

439 
u8
 
	mmsduH™dÀ
;

440 }
	tzb_ms˝_purge_ªq_t
;

443 
u8
 
	mmsduH™dÀ
;

444 
u8
 
	m°©us
;

445 }
	tzb_ms˝_purge_c⁄f_t
;

453 
u8
 
	mlogiˇlCh™√l
;

454 
u8
 
	mch™√lPage
;

455 
u16
 
	mco‹dP™Id
;

457 
addr_t
 
	mco‹dAddªss
;

458 
ˇ∑bûôy_öfo_t
 
	mˇpbûôyInfo
;

459 
mac_£c_t
 
	m£c
;

460 }
	tzb_mlme_assocüã_ªq_t
;

463 
addrExt_t
 
	mdevAddªss
;

464 
ˇ∑bûôy_öfo_t
 
	mˇpbûôyInfo
;

465 
u8
 
	mlqi
;

466 
mac_£c_t
 
	m£c
;

467 }
	tzb_mlme_assocüã_öd_t
;

470 
u16
 
	msh‹tAddªss
;

471 
addrExt_t
 
	mdevAddªss
;

472 
u8
 
	m°©us
;

473 
mac_£c_t
 
	m£c
;

474 }
	tzb_mlme_assocüã_ª•_t
;

477 
addrExt_t
 
	m∑ª¡Addªss
;

478 
u16
 
	msh‹tAddªss
;

479 
u8
 
	m°©us
;

480 
mac_£c_t
 
	m£c
;

481 }
	tzb_mlme_assocüã_c⁄f_t
;

489 
u16
 
	mdevP™Id
;

490 
addr_t
 
	mdevAddr
;

491 
u8
 
	mdißssocüãRós⁄
;

492 
boﬁ
 
	mtxIndúe˘
;

493 
mac_£c_t
 
	m£c
;

494 }
	tzb_mlme_dißssocüã_ªq_t
;

497 
addrExt_t
 
	mdevAddªss
;

498 
u8
 
	mdißssocüãRós⁄
;

499 
mac_£c_t
 
	m£c
;

500 }
	tzb_mlme_dißssocüã_öd_t
;

503 
u16
 
	mdevP™Id
;

504 
addr_t
 
	mdevAddr
;

505 
u8
 
	m°©us
;

506 }
	tzb_mlme_dißssocüã_c⁄f_t
;

515 
mac_∑nDesc_t
 
	m∑nDesc
;

516 
u8
 *
	mpAddrLi°
;

517 
u8
 *
	mpsdu
;

518 
u8
 
	mb¢
;

519 
u8
 
	m≥ndAddrS≥c
;

520 
u8
 
	mpsduLígth
;

521 
u8
 
	mªsved
;

522 }
	tzb_mlme_bóc⁄_nŸify_öd_t
;

533 
u16
 
	m∑nId
;

534 
addr_t
 
	m§cAddr
;

535 
addr_t
 
	md°Addr
;

536 
u8
 
	m°©us
;

537 
mac_£c_t
 
	m£c
;

538 }
	tzb_mlme_comm_°©us_öd_t
;

544 
boﬁ
 
	m£tAsDeÁu…
;

545 }
	tmac_mlme_ª£t_ªq_t
;

551 
u8
 
	m°©us
;

552 }
	tmac_mlme_ª£t_c⁄f_t
;

559 
u8
 
	m¥imôive
;

560 
u32
 
	mrxOnTime
;

561 
mac_£c_t
 
	m£c
;

562 }
	tmac_mlme_rxOnE«bÀReq_t
;

569 
u8
 
	m¥imôive
;

570 
u8
 
	m°©us
;

571 }
	tmac_mlme_rxOnE«bÀCnf_t
;

578 
u32
 
	msˇnCh™√ls
;

579 
u8
 
	msˇnTy≥
;

580 
u8
 
	msˇnDuøti⁄
;

581 
u8
 
	mch™√lPage
;

582 
mac_£c_t
 
	m£c
;

583 }
	tzb_mac_mlme_sˇn_ªq_t
;

590 
u8
 
	m°©us
;

591 
u8
 
	msˇnTy≥
;

592 
u8
 
	mch™√lPage
;

593 
u8
 
	mªsu…Li°Size
;

596 
u32
 
	munsˇ¬edCh™√ls
;

599 
u8
 
	míîgyDëe˘Li°
[
MAX_ED_SCAN_RESULTS_SUPPORTED
];

600 
mac_∑nDesc_t
 
	m∑nDescLi°
[
MAX_PAN_DESC_SUPPORTED
];

601 }
	mªsu…Li°
;

602 }
	tzb_mac_mlme_sˇn_c⁄f_t
;

608 
u32
 
	m°¨tTime
;

610 
u16
 
	m∑nId
;

611 
u8
 
	mlogiˇlCh™√l
;

612 
u8
 
	mch™√lPage
;

614 
u8
 
	mbóc⁄Ordî
;

615 
u8
 
	msu≥r‰ameOrdî
;

616 
u8
 
	m∑nCo‹dö©‹
;

617 
u8
 
	mb©ãryLi„Ext
;

619 
mac_£c_t
 
	mco‹dRólignSec
;

620 
u8
 
	mco‹dRólignmít
;

622 
mac_£c_t
 
	mbóc⁄Sec
;

623 }
	tzb_mac_mlme_°¨t_ªq_t
;

630 
u8
 
	m°©us
;

631 }
	tmac_mlme_°¨tCnf_t
;

637 
u16
 
	mco‹dP™Id
;

638 
é_zb_addr_t
 
	mco‹dAddr
;

639 
u8
 
	mco‹dAddrMode
;

640 }
	tmac_mlme_pﬁl_ªq_t
;

646 
u8
 
	m°©us
;

647 }
	tmac_mlme_pﬁl_c⁄f_t
;

653 
u8
 
	maddrMode
;

654 
é_zb_addr_t
 
	mdevAddr
;

655 }
	tmac_mlme_pﬁl_öd_t
;

661 
addrExt_t
 
	m‹ph™Addr
;

662 }
	tmac_mlme_‹ph™_öd_t
;

668 
addrExt_t
 
	m‹ph™Addr
;

669 
u16
 
	msh‹tAddr
;

671 
boﬁ
 
	massocüãd
;

673 }
	tmac_mlme_‹ph™_ª•_t
;

680 
	mZB_SYNC_LOSS_REASON_PAN_ID_CONFLICT
,

681 
	mZB_SYNC_LOSS_REASON_REALIGNMENT
,

682 
	mZB_SYNC_LOSS_REASON_BEACON_LOST


683 }
	tzb_sync_loss_ªas⁄_t
;

689 
u16
 
	m∑nId
;

691 
zb_sync_loss_ªas⁄_t
 
	mªas⁄
;

692 
u8
 
	mlogiˇlCh™√l
;

693 
u8
 
	mch™√lPage
;

694 }
	tzb_mlme_sync_loss_öd_t
;

697 
u8
 
	m§cAddrMode
;

698 
u8
 
	md°AddrMode
;

699 
é_zb_addr_t
 
	m§cAddr
;

700 
é_zb_addr_t
 
	md°Addr
;

701 
u8
 
	mcbTy≥
;

702 }
	tzb_mlme_d©a_ªq_cmd_t
;

705 
u32
 
	mtime°amp
;

706 
u8
 *
	mpsdu
;

707 
u16
 
	m§cP™Id
;

708 
addr_t
 
	m§cAddr
;

709 
u8
 
	mÀn
;

710 
u8
 
	mlqi
;

711 
u8
 
	mcurCh™√l
;

712 }
	tzb_mac_øw_‰ame_t
;

715 
	#ZB_MAC_GTS_DESCROPTION_NUM_MAX
 7

	)

718 
u8
 
	mbóc⁄Ordî
:4;

719 
u8
 
	msu≥r‰ameOrdî
:4;

720 
u8
 
	mföÆC≠SlŸ
:4;

721 
u8
 
	mb©ãryLi„Exãnsi⁄
:1;

722 
u8
 
	mªsv
:1;

723 
u8
 
	m∑nCo‹dö©‹
:1;

724 
u8
 
	massocüãPîmô
:1;

725 }
	tzb_su≥r‰ame_•ec_t
;

728 
u8
 
	mdescCou¡
:3;

729 
u8
 
	mªsv
:4;

730 
u8
 
	m≥rmô
:1;

731 }
	tzb_gts_•ec_t
;

734 
u8
 
	msh‹tAddr
[2];

735 
u8
 
	m°¨tSlŸ
:4;

736 
u8
 
	mÀn
:4;

737 }
	tzb_gts_desc_t
;

740 
zb_gts_•ec_t
 
	m•ec
;

741 
u8
 
	mdúe˘i⁄
;

742 
zb_gts_desc_t
 
	mdesc
[
ZB_MAC_GTS_DESCROPTION_NUM_MAX
];

743 }
	tzb_mac_gts_t
;

746 
u8
 
	msh‹tPídögAddrNum
:3;

747 
u8
 
	mªsv0
:1;

748 
u8
 
	mextPídögAddrNum
:3;

749 
u8
 
	mªsv1
:1;

750 }
	tzb_≥ndög_addr_•ec_t
;

753 
zb_≥ndög_addr_•ec_t
 
	m•ec
;

754 
u8
 
	mdúe˘i⁄
;

755 
zb_gts_desc_t
 
	mdesc
[
ZB_MAC_GTS_DESCROPTION_NUM_MAX
];

756 }
	tzb_mac_≥ndög_addr_t
;

762 
	szb_mac_bóc⁄_∑ylﬂd_s
{

763 
u8
 
	m¥Ÿocﬁ_id
;

764 
u8
 
	m°ack_¥ofûe
:4;

765 
u8
 
	m¥Ÿocﬁ_vîsi⁄
:4;

767 
u8
 
	ml⁄g_u±ime
:1;

768 
u8
 
	mtc_c⁄√˘ivôy
:1;

769 
u8
 
	mrouãr_ˇ∑côy
:1;

770 
u8
 
	mdevi˚_dïth
:4;

771 
u8
 
	míd_devi˚_ˇ∑côy
:1;

773 
extPANId_t
 
	mexãnded_∑nid
;

774 
u8
 
	mtxoff£t
[3];

775 
u8
 
	mnwk_upd©e_id
;

776 } 
	tzb_mac_bóc⁄_∑ylﬂd_t
;

779 
u8
 
	mcmdId
;

780 }
	tzb_rÂkt_bóc⁄_ªq_t
;

783 
zb_su≥r‰ame_•ec_t
 
	msu≥rFømeS≥c
;

784 
zb_mac_gts_t
 
	mgts
;

785 
zb_mac_≥ndög_addr_t
 
	m≥ndögAddr
;

786 
zb_mac_bóc⁄_∑ylﬂd_t
 
	mbóc⁄Paylﬂd
;

787 }
	tzb_rÂkt_bóc⁄_t
;

793 
	mZB_INDRECT_IDLE
,

794 
	mZB_INDRECT_ASSOCIATE
,

795 
	mZB_INDRECT_POLL
,

796 
	mZB_INDRECT_ASSOCIATE_RESPONSE
,

797 
	mZB_INDRECT_MCPS_DATA
,

798 
	mZB_INDRECT_DISASSOCIATE_NOTIFY


806 (*
	té_zb_max_tx_c⁄f_cb
)(*
	t¨g
, 
	tu8
 
	t°©us
);

809 *
¨g
;

810 
é_zb_max_tx_c⁄f_cb
 
cb
;

811 }
	té_zb_max_tx_c⁄f_t
;

816 
	smac_ödúPídögLi°_t
{

817 
mac_ödúPídögLi°_t
 *
√xt
;

818 *
d©a
;

819 
addr_t
 
d°Addr
;

820 
u8
 
expúy
;

821 
u8
 
extExpúyC¡
;

822 
u8
 
°©e
;

823 
u8
 
°©us
;

824 }
	tmac_ödúPídögLi°_t
;

827 
MAC_PENDIND_READY
 = 0x1,

828 
MAC_PENDIND_TX_READY
 = 0x2,

829 
MAC_PENDIND_TXING
 = 0x3,

830 
MAC_PENDIND_EXPIRY
 = 0x4,

836 
	szb_mac_≥ndög_d©a_s
{

837 
zb_buf_t
 *
≥ndög_d©a
;

838 
zb_addr_mode_t
 
d°_addr_mode
;

839 
é_zb_addr_t
 
d°_addr
;

840 }
	tzb_mac_≥ndög_d©a_t
;

846 
u8
 
w¨mSèπ
;

847 
u8
 
°©us
;

848 
u8
 
curCh™√l
;

849 
u8
 
bóc⁄TrõsNum
;

852 
ev_timî_evít_t
 *
timî
; ;

853 }
ödúe˘D©a
;

855 
u8
 *
txRawD©aBuf
;

856 }
	té_zb_mac_˘x_t
;

862 
u16
 
‰ameCål
;

863 
u8
 
d°AddrMode
;

864 
u8
 
§cAddrMode
;

865 
u8
 
∑nIdMode
;

866 
u8
 
£qNum
;

867 
u16
 
d°P™Id
;

868 
é_zb_addr_t
 
d°Addr
;

869 
u16
 
§cP™Id
;

870 
é_zb_addr_t
 
§cAddr
;

871 #ifde‡
ZB_MAC_SECURITY


872 
u8
 
£cLevñ
;

873 
u8
 
keyIdMode
;

874 
u8
 
keySrc
[8];

875 
u8
 
keyIdx
;

876 
u32
 
‰amCou¡î
;

878 }
	té_zb_mac_mhr_t
;

884 
u8
 
§cAddrMode
;

885 
u8
 
£cE«bÀ
;

886 
u8
 
‰amePídög
;

887 
u8
 
bÀ
;

888 
u8
 
bóc⁄Ordî
;

889 
u16
 
su≥r‰ameOrdî
;

890 }
	té_zbBóc⁄Føme_t
;

896 
MAC_ASS_CONFIRM_CALLBACK
 = 0,

897 
MAC_POLL_REQUEST_CALLBACK
 = 1

898 }
	tzb_ˇŒback_ty≥_t
;

901 
u16
 
sh‹tAddr
;

902 
addrExt_t
 
õìAddr
;

903 }
	tac˚ss_addr_t
;

908 
u8
 
ZB_MAC_PENDING_TRANS_QUEUE_SIZE
;

909 
u8
 
ZB_MAC_EXT_EXPEIRY_CNT
;

910 
é_zb_mac_˘x_t
 
g_zbMacCtx
;

912 
	#TL_ZB_MAC_STATUS_SET
(
°a
Ë(
g_zbMacCtx
.
°©us
 = sè)

	)

913 
	#TL_ZB_MAC_STATUS_GET
(Ë(
g_zbMacCtx
.
°©us
)

	)

920 
	#ZB_PIB_SHORT_ADDRESS
(Ë(
g_zbMacPib
.
sh‹tAddªss
)

	)

924 
	#ZB_PIB_EXTENDED_ADDRESS
(Ë(
g_zbMacPib
.
extAddªss
)

	)

928 
	#ZB_PIB_RX_ON_WHEN_IDLE
(Ë(
g_zbMacPib
.
rxOnWhíIdÀ
)

	)

932 
	#ZB_PIB_ACK_WAIT_DURATION
(Ë(
g_zbMacPib
.
ackWaôDuøti⁄
)

	)

936 
	#ZB_MAC_DSN
(Ë(
g_zbMacPib
.
£qNum
)

	)

940 
	#ZB_MAC_BSN
(Ë(
g_zbMacPib
.
bóc⁄SeqNum
)

	)

944 
	#ZB_INC_MAC_DSN
(Ë(
g_zbMacPib
.
£qNum
++)

	)

948 
	#ZB_INC_MAC_BSN
(Ë(
g_zbMacPib
.
bóc⁄SeqNum
++)

	)

952 
	#ZB_PIB_BEACON_PAYLOAD
(Ë(
g_zbMacPib
.
bóc⁄Paylﬂd
)

	)

958 
	`é_zbMacCh™√lSë
(
u8
 
ch™
);

960 
	#ZB_TRANSCEIVER_SET_CHANNEL
(
chn
Ë
	`é_zbMacCh™√lSë
(chn);

	)

963 
	`é_zbMacRe£t
();

973 
	`é_zbMacInô
(
u8
 
cﬁdRe£t
);

983 
	`é_zbMacTaskProc
();

986 
	`é_zbMacM˝sD©aReque°Proc
(*
¨g
);

1000 
	#é_zbMacM˝sD©aRequ°
(
p
Ë
	`é_zbMacM˝sD©aReque°Proc
’)

	)

1010 
	#é_zbMacRe£tRequ°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_RESET_REQ
,Ö)

	)

1020 
	#é_zbMacPﬁlRequ°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_POLL_REQ
,Ö)

	)

1030 
	#é_zbMacAssocüãReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_ASSOCIATE_REQ
,Ö)

	)

1040 
	#é_zbMacAssocüãRe•⁄£
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_ASSOCIATE_RES
,Ö)

	)

1050 
	#é_zbMacOΩh™Re•⁄£
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_ORPHAN_RES
,Ö)

	)

1060 
	#é_zbMacSˇnReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_SCAN_REQ
,Ö)

	)

1071 
	#é_zbMacSèπReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2MAC
, 
MAC_MLME_START_REQ
,Ö)

	)

1086 
	#é_zbMacRe£tC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_RESET_CNF
,Ö)

	)

1096 
	#é_zbMacAssocüãC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_ASSOCIATE_CNF
,Ö)

	)

1106 
	#é_zbMacDißssocüãC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_DISASSOCIATE_CNF
,Ö)

	)

1116 
	#é_zbMacAssocüãIndiˇã
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_ASSOCIATE_IND
,Ö)

	)

1126 
	#é_zbMacDißssocüãIndiˇã
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_DISASSOCIATE_IND
,Ö)

	)

1136 
	#é_zbMacD©aIndiˇã
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MCPS_DATA_IND
,Ö)

	)

1146 
	#é_zbMacD©aC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MCPS_DATA_CNF
,Ö)

	)

1156 
	#é_zbMacPurgeC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MCPS_PURGE_CNF
,Ö)

	)

1166 
	#é_zbMacPﬁlC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_POLL_CNF
,Ö)

	)

1176 
	#é_zbMacPﬁlIndiˇti⁄
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_POLL_IND
,Ö)

	)

1186 
	#é_zbMacBóc⁄NŸifyIndiˇã
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_BEACON_NOTIFY_IND
,Ö)

	)

1196 
	#é_zbMacOΩh™Indiˇã
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_ORPHAN_IND
,Ö)

	)

1206 
	#é_zbMacSˇnC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_SCAN_CNF
,Ö)

	)

1216 
	#é_zbMacCommSètusIndiˇti⁄
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_COMM_STATUS_IND
,Ö)

	)

1226 
	#é_zbMacSèπC⁄fúm
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_START_CNF
,Ö)

	)

1236 
	#é_zbMacSyncLossIndiˇti⁄
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_MAC2NWK
, 
MAC_MLME_SYNC_LOSS_IND
,Ö)

	)

1241 
	$boﬁ
 (*
	tmac_ˇŒback
)(*
	tp
);

1244 
mac_ˇŒback
 
macBóc⁄ReqRcvCb
;

1245 
mac_ˇŒback
 
macBóc⁄RcvCb
;

1246 
mac_ˇŒback
 
macAssocüti⁄ReqRcvCb
;

1247 }
	tmac_≠pIndCb_t
;

1249 
mac_≠pIndCb_t
 *
macAµIndCb
;

1251 
	`mac_≠pIndCbRegi°î
(
mac_≠pIndCb_t
 *
cb
);

	@zigbee/mac/includes/tl_zb_mac_pib.h

24 #i‚de‡
TL_ZB_MAC_PIB_H


25 
	#TL_ZB_MAC_PIB_H


	)

28 
	#MAC_INVALID_PANID
 0xFFFF

	)

30 
	#MAC_DEVICE_TABLE_SIZE
 4

	)

35 
	#ZB_PHY_MAX_PACKET_SIZE
 127

	)

36 
	#ZB_PHY_TURNROUNDTIME
 12

	)

37 
	#ZB_US_PER_SYMBOL
 16

	)

42 
	#ZB_PHY_SYMBOLS_PER_OCTET
 2

	)

43 
	#ZB_PHY_SHR_DURATION
 40

	)

44 
	#ZB_PHY_MAX_FRAME_DURATION
 (
ZB_PHY_SHR_DURATION
 + (
ZB_PHY_MAX_PACKET_SIZE
 + 1Ë* 
ZB_PHY_SYMBOLS_PER_OCTET
)

	)

51 
	#ZB_MAC_BASE_SLOT_DURATION
 60

52 
	#ZB_MAC_NUM_SUPERFRAME_SLOTS
 16

53 
	#ZB_MAC_BASE_SUPERFRAME_DURATION
 (
ZB_MAC_BASE_SLOT_DURATION
 * 
ZB_MAC_NUM_SUPERFRAME_SLOTS
)

	)

55 
	#ZB_MAC_BASE_SUPERFRAME_DURATION_US
 (
ZB_MAC_BASE_SLOT_DURATION
 * 
ZB_MAC_NUM_SUPERFRAME_SLOTS
 * 
ZB_US_PER_SYMBOL
)

	)

57 
	#ZB_MAC_UNIT_BACKOFF_PERIOD
 (20)

58 
	#ZB_MAC_UNIT_BACKOFF_PERIOD_US
 (
ZB_MAC_UNIT_BACKOFF_PERIOD
 * 
ZB_US_PER_SYMBOL
)

59 
	#ZB_MAC_MIN_MPDU_OVERHEAD
 (9)

60 
	#ZB_MAC_MIN_CAP_LEHGTH
 (440)

61 
	#ZB_MAC_MAX_SIF_FRAME_SIZE
 (18)

62 
	#ZB_MAC_MAX_MPDU_UNSECURITY_OVERHEAD
 (25)

63 
	#ZB_MAC_MAX_MAC_PAYLOAD_SIZE
 (
ZB_PHY_MAX_PACKET_SIZE
 - 
ZB_MAC_MIN_MPDU_OVERHEAD
)

	)

65 
	#ZB_MAC_MAX_MAC_SAFE_PAYLOAD_SIZE
 (
ZB_PHY_MAX_PACKET_SIZE
 - 
ZB_MAC_MAX_MPDU_UNSECURITY_OVERHEAD
)

	)

67 
	#ZB_MAC_MAX_LOST_BEACONS
 (4)

68 
	#ZB_MAC_MAX_BEACON_OVERHEAD
 (75)

69 
	#ZB_MAC_MAX_BEACON_PAYLOAD_LENGTH
 (
ZB_PHY_MAX_PACKET_SIZE
 - 
ZB_MAC_MAX_BEACON_OVERHEAD
)

	)

71 
	#ZB_MAC_GTS_DESC_PERSISTENCE_TIME
 (4)

72 

	)

77 
	#ZB_MAC_WAIT_RESP_TIME_DEFAULT
 (32)

	)

78 
	#ZB_MAC_FRAME_RETRIES_MAX
 (3)

	)

81 #ifde‡
ZB_MAC_SECURITY


82 
	szb_mac_devi˚_èbÀ_s
{

83 
u32
 
	m‰ameCou¡î
;

84 
u16
 
	msh‹tAddr
;

85 
addrExt_t
 
	mextAddr
;

86 
u16
 
	m∑nId
;

87 }
	té_zb_mac_devi˚_èbÀ_t
;

94 
u32
 
	mbóc⁄TxTime
;

95 
addrExt_t
 
	mco‹dExtAddªss
;

96 
addrExt_t
 
	mextAddªss
;

97 
u16
 
	mackWaôDuøti⁄
;

98 
u16
 
	mco‹dSh‹tAddªss
;

99 
u16
 
	m∑nId
;

100 
u16
 
	msh‹tAddªss
;

101 
u16
 
	msu≥r‰ameOrdî
;

102 
u16
 
	må™ß˘i⁄Pîsi°í˚Time
;

103 
u16
 
	m‰ameTŸÆWaôTime
;

104 
u16
 
	msyncSymbﬁOff£t
;

105 
zb_mac_bóc⁄_∑ylﬂd_t
 
	mbóc⁄Paylﬂd
;

106 
u8
 
	mbóc⁄PaylﬂdLí
;

107 
u8
 
	massocüti⁄Pîmô
;

108 
u8
 
	massocüãdP™Co‹d
;

109 
u8
 
	mautoReq
;

110 
u8
 
	mb©tLi„Ext
;

111 
u8
 
	mb©tLi„ExtPîiods
;

112 
u8
 
	mbóc⁄Ordî
;

113 
u8
 
	mbóc⁄SeqNum
;

114 
u8
 
	m£qNum
;

115 
u8
 
	m‰ameRëryNum
;

116 
u8
 
	mª•WaôTime
;

117 
u8
 
	mmaxCsmaBackoffs
;

118 
u8
 
	m¥omiscuousMode
;

119 
u8
 
	mtimeSèmpSuµ‹ãd
;

120 
u8
 
	m£curôyE«bÀd
;

122 
u8
 
	mgtsPîmô
;

123 
u8
 
	mmöBe
;

124 
u8
 
	mmaxBe
;

125 
u8
 
	mphyPageCur
;

126 
u8
 
	mphyCh™√lCur
;

127 
u8
 
	mrxOnWhíIdÀ
;

128 
u8
 
	mtxPowî
;

129 
u8
 
	mªsv
[3];

131 #ifde‡
ZB_MAC_SECURITY


132 
é_zb_mac_devi˚_èbÀ_t
 
	mdevTabÀ
[
MAC_DEVICE_TABLE_SIZE
];

133 
u8
 
	mdevTabÀE¡ry
;

134 
u32
 
	m‰ameCou¡î
;

135 
u8
 
	m£cKey
[16];

137 }
	té_zb_mac_pib_t
;

141 
	#MAC_IB
(Ë
g_zbMacPib


	)

146 
gíî©eIEEEAddr
();

160 
u8
 
é_zbMacAârSë
(u8 
©åibuã
, u8 *
vÆue
, u8 
Àn
);

174 
u8
 
é_zbMacAârGë
(u8 
©åibuã
, u8* 
vÆue
, u8* 
Àn
);

	@zigbee/mac/mac_phy.c

27 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

28 
	~"compûî.h
"

33 
	#LOGICCHANNEL_TO_PHYSICAL
(
p
Ë((’)-10Ë* 5)

	)

35 
	#RF_DROP_REASON_INVALID_CRC
 0x01

	)

36 
	#RF_DROP_REASON_RF_BUSY
 0x02

	)

37 
	#RF_DROP_REASON_EXPECT_ACK
 0x03

	)

38 
	#RF_DROP_REASON_INVALIC_BEACON
 0x04

	)

39 
	#RF_DROP_REASON_FILTER_PANID
 0x05

	)

40 
	#RF_DROP_REASON_FILTER_DSTADDR
 0x06

	)

41 
	#RF_DROP_REASON_FILTER_LEN
 0x07

	)

42 
	#RF_DROP_REASON_INVALIC_FRAME_TYPE
 0x08

	)

49 
	mRF_GAIN_MODE_AUTO
,

50 
	mRF_GAIN_MODE_MANU_MAX
,

51 } 
	trf_rxGaöMode_t
;

56 
u8
 
	gg_zb_txPowîSë
 = 
ZB_DEFAULT_TX_POWER_IDX
;

61 
	$_©åibuã_Æig√d_
(4Ë
u8
 
rf_tx_buf
[
ZB_RADIO_TX_HDR_LEN
 + 127];

62 
	$_©åibuã_Æig√d_
(4Ë
u8
 
rf_ack_buf
[
ZB_RADIO_TX_HDR_LEN
 + 7];

64 
u8
 *
rf_rxBuf
 = 
NULL
;

65 
u8
 
rfMode
 = 
RF_STATE_TX
;

66 vﬁ©ûê
u8
 
rf_busyFœg
 = 0;

68 vﬁ©ûê
s8
 
so·_rssi
;

69 vﬁ©ûê
s32
 
sum_rssi
, 
˙t_rssi
 = 1;

71 
u8
 
fPaEn
;

72 
u32
 
rf_∑_txí_pö
;

73 
u32
 
rf_∑_rxí_pö
;

78 
	#ZB_SWTICH_TO_TXMODE
(Ë\

	)

81 i‡(
fPaEn
) \

83 
	`drv_gpio_wrôe
(
rf_∑_txí_pö
, 1); \

84 
	`drv_gpio_wrôe
(
rf_∑_rxí_pö
, 0); \

86 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_TX
, 
	`LOGICCHANNEL_TO_PHYSICAL
(
	`rf_gëCh™√l
())); \

87 
	}
} 0)

89 
	#ZB_SWTICH_TO_RXMODE
(Ë\

	)

92 i‡(
fPaEn
) \

94 
	`drv_gpio_wrôe
(
rf_∑_txí_pö
, 0); \

95 
	`drv_gpio_wrôe
(
rf_∑_rxí_pö
, 1); \

97 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_RX
, 
	`LOGICCHANNEL_TO_PHYSICAL
(
	`rf_gëCh™√l
())); \

98 
	}
} 0)

109 
	$rf_ª£t
()

111 
	`rf_£tTrxSèã
(
RF_STATE_TX
);

113 
	`rf_£tTxPowî
(
g_zb_txPowîSë
);

115 
	`rf_£tCh™√l
(
g_zbMacPib
.
phyCh™√lCur
);

117 i‡(
rf_rxBuf
)

119 
	`rf_£tRxBuf
(
rf_rxBuf
);

123 
	`rf_£tRxBuf
(
	`é_gëRxBuf
());

126 
	`ZB_RADIO_TRX_CFG
(
RF_PKT_BUFF_LEN
);

128 
ZB_RADIO_RX_ENABLE
;

129 
ZB_RADIO_TX_ENABLE
;

130 
ZB_TIMESTAMP_ENABLE
;

131 
	}
}

133 
	$rf_edDëe˘
()

135 
s8
 
rssi
;

136 
rssi
 = 
	`ZB_RADIO_RSSI_GET
();

139 
sum_rssi
 +
rssi
;

140 i‡(++
˙t_rssi
 >= 0xfffffe)

142 
sum_rssi
 = sum_rssò/ 
˙t_rssi
;

143 
˙t_rssi
 = 1;

145 
	}
}

147 
	$rf_mac_ack_buûd
()

150 
	`mem£t
(
rf_ack_buf
, 0, 12);

152 
	`ZB_RADIO_DMA_HDR_BUILD
(
rf_ack_buf
, 3);

154 
rf_ack_buf
[4] = 5;

155 
rf_ack_buf
[5] = 0x02;

156 
rf_ack_buf
[6] = 0x00;

157 
	}
}

168 
	$rf_öô
()

170 
	`rf_ª£t
();

172 
	`rf_mac_ack_buûd
();

175 
	`ev_⁄_pﬁl
(
EV_POLL_ED_DETECT
, 
rf_edDëe˘
);

176 
	`ev_dißbÀ_pﬁl
(
EV_POLL_ED_DETECT
);

177 
	}
}

188 
	$rf_£tRxBuf
(
u8
 *
pBuf
)

190 
rf_rxBuf
 = 
pBuf
;

191 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

192 
	`ZB_RADIO_RX_BUF_SET
(
rf_rxBuf
);

193 
	}
}

204 
u8
 
	$rf_TrxSèãGë
()

206  
rfMode
;

207 
	}
}

218 
_©åibuã_øm_code_
 
	$rf_£tTrxSèã
(
u8
 
°©e
)

220 #i‚de‡
WIN32


221 i‡(
RF_STATE_RX
 =
°©e
 || 
RF_STATE_ED
 == state)

223 i‡(
	`TL_ZB_MAC_STATUS_GET
(Ë=
ZB_MAC_STATE_ACTIVE_SCAN
 || 
RF_STATE_ED
 =
°©e
)

225 
	`ZB_RADIO_MODE_AUTO_GAIN
();

229 
	`ZB_RADIO_MODE_MAX_GAIN
();

232 
	`ZB_SWTICH_TO_RXMODE
();

233 
rfMode
 = 
RF_STATE_RX
;

235 i‡(
RF_STATE_TX
 =
°©e
)

237 
	`ZB_SWTICH_TO_TXMODE
();

238 
	`WaôUs
(
ZB_TX_WAIT_US
);

239 
rfMode
 = 
RF_STATE_TX
;

244 
	`rf_∑ShutDown
();

245 
	`ZB_RADIO_TRX_SWITCH
(
RF_MODE_OFF
, 
	`LOGICCHANNEL_TO_PHYSICAL
(
	`rf_gëCh™√l
()));

246 
rfMode
 = 
RF_STATE_OFF
;

249 
	}
}

260 
	$rf_£tCh™√l
(
u8
 
chn
)

262 i‡((
chn
 < 
TL_ZB_MAC_CHANNEL_START
Ë|| (ch¿> 
TL_ZB_MAC_CHANNEL_STOP
))

266 
g_zbMacPib
.
phyCh™√lCur
 = 
chn
;

267 
	`ZB_RADIO_TRX_SWITCH
(
	`ZB_RADIO_TRX_STA_GET
(), 
	`LOGICCHANNEL_TO_PHYSICAL
(
chn
));

268 
	}
}

279 
ölöe
 
u8
 
	$rf_gëCh™√l
()

281  
g_zbMacPib
.
phyCh™√lCur
;

282 
	}
}

293 
	$rf_£tTxPowî
(
u8
 
powî
)

295 i‡(
fPaEn
)

297 
	`ZB_RADIO_TX_POWER_SET
(
ZB_RADIO_TX_0DBM
);

301 
	`ZB_RADIO_TX_POWER_SET
(
powî
);

303 
	}
}

314 
u8
 
	$rf_gëLqi
(
s8
 
rssi
)

316 
rf_rxGaöMode_t
 
mode
 = 
RF_GAIN_MODE_MANU_MAX
;

317 i‡(
	`TL_ZB_MAC_STATUS_GET
(Ë=
ZB_MAC_STATE_ACTIVE_SCAN
)

319 
mode
 = 
RF_GAIN_MODE_AUTO
;

322 
u8
 
lqi
 = 0;

323 
	`ZB_RADIO_RSSI_TO_LQI
(
mode
, 
rssi
, 
lqi
);

324  
lqi
;

325 
	}
}

336 
	$rf_°¨tED
()

338 #i‚de‡
WIN32


339 
so·_rssi
 = -110;

340 
sum_rssi
 = 0;

341 
˙t_rssi
 = 0;

342 
	`ev_íabÀ_pﬁl
(
EV_POLL_ED_DETECT
);

344 
	`rf_£tTrxSèã
(
RF_STATE_ED
);

346 
	}
}

357 
u8
 
	$rf_°›ED
()

359 #i‚de‡
WIN32


360 
u8
 
ed
;

361 
u32
 
ãmp
;

363 i‡(
˙t_rssi
 == 0)

364 
˙t_rssi
 = 1;

365 
so·_rssi
 = 
sum_rssi
 / 
˙t_rssi
;

367 
	`ev_dißbÀ_pﬁl
(
EV_POLL_ED_DETECT
);

369 i‡(
so·_rssi
 <= -106)

371 
ed
 = 0;

373 i‡(
so·_rssi
 >= -6)

375 
ed
 = 0xff;

379 
ãmp
 = (
so·_rssi
 + 106) * 255;

380 
ed
 = 
ãmp
 / 100;

383  
ed
;

388 
	}
}

390 
_©åibuã_øm_code_
 
u8
 
	$rf_≥rf‹mCCA
()

392 
u32
 
t1
 = 
	`˛ock_time
();

393 
s8
 
rssi_≥ak
 = -110;

394 
s8
 
rssi_cur
 = -110;

395 
s32
 
rssiSum
 = 0;

396 
s32
 
˙t
 = 1;

398 
rssi_cur
 = 
	`ZB_RADIO_RSSI_GET
();

399 
rssiSum
 +
rssi_cur
;

400 !
	`˛ock_time_ex˚ed
(
t1
, 128))

402 
rssi_cur
 = 
	`ZB_RADIO_RSSI_GET
();

403 
rssiSum
 +
rssi_cur
;

404 
˙t
++;

406 
rssi_≥ak
 = 
rssiSum
 / 
˙t
;

408 i‡(
rssi_≥ak
 > 
CCA_THRESHOLD
 || (
rf_busyFœg
 & 
TX_BUSY
))

410  
PHY_CCA_BUSY
;

414  
PHY_CCA_IDLE
;

416 
	}
}

418 
	$rf802154_tx_ªady
(
u8
 *
buf
, u8 
Àn
)

421 
	`ZB_RADIO_DMA_HDR_BUILD
(
rf_tx_buf
, 
Àn
);

423 
rf_tx_buf
[4] = 
Àn
 + 2;

424 
	`mem˝y
(
rf_tx_buf
 + 5, 
buf
, 
Àn
);

425 
	}
}

427 
_©åibuã_øm_code_
 
	$rf802154_tx
()

429 
	`rf_£tTrxSèã
(
RF_STATE_TX
);

431 
ZB_RADIO_TX_DONE_CLR
;

432 
ZB_RADIO_RX_DONE_CLR
;

433 
	`ZB_RADIO_TX_START
(
rf_tx_buf
);

434 
	}
}

447 
	$rf_∑Inô
(
u32
 
TXEN_pö
, u32 
RXEN_pö
)

449 
rf_∑_txí_pö
 = 
TXEN_pö
;

450 
rf_∑_rxí_pö
 = 
RXEN_pö
;

452 
	`drv_gpio_func_£t
(
rf_∑_txí_pö
);

453 
	`drv_gpio_ouçut_í
(
rf_∑_txí_pö
, 1);

454 
	`drv_gpio_wrôe
(
rf_∑_txí_pö
, 0);

456 
	`drv_gpio_func_£t
(
rf_∑_rxí_pö
);

457 
	`drv_gpio_ouçut_í
(
rf_∑_rxí_pö
, 1);

458 
	`drv_gpio_wrôe
(
rf_∑_rxí_pö
, 1);

460 
fPaEn
 = 1;

461 
	}
}

463 
_©åibuã_øm_code_
 
	$rf_∑ShutDown
()

465 i‡(
fPaEn
)

467 
	`drv_gpio_wrôe
(
rf_∑_txí_pö
, 0);

468 
	`drv_gpio_wrôe
(
rf_∑_rxí_pö
, 0);

470 
	}
}

481 
_©åibuã_øm_code_
 
__©åibuã__
((
›timize
("-Os"))Ë
	$rf_rx_úq_h™dÀr
()

483 
u8
 *
p
 = 
rf_rxBuf
;

484 
u8
 
fAck
 = 0;

485 
u8
 
fDr›
 = 0;

486 
s32
 
txTime
 = 0;

487 
s32
 
txDñayUs
 = 0;

489 
ZB_RADIO_RX_DISABLE
;

491 
g_sysDügs
.
macRxIrqC¡
++;

494 
s32
 
rfRxC¡
 = 0;

495 
s8
 
rssi
 = 
	`ZB_RADION_PKT_RSSI_GET
(
p
) - 110;

496 
T_rxRssiBuf
[
rfRxC¡
++ & 0x3f] = 
rssi
;

498 
T_rxRssiPass
[0]++;

499 if(
rssi
 < 
RSSI_PASS_THRESHOLD
){

500 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

501 
ZB_RADIO_RX_ENABLE
;

504 
T_rxRssiPass
[1]++;

513 i‡((!
	`ZB_RADIO_CRC_OK
(
p
)Ë|| (!
	`ZB_RADIO_PACKET_LENGTH_OK
’)Ë|| (
rf_busyFœg
 & 
TX_BUSY
))

516 
g_sysDügs
.
macRxCrcFaû
++;

518 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

519 
ZB_RADIO_RX_ENABLE
;

524 
u8
 
Àn
 = (u8)
	`ZB_RADIO_ACTUAL_PAYLOAD_LEN
(
p
);

525 
u8
 *
macPld
 = 
p
 + 
ZB_RADIO_RX_HDR_LEN
;

530 
u8
 *
pSrcAddr
 = 
	`zb_macD©aFûãr
(
macPld
, 
Àn
, &
fDr›
, &
fAck
);

531 i‡(
fDr›
)

534 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

535 
ZB_RADIO_RX_ENABLE
;

540 i‡(
macPld
[0] & 
MAC_FCF_ACK_REQ_BIT
)

542 
	`ZB_SWTICH_TO_TXMODE
();

543 
txTime
 = 
	`˛ock_time
();

547 
u8
 *
rxNextBuf
 = 
	`é_gëRxBuf
();

548 i‡(!
rxNextBuf
)

550 i‡(
macPld
[0] & 
MAC_FCF_ACK_REQ_BIT
)

552 
	`ZB_SWTICH_TO_RXMODE
();

556 
g_sysDügs
.
phytoMACqueuñimôªached
++;

558 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

559 
ZB_RADIO_RX_ENABLE
;

564 
rf_rxBuf
 = 
rxNextBuf
;

565 
	`ZB_RADIO_RX_BUF_CLEAR
(
rf_rxBuf
);

566 
	`ZB_RADIO_RX_BUF_SET
(
rf_rxBuf
);

571 i‡(
macPld
[0] & 
MAC_FCF_ACK_REQ_BIT
)

573 
rf_ack_buf
[
ZB_RADIO_TX_HDR_LEN
 + 2] = 
macPld
[2];

574 
rf_ack_buf
[
ZB_RADIO_TX_HDR_LEN
] = 0x02;

576 #i‡
deföed
 
ZB_COORDINATOR_ROLE
 || deföed 
ZB_ROUTER_ROLE


577 
u16
 
fcf
 = (
macPld
[1] << 8) | macPld[0];

578 
u8
 
∂dO·
 = 
	`é_zbMacHdrSize
(
fcf
);

579 
u8
 
‰ameTy≥
 = (
fcf
 & 
MAC_FCF_FRAME_TYPE_MASK
Ë>> 
MAC_FCF_FRAME_TYPE_POS
;

581 
boﬁ
 
cmdD©aReq
 = ((
‰ameTy≥
 =
MAC_FRAME_COMMAND
Ë&& (
macPld
[
∂dO·
] =
MAC_CMD_DATA_REQUEST
));

584 
u8
 
§cAddrMode
 = 
ZB_ADDR_NO_ADDR
;

585 i‡((
macPld
[1] & 
MAC_FCF_SRC_ADDR_BIT
) == 0x80)

587 
§cAddrMode
 = 
ZB_ADDR_16BIT_DEV_OR_BROADCAST
;

589 i‡((
macPld
[1] & 
MAC_FCF_SRC_ADDR_BIT
) == 0xc0)

591 
§cAddrMode
 = 
ZB_ADDR_64BIT_DEV
;

593 i‡(
cmdD©aReq
 && 
§cAddrMode
)

595 
u8
 
	`é_zbMacPídögD©aCheck
(u8 
addrMode
, u8 * 
addr
, u8 
£nd
);

596 i‡(
MAC_SUCCESS
 =
	`é_zbMacPídögD©aCheck
(
§cAddrMode
, 
pSrcAddr
, 1))

598 
rf_ack_buf
[
ZB_RADIO_TX_HDR_LEN
] |= (1 << 4);

602 ()
pSrcAddr
;

605 
txDñayUs
 = (
	`˛ock_time
(Ë- 
txTime
Ë/ 
S_TIMER_CLOCK_1US
;

606 i‡(
txDñayUs
 < 
ZB_TX_WAIT_US
)

608 
	`WaôUs
(
ZB_TX_WAIT_US
 - 
txDñayUs
);

615 
ZB_RADIO_IRQ_MASK_CLR
;

617 
	`ZB_RADIO_TX_START
(
rf_ack_buf
);

620 
u32
 
cur_tick
 = 
	`˛ock_time
();

621 !
ZB_RADIO_TX_DONE
 && !
	`˛ock_time_ex˚ed
(
cur_tick
, 1000))

625 
ZB_RADIO_TX_DONE_CLR
;

627 
ZB_RADIO_IRQ_MASK_SET
;

629 
	`ZB_SWTICH_TO_RXMODE
();

633 
ZB_RADIO_RX_ENABLE
;

636 
	`zb_macD©aRecvH™dî
(
p
, 
macPld
, 
Àn
, 
fAck
, 
	`ZB_RADIO_TIMESTAMP_GET
’), 
	`ZB_RADION_PKT_RSSI_GET
(p) - 110);

637 
	}
}

648 
_©åibuã_øm_code_
 
__©åibuã__
((
›timize
("-Os"))Ë
	$rf_tx_úq_h™dÀr
()

650 
rf_busyFœg
 &~
TX_BUSY
;

652 
g_sysDügs
.
macTxIrqC¡
++;

654 
rfMode
 = 
RF_STATE_RX
;

655 
	`ZB_SWTICH_TO_RXMODE
();

657 
	`zb_macD©aSídH™dî
();

658 
	}
}

	@zigbee/mac/mac_pib.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

29 
u8
 
	moff£t
;

30 
u8
 
	mÀn
;

31 
u8
 
	mmö
;

32 
u8
 
	mmax
;

33 }
	tmac_pibTbl_t
;

36 c⁄° 
u8
 
	g°¨tIEEEAddr
[] = {0x38, 0xc1, 0xa4};

38 c⁄° 
mac_pibTbl_t
 
	gg_zbMacPibTbl
[] = {

39 {
OFFSETOF
(
é_zb_mac_pib_t
, 
ackWaôDuøti⁄
), (
u8
), 54, 54},

40 {
OFFSETOF
(
é_zb_mac_pib_t
, 
assocüti⁄Pîmô
), (
boﬁ
), 
FALSE
, 
TRUE
},

41 {
OFFSETOF
(
é_zb_mac_pib_t
, 
autoReq
), (
boﬁ
), 
FALSE
, 
TRUE
},

42 {
OFFSETOF
(
é_zb_mac_pib_t
, 
b©tLi„Ext
), (
boﬁ
), 
FALSE
, 
TRUE
},

43 {
OFFSETOF
(
é_zb_mac_pib_t
, 
b©tLi„ExtPîiods
), (
u8
), 6, 6},

44 {
OFFSETOF
(
é_zb_mac_pib_t
, 
bóc⁄Paylﬂd
), (
zb_mac_bóc⁄_∑ylﬂd_t
), 0, 0},

45 {
OFFSETOF
(
é_zb_mac_pib_t
, 
bóc⁄PaylﬂdLí
), (
u8
), 0, 52},

46 {
OFFSETOF
(
é_zb_mac_pib_t
, 
bóc⁄Ordî
), (
u8
), 0, 15},

47 {
OFFSETOF
(
é_zb_mac_pib_t
, 
bóc⁄TxTime
), (
u32
), 1, 1},

48 {
OFFSETOF
(
é_zb_mac_pib_t
, 
bóc⁄SeqNum
), (
u8
), 0x00, 0xFF},

49 {
OFFSETOF
(
é_zb_mac_pib_t
, 
co‹dExtAddªss
), (
addrExt_t
), 0, 0},

50 {
OFFSETOF
(
é_zb_mac_pib_t
, 
co‹dSh‹tAddªss
), (
u16
), 0, 0},

51 {
OFFSETOF
(
é_zb_mac_pib_t
, 
£qNum
), (
u8
), 0x00, 0xFF},

52 {
OFFSETOF
(
é_zb_mac_pib_t
, 
gtsPîmô
), (
boﬁ
), 
FALSE
, 
TRUE
},

53 {
OFFSETOF
(
é_zb_mac_pib_t
, 
maxCsmaBackoffs
), (
u8
), 0, 254},

54 {
OFFSETOF
(
é_zb_mac_pib_t
, 
möBe
), (
u8
), 0, 8},

55 {
OFFSETOF
(
é_zb_mac_pib_t
, 
∑nId
), (
u16
), 0, 0},

56 {
OFFSETOF
(
é_zb_mac_pib_t
, 
¥omiscuousMode
), (
boﬁ
), 
FALSE
, 
TRUE
},

57 {
OFFSETOF
(
é_zb_mac_pib_t
, 
rxOnWhíIdÀ
), (
boﬁ
), 
FALSE
, 
TRUE
},

58 {
OFFSETOF
(
é_zb_mac_pib_t
, 
sh‹tAddªss
), (
u16
), 0, 0},

59 {
OFFSETOF
(
é_zb_mac_pib_t
, 
su≥r‰ameOrdî
), (
u8
), 0, 15},

60 {
OFFSETOF
(
é_zb_mac_pib_t
, 
å™ß˘i⁄Pîsi°í˚Time
), (
u16
), 0, 0},

61 {
OFFSETOF
(
é_zb_mac_pib_t
, 
assocüãdP™Co‹d
), (
boﬁ
), 
FALSE
, 
TRUE
},

62 {
OFFSETOF
(
é_zb_mac_pib_t
, 
maxBe
), (
u8
), 0, 8},

63 {
OFFSETOF
(
é_zb_mac_pib_t
, 
‰ameTŸÆWaôTime
), (
u16
), 0x00, 0xFF},

64 {
OFFSETOF
(
é_zb_mac_pib_t
, 
‰ameRëryNum
), (
u8
), 0, 7},

65 {
OFFSETOF
(
é_zb_mac_pib_t
, 
ª•WaôTime
), (
u8
), 2, 64},

66 {
OFFSETOF
(
é_zb_mac_pib_t
, 
syncSymbﬁOff£t
), (
u8
), 0, 0},

67 {
OFFSETOF
(
é_zb_mac_pib_t
, 
timeSèmpSuµ‹ãd
), (
boﬁ
), 
FALSE
, 
TRUE
},

68 {
OFFSETOF
(
é_zb_mac_pib_t
, 
£curôyE«bÀd
), (
boﬁ
), 
FALSE
, 
TRUE
},

69 {
OFFSETOF
(
é_zb_mac_pib_t
, 
extAddªss
), (
addrExt_t
), 
FALSE
, 
TRUE
},

70 {
OFFSETOF
(
é_zb_mac_pib_t
, 
txPowî
), (
u8
), 0, 11},

86 
_CODE_MAC_
 
u8
 
	$é_zbMacAârSë
(
u8
 
©åibuã
, u8 *
vÆue
, u8 
Àn
){

87 if(
©åibuã
 =
MAC_TX_POWER
){

88 if(*
vÆue
 > 11){

89 *
vÆue
 = 11;

91 
	`ZB_RADIO_TX_POWER_SET
(*
vÆue
);

92  
MAC_SUCCESS
;

93 }if(
©åibuã
 =
MAC_PHY_ATTR_CURRENT_CHANNEL
){

94 
g_zbMacPib
.
phyCh™√lCur
 = *
vÆue
;

95  
MAC_SUCCESS
;

99 if(
©åibuã
 > 
MAC_PIB_ATTRIBUTE_STOP
 ||áâribuã < 
MAC_PIB_ATTRIBUTE_START
){

100  
MAC_STA_INVALID_PARAMETER
;

103 if(
Àn
 > 
g_zbMacPibTbl
[
©åibuã
-
MAC_PIB_ATTRIBUTE_START
].len){

104  
MAC_STA_INVALID_PARAMETER
;

106 
	`mem˝y
((
u8
 *)&
g_zbMacPib
+
g_zbMacPibTbl
[
©åibuã
-
MAC_PIB_ATTRIBUTE_START
].
off£t
, 
vÆue
, 
Àn
);

108  
MAC_SUCCESS
;

109 
	}
}

124 
_CODE_MAC_
 
u8
 
	$é_zbMacAârGë
(
u8
 
©åibuã
, u8* 
vÆue
, u8* 
Àn
){

125 if(
©åibuã
 =
MAC_PHY_ATTR_CURRENT_CHANNEL
){

126 *
vÆue
 = 
g_zbMacPib
.
phyCh™√lCur
;

127  
MAC_SUCCESS
;

130 if(
©åibuã
 > 
MAC_PIB_ATTRIBUTE_STOP
 ||áâribuã < 
MAC_PIB_ATTRIBUTE_START
){

131  
MAC_STA_INVALID_PARAMETER
;

133 *
Àn
 = 
g_zbMacPibTbl
[
©åibuã
-
MAC_PIB_ATTRIBUTE_START
].len;

134 
	`mem˝y
(
vÆue
, (
u8
 *)&
g_zbMacPib
+
g_zbMacPibTbl
[
©åibuã
-
MAC_PIB_ATTRIBUTE_START
].
off£t
, *
Àn
);

136  
MAC_SUCCESS
;

137 
	}
}

139 
_CODE_MAC_
 
	$gíî©eIEEEAddr
(){

140 
u8
 
addr
[8];

142 
	`Êash_ªad
(
CFG_MAC_ADDRESS
, 8, 
addr
);

144 if(
	`ZB_IEEE_ADDR_IS_INVALID
(
addr
)){

145 
t0
 = 
	`˛ock_time
();

146 
u32
 
jôãr
 = 0;

148 
jôãr
 = 
	`drv_u32R™d
() % 0x0fff;

149 }
jôãr
 == 0);

150 !
	`˛ock_time_ex˚ed
(
t0
, 
jôãr
));

152 
	`drv_gíî©eR™domD©a
(
addr
, 5);

153 
	`mem˝y
(
addr
+5, 
°¨tIEEEAddr
, 3);

154 
	`Êash_wrôe
(
CFG_MAC_ADDRESS
, 6, 
addr
 + 2);

155 
	`Êash_wrôe
(
CFG_MAC_ADDRESS
 + 6, 2, 
addr
);

164 if((
addr
[3] == 0x38 &&áddr[4] == 0xC1 &&áddr[5] == 0xA4) ||

165 (
addr
[3] == 0xD1 &&áddr[4] == 0x19 &&áddr[5] == 0xC4) ||

166 (
addr
[3] == 0xCB &&áddr[4] == 0x0B &&áddr[5] == 0xD8)){

167 
	`Êash_ªad
(
CFG_MAC_ADDRESS
, 6, 
addr
 + 2);

168 
	`Êash_ªad
(
CFG_MAC_ADDRESS
 + 6, 2, 
addr
);

171 
	`ZB_IEEE_ADDR_COPY
(
	`ZB_PIB_EXTENDED_ADDRESS
(), 
addr
);

172 
	}
}

	@zigbee/nwk/includes/nwk.h

24 #i‚de‡
NWK_H


25 
	#NWK_H


	)

32 #i‡
ZB_COORDINATOR_ROLE


33 #i‚de‡
NWK_ROUTE_RECORD_TABLE_NUM


34 
	#NWK_ROUTE_RECORD_TABLE_NUM
 128

	)

38 #i‡
ZB_ROUTER_ROLE


39 #i‚de‡
ROUTING_TABLE_NUM


40 
	#ROUTING_TABLE_NUM
 48

	)

43 #i‚de‡
NWK_BRC_TRANSTBL_NUM


44 
	#NWK_BRC_TRANSTBL_NUM
 12

47 

	)

48 
	#ZB_NWK_IS_ADDRESS_BROADCAST
(
addr
Ë–(◊ddrË& 0xFFF8Ë=0xFFF8 )

	)

53 
	#NWK_MAX_BROADCAST_RETRIES
 3

	)

55 
	#NWK_ENDDEV_TIMEOUT_DEFAULT
 8

56 

	)

61 
	#NWK_PASSIVE_ACK_TIMEOUT
 500000

62 

	)

66 
	#NWK_MAX_BROADCAST_JITTER
 0x40

67 

	)

81 
	#NWK_BROADCAST_DELIVERY_TIME
 (2*
NWK_MAX_DEPTH
*(((50+(
NWK_MAX_BROADCAST_JITTER
*1000)/2)Ë+ 
NWK_PASSIVE_ACK_TIMEOUT
*
NWK_MAX_BROADCAST_RETRIES
)/1000)

	)

83 
	#NWK_BROADCAST_DELIVERY_TIME
 5000

85 

	)

89 
	#NWK_INITIAL_RREQ_RETRIES
 3

	)

96 
	#NWK_RREQ_RETRIES
 2

	)

101 
	#PANID_TABLE_SIZE
 8

	)

106 
	#NWK_NLDE_DATA_REQ
 0x70

107 
	#NWK_NLDE_DATA_CONF
 0x71

108 
	#NWK_NLDE_DATA_IND
 0x72

109 
	#NWK_NLME_NWK_DISCOVERY_REQ
 0x73

110 
	#NWK_NLME_NWK_DISCOVERY_CNF
 0x74

111 
	#NWK_NLME_NWK_FORMATION_REQ
 0x75

112 
	#NWK_NLME_NWK_FORMATION_CNF
 0x76

113 
	#NWK_NLME_PERMIT_JOINING_REQ
 0x77

114 
	#NWK_NLME_PERMIT_JOINING_CNF
 0x78

115 
	#NWK_NLME_START_ROUTER_REQ
 0x79

116 
	#NWK_NLME_START_ROUTER_CNF
 0x7a

117 
	#NWK_NLME_ED_SCAN_REQ
 0x7b

118 
	#NWK_NLME_ED_SCAN_CNF
 0x7c

119 
	#NWK_NLME_JOIN_REQ
 0x7d

120 
	#NWK_NLME_JOIN_IND
 0x7e

121 
	#NWK_NLME_JOIN_CNF
 0x7f

122 
	#NWK_NLME_DIRECT_JOIN_REQ
 0x80

123 
	#NWK_NLME_DIRECT_JOIN_CNF
 0x81

124 
	#NWK_NLME_LEAVE_REQ
 0x82

125 
	#NWK_NLME_LEAVE_IND
 0x83

126 
	#NWK_NLME_LEAVE_CNF
 0x84

127 
	#NWK_NLME_RESET_REQ
 0x85

128 
	#NWK_NLME_RESET_CNF
 0x86

129 
	#NWK_NLME_SYNC_REQ
 0x87

130 
	#NWK_NLME_SYNC_LOSS_IND
 0x88

131 
	#NWK_NLME_SYNC_CNF
 0x89

132 
	#NWK_NLME_GET_REQ
 0x8a

133 
	#NWK_NLME_GET_CNF
 0x8b

134 
	#NWK_NLME_SET_REQ
 0x8c

135 
	#NWK_NLME_SET_CNF
 0x8d

136 
	#NWK_NLME_NWK_STATUS_IND
 0x8e

137 
	#NWK_NLME_ROUTE_DISCOVERY_REQ
 0x8f

138 
	#NWK_NLME_ROUTE_DISCOVERY_CNF
 0x90

139 

	)

146 
	mNWK_INTERNAL_NSDU_HANDLE
 = 0xC0,

147 
	mNWK_INTERNAL_DATA_RECEIVED_HANDLE
,

148 
	mNWK_INTERNAL_LINK_STATUS_CMD_HANDLE
,

149 
	mNWK_INTERNAL_REJOIN_REQ_CMD_HANDLE
,

150 
	mNWK_INTERNAL_REJOIN_RESP_CMD_HANDLE
,

151 
	mNWK_INTERNAL_NETWORK_UPDATE_CMD_PAN_ID_UPDATE_HANDLE
,

152 
	mNWK_INTERNAL_LEAVE_REQ_CMD_HANDLE
,

153 
	mNWK_INTERNAL_LEAVE_REQ_CMD_INDIRECT_HANDLE
,

154 
	mNWK_INTERNAL_NETWORK_REPORT_CMD_HANDLE
,

155 
	mNWK_INTERNAL_NETWORK_STATUS_CMD_HANDLE
,

156 
	mNWK_INTERNAL_ROUTE_REQ_CMD_HANDLE
,

157 
	mNWK_INTERNAL_ROUTE_REPLY_CMD_HANDLE
,

158 
	mNWK_INTERNAL_ROUTE_RECORD_CMD_HANDLE
,

159 
	mNWK_INTERNAL_ENDDEVTIMEOUT_REQ_CMD_HANDLE
,

160 
	mNWK_INTERNAL_ENDDEVTIMEOUT_RSP_CMD_HANDLE
,

162 }
	tnwk_öã∫Æ_h™dÀ_t
;

169 
	mNWK_DEVICE_TYPE_COORDINATOR
,

170 
	mNWK_DEVICE_TYPE_ROUTER
,

171 
	mNWK_DEVICE_TYPE_ED
,

172 }
	tnwk_devi˚Ty≥_t
;

179 
	mNWK_BROADCAST_ALL_DEVICES
 = 0xFFFF,

180 
	mNWK_BROADCAST_RESERVED
 = 0xFFFE,

181 
	mNWK_BROADCAST_RX_ON_WHEN_IDLE
 = 0xFFFD,

182 
	mNWK_BROADCAST_ROUTER_COORDINATOR
 = 0xFFFC,

183 
	mNWK_BROADCAST_LOW_POWER_ROUTER
 = 0xFFFB

184 }
	tnwk_brﬂdˇ°_addªss_t
;

191 
	mNWK_ADDRESS_ALLOC_METHOD_DISTRIBUTED
,

192 
	mNWK_ADDRESS_ALLOC_METHOD_RESERVER
,

193 
	mNWK_ADDRESS_ALLOC_METHOD_STOCHASTIC


194 }
	tnwk_addrAŒocMëhod_t
;

201 
	mNWK_STATUS_SUCCESS
 = 0x00,

202 
	mNWK_STATUS_ADDR_CONFLICT
 = 0x01,

203 
	mNWK_STATUS_INVALID_PARAMETER
 = 0xC1,

204 
	mNWK_STATUS_INVALID_REQUEST
 = 0xC2,

205 
	mNWK_STATUS_NOT_PERMITTED
 = 0xC3,

206 
	mNWK_STATUS_STARTUP_FAILURE
 = 0xC4,

207 
	mNWK_STATUS_ALREADY_PRESENT
 = 0xC5,

208 
	mNWK_STATUS_SYNC_FAILURE
 = 0xC6,

209 
	mNWK_STATUS_NEIGHBOR_TABLE_FULL
 = 0xC7,

210 
	mNWK_STATUS_UNKNOWN_DEVICE
 = 0xC8,

211 
	mNWK_STATUS_UNSUPPORTED_ATTRIBUTE
 = 0xC9,

212 
	mNWK_STATUS_NO_NETWORKS
 = 0xCA,

213 
	mNWK_STATUS_MAX_FRM_COUNTER
 = 0xCC,

214 
	mNWK_STATUS_NO_KEY
 = 0xCD,

215 
	mNWK_STATUS_BAD_CCM_OUTPUT
 = 0xCE,

216 
	mNWK_STATUS_NO_ROUTING_CAPACITY
 = 0xCF,

217 
	mNWK_STATUS_ROUTE_DISCOVERY_FAILED
 = 0xD0,

218 
	mNWK_STATUS_ROUTE_ERROR
 = 0xD1,

219 
	mNWK_STATUS_BT_TABLE_FULL
 = 0xD2,

220 
	mNWK_STATUS_FRAME_NOT_BUFFERED
 = 0xD3,

221 
	mNWK_STATUS_DECRYPT_ERROR
 = 0xD4

222 }
	tzb_nwk_°©us_t
;

229 
	mNWK_COMMAND_STATUS_NO_ROUTE_AVAILABLE
 = 0x00,

230 
	mNWK_COMMAND_STATUS_TREE_LINK_FAILURE
 = 0x01,

231 
	mNWK_COMMAND_STATUS_NONE_TREE_LINK_FAILURE
 = 0x02,

232 
	mNWK_COMMAND_STATUS_LOW_BATTERY_LEVEL
 = 0x03,

233 
	mNWK_COMMAND_STATUS_NO_ROUTING_CAPACITY
 = 0x04,

234 
	mNWK_COMMAND_STATUS_NO_INDIRECT_CAPACITY
 = 0x05,

235 
	mNWK_COMMAND_STATUS_INDIRECT_TRANSACTION_EXPIRY
 = 0x06,

236 
	mNWK_COMMAND_STATUS_TARGET_DEVICE_UNAVAILABLE
 = 0x07,

237 
	mNWK_COMMAND_STATUS_TARGET_ADDRESS_UNALLOCATED
 = 0x08,

238 
	mNWK_COMMAND_STATUS_PARENT_LINK_FAILURE
 = 0x09,

239 
	mNWK_COMMAND_STATUS_VALIDATE_ROUTE
 = 0x0a,

240 
	mNWK_COMMAND_STATUS_SOURCE_ROUTE_FAILURE
 = 0x0b,

241 
	mNWK_COMMAND_STATUS_MANY_TO_ONE_ROUTE_FAILURE
 = 0x0c,

242 
	mNWK_COMMAND_STATUS_ADDRESS_CONFLICT
 = 0x0d,

243 
	mNWK_COMMAND_STATUS_VERIFY_ADDRESS
 = 0x0e,

244 
	mNWK_COMMAND_STATUS_PAN_IDENTIFIER_UPDATE
 = 0x0f,

245 
	mNWK_COMMAND_STATUS_NETWORK_ADDRESS_UPDATE
 = 0x10,

246 
	mNWK_COMMAND_STATUS_BAD_FRAME_COUNTER
 = 0x11,

247 
	mNWK_COMMAND_STATUS_BAD_KEY_SEQUENCE_NUMBER
 = 0x12

248 }
	tnwk_°©usCode_t
;

255 
	mNIB_ATTRIBUTE_SEQUENCE_NUMBER
 = 0x81,

256 
	mNIB_ATTRIBUTE_PASSIVE_ASK_TIMEOUT
 = 0x82,

257 
	mNIB_ATTRIBUTE_MAX_BROADCAST_RETRIES
 = 0x83,

258 
	mNIB_ATTRIBUTE_MAX_CHILDREN
 = 0x84,

259 
	mNIB_ATTRIBUTE_MAX_DEPTH
 = 0x85,

260 
	mNIB_ATTRIBUTE_MAX_ROUTERS
 = 0x86,

261 
	mNIB_ATTRIBUTE_NEIGHBOR_TABLE
 = 0x87,

262 
	mNIB_ATTRIBUTE_BROADCAST_DELIVERY_TIME
 = 0x88,

263 
	mNIB_ATTRIBUTE_REPORT_CONSTANT_COST
 = 0x89,

264 
	mNIB_ATTRIBUTE_ROUTE_DISCOVERY_RETRIES_PERMITTED
 = 0x8A,

265 
	mNIB_ATTRIBUTE_ROUTE_TABLE
 = 0x8B,

266 
	mNIB_ATTRIBUTE_SYM_LINK
 = 0x8E,

267 
	mNIB_ATTRIBUTE_CAPABILITY_INFORMATION
 = 0x8F,

268 
	mNIB_ATTRIBUTE_ADDR_ALLOC
 = 0x90,

269 
	mNIB_ATTRIBUTE_USE_TREE_ROUTING
 = 0x91,

270 
	mNIB_ATTRIBUTE_MANAGER_ADDR
 = 0x92,

271 
	mNIB_ATTRIBUTE_MAX_SOURCE_ROUTE
 = 0x93,

272 
	mNIB_ATTRIBUTE_UPDATE_ID
 = 0x94,

273 
	mNIB_ATTRIBUTE_TRANSACTION_PERSISTENCE_TIME
 = 0x95,

274 
	mNIB_ATTRIBUTE_NETWORK_ADDRESS
 = 0x96,

275 
	mNIB_ATTRIBUTE_STACK_PROFILE
 = 0x97,

276 
	mNIB_ATTRIBUTE_BROADCAST_TRANSACTION_TABLE
 = 0x98,

277 
	mNIB_ATTRIBUTE_GROUP_ID_TABLE
 = 0x99,

278 
	mNIB_ATTRIBUTE_EXTENDED_PANID
 = 0x9A,

279 
	mNIB_ATTRIBUTE_USE_MULTICAST
 = 0x9B,

280 
	mNIB_ATTRIBUTE_ROUTE_RECORD_TABLE
 = 0x9C,

281 
	mNIB_ATTRIBUTE_IS_CONCENTRATOR
 = 0x9D,

282 
	mNIB_ATTRIBUTE_CONCENTRATOR_RADIUS
 = 0x9E,

283 
	mNIB_ATTRIBUTE_CONCENTRATOR_DESCOVERY_TIME
 = 0x9F,

284 
	mNIB_ATTRIBUTE_SECURITY_LEVEL
 = 0xA0,

285 
	mNIB_ATTRIBUTE_SECURITY_MATERIAL_SET
 = 0xA1,

286 
	mNIB_ATTRIBUTE_ACTIVE_KEY_SEQ_NUMBER
 = 0xA2,

287 
	mNIB_ATTRIBUTE_ALL_FRESH
 = 0xA3,

288 
	mNIB_ATTRIBUTE_SECURE_ALL_FRAMES
 = 0xA5,

289 
	mNIB_ATTRIBUTE_LINK_STATUS_PERIOD
 = 0xA6,

290 
	mNIB_ATTRIBUTE_ROUTER_AGE_LIMIT
 = 0xA7,

291 
	mNIB_ATTRIBUTE_UNIQUE_ADDR
 = 0xA8,

292 
	mNIB_ATTRIBUTE_ADDRESS_MAP
 = 0xA9,

293 
	mNIB_ATTRIBUTE_TIME_STAMP
 = 0x8C,

294 
	mNIB_ATTRIBUTE_PAN_ID
 = 0x80,

295 
	mNIB_ATTRIBUTE_TX_TOTAL
 = 0x8D,

296 
	mNIB_ATTRIBUTE_LEAVEREQALLOWED
 = 0xAA,

297 
	mNIB_ATTRIBUTE_PARENT_INFORMATION
 = 0xAB,

298 
	mNIB_ATTRIBUTE_END_DEVICE_TIMEOUT_DEFAULT
 = 0xAC,

299 
	mNIB_ATTRIBUTE_LEAVE_REQ_WITHOUT_REJOIN_ALLOWED
 = 0xAD,

300 
	mNIB_ATTRIBUTE_IEEE_ADDRESS
 = 0xAE,

301 }
	tnib_©åibuã_t
;

309 
	mNLME_REJOIN_METHOD_ASSOCIATION
 = 0x00,

310 
	mNLME_REJOIN_METHOD_DIRECT
 = 0x01,

311 
	mNLME_REJOIN_METHOD_REJOIN
 = 0x02,

312 
	mNLME_REJOIN_METHOD_CHANGE_CHANNEL
 = 0x03

313 }
	tªjoöNwk_mëhod_t
;

321 
	mFRAME_TYPE_DATA
 = 0,

322 
	mFRAME_TYPE_COMMAND
 = 1,

323 
	mFRAME_TYPE_INTERPAN
 = 3

324 }
	t‰ameTy≥_t
;

331 
u8
 
	m‰ameTy≥
:2;

332 
u8
 
	m¥ŸocﬁVî
:4;

333 
u8
 
	mdiscRouã
:2;

334 
u8
 
	mmu…iˇ°Flg
:1;

335 
u8
 
	m£curôy
:1;

336 
u8
 
	m§cRouã
:1;

337 
u8
 
	md°IEEEAddr
:1;

338 
u8
 
	m§cIEEEAddr
:1;

339 
u8
 
	mídDevInôüt‹
:1;

340 
u8
 
	mª£rved
:2;

341 }
	tnwkFømeCål_t
;

348 
u8
 
	mmu…iˇ°Mode
:2;

349 
u8
 
	mn⁄membîRadius
:3;

350 
u8
 
	mmaxN⁄membîRadius
:3;

351 }
	tnwkMˇ°Cål_t
;

358 
u8
 
	mªœyC¡
;

359 
u8
 
	mªœyIdx
;

360 
u8
 *
	mªœyLi°
;

361 }
	t§cRouãSub‰ame_t
;

368 
u16
 
	md°Addr
;

369 
u16
 
	m§cAddr
;

371 
nwkFømeCål_t
 
	m‰ameC⁄åﬁ
;

372 
u8
 
	mødius
;

373 
u8
 
	m£qNum
;

375 
extAddr_t
 
	md°IìeAddr
;

376 
extAddr_t
 
	m§cIìeAddr
;

378 
nwkMˇ°Cål_t
 
	mmˇ°C⁄åﬁ
;

379 
u8
 
	m‰ameHdrLí
;

380 
§cRouãSub‰ame_t
 
	m§cRouãSub‰ame
;

381 }
	tnwk_hdr_t
;

391 
addrExt_t
 
	mõeAddr
;

393 
u16
 
	md°Addr
;

394 
u8
 
	mødius
;

395 
u8
 
	maddrMode
;

397 
u8
 
	mn⁄membîRadius
;

398 
u8
 
	mdiscovîRouã
;

399 
boﬁ
 
	m£curôyE«bÀ
;

400 
u8
 
	mndsuH™dÀ
;

402 
u8
 *
	mnsdu
;

404 
u8
 
	mnsduLí
;

405 
boﬁ
 
	mu£Alüs
;

406 
u16
 
	mÆüsSrcAddr
;

408 
u8
 
	mÆüsSeqNum
;

409 
boﬁ
 
	muniˇ°SkùRoutög
;

410 }
	t∆de_d©a_ªq_t
;

418 
u32
 
	mtxTime
;

419 
u8
 
	m°©us
;

420 
u8
 
	mnsduH™dÀ
;

421 }
	t∆de_d©a_˙f_t
;

428 
u8
 *
	mnsdu
;

430 
u8
 
	mnsduLí
;

431 
u8
 
	md°AddrMode
;

432 
boﬁ
 
	m£curôyU£
;

433 
u8
 
	mlqi
;

435 
u16
 
	md°Addr
;

436 
u16
 
	m§cAddr
;

438 
u32
 
	mrxTime
;

439 
u16
 
	m§cMacAddr
;

440 }
	t∆de_d©a_öd_t
;

447 
u32
 
	msˇnCh™√ls
;

448 
u8
 
	msˇnDuøti⁄
;

449 }
	t∆me_nwkDisc_ªq_t
;

455 
	szb_∆me_√tw‹k_des¸ùt‹_s


457 
extPANId_t
 
	mextPANId
;

459 
u8
 
	mlogiˇlCh™√l
;

460 
u8
 
	m°ackProfûe
;

461 
u8
 
	mzigbìVî
;

462 
u8
 
	mbóc⁄Ordî
;

464 
u8
 
	msu≥r‰ameOrdî
;

465 
boﬁ
 
	m≥rmôJoöög
;

466 
boﬁ
 
	mrouãrC≠acôy
;

467 
boﬁ
 
	mídDevC≠acôy
;

468 }
	tnwk_des¸ùt‹_t
;

476 
nwk_des¸ùt‹_t
 
	mnwkDes¸ùt‹
[
PANID_TABLE_SIZE
];

477 
u8
 
	m°©us
;

478 
u8
 
	mnwkCou¡
;

479 }
	t∆me_nwkDisc_˙f_t
;

486 
u32
 
	msˇnCh™√ls
;

487 
u16
 
	mdi°ribuãdNwkAddr
;

488 
boﬁ
 
	mdi°ribuãdNëw‹k
;

489 
boﬁ
 
	mb©ãryLi„Ext
;

490 
u8
 
	msˇnDuøti⁄
;

491 
u8
 
	mbóc⁄Ordî
;

492 
u8
 
	msu≥r‰ameOrdî
;

493 }
	t∆me_nwkF‹m©i⁄_ªq_t
;

500 
u8
 
	m°©us
;

501 }
	t∆me_nwkF‹m©i⁄_˙f_t
;

508 
u8
 
	m≥rmôDuøti⁄
;

509 }
	t∆me_≥rmôJoöög_ªq_t
;

516 
u8
 
	m°©us
;

517 }
	t∆me_≥rmôJoöög_˙f_t
;

524 
u8
 
	mbóc⁄Ordî
;

525 
u8
 
	msu≥r‰ameOrdî
;

526 
boﬁ
 
	mb©ãryLi„Ext
;

527 }
	t∆me_°¨tRouãr_ªq_t
;

534 
u8
 
	m°©us
;

535 }
	t∆me_°¨tRouãr_˙f_t
;

542 
u32
 
	msˇnCh™√ls
;

543 
u8
 
	msˇnDuøti⁄
;

544 }
	t∆me_edSˇn_ªq_t
;

551 
u8
 
	m°©us
;

552 
u8
 
	medLi°
[
MAX_ED_SCAN_RESULTS_SUPPORTED
];

553 }
	t∆me_edSˇn_˙f_t
;

562 
u8
 
	mÆtP™Co‹d
:1;

563 
u8
 
	mdevTy≥
:1;

564 
u8
 
	mpowîSrc
:1;

565 
u8
 
	mrcvOnWhíIdÀ
:1;

566 
u8
 
	mª£rved
:2;

567 
u8
 
	m£cuC≠abûôy
:1;

568 
u8
 
	mÆlocAddr
:1;

569 }
	tˇ∑bûôy_öfo_t
;

577 
extPANId_t
 
	mextPANId
;

579 
u32
 
	msˇnCh™√ls
;

581 
ªjoöNwk_mëhod_t
 
	mªjoöNwk
;

582 
u8
 
	msˇnDuøti⁄
;

583 
ˇ∑bûôy_öfo_t
 
	mˇ∑bûôyInfo
;

584 
boﬁ
 
	m£curôyE«bÀd
;

585 }
	t∆me_joö_ªq_t
;

592 
extAddr_t
 
	mextAddr
;

593 
u16
 
	mnwkAddr
;

594 
ˇ∑bûôy_öfo_t
 
	mˇ∑bûôyInfo
;

595 
ªjoöNwk_mëhod_t
 
	mªjoöNwk
;

596 
boﬁ
 
	m£cuªRejoö
;

597 }
	t∆me_joö_öd_t
;

604 
u16
 
	mnwkAddr
;

605 
u8
 
	m°©us
;

606 
u8
 
	ma˘iveCh™√l
;

607 
extPANId_t
 
	mextPANId
;

608 }
	t∆me_joö_˙f_t
;

615 
extAddr_t
 
	mdevi˚Addr
;

616 
u16
 
	mnwkAddr
;

617 
ˇ∑bûôy_öfo_t
 
	mˇ∑bûôyInfo
;

618 }
	t∆me_dúe˘Joö_ªq_t
;

625 
extAddr_t
 
	mdevi˚Addr
;

626 
u8
 
	m°©us
;

627 }
	t∆me_dúe˘Joö_˙f_t
;

634 
extAddr_t
 
	mdevi˚Addr
;

635 
boﬁ
 
	mªmoveChûdªn
;

636 
boﬁ
 
	mªjoö
;

637 }
	t∆me_Àave_ªq_t
;

645 
extAddr_t
 
	mdevi˚Addr
;

646 
boﬁ
 
	mªjoö
;

647 }
	t∆me_Àave_öd_t
;

654 
extAddr_t
 
	mdevi˚Addr
;

655 
u8
 
	m°©us
;

656 }
	t∆me_Àave_˙f_t
;

663 
boﬁ
 
	mw¨mSèπ
;

664 }
	t∆me_ª£t_ªq_t
;

671 
u8
 
	m°©us
;

672 }
	t∆me_ª£t_˙f_t
;

679 
boﬁ
 
	måack
;

680 }
	t∆me_sync_ªq_t
;

687 
u8
 
	m°©us
;

688 }
	t∆me_sync_˙f_t
;

695 
nib_©åibuã_t
 
	mnibAâr
;

696 }
	t∆me_gë_ªq_t
;

703 
u8
 
	m°©us
;

704 
nib_©åibuã_t
 
	mnibAâr
;

705 
u16
 
	mnibAârLí
;

706 
u8
 *
	mnibAârVÆ
;

707 }
	t∆me_gë_˙f_t
;

714 
u8
 *
	mnibAârVÆ
;

715 
u16
 
	mnibAârLí
;

716 
nib_©åibuã_t
 
	mnibAâr
;

717 }
	t∆me_£t_ªq_t
;

724 
u8
 
	m°©us
;

725 
nib_©åibuã_t
 
	mnibAâr
;

726 }
	t∆me_£t_˙f_t
;

733 
u16
 
	mnwkAddr
;

734 
nwk_°©usCode_t
 
	m°©us
;

735 }
	t∆me_nwkSètus_öd_t
;

742 
u16
 
	md°Addr
;

743 
zb_addr_mode_t
 
	md°AddrMode
;

744 
u8
 
	mødius
;

745 
boﬁ
 
	mnoRouãCache
;

746 }
	t∆me_rouãDisc_ªq_t
;

753 
u8
 
	m°©us
;

754 
nwk_°©usCode_t
 
	mnwkSètusCode
;

755 }
	t∆me_rouãDisc_˙f_t
;

762 
	mNWK_CMD_ROUTE_REQUEST
 = 0x01,

763 
	mNWK_CMD_ROUTE_REPLY
 = 0x02,

764 
	mNWK_CMD_NETWORK_STATUS
 = 0x03,

765 
	mNWK_CMD_LEAVE
 = 0x04,

766 
	mNWK_CMD_ROUTE_RECORD
 = 0x05,

767 
	mNWK_CMD_REJOIN_REQUEST
 = 0x06,

768 
	mNWK_CMD_REJOIN_RESPONSE
 = 0x07,

769 
	mNWK_CMD_LINK_STATUS
 = 0x08,

770 
	mNWK_CMD_NETWORK_REPORT
 = 0x09,

771 
	mNWK_CMD_NETWORK_UPDATE
 = 0x0a,

772 
	mNWK_CMD_ENDDEVTIMEOUT_REQUEST
 = 0x0b,

773 
	mNWK_CMD_ENDDEVTIMEOUT_RESPONSE
 = 0x0c,

774 }
	tnwk_cmdId_t
;

780 
u8
 
	mª£rvedL
 :3;

781 
u8
 
	mm™yToO√
 :2;

782 
u8
 
	md°IìeAddr
:1;

783 
u8
 
	mmu…iˇ°
 :1;

784 
u8
 
	mª£rvedH
 :1;

785 }
	tºeq_›t_t
;

789 
extAddr_t
 
	md°IìeAddr
;

791 
ºeq_›t_t
 
	m›ti⁄s
;

792 
u8
 
	mrouãReqId
;

793 
u16
 
	md°Addr
;

795 
u8
 
	m∑thCo°
;

796 }
	tnwkCmd_rouãReq_t
;

803 
extAddr_t
 
	m‹igö©‹IìeAddr
;

804 
extAddr_t
 
	mª•⁄dîIìeAddr
;

805 
u16
 
	m‹igö©‹Addr
;

806 
u16
 
	mª•⁄dîAddr
;

808 
u8
 
	mª£rvedL
 :4;

809 
u8
 
	m‹igö©‹IìeAddr
:1;

810 
u8
 
	mª•⁄dîIìeAddr
 :1;

811 
u8
 
	mmu…iˇ°
 :1;

812 
u8
 
	mª£rvedH
 :1;

813 }
	m›ti⁄s
;

814 
u8
 
	mrouãReqId
;

815 
u8
 
	m∑thCo°
;

816 }
	tnwkCmd_rouãRïly_t
;

823 
u16
 
	md°Addr
;

824 
nwk_°©usCode_t
 
	m°©usCode
;

825 }
	tnwkCmd_nwkSètus_t
;

832 
nwk_cmdId_t
 
	mcmdId
;

833 
nwk_°©usCode_t
 
	m°©usCode
;

834 
u8
 
	m§cIEEEAddrPª£¡
;

835 
u8
 
	md°IEEEAddrPª£¡
;

836 
extAddr_t
 
	md°IìeAddr
;

837 
u16
 
	md°Addr
;

838 
u8
 
	mh™dÀ
;

839 
u8
 
	m∑ylﬂdLí
;

840 
u8
 
	m∑ylﬂd
[1];

841 }
	tmyNwkCmd_nwkSètus_t
;

850 
u8
 
	mª£rved
 :5;

851 
u8
 
	mªjoö
 :1;

852 
u8
 
	mªque°
 :1;

853 
u8
 
	mªmoveChûdªn
:1;

854 }
	m›ti⁄s
;

855 }
	tnwkCmd_Àave_t
;

862 
u8
 *
	mªœyLi°
;

863 
u8
 
	mªœyC¡
;

864 }
	tnwkCmd_rouãRec‹d_t
;

871 
ˇ∑bûôy_öfo_t
 
	mˇ∑bûôyInfo
;

872 }
	tnwkCmd_ªjoöReq_t
;

879 
u16
 
	mnwkAddr
;

880 
u8
 
	mªjoöSètus
;

881 }
	tnwkCmd_ªjoöRe•_t
;

888 
u16
 
	m√ighb‹NwkAddr
;

890 
u8
 
	möcomögCo°
:3;

891 
u8
 
	mª£rvedL
 :1;

892 
u8
 
	moutögCo°
 :3;

893 
u8
 
	mª£rvedH
 :1;

894 }
	mlökSètus
;

895 }
	tlökSètus_íåy_t
;

902 
lökSètus_íåy_t
 *
	mlökSètusLi°
;

904 
u8
 
	míåyC¡
 :5;

905 
u8
 
	mfú°Føme
:1;

906 
u8
 
	mœ°Føme
 :1;

907 
u8
 
	mª£rved
 :1;

908 }
	m›ti⁄s
;

909 }
	tnwkCmd_lökSètus_t
;

916 
extPANId_t
 
	mïid
;

917 
u8
 *
	m∑nIds
;

919 
u8
 
	mªp‹tInfoC¡
:5;

920 
u8
 
	mªp‹tCmdId
 :3;

921 }
	m›ti⁄s
;

922 }
	tnwkCmd_nwkRï‹t_t
;

929 
extPANId_t
 
	mïid
;

930 
u16
 
	m√wP™Id
;

932 
u8
 
	mupd©eInfoC¡
:5;

933 
u8
 
	mupd©eCmdId
 :3;

934 }
	m›ti⁄s
;

935 
u8
 
	mupd©eId
;

936 }
	tnwkCmd_nwkUpd©e_t
;

943 
	mREQTIMEOUTENUM_10_SECONDS
 = 0,

944 
	mREQTIMEOUTENUM_2_MINUTES
,

945 
	mREQTIMEOUTENUM_4_MINUTES
,

946 
	mREQTIMEOUTENUM_8_MINUTES
,

947 
	mREQTIMEOUTENUM_16_MINUTES
,

948 
	mREQTIMEOUTENUM_32_MINUTES
,

949 
	mREQTIMEOUTENUM_64_MINUTES
,

950 
	mREQTIMEOUTENUM_128_MINUTES
,

951 
	mREQTIMEOUTENUM_256_MINUTES
,

952 
	mREQTIMEOUTENUM_512_MINUTES
,

953 
	mREQTIMEOUTENUM_1024_MINUTES
,

954 
	mREQTIMEOUTENUM_2048_MINUTES
,

955 
	mREQTIMEOUTENUM_4096_MINUTES
,

956 
	mREQTIMEOUTENUM_8192_MINUTES
,

957 
	mREQTIMEOUTENUM_16384_MINUTES
,

958 
	mREQTIMEOUTENUM_INVALID
 = 15,

959 }
	tªqTimeoutEnum_t
;

964 
	#REQUESTED_TIMEOUT_VALUE_GET
(
idx
) ( (idx) ? ((()(1 << (idx))) * 60) : (10) )

965 

	)

971 
ªqTimeoutEnum_t
 
	mªqTimeoutEnum
;

972 
u8
 
	mídDevCfg
;

973 }
	tnwkCmd_ídDevTimeoutReq_t
;

979 
	mTIMEOUT_RSP_STATUS_SUCCESS
,

980 
	mTIMEOUT_RSP_STATUS_INCORRECT_VALUE
,

981 }
	tídDevTimeoutR•Sètus_t
;

987 
	mMAC_DATA_POLL_KEEPALIVE_BIT
 = 1,

988 
	mEND_DEV_TIMEOUT_REQ_KEEPALIVE_BIT
 = 2,

989 }
	tkì∑liveSuµ‹tBô_t
;

996 
ídDevTimeoutR•Sètus_t
 
	m°©us
;

997 
u8
 
	m∑ª¡Info
;

998 }
	tnwkCmd_ídDevTimeoutRe•_t
;

1005 
nwk_cmdId_t
 
	mcmdId
;

1006 
u8
 
	mª£rved
[3];

1009 
nwkCmd_rouãReq_t
 
	mºeq
;

1010 
nwkCmd_rouãRïly_t
 
	mºï
;

1011 
nwkCmd_nwkSètus_t
 
	mnwkSètus
;

1012 
nwkCmd_Àave_t
 
	mÀave
;

1013 
nwkCmd_rouãRec‹d_t
 
	mºec
;

1014 
nwkCmd_ªjoöReq_t
 
	mªjoöReq
;

1015 
nwkCmd_ªjoöRe•_t
 
	mªjoöR•
;

1016 
nwkCmd_lökSètus_t
 
	mlökSt
;

1017 
nwkCmd_nwkRï‹t_t
 
	mnwkRï‹t
;

1018 
nwkCmd_nwkUpd©e_t
 
	mnwkUpd©e
;

1019 
nwkCmd_ídDevTimeoutReq_t
 
	mídDevTimeoutReq
;

1020 
nwkCmd_ídDevTimeoutRe•_t
 
	mídDevTimeoutR•
;

1022 }
	tnwkCmd_t
;

1029 *
	m§cBuf
;

1030 
u16
 
	m§cAddr
;

1031 
u16
 
	md°Addr
;

1032 
u8
 
	mh™dÀ
;

1033 
u8
 
	m£qNum
;

1034 
u8
 
	mrouãReqId
;

1035 
u8
 
	mexpú©i⁄Time
:6;

1036 
u8
 
	m√edRouãDisc
:1;

1037 
u8
 
	mu£d
:1;

1038 }
	tnwk_txD©aPídE¡ry_t
;

1045 
nwk_txD©aPídE¡ry_t
 *
	míåy
;

1046 
ev_timî_evít_t
 *
	mªåyTimî
;

1047 
u16
 *
	m∑ssiveAckAddr
;

1051 
u16
 
	m§cAddr
;

1052 
u8
 
	m£qNum
;

1053 
u8
 
	mªåõs
;

1054 
u8
 
	ma˘iveNum
;

1055 
u8
 
	mexpú©i⁄Time
;

1056 
u8
 
	m°©us
;

1057 
u8
 
	mu£d
;

1058 }
	tnwk_brcTønsRec‹dE¡ry_t
;

1065 
	mNWK_ROUTE_STATE_ACTIVE
,

1066 
	mNWK_ROUTE_STATE_DISCOVERY_UNDERWAY
,

1067 
	mNWK_ROUTE_STATE_DISCOVERY_FAILED
,

1068 
	mNWK_ROUTE_STATE_DISCOVERY_INACTIVE
,

1069 
	mNWK_ROUTE_STATE_VALIDATION_UNDERWAY
,

1070 }
	tnwk_rouãSèã_t
;

1075 
	#NWK_MAX_SOURCE_ROUTE
 0x08

	)

1082 
u16
 
	mnwkAddr
;

1083 
u16
 
	m∑th
[
NWK_MAX_SOURCE_ROUTE
];

1084 
u8
 
	mªœyC¡
:7;

1085 
u8
 
	mu£d
:1;

1086 
u8
 
	mf‹gëC¡
;

1087 }
	tnwk_rouãRec‹dTabE¡ry_t
;

1094 
u16
 
	md°Addr
;

1095 
u16
 
	m√xtH›Addr
;

1096 
u8
 
	m°©us
;

1097 
u8
 
	mnoRouãCache
:1;

1098 
u8
 
	mm™yToO√
:1;

1099 
u8
 
	mrouãRec‹dRequúed
:1;

1100 
u8
 
	mgroupIdFœg
:1;

1101 
u8
 
	må™sFaû
:4;

1102 
u8
 
	mªsidCo°
;

1103 
u8
 
	mf‹gëC¡
;

1104 }
	tnwk_routögTabE¡ry_t
;

1112 *
	mbuf
;

1113 
ev_timî_evít_t
 *
	mªåyTimî
;

1114 
u16
 
	m§cAddr
;

1115 
u16
 
	m£ndîAddr
;

1116 
u16
 
	md°Addr
;

1117 
u16
 
	mexpúy
;

1118 
u8
 
	mrouãReqId
;

1119 
u8
 
	mf‹w¨dCo°
;

1120 
u8
 
	mªsidCo°
;

1121 
u8
 
	mœ°Co°
;

1122 
u8
 
	mªåõs
;

1123 
u8
 
	mu£d
;

1124 }
	tnwk_rouãDiscE¡ry_t
;

1132 
u16
 
	m‹igö©‹
;

1133 
u16
 
	möãrvÆ
;

1134 
u8
 
	mªåõs
;

1135 
u8
 
	mødius
;

1136 
u8
 
	m£qNum
;

1137 
nwkCmd_t
 
	mrouãReqCmd
;

1138 }
	tnwk_rouãReqE¡ry_t
;

1142 
u8
 
NWKC_TRANSFAILURE_CNT_THRESHOLD
;

1143 
u8
 
NWKC_INITIAL_RREQ_RETRIES
;

1144 
u8
 
NWKC_RREQ_RETRIES
;

1145 
u16
 
ROUTING_TABLE_SIZE
;

1146 
u8
 
NWK_BRC_TRANSTBL_SIZE
;

1147 
boﬁ
 
NWK_BRC_PASSIVE_ACK_ENABLE
;

1148 
nwk_routögTabE¡ry_t
 
g_routögTab
[];

1149 
nwk_brcTønsRec‹dE¡ry_t
 
g_brcTønsTab
[];

1150 #i‡
ZB_COORDINATOR_ROLE


1151 
u16
 
NWK_ROUTE_RECORD_TABLE_SIZE
;

1152 
nwk_rouãRec‹dTabE¡ry_t
 
g_rouãRecTab
[];

1154 
boﬁ
 
AUTO_QUICK_DATA_POLL_ENABLE
;

1156 
u8
 
NWK_COST_THRESHOLD_ONEHOP
;

1157 
u8
 
NWK_NEIGHBOR_SEND_OUTGOING_THRESHOLD
;

1158 
u16
 
TL_ZB_ASSOCJOIN_FILTER_PANID
;

1159 
u16
 
TL_ZB_ASSOCJOIN_PERMIT_PANID
;

1160 
u32
 
LONG_UPTIME_THRESHOLD
;

1163 
u16
 
é_zbNwkStocha°icAddrCÆ
();

1164 
é_zbNwkSètusAddrC⁄Êi˘Ind
(*
¨g
);

1165 
boﬁ
 
é_zbNwkAddrC⁄Êi˘Dëe˘
(*
¨g
, 
u16
 
nwkAddr
, 
addrExt_t
 
õìAddr
);

1167 
é_zbNwkAddrM≠Inô
();

1168 
zb_nwk_°©us_t
 
é_zbNwkAddrM≠Add
(
u16
 
sh‹tAddr
, 
addrExt_t
 
extAddr
, u16 *
ªf
);

1169 
u8
 
é_idxBySh‹tAddr
(
u16
 *
idx
, u16 
sh‹tAddr
);

1170 
u8
 
é_idxByExtAddr
(
u16
 *
idx
, 
addrExt_t
 
extAddr
);

1171 
é_zbNwkAddrM≠Dñëe
(
u16
 
idx
);

1172 
u8
 
é_zbSh‹tAddrByExtAddr
(
u16
 *
sh‹tAddr
, 
addrExt_t
 
extAddr
, u16 *
idx
);

1173 
u8
 
é_zbExtAddrBySh‹tAddr
(
u16
 
sh‹tAddr
, 
addrExt_t
 
extAddr
, u16 *
idx
);

1174 
é_zbExtAddrByIdx
(
u16
 
idx
, 
addrExt_t
 
extAddr
);

1175 
u16
 
é_zbsh‹tAddrByIdx
(u16 
idx
);

1177 
é_zbNwkAddrC⁄Êi˘SètusSíd
(
u16
 
d°Addr
, u16 
°©usAddr
, 
u8
 
f‹˚SeqNum
);

1178 
é_zbNwkSídNwkSètusCmd
(*
¨g
, 
nwk_hdr_t
 *
pNwkHdr
, 
nwkCmd_t
 *
pNwkSètus
, 
u8
 
h™dÀ
);

1179 
é_zbNwkNlmeNwkSètusInd
(*
¨g
, 
u16
 
nwkAddr
, 
nwk_°©usCode_t
 
°©us
);

1181 
é_zbNwkInô
(
u8
 
cﬁdRe£t
);

1182 
é_zbNwkTaskProc
();

1184 
u8
 
nwkHdrP¨£
(
nwk_hdr_t
 *
pNwkHdr
, u8 *
msdu
);

1185 
u8
 
gëNwkHdrSize
(
nwk_hdr_t
 *
pNwkHdr
);

1186 
u8
 *
nwkHdrBuûdî
(u8 *
buf
, 
nwk_hdr_t
 *
pNwkHdr
);

1188 
é_zbNwkLökSètusSèπ
();

1189 
é_zbNwkLökSètusSt›
();

1190 
é_zbNwkSídLökSètus
();

1192 
nwkEndDevTimeoutReqSíd
(
ªqTimeoutEnum_t
 
ªqTimeoutEnum
, 
u8
 
ídDevCfg
);

1193 
kì∑liveMsgSídSt›
();

1198 
é_zbMacMlmeSèπC⁄fúmH™dÀr
(*
¨g
);

1199 
é_zbMacMlmePﬁlC⁄fúmH™dÀr
(*
¨g
);

1200 
é_zbMacM˝sD©aC⁄fúmH™dÀr
(*
¨g
);

1201 
é_zbMacM˝sD©aIndiˇti⁄H™dÀr
(*
buf
);

1202 
é_zbMacMlmeAssocüãC⁄fúmH™dÀr
(*
¨g
);

1203 
é_zbMacMlmeCommSètusIndiˇti⁄H™dÀr
(*
¨g
);

1204 
é_zbMacMlmeSˇnC⁄fúmH™dÀr
(*
¨g
);

1205 
é_zbMacMlmeBóc⁄NŸifyIndiˇti⁄H™dÀr
(*
¨g
);

1206 
é_zbMacMlmeAssocüãIndiˇti⁄H™dÀr
(*
¨g
);

1207 
é_zbMacMlmeRe£tC⁄fúmH™dÀr
 (*
¨g
);

1208 
é_zbMacMlmeOΩh™Indiˇti⁄H™dÀr
(*
¨g
);

1209 
é_zbMacMlmeSyncLossIndiˇti⁄H™dÀr
(*
¨g
);

1210 
é_zbMacMlmePﬁlIndiˇti⁄H™dÀr
(*
¨g
);

1212 
é_nwkBuûdJoöCnfPrimôive
(*
p
,
u8
 
°©us
);

1214 
é_zbNwkNldeD©aReque°H™dÀr
(*
¨g
);

1215 
é_zbNwkNlmeNëw‹kF‹m©i⁄Reque°H™dÀr
(*
¨g
);

1216 
é_zbNwkNlmePîmôJoöögReque°H™dÀr
(*
¨g
);

1217 
é_zbNwkNlmeNwkDiscReque°H™dÀr
(*
¨g
);

1218 
é_zbNwkNlmeSèπRouãrReque°H™dÀr
(*
¨g
);

1219 
é_zbNwkNlmeRouãDiscReque°H™dÀr
(*
¨g
);

1220 
é_zbNwkNlmeJoöReque°H™dÀr
(*
¨g
);

1221 
é_zbNwkNlmeDúe˘JoöReque°H™dÀr
(*
¨g
);

1222 
é_zbNwkNlmeEDSˇnReque°H™dÀr
(*
¨g
);

1223 
é_zbNwkNlmeLóveReque°H™dÀr
(*
¨g
);

1224 
é_zbNwkNlmeRe£tReque°H™dÀr
(*
¨g
);

1225 
é_zbNwkNlmeSyncReque°H™dÀr
(*
¨g
);

1226 
é_zbNwkNlmeGëReque°H™dÀr
(*
¨g
);

1227 
é_zbNwkNlmeSëReque°H™dÀr
(*
¨g
);

1233 
	#é_zbNwkNldeD©aReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLDE_DATA_REQ
,Ö)

	)

1234 
	#é_zbNwkNlmeNwkDiscReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_NWK_DISCOVERY_REQ
,Ö)

	)

1235 
	#é_zbNwkNlmeJoöReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_JOIN_REQ
,Ö)

	)

1236 
	#é_zbNwkNlmeNwkF‹m©i⁄Reque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_NWK_FORMATION_REQ
,Ö)

	)

1237 
	#é_zbNwkNlmePîmôJoöögReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_PERMIT_JOINING_REQ
,Ö)

	)

1238 
	#é_zbNwkNlmeRouãDiscReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_ROUTE_DISCOVERY_REQ
,Ö)

	)

1239 
	#é_zbNwkNlmeSèπRouãrReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_START_ROUTER_REQ
,Ö)

	)

1240 
	#é_zbNwkNlmeDúe˘JoöReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_DIRECT_JOIN_REQ
,Ö)

	)

1241 
	#é_zbNwkNlmeEDSˇnReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_ED_SCAN_REQ
,Ö)

	)

1242 
	#é_zbNwkNlmeLóveReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_LEAVE_REQ
,Ö)

	)

1243 
	#é_zbNwkNlmeRe£tReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_RESET_REQ
,Ö)

	)

1244 
	#é_zbNwkNlmeSyncReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_SYNC_REQ
,Ö)

	)

1245 
	#é_zbNwkNlmeGëReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_GET_REQ
,Ö)

	)

1246 
	#é_zbNwkNlmeSëReque°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_HIGH2NWK
, 
NWK_NLME_SET_REQ
,Ö)

	)

1252 
	#é_zbNwkNlmeNwkF‹m©i⁄C⁄fúmPo°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2HIGH
, 
NWK_NLME_NWK_FORMATION_CNF
,Ö)

	)

1253 
	#é_zbNwkNlmeNwkDiscC⁄fúmPo°
(
p
Ë
	`é_zbPrimôivePo°
(
TL_Q_NWK2HIGH
, 
NWK_NLME_NWK_DISCOVERY_CNF
,Ö)

	)

1257 (*
	tnwkD©aIndCb_t
)(*
	tp
);

1258 
	`é_nwkD©aIndRegi°î
(
nwkD©aIndCb_t
 
cb
);

1260 (*
	tnwkDiscovîyU£rCb_t
)();

1261 
	`é_nwkDiscovîyCbRegi°î
(
nwkDiscovîyU£rCb_t
 
cb
);

1263 (*
	tnwkSˇnC⁄fúmTouchlökCb_t
)(*
	t¨g
);

1264 (*
	tnwkTouchlökAârCÀ¨_t
)();

1267 
nwkSˇnC⁄fúmTouchlökCb_t
 
sˇnC⁄fCb
;

1268 
nwkTouchlökAârCÀ¨_t
 
©åCÃCb
;

1269 }
	tnwkF‹TouchlökCb_t
;

1271 
	`é_nwkTouchLökCbRegi°î
(
nwkF‹TouchlökCb_t
 *
cb
);

1278 
nwkF‹TouchlökCb_t
 
touchLökCb
;

1279 
nwkDiscovîyU£rCb_t
 
nwkDiscC⁄f
;

1280 }
	tnwk_upLayîCb_t
;

1282 
nwk_upLayîCb_t
 
g_nwkUpLayîCb
;

1285 
u8
 
	`is_devi˚_Á˘‹y_√w
();

1287 
	`é_edBrcD©aSkùP¨ítSë
(
boﬁ
 
skù
);

1290 #i‡
ZB_TEST_ENABLE


1291 
u8
 
nwkSecurôyEn
;

1292 
	#NWK_SECURITY_EN_SET
(
v
Ë
nwkSecurôyEn
 = 
	)
v

1296 
	#zb_isUndîRejoöMode
(Ë(
g_zbNwkCtx
.
°©e
 =
NLME_STATE_REJOIN
)

	)

	@zigbee/nwk/includes/nwk_addr_map.h

24 #i‚de‡
NWK_ADDR_MAP_H


25 
	#NWK_ADDR_MAP_H


	)

29 
	#ZB_UNKNOWN_SHORT_ADDR
 (
u16
)(-1)

	)

31 #i‚de‡
TL_ZB_NWK_ADDR_MAP_NUM


32 #i‡(
ZB_ROUTER_ROLE
)

33 
	#TL_ZB_NWK_ADDR_MAP_NUM
 128

	)

35 
	#TL_ZB_NWK_ADDR_MAP_NUM
 8

	)

39 
	saddrM≠pög_t
{

40 
addrM≠pög_t
 *
	m‰ìNext
;

41 
addrM≠pög_t
 *
	ma˘iveNext
;

42 
addrExt_t
 
	mextAddr
;

44 
u16
 
	msh‹tAddr
;

45 
u8
 
	m≠s_dup_˙t
;

46 
u8
 
	mu£d
:1;

47 
u8
 
	m≠s_dup_˛ock
:3;

48 
u8
 
	mböd
:1;

49 
u8
 
	mªsv
:3;

50 }
	té_zb_addr_m≠_íåy_t
;

53 
é_zb_addr_m≠_íåy_t
 *
	m‰ìHód
;

54 
é_zb_addr_m≠_íåy_t
 *
	ma˘iveHód
;

55 
u32
 
	mvÆidNum
;

56 
é_zb_addr_m≠_íåy_t
 
	maddrM≠
[
TL_ZB_NWK_ADDR_MAP_NUM
];

57 }
	té_zb_addr_m≠_t
;

60 
u16
 
	msh‹tAddr
;

61 
addrExt_t
 
	mextAddr
;

62 
u8
 
	mdïth
;

63 
u8
 
	mrxOnWhûeIdÀ
:1;

64 
u8
 
	mdevi˚Ty≥
:3;

65 
u8
 
	mªœti⁄shù
:3;

66 
u8
 
	mu£d
:1;

67 }
	tzb_addrF‹Neighb‹_t
;

70 
u16
 
	mmask_d°TabÀ
;

71 
addrExt_t
 
	md°ExtAddr
;

72 }
	tzb_addrF‹Böd_t
;

74 
u16
 
TL_ZB_NWK_ADDR_MAP_SIZE
;

75 
é_zb_addr_m≠_t
 
g_nwkAddrM≠
;

78 
	#zb_addªssTabÀNumGë
(Ë(
g_nwkAddrM≠
.
vÆidNum
)

	)

84 
u8
 
zb_addªss_õì_by_sh‹t
(
u16
 
sh‹t_addr
, 
addrExt_t
 
õì_addªss
) ;

86 
é_addrM≠pögF‹Böd
(
u8
 
böd
, 
u16
 
idx
);

88 
addrExt_t
 *
é_zbExtAddrPåBySh‹tAddr
(
u16
 
sh‹tAddr
);

91 
é_zb_addr_m≠_íåy_t
 *
é_zbNwkAddrM≠E¡ryGë
(
u16
 
‹dîIndex
);

94 
nwk_nodeAddrInfoSt‹e
(*
¨g
);

96 
s32
 
nwk_nodeAddrInfoDñëe
(
zb_addrF‹Neighb‹_t
 *
pAddrNv
);

99 
s32
 
nwk_∑ª¡NodeInfoSt‹e
();

102 
s32
 
nwk_bödAddrInfoUpd©e
(
zb_addrF‹Böd_t
 *
pAddrNv
);

104 
s32
 
nwk_bödAddrInfoDñëe
(
zb_addrF‹Böd_t
 *
pAddrNv
);

	@zigbee/nwk/includes/nwk_ctx.h

24 #i‚de‡
NWK_CTX_H


25 
	#NWK_CTX_H


	)

33 
	mSTARTUP_CONTROL_PART_OF_NETWORK
,

34 
	mSTARTUP_CONTROL_FORM_A_NETWORK
,

35 
	mSTARTUP_CONTROL_REJOIN_NETWORK
,

36 
	mSTARTUP_CONTROL_START_FROM_SCRATCH


37 }
	tSèπupC⁄åﬁ_©å_t
;

44 
	mNLME_STATE_IDLE
,

45 
	mNLME_STATE_DISC
,

46 
	mNLME_STATE_FORMATION_ED_SCAN
,

47 
	mNLME_STATE_FORMATION_ACTIVE_SCAN
,

48 
	mNLME_STATE_FORMATION
,

49 
	mNLME_STATE_ROUTER
,

50 
	mNLME_STATE_ED_SCAN
,

51 
	mNLME_STATE_REJOIN
,

52 
	mNLME_STATE_ORPHAN_SCAN
,

53 
	mNLME_STATE_RESET
,

54 
	mNLME_STATE_PANID_CONFLICT_RESOLUTION
,

55 
	mNLME_STATE_ADDR_CONFLICT_RESOLUTION
,

56 
	mNLME_STATE_ZLL_COMMISSION


57 }
	t∆me_°©e_t
;

61 
	mNLME_IDLE
,

62 
	mNLME_PERMIT_JOIN_REQ
,

63 
	mNLME_SEND_DEV_ANN
,

64 
	mNLME_LEAVING
,

65 }
	tu£r_°©e_t
;

69 
u16
 
	mnwkFwdD°Addr
;

70 
u16
 
	mnwkFwdSrcAddr
;

71 
u16
 
	m£ndîAddr
;

72 
u16
 
	mœ°SídFaûAddr
;

73 }
	tm™yToO√_ª∑ú_t
;

77 
u16
 
	mnwkFwdD°Addr
;

78 
u16
 
	mnwkFwdSrcAddr
;

79 }
	t§cRouã_ª∑ú_t
;

89 
u8
 
	míîgy_dëe˘
[
TL_ZB_MAC_CHANNEL_NUM
];

90 
u8
 
	mch™√l_∑n_cou¡
[
TL_ZB_MAC_CHANNEL_NUM
];

91 }
	mf‹m©i⁄Info
;

97 
é_zb_addôi⁄_√ighb‹_íåy_t
 *
	mpP¨ít
;

98 }
	massocJoö
;

100 
é_zb_addôi⁄_√ighb‹_íåy_t
 *
	mpP¨ít
;

101 }
	mªjoö
;

102 }
	mjoö
;

103 
u8
 *
	mjoöC™did©eLi°
;

107 
ev_timî_evít_t
 *
	mcurJoöögDevTimîEvt
;

109 
u32
 
	msˇnCh™√ls
;

111 
u8
 
	msˇnDuøti⁄
;

112 
u8
 
	mis_Á˘‹y_√w
:1;

113 
u8
 
	m≥rmô_joö
:1;

114 
u8
 
	mjoöed
:1;

115 
u8
 
	mrouãr_°¨ãd
:1;

116 
u8
 
	mis_tc
:1;

117 
u8
 
	mjoöed_¥o
:1;

118 
u8
 
	m∑nIdC⁄Êi˘
:1;

119 
u8
 
	mjoöAc˚±
:1;

120 
u8
 
	mknown_∑nids_˙t
:4;

121 
u8
 
	mdiscovîRouã
:1;

122 
u8
 
	m∑nidUpd©eRecv
:1;

123 
u8
 
	mªsv
:1;

124 
u8
 
	m∑ª¡IsCh™ged
:1;

125 
u8
 
	mu£r_°©e
:4;

126 
u8
 
	m°©e
:4;

128 
u8
 
	m∑ª¡
;

129 
u8
 
	mÀaveRejoö
;

130 
u16
 
	m√w_∑nid
;

133 
u16
 
	mknown_∑nids
[
PANID_TABLE_SIZE
];

135 
m™yToO√_ª∑ú_t
 
	mm™yToO√Rïaú
;

136 
§cRouã_ª∑ú_t
 
	m§cRouãRïaú
;

137 }
	tnwk_˘x_t
;

139 
nwk_˘x_t
 
g_zbNwkCtx
;

142 
	#ZB_SET_DISCOVER_ROUTE
(
v
Ë(
g_zbNwkCtx
.
discovîRouã
 = v)

	)

143 
	#ZB_GET_DISCOVER_ROUTE
 (
g_zbNwkCtx
.
discovîRouã
)

	)

145 
	#ZB_SET_USER_STATE
(
v
Ë(
g_zbNwkCtx
.
u£r_°©e
 = v)

	)

146 
	#ZB_GET_USER_STATE
 (
g_zbNwkCtx
.
u£r_°©e
)

	)

	@zigbee/nwk/includes/nwk_neighbor.h

24 #i‚de‡
NWK_NEIGHBOR_H


25 
	#NWK_NEIGHBOR_H


	)

31 
	#NEIGHBOR_IS_PARENT
 0

	)

32 
	#NEIGHBOR_IS_CHILD
 1

	)

33 
	#NEIGHBOR_IS_SIBLING
 2

	)

34 
	#NEIGHBOR_IS_NONE_OF_ABOVE
 3

	)

35 
	#NEIGHBOR_IS_PREVIOUS_CHILD
 4

	)

36 
	#NEIGHBOR_IS_UNAUTH_CHILD
 5

	)

38 #i‚de‡
TL_ZB_NEIGHBOR_TABLE_NUM


39 #i‡
ZB_ROUTER_ROLE


40 
	#TL_ZB_NEIGHBOR_TABLE_NUM
 26

	)

41 
	#TL_ZB_CHILD_TABLE_NUM
 16

	)

43 
	#TL_ZB_NEIGHBOR_TABLE_NUM
 2

	)

44 
	#TL_ZB_CHILD_TABLE_NUM
 0

	)

48 
	#TL_ZB_ADDITION_NEIGHBOR_TABLE_SIZE
 6

	)

50 
	#TRANSFAILURE_CNT_MAX
 2

	)

53 
	s√bTbl_t
{

54 
√bTbl_t
 *
	m‰ìNext
;

55 
√bTbl_t
 *
	ma˘iveNext
;

56 
u32
 
	mauthTimeout
;

57 
u32
 
	mtimeoutC¡
;

58 
u32
 
	mdevTimeout
;

59 
u16
 
	mídDevCfg
;

60 
u16
 
	maddrm≠Idx
;

61 #ifde‡
ZB_SECURITY


62 
u32
 
	möcomögFømeC¡
;

63 
u8
 
	mkeySeqNum
;

65 
u8
 
	mrsv
;

67 
boﬁ
 
	mkì∑liveRcvd
;

68 
u8
 
	mrxOnWhûeIdÀ
:1;

69 
u8
 
	mdevi˚Ty≥
:3;

73 
u8
 
	mªœti⁄shù
:3;

77 
u8
 
	mu£d
:1;

78 
u8
 
	mage
;

79 
u8
 
	mdïth
;

80 
u8
 
	må™sFaûuª
;

81 
u8
 
	mlqi
;

82 
u8
 
	moutgoögCo°
;

83 }
	té_zb_n‹mÆ_√ighb‹_íåy_t
;

86 
extPANId_t
 
	mextP™Id
;

87 
addrExt_t
 
	mextAddr
;

88 
u16
 
	msh‹tAddr
;

89 
u16
 
	m∑nId
;

90 
u8
 
	maddrMode
;

91 
u8
 
	mlogicCh™√l
;

92 
u8
 
	mdïth
 : 4;

93 
u8
 
	mbóc⁄Ordî
 : 4;

94 
u8
 
	m≥rmôJoöög
 : 1;

95 
u8
 
	mpŸítülP¨ít
 : 1;

96 
u8
 
	mrouãrC≠acôy
 : 1;

97 
u8
 
	medC≠acôy
 : 1;

98 
u8
 
	m°ackProfûe
 : 4;

99 
u8
 
	mdevi˚Ty≥
 : 2;

100 
u8
 
	msu≥r‰ameOrdî
 : 6;

102 
u8
 
	mlqi
;

103 
u8
 
	mnwkUpd©eId
;

104 
u8
 
	mrsv
;

105 }
	té_zb_addôi⁄_√ighb‹_íåy_t
;

108 
é_zb_addôi⁄_√ighb‹_íåy_t
 
	maddôi⁄Neighb‹Tbl
[
TL_ZB_ADDITION_NEIGHBOR_TABLE_SIZE
];

109 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
	m‰ìHód
;

110 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
	ma˘iveHód
;

111 
u8
 
	maddôi⁄Neighb‹Num
;

112 
u8
 
	mn‹mÆNeighb‹Num
;

113 
u8
 
	mchûdªnNum
;

114 
u8
 
	mªsv
;

115 
é_zb_n‹mÆ_√ighb‹_íåy_t
 
	m√ighb‹Tbl
[
TL_ZB_NEIGHBOR_TABLE_NUM
];

116 }
	té_zb_√ighb‹_íåy_t
 
	t_©åibuã_Æig√d_
(4);

118 
u8
 
NWK_NEIGHBORTBL_ADD_LQITHRESHOLD
;

119 
u32
 
NWK_UNAUTH_CHILD_TABLE_LIFE_TIME
;

121 
u8
 
TL_ZB_NEIGHBOR_TABLE_SIZE
;

122 
u8
 
TL_ZB_CHILD_TABLE_SIZE
;

123 
é_zb_√ighb‹_íåy_t
 
g_zb_√ighb‹Tbl
;

125 
é_zbNeighb‹TabÀInô
();

127 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
é_zbNeighb‹TabÀUpd©e
—l_zb_n‹mÆ_√ighb‹_íåy_à*
íåy
, 
u8
 
dñëe
);

129 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
é_zbNeighb‹TabÀSórchFromExtAddr
(
u16
 *
sh‹tAddr
, 
addrExt_t
 
extAddr
, u16 *
idx
);

131 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
é_zbNeighb‹TabÀSórchFromSh‹tAddr
(
u16
 
sh‹tAddr
, 
addrExt_t
 
extAddr
, u16 *
idx
);

133 
é_zbNeighb‹TabÀDñëe
(
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
íåy
);

135 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
é_zbNeighb‹TabÀSórchF‹P¨ít
();

137 
u16
 
é_zbNeighb‹P¨ítSh‹tAddrGë
();

139 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
é_zbNeighb‹E¡ryGëFromIdx
(
u8
 
idx
);

141 
u8
 
é_nwkNeighb‹DñëeByAddrm≠Idx
(
u16
 
idx
);

143 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
nwk_√TblGëBySh‹tAddr
(
u16
 
sh‹tAddr
);

145 
é_zb_addôi⁄_√ighb‹_íåy_t
 *
é_zbAddôi⁄Neighb‹E¡ryGëFromIdx
(
u8
 
idx
);

146 
u8
 
é_√ighb‹FømeC¡Re£t
();

147 
u8
 
é_zbAddôi⁄Neighb‹TabÀNumGë
();

149 
é_zbAddôi⁄Neighb‹Re£t
();

151 
u8
 
é_zbAddôi⁄Neighb‹TabÀUpd©e
(
é_zb_addôi⁄_√ighb‹_íåy_t
 *
íåy
);

153 
u8
 
é_zbNeighb‹TabÀNumGë
();

155 
u8
 
é_zbNeighb‹TabÀRouãrVÆidNumGë
();

157 
u8
 
é_zbNeighb‹TabÀChûdEDNumGë
();

159 
é_zb_n‹mÆ_√ighb‹_íåy_t
 *
nwk_√TblGëByExtAddr
(
addrExt_t
 
extAddr
);

	@zigbee/nwk/includes/nwk_nib.h

24 #i‚de‡
NWK_NIB_H


25 
	#NWK_NIB_H


	)

31 
	#NWK_MAX_DEPTH
 15

	)

33 
	#NWK_MAX_ROUTERS
 8

	)

39 
	#DEFAULT_MAX_CHILDREN
 25

	)

44 #i‡!
deföed
 ( 
NWK_MAX_ROUTERS
 )

45 
	#NWK_MAX_ROUTERS
 8

	)

51 #i‡!
deföed
 ( 
NWK_MAX_DEPTH
 )

52 
	#NWK_MAX_DEPTH
 5

	)

55 
	#ZB_NWK_LINK_STATUS_PEROID_DEFAULT
 15

	)

63 #ifde‡
ZB_ROUTER_ROLE


64 
u32
 
	m∑ssiveAckTimeout
;

66 
u8
 
	mlökSètusPîiod
;

67 
u8
 
	mmaxBrﬂdˇ°Rërõs
;

68 
u8
 
	mmaxChûdªn
;

69 
u8
 
	mmaxRouãrs
;

71 
u8
 
	mmaxSour˚Rouã
;

72 
u8
 
	mc⁄˚¡øt‹Radius
;

73 
u8
 
	mc⁄˚¡øt‹DiscovîyTime
;

74 
u8
 
	mrouãrAgeLimô
;

76 
u32
 
	mnwkBrﬂdˇ°DñivîyTime
;

78 
extPANId_t
 
	mextPANId
;

80 
u16
 
	m∑nId
;

81 
u16
 
	mnwkAddr
;

83 
u16
 
	mm™agîAddr
;

84 
u16
 
	mtxTŸÆ
;

86 
u16
 
	mtxFaû
;

87 
u16
 
	må™ß˘i⁄Pîsi°í˚Time
;

89 
u8
 
	m£qNum
;

90 
u8
 
	mdïth
;

91 
ˇ∑bûôy_öfo_t
 
	mˇ∑bûôyInfo
;

92 
u8
 
	maddrAŒoc
;

94 
u8
 
	mupd©eId
;

95 
u8
 
	m°ackProfûe
;

96 
u8
 
	mÆlFªsh
;

97 
u8
 
	m£cAŒFømes
;

99 
u8
 
	mmaxDïth
;

100 
boﬁ
 
	mªp‹tC⁄°™tCo°
:1;

101 
boﬁ
 
	msymLök
:1;

102 
boﬁ
 
	mu£TªeRoutög
:1;

103 
boﬁ
 
	mu£Mu…iˇ°
:1;

104 
boﬁ
 
	misC⁄˚¡øt‹
:1;

105 
boﬁ
 
	muniqueAddr
:1;

106 
boﬁ
 
	mtimeSèmp
:1;

107 
boﬁ
 
	mÀaveReqAŒowed
:1;

108 
u8
 
	m∑ª¡Info
;

109 
u8
 
	mídDevTimeoutDeÁu…
;

111 
addrExt_t
 
	mõìAddr
;

113 
boﬁ
 
	mÀaveReqWôhoutRejoöAŒowed
;

114 
u8
 
	mªsv
[3];

115 }
	tnwk_nib_t
;

118 
	#NWK_NIB
(Ë
g_zbNIB


	)

119 
	#NIB_NETWORK_ADDRESS
(Ë
g_zbNIB
.
nwkAddr


120 
	#NIB_IEEE_ADDRESS
(Ë
g_zbMacPib
.
extAddªss


	)

121 
	#NIB_PAN_ID
(Ë
g_zbNIB
.
∑nId


122 

	)

123 
	#NIB_GET_USE_MULTICAST
(Ë
g_zbNIB
.
u£Mu…iˇ°


	)

124 
	#NIB_SET_USE_MULTICAST
(
v
Ë(
g_zbNIB
.
u£Mu…iˇ°
 = (v))

	)

	@zigbee/ota/ota.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

25 
	~"../z˛/z˛_ö˛ude.h
"

26 
	~"Ÿa.h
"

28 #ifde‡
ZCL_OTA


33 
	#FLASH_WRITE_COUNT_GET
(
size
Ë((sizê/ (110 * 
OTA_IMAGE_MAX_DATA_SIZE
)Ë+ 1)

	)

34 
	#TL_IMAGE_START_FLAG
 0x4b

	)

41 
addrExt_t
 
	mextAddr
;

42 
u16
 
	m¥ofûeId
;

43 
u8
 
	mídpoöt
;

44 
u8
 
	mtxO±i⁄s
;

45 } 
	tŸa_£rvîAddr_t
;

49 
Ÿa_hdrFõlds_t
 
	mhdrInfo
;

50 
Ÿa_£rvîAddr_t
 
	mŸaSîvîAddrInfo
;

51 } 
	tŸa_upd©eInfo_t
;

54 
u8
 
Ÿa_imageNŸifyH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_imageNŸify_t
 *
pImageNŸify
);

55 
u8
 
Ÿa_quîyNextImageReqH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_quîyNextImageReq_t
 *
pQuîyNextImageReq
);

56 
u8
 
Ÿa_quîyNextImageR•H™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_quîyNextImageR•_t
 *
pQuîyNextImageR•
);

57 
u8
 
Ÿa_imageBlockReqH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_imageBlockReq_t
 *
pImageBlockReq
);

58 
u8
 
Ÿa_imagePageReqH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_imagePageReq_t
 *
pImagePageReq
);

59 
u8
 
Ÿa_imageBlockR•H™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_imageBlockR•_t
 *
pImageBlockR•
);

60 
u8
 
Ÿa_upgødeEndReqH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_upgødeEndReq_t
 *
pUpgødeEndReq
);

61 
u8
 
Ÿa_upgødeEndR•H™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_upgødeEndR•_t
 *
pUpgødeEndR•
);

62 
u8
 
Ÿa_quîyDevS≥cFûeReqH™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_quîyS≥cFûeReq_t
 *
pQuîyDevS≥cFûeReq
);

63 
u8
 
Ÿa_quîyDevS≥cFûeR•H™dÀr
(
≠sdeD©aInd_t
 *
pInd
, 
Ÿa_quîyS≥cFûeR•_t
 *
pQuîyDevS≥cFûeR•
);

65 
z˛_Ÿa_AµCÆlbacks_t
 
	gz˛_ŸaCb
 =

67 
Ÿa_imageNŸifyH™dÀr
,

68 
Ÿa_quîyNextImageReqH™dÀr
,

69 
Ÿa_quîyNextImageR•H™dÀr
,

70 
Ÿa_imageBlockReqH™dÀr
,

71 
Ÿa_imagePageReqH™dÀr
,

72 
Ÿa_imageBlockR•H™dÀr
,

73 
Ÿa_upgødeEndReqH™dÀr
,

74 
Ÿa_upgødeEndR•H™dÀr
,

75 
Ÿa_quîyDevS≥cFûeReqH™dÀr
,

76 
Ÿa_quîyDevS≥cFûeR•H™dÀr
,

85 
u8
 
	gmcuBoŸAddr
 = 0;

86 c⁄° 
u8
 
	gŸaHdrMagic
[] = {0x1e, 0xf1, 0xee, 0x0b};

88 c⁄° 
u8
 
	gŸaAesKey
[16] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,

91 
Ÿa_˘x_t
 
	gg_ŸaCtx
;

92 
Ÿa_ˇŒBack_t
 *
	gŸaCb
 = 
NULL
;

95 
Ÿa_˛õ¡Info_t
 
	gŸaClõ¡Info
;

96 
Ÿa_upd©eInfo_t
 *
	gpOèUpd©eInfo
 = 
NULL
;

99 
Ÿa_¥ómbÀ_t
 
	gŸaSîvîBöInfo
;

105 
ev_timî_evít_t
 
	gŸaTimî
;

110 
Ÿa_quîyNextImageReq
(
u8
 
d°Ep
, 
u16
 
d°Addr
, u16 
¥ofûeId
);

111 
Ÿa_imageBlockReq
(
u8
 
d°Ep
, 
u16
 
d°Addr
, u16 
¥ofûeId
);

112 
Ÿa_£ndImageBlockReq
(*
¨g
);

113 
Ÿa_upgødeEndReqSíd
(
Ÿa_upgødeEndReq_t
 *
ªq
);

114 
Ÿa_upgødeWaô
(
u32
 
£c⁄ds
);

115 
Ÿa_upgødeCom∂ëe
(
u8
 
°©us
);

123 
u8
 
	$mcuBoŸAddrGë
()

125 #i‡(
BOOT_LOADER_MODE
)

128 
u8
 
ÊashInfo
 = 0;

129 
	`Êash_ªad
(0 + 
FLASH_TLNK_FLAG_OFFSET
, 1, &
ÊashInfo
);

130  ((
ÊashInfo
 =
TL_IMAGE_START_FLAG
) ? 0 : 1);

132 
	}
}

134 
	$Ÿa_mcuReboŸ
()

136 
u8
 
ÊashInfo
 = 
TL_IMAGE_START_FLAG
;

137 
u32
 
√wAddr
 = 
FLASH_ADDR_OF_OTA_IMAGE
;

139 #i‡(
BOOT_LOADER_MODE
)

140 
	`Êash_wrôe
((
√wAddr
 + 
FLASH_TLNK_FLAG_OFFSET
), 1, &
ÊashInfo
);

142 
u32
 
ba£Addr
 = 0;

144 i‡(
mcuBoŸAddr
)

146 
ba£Addr
 = 
FLASH_ADDR_OF_OTA_IMAGE
;

147 
√wAddr
 = 0;

150 
	`Êash_wrôe
((
√wAddr
 + 
FLASH_TLNK_FLAG_OFFSET
), 1, &
ÊashInfo
);

151 
ÊashInfo
 = 0;

152 
	`Êash_wrôe
((
ba£Addr
 + 
FLASH_TLNK_FLAG_OFFSET
), 1, &
ÊashInfo
);

154 
	`SYSTEM_RESET
();

155 
	}
}

161 
	$Ÿa_£rvîAddrPî¥ogømmed
(
addrExt_t
 
õìAddr
, 
u8
 
§vEndPoöt
)

163 i‡(
	`ZB_IEEE_ADDR_IS_INVALID
(
z˛_©å_upgødeSîvîID
))

165 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
 = 
§vEndPoöt
;

166 
	`ZB_IEEE_ADDR_COPY
(
z˛_©å_upgødeSîvîID
, 
õìAddr
);

168 
	}
}

170 
u8
 
	$Ÿa_lﬂdImageInfo
(
Ÿa_hdrFõlds_t
 *
oh
)

172 
Ÿa_hdrFõlds_t
 *
lh
 = 
oh
;

173 
Ÿa_hdrFõlds_t
 
hdr
;

174 i‡(!
lh
)

176 
lh
 = &
hdr
;

177 
u32
 
ÊashAddr
 = (
mcuBoŸAddr
Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

178 
	`Êash_ªad
(
ÊashAddr
, (
hdr
), (
u8
 *)&hdr);

180 i‡(
lh
->
ŸaUpgødeFûeID
 =
OTA_UPGRADE_FILE_ID
)

182 
ŸaSîvîBöInfo
.
fûeVî
 = 
lh
->fileVer;

183 
ŸaSîvîBöInfo
.
imageTy≥
 = 
lh
->imageType;

184 
ŸaSîvîBöInfo
.
m™uÁ˘uªrCode
 = 
lh
->manufacturerCode;

185 
ŸaSîvîBöInfo
.
tŸÆImageSize
 = 
lh
->totalImageSize;

189  
RET_ERROR
;

191  
RET_OK
;

192 
	}
}

194 
	$Ÿa_˛õ¡InfoRecovî
()

197 
Ÿa_upd©eInfo_t
 *
pInfo
 = (Ÿa_upd©eInfo_à*)
	`ev_buf_Æloˇã
((ota_updateInfo_t));

198 i‡(
pInfo
)

200 i‡(
	`nv_ÊashRódNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_HDR_SERVERINFO
, (
Ÿa_upd©eInfo_t
), (
u8
 *)
pInfo
Ë=
NV_SUCC
)

202 i‡(
pInfo
->
hdrInfo
.
ŸaUpgødeFûeID
 =
OTA_UPGRADE_FILE_ID
)

204 
z˛_©å_dow∆ﬂdFûeVî
 = 
pInfo
->
hdrInfo
.
fûeVî
;

205 
z˛_©å_dow∆ﬂdZigbìSèckVî
 = 
pInfo
->
hdrInfo
.
zbSèckVî
;

206 
z˛_©å_m™uÁ˘uªrID
 = 
pInfo
->
hdrInfo
.
m™uÁ˘uªrCode
;

207 
z˛_©å_imageTy≥ID
 = 
pInfo
->
hdrInfo
.
imageTy≥
;

209 
g_ŸaCtx
.
dow∆ﬂdImageSize
 = 
pInfo
->
hdrInfo
.
tŸÆImageSize
;

211 i‡(
	`nv_ÊashRódNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_CODE
, (
Ÿa_˛õ¡Info_t
), (
u8
 *)&
ŸaClõ¡Info
Ë=
NV_SUCC
)

213 
z˛_©å_fûeOff£t
 = 
ŸaClõ¡Info
.
off£t
;

217 
z˛_©å_fûeOff£t
 = 
pInfo
->
hdrInfo
.
ŸaHdrLí
 + 6;

220 i‡(!
	`ZB_IEEE_ADDR_IS_INVALID
(
pInfo
->
ŸaSîvîAddrInfo
.
extAddr
))

222 
	`ZB_IEEE_ADDR_COPY
(
z˛_©å_upgødeSîvîID
, 
pInfo
->
ŸaSîvîAddrInfo
.
extAddr
);

223 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
¥ofûeId
 = 
pInfo
->
ŸaSîvîAddrInfo
.profileId;

224 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
 = 
pInfo
->
ŸaSîvîAddrInfo
.
ídpoöt
;

225 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
txO±i⁄s
 = 
pInfo
->
ŸaSîvîAddrInfo
.txOptions;

229 
	`ev_buf_‰ì
((
u8
 *)
pInfo
);

231 
	}
}

237 
	$Ÿa_öô
(
Ÿa_ty≥_e
 
ty≥
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂eDesc
, 
Ÿa_¥ómbÀ_t
 *
ŸaPªambÀ
, 
Ÿa_ˇŒBack_t
 *
cb
)

239 
ŸaCb
 = 
cb
;

242 
mcuBoŸAddr
 = 
	`mcuBoŸAddrGë
();

244 
	`mem£t
((
u8
 *)&
g_ŸaCtx
, 0, (g_otaCtx));

245 
	`mem£t
((
u8
 *)&
ŸaClõ¡Info
, 0, (otaClientInfo));

246 
	`mem£t
((
u8
 *)&
ŸaSîvîBöInfo
, 0, (otaServerBinInfo));

248 
g_ŸaCtx
.
isOèSîvî
 = (
ty≥
 =
OTA_TYPE_SERVER
Ë? 
TRUE
 : 
FALSE
;

249 
g_ŸaCtx
.
sim∂eDesc
 = simpleDesc;

251 
z˛_©å_cuºZigbìSèckVî
 = 
ZB_STACKVER_PRO
;

252 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_NORMAL
;

254 
	`z˛_ªgi°î
(
sim∂eDesc
->
ídpoöt
, 
OTA_CB_CLUSTER_NUM
, (
z˛_•ecClu°îInfo_t
 *)
g_ŸaClu°îLi°
);

256 i‡(
g_ŸaCtx
.
isOèSîvî
)

258 
	`Ÿa_lﬂdImageInfo
(
NULL
);

263 
g_ŸaCtx
.
pOèPªambÀ
 = 
ŸaPªambÀ
;

265 
z˛_©å_cuºFûeVî
 = 
ŸaPªambÀ
->
fûeVî
;

266 
z˛_©å_m™uÁ˘uªrID
 = 
ŸaPªambÀ
->
m™uÁ˘uªrCode
;

268 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_INIT_DONE
;

269 
ŸaClõ¡Info
.
¸cVÆue
 = 0xffffffff;

270 
	`Ÿa_˛õ¡InfoRecovî
();

272 
	}
}

274 #ifde‡
ZCL_WWAH


275 
	$Ÿa_wwah_u£Tru°Cíãr
(
u8
 
ídpoöt
)

277 i‡(!
	`ZB_IEEE_ADDR_CMP
(
z˛_©å_upgødeSîvîID
, 
ss_ib
.
åu°_˚¡î_addªss
))

279 
	`ZB_IEEE_ADDR_INVALID
(
z˛_©å_upgødeSîvîID
);

281 
	`ev_un⁄_timî
(&
ŸaTimî
);

283 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_INVALID_IMAGE
);

285 
	`Ÿa_£rvîAddrPî¥ogømmed
(
ss_ib
.
åu°_˚¡î_addªss
, 
ídpoöt
);

288 
Ÿa_upd©eInfo_t
 *
pInfo
 = (Ÿa_upd©eInfo_à*)
	`ev_buf_Æloˇã
((ota_updateInfo_t));

289 i‡(
pInfo
)

291 i‡(
	`nv_ÊashRódNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_HDR_SERVERINFO
, (
Ÿa_upd©eInfo_t
), (
u8
 *)
pInfo
Ë=
NV_SUCC
)

293 i‡(
	`ZB_IEEE_ADDR_CMP
(
pInfo
->
ŸaSîvîAddrInfo
.
extAddr
, 
ss_ib
.
åu°_˚¡î_addªss
) &&

294 (
pInfo
->
ŸaSîvîAddrInfo
.
ídpoöt
 ==Éndpoint))

296 
	`ev_buf_‰ì
((
u8
 *)
pInfo
);

301 
	`mem£t
((
u8
 *)
pInfo
, 0, (
Ÿa_upd©eInfo_t
));

303 
pInfo
->
ŸaSîvîAddrInfo
.
ídpoöt
 =Éndpoint;

304 
pInfo
->
ŸaSîvîAddrInfo
.
¥ofûeId
 = 
HA_PROFILE_ID
;

305 
	`ZB_IEEE_ADDR_COPY
(
pInfo
->
ŸaSîvîAddrInfo
.
extAddr
, 
ss_ib
.
åu°_˚¡î_addªss
);

307 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_HDR_SERVERINFO
, (
Ÿa_upd©eInfo_t
), (
u8
 *)
pInfo
);

309 
	`ev_buf_‰ì
((
u8
 *)
pInfo
);

311 
	}
}

314 
	$Ÿa_õìAddrR•Cb
(*
¨g
)

316 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

317 
zdo_õì_addr_ª•_t
 *
r•
 = (zdo_õì_addr_ª•_à*)
p
->
zpdu
;

319 i‡(
r•
->
°©us
 =
ZDO_SUCCESS
)

321 
	`ZB_IEEE_ADDR_COPY
(
z˛_©å_upgødeSîvîID
, 
r•
->
õì_addr_ªmŸe
);

324 i‡((
z˛_©å_imageUpgødeSètus
 !
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
) ||

325 (
ŸaClõ¡Info
.
˛õ¡OèFlg
 >
OTA_FLAG_IMAGE_MAGIC_0
))

331 
	`ev_un⁄_timî
(&
ŸaTimî
);

333 i‡((
r•
->
°©us
 =
ZDO_SUCCESS
))

338 
	`Ÿa_£ndImageBlockReq
(
NULL
);

339 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MAGIC_0
;

340 i‡(
ŸaCb
)

342 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_START
, 
ZCL_STA_SUCCESS
);

347 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_ABORT
);

349 
	}
}

351 
	$Ÿa_õìAddrReq
(
u16
 
d°Addr
)

353 
zdo_õì_addr_ªq_t
 
pReq
;

354 
u8
 
¢
 = 0;

355 
pReq
.
nwk_addr_öãª°
 = 
d°Addr
;

356 
pReq
.
ªq_ty≥
 = 
ZDO_ADDR_REQ_SINGLE_RESP
;

357 
pReq
.
°¨t_ödex
 = 0;

358 
	`zb_zdoIìeAddrReq
(
d°Addr
, &
pReq
, &
¢
, 
Ÿa_õìAddrR•Cb
);

359 
	}
}

361 
s32
 
	$Ÿa_õìAddrR•Waô
(*
¨g
)

363 
u8
 
˙t
 = 0;

365 i‡(++
˙t
 >
OTA_IEEE_ADDR_REQ_RETRIES
)

367 
˙t
 = 0;

369 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_ABORT
);

374 
	`Ÿa_õìAddrReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Addr
.
sh‹tAddr
);

377 
	}
}

379 
	$Ÿa_õìAddrReqSíd
(*
¨g
)

381 
	`Ÿa_õìAddrReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Addr
.
sh‹tAddr
);

384 
ŸaTimî
.
cb
 = 
Ÿa_õìAddrR•Waô
;

385 
ŸaTimî
.
d©a
 = 
NULL
;

386 
	`ev_⁄_timî
(&
ŸaTimî
, 
OTA_IEEE_ADDR_RSP_WAIT_TIME
 * 1000);

387 
	}
}

389 
	$Ÿa_m©chDescR•Cb
(*
¨g
)

391 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

392 
zdo_m©ch_des¸ùt‹_ª•_t
 *
r•
 = (zdo_m©ch_des¸ùt‹_ª•_à*)
p
->
zpdu
;

394 i‡((
r•
->
°©us
 =
ZDO_SUCCESS
Ë&& (r•->
m©chLí
))

397 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
 = 
r•
->
m©chLi°
[0];

398 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

399 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Addr
.
sh‹tAddr
 = 
r•
->
nwk_addr_öãª°
;

400 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
¥ofûeId
 = g_ŸaCtx.
sim∂eDesc
->
≠p_¥ofûe_id
;

402 
	`Ÿa_õìAddrReqSíd
(
NULL
);

404 i‡(
ŸaClõ¡Info
.
˛õ¡OèFlg
 =
OTA_FLAG_INIT_DONE
)

406 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_PULL_READY
;

407 
	`Ÿa_quîyNextImageReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
, g_ŸaCtx.ŸaSîvîEpInfo.
d°Addr
.
sh‹tAddr
, g_ŸaCtx.ŸaSîvîEpInfo.
¥ofûeId
);

410 
	}
}

412 
	$Ÿa_˛u°îM©chReq
(
u16
 
d°Addr
)

414 
zdo_m©ch_des¸ùt‹_ªq_t
 *
pReq
 = (zdo_m©ch_des¸ùt‹_ªq_à*)
	`ev_buf_Æloˇã
(6 + 2);

415 i‡(
pReq
)

417 
pReq
->
nwk_addr_öãª°
 = 
d°Addr
;

418 
pReq
->
¥ofûe_id
 = 
g_ŸaCtx
.
sim∂eDesc
->
≠p_¥ofûe_id
;

419 
pReq
->
num_ö_˛u°îs
 = 1;

420 
pReq
->
num_out_˛u°îs
 = 0;

421 
pReq
->
˛u°î_li°
[0] = 
ZCL_CLUSTER_OTA
;

423 
u8
 
¢
 = 0;

424 
	`zb_zdoM©chDescReq
(
d°Addr
, 
pReq
, &
¢
, 
Ÿa_m©chDescR•Cb
);

426 
	`ev_buf_‰ì
((
u8
 *)
pReq
);

428 
	}
}

430 
	$Ÿa_nwkAddrReqCb
(*
¨g
)

432 
zdo_zdpD©aInd_t
 *
p
 = (zdo_zdpD©aInd_à*)
¨g
;

433 
zdo_nwk_addr_ª•_t
 *
r•
 = (zdo_nwk_addr_ª•_à*)
p
->
zpdu
;

435 i‡(
r•
->
°©us
 =
ZDO_SUCCESS
)

437 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

438 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Addr
.
sh‹tAddr
 = 
r•
->
nwk_addr_ªmŸe
;

440 i‡(
ŸaClõ¡Info
.
˛õ¡OèFlg
 =
OTA_FLAG_INIT_DONE
)

442 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_PULL_READY
;

443 
	`Ÿa_quîyNextImageReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
, g_ŸaCtx.ŸaSîvîEpInfo.
d°Addr
.
sh‹tAddr
, g_ŸaCtx.ŸaSîvîEpInfo.
¥ofûeId
);

447 
g_ŸaCtx
.
imageBlockRëry
 = 0;

448 
	`ev_un⁄_timî
(&
ŸaTimî
);

449 
	`Ÿa_£ndImageBlockReq
(
NULL
);

450 i‡(
ŸaCb
)

452 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_START
, 
ZCL_STA_SUCCESS
);

456 
	}
}

458 
	$Ÿa_nwkAddrReq
(
addrExt_t
 
extAddr
)

460 
u8
 
¢
 = 0;

461 
zdo_nwk_addr_ªq_t
 
ªq
;

462 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
õì_addr_öãª°
, 
extAddr
);

463 
ªq
.
ªq_ty≥
 = 
ZDO_ADDR_REQ_SINGLE_RESP
;

464 
ªq
.
°¨t_ödex
 = 0;

465 
	`zb_zdoNwkAddrReq
(
NWK_BROADCAST_ROUTER_COORDINATOR
, &
ªq
, &
¢
, 
Ÿa_nwkAddrReqCb
);

466 
	}
}

468 
s32
 
	$Ÿa_≥riodicQuîySîvîCb
(*
¨g
)

470 
u16
 
£c⁄ds
 = ((
u32
)
¨g
) & 0xffff;

472 i‡(
ŸaClõ¡Info
.
˛õ¡OèFlg
 =
OTA_FLAG_INIT_DONE
)

474 i‡(
	`ZB_IEEE_ADDR_IS_INVALID
(
z˛_©å_upgødeSîvîID
))

477 
	`Ÿa_˛u°îM©chReq
(
NWK_BROADCAST_RX_ON_WHEN_IDLE
);

482 
	`Ÿa_nwkAddrReq
(
z˛_©å_upgødeSîvîID
);

493 
	`Ÿa_quîyNextImageReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
, g_ŸaCtx.ŸaSîvîEpInfo.
d°Addr
.
sh‹tAddr
, g_ŸaCtx.ŸaSîvîEpInfo.
¥ofûeId
);

496  (
£c⁄ds
 * 1000);

497 
	}
}

505 
	$Ÿa_quîySèπ
(
u16
 
£c⁄ds
)

507 i‡(!
g_ŸaCtx
.
isOèSîvî
)

509 i‡(!
	`ev_timî_exi°
(&
ŸaTimî
))

511 
ŸaTimî
.
cb
 = 
Ÿa_≥riodicQuîySîvîCb
;

512 
ŸaTimî
.
d©a
 = (*)((
u32
)
£c⁄ds
);

514 
u16
 
jôãr
 = 0;

517 
jôãr
 = 
	`zb_øndom
(Ë% 
OTA_QUERY_START_JITTER
;

518 } 
jôãr
 == 0);

520 
	`ev_⁄_timî
(&
ŸaTimî
, (
£c⁄ds
 * 1000Ë+ 
jôãr
);

523 
	}
}

525 
	$Ÿa_upgødeCom∂ëe
(
u8
 
°©us
)

528 i‡(
pOèUpd©eInfo
)

530 
	`ev_buf_‰ì
((
u8
 *)
pOèUpd©eInfo
);

531 
pOèUpd©eInfo
 = 
NULL
;

534 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_NORMAL
;

536 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

538 
	`nv_ª£tModuÀ
(
NV_MODULE_OTA
);

539 i‡(
ŸaCb
)

541 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_COMPLETE
, 
°©us
);

551 i‡(
°©us
 =
ZCL_STA_INVALID_IMAGE
)

553 
	`nv_ª£tModuÀ
(
NV_MODULE_OTA
);

555 
	`mem£t
((
u8
 *)&
ŸaClõ¡Info
, 0, (otaClientInfo));

556 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_INIT_DONE
;

557 
ŸaClõ¡Info
.
¸cVÆue
 = 0xffffffff;

559 
z˛_©å_imageTy≥ID
 = 0xffff;

560 
z˛_©å_fûeOff£t
 = 0xffffffff;

561 
z˛_©å_dow∆ﬂdFûeVî
 = 0xffffffff;

564 i‡(
ŸaCb
)

566 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_COMPLETE
, 
°©us
);

569 
	}
}

571 
	$Ÿa_imageBlockR•Timeout
(*
¨g
)

573 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_ABORT
);

574 
	}
}

576 
	$Ÿa_upgødeAb‹t
()

578 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_ABORT
);

579 
	}
}

581 
s32
 
	$Ÿa_imageBlockR•Waô
(*
¨g
)

583 i‡(++
g_ŸaCtx
.
imageBlockRëry
 >
OTA_MAX_IMAGE_BLOCK_RETRIES
)

586 
Ÿa_upgødeEndReq_t
 
ªq
;

588 
ªq
.
°
 = 
ZCL_STA_ABORT
;

589 
ªq
.
fûeVî
 = 
z˛_©å_dow∆ﬂdFûeVî
;

590 
ªq
.
imageTy≥
 = 
z˛_©å_imageTy≥ID
;

591 
ªq
.
m™uCode
 = 
z˛_©å_m™uÁ˘uªrID
;

593 
	`Ÿa_upgødeEndReqSíd
(&
ªq
);

602 
	`TL_SCHEDULE_TASK
(
Ÿa_imageBlockR•Timeout
, 
NULL
);

607 
	`TL_SCHEDULE_TASK
(
Ÿa_£ndImageBlockReq
, 
NULL
);

611 
	}
}

613 
	$£ndImageBlockReq
(*
¨g
)

615 
	`Ÿa_imageBlockReq
(
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
, g_ŸaCtx.ŸaSîvîEpInfo.
d°Addr
.
sh‹tAddr
, g_ŸaCtx.ŸaSîvîEpInfo.
¥ofûeId
);

618 
ŸaTimî
.
cb
 = 
Ÿa_imageBlockR•Waô
;

619 
ŸaTimî
.
d©a
 = 
NULL
;

620 
	`ev_⁄_timî
(&
ŸaTimî
, 
OTA_MAX_IMAGE_BLOCK_RSP_WAIT_TIME
 * 1000);

621 
	}
}

623 
s32
 
	$Ÿa_£ndImageBlockReqDñay
(*
¨g
)

625 
	`TL_SCHEDULE_TASK
(
£ndImageBlockReq
, 
NULL
);

627 
	}
}

629 
	$Ÿa_£ndImageBlockReq
(*
¨g
)

634 i‡(
z˛_©å_möBlockPîiod
)

636 
ŸaTimî
.
cb
 = 
Ÿa_£ndImageBlockReqDñay
;

637 
ŸaTimî
.
d©a
 = 
NULL
;

638 
	`ev_⁄_timî
(&
ŸaTimî
, 
z˛_©å_möBlockPîiod
);

642 
	`£ndImageBlockReq
(
NULL
);

644 
	}
}

646 
s32
 
	$Ÿa_imageBlockWaôCb
(*
¨g
)

648 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
)

650 
	`TL_SCHEDULE_TASK
(
£ndImageBlockReq
, 
NULL
);

654 
	}
}

656 
	$Ÿa_imageBlockWaô
(
u32
 
£c⁄ds
)

658 i‡(
£c⁄ds
)

660 
ŸaTimî
.
cb
 = 
Ÿa_imageBlockWaôCb
;

661 
ŸaTimî
.
d©a
 = 
NULL
;

662 
	`ev_⁄_timî
(&
ŸaTimî
, 
£c⁄ds
 * 1000);

666 
	`Ÿa_£ndImageBlockReq
(
NULL
);

668 
	}
}

670 
	$Ÿa_upgødeWôhWaô
(*
¨g
)

672 
Ÿa_upgødeEndReq_t
 
ªq
;

674 
ªq
.
°
 = 
ZCL_STA_SUCCESS
;

675 
ªq
.
fûeVî
 = 
z˛_©å_dow∆ﬂdFûeVî
;

676 
ªq
.
imageTy≥
 = 
z˛_©å_imageTy≥ID
;

677 
ªq
.
m™uCode
 = 
z˛_©å_m™uÁ˘uªrID
;

679 
	`Ÿa_upgødeEndReqSíd
(&
ªq
);

682 
u32
 
time
 = (u32)
¨g
;

683 
	`Ÿa_upgødeWaô
(
time
);

684 
	}
}

686 
	$Ÿa_upgøde
()

688 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
)

690 i‡(++
g_ŸaCtx
.
upgødeEndRëry
 >
OTA_MAX_UPGRADE_END_REQ_RETRIES
)

692 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_SUCCESS
);

696 
	`TL_SCHEDULE_TASK
(
Ÿa_upgødeWôhWaô
, (*)
OTA_MAX_IMAGE_BLOCK_RSP_WAIT_TIME
);

699 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_COUNT_DOWN
)

701 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_SUCCESS
);

703 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_WAITING_TO_UPGRADE
)

705 i‡(++
g_ŸaCtx
.
upgødeEndRëry
 >
OTA_MAX_UPGRADE_END_REQ_RETRIES
)

707 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_SUCCESS
);

712 
	`TL_SCHEDULE_TASK
(
Ÿa_upgødeWôhWaô
, (*)3600);

715 
	}
}

717 
s32
 
	$Ÿa_upgødeWaôCb
(*
¨g
)

719 
	`Ÿa_upgøde
();

721 
	}
}

723 
	$Ÿa_upgødeWaô
(
u32
 
£c⁄ds
)

725 i‡(
£c⁄ds
)

727 
ŸaTimî
.
cb
 = 
Ÿa_upgødeWaôCb
;

728 
ŸaTimî
.
d©a
 = 
NULL
;

729 
	`ev_⁄_timî
(&
ŸaTimî
, 
£c⁄ds
 * 1000);

733 
	`Ÿa_upgøde
();

735 
	}
}

737 
boﬁ
 
	$Ÿa_fûeIdCmp
(
u16
 
cuºM™uCode
, u16 
√wM™uCode
, u16 
cuºImageTy≥
, u16 
√wImageTy≥
, 
u32
 
cuºFûeVî
, u32 
√wFûeVî
)

739 i‡((
cuºM™uCode
 =0xFFFFË|| (
√wM™uCode
 == 0xFFFF) || (currManuCode ==ÇewManuCode))

741 i‡((
cuºImageTy≥
 =0xFFFFË|| (
√wImageTy≥
 == 0xFFFF) || (currImageType ==ÇewImageType))

743 i‡((
cuºFûeVî
 =0xFFFFFFFFË|| (
√wFûeVî
 == 0xFFFFFFFF) || (currFileVer ==ÇewFileVer))

745  
TRUE
;

750  
FALSE
;

751 
	}
}

753 
	$Ÿa_ßveUpd©eInfo2NV
(*
¨g
)

755 
u8
 
˙t
 = 0;

757 i‡((++
˙t
 >
	`FLASH_WRITE_COUNT_GET
(
g_ŸaCtx
.
dow∆ﬂdImageSize
Ë|| (
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
)))

759 
˙t
 = 0;

760 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_CODE
, (
Ÿa_˛õ¡Info_t
), (
u8
 *)&
ŸaClõ¡Info
);

762 
	}
}

764 
u8
 
	$Ÿa_imageD©aPro˚ss
(
u8
 
Àn
, u8 *
pD©a
)

766 
boﬁ
 
vÆidChecked
 = 0;

768 i‡(
z˛_©å_imageUpgødeSètus
 !
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
)

770  
ZCL_STA_ABORT
;

772 i‡(!
pD©a
)

774  
ZCL_STA_INVALID_IMAGE
;

777 
u8
 
i
 = 0; i < 
Àn
; i++)

779 
ŸaClõ¡Info
.
˛õ¡OèFlg
)

781 
OTA_FLAG_IMAGE_MAGIC_0
:

782 i‡(
pD©a
[
i
] !
ŸaHdrMagic
[i] || !
pOèUpd©eInfo
)

784  
ZCL_STA_INVALID_IMAGE
;

788 
pOèUpd©eInfo
->
hdrInfo
.
ŸaUpgødeFûeID
 = 
pD©a
[
i
];

790 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MAGIC_1
;

792 
OTA_FLAG_IMAGE_MAGIC_1
:

793 i‡(
pD©a
[
i
] !
ŸaHdrMagic
[i] || !
pOèUpd©eInfo
)

795  
ZCL_STA_INVALID_IMAGE
;

799 
pOèUpd©eInfo
->
hdrInfo
.
ŸaUpgødeFûeID
 |((
u32
)
pD©a
[
i
] << 8) & 0xff00;

801 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MAGIC_2
;

803 
OTA_FLAG_IMAGE_MAGIC_2
:

804 i‡(
pD©a
[
i
] !
ŸaHdrMagic
[i] || !
pOèUpd©eInfo
)

806  
ZCL_STA_INVALID_IMAGE
;

810 
pOèUpd©eInfo
->
hdrInfo
.
ŸaUpgødeFûeID
 |((
u32
)
pD©a
[
i
] << 16) & 0xff0000;

812 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MAGIC_3
;

814 
OTA_FLAG_IMAGE_MAGIC_3
:

815 i‡(
pD©a
[
i
] !
ŸaHdrMagic
[i])

817  
ZCL_STA_INVALID_IMAGE
;

821 i‡(!
pOèUpd©eInfo
)

823  
ZCL_STA_INVALID_IMAGE
;

825 
pOèUpd©eInfo
->
hdrInfo
.
ŸaUpgødeFûeID
 |((
u32
)
pD©a
[
i
] << 24) & 0xff000000;

827 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_VER1
;

829 
OTA_FLAG_IMAGE_HDR_VER1
:

830 i‡(!
pOèUpd©eInfo
)

832  
ZCL_STA_INVALID_IMAGE
;

834 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrVî
 = 
pD©a
[
i
];

835 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_VER2
;

837 
OTA_FLAG_IMAGE_HDR_VER2
:

838 i‡(!
pOèUpd©eInfo
)

840  
ZCL_STA_INVALID_IMAGE
;

842 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrVî
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

843 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_LEN1
;

845 
OTA_FLAG_IMAGE_HDR_LEN1
:

847 i‡(!
pOèUpd©eInfo
)

849  
ZCL_STA_INVALID_IMAGE
;

851 i‡(
z˛_©å_fûeOff£t
 =
OTA_HDR_LEN_OFFSET
)

853 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrLí
 = 
pD©a
[
i
];

854 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_LEN2
;

857 
OTA_FLAG_IMAGE_HDR_LEN2
:

858 i‡(!
pOèUpd©eInfo
)

860  
ZCL_STA_INVALID_IMAGE
;

862 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrLí
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

863 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_FC1
;

865 
OTA_FLAG_IMAGE_HDR_FC1
:

866 i‡(!
pOèUpd©eInfo
)

868  
ZCL_STA_INVALID_IMAGE
;

870 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrFC
 = 
pD©a
[
i
];

871 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_HDR_FC2
;

873 
OTA_FLAG_IMAGE_HDR_FC2
:

874 i‡(!
pOèUpd©eInfo
)

876  
ZCL_STA_INVALID_IMAGE
;

878 
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrFC
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

879 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MANU_CODE1
;

881 
OTA_FLAG_IMAGE_MANU_CODE1
:

882 i‡(!
pOèUpd©eInfo
)

884  
ZCL_STA_INVALID_IMAGE
;

886 
pOèUpd©eInfo
->
hdrInfo
.
m™uÁ˘uªrCode
 = 
pD©a
[
i
];

887 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MANU_CODE2
;

889 
OTA_FLAG_IMAGE_MANU_CODE2
:

890 i‡(!
pOèUpd©eInfo
)

892  
ZCL_STA_INVALID_IMAGE
;

894 
pOèUpd©eInfo
->
hdrInfo
.
m™uÁ˘uªrCode
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

895 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_TYPE1
;

897 
OTA_FLAG_IMAGE_TYPE1
:

898 i‡(!
pOèUpd©eInfo
)

900  
ZCL_STA_INVALID_IMAGE
;

902 
pOèUpd©eInfo
->
hdrInfo
.
imageTy≥
 = 
pD©a
[
i
];

903 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_TYPE2
;

905 
OTA_FLAG_IMAGE_TYPE2
:

906 i‡(!
pOèUpd©eInfo
)

908  
ZCL_STA_INVALID_IMAGE
;

910 
pOèUpd©eInfo
->
hdrInfo
.
imageTy≥
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

911 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_FILE_VER1
;

913 
OTA_FLAG_IMAGE_FILE_VER1
:

914 i‡(!
pOèUpd©eInfo
)

916  
ZCL_STA_INVALID_IMAGE
;

918 
pOèUpd©eInfo
->
hdrInfo
.
fûeVî
 = 
pD©a
[
i
];

919 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_FILE_VER2
;

921 
OTA_FLAG_IMAGE_FILE_VER2
:

922 i‡(!
pOèUpd©eInfo
)

924  
ZCL_STA_INVALID_IMAGE
;

926 
pOèUpd©eInfo
->
hdrInfo
.
fûeVî
 |((
u32
)
pD©a
[
i
] << 8) & 0xff00;

927 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_FILE_VER3
;

929 
OTA_FLAG_IMAGE_FILE_VER3
:

930 i‡(!
pOèUpd©eInfo
)

932  
ZCL_STA_INVALID_IMAGE
;

934 
pOèUpd©eInfo
->
hdrInfo
.
fûeVî
 |((
u32
)
pD©a
[
i
] << 16) & 0xff0000;

935 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_FILE_VER4
;

937 
OTA_FLAG_IMAGE_FILE_VER4
:

938 i‡(!
pOèUpd©eInfo
)

940  
ZCL_STA_INVALID_IMAGE
;

942 
pOèUpd©eInfo
->
hdrInfo
.
fûeVî
 |((
u32
)
pD©a
[
i
] << 24) & 0xff000000;

943 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_STACK_VER1
;

945 
OTA_FLAG_IMAGE_STACK_VER1
:

947 i‡(!
pOèUpd©eInfo
)

949  
ZCL_STA_INVALID_IMAGE
;

951 i‡(
z˛_©å_fûeOff£t
 =
OTA_STACK_VER_OFFSET
)

953 
pOèUpd©eInfo
->
hdrInfo
.
zbSèckVî
 = 
pD©a
[
i
];

954 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_STACK_VER2
;

957 
OTA_FLAG_IMAGE_STACK_VER2
:

958 i‡(!
pOèUpd©eInfo
)

960  
ZCL_STA_INVALID_IMAGE
;

962 
pOèUpd©eInfo
->
hdrInfo
.
zbSèckVî
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

963 i‡(
pOèUpd©eInfo
->
hdrInfo
.
zbSèckVî
 !
ZB_STACKVER_PRO
)

965  
ZCL_STA_INVALID_IMAGE
;

969 
z˛_©å_dow∆ﬂdZigbìSèckVî
 = 
pOèUpd©eInfo
->
hdrInfo
.
zbSèckVî
;

971 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_CONT_HDR
;

973 
OTA_FLAG_IMAGE_CONT_HDR
:

975 i‡(
z˛_©å_fûeOff£t
 >(
Ÿa_hdrFõlds_t
Ë|| !
pOèUpd©eInfo
)

977  
ZCL_STA_INVALID_IMAGE
;

979 
	`mem˝y
((
u8
 *)&(
pOèUpd©eInfo
->
hdrInfo
Ë+ 
z˛_©å_fûeOff£t
, &
pD©a
[
i
], 1);

980 i‡(
z˛_©å_fûeOff£t
 =
pOèUpd©eInfo
->
hdrInfo
.
ŸaHdrLí
 - 1)

984 
	`ZB_IEEE_ADDR_COPY
(
pOèUpd©eInfo
->
ŸaSîvîAddrInfo
.
extAddr
, 
z˛_©å_upgødeSîvîID
);

985 
pOèUpd©eInfo
->
ŸaSîvîAddrInfo
.
¥ofûeId
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.profileId;

986 
pOèUpd©eInfo
->
ŸaSîvîAddrInfo
.
ídpoöt
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
;

987 
pOèUpd©eInfo
->
ŸaSîvîAddrInfo
.
txO±i⁄s
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.txOptions;

990 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_OTA
, 
NV_ITEM_OTA_HDR_SERVERINFO
, (
Ÿa_upd©eInfo_t
), (
u8
 *)
pOèUpd©eInfo
);

991 
	`ev_buf_‰ì
((
u8
 *)
pOèUpd©eInfo
);

992 
pOèUpd©eInfo
 = 
NULL
;

994 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_TAG1
;

997 
OTA_FLAG_IMAGE_ELEM_TAG1
:

998 
ŸaClõ¡Info
.
ŸaEÀmítTag
 = 
pD©a
[
i
];

999 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_TAG2
;

1001 
OTA_FLAG_IMAGE_ELEM_TAG2
:

1002 
ŸaClõ¡Info
.
ŸaEÀmítTag
 |((
u16
)
pD©a
[
i
] << 8) & 0xff00;

1003 
ŸaClõ¡Info
.
ŸaEÀmítPos
 = 0;

1004 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_LEN1
;

1006 
OTA_FLAG_IMAGE_ELEM_LEN1
:

1007 
ŸaClõ¡Info
.
ŸaEÀmítLí
 = 
pD©a
[
i
];

1008 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_LEN2
;

1010 
OTA_FLAG_IMAGE_ELEM_LEN2
:

1011 
ŸaClõ¡Info
.
ŸaEÀmítLí
 |((
u32
)
pD©a
[
i
] << 8) & 0xff00;

1012 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_LEN3
;

1014 
OTA_FLAG_IMAGE_ELEM_LEN3
:

1015 
ŸaClõ¡Info
.
ŸaEÀmítLí
 |((
u32
)
pD©a
[
i
] << 16) & 0xff0000;

1016 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_LEN4
;

1018 
OTA_FLAG_IMAGE_ELEM_LEN4
:

1019 
ŸaClõ¡Info
.
ŸaEÀmítLí
 |((
u32
)
pD©a
[
i
] << 24) & 0xff000000;

1020 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = (ŸaClõ¡Info.
ŸaEÀmítTag
 =
OTA_UPGRADE_IMAGE_AES_TAG_ID
Ë? 
OTA_FLAG_IMAGE_ELEM_INFO1


1021 : 
OTA_FLAG_IMAGE_ELEMENT
;

1024 i‡(
ŸaClõ¡Info
.
ŸaEÀmítLí
 > (
g_ŸaCtx
.
dow∆ﬂdImageSize
 - 
z˛_©å_fûeOff£t
))

1026  
ZCL_STA_INVALID_IMAGE
;

1029 
OTA_FLAG_IMAGE_ELEM_INFO1
:

1030 
ŸaClõ¡Info
.
ŸaEÀmítInfo1
 = 
pD©a
[
i
];

1031 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_INFO2
;

1033 
OTA_FLAG_IMAGE_ELEM_INFO2
:

1034 
ŸaClõ¡Info
.
ŸaEÀmítInfo2
 = 
pD©a
[
i
];

1035 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEMENT
;

1037 
OTA_FLAG_IMAGE_ELEMENT
:

1038 i‡((
ŸaClõ¡Info
.
ŸaEÀmítTag
 =
OTA_UPGRADE_IMAGE_TAG_ID
Ë|| (ŸaClõ¡Info.ŸaEÀmítTag =
OTA_UPGRADE_IMAGE_AES_TAG_ID
))

1040 i‡((
ŸaClõ¡Info
.
ŸaEÀmítLí
 =0Ë|| (ŸaClõ¡Info.
ŸaEÀmítPos
 > otaClientInfo.otaElementLen))

1042  
ZCL_STA_INVALID_IMAGE
;

1045 
u8
 
d©aSize
 = 
Àn
 - 
i
;

1047 
u8
 
c›yLí
 = 
d©aSize
;

1048 i‡(
ŸaClõ¡Info
.
ŸaEÀmítLí
 - oèClõ¡Info.
ŸaEÀmítPos
 < 
d©aSize
)

1050 
c›yLí
 = 
ŸaClõ¡Info
.
ŸaEÀmítLí
 - oèClõ¡Info.
ŸaEÀmítPos
;

1053 i‡(
ŸaClõ¡Info
.
ŸaEÀmítTag
 =
OTA_UPGRADE_IMAGE_AES_TAG_ID
)

1055 
u8
 
tmpBuf
[16];

1056 
u8
 
j
 = 0; j < 
c›yLí
; j += 16)

1058 
	`mem£t
(
tmpBuf
, 0xff, 16);

1059 
	`mem˝y
(
tmpBuf
, &
pD©a
[
i
 + 
j
], 16);

1060 
	`´s_de¸y±
((
u8
 *)
ŸaAesKey
, 
tmpBuf
, &
pD©a
[
i
 + 
j
]);

1065 
u32
 
d©aEndPos
 = 
ŸaClõ¡Info
.
ŸaEÀmítLí
 - oèClõ¡Info.
ŸaEÀmítInfo2
;

1066 
u8
 
¸cLí
 = 0;

1067 i‡(
d©aEndPos
 - 
ŸaClõ¡Info
.
ŸaEÀmítPos
 <= 4)

1069 
¸cLí
 = 0;

1071 i‡(
d©aEndPos
 - 4 - 
ŸaClõ¡Info
.
ŸaEÀmítPos
 >
d©aSize
)

1073 
¸cLí
 = 
d©aSize
;

1077 
¸cLí
 = 
d©aEndPos
 - 4 - 
ŸaClõ¡Info
.
ŸaEÀmítPos
;

1079 
ŸaClõ¡Info
.
¸cVÆue
 = 
	`x¸c32
(&
pD©a
[
i
], 
¸cLí
, otaClientInfo.crcValue);

1082 i‡((
ŸaClõ¡Info
.
ŸaEÀmítPos
 < 
FLASH_TLNK_FLAG_OFFSET
 + 1Ë&& ((ŸaClõ¡Info.ŸaEÀmítPo†+ 
d©aSize
) >= FLASH_TLNK_FLAG_OFFSET + 1))

1084 i‡(
pD©a
[
i
 + (
FLASH_TLNK_FLAG_OFFSET
 - 
ŸaClõ¡Info
.
ŸaEÀmítPos
)] !
TL_IMAGE_START_FLAG
)

1086  
ZCL_STA_INVALID_IMAGE
;

1088 
pD©a
[
i
 + (
FLASH_TLNK_FLAG_OFFSET
 - 
ŸaClõ¡Info
.
ŸaEÀmítPos
)] = 0xff;

1090 
u32
 
ba£Addr
 = (
mcuBoŸAddr
Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

1091 
	`Êash_wrôe
(
ba£Addr
 + 
ŸaClõ¡Info
.
ŸaEÀmítPos
, 
c›yLí
, &
pD©a
[
i
]);

1093 
ŸaClõ¡Info
.
ŸaEÀmítPos
 +
c›yLí
;

1094 
z˛_©å_fûeOff£t
 +
c›yLí
;

1096 
ŸaClõ¡Info
.
off£t
 = 
z˛_©å_fûeOff£t
;

1098 i‡(
ŸaClõ¡Info
.
ŸaEÀmítPos
 =ŸaClõ¡Info.
ŸaEÀmítLí
)

1100 
u16
 
¸cFúmw¨e
 = 0;

1101 
	`Êash_ªad
(
ba£Addr
 + 6, 2, (
u8
 *)&
¸cFúmw¨e
);

1102 i‡(((
¸cFúmw¨e
 & 0xff) == 0x5D) && ((crcFirmware >> 8) & 0xff) == 0x02)

1104 
u32
 
¸cRe˚ived
;

1105 
	`Êash_ªad
(
ba£Addr
 + 
d©aEndPos
 - 4, 4, (
u8
 *)&
¸cRe˚ived
);

1107 i‡(
¸cRe˚ived
 !
ŸaClõ¡Info
.
¸cVÆue
)

1109  
ZCL_STA_INVALID_IMAGE
;

1111 
vÆidChecked
 = 1;

1115  
ZCL_STA_INVALID_IMAGE
;

1118 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_ELEM_TAG1
;

1121 i‡(
c›yLí
 =
d©aSize
)

1123 
i
 = 
Àn
 - 1;

1127 
i
 +
c›yLí
 - 1;

1129 
z˛_©å_fûeOff£t
--;

1133  
ZCL_STA_INVALID_IMAGE
;

1141 
z˛_©å_fûeOff£t
++;

1144 i‡(
z˛_©å_fûeOff£t
 >
g_ŸaCtx
.
dow∆ﬂdImageSize
)

1146 i‡(
vÆidChecked
)

1148 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
;

1149  
ZCL_STA_SUCCESS
;

1153  
ZCL_STA_INVALID_IMAGE
;

1158  
ZCL_STA_SUCCESS
;

1159 
	}
}

1161 
	$Ÿa_quîyNextImageReq
(
u8
 
d°Ep
, 
u16
 
d°Addr
, u16 
¥ofûeId
)

1163 
Ÿa_quîyNextImageReq_t
 
ªq
;

1164 
	`mem£t
((
u8
 *)&
ªq
, 0, (req));

1165 
ªq
.
fc
 = 0;

1166 
ªq
.
m™uCode
 = 
g_ŸaCtx
.
pOèPªambÀ
->
m™uÁ˘uªrCode
;

1167 
ªq
.
imageTy≥
 = 
g_ŸaCtx
.
pOèPªambÀ
->imageType;

1168 
ªq
.
curFûeVî
 = 
z˛_©å_cuºFûeVî
;

1170 
ïInfo_t
 
d°EpInfo
;

1171 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1172 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1173 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = dstAddr;

1174 
d°EpInfo
.
d°Ep
 = dstEp;

1175 
d°EpInfo
.
¥ofûeId
 =ÖrofileId;

1176 
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1177 
d°EpInfo
.
txO±i⁄s
 |
g_ŸaCtx
.
ŸaSîvîEpInfo
.txOptions;

1179 
	`z˛_Ÿa_quîyNextImageReqCmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
FALSE
, &
ªq
);

1180 
	}
}

1182 
	$Ÿa_imageBlockReq
(
u8
 
d°Ep
, 
u16
 
d°Addr
, u16 
¥ofûeId
)

1184 
Ÿa_imageBlockReq_t
 
ªq
;

1185 
	`mem£t
((
u8
 *)&
ªq
, 0, (req));

1186 
ªq
.
fc
 = 
OTA_IMAGE_BLOCK_FC
;

1187 
ªq
.
m™uCode
 = 
g_ŸaCtx
.
pOèPªambÀ
->
m™uÁ˘uªrCode
;

1188 
ªq
.
imageTy≥
 = 
g_ŸaCtx
.
pOèPªambÀ
->imageType;

1189 
ªq
.
fûeVî
 = 
z˛_©å_dow∆ﬂdFûeVî
;

1190 
ªq
.
fûeOff£t
 = 
z˛_©å_fûeOff£t
;

1192 i‡(
g_ŸaCtx
.
dow∆ﬂdImageSize
 - 
z˛_©å_fûeOff£t
 < 
OTA_IMAGE_MAX_DATA_SIZE
)

1194 
ªq
.
maxD©aSize
 = 
g_ŸaCtx
.
dow∆ﬂdImageSize
 - 
z˛_©å_fûeOff£t
;

1198 
ªq
.
maxD©aSize
 = 
OTA_IMAGE_MAX_DATA_SIZE
;

1201 i‡(
ªq
.
fc
 & 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
)

1203 
ªq
.
blockReqDñay
 = 
z˛_©å_möBlockPîiod
;

1206 
ïInfo_t
 
d°EpInfo
;

1207 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1208 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1209 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = dstAddr;

1210 
d°EpInfo
.
d°Ep
 = dstEp;

1211 
d°EpInfo
.
¥ofûeId
 =ÖrofileId;

1212 
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1213 
d°EpInfo
.
txO±i⁄s
 |
g_ŸaCtx
.
ŸaSîvîEpInfo
.txOptions;

1215 
	`z˛_Ÿa_imageBlockReqCmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
FALSE
, &
ªq
);

1216 
	}
}

1218 
	$Ÿa_upgødeEndReqSíd
(
Ÿa_upgødeEndReq_t
 *
ªq
)

1220 
ïInfo_t
 
d°EpInfo
;

1221 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1222 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1223 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.dstAddr.shortAddr;

1224 
d°EpInfo
.
d°Ep
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.dstEp;

1225 
d°EpInfo
.
¥ofûeId
 = 
g_ŸaCtx
.
ŸaSîvîEpInfo
.profileId;

1226 
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1227 
d°EpInfo
.
txO±i⁄s
 |
g_ŸaCtx
.
ŸaSîvîEpInfo
.txOptions;

1229 
	`z˛_Ÿa_upgødeEndReqCmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
FALSE
, 
ªq
);

1230 
	}
}

1232 
°©us_t
 
	$Ÿa_quîyNextImageReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_quîyNextImageReq_t
 *
pQuîyNextImageReq
)

1234 
u8
 
°©us
 = 
ZCL_STA_NO_IMAGE_AVAILABLE
;

1235 
Ÿa_quîyNextImageR•_t
 
r•
;

1237 i‡((
ŸaSîvîBöInfo
.
m™uÁ˘uªrCode
 =
pQuîyNextImageReq
->
m™uCode
Ë&& (ŸaSîvîBöInfo.
imageTy≥
 =pQuîyNextImageReq->imageTy≥Ë&& (ŸaSîvîBöInfo.
fûeVî
 >ÖQuîyNextImageReq->
curFûeVî
))

1239 
°©us
 = 
ZCL_STA_SUCCESS
;

1242 
r•
.
°
 = 
°©us
;

1243 
r•
.
m™uCode
 = 
pQuîyNextImageReq
->manuCode;

1244 
r•
.
imageTy≥
 = 
pQuîyNextImageReq
->imageType;

1245 
r•
.
fûeVî
 = 
ŸaSîvîBöInfo
.fileVer;

1246 
r•
.
imageSize
 = 
ŸaSîvîBöInfo
.
tŸÆImageSize
;

1248 
ïInfo_t
 
d°EpInfo
;

1249 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1250 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1251 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

1252 
d°EpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

1253 
d°EpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

1254 
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1256 
	`z˛_Ÿa_quîyNextImageR•CmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
TRUE
, 
pAddrInfo
->
£qNum
, &
r•
);

1258  
ZCL_STA_CMD_HAS_RESP
;

1259 
	}
}

1261 
°©us_t
 
	$Ÿa_imageBlockReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_imageBlockReq_t
 *
pImageBlockReq
)

1263 i‡((
ŸaSîvîBöInfo
.
m™uÁ˘uªrCode
 !
pImageBlockReq
->
m™uCode
Ë|| (pImageBlockReq->
fûeVî
 !ŸaSîvîBöInfo.fûeVîË|| (ŸaSîvîBöInfo.
imageTy≥
 !=ÖImageBlockReq->imageType))

1265  
ZCL_STA_NO_IMAGE_AVAILABLE
;

1268 
u8
 *
buf
 = 
NULL
;

1269 
Ÿa_imageBlockR•_t
 
r•
;

1271 i‡((
pImageBlockReq
->
fc
 & 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
Ë&& (pImageBlockReq->
blockReqDñay
 !
z˛_©å_möBlockPîiod
))

1273 
r•
.
°
 = 
ZCL_STA_WAIT_FOR_DATA
;

1274 
r•
.r•.
waô
.
cuºTime
 = 0;

1275 
r•
.r•.
waô
.
ªqTime
 = 0;

1276 
r•
.r•.
waô
.
blockReqDñay
 = 
z˛_©å_möBlockPîiod
;

1280 
u8
 
Àn
 = (
pImageBlockReq
->
maxD©aSize
 > 
OTA_IMAGE_MAX_DATA_SIZE
) ? OTA_IMAGE_MAX_DATA_SIZE :ÖImageBlockReq->maxDataSize;

1281 
buf
 = (
u8
 *)
	`ev_buf_Æloˇã
(
Àn
);

1282 i‡(!
buf
)

1284 
r•
.
°
 = 
ZCL_STA_WAIT_FOR_DATA
;

1285 
r•
.r•.
waô
.
cuºTime
 = 0;

1286 
r•
.r•.
waô
.
ªqTime
 = 0;

1287 
r•
.r•.
waô
.
blockReqDñay
 = 
z˛_©å_möBlockPîiod
;

1291 
u32
 
ÊashAddr
 = (
mcuBoŸAddr
Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

1292 
	`Êash_ªad
(
ÊashAddr
 + 
pImageBlockReq
->
fûeOff£t
, 
Àn
, 
buf
);

1293 
r•
.
°
 = 
ZCL_STA_SUCCESS
;

1294 
r•
.r•.
suc˚ss
.
m™uCode
 = 
pImageBlockReq
->manuCode;

1295 
r•
.r•.
suc˚ss
.
imageTy≥
 = 
pImageBlockReq
->imageType;

1296 
r•
.r•.
suc˚ss
.
fûeVî
 = 
ŸaSîvîBöInfo
.fileVer;

1297 
r•
.r•.
suc˚ss
.
fûeOff£t
 = 
pImageBlockReq
->fileOffset;

1298 
r•
.r•.
suc˚ss
.
d©aSize
 = 
Àn
;

1299 
r•
.r•.
suc˚ss
.
d©a
 = 
buf
;

1303 
ïInfo_t
 
d°EpInfo
;

1304 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1305 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1306 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

1307 
d°EpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

1308 
d°EpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

1310 
	`z˛_Ÿa_imageBlockR•CmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
TRUE
, 
pAddrInfo
->
£qNum
, &
r•
);

1312 i‡(
buf
)

1314 
	`ev_buf_‰ì
(
buf
);

1317  
ZCL_STA_CMD_HAS_RESP
;

1318 
	}
}

1320 
°©us_t
 
	$Ÿa_imagePageReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_imagePageReq_t
 *
pImagePageReq
)

1322  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1323 
	}
}

1325 
°©us_t
 
	$Ÿa_upgødeEndReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_upgødeEndReq_t
 *
pUpgødeEndReq
)

1327 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1329 i‡(
pUpgødeEndReq
->
°
 =
ZCL_STA_SUCCESS
)

1331 
Ÿa_upgødeEndR•_t
 
r•
;

1333 
r•
.
fûeVî
 = 
pUpgødeEndReq
->fileVer;

1334 
r•
.
imageTy≥
 = 
pUpgødeEndReq
->imageType;

1335 
r•
.
m™uCode
 = 
pUpgødeEndReq
->manuCode;

1336 
r•
.
cuºítTime
 = 0;

1337 
r•
.
upgødeTime
 = 60;

1339 
ïInfo_t
 
d°EpInfo
;

1340 
	`mem£t
((
u8
 *)&
d°EpInfo
, 0, (dstEpInfo));

1341 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1342 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

1343 
d°EpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

1344 
d°EpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

1346 
	`z˛_Ÿa_upgødeEndR•CmdSíd
(
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
, &
d°EpInfo
, 
TRUE
, 
pAddrInfo
->
£qNum
, &
r•
);

1348 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1351  
°©us
;

1352 
	}
}

1354 
°©us_t
 
	$Ÿa_quîyDevS≥cFûeReqH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_quîyS≥cFûeReq_t
 *
pQuîyDevS≥cFûeReq
)

1356  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1357 
	}
}

1359 
°©us_t
 
	$Ÿa_imageNŸifyH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_imageNŸify_t
 *
pImageNŸify
)

1361 i‡(!
	`ZB_IEEE_ADDR_IS_INVALID
(
z˛_©å_upgødeSîvîID
))

1363 
addrExt_t
 *
pExtAddr
 = 
	`é_zbExtAddrPåBySh‹tAddr
(
pAddrInfo
->
§cAddr
);

1364 i‡(
pExtAddr
 && !
	`ZB_IEEE_ADDR_CMP
(
z˛_©å_upgødeSîvîID
,ÖExtAddr))

1366  
ZCL_STA_CMD_HAS_RESP
;

1370 i‡(
z˛_©å_imageUpgødeSètus
 !
IMAGE_UPGRADE_STATUS_NORMAL
)

1372  
ZCL_STA_FAILURE
;

1375 i‡(
	`ZB_NWK_IS_ADDRESS_BROADCAST
(
pAddrInfo
->
d°Addr
))

1377 i‡((
pImageNŸify
->
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERT_JITTER_MFG
Ë&& (pImageNŸify->
m™uCode
 !
g_ŸaCtx
.
pOèPªambÀ
->
m™uÁ˘uªrCode
))

1379  
ZCL_STA_SUCCESS
;

1381 i‡((
pImageNŸify
->
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE
Ë&& (pImageNŸify->
imageTy≥
 !
g_ŸaCtx
.
pOèPªambÀ
->imageType))

1383  
ZCL_STA_SUCCESS
;

1385 i‡((
pImageNŸify
->
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE_VER
Ë&& (pImageNŸify->
√wFûeVî
 =
z˛_©å_cuºFûeVî
))

1387  
ZCL_STA_SUCCESS
;

1390 i‡((
	`zb_øndom
(Ë% 100Ë> 
pImageNŸify
->
quîyJôãr
)

1392  
ZCL_STA_SUCCESS
;

1396 i‡(
pAddrInfo
->
≠sSec
)

1398 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1402 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
txO±i⁄s
 &(
u8
)(~(
u16
)
APS_TX_OPT_SECURITY_ENABLED
);

1405 
	`Ÿa_quîyNextImageReq
(
pAddrInfo
->
§cEp
,ÖAddrInfo->
§cAddr
,ÖAddrInfo->
¥ofûeId
);

1407  
ZCL_STA_CMD_HAS_RESP
;

1408 
	}
}

1410 
°©us_t
 
	$Ÿa_quîyNextImageR•H™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_quîyNextImageR•_t
 *
pQuîyNextImageR•
)

1412 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
)

1414  
ZCL_STA_SUCCESS
;

1417 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1418 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

1419 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

1420 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

1421 
g_ŸaCtx
.
ŸaSîvîEpInfo
.
ødius
 = 0;

1423 
g_ŸaCtx
.
imageBlockRëry
 = 0;

1425 i‡((
pQuîyNextImageR•
->
°
 =
ZCL_STA_SUCCESS
Ë&& (pQuîyNextImageR•->
imageTy≥
 =
g_ŸaCtx
.
pOèPªambÀ
->imageTy≥Ë&& (pQuîyNextImageR•->
m™uCode
 =g_ŸaCtx.pOèPªambÀ->
m™uÁ˘uªrCode
))

1428 #ifde‡
ZCL_WWAH


1429 
boﬁ
 
dißbÀ
 = 
FALSE
;

1430 
u16
 
Àn
;

1432 i‡(
	`z˛_gëAârVÆ
(
pAddrInfo
->
d°Ep
, 
ZCL_CLUSTER_WWAH
, 
ZCL_ATTRID_WWAH_DISABLE_OTA_DOWNGRADES
, &
Àn
, (
u8
 *)&
dißbÀ
Ë=
ZCL_STA_SUCCESS
)

1434 i‡(
dißbÀ
 && (
pQuîyNextImageR•
->
fûeVî
 < 
g_ŸaCtx
.
pOèPªambÀ
->fileVer))

1436 
Ÿa_upgødeEndReq_t
 
ªq
;

1438 
ªq
.
°
 = 
ZCL_STA_INVALID_IMAGE
;

1439 
ªq
.
fûeVî
 = 
pQuîyNextImageR•
->fileVer;

1440 
ªq
.
imageTy≥
 = 
pQuîyNextImageR•
->imageType;

1441 
ªq
.
m™uCode
 = 
pQuîyNextImageR•
->manuCode;

1443 
	`Ÿa_upgødeEndReqSíd
(&
ªq
);

1445  
ZCL_STA_SUCCESS
;

1450 i‡(
pQuîyNextImageR•
->
fûeVî
 =
g_ŸaCtx
.
pOèPªambÀ
->fileVer)

1452  
ZCL_STA_SUCCESS
;

1455 i‡(
pQuîyNextImageR•
->
imageSize
 > 
FLASH_OTA_IMAGE_MAX_SIZE
)

1457  
ZCL_STA_INSUFFICIENT_SPACE
;

1460 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
;

1463 
	`ev_un⁄_timî
(&
ŸaTimî
);

1465 i‡(
g_ŸaCtx
.
dow∆ﬂdImageSize
 =
pQuîyNextImageR•
->
imageSize
 &&

1466 
z˛_©å_imageTy≥ID
 =
pQuîyNextImageR•
->
imageTy≥
 &&

1467 
z˛_©å_dow∆ﬂdFûeVî
 =
pQuîyNextImageR•
->
fûeVî
 &&

1468 
z˛_©å_fûeOff£t
 > 4096)

1472 i‡(
ŸaClõ¡Info
.
off£t
 =
g_ŸaCtx
.
dow∆ﬂdImageSize
)

1475 i‡(
ŸaClõ¡Info
.
ŸaEÀmítPos
 =ŸaClõ¡Info.
ŸaEÀmítLí
)

1478 
u32
 
ba£Addr
 = (
mcuBoŸAddr
Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

1479 
u16
 
¸cFúmw¨e
 = 0;

1480 
	`Êash_ªad
(
ba£Addr
 + 6, 2, (
u8
 *)&
¸cFúmw¨e
);

1481 i‡(((
¸cFúmw¨e
 & 0xff) == 0x5D) && ((crcFirmware >> 8) & 0xff) == 0x02)

1483 
u32
 
¸cRe˚ived
;

1484 
	`Êash_ªad
(
ba£Addr
 + 
ŸaClõ¡Info
.
ŸaEÀmítLí
 - oèClõ¡Info.
ŸaEÀmítInfo2
 - 4, 4, (
u8
 *)&
¸cRe˚ived
);

1487 i‡(
¸cRe˚ived
 =
ŸaClõ¡Info
.
¸cVÆue
)

1489 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_SUCCESS
);

1491  
ZCL_STA_SUCCESS
;

1499 
	`Ÿa_£ndImageBlockReq
(
NULL
);

1500 i‡(
ŸaCb
)

1502 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_START
, 
pQuîyNextImageR•
->
°
);

1504  
ZCL_STA_SUCCESS
;

1509 
z˛_©å_fûeOff£t
 = 0;

1511 
ŸaClõ¡Info
.
¸cVÆue
 = 0xffffffff;

1513 
z˛_©å_imageTy≥ID
 = 
pQuîyNextImageR•
->
imageTy≥
;

1514 
z˛_©å_dow∆ﬂdFûeVî
 = 
pQuîyNextImageR•
->
fûeVî
;

1515 
g_ŸaCtx
.
dow∆ﬂdImageSize
 = 
pQuîyNextImageR•
->
imageSize
;

1517 
u16
 
£˘‹NumU£d
 = 
g_ŸaCtx
.
dow∆ﬂdImageSize
 / 
FLASH_SECTOR_SIZE
 + 1;

1518 
u32
 
ba£Addr
 = (
mcuBoŸAddr
Ë? 0 : 
FLASH_ADDR_OF_OTA_IMAGE
;

1520 
u16
 
i
 = 0; i < 
£˘‹NumU£d
; i++)

1522 
	`Êash_îa£
(
ba£Addr
 + 
i
 * 
FLASH_SECTOR_SIZE
);

1525 
pOèUpd©eInfo
 = (
Ÿa_upd©eInfo_t
 *)
	`ev_buf_Æloˇã
((ota_updateInfo_t));

1526 i‡(!
pOèUpd©eInfo
)

1528  
ZCL_STA_INSUFFICIENT_SPACE
;

1531 
	`mem£t
((
u8
 *)
pOèUpd©eInfo
, 0, (
Ÿa_upd©eInfo_t
));

1533 i‡(
	`ZB_IEEE_ADDR_IS_INVALID
(
z˛_©å_upgødeSîvîID
))

1535 
	`TL_SCHEDULE_TASK
(
Ÿa_õìAddrReqSíd
, 
NULL
);

1539 
	`Ÿa_£ndImageBlockReq
(
NULL
);

1540 
ŸaClõ¡Info
.
˛õ¡OèFlg
 = 
OTA_FLAG_IMAGE_MAGIC_0
;

1541 i‡(
ŸaCb
)

1543 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_START
, 
pQuîyNextImageR•
->
°
);

1548  
ZCL_STA_SUCCESS
;

1549 
	}
}

1551 
°©us_t
 
	$Ÿa_imageBlockR•H™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_imageBlockR•_t
 *
pImageBlockR•
)

1553 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1555 
Ÿa_upgødeEndReq_t
 
ªq
;

1557 i‡(
z˛_©å_imageUpgødeSètus
 !
IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
)

1559  
ZCL_STA_SUCCESS
;

1562 i‡(
pImageBlockR•
->
°
 =
ZCL_STA_SUCCESS
)

1564 i‡((
pImageBlockR•
->
r•
.
suc˚ss
.
imageTy≥
 !
g_ŸaCtx
.
pOèPªambÀ
->imageTy≥Ë|| (pImageBlockR•->r•.suc˚ss.
m™uCode
 !g_ŸaCtx.pOèPªambÀ->
m™uÁ˘uªrCode
Ë|| (pImageBlockR•->r•.suc˚ss.
fûeVî
 !
z˛_©å_dow∆ﬂdFûeVî
))

1566 
°©us
 = 
ZCL_STA_INVALID_IMAGE
;

1570 i‡(
pImageBlockR•
->
r•
.
suc˚ss
.
fûeOff£t
 !
z˛_©å_fûeOff£t
)

1572  
ZCL_STA_SUCCESS
;

1576 
	`ev_un⁄_timî
(&
ŸaTimî
);

1578 
g_ŸaCtx
.
imageBlockRëry
 = 0;

1580 
°©us
 = 
	`Ÿa_imageD©aPro˚ss
(
pImageBlockR•
->
r•
.
suc˚ss
.
d©aSize
,

1581 
pImageBlockR•
->
r•
.
suc˚ss
.
d©a
);

1583 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1586 
	`TL_SCHEDULE_TASK
(
Ÿa_ßveUpd©eInfo2NV
, 
NULL
);

1588 i‡(
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
)

1590 
ªq
.
°
 = 
ZCL_STA_SUCCESS
;

1591 
ªq
.
fûeVî
 = 
pImageBlockR•
->
r•
.
suc˚ss
.fileVer;

1592 
ªq
.
imageTy≥
 = 
pImageBlockR•
->
r•
.
suc˚ss
.imageType;

1593 
ªq
.
m™uCode
 = 
pImageBlockR•
->
r•
.
suc˚ss
.manuCode;

1595 
	`Ÿa_upgødeEndReqSíd
(&
ªq
);

1597 
g_ŸaCtx
.
upgødeEndRëry
 = 0;

1598 
	`Ÿa_upgødeWaô
(
OTA_MAX_IMAGE_BLOCK_RSP_WAIT_TIME
);

1602 
	`Ÿa_£ndImageBlockReq
(
NULL
);

1607 
	`Ÿa_upgødeCom∂ëe
(
°©us
);

1611 i‡(
pImageBlockR•
->
°
 =
ZCL_STA_WAIT_FOR_DATA
)

1614 
	`ev_un⁄_timî
(&
ŸaTimî
);

1617 i‡((
OTA_IMAGE_BLOCK_FC
 & 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
) != 0)

1619 i‡(
pImageBlockR•
->
r•
.
waô
.
ªqTime
 -ÖImageBlockR•->r•.waô.
cuºTime
)

1622 
g_ŸaCtx
.
imageBlockRëry
 = 0;

1624 
	`Ÿa_imageBlockWaô
(
pImageBlockR•
->
r•
.
waô
.
ªqTime
 -ÖImageBlockR•->r•.waô.
cuºTime
);

1629 
z˛_©å_möBlockPîiod
 = 
pImageBlockR•
->
r•
.
waô
.
blockReqDñay
;

1630 
	`Ÿa_£ndImageBlockReq
(
NULL
);

1636 
g_ŸaCtx
.
imageBlockRëry
 = 0;

1638 
	`Ÿa_imageBlockWaô
(
pImageBlockR•
->
r•
.
waô
.
ªqTime
 -ÖImageBlockR•->r•.waô.
cuºTime
);

1641 i‡(
pImageBlockR•
->
°
 =
ZCL_STA_ABORT
)

1643 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_NORMAL
;

1646 
	`ev_un⁄_timî
(&
ŸaTimî
);

1649 
g_ŸaCtx
.
imageBlockRëry
 = 0;

1651 
	`Ÿa_upgødeCom∂ëe
(
ZCL_STA_ABORT
);

1653  
ZCL_STA_SUCCESS
;

1657  
ZCL_STA_MALFORMED_COMMAND
;

1660 i‡(
°©us
 !
ZCL_STA_SUCCESS
)

1662 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_NORMAL
;

1664 
ªq
.
°
 = 
°©us
;

1665 
ªq
.
fûeVî
 = 
pImageBlockR•
->
r•
.
suc˚ss
.fileVer;

1666 
ªq
.
imageTy≥
 = 
pImageBlockR•
->
r•
.
suc˚ss
.imageType;

1667 
ªq
.
m™uCode
 = 
pImageBlockR•
->
r•
.
suc˚ss
.manuCode;

1669 
	`Ÿa_upgødeEndReqSíd
(&
ªq
);

1672  
ZCL_STA_SUCCESS
;

1673 
	}
}

1675 
°©us_t
 
	$Ÿa_upgødeEndR•H™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_upgødeEndR•_t
 *
pUpgødeEndR•
)

1677 i‡((
z˛_©å_imageUpgødeSètus
 =
IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
Ë|| ((z˛_©å_imageUpgødeSètu†=
IMAGE_UPGRADE_STATUS_WAITING_TO_UPGRADE
Ë&& (
pUpgødeEndR•
->
upgødeTime
 != 0xFFFFFFFF)))

1680 i‡(
	`Ÿa_fûeIdCmp
(
g_ŸaCtx
.
pOèPªambÀ
->
m™uÁ˘uªrCode
, 
pUpgødeEndR•
->
m™uCode
,

1681 
g_ŸaCtx
.
pOèPªambÀ
->
imageTy≥
, 
pUpgødeEndR•
->imageType,

1682 
z˛_©å_dow∆ﬂdFûeVî
, 
pUpgødeEndR•
->
fûeVî
Ë=
FALSE
)

1684  
ZCL_STA_SUCCESS
;

1688 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_COUNT_DOWN
;

1690 
u32
 
jôãr
 = 
	`zb_øndom
();

1692 if((
jôãr
 >= 5) && (jitter <= 10)){

1695 
jôãr
 = 
	`zb_øndom
();

1699 
	`Ÿa_upgødeWaô
(
jôãr
);

1701 i‡(
pUpgødeEndR•
->
upgødeTime
 != 0xFFFFFFFF)

1703 
u32
 
nŸifyDñay
 = 0;

1704 i‡(
pUpgødeEndR•
->
upgødeTime
 >ÖUpgødeEndR•->
cuºítTime
)

1707 
nŸifyDñay
 = 
pUpgødeEndR•
->
upgødeTime
 -ÖUpgødeEndR•->
cuºítTime
;

1710 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_COUNT_DOWN
;

1712 
	`Ÿa_upgødeWaô
(
nŸifyDñay
);

1717 
z˛_©å_imageUpgødeSètus
 = 
IMAGE_UPGRADE_STATUS_WAITING_TO_UPGRADE
;

1720 
	`Ÿa_upgødeWaô
(3600);

1722 
g_ŸaCtx
.
upgødeEndRëry
 = 0;

1725 i‡(
ŸaCb
)

1727 
ŸaCb
->
	`¥o˚ssMsgCbFunc
(
OTA_EVT_IMAGE_DONE
, 
z˛_©å_imageUpgødeSètus
);

1732  
ZCL_STA_SUCCESS
;

1733 
	}
}

1735 
°©us_t
 
	$Ÿa_quîyDevS≥cFûeR•H™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
Ÿa_quîyS≥cFûeR•_t
 *
pQuîyDevS≥cFûeR•
)

1737  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1738 
	}
}

1740 
°©us_t
 
	$z˛_ŸaCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

1742 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1744 i‡(
pAddrInfo
->
d°Ep
 =
g_ŸaCtx
.
sim∂eDesc
->
ídpoöt
)

1746 i‡(
pAddrInfo
->
dúClu°î
 =
ZCL_FRAME_CLIENT_SERVER_DIR
)

1748 
cmdId
)

1750 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_REQ
:

1751 
°©us
 = 
	`Ÿa_quîyNextImageReqH™dÀr
(
pAddrInfo
, (
Ÿa_quîyNextImageReq_t
 *)
cmdPaylﬂd
);

1753 
ZCL_CMD_OTA_IMAGE_BLOCK_REQ
:

1754 
°©us
 = 
	`Ÿa_imageBlockReqH™dÀr
(
pAddrInfo
, (
Ÿa_imageBlockReq_t
 *)
cmdPaylﬂd
);

1756 
ZCL_CMD_OTA_IMAGE_PAGE_REQ
:

1757 
°©us
 = 
	`Ÿa_imagePageReqH™dÀr
(
pAddrInfo
, (
Ÿa_imagePageReq_t
 *)
cmdPaylﬂd
);

1759 
ZCL_CMD_OTA_UPGRADE_END_REQ
:

1760 
°©us
 = 
	`Ÿa_upgødeEndReqH™dÀr
(
pAddrInfo
, (
Ÿa_upgødeEndReq_t
 *)
cmdPaylﬂd
);

1762 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_REQ
:

1763 
°©us
 = 
	`Ÿa_quîyDevS≥cFûeReqH™dÀr
(
pAddrInfo
, (
Ÿa_quîyS≥cFûeReq_t
 *)
cmdPaylﬂd
);

1766 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1772 
cmdId
)

1774 
ZCL_CMD_OTA_IMAGE_NOTIFY
:

1775 
°©us
 = 
	`Ÿa_imageNŸifyH™dÀr
(
pAddrInfo
, (
Ÿa_imageNŸify_t
 *)
cmdPaylﬂd
);

1777 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_RSP
:

1778 
°©us
 = 
	`Ÿa_quîyNextImageR•H™dÀr
(
pAddrInfo
, (
Ÿa_quîyNextImageR•_t
 *)
cmdPaylﬂd
);

1780 
ZCL_CMD_OTA_IMAGE_BLOCK_RSP
:

1781 
°©us
 = 
	`Ÿa_imageBlockR•H™dÀr
(
pAddrInfo
, (
Ÿa_imageBlockR•_t
 *)
cmdPaylﬂd
);

1783 
ZCL_CMD_OTA_UPGRADE_END_RSP
:

1784 
°©us
 = 
	`Ÿa_upgødeEndR•H™dÀr
(
pAddrInfo
, (
Ÿa_upgødeEndR•_t
 *)
cmdPaylﬂd
);

1786 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_RSP
:

1787 
°©us
 = 
	`Ÿa_quîyDevS≥cFûeR•H™dÀr
(
pAddrInfo
, (
Ÿa_quîyS≥cFûeR•_t
 *)
cmdPaylﬂd
);

1790 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1796  
°©us
;

1797 
	}
}

	@zigbee/ota/ota.h

24 #i‚de‡
OTA_H


25 
	#OTA_H


	)

29 
	#OTA_IMAGESECTORHDR_SIZE
 6

	)

30 
	#OTA_IMAGE_MAX_DATA_SIZE
 48

	)

32 
	#OTA_HDR_LEN_OFFSET
 6

	)

33 
	#OTA_STACK_VER_OFFSET
 18

	)

35 
	#OTA_UPGRADE_FILE_ID
 0x0BEEF11E

	)

37 
	#OTA_UPGRADE_IMAGE_TAG_ID
 0x0000

38 
	#OTA_UPGRADE_IMAGE_AES_TAG_ID
 0xF000

39 

	)

40 
	#OTA_QUERY_START_JITTER
 (5 * 1000)

41 
	#OTA_PERIODIC_QUERY_INTERVAL
 (5 * 60)

42 
	#OTA_MAX_IMAGE_BLOCK_RSP_WAIT_TIME
 5

43 
	#OTA_IEEE_ADDR_RSP_WAIT_TIME
 2

44 

	)

45 
	#OTA_IMAGE_BLOCK_FC
 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT


46 

	)

48 
	#OTA_MAX_IMAGE_BLOCK_RETRIES
 10

	)

49 
	#OTA_MAX_UPGRADE_END_REQ_RETRIES
 2

	)

50 
	#OTA_IEEE_ADDR_REQ_RETRIES
 3

	)

53 
	mOTA_TYPE_CLIENT
,

54 
	mOTA_TYPE_SERVER


55 }
	tŸa_ty≥_e
;

58 
	mZB_STACKVER_2006
 = 0x0000,

59 
	mZB_STACKVER_2007
 = 0x0001,

60 
	mZB_STACKVER_PRO
 = 0x0002,

61 
	mZB_STACKVER_IP
 = 0x0003

62 }
	tzb_°ackVî_e
;

71 
u32
 
	mŸaUpgødeFûeID
;

74 
u16
 
	mŸaHdrVî
;

78 
u16
 
	mŸaHdrLí
;

81 
u16
 
	mŸaHdrFC
;

83 
u16
 
	mm™uÁ˘uªrCode
;

87 
u16
 
	mimageTy≥
;

90 
u32
 
	mfûeVî
;

91 
u16
 
	mzbSèckVî
;

93 
u8
 
	mŸaHdrSåög
[32];

95 
u32
 
	mtŸÆImageSize
;

97 
u8
 
	m£curôyCªdVî
;

98 
addrExt_t
 
	mfûeDe°
;

99 
u16
 
	mmöHdrVî
;

100 
u16
 
	mmaxHdrVî
;

101 }
	tŸa_hdrFõlds_t
;

104 
u32
 
	mfûeVî
;

106 
u32
 
	mtŸÆImageSize
;

107 
u16
 
	mimageTy≥
;

108 
u16
 
	mm™uÁ˘uªrCode
;

109 }
	tŸa_¥ómbÀ_t
;

114 
	mOTA_FLAG_INIT_DONE
,

115 
	mOTA_FLAG_IMAGE_PULL_READY
,

116 
	mOTA_FLAG_IMAGE_PULL_CONTINUE
,

118 
	mOTA_FLAG_IMAGE_MAGIC_0
,

119 
	mOTA_FLAG_IMAGE_MAGIC_1
,

120 
	mOTA_FLAG_IMAGE_MAGIC_2
,

121 
	mOTA_FLAG_IMAGE_MAGIC_3
,

122 
	mOTA_FLAG_IMAGE_HDR_VER1
,

123 
	mOTA_FLAG_IMAGE_HDR_VER2
,

124 
	mOTA_FLAG_IMAGE_HDR_LEN1
,

125 
	mOTA_FLAG_IMAGE_HDR_LEN2
,

126 
	mOTA_FLAG_IMAGE_HDR_FC1
,

127 
	mOTA_FLAG_IMAGE_HDR_FC2
,

128 
	mOTA_FLAG_IMAGE_MANU_CODE1
,

129 
	mOTA_FLAG_IMAGE_MANU_CODE2
,

130 
	mOTA_FLAG_IMAGE_TYPE1
,

131 
	mOTA_FLAG_IMAGE_TYPE2
,

132 
	mOTA_FLAG_IMAGE_FILE_VER1
,

133 
	mOTA_FLAG_IMAGE_FILE_VER2
,

134 
	mOTA_FLAG_IMAGE_FILE_VER3
,

135 
	mOTA_FLAG_IMAGE_FILE_VER4
,

136 
	mOTA_FLAG_IMAGE_STACK_VER1
,

137 
	mOTA_FLAG_IMAGE_STACK_VER2
,

138 
	mOTA_FLAG_IMAGE_CONT_HDR
,

139 
	mOTA_FLAG_IMAGE_ELEM_TAG1
,

140 
	mOTA_FLAG_IMAGE_ELEM_TAG2
,

141 
	mOTA_FLAG_IMAGE_ELEM_LEN1
,

142 
	mOTA_FLAG_IMAGE_ELEM_LEN2
,

143 
	mOTA_FLAG_IMAGE_ELEM_LEN3
,

144 
	mOTA_FLAG_IMAGE_ELEM_LEN4
,

145 
	mOTA_FLAG_IMAGE_ELEM_INFO1
,

146 
	mOTA_FLAG_IMAGE_ELEM_INFO2
,

147 
	mOTA_FLAG_IMAGE_ELEMENT
,

148 }
	tŸaFlg_t
;

151 
af_sim∂e_des¸ùt‹_t
 *
	msim∂eDesc
;

152 
Ÿa_¥ómbÀ_t
 *
	mpOèPªambÀ
;

153 
u32
 
	mdow∆ﬂdImageSize
;

154 
ïInfo_t
 
	mŸaSîvîEpInfo
;

155 
u8
 
	mimageBlockRëry
;

156 
u8
 
	mupgødeEndRëry
;

157 
boﬁ
 
	misOèSîvî
;

158 }
	tŸa_˘x_t
;

161 
u32
 
	moff£t
;

162 
u32
 
	m¸cVÆue
;

163 
u32
 
	mŸaEÀmítPos
;

164 
u32
 
	mŸaEÀmítLí
;

165 
u16
 
	mŸaEÀmítTag
;

166 
u8
 
	mŸaEÀmítInfo1
;

167 
u8
 
	mŸaEÀmítInfo2
;

168 
u8
 
	m˛õ¡OèFlg
;

169 }
	tŸa_˛õ¡Info_t
;

172 
	mOTA_EVT_START
,

173 
	mOTA_EVT_IMAGE_DONE
,

174 
	mOTA_EVT_COMPLETE
,

175 }
	tŸa_evt_t
;

177 (*
	tŸa_¥o˚ssMsg_t
)–
	tu8
 
	tevt
, u8 
	t°©us
 );

180 
Ÿa_¥o˚ssMsg_t
 
¥o˚ssMsgCbFunc
;

181 }
	tŸa_ˇŒBack_t
;

185 
addrExt_t
 
z˛_©å_upgødeSîvîID
;

186 
u32
 
z˛_©å_fûeOff£t
;

187 
u32
 
z˛_©å_cuºFûeVî
;

188 
u16
 
z˛_©å_cuºZigbìSèckVî
;

189 
u32
 
z˛_©å_dow∆ﬂdFûeVî
;

190 
u16
 
z˛_©å_dow∆ﬂdZigbìSèckVî
;

191 
u8
 
z˛_©å_imageUpgødeSètus
;

192 
u16
 
z˛_©å_m™uÁ˘uªrID
;

193 
u16
 
z˛_©å_imageTy≥ID
;

194 
u16
 
z˛_©å_möBlockPîiod
;

197 c⁄° 
z˛_•ecClu°îInfo_t
 
g_ŸaClu°îLi°
[];

198 
u8
 
OTA_CB_CLUSTER_NUM
;

201 
°©us_t
 
	`z˛_ŸaCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

203 
	`x¸c32
(c⁄° *
buf
, 
Àn
, 
öô
);

205 
	`Ÿa_wwah_u£Tru°Cíãr
(
u8
 
ídpoöt
);

207 
	`Ÿa_öô
(
Ÿa_ty≥_e
 
ty≥
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂eDesc
, 
Ÿa_¥ómbÀ_t
 *
ŸaPªambÀ
, 
Ÿa_ˇŒBack_t
 *
cb
);

208 
	`Ÿa_quîySèπ
(
u16
 
£c⁄ds
);

209 
	`Ÿa_£rvîAddrPî¥ogømmed
(
addrExt_t
 
õìAddr
, 
u8
 
§vEndPoöt
);

210 
	`Ÿa_mcuReboŸ
();

211 
	`Ÿa_upgødeAb‹t
();

212 
u8
 
	`mcuBoŸAddrGë
();

	@zigbee/ota/otaCRC.c

24 
	~"../z˛/z˛_ö˛ude.h
"

26 #ifde‡
ZCL_OTA


29 c⁄° 
	g¸c32_èbÀ
[] =

120 
	$x¸c32
 (c⁄° *
buf
, 
Àn
, 
öô
)

122 
¸c
 = 
öô
;

123 
Àn
--)

125 
¸c
 = (¸¯<< 8Ë^ 
¸c32_èbÀ
[((¸¯>> 24Ë^ *
buf
) & 255];

126 
buf
++;

128  
¸c
;

129 
	}
}

131 c⁄° 
	g¸c32_èbÀ
[] = {

186 
	$x¸c32
 (c⁄° *
buf
, 
Àn
, 
öô
)

188 
¸c
 = 
öô
;

189 
Àn
--)

191 
¸c
 = (¸¯>> 8Ë^ 
¸c32_èbÀ
[(¸¯^ *
buf
) & 0xff];

192 
buf
++;

194  
¸c
;

195 
	}
}

	@zigbee/ota/otaEpCfg.c

27 
	~"../z˛/z˛_ö˛ude.h
"

28 
	~"Ÿa.h
"

30 #ifde‡
ZCL_OTA


47 
addrExt_t
 
	gz˛_©å_upgødeSîvîID
 = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

48 
u32
 
	gz˛_©å_fûeOff£t
 = 0xffffffff;

49 
u32
 
	gz˛_©å_cuºFûeVî
 = 0xffffffff;

50 
u16
 
	gz˛_©å_cuºZigbìSèckVî
 = 0xffff;

51 
u32
 
	gz˛_©å_dow∆ﬂdFûeVî
 = 0xffffffff;

52 
u16
 
	gz˛_©å_dow∆ﬂdZigbìSèckVî
 = 0xffff;

53 
u8
 
	gz˛_©å_imageUpgødeSètus
 = 0;

54 
u16
 
	gz˛_©å_m™uÁ˘uªrID
 = 0;

55 
u16
 
	gz˛_©å_imageTy≥ID
 = 0xffff;

56 
u16
 
	gz˛_©å_möBlockPîiod
 = 0;

60 c⁄° 
z˛AârInfo_t
 
	gŸa_©åTbl
[] =

62 { 
ZCL_ATTRID_OTA_UPGRADE_SERVER_ID
, 
ZCL_DATA_TYPE_IEEE_ADDR
,
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_upgødeSîvîID
 },

63 { 
ZCL_ATTRID_OTA_FILE_OFFSET
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_fûeOff£t
 },

64 { 
ZCL_ATTRID_OTA_CURRENT_FILE_VER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºFûeVî
 },

65 { 
ZCL_ATTRID_OTA_CURRENT_ZIGBEE_STACK_VER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºZigbìSèckVî
 },

66 { 
ZCL_ATTRID_OTA_DOWNLOAD_FILE_VER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dow∆ﬂdFûeVî
 },

67 { 
ZCL_ATTRID_OTA_DOWNLOAD_ZIGBEE_STACK_VER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dow∆ﬂdZigbìSèckVî
 },

68 { 
ZCL_ATTRID_OTA_IMAGE_UPGRADE_STAUS
, 
ZCL_DATA_TYPE_ENUM8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_imageUpgødeSètus
 },

69 { 
ZCL_ATTRID_OTA_MANUFACTURER_ID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_m™uÁ˘uªrID
 },

70 { 
ZCL_ATTRID_OTA_IMAGE_TYPE_ID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_imageTy≥ID
 },

71 { 
ZCL_ATTRID_OTA_MINIMUM_BLOCK_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_möBlockPîiod
 },

73 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

76 
	#ZCL_OTA_ATTR_NUM
 (
Ÿa_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

82 c⁄° 
z˛_•ecClu°îInfo_t
 
	gg_ŸaClu°îLi°
[] =

84 {
ZCL_CLUSTER_OTA
, 
MANUFACTURER_CODE_NONE
, 
ZCL_OTA_ATTR_NUM
, 
Ÿa_©åTbl
, 
z˛_Ÿa_ªgi°î
, 
z˛_ŸaCb
},

87 
u8
 
	gOTA_CB_CLUSTER_NUM
 = ((
g_ŸaClu°îLi°
)/(g_otaClusterList[0]));

	@zigbee/ss/security_service.h

24 #i‚de‡
SECURITY_SERVICE_H


25 
	#SECURITY_SERVICE_H


	)

28 #ifde‡
ZB_SECURITY


29 
	#SECURITY_MODE_STANDARD
 1

	)

30 
	#SECURITY_MODE_HIGH
 (!
SECURITY_MODE_STANDARD
)

	)

31 
	#SS_UPDATE_FRAMECOUNT_THRES
 1024

	)

35 
	mSS_KEYREQ_TYPE_APPLK
 = 0x02,

36 
	mSS_KEYREQ_TYPE_TCLK
 = 0x04

37 }
	tss_keyReqTy≥_e
;

40 
	mSS_SECUR_NO_ENCR
,

41 
	mSS_SECUR_NWK_ENCR
,

42 
	mSS_SECUR_APS_ENCR
,

43 
	mSS_SECUR_MAC_ENCR


50 
	mSS_SECUR_DATA_KEY
,

51 
	mSS_SECUR_NWK_KEY
,

52 
	mSS_SECUR_KEY_TRANSPORT_KEY
,

53 
	mSS_SECUR_KEY_LOAD_KEY


58 
	mSS_TC_MASTER_KEY
 = 0x00,

59 
	mSS_STANDARD_NETWORK_KEY
 = 0x01,

60 
	mSS_APP_MASTER_KEY
 = 0x02,

61 
	mSS_APP_LINK_KEY
 = 0x03,

62 
	mSS_TC_LINK_KEY
 = 0x04,

63 
	mSS_HIGH_SECUR_NETWORK_KEY
,

64 }
	tss_£KeyTy≥_e
;

67 
	mSS_UNIQUE_LINK_KEY
 = 0x00,

68 
	mSS_GLOBAL_LINK_KEY
 = 0x01

69 }
	tss_lökKeyty≥_e
;

72 
	mSS_SEMODE_CENTRALIZED
,

73 
	mSS_SEMODE_DISTRIBUTED


74 }
	tss_£curôyMode_e
;

77 
	mSS_PROVISIONAL_KEY
,

78 
	mSS_UNVERIFIED_KEY
,

79 
	mSS_VERIFIED_KEY


80 }
	tss_keyAâribuãs_e
;

83 
u8
 
	mkey
[
CCM_KEY_SIZE
];

84 
u8
 
	mkeySeqNum
;

85 
u8
 
	mkeyTy≥
;

86 }
	tss_m©îül_£t_t
;

89 
	mSS_PRECONFIGURED_NOKEY
 = 0,

90 
	mSS_PRECONFIGURED_GLOBALLINKKEY
 = 
BIT
(0),

91 
	mSS_PRECONFIGURED_UNIQUELLINKKEY
 = 
BIT
(1),

92 
	mSS_PRECONFIGURED_NWKKEY
 = 
BIT
(2),

93 }
	tss_¥ec⁄figuªdKey_e
;

97 
boﬁ
 
	mu£WhôeLi°
;

100 
u8
 
	mÆlowIn°ÆlCode
;

103 
boﬁ
 
	mupd©eTCLKªquúed
;

104 #i‡
ZB_COORDINATOR_ROLE


107 
boﬁ
 
	mÆlowJoös
;

110 
boﬁ
 
	mÆlowRejoös
;

113 
u8
 
	mÆlowTCLKªque°
;

115 
u8
 
	mÆlowAµLKªque°
;

117 }
	tss_tcPﬁicy_t
;

120 
	mKEYTYPE_PRO_MASK
 = 
BIT
(0),

121 
	mKEYTYPE_UNVERIFY_MASK
 = 
BIT
(1),

122 
	mKEYTYPE_VERIFIED_MASK
 = 
BIT
(2)

123 }
	tnvKeyçeMask_e
;

126 
	mSS_DEVKEYPAIR_SYNID_KEYATTR
,

127 
	mSS_DEVKEYPAIR_SYNID_INCOMMINGFRAMECNT
,

128 
	mSS_DEVKEYPAIR_SYNID_ALL


129 }
	tss_devKeyPaúSyn_id
;

132 
addrExt_t
 
	mdevi˚_addªss
;

134 
u8
 
	mlökKey
[
CCM_KEY_SIZE
];

136 
ss_keyAâribuãs_e
 
	mkeyAâr
;

137 
ss_lökKeyty≥_e
 
	m≠sLökKeyTy≥
;

138 
u8
 
	mu£d
;

139 
u8
 
	mrsv
;

141 
u32
 
	moutgoögFømeCou¡î
;

142 
u32
 
	möcomögFømeCou¡î
;

143 }
	tss_dev_∑ú_£t_t
;

146 
u32
 
	mssTimeoutPîiod
;

147 
u32
 
	moutgoögFømeCou¡î
;

148 
u32
 
	m¥evOutgoögFømeCou¡î
;

149 
u8
 *
	mkeyPaúSëNew
;

150 
ss_m©îül_£t_t
 
	mnwkSecurM©îülSë
[
SECUR_N_SECUR_MATERIAL
];

151 
u16
 
	mdevKeyPaúNum
;

152 
addrExt_t
 
	måu°_˚¡î_addªss
;

153 
u8
 
	m£curôyLevñ
:3;

154 
u8
 
	m£cuªAŒFªsh
:1;

155 
u8
 
	ma˘iveSecuªM©îülIndex
:2;

156 
u8
 
	mª£rved
:2;

157 
u8
 
	ma˘iveKeySeqNum
;

158 
ss_¥ec⁄figuªdKey_e
 
	m¥eC⁄figuªdKeyTy≥
;

159 
ss_tcPﬁicy_t
 
	mtcPﬁicy
;

160 
u8
 *
	mtouchLökKey
;

161 
u8
 *
	mdi°ibuãLökKey
;

162 
u8
 
	mtcLökKeyTy≥
;

163 
u8
 *
	mtcLökKey
;

164 }
	tss_öfo_ba£_t
;

171 
addrExt_t
 
	md°Addr
;

172 
u8
 
	mkeyTy≥
;

173 
u8
 
	mkey
[
CCM_KEY_SIZE
];

174 
u8
 
	mªœyByP¨ít
;

175 
u8
 
	mkeySeqNum
;

176 
addrExt_t
 
	m∑π√rAddr
;

177 
u8
 
	möô©‹Fœg
;

178 
u8
 
	mnwkSecurôy
;

179 }
	tss_≠smeTøn•‹tKeyReq_t
;

183 
addrExt_t
 
	m§cAddr
;

184 
u8
 
	mkeyTy≥
;

185 
u8
 
	mkey
[
CCM_KEY_SIZE
];

187 
u8
 
	mkeySeqNum
;

188 
addrExt_t
 
	m∑π√rAddr
;

190 }
	tss_≠smeTøn•‹tKeyInd_t
;

196 
addrExt_t
 
	md°Addr
;

199 
addrExt_t
 
	mdevAddr
;

200 
u16
 
	mdevSh‹tAddr
;

201 
u8
 
	m°©us
;

202 }
	tss_≠smeUpd©eDevi˚Req_t
;

205 
	mSS_STANDARD_DEV_SECURED_REJOIN
 = 0,

206 
	mSS_STANDARD_DEV_UNSECURED_JOIN
 = 1,

207 
	mSS_DEV_LEFT
 = 2,

208 
	mSS_STANDARD_DEV_TC_REJOIN
 = 3

209 }
	tss_≠smeUpd©eDevSètus_e
;

216 
addrExt_t
 
	m§cAddr
;

219 
addrExt_t
 
	mdevAddr
;

220 
u16
 
	mdevSh‹tAddr
;

221 
ss_≠smeUpd©eDevSètus_e
 
	m°©us
;

222 }
	tss_≠smeUpd©eDevi˚Ind_t
;

230 
addrExt_t
 
	m∑ª¡Addr
;

236 
addrExt_t
 
	mèrgëExtAddr
;

237 }
	tss_≠smeRemoveDevi˚Req_t
;

243 
addrExt_t
 
	mtcAddr
;

246 
addrExt_t
 
	mchûdExtAddr
;

247 }
	tss_≠smeRemoveDevi˚Ind_t
;

252 
é_zb_addr_t
 
	md°Addr
;

257 
addrExt_t
 
	m∑π√rAddr
;

259 
u8
 
	md°AddrMode
;

261 
ss_keyReqTy≥_e
 
	mkeyTy≥
;

262 }
	tss_≠smeReque°KeyReq_t
;

267 
é_zb_addr_t
 
	m§cAddr
;

272 
addrExt_t
 
	m∑π√rAddr
;

274 
u8
 
	md°AddrMode
;

276 
ss_keyReqTy≥_e
 
	mkeyTy≥
;

277 }
	tss_≠smeReque°KeyInd_t
;

284 
addrExt_t
 
	md°Addr
;

288 
u8
 
	mkeySeqNum
;

289 }
	tss_≠smeSwôchKeyReq_t
;

293 
addrExt_t
 
	m§cAddr
;

294 
u8
 
	mkeySeqNum
;

295 }
	tss_≠smeSwôchKeyInd_t
;

299 
addrExt_t
 
	md°Addr
;

300 
u8
 
	mkeyTy≥
;

301 }
	tss_≠smeVîifyKeyReq_t
;

305 
addrExt_t
 
	m§cAddr
;

306 
u8
 
	mhashVÆ
[16];

307 
u8
 
	mkeyTy≥
;

308 }
	tss_≠smeVîifyKeyInd_t
;

312 
addrExt_t
 
	md°Addr
;

313 
u8
 
	mkeyTy≥
;

314 
u8
 
	m°©us
;

315 }
	tss_≠smeC⁄fúmKeyReq_t
;

319 
addrExt_t
 
	m§cAddr
;

320 
u8
 
	mkeyTy≥
;

321 
u8
 
	m°©us
;

322 }
	tss_≠smeC⁄fúmKeyInd_t
;

325 
addrExt_t
 
	md°Addr
;

326 
u8
 
	mkey
[
CCM_KEY_SIZE
];

327 }
	tss_tcUpd©eNwkKey_t
;

330 
ss_dev_∑ú_£t_t
 
	mkeyPaú
;

331 
u32
 
	mtimeout
;

332 }
	tss_tc_keyPaú_t
;

335 
ss_dev_∑ú_£t_t
 
	mkeyPaú
;

336 
ev_timî_evít_t
 *
	mpTimeoutEvt
;

337 }
	tss_dev_keyPaú_t
;

339 
ss_öfo_ba£_t
 
ss_ib
;

341 
	#SS_IB
(Ë
ss_ib


	)

343 #i‡
ZB_COORDINATOR_ROLE


344 
	#SS_TC_KEY_PAIR_CACHE_NUM
 10

	)

345 
ss_tc_keyPaú_t
 
g_ssTcKeyPaú
[];

347 
ss_dev_keyPaú_t
 
g_ssDevKeyPaú
;

350 
ss_mmoHash
(
u8
 *
d©a
, u8 
Àn
, u8 *
ªsu…
);

351 
u8
 
´s_ccmAuthTøn
(u8 
M
, u8 *
key
, u8 *
iv
, u8 *
mSå
, 
u16
 
mSåLí
, u8 *
aSå
, u8 
aSåLí
, u8 *
ªsu…
);

352 
u8
 
´s_ccmEncTøn
(u8 
M
, u8 *
key
, u8 *
iv
, u8 *
mSå
, 
u16
 
mSåLí
, u8 *
aSå
, u8 
aSåLí
, u8 *
ªsu…
);

353 
u8
 
´s_ccmDecTøn
(u8 
micLí
, u8 *
key
, u8 *
iv
, u8 *
mSå
, 
u16
 
mSåLí
, u8 *
aSå
, u8 
aSåLí
, u8 *
mic
);

354 
u8
 
´s_ccmDecAuthTøn
(u8 
micLí
, u8 *
key
, u8 *
iv
, u8 *
mSå
, 
u16
 
mSåLí
, u8 *
aSå
, u8 
aSåLí
, u8 *
mic
);

357 
u16
 
ss_devKeyPaúInfoGë
();

358 
u8
 
ss_devKeyPaúFöd
(
addrExt_t
 
extAddr
, 
ss_dev_∑ú_£t_t
 *
keyPaú
);

359 
u8
 
ss_devKeyPaúDñëe
(
addrExt_t
 
extAddr
);

360 
ss_devKeyPaúSave
(
ss_dev_∑ú_£t_t
 *
keyPaú
);

363 
u32
 
ss_outgoögFømeC¡Gë
();

377 
u16
 
ss_nodeMacAddrFromdevKeyPaú
(u16 
°¨t_idx
, 
u8
 
num
, u8 *
vÆidNum
, 
addrExt_t
 *
nodeMacAddrLi°
);

383 
zdo_ssInfoSaveToFœsh
();

389 
u8
 
zdo_ssInfoInô
();

395 
zdo_ssInfoUpd©e
();

401 
u8
 
zdo_ssInfoKeyGë
();

405 
ss_nwkKeyGíî©e
(
u8
 *
nwkKey
);

408 
ss_nwkKeySt‹e
(
u8
 *
nwkKey
);

416 
ss_zdoInô
(
boﬁ
 
íSecurôy
);

424 
ss_£curôyModeSë
(
ss_£curôyMode_e
 
m
);

430 
boﬁ
 
ss_£curôyModeIsDi°ribuãd
();

432 
boﬁ
 
ss_keyPªc⁄figuªd
();

	@zigbee/ss/ss_nv.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

27 #ifde‡
ZB_SECURITY


29 
_CODE_SS_
 
	$zdo_ssInfoSaveToFœsh
(){

30 #i‡
NV_ENABLE


36 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_APS
, 
NV_ITEM_APS_SSIB
, (
ss_ib
), (
u8
*)&ss_ib);

38 
	}
}

40 
_CODE_SS_
 
u8
 
	$zdo_ssInfoInô
(){

41 
u8
 
ªt
 = 
NV_ITEM_NOT_FOUND
;

42 #i‡
NV_ENABLE


43 
ªt
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_APS
, 
NV_ITEM_APS_SSIB
, (
ss_ib
), (
u8
*)&ss_ib);

51  
ªt
;

52 
	}
}

54 
_CODE_SS_
 
u8
 
	$zdo_ssInfoKeyGë
(){

55 
u8
 
ªt
 = 
NV_ITEM_NOT_FOUND
;

56 #i‡
NV_ENABLE


57 
ss_öfo_ba£_t
 
ss
;

58 
ªt
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_APS
, 
NV_ITEM_APS_SSIB
, (
ss_ib
), (
u8
*)&
ss
);

59 if(
ªt
 =
NV_SUCC
){

60 
ªt
 = 
ss
.
a˘iveSecuªM©îülIndex
;

63  
ªt
;

64 
	}
}

	@zigbee/wwah/wwah.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

25 
	~"../z˛/z˛_ö˛ude.h
"

26 
	~"wwah.h
"

27 #ifde‡
ZCL_OTA


28 
	~"Ÿa.h
"

31 #ifde‡
ZCL_WWAH


37 
ev_timî_evít_t
 *
	m≥riodicRouãrCheckInEvt
;

38 
ïInfo_t
 
	md°EpInfo
;

39 
u16
 
	mm™ufCode
;

40 
u8
 
	m§cEp
;

41 }
	twwah_≥rRouãrCheckInInfo_t
;

51 
wwah_≥rRouãrCheckInInfo_t
 
	gg_z˛_≥rRouãrCheckInInfo
;

57 
	$wwah_öô
(
wwah_ty≥_e
 
ty≥
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂eDesc
)

59 if(
ty≥
 =
WWAH_TYPE_CLIENT
){

64 
	`z˛_ªgi°î
(
sim∂eDesc
->
ídpoöt
, 
WWAH_CB_CLUSTER_NUM
, (
z˛_•ecClu°îInfo_t
 *)
g_wwahClu°îLi°
);

65 
	}
}

67 
	$z˛_wwah_ªqNewApsLökKey
(*
¨g
)

69 
ss_≠smeReque°KeyReq_t
 
ªque°Key
;

70 
	`TL_SETSTRUCTCONTENT
(
ªque°Key
, 0);

72 
ªque°Key
.
keyTy≥
 = 
SS_KEYREQ_TYPE_TCLK
;

73 
ªque°Key
.
d°Addr
.
sh‹tAddr
 = 0x0000;

74 
ªque°Key
.
d°AddrMode
 = 
ZB_ADDR_16BIT_DEV_OR_BROADCAST
;

76 
	`zb_≠smeReque°KeyReq
(&
ªque°Key
);

77 
	}
}

79 
	$z˛_wwah_ªjoö
(*
¨g
)

81 
	`zb_ªjoöReq
(
NLME_REJOIN_METHOD_REJOIN
, 
	`zb_≠sCh™√lMaskGë
());

82 
	}
}

84 
s32
 
	$≥riodicRouãrCheckInCb
(*
¨g
)

86 if(!
	`z˛_wwah_gëRouãrCheckedFœg
()){

87 
	`TL_SCHEDULE_TASK
(
z˛_wwah_ªjoö
, 
NULL
);

89 
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
 = 
NULL
;

93 
z˛RódCmd_t
 *
pRódCmd
 = (z˛RódCmd_à*)
	`ev_buf_Æloˇã
((z˛RódCmd_tË+ (
u16
));

94 if(
pRódCmd
){

95 
pRódCmd
->
numAâr
 = 1;

96 
pRódCmd
->
©åID
[0] = 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
;

98 
	`z˛_£ndRódWôhMfgCodeCmd
–
g_z˛_≥rRouãrCheckInInfo
.
§cEp
, &g_z˛_≥rRouãrCheckInInfo.
d°EpInfo
,

99 
ZCL_CLUSTER_GEN_BASIC
, 
MANUFACTURER_CODE_AMAZON
,

100 
FALSE
, 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
pRódCmd
 );

102 
	`ev_buf_‰ì
((
u8
 *)
pRódCmd
);

104 
	`z˛_wwah_˛órRouãrCheckedFœg
();

108 
	}
}

110 
°©us_t
 
	$wwah_ªque°NewApsLökKeyH™dÀr
()

112 
	`TL_SCHEDULE_TASK
(
z˛_wwah_ªqNewApsLökKey
, 
NULL
);

114  
ZCL_STA_SUCCESS
;

115 
	}
}

117 
°©us_t
 
	$wwah_≥riodicRouãrCheckInsH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, 
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
 *
pCheckInCmd
)

119 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

121 if(
cmdId
 =
ZCL_CMD_WWAH_ENABLE_PERIODIC_ROUTER_CHECK_INS
){

122 if(
pCheckInCmd
->
checkInI¡îvÆ
){

123 
g_z˛_wwahAârs
.
rouãrCheckInE«bÀd
 = 
TRUE
;

125 if(
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
){

126 
	`TL_ZB_TIMER_CANCEL
(&
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
);

128 if(
pCheckInCmd
->
checkInI¡îvÆ
){

129 
g_z˛_≥rRouãrCheckInInfo
.
§cEp
 = 
pAddrInfo
->
d°Ep
;

130 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
d°Ep
 = 
pAddrInfo
->
§cEp
;

131 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
¥ofûeId
 = 
pAddrInfo
->profileId;

132 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

133 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
pAddrInfo
->
§cAddr
;

134 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

135 if(
pAddrInfo
->
≠sSec
){

136 
g_z˛_≥rRouãrCheckInInfo
.
d°EpInfo
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

139 
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
≥riodicRouãrCheckInCb
, 
NULL
, 
pCheckInCmd
->
checkInI¡îvÆ
 * 1000);

142 
°©us
 = 
ZCL_STA_FAILURE
;

145 
g_z˛_wwahAârs
.
rouãrCheckInE«bÀd
 = 
FALSE
;

147 if(
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
){

148 
	`TL_ZB_TIMER_CANCEL
(&
g_z˛_≥rRouãrCheckInInfo
.
≥riodicRouãrCheckInEvt
);

152 if(
°©us
 =
ZCL_STA_SUCCESS
){

156  
°©us
;

157 
	}
}

159 
°©us_t
 
	$wwah_£tPídögNwkUpd©eH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
z˛_wwah_£tPídögNwkUpd©eCmd_t
 *
pSëPídögNwkUpd©eCmd
)

161 
g_z˛_wwahAârs
.
≥ndögNwkUpd©eCh™√l
 = 
pSëPídögNwkUpd©eCmd
->
ch™√l
;

162 
g_z˛_wwahAârs
.
≥ndögNwkUpd©eP™ID
 = 
pSëPídögNwkUpd©eCmd
->
∑nID
;

164 
	`zdo_af_£t_ac˚±_nwk_upd©e_ch™√l
(
pSëPídögNwkUpd©eCmd
->
ch™√l
);

165 
	`zdo_af_£t_ac˚±_nwk_upd©e_∑n_id
(
pSëPídögNwkUpd©eCmd
->
∑nID
);

169  
ZCL_STA_SUCCESS
;

170 
	}
}

172 
°©us_t
 
	$wwah_cmdH™dÀr
(
u8
 
cmdId
)

174 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

176 
cmdId
){

177 
ZCL_CMD_WWAH_DISABLE_OTA_DOWNGRADES
:

178 
g_z˛_wwahAârs
.
dißbÀOTADowngødes
 = 
TRUE
;

180 
ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
:

181 
g_z˛_wwahAârs
.
mgmtLóveWôhoutRejoöE«bÀd
 = 
FALSE
;

182 
	`zdo_af_£t_mgmtLóve_u£_≠s_£c
(
TRUE
);

184 
ZCL_CMD_WWAH_DISABLE_TOUCHLINK_INTERPAN_MSG_SUPPORT
:

185 
g_z˛_wwahAârs
.
touchlökI¡î∑nE«bÀd
 = 
FALSE
;

187 
ZCL_CMD_WWAH_ENABLE_PARENT_CLASSIFICATION
:

188 
g_z˛_wwahAârs
.
∑ª¡Cœssifiˇti⁄E«bÀd
 = 
TRUE
;

190 
ZCL_CMD_WWAH_DISABLE_PARENT_CLASSIFICATION
:

191 
g_z˛_wwahAârs
.
∑ª¡Cœssifiˇti⁄E«bÀd
 = 
FALSE
;

193 
ZCL_CMD_WWAH_ENABLE_TC_SECURITY_ON_NWK_KEY_ROTATION
:

194 
g_z˛_wwahAârs
.
tcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
 = 
TRUE
;

195 
	`zdo_af_£t_u£_tc_£c_⁄_nwk_key_rŸ©i⁄
(
TRUE
);

197 
ZCL_CMD_WWAH_ENABLE_CONFIGURATION_MODE
:

198 
g_z˛_wwahAârs
.
c⁄figuøti⁄ModeE«bÀd
 = 
TRUE
;

199 
	`APS_IB
().
≠s_zdo_ª°ri˘ed_mode
 = 
FALSE
;

201 
ZCL_CMD_WWAH_DISABLE_CONFIGURATION_MODE
:

202 
g_z˛_wwahAârs
.
c⁄figuøti⁄ModeE«bÀd
 = 
FALSE
;

203 
	`APS_IB
().
≠s_zdo_ª°ri˘ed_mode
 = 
TRUE
;

206 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

210 if(
°©us
 =
ZCL_STA_SUCCESS
){

214  
°©us
;

215 
	}
}

218 
°©us_t
 
	$wwah_u£Tru°CíãrF‹Clu°îH™dÀr
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
wwah_u£TCF‹Clu°îInfo_t
 *
pU£TCF‹Clu°î
)

220 #ifde‡
ZCL_OTA


221 
u8
 
i
 = 0; i < 
pU£TCF‹Clu°î
->
num
; i++){

222 if(
pU£TCF‹Clu°î
->
˛u°îID
[
i
] =
ZCL_CLUSTER_OTA
){

223 
	`Ÿa_wwah_u£Tru°Cíãr
(
pAddrInfo
->
§cEp
);

228  
ZCL_STA_SUCCESS
;

229 
	}
}

231 
°©us_t
 
	$z˛_wwahCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
)

233 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

235 if(
pAddrInfo
->
dúClu°î
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

236 
cmdId
){

237 
ZCL_CMD_WWAH_REQUEST_NEW_APS_LINK_KEY
:

238 
°©us
 = 
	`wwah_ªque°NewApsLökKeyH™dÀr
();

240 
ZCL_CMD_WWAH_ENABLE_PERIODIC_ROUTER_CHECK_INS
:

241 
ZCL_CMD_WWAH_DISABLE_PERIODIC_ROUTER_CHECK_INS
:

242 
°©us
 = 
	`wwah_≥riodicRouãrCheckInsH™dÀr
(
pAddrInfo
, 
cmdId
, (
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
 *)
cmdPaylﬂd
);

244 
ZCL_CMD_WWAH_SET_PENDING_NWK_UPDATE
:

245 
°©us
 = 
	`wwah_£tPídögNwkUpd©eH™dÀr
(
pAddrInfo
, (
z˛_wwah_£tPídögNwkUpd©eCmd_t
 *)
cmdPaylﬂd
);

247 
ZCL_CMD_WWAH_DISABLE_OTA_DOWNGRADES
:

248 
ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
:

249 
ZCL_CMD_WWAH_DISABLE_TOUCHLINK_INTERPAN_MSG_SUPPORT
:

250 
ZCL_CMD_WWAH_ENABLE_PARENT_CLASSIFICATION
:

251 
ZCL_CMD_WWAH_DISABLE_PARENT_CLASSIFICATION
:

252 
ZCL_CMD_WWAH_ENABLE_TC_SECURITY_ON_NWK_KEY_ROTATION
:

253 
ZCL_CMD_WWAH_ENABLE_CONFIGURATION_MODE
:

254 
ZCL_CMD_WWAH_DISABLE_CONFIGURATION_MODE
:

255 
°©us
 = 
	`wwah_cmdH™dÀr
(
cmdId
);

257 
ZCL_CMD_WWAH_USE_TRUST_CENTER_FOR_CLUSTER
:

258 
°©us
 = 
	`wwah_u£Tru°CíãrF‹Clu°îH™dÀr
(
pAddrInfo
, (
wwah_u£TCF‹Clu°îInfo_t
 *)
cmdPaylﬂd
);

261 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

265 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

268  
°©us
;

269 
	}
}

	@zigbee/wwah/wwah.h

24 #i‚de‡
WWAH_H


25 
	#WWAH_H


	)

29 
	mWWAH_TYPE_CLIENT
,

30 
	mWWAH_TYPE_SERVER


31 }
	twwah_ty≥_e
;

37 
boﬁ
 
	mdißbÀOTADowngødes
;

38 
boﬁ
 
	mmgmtLóveWôhoutRejoöE«bÀd
;

39 
u8
 
	mnwkRëryCou¡
;

40 
u8
 
	mmacRëryCou¡
;

41 
boﬁ
 
	mrouãrCheckInE«bÀd
;

42 
boﬁ
 
	mtouchlökI¡î∑nE«bÀd
;

43 
boﬁ
 
	m∑ª¡Cœssifiˇti⁄E«bÀd
;

44 
boﬁ
 
	mc⁄figuøti⁄ModeE«bÀd
;

45 
u8
 
	mcuºítDebugRï‹tID
;

46 
boﬁ
 
	mtcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
;

47 
u8
 
	m≥ndögNwkUpd©eCh™√l
;

48 
u16
 
	m≥ndögNwkUpd©eP™ID
;

49 
u16
 
	mŸaMaxOfÊöeDuøti⁄
;

50 }
	tz˛_wwahAâr_t
;

53 c⁄° 
z˛_•ecClu°îInfo_t
 
g_wwahClu°îLi°
[];

54 
u8
 
WWAH_CB_CLUSTER_NUM
;

55 
z˛_wwahAâr_t
 
g_z˛_wwahAârs
;

58 
wwah_öô
(
wwah_ty≥_e
 
ty≥
, 
af_sim∂e_des¸ùt‹_t
 *
sim∂eDesc
);

59 
°©us_t
 
z˛_wwahCb
(
z˛IncomögAddrInfo_t
 *
pAddrInfo
, 
u8
 
cmdId
, *
cmdPaylﬂd
);

	@zigbee/wwah/wwahEpCfg.c

27 
	~"../z˛/z˛_ö˛ude.h
"

28 
	~"wwah.h
"

30 #ifde‡
ZCL_WWAH


46 
z˛_wwahAâr_t
 
	gg_z˛_wwahAârs
 =

48 .
dißbÀOTADowngødes
 = 
FALSE
,

49 .
	gmgmtLóveWôhoutRejoöE«bÀd
 = 
TRUE
,

50 .
	gnwkRëryCou¡
 = 3,

51 .
	gmacRëryCou¡
 = 3,

52 .
	grouãrCheckInE«bÀd
 = 
FALSE
,

53 .
	gtouchlökI¡î∑nE«bÀd
 = 
TRUE
,

54 .
	g∑ª¡Cœssifiˇti⁄E«bÀd
 = 
FALSE
,

55 .
	gc⁄figuøti⁄ModeE«bÀd
 = 
TRUE
,

56 .
	gcuºítDebugRï‹tID
 = 0,

57 .
	gtcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
 = 
FALSE
,

58 .
	g≥ndögNwkUpd©eCh™√l
 = 0xFF,

59 .
	g≥ndögNwkUpd©eP™ID
 = 0xFFFF,

60 .
	gŸaMaxOfÊöeDuøti⁄
 = 0,

64 c⁄° 
z˛AârInfo_t
 
	gwwah_©åTbl
[] =

66 { 
ZCL_ATTRID_WWAH_DISABLE_OTA_DOWNGRADES
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
dißbÀOTADowngødes
 },

67 { 
ZCL_ATTRID_WWAH_MGMT_LEAVE_WITHOUT_REJOIN_ENABLED
,
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
mgmtLóveWôhoutRejoöE«bÀd
 },

68 { 
ZCL_ATTRID_WWAH_NWK_RETRY_COUNT
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
nwkRëryCou¡
 },

69 { 
ZCL_ATTRID_WWAH_MAC_RETRY_COUNT
, 
ZCL_DATA_TYPE_UINT8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
macRëryCou¡
 },

70 { 
ZCL_ATTRID_WWAH_ROUTER_CHECK_IN_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
rouãrCheckInE«bÀd
 },

71 { 
ZCL_ATTRID_WWAH_TOUCHLINK_INTERPAN_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
touchlökI¡î∑nE«bÀd
 },

72 { 
ZCL_ATTRID_WWAH_PARENT_CLASSIFICATION_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
∑ª¡Cœssifiˇti⁄E«bÀd
 },

73 { 
ZCL_ATTRID_WWAH_CONFIGURATION_MODE_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
c⁄figuøti⁄ModeE«bÀd
 },

74 { 
ZCL_ATTRID_WWAH_CURRENT_DEBUG_REPORT_ID
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
cuºítDebugRï‹tID
 },

75 { 
ZCL_ATTRID_WWAH_TC_SECURITY_ON_NWK_KEY_ROTATION_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
tcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
 },

76 { 
ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_CHANNEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
≥ndögNwkUpd©eCh™√l
 },

77 { 
ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_PANID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
≥ndögNwkUpd©eP™ID
 },

78 { 
ZCL_ATTRID_WWAH_OTA_MAX_OFFLINE_DURATION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛_wwahAârs
.
ŸaMaxOfÊöeDuøti⁄
 },

80 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
 },

83 
	#ZCL_WWAH_ATTR_NUM
 (
wwah_©åTbl
Ë/ (
z˛AârInfo_t
)

	)

89 c⁄° 
z˛_•ecClu°îInfo_t
 
	gg_wwahClu°îLi°
[] =

91 {
ZCL_CLUSTER_WWAH
, 
MANUFACTURER_CODE_AMAZON
, 
ZCL_WWAH_ATTR_NUM
, 
wwah_©åTbl
, 
z˛_wwah_ªgi°î
, 
z˛_wwahCb
},

94 
u8
 
	gWWAH_CB_CLUSTER_NUM
 = ((
g_wwahClu°îLi°
)/(g_wwahClusterList[0]));

	@zigbee/zbapi/zb_api.h

24 #i‚de‡
ZB_API_H


25 
	#ZB_API_H


	)

30 
	~"zb_comm⁄.h
"

36 
	s≠sdeD©aInd_s
{

37 
≠s_d©a_öd_t
 
	mödInfo
;

38 
u16
 
	masduLí
;

39 
u8
 
	masdu
[];

40 }
	t≠sdeD©aInd_t
;

43 
ölöe
 
	$zb_ª£tDevi˚
(){

44 
	`SYSTEM_RESET
();

45 
	}
}

58 
zb_Á˘‹yRe£t
();

74 
zb_ª£tDevi˚2FN
();

84 
boﬁ
 
zb_isDevi˚Fa˘‹yNew
();

94 
zb_devi˚Fa˘‹yNewSë
(
boﬁ
 
√w
);

104 
boﬁ
 
zb_isDevi˚JoöedNwk
();

114 
boﬁ
 
zb_gëMacAssocPîmô
();

124 
zb_∆deD©aDiscovîRouãSë
(
boﬁ
 
íabÀ
);

134 
boﬁ
 
zb_∆deD©aDiscovîRouãGë
();

144 
zb_≠sExtP™idSë
(
extPANId_t
 
∑nId
);

154 
≠s_°©us_t
 
zb_≠sCh™√lMaskSë
(
u32
 
mask
);

164 
u32
 
zb_≠sCh™√lMaskGë
();

177 
devi˚_ty≥_t
 
zb_gëDevi˚Ty≥
();

187 
zb_gëLoˇlExtAddr
(
addrExt_t
 
extAddr
);

197 
u16
 
zb_gëLoˇlSh‹tAddr
();

207 
u16
 
zb_gëP¨ítSh‹tAddr
();

218 
u8
 
zb_gëNwkAddrByExtAddr
(
addrExt_t
 
extAddr
, 
u16
 *
nwkAddr
);

229 
u8
 
zb_gëExtAddrByNwkAddr
(
u16
 
nwkAddr
, 
addrExt_t
 
extAddr
);

240 
zb_∆meSëLökStsPîiod
(
u8
 
≥riodInSec
);

250 
zb_ídDevi˚SyncReq
();

260 
zb_£tPﬁlR©e
(
u32
 
√wR©e
);

270 
u32
 
zb_gëPﬁlR©e
();

281 
u8
 
zb_nwkF‹m©i⁄
(
u32
 
sˇnCh™√ls
, u8 
sˇnDuøti⁄
);

292 
u8
 
zb_nwkDiscReq
(
∆me_nwkDisc_ªq_t
 *
pReq
, 
∆me_°©e_t
 
°©e
);

302 
zb_rouãrSèπ
();

312 
zb_ªjoö_mode_£t
(
u8
 
mode
);

323 
zdo_°©us_t
 
zb_ªjoöReq
(
ªjoöNwk_mëhod_t
 
mëhod
, 
u32
 
chm
);

333 
u8
 
zb_nwkDúe˘Joö
(
∆me_dúe˘Joö_ªq_t
 
ªq
);

343 
u8
 
zb_mlmeSˇnReque°
(
u32
 
sˇnCh™√ls
);

354 
u8
 
zb_nwkAssocüãJoöReque°
(u8 
ch™√l
, 
extPANId_t
 
extP™Id
);

364 
u8
 
zb_∆meLóveReq
(
∆me_Àave_ªq_t
 *
ªq
);

375 
zdo_°©us_t
 
zb_∆mePîmôJoöögReque°
(
u8
 
≥rmôDuøti⁄
);

388 
zdo_°©us_t
 
zb_zdoNwkAddrReq
(
u16
 
d°NwkAddr
, 
zdo_nwk_addr_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

401 
zdo_°©us_t
 
zb_zdoIìeAddrReq
(
u16
 
d°NwkAddr
, 
zdo_õì_addr_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

414 
zdo_°©us_t
 
zb_zdoSim∂eDescReq
(
u16
 
d°NwkAddr
, 
zdo_sim∂e_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

427 
zdo_°©us_t
 
zb_zdoNodeDescReq
(
u16
 
d°NwkAddr
, 
zdo_node_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

440 
zdo_°©us_t
 
zb_zdoPowîDescReq
(
u16
 
d°NwkAddr
, 
zdo_powî_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

453 
zdo_°©us_t
 
zb_zdoA˘iveEpReq
(
u16
 
d°NwkAddr
, 
zdo_a˘ive_ï_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

466 
zdo_°©us_t
 
zb_zdoM©chDescReq
(
u16
 
d°NwkAddr
, 
zdo_m©ch_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

479 
zdo_°©us_t
 
zb_zdoCom∂exDescReq
(
u16
 
d°NwkAddr
, 
zdo_com∂ex_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

492 
zdo_°©us_t
 
zb_zdoU£rDescReq
(
u16
 
d°NwkAddr
, 
zdo_u£r_des¸ùt‹_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

504 
zdo_°©us_t
 
zb_zdoSy°emSîvîDiscovîyReq
(
u16
 
£rvîMask
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

517 
zdo_°©us_t
 
zb_zdoBödUnbödReq
(
boﬁ
 
isBödög
, 
zdo_böd_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

529 
zdo_°©us_t
 
zb_zdoEndDevi˚BödReq
(
zdo_edBödReq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

543 
zdo_°©us_t
 
zb_mgmtPîmôJoöReq
(
u16
 
d°NwkAddr
, 
u8
 
≥rmôJoöDuøti⁄
, u8 
tcSignifiˇn˚
, u8 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

556 
zdo_°©us_t
 
zb_mgmtLóveReq
(
u16
 
d°NwkAddr
, 
zdo_mgmt_Àave_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

568 
zdo_°©us_t
 
zb_mgmtNwkUpd©eReq
(
u16
 
d°NwkAddr
, 
zdo_mgmt_nwk_upd©e_ªq_t
 *
pReq
, 
u8
 *
£qNo
);

581 
zdo_°©us_t
 
zb_mgmtLqiReq
(
u16
 
d°NwkAddr
, 
zdo_mgmt_lqi_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

594 
zdo_°©us_t
 
zb_mgmtBödReq
(
u16
 
d°NwkAddr
, 
zdo_mgmt_böd_ªq_t
 *
pReq
, 
u8
 *
£qNo
, 
zdo_ˇŒback
 
ödCb
);

604 
u8
 
zb_≠smeRemoveDevReq
(
ss_≠smeRemoveDevi˚Req_t
 *
pRemoveDevReq
);

614 
u8
 
zb_≠smeReque°KeyReq
(
ss_≠smeReque°KeyReq_t
 *
pReque°KeyReq
);

624 
u8
 
zb_≠smeTøn•‹tKeyReq
(
ss_≠smeTøn•‹tKeyReq_t
 *
pTøn•‹tKeyReq
);

634 
u8
 
zb_≠smeSwôchKeyReq
(
ss_≠smeSwôchKeyReq_t
 *
pSwôchKeyReq
);

645 
u8
 
zb_tcUpd©eNwkKey
(
ss_tcUpd©eNwkKey_t
 *
pTcUpd©eNwkKey
);

655 
≠s_°©us_t
 
zb_rouãReque°
(
∆me_rouãDisc_ªq_t
 *
pRouãDiscReq
);

666 
boﬁ
 
zb_bödögTblSórched
(
u16
 
˛u°îID
, 
u8
 
§cEp
);

676 
u8
 
zb_zdoSídDevA¬™˚
();

686 
zb_zdoSídP¨ítA¬˚
();

696 
zb_macCbRegi°î
(
mac_≠pIndCb_t
 *
cb
);

706 
zb_zdoCbRegi°î
(
zdo_≠pIndCb_t
 *
cb
);

720 
zb_joöAFixedNëw‹k
(
u8
 
ch™√l
, 
u16
 
∑nId
, u16 
sh‹tAddr
, u8 *
extP™Id
, u8 *
nwkKey
);

730 
zb_extP™IdRejoö
(
extPANId_t
 
extP™Id
);

743 
zb_¥eC⁄figNwkKey
(
u8
 *
nwkKey
, 
boﬁ
 
íTønsKey
);

753 
zdo_∆meCh™√lShi·
(
u8
 
ch
);

	@zigbee/zcl/closures/zcl_door_lock.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_DOOR_LOCK


49 
°©us_t
 
z˛_do‹Lock_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_CLOSURES_DOOR_LOCK
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_do‹Lock_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_do‹LockReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, u8 *
pCode
)

60 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

61 
u8
 
Àn
 = 
pCode
[0] + 1;

63 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

64 if(!
buf
){

65  
ZCL_STA_INSUFFICIENT_SPACE
;

68 
u8
 
i
 = 0; i < 
Àn
; i++){

69 
buf
[
i
] = 
pCode
[i];

72 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_CLOSURES_DOOR_LOCK
, 
cmdId
, 
TRUE
,

73 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

75 if(
buf
){

76 
	`ev_buf_‰ì
(
buf
);

78  
°©us
;

79 
	}
}

81 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_do‹LockR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
°©us_t
 
r•Sètus
)

83  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_CLOSURES_DOOR_LOCK
, 
cmdId
, 
TRUE
,

84 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, &
r•Sètus
);

85 
	}
}

88 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_do‹LockReqPrc
(
z˛Incomög_t
 *
pInMsg
)

90 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

91 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

93 if(
pInMsg
->
˛u°îAµCb
){

94 
z˛_do‹lockReq_t
 
ªqCmd
;

95 
ªqCmd
.
d©aLí
 = 
pInMsg
->dataLen;

96 
ªqCmd
.
pD©a
 = 
pInMsg
->pData;

98 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªqCmd
);

100 
ïInfo_t
 
d°Ep
;

101 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

103 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

104 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

105 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

106 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

108 
	`z˛_do‹Lock_do‹LockR•
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
,ÖInMsg->hdr.
cmd
, 
°©us
);

110 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

112 
°©us
 = 
ZCL_STA_FAILURE
;

115  
°©us
;

116 
	}
}

118 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_do‹LockR•Prc
(
z˛Incomög_t
 *
pInMsg
)

120 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

122 if(
pInMsg
->
˛u°îAµCb
){

123 
z˛_do‹lockR•_t
 
r•Cmd
;

124 
r•Cmd
.
°©us
 = 
pInMsg
->
pD©a
[0];

126 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
r•Cmd
);

128 
°©us
 = 
ZCL_STA_FAILURE
;

131  
°©us
;

132 
	}
}

134 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

136 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

138 
pInMsg
->
hdr
.
cmd
){

139 
ZCL_CMD_LOCK_DOOR
:

140 
ZCL_CMD_UNLOCK_DOOR
:

141 
ZCL_CMD_DOOR_LOCK_TOGGLE
:

142 
°©us
 = 
	`z˛_do‹Lock_do‹LockReqPrc
(
pInMsg
);

145 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

149  
°©us
;

150 
	}
}

152 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

154 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

156 
pInMsg
->
hdr
.
cmd
){

157 
ZCL_CMD_LOCK_DOOR_RESPONSE
:

158 
ZCL_CMD_UNLOCK_DOOR_RESPONSE
:

159 
ZCL_CMD_DOOR_LOCK_TOGGLE_RESPONSE
:

160 
°©us
 = 
	`z˛_do‹Lock_do‹LockR•Prc
(
pInMsg
);

163 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

167  
°©us
;

168 
	}
}

170 
_CODE_ZCL_
 
°©us_t
 
	$z˛_do‹Lock_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

172 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

173  
	`z˛_do‹Lock_˛õ¡CmdH™dÀr
(
pInMsg
);

175  
	`z˛_do‹Lock_£rvîCmdH™dÀr
(
pInMsg
);

177 
	}
}

	@zigbee/zcl/closures/zcl_door_lock.h

24 #i‚de‡
ZCL_DOOR_LOCK_H


25 
	#ZCL_DOOR_LOCK_H


	)

36 
	#ZCL_ATTRID_LOCK_STATE
 0x0000

	)

37 
	#ZCL_ATTRID_LOCK_TYPE
 0x0001

	)

38 
	#ZCL_ATTRID_ACTUATOR_ENABLED
 0x0002

	)

40 
	#ZCL_ATTRID_SEND_PIN_OTA
 0x0032

	)

41 
	#ZCL_ATTRID_REQUIRE_PIN_FOR_RF_OPERATION
 0x0033

	)

47 
	#ZCL_CMD_LOCK_DOOR
 0x00

	)

48 
	#ZCL_CMD_UNLOCK_DOOR
 0x01

	)

49 
	#ZCL_CMD_DOOR_LOCK_TOGGLE
 0x02

	)

51 
	#ZCL_CMD_LOCK_DOOR_RESPONSE
 0x00

	)

52 
	#ZCL_CMD_UNLOCK_DOOR_RESPONSE
 0x01

	)

53 
	#ZCL_CMD_DOOR_LOCK_TOGGLE_RESPONSE
 0x02

	)

59 
	#LOCK_STATE_NOT_FULLY_LOCKED
 0x00

	)

60 
	#LOCK_STATE_LOCKED
 0x01

	)

61 
	#LOCK_STATE_UNLOCKED
 0x02

	)

62 
	#LOCK_STATE_UNDEFINED
 0xFF

	)

67 
	#LOCK_TYPE_DEAD_BOLT
 0x00

	)

68 
	#LOCK_TYPE_MAGNETIC
 0x01

	)

69 
	#LOCK_TYPE_OTHER
 0x02

	)

70 
	#LOCK_TYPE_MORTISE
 0x03

	)

71 
	#LOCK_TYPE_RIM
 0x04

	)

72 
	#LOCK_TYPE_LATCH_BOLT
 0x05

	)

73 
	#LOCK_TYPE_CYLINDRICAL_LOCK
 0x06

	)

74 
	#LOCK_TYPE_TUBULAR_LOCK
 0x07

	)

75 
	#LOCK_TYPE_INTERCONNECTED_LOCK
 0x08

	)

76 
	#LOCK_TYPE_DEAD_LATCH
 0x09

	)

77 
	#LOCK_TYPE_DOOR_FURNITURE
 0x0A

	)

81 *
	mpD©a
;

82 
u8
 
	md©aLí
;

83 }
	tz˛_do‹lockReq_t
;

86 
u8
 
	m°©us
;

87 }
	tz˛_do‹lockR•_t
;

91 
	$°©us_t
 (*
	tz˛_do‹Lock_do‹LockReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tu8
 
	tcmdId
, u8 
	td©aLí
, u8 *
	tpD©a
);

92 (*
	tz˛_do‹Lock_do‹LockR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tu8
 
	tcmdId
, u8 
	tr•Sètus
);

98 
z˛_do‹Lock_do‹LockReqCb_t
 
do‹LockReqCbFunc
;

99 
z˛_do‹Lock_do‹LockR•Cb_t
 
do‹LockR•CbFunc
;

100 }
	tz˛_do‹Lock_AµCÆlbacks_t
;

103 
u8
 
z˛_©å_LockSèã
;

104 
u8
 
z˛_©å_LockTy≥
;

105 
u8
 
z˛_©å_A˘u©‹E«bÀd
;

106 
u8
 
z˛_©å_£ndPöOè
;

107 
u8
 
z˛_©å_ªquúePöF‹RfO≥øti⁄
;

108 }
	tz˛_©å_do‹Lock_t
;

111 c⁄° 
z˛AârInfo_t
 
do‹Lock_©åTbl
[];

112 c⁄° 
u8
 
z˛_do‹Lock_©åNum
;

114 
z˛_©å_do‹Lock_t
 
g_z˛Do‹LockAâr
;

116 
	#z˛_do‹LockAârGë
(Ë&
g_z˛Do‹LockAâr


	)

119 
°©us_t
 
	`z˛_do‹Lock_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

121 
°©us_t
 
	`z˛_do‹Lock_do‹LockReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, u8 *
pCode
);

122 
	#z˛_do‹Lock_lockDo‹CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_do‹Lock_do‹LockReq
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LOCK_DOOR
, (d)))

	)

123 
	#z˛_do‹Lock_u∆ockDo‹CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_do‹Lock_do‹LockReq
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_UNLOCK_DOOR
, (d)))

	)

124 
	#z˛_do‹Lock_toggÀDo‹CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_do‹Lock_do‹LockReq
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_DOOR_LOCK_TOGGLE
, (d)))

	)

126 
°©us_t
 
	`z˛_do‹Lock_do‹LockR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, sètus_à
r•Sètus
);

127 
	#z˛_do‹Lock_do‹LockR•CmdSíd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_do‹Lock_do‹LockR•
(◊), (b), (c), (d), (e), (f)))

	)

128 
	#z˛_do‹Lock_lockDo‹R•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_do‹Lock_do‹LockR•
(◊), (b), (c), (d), 
ZCL_CMD_LOCK_DOOR_RESPONSE
, (e)))

	)

129 
	#z˛_do‹Lock_u∆ockDo‹R•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_do‹Lock_do‹LockR•
(◊), (b), (c), (d), 
ZCL_CMD_UNLOCK_DOOR_RESPONSE
, (e)))

	)

130 
	#z˛_do‹Lock_toggÀDo‹R•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_do‹Lock_do‹LockR•
(◊), (b), (c), (d), 
ZCL_CMD_DOOR_LOCK_TOGGLE_RESPONSE
, (e)))

	)

	@zigbee/zcl/closures/zcl_door_lock_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_DOOR_LOCK


48 
z˛_©å_do‹Lock_t
 
	gg_z˛Do‹LockAâr
 = {

49 .
z˛_©å_LockSèã
 = 0,

50 .
	gz˛_©å_LockTy≥
 = 0,

51 .
	gz˛_©å_A˘u©‹E«bÀd
 = 0,

52 .
	gz˛_©å_£ndPöOè
 = 0,

53 .
	gz˛_©å_ªquúePöF‹RfO≥øti⁄
 = 0,

58 c⁄° 
z˛AârInfo_t
 
	gdo‹Lock_©åTbl
[] =

60 { 
ZCL_ATTRID_LOCK_STATE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
g_z˛Do‹LockAâr
.
z˛_©å_LockSèã
},

61 { 
ZCL_ATTRID_LOCK_TYPE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛Do‹LockAâr
.
z˛_©å_LockTy≥
},

62 { 
ZCL_ATTRID_ACTUATOR_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛Do‹LockAâr
.
z˛_©å_A˘u©‹E«bÀd
},

63 { 
ZCL_ATTRID_SEND_PIN_OTA
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
g_z˛Do‹LockAâr
.
z˛_©å_£ndPöOè
},

64 { 
ZCL_ATTRID_REQUIRE_PIN_FOR_RF_OPERATION
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
g_z˛Do‹LockAâr
.
z˛_©å_ªquúePöF‹RfO≥øti⁄
},

65 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

68 c⁄° 
u8
 
	gz˛_do‹Lock_©åNum
 = ( (
do‹Lock_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/closures/zcl_window_covering.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_WINDOW_COVERING


49 
°©us_t
 
z˛_wödowCovîög_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_CLOSURES_WINDOW_COVERING
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_wödowCovîög_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_upO≥n
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

60  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_CLOSURES_WINDOW_COVERING
, 
ZCL_CMD_UP_OPEN
, 
TRUE
,

61 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 0);

62 
	}
}

64 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_downClo£
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

66  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_CLOSURES_WINDOW_COVERING
, 
ZCL_CMD_DOWN_CLOSE
, 
TRUE
,

67 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 0);

68 
	}
}

70 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_°›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

72  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_CLOSURES_WINDOW_COVERING
, 
ZCL_CMD_STOP
, 
TRUE
,

73 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 0);

74 
	}
}

78 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_gíCmdPrc
(
z˛Incomög_t
 *
pInMsg
)

80 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

83 if(
pInMsg
->
˛u°îAµCb
){

84 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

86 
°©us
 = 
ZCL_STA_FAILURE
;

89  
°©us
;

90 
	}
}

92 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

94 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

96 
pInMsg
->
hdr
.
cmd
){

97 
ZCL_CMD_UP_OPEN
:

98 
ZCL_CMD_DOWN_CLOSE
:

99 
ZCL_CMD_STOP
:

100 
°©us
 = 
	`z˛_wödowCovîög_gíCmdPrc
(
pInMsg
);

103 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

107  
°©us
;

108 
	}
}

110 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wödowCovîög_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

112 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

113  
	`z˛_wödowCovîög_˛õ¡CmdH™dÀr
(
pInMsg
);

115  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

117 
	}
}

	@zigbee/zcl/closures/zcl_window_covering.h

24 #i‚de‡
ZCL_WINDOW_COVERING_H


25 
	#ZCL_WINDOW_COVERING_H


	)

35 
	#ZCL_ATTRID_WINDOW_COVERING_TYPE
 0x0000

	)

36 
	#ZCL_ATTRID_PHYSICAL_CLOSED_LIMIT_LIFT
 0x0001

	)

37 
	#ZCL_ATTRID_PHYSICAL_CLOSED_LIMIT_TILT
 0x0002

	)

38 
	#ZCL_ATTRID_CURRENT_POSITION_LIFT
 0x0003

	)

39 
	#ZCL_ATTRID_CURRENT_POSITION_TILT
 0x0004

	)

40 
	#ZCL_ATTRID_NUM_OF_ACTUATIONS_LIFT
 0x0005

	)

41 
	#ZCL_ATTRID_NUM_OF_ACTUATIONS_TILT
 0x0006

	)

42 
	#ZCL_ATTRID_CONFIG_STATUS
 0x0007

	)

43 
	#ZCL_ATTRID_CURRENT_POSITION_LIFT_PERCENTAGE
 0x0008

	)

44 
	#ZCL_ATTRID_CURRENT_POSITION_TILT_PERCENTAGE
 0x0009

	)

45 
	#ZCL_ATTRID_INSTALLED_OPEN_LIMIT_LIFT
 0x0010

	)

46 
	#ZCL_ATTRID_INSTALLED_CLOSED_LIMIT_LIFT
 0x0011

	)

47 
	#ZCL_ATTRID_INSTALLED_OPEN_LIMIT_TILT
 0x0012

	)

48 
	#ZCL_ATTRID_INSTALLED_CLOSED_LIMIT_TILT
 0x0013

	)

49 
	#ZCL_ATTRID_VELOCITY_LIFT
 0x0014

	)

50 
	#ZCL_ATTRID_ACCELERATION_TIME_LIFT
 0x0015

	)

51 
	#ZCL_ATTRID_DECELERATION_TIME_LIFT
 0x0016

	)

52 
	#ZCL_ATTRID_MODE
 0x0017

	)

53 
	#ZCL_ATTRID_INTERMEDIATE_SETPOINTS_LIFT
 0x0018

	)

54 
	#ZCL_ATTRID_INTERMEDIATE_SETPOINTS_TILT
 0x0019

	)

60 
	#ZCL_CMD_UP_OPEN
 0x00

	)

61 
	#ZCL_CMD_DOWN_CLOSE
 0x01

	)

62 
	#ZCL_CMD_STOP
 0x02

	)

63 
	#ZCL_CMD_GO_TO_LIFT_VALUE
 0x04

	)

64 
	#ZCL_CMD_GO_TO_LIFT_PERCENTAGE
 0x05

	)

65 
	#ZCL_CMD_GO_TO_TILT_VALUE
 0x07

	)

66 
	#ZCL_CMD_GO_TO_TILT_PERCENTAGE
 0x08

	)

74 
u16
 
	mli·VÆue
;

75 }
	tz˛_goToLi·VÆue_t
;

81 
u8
 
	m≥rLi·VÆue
;

82 }
	tz˛_goToLi·Pî_t
;

88 
u16
 
	mtûtVÆue
;

89 }
	tz˛_goToTûâVÆue_t
;

95 
u8
 
	m≥rTûtVÆue
;

96 }
	tz˛_goToTûtPî_t
;

104 
z˛_goToLi·VÆue_t
 
	mgoToLi·VÆue
;

105 
z˛_goToLi·Pî_t
 
	mgoToLi·Pî
;

106 
z˛_goToTûâVÆue_t
 
	mgoToTûtVÆue
;

107 
z˛_goToTûtPî_t
 
	mgoToTûtPî
;

108 }
	tz˛_wöCovîög_cmdPaylﬂd_t
;

113 
	$°©us_t
 (*
	tz˛_wödowCovîög_gíCmdCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tu8
 
	tcmdId
, 
	tz˛_wöCovîög_cmdPaylﬂd_t
 *
	tcmdPaylﬂd
);

120 
z˛_wödowCovîög_gíCmdCb_t
 
gíCmdCbFunc
;

121 }
	tz˛_WödowCovîög_AµCÆlbacks_t
;

124 
u8
 
z˛_©å_WödowCovîögTy≥
;

125 
u8
 
z˛_©å_C⁄figSètus
;

126 
u8
 
z˛_©å_Mode
;

128 c⁄° 
z˛AârInfo_t
 
wödowCovîög_©åTbl
[];

129 c⁄° 
u8
 
z˛_wödowCovîög_©åNum
;

133 
°©us_t
 
	`z˛_wödowCovîög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

135 
°©us_t
 
	`z˛_wödowCovîög_upO≥n
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

136 
	#z˛_wödowCovîög_upO≥nCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wödowCovîög_upO≥n
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

138 
°©us_t
 
	`z˛_wödowCovîög_downClo£
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

139 
	#z˛_wödowCovîög_downClo£CmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wödowCovîög_downClo£
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

141 
°©us_t
 
	`z˛_wödowCovîög_°›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

142 
	#z˛_wödowCovîög_°›CmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wödowCovîög_°›
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

	@zigbee/zcl/closures/zcl_window_covering_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_WINDOW_COVERING


48 
u8
 
	gz˛_©å_WödowCovîögTy≥
 = 0;

49 
u8
 
	gz˛_©å_C⁄figSètus
 = 0x03;

50 
u8
 
	gz˛_©å_Mode
 = 0x04;

54 c⁄° 
z˛AârInfo_t
 
	gwödowCovîög_©åTbl
[] =

56 { 
ZCL_ATTRID_WINDOW_COVERING_TYPE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_WödowCovîögTy≥
},

57 { 
ZCL_ATTRID_CONFIG_STATUS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_C⁄figSètus
},

58 { 
ZCL_ATTRID_MODE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
| 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Mode
},

59 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

62 c⁄° 
u8
 
	gz˛_wödowCovîög_©åNum
 = ( (
wödowCovîög_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/commissioning/zcl_commissioning.c

27 
	~"../z˛_ö˛ude.h
"

30 
	#ZB_RANDOM_X
(
x
Ë(xË? (
	`zb_øndom
(Ë% xË: 0

	)

41 #ifde‡
ZCL_COMMISSIONING


43 
z˛_commissi⁄ög_AµCÆlbacks_t
 *
	gz˛_commissi⁄ög_cb
;

51 
u8
 
z˛_commissi⁄ög_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

54 
_CODE_ZCL_
 
	$zb_ª°¨t_devi˚_func
(*
¨g
)

56 
	`z˛_öôülize_°¨tup_©åibuãs
();

60 
	}
}

63 
_CODE_ZCL_
 
	$z˛_commissi⁄ög_ª°¨t_devi˚
(
u8
 
§cEp
, 
ïInfo_t
* 
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
,

64 
u8
 
›ti⁄s
, u8 
dñay
, u8 
jôãr
)

66 
u8
 
buf
[3];

67 
buf
[0] = 
›ti⁄s
;

68 
buf
[1] = 
dñay
;

69 
buf
[2] = 
jôãr
;

71 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_COMMISSIONING
, 
ZCL_CMD_RESTART_DEVICE
, 
TRUE
,

72 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

73 
	}
}

76 
_CODE_ZCL_
 
u8
 
	$z˛_commissi⁄ög_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

78 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

79 
u8
 
cmd
 = 
pInMsg
->
hdr
.cmd;

80 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

83 
ïInfo_t
 
d°Ep
;

84 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

86 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

87 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

88 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

89 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

90 
d°Ep
.
ødius
 = 0x0a;

91 
d°Ep
.
txO±i⁄s
 = 0;

93 
cmd
) {

94 
ZCL_CMD_RESTART_DEVICE
:

96 
z˛_ª°¨tDevi˚_t
 *
ª°¨tDevi˚
 = (z˛_ª°¨tDevi˚_à*Ë
pInMsg
->
pD©a
;

97 
boﬁ
 
immedüã
 = 
Ál£
;

99 if(
	`ZCL_RESTART_OPTIONS_GET_IMMEDIATE
(
ª°¨tDevi˚
->
›ti⁄s
))

101 if(
ª°¨tDevi˚
->
dñay
 == 0)

104 
immedüã
 = 
åue
;

105 
	`zb_ª°¨t_devi˚_func
(&
immedüã
);

110 
u16
 
jôãr_ö_mûli£c⁄ds
 = 
ª°¨tDevi˚
->
jôãr
 ?

111 
	`ZB_RANDOM_X
(
ª°¨tDevi˚
->
jôãr
 * 80) : 0;

112 
u32
 
max_dñay
 = (
ª°¨tDevi˚
->
dñay
 +

113 (
jôãr_ö_mûli£c⁄ds
 / 1000)) * 1000;

115 
immedüã
 = 
åue
;

116 
	`TL_ZB_TIMER_SCHEDULE
(
zb_ª°¨t_devi˚_func
,(*)
TRUE
,
max_dñay
);

122 
u16
 
jôãr_ö_mûli£c⁄ds
 = 
ª°¨tDevi˚
->
jôãr
 ?

123 
	`ZB_RANDOM_X
(
ª°¨tDevi˚
->
jôãr
 * 80) : 0;

124 
u32
 
max_dñay
 = 0;

125 
max_dñay
 = (
ª°¨tDevi˚
->
dñay
 +

126 (
jôãr_ö_mûli£c⁄ds
 / 1000)) * 1000;

128 
immedüã
 = 
Ál£
;

129 if(
max_dñay
)

131 
	`TL_ZB_TIMER_SCHEDULE
(
zb_ª°¨t_devi˚_func
,(*)
TRUE
,
max_dñay
);

135 
	`zb_ª°¨t_devi˚_func
(&
immedüã
);

140 
ZCL_CMD_SAVE_STARTUP_PARAMETERS
:

142 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

144 
ZCL_CMD_RESTORE_STARTUP_PARAMETERS
:

146 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

148 
ZCL_CMD_RESET_STARTUP_PARAMETERS
:

150 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

153 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

157  
°©us
;

158 
	}
}

162 
_CODE_ZCL_
 
u8
 
	$z˛_commissi⁄ög_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

164 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

165 
u8
 
cmd
 = 
pInMsg
->
hdr
.cmd;

168 
cmd
) {

169 
ZCL_CMD_RESTART_DEVICE_RSP
:

171 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

173 
ZCL_CMD_SAVE_STARTUP_PARAMETERS_RSP
:

175 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

177 
ZCL_CMD_RESTORE_STARTUP_PARAMETERS_RSP
:

179 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

181 
ZCL_CMD_RESET_STARTUP_PARAMETERS_RSP
:

183 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

187 
°©us
 = 
ZCL_STA_FAILURE
;

191  
°©us
;

192 
	}
}

	@zigbee/zcl/commissioning/zcl_commissioning.h

24 #i‚de‡
ZCL_COMMISSIONING_H


25 
	#ZCL_COMMISSIONING_H


	)

50 
	#ZCL_CMD_RESTART_DEVICE
 0x00

	)

51 
	#ZCL_CMD_SAVE_STARTUP_PARAMETERS
 0x01

	)

52 
	#ZCL_CMD_RESTORE_STARTUP_PARAMETERS
 0x02

	)

53 
	#ZCL_CMD_RESET_STARTUP_PARAMETERS
 0x03

	)

56 
	#ZCL_CMD_RESTART_DEVICE_RSP
 0x00

	)

57 
	#ZCL_CMD_SAVE_STARTUP_PARAMETERS_RSP
 0x01

	)

58 
	#ZCL_CMD_RESTORE_STARTUP_PARAMETERS_RSP
 0x02

	)

59 
	#ZCL_CMD_RESET_STARTUP_PARAMETERS_RSP
 0x03

	)

70 
	#ZCL_ATTR_SHORT_ADDRESS
 0x0000

	)

71 
	#ZCL_ATTR_EXTENDED_PAN_ID
 0x0001

	)

72 
	#ZCL_ATTR_PAN_ID
 0x0002

	)

73 
	#ZCL_ATTR_CHANNEL_MASK
 0x0003

	)

74 
	#ZCL_ATTR_PROTOCOL_VERSION
 0x0004

	)

75 
	#ZCL_ATTR_STACK_PROFILE
 0x0005

	)

76 
	#ZCL_ATTR_STARTUP_CONTROL
 0x0006

	)

78 
	#ZCL_ATTR_TRUST_CENTER_ADDRESS
 0x0010

	)

79 
	#ZCL_ATTR_TRUST_CENTER_MASTER_KEY
 0x0011

	)

80 
	#ZCL_ATTR_NETWORK_KEY
 0x0012

	)

81 
	#ZCL_ATTR_USE_INSECURE_JOIN
 0x0013

	)

82 
	#ZCL_ATTR_PRECONFIGURED_LINK_KEY
 0x0014

	)

83 
	#ZCL_ATTR_NETWORK_KEY_SEQUENCE_NO
 0x0015

	)

84 
	#ZCL_ATTR_NETWORK_KEY_TYPE
 0x0016

	)

85 
	#ZCL_ATTR_NETWORK_MANAGER_ADDRESS
 0x0017

	)

87 
	#ZCL_ATTR_SCAN_ATTEMPTS
 0x0020

	)

88 
	#ZCL_ATTR_TIME_BETWEEN_SCANS
 0x0021

	)

89 
	#ZCL_ATTR_REJOIN_INTERVAL
 0x0022

	)

90 
	#ZCL_ATTR_MAX_REJOIN_INTERVAL
 0x0023

	)

92 
	#ZCL_ATTR_INDIRECT_POLL_RATE
 0x0030

	)

93 
	#ZCL_ATTR_PARENT_RETRY_THRESHOLD
 0x0031

	)

95 
	#ZCL_ATTR_CONCENTRATOR_FLAG
 0x0040

	)

96 
	#ZCL_ATTR_CONCENTRATOR_RADIUS
 0x0041

	)

97 
	#ZCL_ATTR_CONCENTRATOR_DISCOVERY_TIME
 0x0042

	)

113 (*
	tz˛_ª°¨tDevi˚Cb_t
)–
	tu8
 
	t›ti⁄s
, u8 
	tdñay
, u8 
	tjôãr
 );

114 (*
	tz˛_ßveSèπupP¨amsCb_t
)–
	tu8
 
	t›ti⁄s
, u8 
	tödex
 );

115 (*
	tz˛_ª°‹eSèπupP¨amsCb_t
)–
	tu8
 
	t›ti⁄s
, u8 
	tödex
 );

116 (*
	tz˛_ª£tSèπupP¨amsCb_t
)–
	tu8
 
	t›ti⁄s
, u8 
	tödex
 );

122 
z˛_ª°¨tDevi˚Cb_t
 
ª°¨tDevi˚CbFunc
;

123 
z˛_ßveSèπupP¨amsCb_t
 
ßveSèπupP¨amsCbFunc
;

124 
z˛_ª°‹eSèπupP¨amsCb_t
 
ª°‹eSèπupP¨amsCbFunc
;

125 
z˛_ª£tSèπupP¨amsCb_t
 
ªs£tSèπupP¨amsCbFunc
;

126 } 
	tz˛_commissi⁄ög_AµCÆlbacks_t
;

141 
u16
 
z˛_©å_sh‹t_addªss
;

142 
extPANId_t
 
z˛_©å_exãnded_PAN_id
;

143 
u16
 
z˛_©å_PAN_id
;

144 
u32
 
z˛_©å_ch™√l_mask
;

145 
u8
 
z˛_©å_¥Ÿocﬁ_vîsi⁄
;

146 
u8
 
z˛_©å_°ack_¥ofûe
;

147 
u8
 
z˛_©å_°¨tup_c⁄åﬁ
;

150 
addrExt_t
 
z˛_©å_åu°_˚¡î_addªss
;

151 
u8
 
z˛_©å_åu°_˚¡î_ma°î_key
[16];

152 
u8
 
z˛_©å_√tw‹k_key
[16];

153 
u8
 
z˛_©å_u£_ö£cuª_joö
;

154 
u8
 
z˛_©å_¥ec⁄figuªd_lök_key
[16];

155 
u8
 
z˛_©å_√tw‹k_key_£quí˚_numbî
;

156 
u8
 
z˛_©å_√tw‹k_key_ty≥
;

157 
u16
 
z˛_©å_√tw‹k_m™agî_addªss
;

159 
u8
 
z˛_©å_sˇn_©ãm±s
;

160 
u16
 
z˛_©å_time_bëwìn_sˇns
;

161 
u16
 
z˛_©å_ªjoö_öãrvÆ
;

162 
u16
 
z˛_©å_max_ªjoö_öãrvÆ
;

164 
u16
 
ödúe˘_pﬁl_øã
;

165 
u8
 
z˛_©å_∑ª¡_ªåy_thªshﬁd
;

167 
u8
 
z˛_©å_c⁄˚¡øt‹_Êag
;

168 
u8
 
z˛_©å_c⁄˚¡øt‹_ødius
;

169 
u8
 
z˛_©å_c⁄˚¡øt‹_discovîy_time
;

173 c⁄° 
z˛AârInfo_t
 
commissi⁄ög_©åTbl
[];

175 c⁄° 
u8
 
z˛_commissi⁄ög_©åNum
;

182 
	#ZCL_RESTART_OPTIONS_GET_STARTUP_MODE
(
›ti⁄s
Ë(›ti⁄†& 7)

	)

183 
	#ZCL_RESTART_OPTIONS_GET_IMMEDIATE
(
›ti⁄s
Ë(›ti⁄†& (1 << 3))

	)

186 
u8
 
›ti⁄s
;

187 
u8
 
dñay
;

188 
u8
 
jôãr
;

189 } 
	tz˛_ª°¨tDevi˚_t
;

208 
°©us_t
 
	`z˛_commissi⁄ög_ªgi°î
(
u8
 
ídpoöt
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

210 
	`z˛_öôülize_°¨tup_©åibuãs
();

	@zigbee/zcl/commissioning/zcl_commissioning_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_COMMISSIONING


50 
u16
 
	gz˛_©å_sh‹t_addªss
 = 0x00;

51 
extPANId_t
 
	gz˛_©å_exãnded_PAN_id
 = { 0 };

52 
u16
 
	gz˛_©å_PAN_id
 = 
MAC_INVALID_PANID
;

53 
u32
 
	gz˛_©å_ch™√l_mask
 = 
ZB_TRANSCEIVER_ALL_CHANNELS_MASK
;

54 
u8
 
	gz˛_©å_¥Ÿocﬁ_vîsi⁄
 = 
ZB_PROTOCOL_VERSION
;

55 
u8
 
	gz˛_©å_°ack_¥ofûe
 = 
ZB_STACK_PROFILE
;

56 
u8
 
	gz˛_©å_°¨tup_c⁄åﬁ
 = 0;

58 
addrExt_t
 
	gz˛_©å_åu°_˚¡î_addªss
 = {0, 0, 0, 0, 0, 0, 0, 0};

59 
u8
 
	gz˛_©å_åu°_˚¡î_ma°î_key
[16] = { 0, 0, 0, 0, 0, 0, 0, 0 };

60 
u8
 
	gz˛_©å_√tw‹k_key
[16] = { 0, 0, 0, 0, 0, 0, 0, 0 };

61 
u8
 
	gz˛_©å_u£_ö£cuª_joö
 = 
åue
;

62 
u8
 
	gz˛_©å_¥ec⁄figuªd_lök_key
[16] = { 0, 0, 0, 0, 0, 0, 0, 0 };

63 
u8
 
	gz˛_©å_√tw‹k_key_£quí˚_numbî
 = 0;

64 
u8
 
	gz˛_©å_√tw‹k_key_ty≥
 = 0;

65 
u16
 
	gz˛_©å_√tw‹k_m™agî_addªss
 = 0x0000;

68 
u8
 
	gz˛_©å_sˇn_©ãm±s
 = 0;

69 
u16
 
	gz˛_©å_time_bëwìn_sˇns
 = 0;

70 
u16
 
	gz˛_©å_ªjoö_öãrvÆ
 = 0;

71 
u16
 
	gz˛_©å_max_ªjoö_öãrvÆ
 = 0;

73 
u16
 
	gödúe˘_pﬁl_øã
 = 0;

74 
u8
 
	gz˛_©å_∑ª¡_ªåy_thªshﬁd
 = 0;

76 
u8
 
	gz˛_©å_c⁄˚¡øt‹_Êag
 = 0;

77 
u8
 
	gz˛_©å_c⁄˚¡øt‹_ødius
 = 0;

78 
u8
 
	gz˛_©å_c⁄˚¡øt‹_discovîy_time
 = 0;

81 c⁄° 
z˛AârInfo_t
 
	gcommissi⁄ög_©åTbl
[] =

83 { 
ZCL_ATTR_SHORT_ADDRESS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_sh‹t_addªss
 },

84 { 
ZCL_ATTR_EXTENDED_PAN_ID
, 
ZCL_DATA_TYPE_IEEE_ADDR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_exãnded_PAN_id
 },

85 { 
ZCL_ATTR_PAN_ID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_PAN_id
 },

86 { 
ZCL_ATTR_CHANNEL_MASK
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_ch™√l_mask
 },

87 { 
ZCL_ATTR_PROTOCOL_VERSION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥Ÿocﬁ_vîsi⁄
 },

88 { 
ZCL_ATTR_STACK_PROFILE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_°ack_¥ofûe
 },

89 { 
ZCL_ATTR_STARTUP_CONTROL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_°¨tup_c⁄åﬁ
 },

91 { 
ZCL_ATTR_TRUST_CENTER_ADDRESS
, 
ZCL_DATA_TYPE_IEEE_ADDR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_åu°_˚¡î_addªss
 },

92 { 
ZCL_ATTR_TRUST_CENTER_MASTER_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_åu°_˚¡î_ma°î_key
 },

93 { 
ZCL_ATTR_NETWORK_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_√tw‹k_key
 },

94 { 
ZCL_ATTR_USE_INSECURE_JOIN
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_u£_ö£cuª_joö
 },

95 { 
ZCL_ATTR_PRECONFIGURED_LINK_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_¥ec⁄figuªd_lök_key
 },

96 { 
ZCL_ATTR_NETWORK_KEY_SEQUENCE_NO
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_√tw‹k_key_£quí˚_numbî
 },

97 { 
ZCL_ATTR_NETWORK_KEY_TYPE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_√tw‹k_key_ty≥
 },

98 { 
ZCL_ATTR_NETWORK_MANAGER_ADDRESS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_√tw‹k_m™agî_addªss
 },

100 { 
ZCL_ATTR_SCAN_ATTEMPTS
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_sˇn_©ãm±s
 },

101 { 
ZCL_ATTR_TIME_BETWEEN_SCANS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_time_bëwìn_sˇns
 },

102 { 
ZCL_ATTR_REJOIN_INTERVAL
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_ªjoö_öãrvÆ
 },

103 { 
ZCL_ATTR_MAX_REJOIN_INTERVAL
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_max_ªjoö_öãrvÆ
 },

105 { 
ZCL_ATTR_INDIRECT_POLL_RATE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
ödúe˘_pﬁl_øã
 },

106 { 
ZCL_ATTR_PARENT_RETRY_THRESHOLD
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_∑ª¡_ªåy_thªshﬁd
 },

108 { 
ZCL_ATTR_CONCENTRATOR_FLAG
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_c⁄˚¡øt‹_Êag
 },

109 { 
ZCL_ATTR_CONCENTRATOR_RADIUS
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_c⁄˚¡øt‹_ødius
 },

110 { 
ZCL_ATTR_CONCENTRATOR_DISCOVERY_TIME
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_c⁄˚¡øt‹_discovîy_time
 },

113 c⁄° 
u8
 
	gz˛_commissi⁄ög_©åNum
 = ( (
commissi⁄ög_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_alarm.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_ALARMS


44 
z˛_Æ¨mTabÀ_t
 
	gg_z˛_Æ¨mTab
[
ZCL_ALARM_TABLE_NUM
];

50 
°©us_t
 
z˛_Æ¨m_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

53 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

55  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_ALARMS
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_Æ¨m_cmdH™dÀr
, 
cb
);

56 
	}
}

59 
_CODE_ZCL_
 
	$z˛_Æ¨m_˛órAœrmE¡ry
(
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
)

61 if(
pAœrmTab
){

62 
pAœrmTab
->
u£d
 = 0;

63 
pAœrmTab
->
ídpoöt
 = 0xfe;

64 
	`mem£t
((
u8
 *)&
pAœrmTab
->
Æ¨m
, 0, (
z˛_Æ¨mE¡ry_t
));

66 
	}
}

68 
_CODE_ZCL_
 
	$z˛_Æ¨m_Æ¨mTabCÀ¨
()

70 
u8
 
i
 = 0; i < 
ZCL_ALARM_TABLE_NUM
; i++){

71 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = &
g_z˛_Æ¨mTab
[
i
];

73 
	`z˛_Æ¨m_˛órAœrmE¡ry
(
pAœrmTab
);

75 
	}
}

77 
_CODE_ZCL_
 
z˛_Æ¨mTabÀ_t
 *
	$z˛_Æ¨m_födE¨lõ°AœrmE¡ry
(
u8
 
ídpoöt
)

79 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = 
NULL
;

80 
u32
 
t
 = 0xffffffff;

82 
u8
 
i
 = 0; i < 
ZCL_ALARM_TABLE_NUM
; i++){

83 
z˛_Æ¨mTabÀ_t
 *
pE¡ry
 = &
g_z˛_Æ¨mTab
[
i
];

85 if(
pE¡ry
->
u£d
 && (pE¡ry->
ídpoöt
 ==Éndpoint)){

86 if(
pE¡ry
->
Æ¨m
.
timeSèmp
 < 
t
){

87 
pAœrmTab
 = 
pE¡ry
;

88 
t
 = 
pE¡ry
->
Æ¨m
.
timeSèmp
;

93  
pAœrmTab
;

94 
	}
}

96 
_CODE_ZCL_
 
	$z˛_Æ¨m_ªmoveAŒAœrmE¡rõs
(
u8
 
ídpoöt
)

98 
u8
 
i
 = 0; i < 
ZCL_ALARM_TABLE_NUM
; i++){

99 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = &
g_z˛_Æ¨mTab
[
i
];

101 if(
pAœrmTab
->
u£d
 && (pAœrmTab->
ídpoöt
 ==Éndpoint)){

102 
	`z˛_Æ¨m_˛órAœrmE¡ry
(
pAœrmTab
);

105 
	}
}

107 
_CODE_ZCL_
 
z˛_Æ¨mTabÀ_t
 *
	$z˛_Æ¨m_gëFªeAœrmTabE¡ry
()

109 
u8
 
i
 = 0; i < 
ZCL_ALARM_TABLE_NUM
; i++){

110 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = &
g_z˛_Æ¨mTab
[
i
];

112 if(!
pAœrmTab
->
u£d
){

113  
pAœrmTab
;

117  
NULL
;

118 
	}
}

120 
_CODE_ZCL_
 
z˛_Æ¨mTabÀ_t
 *
	$z˛_Æ¨m_födAœrmTab
(
u8
 
ídpoöt
, u8 
Æ¨mCode
, 
u16
 
˛u°îId
)

122 
u8
 
i
 = 0; i < 
ZCL_ALARM_TABLE_NUM
; i++){

123 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = &
g_z˛_Æ¨mTab
[
i
];

125 if–
pAœrmTab
->
u£d
 && (pAœrmTab->
ídpoöt
 ==Éndpoint) &&

126 (
pAœrmTab
->
Æ¨m
.
Æ¨mCode
 =Æ¨mCodeË&& (pAœrmTab->Æ¨m.
˛u°îId
 == clusterId) ){

127  
pAœrmTab
;

131  
NULL
;

132 
	}
}

134 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_AddAœrmTab
(
u8
 
ídpoöt
, u8 
Æ¨mCode
, 
u16
 
˛u°îId
, 
u32
 
timeSèmp
)

136 
z˛_Æ¨mTabÀ_t
 *
pAœrmTab
 = 
	`z˛_Æ¨m_gëFªeAœrmTabE¡ry
();

137 if(
pAœrmTab
){

138 
pAœrmTab
->
u£d
 = 1;

139 
pAœrmTab
->
ídpoöt
 =Éndpoint;

140 
pAœrmTab
->
Æ¨m
.
Æ¨mCode
 =álarmCode;

141 
pAœrmTab
->
Æ¨m
.
˛u°îId
 = clusterId;

142 
pAœrmTab
->
Æ¨m
.
timeSèmp
 =ÅimeStamp;

144  
ZCL_STA_INSUFFICIENT_SPACE
;

147  
ZCL_STA_SUCCESS
;

148 
	}
}

151 
_CODE_ZCL_
 
u8
 
	$z˛_Æ¨m_gëAœrmR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëAœrmR•_t
 *
pGëAœrmR•
)

153 
buf
[8];

155 
u8
 *
pBuf
 = 
buf
;

157 *
pBuf
++ = 
pGëAœrmR•
->
°©us
;

158 if(
pGëAœrmR•
->
°©us
 =
ZCL_STA_SUCCESS
){

159 *
pBuf
++ = 
pGëAœrmR•
->
Æ¨mCode
;

160 *
pBuf
++ = 
	`LO_UINT16
(
pGëAœrmR•
->
˛u°îId
);

161 *
pBuf
++ = 
	`HI_UINT16
(
pGëAœrmR•
->
˛u°îId
);

162 *
pBuf
++ = 
	`U32_BYTE0
(
pGëAœrmR•
->
timeSèmp
);

163 *
pBuf
++ = 
	`U32_BYTE1
(
pGëAœrmR•
->
timeSèmp
);

164 *
pBuf
++ = 
	`U32_BYTE2
(
pGëAœrmR•
->
timeSèmp
);

165 *
pBuf
++ = 
	`U32_BYTE3
(
pGëAœrmR•
->
timeSèmp
);

168  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_GET_ALARM_RSP
, 
TRUE
,

169 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

170 
	}
}

173 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_Æ¨m
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Æ¨m_t
 *
pAœrm
)

175 
u8
 
buf
[3];

177 
buf
[0] = 
pAœrm
->
Æ¨mCode
;

178 
buf
[1] = 
	`LO_UINT16
(
pAœrm
->
˛u°îId
);

179 
buf
[2] = 
	`HI_UINT16
(
pAœrm
->
˛u°îId
);

181  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_ALARM
, 
TRUE
,

182 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

183 
	}
}

185 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ª£tAœrm_t
 *
pRe£tAœrm
)

187 
u8
 
buf
[3];

189 
buf
[0] = 
pRe£tAœrm
->
Æ¨mCode
;

190 
buf
[1] = 
	`LO_UINT16
(
pRe£tAœrm
->
˛u°îId
);

191 
buf
[2] = 
	`HI_UINT16
(
pRe£tAœrm
->
˛u°îId
);

193  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_RESET_ALARM
, 
TRUE
,

194 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

195 
	}
}

197 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAŒAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

199  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_RESET_ALL
, 
TRUE
,

200 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

201 
	}
}

203 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_gëAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

205  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_GET_ALARM
, 
TRUE
,

206 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

207 
	}
}

209 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAœrmLog
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

211  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ALARMS
, 
ZCL_CMD_ALARM_RESET_ALARM_LOG
, 
TRUE
,

212 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

213 
	}
}

216 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAœrmPrc
(
z˛Incomög_t
 *
pInMsg
)

218 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

219 
u8
 *
pD©a
 = 
pInMsg
->pData;

221 if(
pInMsg
->
˛u°îAµCb
){

222 
ª£tAœrm_t
 
ª£tAœrm
;

223 
ª£tAœrm
.
Æ¨mCode
 = *
pD©a
++;

224 
ª£tAœrm
.
˛u°îId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

225 
pD©a
 += 2;

227 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ª£tAœrm
);

229 
°©us
 = 
ZCL_STA_FAILURE
;

232  
°©us
;

233 
	}
}

235 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAŒAœrmsPrc
(
z˛Incomög_t
 *
pInMsg
)

237 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

239 if(
pInMsg
->
˛u°îAµCb
){

240 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

242 
°©us
 = 
ZCL_STA_FAILURE
;

245  
°©us
;

246 
	}
}

248 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_gëAœrmPrc
(
z˛Incomög_t
 *
pInMsg
)

250 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

251 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

253 if(
pInMsg
->
˛u°îAµCb
){

254 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

256 
gëAœrmR•_t
 
gëAœrmR•
;

257 
	`TL_SETSTRUCTCONTENT
(
gëAœrmR•
, 0);

259 
z˛_Æ¨mTabÀ_t
 *
pE¡ry
 = 
	`z˛_Æ¨m_födE¨lõ°AœrmE¡ry
(
ídpoöt
);

260 if(
pE¡ry
){

261 
gëAœrmR•
.
°©us
 = 
ZCL_STA_SUCCESS
;

262 
gëAœrmR•
.
Æ¨mCode
 = 
pE¡ry
->
Æ¨m
.alarmCode;

263 
gëAœrmR•
.
˛u°îId
 = 
pE¡ry
->
Æ¨m
.clusterId;

264 
gëAœrmR•
.
timeSèmp
 = 
pE¡ry
->
Æ¨m
.timeStamp;

266 
gëAœrmR•
.
°©us
 = 
ZCL_STA_NOT_FOUND
;

269 
ïInfo_t
 
d°Ep
;

270 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

272 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

273 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

274 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

275 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

277 
	`z˛_Æ¨m_gëAœrmR•
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, &
gëAœrmR•
);

279 if(
gëAœrmR•
.
°©us
 =
ZCL_STA_SUCCESS
){

281 
	`z˛_Æ¨m_˛órAœrmE¡ry
(
pE¡ry
);

284 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

286 
°©us
 = 
ZCL_STA_FAILURE
;

289  
°©us
;

290 
	}
}

292 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_ª£tAœrmLogPrc
(
z˛Incomög_t
 *
pInMsg
)

294 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

295 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

297 if(
pInMsg
->
˛u°îAµCb
){

298 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

301 
	`z˛_Æ¨m_ªmoveAŒAœrmE¡rõs
(
pApsdeInd
->
ödInfo
.
d°_ï
);

303 
°©us
 = 
ZCL_STA_FAILURE
;

306  
°©us
;

307 
	}
}

309 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_Æ¨mPrc
(
z˛Incomög_t
 *
pInMsg
)

311 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

312 
u8
 *
pD©a
 = 
pInMsg
->pData;

314 if(
pInMsg
->
˛u°îAµCb
){

315 
Æ¨m_t
 
Æ¨m
;

316 
Æ¨m
.
Æ¨mCode
 = *
pD©a
++;

317 
Æ¨m
.
˛u°îId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

318 
pD©a
 += 2;

320 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
Æ¨m
);

322 
°©us
 = 
ZCL_STA_FAILURE
;

325  
°©us
;

326 
	}
}

328 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_gëAœrmR•Prc
(
z˛Incomög_t
 *
pInMsg
)

330 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

331 
u8
 *
pD©a
 = 
pInMsg
->pData;

333 if(
pInMsg
->
˛u°îAµCb
){

334 
gëAœrmR•_t
 
gëAœrmR•
;

335 
gëAœrmR•
.
°©us
 = *
pD©a
++;

336 if(
gëAœrmR•
.
°©us
 =
ZCL_STA_SUCCESS
){

337 
gëAœrmR•
.
Æ¨mCode
 = *
pD©a
++;

338 
gëAœrmR•
.
˛u°îId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

339 
pD©a
 += 2;

340 
gëAœrmR•
.
timeSèmp
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

341 
pD©a
 += 4;

344 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëAœrmR•
);

346 
°©us
 = 
ZCL_STA_FAILURE
;

349  
°©us
;

350 
	}
}

352 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

354 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

356 
pInMsg
->
hdr
.
cmd
){

357 
ZCL_CMD_ALARM_RESET_ALARM
:

358 
°©us
 = 
	`z˛_Æ¨m_ª£tAœrmPrc
(
pInMsg
);

360 
ZCL_CMD_ALARM_RESET_ALL
:

361 
°©us
 = 
	`z˛_Æ¨m_ª£tAŒAœrmsPrc
(
pInMsg
);

363 
ZCL_CMD_ALARM_GET_ALARM
:

364 
°©us
 = 
	`z˛_Æ¨m_gëAœrmPrc
(
pInMsg
);

366 
ZCL_CMD_ALARM_RESET_ALARM_LOG
:

367 
°©us
 = 
	`z˛_Æ¨m_ª£tAœrmLogPrc
(
pInMsg
);

370 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

374  
°©us
;

375 
	}
}

377 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

379 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

381 
pInMsg
->
hdr
.
cmd
){

382 
ZCL_CMD_ALARM_ALARM
:

383 
°©us
 = 
	`z˛_Æ¨m_Æ¨mPrc
(
pInMsg
);

385 
ZCL_CMD_ALARM_GET_ALARM_RSP
:

386 
°©us
 = 
	`z˛_Æ¨m_gëAœrmR•Prc
(
pInMsg
);

389 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

393  
°©us
;

394 
	}
}

396 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Æ¨m_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

398 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

399  
	`z˛_Æ¨m_˛õ¡CmdH™dÀr
(
pInMsg
);

401  
	`z˛_Æ¨m_£rvîCmdH™dÀr
(
pInMsg
);

403 
	}
}

	@zigbee/zcl/general/zcl_alarm.h

24 #i‚de‡
ZCL_ALARM_H


25 
	#ZCL_ALARM_H


	)

48 #i‚de‡
ZCL_ALARM_TABLE_NUM


49 
	#ZCL_ALARM_TABLE_NUM
 5

	)

55 
	#ZCL_CMD_ALARM_RESET_ALARM
 0x00

	)

56 
	#ZCL_CMD_ALARM_RESET_ALL
 0x01

	)

57 
	#ZCL_CMD_ALARM_GET_ALARM
 0x02

	)

58 
	#ZCL_CMD_ALARM_RESET_ALARM_LOG
 0x03

	)

60 
	#ZCL_CMD_ALARM_ALARM
 0x00

	)

61 
	#ZCL_CMD_ALARM_GET_ALARM_RSP
 0x01

	)

67 
	#ZCL_ATTRID_ALARM_COUNT
 0x0000

	)

80 
u8
 
	mÆ¨mCode
;

81 
u16
 
	m˛u°îId
;

82 } 
	tª£tAœrm_t
;

88 
u8
 
	mÆ¨mCode
;

89 
u16
 
	m˛u°îId
;

90 } 
	tÆ¨m_t
;

96 
u8
 
	m°©us
;

97 
u8
 
	mÆ¨mCode
;

98 
u16
 
	m˛u°îId
;

99 
u32
 
	mtimeSèmp
;

100 } 
	tgëAœrmR•_t
;

108 
u8
 
	mÆ¨mCode
;

109 
u16
 
	m˛u°îId
;

110 
u32
 
	mtimeSèmp
;

111 } 
	tz˛_Æ¨mE¡ry_t
;

117 
u8
 
	mu£d
;

118 
u8
 
	mídpoöt
;

119 
z˛_Æ¨mE¡ry_t
 
	mÆ¨m
;

120 } 
	tz˛_Æ¨mTabÀ_t
;

125 
z˛_Æ¨mTabÀ_t
 
g_z˛_Æ¨mTab
[];

133 (*
	tz˛_Æ¨mRe£tAœrmCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tª£tAœrm_t
 *
	tcmd
);

134 (*
	tz˛_Æ¨mRe£tAŒCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

135 (*
	tz˛_Æ¨mGëAœrmCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

136 (*
	tz˛_Æ¨mRe£tAœrmLogCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

137 (*
	tz˛_Æ¨mRecvAœrmCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tÆ¨m_t
 *
	tcmd
);

138 (*
	tz˛_Æ¨mGëAœrmR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëAœrmR•_t
 *
	tcmd
);

144 
z˛_Æ¨mRe£tAœrmCb_t
 
Æ¨mRe£tCbFunc
;

145 
z˛_Æ¨mRe£tAŒCb_t
 
Æ¨mRe£tAŒCbFunc
;

146 
z˛_Æ¨mGëAœrmCb_t
 
Æ¨mGëAœrmCbFunc
;

147 
z˛_Æ¨mRe£tAœrmLogCb_t
 
Æ¨mRe£tLogCbFunc
;

148 
z˛_Æ¨mRecvAœrmCb_t
 
Æ¨mRecvAœrmCbFunc
;

149 
z˛_Æ¨mGëAœrmR•Cb_t
 
Æ¨mGëAœrmR•Func
;

150 } 
	tz˛_Æ¨m_AµCÆlbacks_t
;

162 
u16
 
z˛_©å_Æ¨mCou¡
;

167 c⁄° 
z˛AârInfo_t
 
Æ¨m_©åTbl
[];

169 c⁄° 
u8
 
z˛_Æ¨m_©åNum
;

186 
°©us_t
 
	`z˛_Æ¨m_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

200 
°©us_t
 
	`z˛_Æ¨m_Æ¨m
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Æ¨m_t
 *
pAœrm
);

201 
	#z˛_Æ¨m_Æ¨mCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Æ¨m_Æ¨m
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

214 
°©us_t
 
	`z˛_Æ¨m_ª£tAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ª£tAœrm_t
 *
pRe£tAœrm
);

215 
	#z˛_Æ¨m_ª£tAœrmCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Æ¨m_ª£tAœrm
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

227 
°©us_t
 
	`z˛_Æ¨m_ª£tAŒAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

228 
	#z˛_Æ¨m_ª£tAŒAœrmCmd
(
a
,
b
,
c
Ë(
	`z˛_Æ¨m_ª£tAŒAœrm
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

240 
°©us_t
 
	`z˛_Æ¨m_gëAœrm
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

241 
	#z˛_Æ¨m_gëAœrmCmd
(
a
,
b
,
c
Ë(
	`z˛_Æ¨m_gëAœrm
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

253 
°©us_t
 
	`z˛_Æ¨m_ª£tAœrmLog
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

254 
	#z˛_Æ¨m_ª£tAœrmLogCmd
(
a
,
b
,
c
Ë(
	`z˛_Æ¨m_ª£tAœrmLog
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

267 
°©us_t
 
	`z˛_Æ¨m_AddAœrmTab
(
u8
 
ídpoöt
, u8 
Æ¨mCode
, 
u16
 
˛u°îId
, 
u32
 
timeSèmp
);

	@zigbee/zcl/general/zcl_alarm_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_ALARMS


47 
u16
 
	gz˛_©å_Æ¨mCou¡
 = 0;

50 c⁄° 
z˛AârInfo_t
 
	gÆ¨m_©åTbl
[] =

52 #ifde‡
ZCL_ATTR_ALARM_COUNT_ENABLE


53 { 
ZCL_ATTRID_ALARM_COUNT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_Æ¨mCou¡
},

55 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

58 c⁄° 
u8
 
	gz˛_Æ¨m_©åNum
 = ( (
Æ¨m_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_basic.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_BASIC


49 
°©us_t
 
z˛_basic_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_basic_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_BASIC
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_basic_cmdH™dÀr
, 
cb
);

55 
	}
}

57 
_CODE_ZCL_
 
°©us_t
 
	$z˛_basic_ª£t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

59  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_BASIC
, 
ZCL_CMD_BASIC_RESET_FAC_DEFAULT
, 
TRUE
,

60 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

61 
	}
}

63 
_CODE_ZCL_
 
°©us_t
 
	$z˛_basic_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

65 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

67 
pInMsg
->
hdr
.
cmd
)

69 
ZCL_CMD_BASIC_RESET_FAC_DEFAULT
:

70 if(
pInMsg
->
˛u°îAµCb
){

71 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
), 
ZCL_CMD_BASIC_RESET_FAC_DEFAULT
, 
NULL
);

73 
°©us
 = 
ZCL_STA_FAILURE
;

77 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

81  
°©us
;

82 
	}
}

84 
_CODE_ZCL_
 
°©us_t
 
	$z˛_basic_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

86 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

87  
	`z˛_basic_˛õ¡CmdH™dÀr
(
pInMsg
);

89  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

91 
	}
}

	@zigbee/zcl/general/zcl_basic.h

24 #i‚de‡
ZCL_BASIC_H


25 
	#ZCL_BASIC_H


	)

48 
	#ZCL_CMD_BASIC_RESET_FAC_DEFAULT
 0x00

	)

55 
	#ZCL_ATTRID_BASIC_ZCL_VER
 0x0000

	)

56 
	#ZCL_ATTRID_BASIC_APP_VER
 0x0001

	)

57 
	#ZCL_ATTRID_BASIC_STACK_VER
 0x0002

	)

58 
	#ZCL_ATTRID_BASIC_HW_VER
 0x0003

	)

59 
	#ZCL_ATTRID_BASIC_MFR_NAME
 0x0004

	)

60 
	#ZCL_ATTRID_BASIC_MODEL_ID
 0x0005

	)

61 
	#ZCL_ATTRID_BASIC_DATE_CODE
 0x0006

	)

62 
	#ZCL_ATTRID_BASIC_POWER_SOURCE
 0x0007

	)

63 
	#ZCL_ATTRID_BASIC_LOC_DESC
 0x0010

	)

64 
	#ZCL_ATTRID_BASIC_PHY_ENV
 0x0011

	)

65 
	#ZCL_ATTRID_BASIC_DEV_ENABLED
 0x0012

	)

66 
	#ZCL_ATTRID_BASIC_ALARM_MASK
 0x0013

	)

67 
	#ZCL_ATTRID_BASIC_DISABLE_LOCAL_CFG
 0x0014

	)

68 
	#ZCL_ATTRID_BASIC_SW_BUILD_ID
 0x4000

	)

73 
	#POWER_SOURCE_UNKNOWN
 0x00

	)

74 
	#POWER_SOURCE_MAINS_1_PHASE
 0x01

	)

75 
	#POWER_SOURCE_MAINS_3_PHASE
 0x02

	)

76 
	#POWER_SOURCE_BATTERY
 0x03

	)

77 
	#POWER_SOURCE_DC
 0x04

	)

78 
	#POWER_SOURCE_EMERG_MAINS_CONST_PWR
 0x05

	)

79 
	#POWER_SOURCE_EMERG_MAINS_XFER_SW
 0x06

	)

84 
	#ZCL_BASIC_MAX_LENGTH
 24

	)

96 (*
	tz˛_r°FacDeÁu…Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

102 
z˛_r°FacDeÁu…Cb_t
 
r°FacDeÁu…CbFunc
;

103 } 
	tz˛_basic_AµCÆlbacks_t
;

115 c⁄° 
u8
 
z˛_©å_z˛Vî
;

116 c⁄° 
u8
 
z˛_©å_≠pVî
;

117 c⁄° 
u8
 
z˛_©å_°ackVî
;

118 c⁄° 
u8
 
z˛_©å_hwVî
;

119 c⁄° 
u8
 
z˛_©å_mfName
[];

120 c⁄° 
u8
 
z˛_©å_d©eCode
[];

121 c⁄° 
u8
 
z˛_©å_powîSrc
;

122 c⁄° 
u8
 
z˛_©å_swBuûdId
[];

123 
u8
 
z˛_©å_modñID
[];

124 
u8
 
z˛_©å_locDesc
[];

125 
u8
 
z˛_©å_phyEnv
;

126 
u8
 
z˛_©å_devE«bÀd
;

127 
u8
 
z˛_©å_Æ¨mMask
;

128 
u8
 
z˛_©å_loˇlCfg
;

133 c⁄° 
z˛AârInfo_t
 
basic_©åTbl
[];

135 c⁄° 
u8
 
z˛_basic_©åNum
;

154 
°©us_t
 
	`z˛_basic_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

168 
°©us_t
 
	`z˛_basic_ª£t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

169 
	#z˛_basic_ª£tFa˘‹yD·Cmd
(
a
,
b
,
c
Ë(
	`z˛_basic_ª£t
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

	@zigbee/zcl/general/zcl_basic_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

36 #i‚de‡
ZCL_BASIC_MFG_NAME


37 
	#ZCL_BASIC_MFG_NAME
 {6,'T','E','L','I','N','K'}

	)

39 #i‚de‡
ZCL_BASIC_MODEL_ID


40 
	#ZCL_BASIC_MODEL_ID
 {8,'T','L','S','R','8','2','6','x'}

	)

42 #i‚de‡
ZCL_BASIC_DATE_CODE


43 
	#ZCL_BASIC_DATE_CODE
 {8,'2','0','1','7','0','8','1','4'}

	)

45 #i‚de‡
ZCL_BASIC_LOC_DESC


46 
	#ZCL_BASIC_LOC_DESC
 {7,'U','N','K','N','O','W','N'}

	)

48 #i‚de‡
ZCL_BASIC_BUILD_ID


49 
	#ZCL_BASIC_BUILD_ID
 {10,'0','1','2','2','0','5','2','0','1','7'}

	)

59 #ifde‡
ZCL_BASIC


60 c⁄° 
u8
 
	gz˛_©å_z˛Vî
 = 3;

61 c⁄° 
u8
 
	gz˛_©å_≠pVî
 = 0;

62 c⁄° 
u8
 
	gz˛_©å_°ackVî
 = 2;

63 c⁄° 
u8
 
	gz˛_©å_hwVî
 = 0;

64 c⁄° 
u8
 
	gz˛_©å_mfName
[
ZCL_BASIC_MAX_LENGTH
] = 
ZCL_BASIC_MFG_NAME
;

65 c⁄° 
u8
 
	gz˛_©å_d©eCode
[
ZCL_BASIC_MAX_LENGTH
] = 
ZCL_BASIC_DATE_CODE
;

66 c⁄° 
u8
 
	gz˛_©å_swBuûdId
[
ZCL_BASIC_MAX_LENGTH
] = 
ZCL_BASIC_BUILD_ID
;

67 c⁄° 
u8
 
	gz˛_©å_powîSrc
 = 
POWER_SOURCE_MAINS_1_PHASE
;

68 
u8
 
	gz˛_©å_modñID
[
ZCL_BASIC_MAX_LENGTH
] = 
ZCL_BASIC_MODEL_ID
;

69 
u8
 
	gz˛_©å_locDesc
[
ZCL_BASIC_MAX_LENGTH
] = 
ZCL_BASIC_LOC_DESC
;

70 
u8
 
	gz˛_©å_phyEnv
 = 0;

71 
u8
 
	gz˛_©å_devE«bÀd
 = 1;

72 
u8
 
	gz˛_©å_Æ¨mMask
 = 0;

73 
u8
 
	gz˛_©å_loˇlCfg
 = 0;

77 c⁄° 
z˛AârInfo_t
 
	gbasic_©åTbl
[] =

79 #ifde‡
ZCL_ATTR_VERSION_ENABLE


80 { 
ZCL_ATTRID_BASIC_ZCL_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_z˛Vî
},

82 #ifde‡
ZCL_ATTR_APPLICATION_VERSION_ENABLE


83 { 
ZCL_ATTRID_BASIC_APP_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_≠pVî
},

85 #ifde‡
ZCL_ATTR_STACK_VERSION_ENABLE


86 { 
ZCL_ATTRID_BASIC_STACK_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_°ackVî
},

88 #ifde‡
ZCL_ATTR_HW_VERSION_ENABLE


89 { 
ZCL_ATTRID_BASIC_HW_VER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_hwVî
},

91 #ifde‡
ZCL_ATTR_MANUFACTURER_NAME_ENABLE


92 { 
ZCL_ATTRID_BASIC_MFR_NAME
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mfName
},

94 #ifde‡
ZCL_ATTR_MODEL_IDENTIFIER_ENABLE


95 { 
ZCL_ATTRID_BASIC_MODEL_ID
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_modñID
},

97 #ifde‡
ZCL_ATTR_DATE_CODE_ENABLE


98 { 
ZCL_ATTRID_BASIC_DATE_CODE
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_d©eCode
},

100 #ifde‡
ZCL_ATTR_POWER_SOURCE_ENABLE


101 { 
ZCL_ATTRID_BASIC_POWER_SOURCE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_powîSrc
},

103 #ifde‡
ZCL_ATTR_LOC_DESC_ENABLE


104 { 
ZCL_ATTRID_BASIC_LOC_DESC
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_locDesc
},

106 #ifde‡
ZCL_ATTR_PHY_ENV_ENABLE


107 { 
ZCL_ATTRID_BASIC_PHY_ENV
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_phyEnv
},

109 #ifde‡
ZCL_ATTR_DEV_ENABLED_ENABLE


110 { 
ZCL_ATTRID_BASIC_DEV_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_devE«bÀd
},

112 #ifde‡
ZCL_ATTR_ALARM_MASK_ENABLE


113 { 
ZCL_ATTRID_BASIC_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Æ¨mMask
},

115 #ifde‡
ZCL_ATTR_DISABLE_LOCAL_CFG_ENABLE


116 { 
ZCL_ATTRID_BASIC_DISABLE_LOCAL_CFG
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_loˇlCfg
},

118 #ifde‡
ZCL_ATTR_SW_BUILD_ID


119 { 
ZCL_ATTRID_BASIC_SW_BUILD_ID
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_swBuûdId
},

121 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

124 c⁄° 
u8
 
	gz˛_basic_©åNum
 = ( (
basic_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_binary_input.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_BINARY_INPUT


50 
_CODE_ZCL_
 
°©us_t
 
	$z˛_bö¨y_öput_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

52  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_BINARY_INPUT_BASIC
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

53 
	}
}

	@zigbee/zcl/general/zcl_binary_input.h

24 #i‚de‡
ZCL_BINARY_INPUT_H


25 
	#ZCL_BINARY_INPUT_H


	)

36 
	#ZCL_BINARY_INPUT_ATTRID_ACTIVE_TEXT
 0x0004

	)

37 
	#ZCL_BINARY_INPUT_ATTRID_DESCRIPTION
 0x001C

	)

38 
	#ZCL_BINARY_INPUT_ATTRID_INACTIVE_TEXT
 0x002E

	)

39 
	#ZCL_BINARY_INPUT_ATTRID_OUT_OF_SERVICE
 0x0051

	)

40 
	#ZCL_BINARY_INPUT_ATTRID_POLARITY
 0x0054

	)

41 
	#ZCL_BINARY_INPUT_ATTRID_PRESENT_VALUE
 0x0055

	)

42 
	#ZCL_BINARY_INPUT_ATTRID_RELIABILITY
 0x0067

	)

43 
	#ZCL_BINARY_INPUT_ATTRID_STATUS_FLAGS
 0x006F

	)

44 
	#ZCL_BINARY_INPUT_ATTRID_APP_TYPE
 0x0100

	)

49 
	#ZCL_BINARY_INPUT_MAX_LENGTH
 24

	)

52 #ifde‡
ZCL_BINARY_INPUT_ATTR_ACTIVE_TEXT_ENABLE


53 
u8
 
z˛_©å_böI≈ut_a˘iveText
[];

55 #ifde‡
ZCL_BINARY_INPUT_ATTR_DESCRIPTIONT_ENABLE


56 
u8
 
z˛_©å_böI≈ut_des¸ùti⁄
[];

58 #ifde‡
ZCL_BINARY_INPUT_ATTR_INACTIVE_TEXT_ENABLE


59 
u8
 
z˛_©å_böI≈ut_öa˘iveText
[];

61 #ifde‡
ZCL_BINARY_INPUT_ATTR_OUT_OF_SERVICE_ENABLE


62 
boﬁ
 
z˛_©å_böI≈ut_outOfSîvi˚
;

64 #ifde‡
ZCL_BINARY_INPUT_ATTR_POLARITY_ENABLE


65 
u8
 
z˛_©å_böI≈ut_pﬁ¨ôy
;

67 #ifde‡
ZCL_BINARY_INPUT_ATTR_PRESENT_VALUE_ENABLE


68 
boﬁ
 
z˛_©å_böI≈ut_¥e£¡VÆue
;

70 #ifde‡
ZCL_BINARY_INPUT_ATTR_RELIABILITY_ENABLE


71 
u8
 
z˛_©å_böI≈ut_ªlübûôy
;

73 #ifde‡
ZCL_BINARY_INPUT_ATTR_STATUS_FLAGS_ENABLE


74 
u8
 
z˛_©å_böI≈ut_°©usFœgs
;

76 #ifde‡
ZCL_BINARY_INPUT_ATTR_APP_TYPE_ENABLE


77 
u32
 
z˛_©å_böI≈ut_≠pTy≥
;

80 c⁄° 
z˛AârInfo_t
 
bö¨y_öput_©åTbl
[];

81 c⁄° 
u8
 
z˛_bö¨y_öput_©åNum
;

85 
°©us_t
 
z˛_bö¨y_öput_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_binary_input_attr.c

29 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_BINARY_INPUT


47 #ifde‡
ZCL_BINARY_INPUT_ATTR_ACTIVE_TEXT_ENABLE


48 
u8
 
	gz˛_©å_böI≈ut_a˘iveText
[
ZCL_BINARY_INPUT_MAX_LENGTH
] = {0};

50 #ifde‡
ZCL_BINARY_INPUT_ATTR_DESCRIPTIONT_ENABLE


51 
u8
 
	gz˛_©å_böI≈ut_des¸ùti⁄
[
ZCL_BINARY_INPUT_MAX_LENGTH
] = {0};

53 #ifde‡
ZCL_BINARY_INPUT_ATTR_INACTIVE_TEXT_ENABLE


54 
u8
 
	gz˛_©å_böI≈ut_öa˘iveText
[
ZCL_BINARY_INPUT_MAX_LENGTH
] = {0};

56 #ifde‡
ZCL_BINARY_INPUT_ATTR_OUT_OF_SERVICE_ENABLE


57 
boﬁ
 
	gz˛_©å_böI≈ut_outOfSîvi˚
 = 
FALSE
;

59 #ifde‡
ZCL_BINARY_INPUT_ATTR_POLARITY_ENABLE


60 
u8
 
	gz˛_©å_böI≈ut_pﬁ¨ôy
 = 0;

62 #ifde‡
ZCL_BINARY_INPUT_ATTR_PRESENT_VALUE_ENABLE


63 
boﬁ
 
	gz˛_©å_böI≈ut_¥e£¡VÆue
 = 0;

65 #ifde‡
ZCL_BINARY_INPUT_ATTR_RELIABILITY_ENABLE


66 
u8
 
	gz˛_©å_böI≈ut_ªlübûôy
 = 0;

68 #ifde‡
ZCL_BINARY_INPUT_ATTR_STATUS_FLAGS_ENABLE


69 
u8
 
	gz˛_©å_böI≈ut_°©usFœgs
 = 0;

71 #ifde‡
ZCL_BINARY_INPUT_ATTR_APP_TYPE_ENABLE


72 
u32
 
	gz˛_©å_böI≈ut_≠pTy≥
 = 0;

75 c⁄° 
z˛AârInfo_t
 
	gbö¨y_öput_©åTbl
[] =

77 #ifde‡
ZCL_BINARY_INPUT_ATTR_ACTIVE_TEXT_ENABLE


78 { 
ZCL_BINARY_INPUT_ATTRID_ACTIVE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böI≈ut_a˘iveText
},

80 #ifde‡
ZCL_BINARY_INPUT_ATTR_DESCRIPTIONT_ENABLE


81 { 
ZCL_BINARY_INPUT_ATTRID_DESCRIPTION
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böI≈ut_des¸ùti⁄
},

83 #ifde‡
ZCL_BINARY_INPUT_ATTR_INACTIVE_TEXT_ENABLE


84 { 
ZCL_BINARY_INPUT_ATTRID_INACTIVE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böI≈ut_öa˘iveText
},

86 #ifde‡
ZCL_BINARY_INPUT_ATTR_OUT_OF_SERVICE_ENABLE


87 { 
ZCL_BINARY_INPUT_ATTRID_OUT_OF_SERVICE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böI≈ut_outOfSîvi˚
},

89 #ifde‡
ZZCL_BINARY_INPUT_ATTR_POLARITY_ENABLE


90 { 
ZCL_BINARY_INPUT_ATTRID_POLARITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böI≈ut_pﬁ¨ôy
},

92 #ifde‡
ZCL_BINARY_INPUT_ATTR_PRESENT_VALUE_ENABLE


93 { 
ZCL_BINARY_INPUT_ATTRID_PRESENT_VALUE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böI≈ut_¥e£¡VÆue
},

95 #ifde‡
ZCL_BINARY_INPUT_ATTR_RELIABILITY_ENABLE


96 { 
ZCL_BINARY_INPUT_ATTRID_RELIABILITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böI≈ut_ªlübûôy
},

98 #ifde‡
ZCL_BINARY_INPUT_ATTR_STATUS_FLAGS_ENABLE


99 { 
ZCL_BINARY_INPUT_ATTRID_STATUS_FLAGS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böI≈ut_°©usFœgs
},

101 #ifde‡
ZCL_BINARY_INPUT_ATTR_APP_TYPE_ENABLE


102 { 
ZCL_BINARY_INPUT_ATTRID_APP_TYPE
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böI≈ut_≠pTy≥
},

104 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

107 c⁄° 
u8
 
	gz˛_bö¨y_öput_©åNum
 = ( (
bö¨y_öput_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_binary_output.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_BINARY_OUTPUT


50 
_CODE_ZCL_
 
°©us_t
 
	$z˛_bö¨y_ouçut_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

52  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_BINARY_OUTPUT_BASIC
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

53 
	}
}

	@zigbee/zcl/general/zcl_binary_output.h

24 #i‚de‡
ZCL_BINARY_OUTPUT_H


25 
	#ZCL_BINARY_OUTPUT_H


	)

36 
	#ZCL_BINARY_OUTPUT_ATTRID_ACTIVE_TEXT
 0x0004

	)

37 
	#ZCL_BINARY_OUTPUT_ATTRID_DESCRIPTION
 0x001C

	)

38 
	#ZCL_BINARY_OUTPUT_ATTRID_INACTIVE_TEXT
 0x002E

	)

39 
	#ZCL_BINARY_OUTPUT_ATTRID_MIN_OFF_TIME
 0x0042

	)

40 
	#ZCL_BINARY_OUTPUT_ATTRID_MIN_ON_TIME
 0x0043

	)

41 
	#ZCL_BINARY_OUTPUT_ATTRID_OUT_OF_SERVICE
 0x0051

	)

42 
	#ZCL_BINARY_OUTPUT_ATTRID_POLARITY
 0x0054

	)

43 
	#ZCL_BINARY_OUTPUT_ATTRID_PRESENT_VALUE
 0x0055

	)

44 
	#ZCL_BINARY_OUTPUT_ATTRID_PRIORITY_ARRAY
 0x0057

	)

45 
	#ZCL_BINARY_OUTPUT_ATTRID_RELIABLILITY
 0x0067

	)

46 
	#ZCL_BINARY_OUTPUT_ATTRID_RELINQUISH_DEFAULT
 0x0068

	)

47 
	#ZCL_BINARY_OUTPUT_ATTRID_STATUS_FLAGS
 0x006F

	)

48 
	#ZCL_BINARY_OUTPUT_ATTRID_APP_TYPE
 0x0100

	)

53 
	#ZCL_BINARY_OUTPUT_MAX_LENGTH
 24

	)

60 
boﬁ
 
	m¥i‹ôy1
;

61 
boﬁ
 
	m¥i‹ôy2
;

62 } 
	tz˛_böOuçut_¥i‹ôyAºay_t
;

65 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_ACTIVE_TEXT_ENABLE


66 
u8
 
z˛_©å_böOuçut_a˘iveText
[];

68 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_DESCRIPTIONT_ENABLE


69 
u8
 
z˛_©å_böOuçut_des¸ùti⁄
[];

71 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_INACTIVE_TEXT_ENABLE


72 
u8
 
z˛_©å_böOuçut_öa˘iveText
[];

74 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_OFF_TIME_ENABLE


75 
u32
 
z˛_©å_böOuçut_möOffTime
;

77 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_ON_TIME_ENABLE


78 
u32
 
z˛_©å_böOuçut_möOnTime
;

80 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_OUT_OF_SERVICE_ENABLE


81 
boﬁ
 
z˛_©år_böOuçut_outOfSîvi˚
;

83 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_POLARITY_ENABLE


84 
u8
 
z˛_©å_böOuçut_pﬁ¨ôy
;

86 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRESENT_VALUE_ENABLE


87 
boﬁ
 
z˛_©å_böOuçut_¥e£¡VÆue
;

89 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRIORITY_ARRAY_ENABLE


90 
z˛_böOuçut_¥i‹ôyAºay_t
 
z˛_©å_böOuçut_¥i‹ôyAºay
[];

92 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELIABILITY_ENABLE


93 
u8
 
z˛_©å_böOuçut_ªlübûôy
;

95 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENABLE


96 
boﬁ
 
z˛_©å_böOuçut_ªlöquishDeÁu…
;

98 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_STATUS_FLAGS_ENABLE


99 
u8
 
z˛_©å_böOuçut_°©usFœgs
;

101 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_APP_TYPE_ENABLE


102 
u32
 
z˛_©å_böOuçut_≠pTy≥
;

105 c⁄° 
z˛AârInfo_t
 
bö¨y_ouçut_©åTbl
[];

106 c⁄° 
u8
 
z˛_bö¨y_ouçut_©åNum
;

110 
°©us_t
 
z˛_bö¨y_ouçut_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_binary_output_attr.c

29 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_BINARY_OUTPUT


48 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_ACTIVE_TEXT_ENABLE


49 c⁄° 
u8
 
	gz˛_©å_böOuçut_a˘iveText
[
ZCL_BINARY_OUTPUT_MAX_LENGTH
] = {0};

51 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_DESCRIPTIONT_ENABLE


52 c⁄° 
u8
 
	gz˛_©å_böOuçut_des¸ùti⁄
[
ZCL_BINARY_OUTPUT_MAX_LENGTH
] = {0};

54 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_INACTIVE_TEXT_ENABLE


55 c⁄° 
u8
 
	gz˛_©å_böOuçut_öa˘iveText
[
ZCL_BINARY_OUTPUT_MAX_LENGTH
] = {0};

57 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_OFF_TIME_ENABLE


58 
u32
 
	gz˛_©å_böOuçut_möOffTime
 = 0xFFFFFFFF;

60 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_ON_TIME_ENABLE


61 
u32
 
	gz˛_©å_böOuçut_möOnTime
 = 0xFFFFFFFF;

63 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_OUT_OF_SERVICE_ENABLE


64 
boﬁ
 
	gz˛_©år_böOuçut_outOfSîvi˚
 = 
FALSE
;

66 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_POLARITY_ENABLE


67 
u8
 
	gz˛_©å_böOuçut_pﬁ¨ôy
 = 0;

69 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRESENT_VALUE_ENABLE


70 
boﬁ
 
	gz˛_©å_böOuçut_¥e£¡VÆue
 = 0;

72 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRIORITY_ARRAY_ENABLE


73 
z˛_böOuçut_¥i‹ôyAºay_t
 
	gz˛_©å_böOuçut_¥i‹ôyAºay
[16] = {0};

75 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELIABILITY_ENABLE


76 
u8
 
	gz˛_©å_böOuçut_ªlübûôy
 = 0;

78 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENABLE


79 
boﬁ
 
	gz˛_©å_böOuçut_ªlöquishDeÁu…
 = 0;

81 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_STATUS_FLAGS_ENABLE


82 
u8
 
	gz˛_©å_böOuçut_°©usFœgs
 = 0;

84 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_APP_TYPE_ENABLE


85 
u32
 
	gz˛_©å_böOuçut_≠pTy≥
 = 0;

88 c⁄° 
z˛AârInfo_t
 
	gbö¨y_ouçut_©åTbl
[] =

90 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_ACTIVE_TEXT_ENABLE


91 { 
ZCL_BINARY_OUTPUT_ATTRID_ACTIVE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böOuçut_a˘iveText
},

93 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_DESCRIPTIONT_ENABLE


94 { 
ZCL_BINARY_OUTPUT_ATTRID_DESCRIPTION
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böOuçut_des¸ùti⁄
},

96 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_INACTIVE_TEXT_ENABLE


97 { 
ZCL_BINARY_OUTPUT_ATTRID_INACTIVE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böOuçut_öa˘iveText
},

99 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_OFF_TIME_ENABLE


100 { 
ZCL_BINARY_OUTPUT_ATTRID_MIN_OFF_TIME
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böOuçut_möOffTime
},

102 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_MIN_ON_TIME_ENABLE


103 { 
ZCL_BINARY_OUTPUT_ATTRID_MIN_ON_TIME
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böOuçut_möOnTime
},

105 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_OUT_OF_SERVICE_ENABLE


106 { 
ZCL_BINARY_OUTPUT_ATTRID_OUT_OF_SERVICE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©år_böOuçut_outOfSîvi˚
},

108 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_POLARITY_ENABLE


109 { 
ZCL_BINARY_OUTPUT_ATTRID_POLARITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böOuçut_pﬁ¨ôy
},

111 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRESENT_VALUE_ENABLE


112 { 
ZCL_BINARY_OUTPUT_ATTRID_PRESENT_VALUE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böOuçut_¥e£¡VÆue
},

114 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_PRIORITY_ARRAY_ENABLE


115 { 
ZCL_BINARY_OUTPUT_ATTRID_PRIORITY_ARRAY
, 
ZCL_DATA_TYPE_ARRAY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_böOuçut_¥i‹ôyAºay
},

117 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELIABILITY_ENABLE


118 { 
ZCL_BINARY_OUTPUT_ATTRID_RELIABLILITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böOuçut_ªlübûôy
},

120 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENABLE


121 { 
ZCL_BINARY_OUTPUT_ATTRID_RELINQUISH_DEFAULT
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_böOuçut_ªlöquishDeÁu…
},

123 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_STATUS_FLAGS_ENABLE


124 { 
ZCL_BINARY_OUTPUT_ATTRID_STATUS_FLAGS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böOuçut_°©usFœgs
},

126 #ifde‡
ZCL_BINARY_OUTPUT_ATTR_APP_TYPE_ENABLE


127 { 
ZCL_BINARY_OUTPUT_ATTRID_APP_TYPE
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_böOuçut_≠pTy≥
},

129 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

132 c⁄° 
u8
 
	gz˛_bö¨y_ouçut_©åNum
 = ( (
bö¨y_ouçut_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_devTemperatureCfg.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_DEV_TEMPERATURE_CFG


48 
_CODE_ZCL_
 
°©us_t
 
	$z˛_devTem≥øtuªCfg_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

50  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_DEVICE_TEMP_CONFIG
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

51 
	}
}

	@zigbee/zcl/general/zcl_devTemperatureCfg.h

24 #i‚de‡
ZCL_DEV_TEMP_CFG_H


25 
	#ZCL_DEV_TEMP_CFG_H


	)

48 
	#ZCL_ATTRID_DEV_TEMP_CURR_TEMP
 0x0000

	)

49 
	#ZCL_ATTRID_DEV_TEMP_MIN_TEMP_EXP
 0x0001

	)

50 
	#ZCL_ATTRID_DEV_TEMP_MAX_TEMP_EXP
 0x0002

	)

51 
	#ZCL_ATTRID_DEV_TEMP_OVER_TEMP_TOTAL
 0x0003

	)

52 
	#ZCL_ATTRID_DEV_TEMP_ALARM_MASK
 0x0010

	)

53 
	#ZCL_ATTRID_DEV_TEMP_LOW_THRE
 0x0011

	)

54 
	#ZCL_ATTRID_DEV_TEMP_HIGHT_THRE
 0x0012

	)

55 
	#ZCL_ATTRID_DEV_TEMP_LOW_TRIP
 0x0013

	)

56 
	#ZCL_ATTRID_DEV_TEMP_HIGHT_TRIP
 0x0014

	)

71 
s16
 
z˛_©å_curTemp
;

72 
s16
 
z˛_©å_möTempExp
;

73 
s16
 
z˛_©å_maxTempExp
;

74 
u16
 
z˛_©å_ovîTempTŸÆ
;

75 
u8
 
z˛_©å_ãmpAœrmMask
;

76 
s16
 
z˛_©å_lowTempThªshﬁd
;

77 
s16
 
z˛_©å_highTempThªshﬁd
;

78 
u24
 
z˛_©å_lowTrùPoöt
;

79 
u24
 
z˛_©å_highTrùPoöt
;

84 c⁄° 
z˛AârInfo_t
 
dev_ãmp_cfg_©åTbl
[];

86 c⁄° 
u8
 
z˛_dev_ãmp_cfg_©åNum
;

105 
°©us_t
 
z˛_devTem≥øtuªCfg_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_devTemperatureCfg_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

47 #ifde‡
ZCL_DEV_TEMPERATURE_CFG


48 
s16
 
	gz˛_©å_curTemp
 = 0;

49 
s16
 
	gz˛_©å_möTempExp
 = -199;

50 
s16
 
	gz˛_©å_maxTempExp
 = 200;

51 
u16
 
	gz˛_©å_ovîTempTŸÆ
 = 0;

52 
u8
 
	gz˛_©å_ãmpAœrmMask
 = 0;

53 
s16
 
	gz˛_©å_lowTempThªshﬁd
 = -199;

54 
s16
 
	gz˛_©å_highTempThªshﬁd
 = 200;

55 
u24
 
	gz˛_©å_lowTrùPoöt
 = 0x000001;

56 
u24
 
	gz˛_©å_highTrùPoöt
 = 0x000001;

59 c⁄° 
z˛AârInfo_t
 
	gdev_ãmp_cfg_©åTbl
[] =

61 #ifde‡
ZCL_ATTR_CUTTRNT_TEMP_ENABLE


62 { 
ZCL_ATTRID_DEV_TEMP_CURR_TEMP
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_curTemp
},

64 #ifde‡
ZCL_ATTR_MIN_TEMP_EXP_ENABLE


65 { 
ZCL_ATTRID_DEV_TEMP_MIN_TEMP_EXP
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_möTempExp
},

67 #ifde‡
ZCL_ATTR_MAX_TEMP_EXP_ENABLE


68 { 
ZCL_ATTRID_DEV_TEMP_MAX_TEMP_EXP
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_maxTempExp
},

70 #ifde‡
ZCL_ATTR_OVER_TEMP_TOTAL_ENABLE


71 { 
ZCL_ATTRID_DEV_TEMP_OVER_TEMP_TOTAL
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ovîTempTŸÆ
},

73 #ifde‡
ZCL_ATTR_OVER_DEV_TEMP_ALARM_MASK_ENABLE


74 { 
ZCL_ATTRID_DEV_TEMP_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_ãmpAœrmMask
},

76 #ifde‡
ZCL_ATTR_OVER_LOW_TEMP_THRESHOLD_ENABLE


77 { 
ZCL_ATTRID_DEV_TEMP_LOW_THRE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lowTempThªshﬁd
},

79 #ifde‡
ZCL_ATTR_OVER_HIGH_TEMP_THERSHOLD_ENABLE


80 { 
ZCL_ATTRID_DEV_TEMP_HIGHT_THRE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_highTempThªshﬁd
},

82 #ifde‡
ZCL_ATTR_OVER_LOW_TEMP_TRIP_ENABLE


83 { 
ZCL_ATTRID_DEV_TEMP_LOW_TRIP
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lowTrùPoöt
},

85 #ifde‡
ZCL_ATTR_OVER_HIGH_TEMP_TRIP_ENABLE


86 { 
ZCL_ATTRID_DEV_TEMP_HIGHT_TRIP
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_highTrùPoöt
},

88 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

91 c⁄° 
u8
 
	gz˛_dev_ãmp_cfg_©åNum
 = ( (
dev_ãmp_cfg_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_diagnostics.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_DIAGNOSTICS


49 
_CODE_ZCL_
 
°©us_t
 
	$z˛_dügno°ics_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

51  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_DIAGNOSTICS
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

52 
	}
}

	@zigbee/zcl/general/zcl_diagnostics.h

24 #i‚de‡
ZCL_DIAGNOSTICS_H


25 
	#ZCL_DIAGNOSTICS_H


	)

32 
	#ZCL_DIAGNOSTICS_ATTRID_NUMBER_OF_RESETS
 0x0000

	)

33 
	#ZCL_DIAGNOSTICS_ATTRID_PERSISTENT_MEMORY_WRITES
 0x0001

	)

34 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_RX_BCAST
 0x0100

	)

35 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_TX_BCAST
 0x0101

	)

36 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_RX_UCAST
 0x0102

	)

37 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST
 0x0103

	)

38 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST_RETRY
 0x0104

	)

39 
	#ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST_FAIL
 0x0105

	)

40 
	#ZCL_DIAGNOSTICS_ATTRID_APS_RX_BCAST
 0x0106

	)

41 
	#ZCL_DIAGNOSTICS_ATTRID_APS_TX_BCAST
 0x0107

	)

42 
	#ZCL_DIAGNOSTICS_ATTRID_APS_RX_UCAST
 0x0108

	)

43 
	#ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_SUCCESS
 0x0109

	)

44 
	#ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_RETRY
 0x010A

	)

45 
	#ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_FAIL
 0x010B

	)

46 
	#ZCL_DIAGNOSTICS_ATTRID_ROUTE_DISC_INITIATED
 0x010C

	)

47 
	#ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_ADDED
 0x010D

	)

48 
	#ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_REMOVED
 0x010E

	)

49 
	#ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_STALE
 0x010F

	)

50 
	#ZCL_DIAGNOSTICS_ATTRID_JOIN_INDICATION
 0x0110

	)

51 
	#ZCL_DIAGNOSTICS_ATTRID_CHILD_MOVED
 0x0111

	)

52 
	#ZCL_DIAGNOSTICS_ATTRID_NWK_FC_FAILURE
 0x0112

	)

53 
	#ZCL_DIAGNOSTICS_ATTRID_APS_FC_FAILURE
 0x0113

	)

54 
	#ZCL_DIAGNOSTICS_ATTRID_APS_UNAUTHORIZED_KEY
 0x0114

	)

55 
	#ZCL_DIAGNOSTICS_ATTRID_NWK_DECRYPT_FAILURES
 0x0115

	)

56 
	#ZCL_DIAGNOSTICS_ATTRID_APS_DECRYPT_FAILURES
 0x0116

	)

57 
	#ZCL_DIAGNOSTICS_ATTRID_PACKET_BUFFER_ALLOCATE_FAILURES
 0x0117

	)

58 
	#ZCL_DIAGNOSTICS_ATTRID_RELAYED_UCAST
 0x0118

	)

59 
	#ZCL_DIAGNOSTICS_ATTRID_PHY_TO_MAC_QUEUE_LIMITREACHED
 0x0119

	)

60 
	#ZCL_DIAGNOSTICS_ATTRID_PACKET_VALIDATE_DROP_COUNT
 0x011A

	)

61 
	#ZCL_DIAGNOSTICS_ATTRID_AVERAGE_MAC_RETRY_PER_APS_MESSAGE_SENT
 0x011B

	)

62 
	#ZCL_DIAGNOSTICS_ATTRID_LAST_MESSAGE_LQI
 0x011C

	)

63 
	#ZCL_DIAGNOSTICS_ATTRID_LAST_MESSAGE_RSSI
 0x011D

	)

72 c⁄° 
z˛AârInfo_t
 
dügno°ics_©åTbl
[];

73 c⁄° 
u8
 
z˛_dügno°ics_©åNum
;

77 
°©us_t
 
z˛_dügno°ics_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_diagnostics_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_DIAGNOSTICS


49 #ifde‡
ZCL_ATTR_AVERAGE_MAC_RETRY_PER_APS_MESSAGE_SENT_ENABLE


50 
u16
 
	gz˛_©å_avîageMACRëryPîAPSMesßgeSít
 = 0;

54 c⁄° 
z˛AârInfo_t
 
	gdügno°ics_©åTbl
[] =

56 #ifde‡
ZCL_ATTR_NUMBER_OF_RESETS_ENABLE


57 {
ZCL_DIAGNOSTICS_ATTRID_NUMBER_OF_RESETS
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
numbîOfRe£ts
 },

59 #ifde‡
ZCL_ATTR_PERSISTENT_MEMORY_WRITES_ENABLE


60 {
ZCL_DIAGNOSTICS_ATTRID_PERSISTENT_MEMORY_WRITES
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≥rsi°ítMem‹yWrôes
 },

62 #ifde‡
ZCL_ATTR_MAC_RX_BCAST_ENABLE


63 {
ZCL_DIAGNOSTICS_ATTRID_MAC_RX_BCAST
 , 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macRxBˇ°
 },

65 #ifde‡
ZCL_ATTR_MAC_TX_BCAST_ENABLE


66 {
ZCL_DIAGNOSTICS_ATTRID_MAC_TX_BCAST
 , 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macTxBˇ°
 },

68 #ifde‡
ZCL_ATTR_MAC_RX_UCAST_ENABLE


69 {
ZCL_DIAGNOSTICS_ATTRID_MAC_RX_UCAST
 , 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macRxUˇ°
 },

71 #ifde‡
ZCL_ATTR_MAC_TX_UCAST_ENABLE


72 {
ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST
 , 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macTxUˇ°
 },

74 #ifde‡
ZCL_ATTR_MAC_TX_UCAST_RETRY_ENABLE


75 {
ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST_RETRY
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macTxUˇ°Rëry
 },

77 #ifde‡
ZCL_ATTR_MAC_TX_UCAST_FAIL_ENABLE


78 {
ZCL_DIAGNOSTICS_ATTRID_MAC_TX_UCAST_FAIL
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
macTxUˇ°Faû
 },

80 #ifde‡
ZCL_ATTR_APS_RX_BCAST_ENABLE


81 {
ZCL_DIAGNOSTICS_ATTRID_APS_RX_BCAST
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sRxBˇ°
 },

83 #ifde‡
ZCL_ATTR_APS_TX_BCAST_ENABLE


84 {
ZCL_DIAGNOSTICS_ATTRID_APS_TX_BCAST
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sTxBˇ°
 },

86 #ifde‡
ZCL_ATTR_APS_RX_UCAST_ENABLE


87 {
ZCL_DIAGNOSTICS_ATTRID_APS_RX_UCAST
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sRxUˇ°
 },

89 #ifde‡
ZCL_ATTR_APS_TX_UCAST_SUCCESS_ENABLE


90 {
ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_SUCCESS
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sTxUˇ°Suc˚ss
 },

92 #ifde‡
ZCL_ATTR_APS_TX_UCAST_RETRY_ENABLE


93 {
ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_RETRY
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sTxUˇ°Rëry
 },

95 #ifde‡
ZCL_ATTR_APS_TX_UCAST_FAIL_ENABLE


96 {
ZCL_DIAGNOSTICS_ATTRID_APS_TX_UCAST_FAIL
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sTxUˇ°Faû
 },

98 #ifde‡
ZCL_ATTR_ROUTE_DISC_INITIATED_ENABLE


99 {
ZCL_DIAGNOSTICS_ATTRID_ROUTE_DISC_INITIATED
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
rouãDiscInôüãd
 },

101 #ifde‡
ZCL_ATTR_NEIGHBOR_ADDED_ENABLE


102 {
ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_ADDED
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
√ighb‹Added
 },

104 #ifde‡
ZCL_ATTR_NEIGHBOR_REMOVED_ENABLE


105 {
ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_REMOVED
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
√ighb‹Removed
 },

107 #ifde‡
ZCL_ATTR_NEIGHBOR_STALE_ENABLE


108 {
ZCL_DIAGNOSTICS_ATTRID_NEIGHBOR_STALE
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
√ighb‹SèÀ
 },

110 #ifde‡
ZCL_ATTR_JOIN_INDICATION_ENABLE


111 {
ZCL_DIAGNOSTICS_ATTRID_JOIN_INDICATION
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
joöIndiˇti⁄
 },

113 #ifde‡
ZCL_ATTR_CHILD_MOVED_ENABLE


114 {
ZCL_DIAGNOSTICS_ATTRID_CHILD_MOVED
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
chûdMoved
 },

116 #ifde‡
ZCL_ATTR_NWK_FC_FAILURE_ENABLE


117 {
ZCL_DIAGNOSTICS_ATTRID_NWK_FC_FAILURE
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
nwkFCFaûuª
 },

119 #ifde‡
ZCL_ATTR_APS_FC_FAILURE_ENABLE


120 {
ZCL_DIAGNOSTICS_ATTRID_APS_FC_FAILURE
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sFCFaûuª
 },

122 #ifde‡
ZCL_ATTR_APS_UNAUTHORIZED_KEY_ENABLE


123 {
ZCL_DIAGNOSTICS_ATTRID_APS_UNAUTHORIZED_KEY
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sU«uth‹izedKey
 },

125 #ifde‡
ZCL_ATTR_NWK_DECRYPT_FAILURES_ENABLE


126 {
ZCL_DIAGNOSTICS_ATTRID_NWK_DECRYPT_FAILURES
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
nwkDe¸y±Faûuªs
 },

128 #ifde‡
ZCL_ATTR_APS_DECRYPT_FAILURES_ENABLE


129 {
ZCL_DIAGNOSTICS_ATTRID_APS_DECRYPT_FAILURES
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
≠sDe¸y±Faûuªs
 },

131 #ifde‡
ZCL_ATTR_PACKET_BUFFER_ALLOCATE_FAILURES_ENABLE


132 {
ZCL_DIAGNOSTICS_ATTRID_PACKET_BUFFER_ALLOCATE_FAILURES
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
∑ckëBuf„rAŒoˇãFaûuªs
 },

134 #ifde‡
ZCL_ATTR_RELAYED_UCAST_ENABLE


135 {
ZCL_DIAGNOSTICS_ATTRID_RELAYED_UCAST
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
ªœyedUˇ°
 },

137 #ifde‡
ZCL_ATTR_PHY_TO_MAC_QUEUE_LIMITREACHED_ENABLE


138 {
ZCL_DIAGNOSTICS_ATTRID_PHY_TO_MAC_QUEUE_LIMITREACHED
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
phytoMACqueuñimôªached
 },

140 #ifde‡
ZCL_ATTR_PACKET_VALIDATE_DROP_COUNT_ENABLE


141 {
ZCL_DIAGNOSTICS_ATTRID_PACKET_VALIDATE_DROP_COUNT
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
∑ckëVÆid©eDr›Cou¡
 },

143 #ifde‡
ZCL_ATTR_AVERAGE_MAC_RETRY_PER_APS_MESSAGE_SENT_ENABLE


144 {
ZCL_DIAGNOSTICS_ATTRID_AVERAGE_MAC_RETRY_PER_APS_MESSAGE_SENT
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_avîageMACRëryPîAPSMesßgeSít
 },

146 #ifde‡
ZCL_ATTR_LAST_MESSAGE_LQI_ENABLE


147 {
ZCL_DIAGNOSTICS_ATTRID_LAST_MESSAGE_LQI
 , 
ZCL_DATA_TYPE_UINT8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
œ°MesßgeLQI
 },

149 #ifde‡
ZCL_ATTR_LAST_MESSAGE_RSSI_ENABLE


150 {
ZCL_DIAGNOSTICS_ATTRID_LAST_MESSAGE_RSSI
 , 
ZCL_DATA_TYPE_INT8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
g_sysDügs
.
œ°MesßgeRSSI
 },

152 {
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
 , 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

155 c⁄° 
u8
 
	gz˛_dügno°ics_©åNum
 = ( (
dügno°ics_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_greenPower.c

27 
	~"../z˛_ö˛ude.h
"

29 #ifde‡
ZCL_GREEN_POWER


48 
°©us_t
 
z˛_gp_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

51 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

53  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
m™uCode
, 
¨πNum
, 
©åTbl
, 
z˛_gp_cmdH™dÀr
, 
cb
);

54 
	}
}

57 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_nŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_nŸifiˇti⁄Cmd_t
 *
pCmd
)

59 
u8
 
Àn
 = 11;

61 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

62 
Àn
 += 4;

63 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

64 
Àn
 += 9;

67 
Àn
 +
pCmd
->
∑ylﬂdLí
;

69 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

70 if(!
buf
){

71  
ZCL_STA_INSUFFICIENT_SPACE
;

74 
u8
 *
pBuf
 = 
buf
;

77 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
›ti⁄s
.
›ts
);

78 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
›ti⁄s
.
›ts
);

80 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

81 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

82 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

83 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

84 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

85 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

86 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

87 
pBuf
 +
EXT_ADDR_LEN
;

88 *
pBuf
++ = 
pCmd
->
ídpoöt
;

91 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdSecFømeC¡
);

92 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdSecFømeC¡
);

93 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdSecFømeC¡
);

94 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdSecFømeC¡
);

96 *
pBuf
++ = 
pCmd
->
gpdCmdID
;

97 *
pBuf
++ = 
pCmd
->
∑ylﬂdLí
;

98 if(
pCmd
->
∑ylﬂdLí
){

99 
	`mem˝y
(
pBuf
, 
pCmd
->
pGpdCmdPaylﬂd
,ÖCmd->
∑ylﬂdLí
);

100 
pBuf
 +
pCmd
->
∑ylﬂdLí
;

102 if(
pCmd
->
›ti⁄s
.
bôs
.
¥oxyInfoPª£¡
){

104 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
gµSh‹tAddr
);

105 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
gµSh‹tAddr
);

107 *
pBuf
++ = 
pCmd
->
gµGpdLök
.
lök
;

110 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_NOTIFICATION
, 
TRUE
,

111 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

113 
	`ev_buf_‰ì
(
buf
);

115  
ZCL_STA_SUCCESS
;

116 
	}
}

118 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
 *
pCmd
)

120 
u8
 
Àn
 = 11;

122 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

123 
Àn
 += 4;

124 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

125 
Àn
 += 9;

128 if(
pCmd
->
›ti⁄s
.
bôs
.
£cPrcFaûed
){

129 
Àn
 += 4;

132 
Àn
 +
pCmd
->
∑ylﬂdLí
;

134 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

135 if(!
buf
){

136  
ZCL_STA_INSUFFICIENT_SPACE
;

139 
u8
 *
pBuf
 = 
buf
;

142 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
›ti⁄s
.
›ts
);

143 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
›ti⁄s
.
›ts
);

145 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

146 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

147 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

148 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

149 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

150 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

151 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

152 
pBuf
 +
EXT_ADDR_LEN
;

153 *
pBuf
++ = 
pCmd
->
ídpoöt
;

156 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdSecFømeC¡
);

157 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdSecFømeC¡
);

158 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdSecFømeC¡
);

159 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdSecFømeC¡
);

161 *
pBuf
++ = 
pCmd
->
gpdCmdID
;

162 *
pBuf
++ = 
pCmd
->
∑ylﬂdLí
;

163 if(
pCmd
->
∑ylﬂdLí
){

164 
	`mem˝y
(
pBuf
, 
pCmd
->
pGpdCmdPaylﬂd
,ÖCmd->
∑ylﬂdLí
);

165 
pBuf
 +
pCmd
->
∑ylﬂdLí
;

168 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
gµSh‹tAddr
);

169 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
gµSh‹tAddr
);

171 *
pBuf
++ = 
pCmd
->
gµGpdLök
.
lök
;

173 if(
pCmd
->
›ti⁄s
.
bôs
.
£cPrcFaûed
){

174 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
mic
);

175 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
mic
);

176 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
mic
);

177 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
mic
);

180 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_COMMISSIONING_NOTIFICATION
, 
TRUE
,

181 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

183 
	`ev_buf_‰ì
(
buf
);

185  
ZCL_STA_SUCCESS
;

186 
	}
}

188 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökTabReqCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökTabReqCmd_t
 *
pCmd
)

190 
u8
 
Àn
 = 1;

192 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

193 
Àn
 += 4;

194 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

195 
Àn
 += 9;

197 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

198 
Àn
++;

201 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

202 if(!
buf
){

203  
ZCL_STA_INSUFFICIENT_SPACE
;

206 
u8
 *
pBuf
 = 
buf
;

209 *
pBuf
++ = 
pCmd
->
›ti⁄s
.
›ts
;

211 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

212 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

213 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

214 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

215 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

216 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

217 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

218 
pBuf
 +
EXT_ADDR_LEN
;

219 *
pBuf
++ = 
pCmd
->
ídpoöt
;

222 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

223 *
pBuf
++ = 
pCmd
->
ödex
;

226 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_SINK_TABLE_REQUEST
, 
TRUE
,

227 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

229 
	`ev_buf_‰ì
(
buf
);

231  
ZCL_STA_SUCCESS
;

232 
	}
}

234 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyTabÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyTabR•Cmd_t
 *
pCmd
)

236 
u8
 
Àn
 = 4;

238 
Àn
 +
pCmd
->
íåõsLí
;

240 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

241 if(!
buf
){

242  
ZCL_STA_INSUFFICIENT_SPACE
;

245 
u8
 *
pBuf
 = 
buf
;

247 *
pBuf
++ = 
pCmd
->
°©us
;

248 *
pBuf
++ = 
pCmd
->
tŸÆTabE¡rõs
;

249 *
pBuf
++ = 
pCmd
->
°¨tIdx
;

250 *
pBuf
++ = 
pCmd
->
íåõsC¡
;

251 if(
pCmd
->
íåõsLí
){

252 
	`mem˝y
(
pBuf
, 
pCmd
->
¥oxyTabE¡ry
,ÖCmd->
íåõsLí
);

255 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_PROXY_TABLE_RESPONSE
, 
TRUE
,

256 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

258 
	`ev_buf_‰ì
(
buf
);

260  
ZCL_STA_SUCCESS
;

261 
	}
}

263 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_∑úögCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_∑úögCmd_t
 *
pCmd
)

265 
u8
 
Àn
 = 3;

267 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

268 
Àn
 += 4;

269 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

270 
Àn
 += 9;

273 if(!
pCmd
->
›ti⁄s
.
bôs
.
ªmoveGPD
){

274 if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_FULL_UNICAST
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
)){

275 
Àn
 += 10;

276 }if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_DGROUPID
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
)){

277 
Àn
 += 2;

280 if(
pCmd
->
›ti⁄s
.
bôs
.
addSök
){

281 
Àn
 += 1;

283 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecFømeC¡Pª£¡
){

284 
Àn
 += 4;

287 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecKeyPª£¡
){

288 
Àn
 +
SEC_KEY_LEN
;

291 if(
pCmd
->
›ti⁄s
.
bôs
.
assig√dAlüsPª£¡
){

292 
Àn
 += 2;

295 if(
pCmd
->
›ti⁄s
.
bôs
.
groupˇ°RadiusPª£¡
){

296 
Àn
 += 1;

301 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

302 if(!
buf
){

303  
ZCL_STA_INSUFFICIENT_SPACE
;

306 
u8
 *
pBuf
 = 
buf
;

309 *
pBuf
++ = 
	`U24_BYTE0
(
pCmd
->
›ti⁄s
.
›ts
);

310 *
pBuf
++ = 
	`U24_BYTE1
(
pCmd
->
›ti⁄s
.
›ts
);

311 *
pBuf
++ = 
	`U24_BYTE2
(
pCmd
->
›ti⁄s
.
›ts
);

313 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

314 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

315 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

316 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

317 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

318 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

319 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

320 
pBuf
 +
EXT_ADDR_LEN
;

321 *
pBuf
++ = 
pCmd
->
ídpoöt
;

324 if(!
pCmd
->
›ti⁄s
.
bôs
.
ªmoveGPD
){

326 if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_FULL_UNICAST
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
)){

327 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
sökIìeAddr
);

328 
pBuf
 +
EXT_ADDR_LEN
;

329 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
sökNwkAddr
);

330 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
sökNwkAddr
);

331 }if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_DGROUPID
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
)){

332 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
sökGroupID
);

333 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
sökGroupID
);

336 if(
pCmd
->
›ti⁄s
.
bôs
.
addSök
){

338 *
pBuf
++ = 
pCmd
->
devi˚ID
;

340 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecFømeC¡Pª£¡
){

341 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdSecFømeC¡
);

342 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdSecFømeC¡
);

343 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdSecFømeC¡
);

344 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdSecFømeC¡
);

347 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecKeyPª£¡
){

348 
	`mem˝y
(
pBuf
, 
pCmd
->
gpdKey
, 
SEC_KEY_LEN
);

349 
pBuf
 +
SEC_KEY_LEN
;

352 if(
pCmd
->
›ti⁄s
.
bôs
.
assig√dAlüsPª£¡
){

353 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
assig√dAlüs
);

354 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
assig√dAlüs
);

357 if(
pCmd
->
›ti⁄s
.
bôs
.
groupˇ°RadiusPª£¡
){

358 *
pBuf
++ = 
pCmd
->
groupˇ°Radius
;

363 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_PAIRING
, 
TRUE
,

364 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

366 
	`ev_buf_‰ì
(
buf
);

368  
ZCL_STA_SUCCESS
;

369 
	}
}

371 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyCommissi⁄ögModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *
pCmd
)

373 
u8
 
Àn
 = 1;

375 if(
pCmd
->
›ti⁄s
.
bôs
.
a˘i⁄
){

376 if(
pCmd
->
›ti⁄s
.
bôs
.
commWödowPª£¡
){

377 
Àn
 += 2;

379 if(
pCmd
->
›ti⁄s
.
bôs
.
ch™√lPª£¡
){

380 
Àn
++;

384 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

385 if(!
buf
){

386  
ZCL_STA_INSUFFICIENT_SPACE
;

389 
u8
 *
pBuf
 = 
buf
;

392 *
pBuf
++ = 
pCmd
->
›ti⁄s
.
›ts
;

394 if(
pCmd
->
›ti⁄s
.
bôs
.
a˘i⁄
){

395 if(
pCmd
->
›ti⁄s
.
bôs
.
commWödowPª£¡
){

396 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
commissi⁄ögWödow
);

397 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
commissi⁄ögWödow
);

399 if(
pCmd
->
›ti⁄s
.
bôs
.
ch™√lPª£¡
){

400 *
pBuf
++ = 
pCmd
->
ch™√l
;

404 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_PROXY_COMMISSIONING_MODE
, 
TRUE
,

405 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

407 
	`ev_buf_‰ì
(
buf
);

409  
ZCL_STA_SUCCESS
;

410 
	}
}

412 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_ª•⁄£Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_ª•⁄£Cmd_t
 *
pCmd
)

414 
u8
 
Àn
 = 1 + 2 + 1 + 1;

416 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

417 
Àn
 += 4;

418 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

419 
Àn
 += 9;

422 
Àn
++;

424 if((
pCmd
->
∑ylﬂdLí
 != 0xff) && (pCmd->payloadLen != 0x0)){

425 
Àn
 +
pCmd
->
∑ylﬂdLí
;

428 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

429 if(!
buf
){

430  
ZCL_STA_INSUFFICIENT_SPACE
;

433 
u8
 *
pBuf
 = 
buf
;

436 *
pBuf
++ = 
pCmd
->
›ti⁄s
.
›ts
;

438 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
ãmpMa°îSh‹tAddr
);

439 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
ãmpMa°îSh‹tAddr
);

441 *
pBuf
++ = 
pCmd
->
ãmpMa°îTxCh™√l
;

443 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

444 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

445 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

446 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

447 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

448 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

449 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

450 
pBuf
 +
EXT_ADDR_LEN
;

451 *
pBuf
++ = 
pCmd
->
ídpoöt
;

454 *
pBuf
++ = 
pCmd
->
gpdCmdID
;

456 *
pBuf
++ = 
pCmd
->
∑ylﬂdLí
;

457 if((
pCmd
->
∑ylﬂdLí
 != 0xff) && (pCmd->payloadLen != 0x0)){

458 
	`mem˝y
(
pBuf
, 
pCmd
->
pGpdCmdPaylﬂd
,ÖCmd->
∑ylﬂdLí
);

459 
pBuf
 +
pCmd
->
∑ylﬂdLí
;

462 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_RESPONSE
, 
TRUE
,

463 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

465 
	`ev_buf_‰ì
(
buf
);

467  
ZCL_STA_SUCCESS
;

468 
	}
}

470 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökTabÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökTabR•Cmd_t
 *
pCmd
)

472 
u8
 
Àn
 = 4;

474 
Àn
 +
pCmd
->
íåõsLí
;

476 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

477 if(!
buf
){

478  
ZCL_STA_INSUFFICIENT_SPACE
;

481 
u8
 *
pBuf
 = 
buf
;

483 *
pBuf
++ = 
pCmd
->
°©us
;

484 *
pBuf
++ = 
pCmd
->
tŸÆTabE¡rõs
;

485 *
pBuf
++ = 
pCmd
->
°¨tIdx
;

486 *
pBuf
++ = 
pCmd
->
íåõsC¡
;

487 if(
pCmd
->
íåõsLí
){

488 
	`mem˝y
(
pBuf
, 
pCmd
->
sökTabE¡ry
,ÖCmd->
íåõsLí
);

491 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_SINK_TABLE_RESPONSE
, 
TRUE
,

492 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

494 
	`ev_buf_‰ì
(
buf
);

496  
ZCL_STA_SUCCESS
;

497 
	}
}

499 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyTabÀReqCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyTabReqCmd_t
 *
pCmd
)

501 
u8
 
Àn
 = 1;

503 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

504 
Àn
 += 4;

505 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

506 
Àn
 += 9;

508 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

509 
Àn
++;

512 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

513 if(!
buf
){

514  
ZCL_STA_INSUFFICIENT_SPACE
;

517 
u8
 *
pBuf
 = 
buf
;

520 *
pBuf
++ = 
pCmd
->
›ti⁄s
.
›ts
;

522 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

523 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
gpdId
.
§cId
);

524 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
gpdId
.
§cId
);

525 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
gpdId
.
§cId
);

526 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
gpdId
.
§cId
);

527 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

528 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
gpdId
.
gpdIìeAddr
);

529 
pBuf
 +
EXT_ADDR_LEN
;

530 *
pBuf
++ = 
pCmd
->
ídpoöt
;

533 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

534 *
pBuf
++ = 
pCmd
->
ödex
;

537 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_PROXY_TABLE_REQUEST
, 
TRUE
,

538 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

540 
	`ev_buf_‰ì
(
buf
);

542  
ZCL_STA_SUCCESS
;

543 
	}
}

545 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökCommissi⁄ögModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökCommissi⁄ögModeCmd_t
 *
pCmd
)

547 
u8
 
Àn
 = 1 + 2 + 2 + 1;

549 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

550 if(!
buf
){

551  
ZCL_STA_INSUFFICIENT_SPACE
;

554 
u8
 *
pBuf
 = 
buf
;

557 *
pBuf
++ = 
pCmd
->
›ti⁄s
.
›ts
;

559 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
gpmAddrF‹Sec
);

560 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
gpmAddrF‹Sec
);

562 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
gpmAddrF‹Paúög
);

563 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
gpmAddrF‹Paúög
);

565 *
pBuf
++ = 
pCmd
->
sökEndpoöt
;

567 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GREEN_POWER
, 
ZCL_CMD_GP_SINK_COMMISSIONING_MODE
, 
TRUE
,

568 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

570 
	`ev_buf_‰ì
(
buf
);

572  
ZCL_STA_SUCCESS
;

573 
	}
}

576 
_CODE_ZCL_
 
	$z˛_gp_nŸifiˇti⁄P¨£
(
u8
 *
pD©a
, 
z˛_gp_nŸifiˇti⁄Cmd_t
 *
pCmd
)

578 
pCmd
->
›ti⁄s
.
›ts
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

579 
pD©a
 += 2;

581 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

582 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

583 
pD©a
 += 4;

584 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

585 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

586 
pD©a
 +
EXT_ADDR_LEN
;

587 
pCmd
->
ídpoöt
 = *
pD©a
++;

590 
pCmd
->
gpdSecFømeC¡
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

591 
pD©a
 += 4;

593 
pCmd
->
gpdCmdID
 = *
pD©a
++;

595 
pCmd
->
∑ylﬂdLí
 = *
pD©a
++;

596 
pCmd
->
pGpdCmdPaylﬂd
 = 
pD©a
;

597 
pD©a
 +
pCmd
->
∑ylﬂdLí
;

599 if(
pCmd
->
›ti⁄s
.
bôs
.
¥oxyInfoPª£¡
){

600 
pCmd
->
gµSh‹tAddr
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

601 
pD©a
 += 2;

602 
pCmd
->
gµGpdLök
.
lök
 = *
pD©a
++;

604 
	}
}

606 
_CODE_ZCL_
 
	$z˛_gp_commNŸifiˇti⁄P¨£
(
u8
 *
pD©a
, 
z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
 *
pCmd
)

608 
pCmd
->
›ti⁄s
.
›ts
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

609 
pD©a
 += 2;

611 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

612 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

613 
pD©a
 += 4;

614 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

615 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

616 
pD©a
 +
EXT_ADDR_LEN
;

617 
pCmd
->
ídpoöt
 = *
pD©a
++;

620 
pCmd
->
gpdSecFømeC¡
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

621 
pD©a
 += 4;

623 
pCmd
->
gpdCmdID
 = *
pD©a
++;

625 
pCmd
->
∑ylﬂdLí
 = *
pD©a
++;

626 
pCmd
->
pGpdCmdPaylﬂd
 = 
pD©a
;

627 
pD©a
 +
pCmd
->
∑ylﬂdLí
;

629 if(
pCmd
->
›ti⁄s
.
bôs
.
¥oxyInfoPª£¡
){

630 
pCmd
->
gµSh‹tAddr
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

631 
pD©a
 += 2;

632 
pCmd
->
gµGpdLök
.
lök
 = *
pD©a
++;

635 if(
pCmd
->
›ti⁄s
.
bôs
.
£cPrcFaûed
){

636 
pCmd
->
mic
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

637 
pD©a
 += 4;

639 
	}
}

641 
_CODE_ZCL_
 
	$z˛_gp_sökCommModeP¨£
(
u8
 *
pD©a
, 
z˛_gp_sökCommissi⁄ögModeCmd_t
 *
pCmd
)

643 
pCmd
->
›ti⁄s
.
›ts
 = *
pD©a
++;

645 
pCmd
->
gpmAddrF‹Sec
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

646 
pD©a
 += 2;

648 
pCmd
->
gpmAddrF‹Paúög
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

649 
pD©a
 += 2;

651 
pCmd
->
sökEndpoöt
 = *
pD©a
++;

652 
	}
}

654 
_CODE_ZCL_
 
	$z˛_gp_∑úögCfgP¨£
(
u8
 *
pD©a
, 
z˛_gp_∑úögC⁄figuøti⁄Cmd_t
 *
pCmd
)

656 
pCmd
->
a˘i⁄s
.
a˘s
 = *
pD©a
++;

658 
pCmd
->
›ti⁄s
.
›ts
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

659 
pD©a
 += 2;

661 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

662 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

663 
pD©a
 += 4;

664 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

665 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

666 
pD©a
 +
EXT_ADDR_LEN
;

667 
pCmd
->
ídpoöt
 = *
pD©a
++;

670 
pCmd
->
devi˚Id
 = *
pD©a
++;

672 
u8
 
Àn
 = 0;

673 if(
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
){

674 
pCmd
->
pGroupLi°
 = 
pD©a
;

675 
Àn
 = (*
pD©a
Ë* (
gpSökGroupLi°Iãm_t
) + 1;

676 
pD©a
 +
Àn
;

679 if(
pCmd
->
›ti⁄s
.
bôs
.
assig√dAlüs
){

680 
pCmd
->
gpdAssig√dAlüs
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

681 
pD©a
 += 2;

684 
pCmd
->
groupˇ°Radius
 = *
pD©a
++;

686 if(
pCmd
->
›ti⁄s
.
bôs
.
£cU£
){

687 
pCmd
->
£cO±i⁄s
 = *
pD©a
++;

689 
pCmd
->
gpdSecFømeC¡
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

690 
pD©a
 += 4;

692 
	`mem˝y
(
pCmd
->
gpdSecKey
, 
pD©a
, 
SEC_KEY_LEN
);

693 
pD©a
 +
SEC_KEY_LEN
;

696 
pCmd
->
numOfPaúedEndpoöts
 = *
pD©a
++;

698 if–(
pCmd
->
numOfPaúedEndpoöts
 != 0x00) && (pCmd->numOfPairedEndpoints != 0xfd) &&

699 (
pCmd
->
numOfPaúedEndpoöts
 != 0xff) && (pCmd->numOfPairedEndpoints != 0xfe)){

700 
pCmd
->
pPaúedEndpoöts
 = 
pD©a
;

701 
pD©a
 +
pCmd
->
numOfPaúedEndpoöts
;

704 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pInfoPª£¡
){

705 
pCmd
->
≠pInfo
.
öfo
 = *
pD©a
++;

707 if(
pCmd
->
≠pInfo
.
bôs
.
m™uIdPª£¡
){

708 
pCmd
->
m™uÁ˘uªrId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

709 
pD©a
 += 2;

711 if(
pCmd
->
≠pInfo
.
bôs
.
modñIdPª£¡
){

712 
pCmd
->
modñId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

713 
pD©a
 += 2;

715 if(
pCmd
->
≠pInfo
.
bôs
.
gpdCmdsPª£¡
){

716 
pCmd
->
numOfGpdCmds
 = *
pD©a
++;

717 if(
pCmd
->
numOfGpdCmds
){

718 
pCmd
->
pGpdCmdLi°
 = 
pD©a
;

719 
pD©a
 +
pCmd
->
numOfGpdCmds
;

722 if(
pCmd
->
≠pInfo
.
bôs
.
˛u°îLi°Pª£¡
){

723 
pCmd
->
pClu°îLi°
 = 
pD©a
;

724 
Àn
 = (((*
pD©a
Ë& 0x0fË+ ((*pD©aË& 0xf0)Ë* (
u16
) + 1;

725 
pD©a
 +
Àn
;

727 if(
pCmd
->
≠pInfo
.
bôs
.
swôchInfoPª£¡
 && (pCmd->
devi˚Id
 == 0x07)){

728 
u8
 
¥e£¡
 = 0;

729 
u8
 
i
 = 0; i < 
pCmd
->
numOfGpdCmds
; i++){

730 if((
pCmd
->
pGpdCmdLi°
[
i
] == 0x69) || (pCmd->pGpdCmdList[i] == 0x6a)){

731 
¥e£¡
 = 1;

735 if(
¥e£¡
){

736 
pCmd
->
pSwôchInfo
 = 
pD©a
;

737 
Àn
 = (*
pD©a
) + 1;

738 
pD©a
 +
Àn
;

742 
	}
}

744 
_CODE_ZCL_
 
	$z˛_gp_sökTabReqP¨£
(
u8
 *
pD©a
, 
z˛_gp_sökTabReqCmd_t
 *
pCmd
)

746 
pCmd
->
›ti⁄s
.
›ts
 = *
pD©a
++;

748 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

749 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

750 
pD©a
 += 4;

751 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

752 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

753 
pD©a
 +
EXT_ADDR_LEN
;

754 
pCmd
->
ídpoöt
 = *
pD©a
++;

757 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

758 
pCmd
->
ödex
 = *
pD©a
++;

760 
	}
}

762 
_CODE_ZCL_
 
	$z˛_gp_¥oxyTabR•P¨£
(
u8
 *
pD©a
, 
u16
 
d©aLí
, 
z˛_gp_¥oxyTabR•Cmd_t
 *
pCmd
)

764 
u8
 *
±r
 = 
pD©a
;

766 
pCmd
->
°©us
 = *
pD©a
++;

767 
pCmd
->
tŸÆTabE¡rõs
 = *
pD©a
++;

768 
pCmd
->
°¨tIdx
 = *
pD©a
++;

769 
pCmd
->
íåõsC¡
 = *
pD©a
++;

770 
pCmd
->
íåõsLí
 = 
d©aLí
 - (
pD©a
 - 
±r
);

771 if(
pCmd
->
íåõsLí
){

772 
pCmd
->
¥oxyTabE¡ry
 = 
pD©a
;

774 
	}
}

776 
_CODE_ZCL_
 
	$z˛_gp_∑úögP¨£
(
u8
 *
pD©a
, 
z˛_gp_∑úögCmd_t
 *
pCmd
)

779 
pCmd
->
›ti⁄s
.
›ts
 = 
	`BUILD_U24
(
pD©a
[0],ÖData[1],ÖData[2]);

780 
pD©a
 += 3;

783 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

784 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

785 
pD©a
 += 4;

786 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

787 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

788 
pD©a
 +
EXT_ADDR_LEN
;

789 
pCmd
->
ídpoöt
 = *
pD©a
++;

792 if(!
pCmd
->
›ti⁄s
.
bôs
.
ªmoveGPD
){

793 if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_FULL_UNICAST
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_LIGHTWEIGHT_UNICAST
)){

794 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
sökIìeAddr
, 
pD©a
);

795 
pD©a
 +
EXT_ADDR_LEN
;

796 
pCmd
->
sökNwkAddr
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

797 
pD©a
 += 2;

798 }if((
pCmd
->
›ti⁄s
.
bôs
.
commMode
 =
GPS_COMM_MODE_GROUP_DGROUPID
Ë|| (pCmd->›ti⁄s.bôs.commModê=
GPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
)){

799 
pCmd
->
sökGroupID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

800 
pD©a
 += 2;

807 if(
pCmd
->
›ti⁄s
.
bôs
.
addSök
){

808 
pCmd
->
devi˚ID
 = *
pD©a
++;

810 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecFømeC¡Pª£¡
){

811 
pCmd
->
gpdSecFømeC¡
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

812 
pD©a
 += 4;

815 if(
pCmd
->
›ti⁄s
.
bôs
.
gpdSecKeyPª£¡
){

816 
	`mem˝y
(
pCmd
->
gpdKey
, 
pD©a
, 
SEC_KEY_LEN
);

817 
pD©a
 +
SEC_KEY_LEN
;

820 if(
pCmd
->
›ti⁄s
.
bôs
.
assig√dAlüsPª£¡
){

821 
pCmd
->
assig√dAlüs
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

822 
pD©a
 += 2;

825 if(
pCmd
->
›ti⁄s
.
bôs
.
groupˇ°RadiusPª£¡
){

826 
pCmd
->
groupˇ°Radius
 = *
pD©a
++;

829 
	}
}

831 
_CODE_ZCL_
 
	$z˛_gp_sökTabR•P¨£
(
u8
 *
pD©a
, 
u16
 
d©aLí
, 
z˛_gp_sökTabR•Cmd_t
 *
pCmd
)

833 
pCmd
->
°©us
 = *
pD©a
++;

834 
pCmd
->
tŸÆTabE¡rõs
 = *
pD©a
++;

835 
pCmd
->
°¨tIdx
 = *
pD©a
++;

836 
pCmd
->
íåõsC¡
 = *
pD©a
++;

837 
pCmd
->
sökTabE¡ry
 = 
pD©a
;

838 
pCmd
->
íåõsLí
 = 
d©aLí
 - 4;

839 
	}
}

841 
_CODE_ZCL_
 
	$z˛_gp_¥oxyTabReqP¨£
(
u8
 *
pD©a
, 
z˛_gp_¥oxyTabReqCmd_t
 *
pCmd
)

844 
pCmd
->
›ti⁄s
.
›ts
 = *
pD©a
++;

847 if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_GPD_ID
){

848 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

849 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

850 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

851 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

852 
pD©a
 +
EXT_ADDR_LEN
;

853 
pCmd
->
ídpoöt
 = *
pD©a
;

855 }if(
pCmd
->
›ti⁄s
.
bôs
.
ªqTy≥
 =
REQUEST_TABLE_ENTRIES_BY_INDEX
){

856 
pCmd
->
ödex
 = *
pD©a
;

858 
	}
}

860 
_CODE_ZCL_
 
	$z˛_gp_¥oxyCommModeP¨£
(
u8
 *
pD©a
, 
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *
pCmd
)

863 
pCmd
->
›ti⁄s
.
›ts
 = *
pD©a
++;

865 if(
pCmd
->
›ti⁄s
.
bôs
.
a˘i⁄
){

866 if(
pCmd
->
›ti⁄s
.
bôs
.
commWödowPª£¡
){

867 
pCmd
->
commissi⁄ögWödow
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

868 
pD©a
 += 2;

870 if(
pCmd
->
›ti⁄s
.
bôs
.
ch™√lPª£¡
){

871 
pCmd
->
ch™√l
 = *
pD©a
++;

874 
	}
}

876 
_CODE_ZCL_
 
	$z˛_gp_ª•⁄£P¨£
(
u8
 *
pD©a
, 
u16
 
d©aLí
, 
z˛_gp_ª•⁄£Cmd_t
 *
pCmd
)

879 
pCmd
->
›ti⁄s
.
›ts
 = *
pD©a
++;

881 
pCmd
->
ãmpMa°îSh‹tAddr
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

882 
pD©a
 += 2;

884 
pCmd
->
ãmpMa°îTxCh™√l
 = *
pD©a
++;

886 if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_SRC_ID
){

887 
pCmd
->
gpdId
.
§cId
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

888 
pD©a
 += 4;

889 }if(
pCmd
->
›ti⁄s
.
bôs
.
≠pId
 =
GP_APP_ID_GPD
){

890 
	`ZB_64BIT_ADDR_COPY
(
pCmd
->
gpdId
.
gpdIìeAddr
, 
pD©a
);

891 
pD©a
 +
EXT_ADDR_LEN
;

892 
pCmd
->
ídpoöt
 = *
pD©a
++;

895 
pCmd
->
gpdCmdID
 = *
pD©a
++;

897 
pCmd
->
∑ylﬂdLí
 = *
pD©a
++;

899 
pCmd
->
pGpdCmdPaylﬂd
 = 
pD©a
;

900 
	}
}

902 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_nŸifiˇti⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

904 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

906 if(
pInMsg
->
˛u°îAµCb
){

907 
z˛_gp_nŸifiˇti⁄Cmd_t
 
cmd
;

908 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

910 
	`z˛_gp_nŸifiˇti⁄P¨£
(
pInMsg
->
pD©a
, &
cmd
);

912 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

914 
°©us
 = 
ZCL_STA_FAILURE
;

917  
°©us
;

918 
	}
}

920 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_commissi⁄ögNŸifiˇti⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

922 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

924 if(
pInMsg
->
˛u°îAµCb
){

925 
z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
 
cmd
;

926 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

928 
	`z˛_gp_commNŸifiˇti⁄P¨£
(
pInMsg
->
pD©a
, &
cmd
);

930 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

932 
°©us
 = 
ZCL_STA_FAILURE
;

935  
°©us
;

936 
	}
}

938 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökCommissi⁄ögModePrc
(
z˛Incomög_t
 *
pInMsg
)

940 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

942 if(
pInMsg
->
˛u°îAµCb
){

943 
z˛_gp_sökCommissi⁄ögModeCmd_t
 
cmd
;

944 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

946 
	`z˛_gp_sökCommModeP¨£
(
pInMsg
->
pD©a
, &
cmd
);

948 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

950 
°©us
 = 
ZCL_STA_FAILURE
;

953  
°©us
;

954 
	}
}

956 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_∑úögCfgPrc
(
z˛Incomög_t
 *
pInMsg
)

958 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

960 if(
pInMsg
->
˛u°îAµCb
){

961 
z˛_gp_∑úögC⁄figuøti⁄Cmd_t
 
cmd
;

962 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

964 
	`z˛_gp_∑úögCfgP¨£
(
pInMsg
->
pD©a
, &
cmd
);

966 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

968 
°©us
 = 
ZCL_STA_FAILURE
;

971  
°©us
;

972 
	}
}

974 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökTabReqPrc
(
z˛Incomög_t
 *
pInMsg
)

976 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

978 if(
pInMsg
->
˛u°îAµCb
){

979 
z˛_gp_sökTabReqCmd_t
 
cmd
;

980 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

982 
	`z˛_gp_sökTabReqP¨£
(
pInMsg
->
pD©a
, &
cmd
);

984 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

986 
°©us
 = 
ZCL_STA_FAILURE
;

989  
°©us
;

990 
	}
}

992 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyTabR•Prc
(
z˛Incomög_t
 *
pInMsg
)

994 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

996 if(
pInMsg
->
˛u°îAµCb
){

997 
z˛_gp_¥oxyTabR•Cmd_t
 
cmd
;

998 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1000 
	`z˛_gp_¥oxyTabR•P¨£
(
pInMsg
->
pD©a
,ÖInMsg->
d©aLí
, &
cmd
);

1002 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1004 
°©us
 = 
ZCL_STA_FAILURE
;

1007  
°©us
;

1008 
	}
}

1010 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_∑úögPrc
(
z˛Incomög_t
 *
pInMsg
)

1012 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1014 if(
pInMsg
->
˛u°îAµCb
){

1015 
z˛_gp_∑úögCmd_t
 
cmd
;

1016 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1018 
	`z˛_gp_∑úögP¨£
(
pInMsg
->
pD©a
, &
cmd
);

1020 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1022 
°©us
 = 
ZCL_STA_FAILURE
;

1025  
°©us
;

1026 
	}
}

1028 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyCommissi⁄ögModePrc
(
z˛Incomög_t
 *
pInMsg
)

1030 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1032 if(
pInMsg
->
˛u°îAµCb
){

1033 
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 
cmd
;

1034 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1036 
	`z˛_gp_¥oxyCommModeP¨£
(
pInMsg
->
pD©a
, &
cmd
);

1038 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1040 
°©us
 = 
ZCL_STA_FAILURE
;

1043  
°©us
;

1044 
	}
}

1046 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_Re•⁄£Prc
(
z˛Incomög_t
 *
pInMsg
)

1048 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1050 if(
pInMsg
->
˛u°îAµCb
){

1051 
z˛_gp_ª•⁄£Cmd_t
 
cmd
;

1052 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1054 
	`z˛_gp_ª•⁄£P¨£
(
pInMsg
->
pD©a
,ÖInMsg->
d©aLí
, &
cmd
);

1056 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1058 
°©us
 = 
ZCL_STA_FAILURE
;

1061  
°©us
;

1062 
	}
}

1064 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_sökTabR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1066 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1068 if(
pInMsg
->
˛u°îAµCb
){

1069 
z˛_gp_sökTabR•Cmd_t
 
cmd
;

1070 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1072 
	`z˛_gp_sökTabR•P¨£
(
pInMsg
->
pD©a
,ÖInMsg->
d©aLí
, &
cmd
);

1074 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1076 
°©us
 = 
ZCL_STA_FAILURE
;

1079  
°©us
;

1080 
	}
}

1082 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_¥oxyTabReqPrc
(
z˛Incomög_t
 *
pInMsg
)

1084 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1086 if(
pInMsg
->
˛u°îAµCb
){

1087 
z˛_gp_¥oxyTabReqCmd_t
 
cmd
;

1088 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1090 
	`z˛_gp_¥oxyTabReqP¨£
(
pInMsg
->
pD©a
, &
cmd
);

1092 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1094 
°©us
 = 
ZCL_STA_FAILURE
;

1097  
°©us
;

1098 
	}
}

1101 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1103 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1105 
pInMsg
->
hdr
.
cmd
)

1107 
ZCL_CMD_GP_NOTIFICATION
:

1108 
°©us
 = 
	`z˛_gp_nŸifiˇti⁄Prc
(
pInMsg
);

1110 
ZCL_CMD_GP_COMMISSIONING_NOTIFICATION
:

1111 
°©us
 = 
	`z˛_gp_commissi⁄ögNŸifiˇti⁄Prc
(
pInMsg
);

1113 
ZCL_CMD_GP_SINK_COMMISSIONING_MODE
:

1114 
°©us
 = 
	`z˛_gp_sökCommissi⁄ögModePrc
(
pInMsg
);

1116 
ZCL_CMD_GP_PAIRING_CONFIGURATION
:

1117 
°©us
 = 
	`z˛_gp_∑úögCfgPrc
(
pInMsg
);

1119 
ZCL_CMD_GP_SINK_TABLE_REQUEST
:

1120 
°©us
 = 
	`z˛_gp_sökTabReqPrc
(
pInMsg
);

1122 
ZCL_CMD_GP_PROXY_TABLE_RESPONSE
:

1123 
°©us
 = 
	`z˛_gp_¥oxyTabR•Prc
(
pInMsg
);

1126 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1130  
°©us
;

1131 
	}
}

1133 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1135 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1137 
pInMsg
->
hdr
.
cmd
)

1139 
ZCL_CMD_GP_PAIRING
:

1140 
°©us
 = 
	`z˛_gp_∑úögPrc
(
pInMsg
);

1142 
ZCL_CMD_GP_PROXY_COMMISSIONING_MODE
:

1143 
°©us
 = 
	`z˛_gp_¥oxyCommissi⁄ögModePrc
(
pInMsg
);

1145 
ZCL_CMD_GP_RESPONSE
:

1146 
°©us
 = 
	`z˛_gp_Re•⁄£Prc
(
pInMsg
);

1148 
ZCL_CMD_GP_SINK_TABLE_RESPONSE
:

1149 
°©us
 = 
	`z˛_gp_sökTabR•Prc
(
pInMsg
);

1151 
ZCL_CMD_GP_PROXY_TABLE_REQUEST
:

1152 
°©us
 = 
	`z˛_gp_¥oxyTabReqPrc
(
pInMsg
);

1155 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1159  
°©us
;

1160 
	}
}

1162 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gp_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1164 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

1165  
	`z˛_gp_˛õ¡CmdH™dÀr
(
pInMsg
);

1167  
	`z˛_gp_£rvîCmdH™dÀr
(
pInMsg
);

1169 
	}
}

	@zigbee/zcl/general/zcl_greenPower.h

24 #i‚de‡
ZCL_GREEN_POWER_H


25 
	#ZCL_GREEN_POWER_H


	)

30 
	#DEFAULT_TC_LINK_KEY
 { 0x5a, 0x69, 0x67, 0x42, 0x65, 0x65, 0x41, 0x6c,\

	)

33 
	#GP_LINK_KEY
 
DEFAULT_TC_LINK_KEY


	)

34 
	#GP_CLUSTER_REVISION
 0x0001

	)

39 
	#GP_DEVICE_ID_PROXY
 0x0060

	)

40 
	#GP_DEVICE_ID_PROXY_BASIC
 0x0061

	)

41 
	#GP_DEVICE_ID_TARGET_PLUS
 0x0062

	)

42 
	#GP_DEVICE_ID_TARGET
 0x0063

	)

43 
	#GP_DEVICE_ID_COMMISSIONING_TOOL
 0x0064

	)

44 
	#GP_DEVICE_ID_COMBO
 0x0065

	)

45 
	#GP_DEVICE_ID_COMBO_BASIC
 0x0066

	)

51 
	#ZCL_ATTRID_GP_GPS_MAX_SINK_TABLE_ENTRIES
 0x0000

	)

52 
	#ZCL_ATTRID_GP_SINK_TABLE
 0x0001

	)

53 
	#ZCL_ATTRID_GP_GPS_COMMUNICATION_MODE
 0x0002

	)

54 
	#ZCL_ATTRID_GP_GPS_COMMISSIONING_EXIT_MODE
 0x0003

	)

55 
	#ZCL_ATTRID_GP_GPS_COMMISSIONING_WINDOW
 0x0004

	)

56 
	#ZCL_ATTRID_GP_GPS_SECURITY_LEVEL
 0x0005

	)

57 
	#ZCL_ATTRID_GP_GPS_FUNCTIONALITY
 0x0006

	)

58 
	#ZCL_ATTRID_GP_GPS_ACTIVE_FUNCTIONALITY
 0x0007

	)

60 
	#ZCL_ATTRID_GP_GPP_MAX_PROXY_TABLE_ENTRIES
 0x0010

	)

61 
	#ZCL_ATTRID_GP_PROXY_TABLE
 0x0011

	)

62 
	#ZCL_ATTRID_GP_GPP_NOTIFICATION_RETRY_NUMBER
 0x0012

	)

63 
	#ZCL_ATTRID_GP_GPP_NOTIFICATION_RETRY_TIMER
 0x0013

	)

64 
	#ZCL_ATTRID_GP_GPP_MAX_SEARCH_COUNTER
 0x0014

	)

65 
	#ZCL_ATTRID_GP_GPP_BLOCKED_GPD_ID
 0x0015

	)

66 
	#ZCL_ATTRID_GP_GPP_FUNCTIONALITY
 0x0016

	)

67 
	#ZCL_ATTRID_GP_GPP_ACTIVE_FUNCTIONALITY
 0x0017

	)

69 
	#ZCL_ATTRID_GP_SHARED_SECURITY_KEY_TYPE
 0x0020

	)

70 
	#ZCL_ATTRID_GP_SHARED_SECURITY_KEY
 0x0021

	)

71 
	#ZCL_ATTRID_GP_LINK_KEY
 0x0022

	)

72 
	#ZCL_ATTRID_GP_CLUSTER_REVISION
 0xfffd

	)

78 
	#ZCL_CMD_GP_NOTIFICATION
 0x00

	)

79 
	#ZCL_CMD_GP_PAIRING_SEARCH
 0x01

	)

80 
	#ZCL_CMD_GP_TUNNELING_STOP
 0x03

	)

81 
	#ZCL_CMD_GP_COMMISSIONING_NOTIFICATION
 0x04

	)

82 
	#ZCL_CMD_GP_SINK_COMMISSIONING_MODE
 0x05

	)

83 
	#ZCL_CMD_GP_TRANSLATION_TABLE_UPDATE_COMMAND
 0x07

	)

84 
	#ZCL_CMD_GP_TRANSLATION_TABLE_REQUEST
 0x08

	)

85 
	#ZCL_CMD_GP_PAIRING_CONFIGURATION
 0x09

	)

86 
	#ZCL_CMD_GP_SINK_TABLE_REQUEST
 0x0a

	)

87 
	#ZCL_CMD_GP_PROXY_TABLE_RESPONSE
 0x0b

	)

89 
	#ZCL_CMD_GP_NOTIFICATION_RESPONSE
 0x00

	)

90 
	#ZCL_CMD_GP_PAIRING
 0x01

	)

91 
	#ZCL_CMD_GP_PROXY_COMMISSIONING_MODE
 0x02

	)

92 
	#ZCL_CMD_GP_RESPONSE
 0x06

	)

93 
	#ZCL_CMD_GP_TRANSLATION_TABLE_RESPONSE
 0x08

	)

94 
	#ZCL_CMD_GP_SINK_TABLE_RESPONSE
 0x0a

	)

95 
	#ZCL_CMD_GP_PROXY_TABLE_REQUEST
 0x0b

	)

99 
	#GP_COMMISSIONING_COMMAND_ID
 0xE0

100 
	#GP_DECOMMISSIONING_COMMAND_ID
 0xE1

101 
	#GP_SUCCESS_COMMAND_ID
 0xE2

102 
	#GP_CHANNEL_REQ_COMMAND_ID
 0xE3

103 
	#GP_COMMISSIONING_REPLY
 0xF0

	)

104 
	#GP_CHANNEL_CONFIGURATION_COMMAND_ID
 0xF3

	)

107 
	#ZCL_GP_MAX_SINK_TABLE_ATTR_LEN
 45

	)

108 
	#ZCL_GP_MAX_PROXY_TABLE_ATTR_LEN
 75

	)

115 
u8
 
	m›ts
;

118 
u8
 
	m£cLevñ
:2;

119 
u8
 
	m£cKeyTy≥
:3;

120 
u8
 
	mª£rved
:3;

121 }
	mbôs
;

122 }
	tgpSecO±_t
;

126 
u16
 
	mgroupId
;

127 
u16
 
	mÆüs
;

128 }
	tgpSökGroupLi°Iãm_t
;

131 
	#SINK_GROUP_LIST_NUM
 2

	)

135 
u16
 
	m›ts
;

138 
u16
 
	m≠pId
:3;

139 
u16
 
	mcommuiˇti⁄Mode
:2;

140 
u16
 
	m£qNumC≠abûôõs
:1;

141 
u16
 
	mrxOnC≠abûôy
:1;

142 
u16
 
	mfixedLoˇti⁄
:1;

143 
u16
 
	massig√dAlüs
:1;

144 
u16
 
	m£curôyU£
:1;

145 
u16
 
	mª£rved
:6;

146 }
	mbôs
;

147 }
	tgpSökE¡ryO±_t
;

154 
gpdId_t
 
	mgpdId
;

155 
u32
 
	mgpdSecFømeC¡
;

156 
gpSökE¡ryO±_t
 
	m›ti⁄s
;

157 
u16
 
	mgpdAssig√dAlüs
;

158 
gpSökGroupLi°Iãm_t
 
	mgroupLi°
[
SINK_GROUP_LIST_NUM
];

160 
u8
 
	mídpoöt
;

161 
u8
 
	mdevi˚Id
;

162 
u8
 
	mgroupˇ°Radius
;

163 
gpSecO±_t
 
	m£cO±i⁄s
;

165 
u8
 
	mgpdKey
[16];

167 
u8
 
	mu£d
:1;

168 
u8
 
	msökGroupLi°C¡
:2;

169 
u8
 
	mª£rved
:5;

170 }
	tgpSökTabE¡ry_t
;

177 
	mGPS_COMM_MODE_FULL_UNICAST
,

178 
	mGPS_COMM_MODE_GROUP_DGROUPID
,

179 
	mGPS_COMM_MODE_GROUP_PRE_COMMISSIONED_GROUPID
,

180 
	mGPS_COMM_MODE_LIGHTWEIGHT_UNICAST
,

181 }
	tgpsCommMode_t
;

188 
u8
 
	mmode
;

191 
u8
 
	m⁄CommWödowExpú©i⁄
:1;

192 
u8
 
	m⁄Fú°PaúögSuc˚ss
:1;

193 
u8
 
	m⁄GpProxyCommMode_exô
:1;

194 
u8
 
	mª£rved
:5;

195 }
	mbôs
;

196 }
	tgpsCommExôMode_t
;

203 
u8
 
	mÀvñ
;

206 
u8
 
	mmöimÆGpdSecLevñ
:2;

207 
u8
 
	m¥Ÿe˘i⁄WôhGpLökKey
:1;

208 
u8
 
	mövﬁveTC
:1;

209 
u8
 
	mª£rved
:4;

210 }
	mbôs
;

211 }
	tgpsSecLevñ_t
;

216 
u16
 
	m›ts
;

219 
u16
 
	m≠pId
:3;

220 
u16
 
	míåyA˘ive
:1;

221 
u16
 
	míåyVÆid
:1;

222 
u16
 
	m£qNumC≠
:1;

223 
u16
 
	mlightWeightUniˇ°GPS
:1;

224 
u16
 
	mdîivedGroupGPS
:1;

225 
u16
 
	mcommGroupGPS
:1;

226 
u16
 
	mfú°ToF‹w¨d
:1;

227 
u16
 
	möR™ge
:1;

228 
u16
 
	mgpdFixed
:1;

229 
u16
 
	mhasAŒUniˇ°Rouãs
:1;

230 
u16
 
	massig√dAlüs
:1;

231 
u16
 
	m£cU£
:1;

232 
u16
 
	m›tsExãnsi⁄
:1;

233 }
	mbôs
;

234 }
	tgpProxyE¡ryO±_t
;

238 
addrExt_t
 
	msökIìeAddr
;

239 
u16
 
	msökNwkAddr
;

240 }
	tgpLwSökAddrLi°Iãm_t
;

244 
u16
 
	mfuŒUniˇ°GPS
:1;

245 
u16
 
	mª£rved
:15;

246 }
	tgpExãndedO±_t
;

251 
	#PROXY_LIGHTWEIGHT_SINK_ADDR_LIST_NUM
 2

	)

252 
	#PROXY_SINK_GROUP_LIST_NUM
 2

	)

253 
	#PROXY_FULL_UNICAST_SINK_ADDR_LIST_NUM
 2

	)

257 
gpdId_t
 
	mgpdId
;

259 
gpProxyE¡ryO±_t
 
	m›ti⁄s
;

260 
u16
 
	mgpdAssig√dAlüs
;

261 
gpSecO±_t
 
	m£cO±i⁄s
;

262 
u8
 
	mídpoöt
;

263 
u8
 
	mgroupˇ°Radius
;

264 
u8
 
	m£¨chC¡
;

266 
u8
 
	mgpdKey
[16];

268 
u32
 
	mgpdSecFømeC¡
;

270 
gpLwSökAddrLi°Iãm_t
 
	mlightweightSökAddrLi°
[
PROXY_LIGHTWEIGHT_SINK_ADDR_LIST_NUM
];

271 
gpSökGroupLi°Iãm_t
 
	msökGroupLi°
[
PROXY_SINK_GROUP_LIST_NUM
];

273 
u8
 
	mu£d
:1;

274 
u8
 
	mlwSökC¡
:2;

275 
u8
 
	msökGroupC¡
:2;

276 
u8
 
	mª£rved
:3;

277 }
	tgpProxyTabE¡ry_t
;

284 
u8
 
	m≠pId
:3;

285 
u8
 
	mª£rved
:5;

286 }
	tgµBlockedGpdIdO±_t
;

290 
gpdId_t
 
	mgpdId
;

291 
gµBlockedGpdIdO±_t
 
	m›ti⁄s
;

292 
u8
 
	mídpoöt
;

293 
u8
 
	m£qNum
;

294 
u8
 
	m£¨chC¡
;

295 }
	tgµBlockedGpdId_t
;

305 
u8
 
	mlök
;

308 
u8
 
	mrssi
:6;

309 
u8
 
	mlqi
:2;

310 }
	mbôs
;

311 }
	tgpGµGpdLök_t
;

315 
u16
 
	m›ts
;

318 
u16
 
	m≠pId
:3;

319 
u16
 
	mÆsoUniˇ°
:1;

320 
u16
 
	mÆsoDîivedGroup
:1;

321 
u16
 
	mÆsoCommGroup
:1;

322 
u16
 
	m£cLevñ
:2;

323 
u16
 
	m£cKeyTy≥
:3;

324 
u16
 
	mrxA·îTx
:1;

325 
u16
 
	mgpTxQueueFuŒ
:1;

326 
u16
 
	mbidúe˘i⁄ÆC≠
:1;

327 
u16
 
	m¥oxyInfoPª£¡
:1;

328 
u16
 
	mª£rved
:1;

329 }
	mbôs
;

330 }
	tgpNŸiO±_t
;

337 
gpdId_t
 
	mgpdId
;

338 
u8
 *
	mpGpdCmdPaylﬂd
;

339 
u32
 
	mgpdSecFømeC¡
;

340 
gpNŸiO±_t
 
	m›ti⁄s
;

341 
u16
 
	mgµSh‹tAddr
;

342 
u8
 
	mídpoöt
;

343 
u8
 
	mgpdCmdID
;

344 
u8
 
	m∑ylﬂdLí
;

345 
gpGµGpdLök_t
 
	mgµGpdLök
;

346 }
	tz˛_gp_nŸifiˇti⁄Cmd_t
;

351 
u24
 
	m›ts
;

354 
u24
 
	m≠pId
:3;

355 
u24
 
	maddSök
:1;

356 
u24
 
	mªmoveGPD
:1;

357 
u24
 
	mcommMode
:2;

358 
u24
 
	mgpdFixed
:1;

359 
u24
 
	mgpdMacSeqNumC≠
:1;

360 
u24
 
	m£cLevñ
:2;

361 
u24
 
	m£cKeyTy≥
:3;

362 
u24
 
	mgpdSecFømeC¡Pª£¡
:1;

363 
u24
 
	mgpdSecKeyPª£¡
:1;

364 
u24
 
	massig√dAlüsPª£¡
:1;

365 
u24
 
	mgroupˇ°RadiusPª£¡
:1;

366 
u24
 
	mª£rved
:6;

367 }
	mbôs
;

368 }
	tgpPaúögO±_t
;

375 
gpdId_t
 
	mgpdId
;

376 
addrExt_t
 
	msökIìeAddr
;

377 
gpPaúögO±_t
 
	m›ti⁄s
;

378 
u32
 
	mgpdSecFømeC¡
;

379 
u8
 
	mgpdKey
[16];

380 
u16
 
	msökNwkAddr
;

381 
u16
 
	msökGroupID
;

382 
u16
 
	massig√dAlüs
;

383 
u8
 
	mídpoöt
;

384 
u8
 
	mdevi˚ID
;

385 
u8
 
	mgroupˇ°Radius
;

386 }
	tz˛_gp_∑úögCmd_t
;

391 
	mEXIT_ON_FIRST_PAIRING_SUCCESS
 = 
BIT
(0),

392 
	mEXIT_ON_GP_PROXY_COMMISSIONING_MODE
 = 
BIT
(1),

397 
u8
 
	m›ts
;

400 
u8
 
	ma˘i⁄
:1;

401 
u8
 
	mcommWödowPª£¡
:1;

402 
u8
 
	mexôMode
:2;

403 
u8
 
	mch™√lPª£¡
:1;

404 
u8
 
	muniˇ°Communiˇti⁄
:1;

405 
u8
 
	mª£rved
:2;

406 }
	mbôs
;

407 }
	tgpProxyCommModeO±_t
;

414 
gpProxyCommModeO±_t
 
	m›ti⁄s
;

415 
u8
 
	mch™√l
;

416 
u16
 
	mcommissi⁄ögWödow
;

417 }
	tz˛_gp_¥oxyCommissi⁄ögModeCmd_t
;

422 
u16
 
	m›ts
;

425 
u16
 
	m≠pId
:3;

426 
u16
 
	mrxA·îTx
:1;

427 
u16
 
	m£cLevñ
:2;

428 
u16
 
	m£cKeyTy≥
:3;

429 
u16
 
	m£cPrcFaûed
:1;

430 
u16
 
	mbidúe˘i⁄ÆC≠
:1;

431 
u16
 
	m¥oxyInfoPª£¡
:1;

432 
u16
 
	mª£rved
:4;

433 }
	mbôs
;

434 }
	tgpCommNŸiO±_t
;

441 
gpdId_t
 
	mgpdId
;

442 
u8
 *
	mpGpdCmdPaylﬂd
;

443 
u32
 
	mgpdSecFømeC¡
;

444 
u32
 
	mmic
;

445 
gpCommNŸiO±_t
 
	m›ti⁄s
;

446 
u16
 
	mgµSh‹tAddr
;

447 
u8
 
	mídpoöt
;

448 
u8
 
	mgpdCmdID
;

449 
u8
 
	m∑ylﬂdLí
;

450 
gpGµGpdLök_t
 
	mgµGpdLök
;

451 }
	tz˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
;

456 
u8
 
	m›ts
;

459 
u8
 
	m≠pId
:3;

460 
u8
 
	må™smôOnEndpoötM©ch
:1;

461 
u8
 
	mª£rved
:4;

462 }
	mbôs
;

463 }
	tgpRe•⁄£O±_t
;

470 
gpdId_t
 
	mgpdId
;

471 
u8
 *
	mpGpdCmdPaylﬂd
;

472 
u16
 
	mãmpMa°îSh‹tAddr
;

473 
gpRe•⁄£O±_t
 
	m›ti⁄s
;

474 
u8
 
	mãmpMa°îTxCh™√l
;

475 
u8
 
	mídpoöt
;

476 
u8
 
	mgpdCmdID
;

477 
u8
 
	m∑ylﬂdLí
;

478 }
	tz˛_gp_ª•⁄£Cmd_t
;

483 
	mACTION_ADD_TRANS_TABLE_ENTRY
,

484 
	mACTION_REPLACE_TRANS_TABLE_ENTRY
,

485 
	mACTION_REMOVE_TRANS_TABLE_ENTRY
,

490 
u16
 
	m›ts
;

493 
u16
 
	m≠pId
:3;

494 
u16
 
	ma˘i⁄
:2;

495 
u16
 
	mnumOfTøns
:3;

496 
u16
 
	maddôi⁄ÆInfoBlockPª£¡
:1;

497 
u16
 
	mª£rved
:7;

498 }
	mbôs
;

499 }
	tgpTønsTabUpd©eO±_t
;

503 
u16
 
	m¥ofûe
;

504 
u16
 
	m˛u°î
;

505 
u8
 
	mödex
;

506 
u8
 
	mgpdCmdId
;

507 
u8
 
	mídpoöt
;

508 
u8
 
	mzbCmdId
;

509 
u8
 
	mzbCmdPaylﬂdLí
;

510 
u8
 *
	mpZbPaylﬂdAndAddôi⁄ÆInfo
;

511 }
	tgpTøn¶©i⁄_t
;

518 
gpdId_t
 
	mgpdId
;

519 
u8
 *
	mpBuf
;

520 
gpTønsTabUpd©eO±_t
 
	m›ti⁄s
;

521 
u8
 
	mídpoöt
;

522 
u8
 
	mbufLí
;

523 }
	tz˛_gp_å™sTabUpd©eCmd_t
;

531 
u8
 
	m°¨tIdx
;

532 }
	tz˛_gp_å™sTabReqCmd_t
;

537 
u8
 
	m›ts
;

540 
u8
 
	m≠pId
:3;

541 
u8
 
	maddôi⁄ÆInfoBlockPª£¡
:1;

542 
u8
 
	mª£rved
:4;

543 }
	mbôs
;

544 }
	tgpTønsTabR•O±_t
;

548 
gpdId_t
 
	mgpdId
;

549 
u16
 
	m¥ofûe
;

550 
u16
 
	m˛u°î
;

551 
u8
 
	mgpdEndpoöt
;

552 
u8
 
	mgpdCmdId
;

553 
u8
 
	mídpoöt
;

554 
u8
 
	mzbCmdId
;

555 
u8
 
	mzbCmdPaylﬂdLí
;

556 
u8
 *
	mpZbPaylﬂdAndAddôi⁄ÆInfo
;

557 }
	tgpTønsTabLi°_t
;

564 
u8
 *
	mpBuf
;

565 
u8
 
	mbufLí
;

566 
u8
 
	m°©us
;

567 
gpTønsTabR•O±_t
 
	m›ti⁄s
;

568 
u8
 
	mtŸÆNumOfE¡rõs
;

569 
u8
 
	m°¨tIdx
;

570 
u8
 
	míåõsC¡
;

571 }
	tz˛_gp_å™sTabR•Cmd_t
;

579 
	mNO_ACTION
,

580 
	mEXTEND_SINK_TABLE_ENTRY
,

581 
	mREPLACE_SINK_TABLE_ENTRY
,

582 
	mREMOVE_A_PAIRING
,

583 
	mREMOVE_GPD
,

584 
	mAPPLICATION_DESCRIPTION
,

589 
u8
 
	ma˘s
;

592 
u8
 
	ma˘i⁄
:3;

593 
u8
 
	m£ndGpPaúög
:1;

594 
u8
 
	mª£rved
:4;

595 }
	mbôs
;

596 }
	tgpPaúögCfgA˘i⁄s_t
;

600 
u16
 
	m›ts
;

603 
u16
 
	m≠pId
:3;

604 
u16
 
	mcommMode
:2;

605 
u16
 
	m£qNumC≠
:1;

606 
u16
 
	mrxOnC≠
:1;

607 
u16
 
	mfixedLoˇti⁄
:1;

608 
u16
 
	massig√dAlüs
:1;

609 
u16
 
	m£cU£
:1;

610 
u16
 
	m≠pInfoPª£¡
:1;

611 
u16
 
	mª£rved
:5;

612 }
	mbôs
;

613 }
	tgpPaúögCfgO±_t
;

617 
u8
 
	möfo
;

620 
u8
 
	mm™uIdPª£¡
:1;

621 
u8
 
	mmodñIdPª£¡
:1;

622 
u8
 
	mgpdCmdsPª£¡
:1;

623 
u8
 
	m˛u°îLi°Pª£¡
:1;

624 
u8
 
	mswôchInfoPª£¡
:1;

625 
u8
 
	mgpdAµDescCmdFﬁlows
:1;

626 
u8
 
	mª£rved
:2;

627 }
	mbôs
;

628 }
	tgpAµInfo_t
;

635 
u8
 *
	mpGroupLi°
;

636 
u8
 *
	mpPaúedEndpoöts
;

637 
u8
 *
	mpGpdCmdLi°
;

638 
u8
 *
	mpClu°îLi°
;

639 
u8
 *
	mpSwôchInfo
;

640 
u8
 *
	mpRï‹tDes¸ùt‹
;

642 
u32
 
	mgpdSecFømeC¡
;

643 
u8
 
	mgpdSecKey
[16];

644 
gpdId_t
 
	mgpdId
;

645 
gpPaúögCfgO±_t
 
	m›ti⁄s
;

646 
u16
 
	mgpdAssig√dAlüs
;

647 
u16
 
	mm™uÁ˘uªrId
;

648 
u16
 
	mmodñId
;

649 
gpPaúögCfgA˘i⁄s_t
 
	ma˘i⁄s
;

650 
gpAµInfo_t
 
	m≠pInfo
;

651 
u8
 
	mídpoöt
;

652 
u8
 
	mdevi˚Id
;

653 
u8
 
	mgroupˇ°Radius
;

654 
u8
 
	m£cO±i⁄s
;

655 
u8
 
	mnumOfPaúedEndpoöts
;

656 
u8
 
	mnumOfGpdCmds
;

657 
u8
 
	mtŸÆNumOfRï‹ts
;

658 
u8
 
	mnumOfRï‹ts
;

659 }
	tz˛_gp_∑úögC⁄figuøti⁄Cmd_t
;

667 
	mREQUEST_TABLE_ENTRIES_BY_GPD_ID
,

668 
	mREQUEST_TABLE_ENTRIES_BY_INDEX
,

673 
u8
 
	m›ts
;

676 
u8
 
	m≠pId
:3;

677 
u8
 
	mªqTy≥
:2;

678 
u8
 
	mª£rved
:3;

679 }
	mbôs
;

680 }
	tgpSökProxyTabReqO±_t
;

687 
gpdId_t
 
	mgpdId
;

688 
gpSökProxyTabReqO±_t
 
	m›ti⁄s
;

689 
u8
 
	mídpoöt
;

690 
u8
 
	mödex
;

691 }
	tz˛_gp_sökTabReqCmd_t
;

698 
u8
 *
	msökTabE¡ry
;

699 
u8
 
	míåõsLí
;

700 
u8
 
	m°©us
;

701 
u8
 
	mtŸÆTabE¡rõs
;

702 
u8
 
	m°¨tIdx
;

703 
u8
 
	míåõsC¡
;

704 }
	tz˛_gp_sökTabR•Cmd_t
;

711 
gpdId_t
 
	mgpdId
;

712 
gpSökProxyTabReqO±_t
 
	m›ti⁄s
;

713 
u8
 
	mídpoöt
;

714 
u8
 
	mödex
;

715 }
	tz˛_gp_¥oxyTabReqCmd_t
;

722 
u8
 *
	m¥oxyTabE¡ry
;

723 
u8
 
	míåõsLí
;

724 
u8
 
	m°©us
;

725 
u8
 
	mtŸÆTabE¡rõs
;

726 
u8
 
	m°¨tIdx
;

727 
u8
 
	míåõsC¡
;

728 }
	tz˛_gp_¥oxyTabR•Cmd_t
;

733 
u8
 
	m›ts
;

736 
u8
 
	ma˘i⁄
:1;

737 
u8
 
	mövﬁveGpmInSec
:1;

738 
u8
 
	mövﬁveGpmInPaúög
:1;

739 
u8
 
	mövﬁveProxõs
:1;

740 
u8
 
	mª£rved
:4;

741 }
	mbôs
;

742 }
	tgpSökCommModeO±_t
;

749 
u16
 
	mgpmAddrF‹Sec
;

750 
u16
 
	mgpmAddrF‹Paúög
;

751 
gpSökCommModeO±_t
 
	m›ti⁄s
;

752 
u8
 
	msökEndpoöt
;

753 }
	tz˛_gp_sökCommissi⁄ögModeCmd_t
;

756 (*
	tz˛_gp_PaúögCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_gp_∑úögCmd_t
 *
	tpCmd
);

757 (*
	tz˛_gp_¥oxyTabReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_gp_¥oxyTabReqCmd_t
 *
	tpCmd
);

758 (*
	tz˛_gp_¥oxyCommModeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *
	tpCmd
);

759 (*
	tz˛_gp_r•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_gp_ª•⁄£Cmd_t
 *
	tpCmd
);

766 
z˛_gp_PaúögCb_t
 
gpPaúögCbFunc
;

767 
z˛_gp_¥oxyTabReqCb_t
 
gpProxtTabReqCbFunc
;

768 
z˛_gp_¥oxyCommModeCb_t
 
gpProxyCommModeCbFunc
;

769 
z˛_gp_r•Cb_t
 
gpR•CbFunc
;

770 }
	tz˛_gp_AµCÆlbacks_t
;

775 c⁄° 
u8
 
z˛GpAâr_gµMaxProxyTabE¡rõs
;

776 c⁄° 
u16
 
z˛GpAâr_˛u°îRev
;

777 
u8
 
z˛GpAâr_¥oxyTabE¡ry
[];

779 
u8
 
z˛GpAâr_gµNŸifiˇti⁄RëryNum
;

780 
u8
 
z˛GpAâr_gµNŸifiˇti⁄Timî
;

781 
u8
 
z˛GpAâr_gµMaxSórchC¡
;

782 
u8
 *
pZ˛GpAâr_gµBlockedGPDID
;

784 
u8
 
z˛GpAâr_gµFunc
[];

785 
u8
 
z˛GpAâr_gµA˘iveFunc
[];

787 
u8
 
z˛GpAâr_gpSh¨edSecKeyTy≥
;

788 
u8
 
z˛GpAâr_gpSh¨edSecKey
[];

789 
u8
 
z˛GpAâr_gpLökKey
[];

796 c⁄° 
z˛AârInfo_t
 
gp_©åTbl
[];

798 c⁄° 
u8
 
z˛_gp_©åNum
;

801 
°©us_t
 
	`z˛_gp_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

803 
°©us_t
 
	`z˛_gp_nŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_nŸifiˇti⁄Cmd_t
 *
pCmd
);

804 
	#z˛_gp_nŸifiˇti⁄CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_nŸifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

806 
°©us_t
 
	`z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd_t
 *
pCmd
);

807 
	#z˛_gp_commissi⁄ögNŸifiˇti⁄CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_commissi⁄ögNŸifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

809 
°©us_t
 
	`z˛_gp_sökTabReqCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökTabReqCmd_t
 *
pCmd
);

810 
	#z˛_gp_sökTabReqCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_sökTabReqCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

812 
°©us_t
 
	`z˛_gp_¥oxyTabÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyTabR•Cmd_t
 *
pCmd
);

813 
	#z˛_gp_¥oxyTabÀR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_gp_¥oxyTabÀR•Cmd
(◊), (b), (c), (d), (e)))

	)

815 
°©us_t
 
	`z˛_gp_∑úögCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_∑úögCmd_t
 *
pCmd
);

816 
	#z˛_gp_∑úögCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_∑úögCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

818 
°©us_t
 
	`z˛_gp_¥oxyCommissi⁄ögModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyCommissi⁄ögModeCmd_t
 *
pCmd
);

819 
	#z˛_gp_¥oxyCommissi⁄ögModeCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_¥oxyCommissi⁄ögModeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

821 
°©us_t
 
	`z˛_gp_ª•⁄£Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_ª•⁄£Cmd_t
 *
pCmd
);

822 
	#z˛_gp_ª•⁄£CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_ª•⁄£Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

824 
°©us_t
 
	`z˛_gp_sökTabÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökTabR•Cmd_t
 *
pCmd
);

825 
	#z˛_gp_sökTabÀR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_gp_sökTabÀR•Cmd
(◊), (b), (c), (d), (e)))

	)

827 
°©us_t
 
	`z˛_gp_¥oxyTabÀReqCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_¥oxyTabReqCmd_t
 *
pCmd
);

828 
	#z˛_gp_¥oxyTabÀReqCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_¥oxyTabÀReqCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

830 
°©us_t
 
	`z˛_gp_sökCommissi⁄ögModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_gp_sökCommissi⁄ögModeCmd_t
 *
pCmd
);

831 
	#z˛_gp_sökCommissi⁄ögModeCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_gp_sökCommissi⁄ögModeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/general/zcl_greenPower_attr.c

28 
	~"é_comm⁄.h
"

29 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_GREEN_POWER


48 c⁄° 
u8
 
	gz˛GpAâr_gµMaxProxyTabE¡rõs
 = 
GPP_MAX_PROXY_TABLE_ENTRIES
;

49 c⁄° 
u16
 
	gz˛GpAâr_˛u°îRev
 = 
GP_CLUSTER_REVISION
;

50 
u8
 
	gz˛GpAâr_¥oxyTabE¡ry
[
ZCL_GP_MAX_PROXY_TABLE_ATTR_LEN
 + 2] = {0x0, 0x0,};

52 
u8
 
	gz˛GpAâr_gµNŸifiˇti⁄RëryNum
 = 
GPP_NOTIFICATION_RETRY_NUM
;

53 
u8
 
	gz˛GpAâr_gµNŸifiˇti⁄Timî
 = 
GPP_NOTIFICATION_RETRY_TIMER
;

54 
u8
 
	gz˛GpAâr_gµMaxSórchC¡
 = 
GPP_MAX_SEARCH_CNT
;

55 
u8
 *
	gpZ˛GpAâr_gµBlockedGPDID
 = 
NULL
;

57 
u8
 
	gz˛GpAâr_gµFunc
[3] = {0};

58 
u8
 
	gz˛GpAâr_gµA˘iveFunc
[3] = {0};

60 
u8
 
	gz˛GpAâr_gpSh¨edSecKeyTy≥
 = 0;

61 
u8
 
	gz˛GpAâr_gpSh¨edSecKey
[
SEC_KEY_LEN
] = {0};

62 
u8
 
	gz˛GpAâr_gpLökKey
[
SEC_KEY_LEN
] = 
GP_LINK_KEY
;

67 c⁄° 
z˛AârInfo_t
 
	ggp_©åTbl
[] =

71 { 
ZCL_ATTRID_GP_GPS_MAX_SINK_TABLE_ENTRIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

72 { 
ZCL_ATTRID_GP_SINK_TABLE
, 
ZCL_DATA_TYPE_LONG_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

73 { 
ZCL_ATTRID_GP_GPS_COMMUNICATION_MODE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

74 { 
ZCL_ATTRID_GP_GPS_COMMISSIONING_EXIT_MODE
,
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

75 { 
ZCL_ATTRID_GP_GPS_COMMISSIONING_WINDOW
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

76 { 
ZCL_ATTRID_GP_GPS_SECURITY_LEVEL
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
NULL
 },

77 { 
ZCL_ATTRID_GP_GPS_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

78 { 
ZCL_ATTRID_GP_GPS_ACTIVE_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)
NULL
 },

81 { 
ZCL_ATTRID_GP_GPP_MAX_PROXY_TABLE_ENTRIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµMaxProxyTabE¡rõs
 },

82 { 
ZCL_ATTRID_GP_PROXY_TABLE
, 
ZCL_DATA_TYPE_LONG_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_¥oxyTabE¡ry
 },

84 { 
ZCL_ATTRID_GP_GPP_NOTIFICATION_RETRY_NUMBER
,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gµNŸifiˇti⁄RëryNum
 },

85 { 
ZCL_ATTRID_GP_GPP_NOTIFICATION_RETRY_TIMER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gµNŸifiˇti⁄Timî
 },

86 { 
ZCL_ATTRID_GP_GPP_MAX_SEARCH_COUNTER
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gµMaxSórchC¡
 },

87 { 
ZCL_ATTRID_GP_GPP_BLOCKED_GPD_ID
, 
ZCL_DATA_TYPE_LONG_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
pZ˛GpAâr_gµBlockedGPDID
 },

89 { 
ZCL_ATTRID_GP_GPP_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµFunc
 },

90 { 
ZCL_ATTRID_GP_GPP_ACTIVE_FUNCTIONALITY
, 
ZCL_DATA_TYPE_BITMAP24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_gµA˘iveFunc
 },

92 { 
ZCL_ATTRID_GP_SHARED_SECURITY_KEY_TYPE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpSh¨edSecKeyTy≥
 },

93 { 
ZCL_ATTRID_GP_SHARED_SECURITY_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpSh¨edSecKey
 },

94 { 
ZCL_ATTRID_GP_LINK_KEY
, 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛GpAâr_gpLökKey
 },

95 { 
ZCL_ATTRID_GP_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛GpAâr_˛u°îRev
 },

97 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

100 c⁄° 
u8
 
	gz˛_gp_©åNum
 = ( (
gp_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_group.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_GROUP


49 
°©us_t
 
z˛_group_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_GROUPS
, 
m™uCode
, 
¨πNum
, 
©åTbl
, 
z˛_group_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_add
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 *
groupName
)

60 
u8
 
buf
[20];

62 
u8
 *
pBuf
 = 
buf
;

64 *
pBuf
++ = 
	`LO_UINT16
(
groupId
);

65 *
pBuf
++ = 
	`HI_UINT16
(
groupId
);

66 if(!
groupName
){

67 *
pBuf
++ = 0;

69 
u8
 
Àn
 = 
groupName
[0];

70 
Àn
 = (len > 15) ? 15 :Üen;

71 *
pBuf
++ = 
Àn
;

72 
	`mem˝y
(
pBuf
, &
groupName
[1], 
Àn
);

73 
pBuf
 +
Àn
;

76  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_ADD_GROUP
, 
TRUE
,

77 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

78 
	}
}

80 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_võw
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
)

82  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_VIEW_GROUP
, 
TRUE
,

83 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, (
u8
*)&
groupId
);

84 
	}
}

86 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_gëMembîshù
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
groupC¡
, 
u16
 *
groupLi°
)

88 
u8
 
buf
[40];

89 
buf
[0] = 
groupC¡
;

90 
	`mem˝y
(&
buf
[1], 
groupLi°
, 
groupC¡
*2);

92  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_GET_MEMBERSHIP
, 
TRUE
,

93 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
groupC¡
*2+1, 
buf
);

94 
	}
}

96 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_ªmove
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
)

98  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_REMOVE_GROUP
, 
TRUE
,

99 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, (
u8
*)&
groupId
);

100 
	}
}

102 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_ªmoveAŒ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

104  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_REMOVE_ALL_GROUP
, 
TRUE
,

105 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

106 
	}
}

108 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_addIfIdítify
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 *
groupName
)

110 
u8
 
buf
[20];

112 
u8
 *
pBuf
 = 
buf
;

114 *
pBuf
++ = 
	`LO_UINT16
(
groupId
);

115 *
pBuf
++ = 
	`HI_UINT16
(
groupId
);

116 if(!
groupName
){

117 *
pBuf
++ = 0;

119 
u8
 
Àn
 = 
groupName
[0];

120 
Àn
 = (len > 15) ? 15 :Üen;

121 *
pBuf
++ = 
Àn
;

122 
	`mem˝y
(
pBuf
, &
groupName
[1], 
Àn
);

123 
pBuf
 +
Àn
;

126  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_ADD_GROUP_IF_IDF
, 
TRUE
,

127 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

128 
	}
}

132 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_addGroupR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 
°auts
)

134 
u8
 
buf
[3];

136 
buf
[0] = 
°auts
;

137 
buf
[1] = 
	`LO_UINT16
(
groupId
);

138 
buf
[2] = 
	`HI_UINT16
(
groupId
);

140  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_ADD_GROUP_RSP
, 
TRUE
,

141 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

142 
	}
}

144 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_võwGroupR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_võwGroupR•_t
 *
pVõwGroupR•
)

146 
u8
 
buf
[20];

148 
u8
 *
pBuf
 = 
buf
;

150 *
pBuf
++ = 
pVõwGroupR•
->
°©us
;

151 *
pBuf
++ = 
	`LO_UINT16
(
pVõwGroupR•
->
groupId
);

152 *
pBuf
++ = 
	`HI_UINT16
(
pVõwGroupR•
->
groupId
);

153 if(
pVõwGroupR•
->
pGroupName
 =
NULL
){

154 *
pBuf
++ = 0;

156 
u8
 
Àn
 = 
pVõwGroupR•
->
pGroupName
[0];

157 
Àn
 = (len > 15) ? 15 :Üen;

158 *
pBuf
++ = 
Àn
;

159 
	`mem˝y
(
pBuf
, &
pVõwGroupR•
->
pGroupName
[1], 
Àn
);

160 
pBuf
 +
Àn
;

163  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_VIEW_GROUP_RSP
, 
TRUE
,

164 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

165 
	}
}

167 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_gëGroupMembîshùR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
ˇ∑côy
, u8 
groupC¡
, 
u16
 *
groupLi°
)

169 
u8
 
buf
[30];

170 
buf
[0] = 
ˇ∑côy
;

171 
buf
[1] = 
groupC¡
;

172 
	`mem˝y
(&
buf
[2], 
groupLi°
, 
groupC¡
*2);

174  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_GET_MEMBERSHIP_RSP
, 
TRUE
,

175 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
groupC¡
*2+2, 
buf
);

176 
	}
}

178 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_ªmoveGroupR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 
°auts
)

180 
u8
 
buf
[3];

182 
buf
[0] = 
°auts
;

183 
buf
[1] = 
	`LO_UINT16
(
groupId
);

184 
buf
[2] = 
	`HI_UINT16
(
groupId
);

186  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_GROUPS
, 
ZCL_CMD_GROUP_REMOVE_GROUP_RSP
, 
TRUE
,

187 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

188 
	}
}

191 
_CODE_ZCL_
 
°©us_t
 
	$z˛_addGroupPrc
(
z˛Incomög_t
 *
pInMsg
)

193 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

194 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

195 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

197 
≠s_add_group_ªq_t
 
addGroup
;

199 
addGroup
.
group_addr
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

200 
addGroup
.
ï
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

202 
°©us
 = 
	`≠s_me_group_add_ªq
(&
addGroup
);

203 if(
°©us
 =
APS_STATUS_DUPLICATE_ENTRY
){

204 
°©us
 = 
ZCL_STA_DUPLICATE_EXISTS
;

205 }if(
°©us
 =
APS_STATUS_TABLE_FULL
){

206 
°©us
 = 
ZCL_STA_INSUFFICIENT_SPACE
;

208 
°©us
 = 
ZCL_STA_SUCCESS
;

211 if(
	`UNICAST_MSG
(
pApsdeInd
)){

212 
ïInfo_t
 
d°Ep
;

213 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

215 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

216 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

217 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

218 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

220 
	`z˛_group_addGroupR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
addGroup
.
group_addr
, 
°©us
);

222 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

225  
°©us
;

226 
	}
}

228 
_CODE_ZCL_
 
°©us_t
 
	$z˛_võwGroupPrc
(
z˛Incomög_t
 *
pInMsg
)

230 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

231 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

232 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

234 if(
	`UNICAST_MSG
(
pApsdeInd
)){

235 
z˛_võwGroupR•_t
 
võwGroupR•
;

237 
võwGroupR•
.
groupId
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

239 
≠s_group_tbl_ít_t
 *
pE¡ry
 = 
	`≠s_group_£¨ch
(
võwGroupR•
.
groupId
, 
ídpoöt
);

240 if(!
pE¡ry
){

241 
°©us
 = 
ZCL_STA_NOT_FOUND
;

244 
võwGroupR•
.
pGroupName
 = 
NULL
;

245 
võwGroupR•
.
°©us
 = status;

247 
ïInfo_t
 
d°Ep
;

248 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

250 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

251 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

252 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

253 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

255 
	`z˛_group_võwGroupR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, &
võwGroupR•
);

257 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

260  
°©us
;

261 
	}
}

263 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gëGroupMembîshùPrc
(
z˛Incomög_t
 *
pInMsg
)

265 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

266 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

267 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

269 if(
	`UNICAST_MSG
(
pApsdeInd
)){

270 
u8
 *
pBuf
 = 
pInMsg
->
pD©a
;

271 
u8
 
groupC¡
 = *
pBuf
++;

272 
u16
 
födGroupLi°
[15];

273 
u8
 
födC¡
 = 0;

275 if(
groupC¡
 == 0){

276 
	`≠s_group_li°_gë
(&
födC¡
, 
födGroupLi°
);

278 
groupC¡
--){

279 
u16
 
groupId
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

281 
≠s_group_tbl_ít_t
 *
pE¡ry
 = 
	`≠s_group_£¨ch
(
groupId
, 
ídpoöt
);

282 if(
pE¡ry
){

283 
födGroupLi°
[
födC¡
++] = 
groupId
;

285 
pBuf
 += 2;

289 
ïInfo_t
 
d°Ep
;

290 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

292 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

293 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

294 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

295 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

297 
	`z˛_group_gëGroupMembîshùR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
,

298 (
APS_GROUP_TABLE_SIZE
 - 
	`≠s_group_íåy_num_gë
()), 
födC¡
, 
födGroupLi°
);

300 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

303  
°©us
;

304 
	}
}

306 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªmoveGroupPrc
(
z˛Incomög_t
 *
pInMsg
)

308 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

309 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

310 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

312 
≠s_dñëe_group_ªq_t
 
ªmoveGroup
;

313 
ªmoveGroup
.
ï
 = 
ídpoöt
;

314 
ªmoveGroup
.
group_addr
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

316 #ifde‡
ZCL_SCENE


317 
	`z˛_s˚√_ªmoveAŒS˚√E¡ry
(
ídpoöt
, 
ªmoveGroup
.
group_addr
, 
TRUE
);

320 
°©us
 = 
	`≠s_me_group_dñëe_ªq
(&
ªmoveGroup
);

321 if(
°©us
 =
APS_STATUS_INVALID_GROUP
){

322 
°©us
 = 
ZCL_STA_NOT_FOUND
;

324 
°©us
 = 
ZCL_STA_SUCCESS
;

327 if(
	`UNICAST_MSG
(
pApsdeInd
)){

328 
ïInfo_t
 
d°Ep
;

329 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

331 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

332 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

333 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

334 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

336 
	`z˛_group_ªmoveGroupR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
ªmoveGroup
.
group_addr
, 
°©us
);

338 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

341  
°©us
;

342 
	}
}

344 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªmoveAŒGroupPrc
(
z˛Incomög_t
 *
pInMsg
)

346 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

347 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

348 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

350 #ifde‡
ZCL_SCENE


351 
u8
 
groupC¡
 = 0;

352 
u16
 
groupLi°
[15] = {0};

354 
	`≠s_group_li°_gë
(&
groupC¡
, 
groupLi°
);

356 
u8
 
i
 = 0; i < 
groupC¡
; i++){

357 
	`z˛_s˚√_ªmoveAŒS˚√E¡ry
(
ídpoöt
, 
groupLi°
[
i
], ((ò>
groupC¡
Ë? 
TRUE
 : 
FALSE
));

361 
	`≠s_me_group_dñëe_Æl_ªq
(
ídpoöt
);

363  
°©us
;

364 
	}
}

366 
_CODE_ZCL_
 
°©us_t
 
	$z˛_addGroupIfIdítifyPrc
(
z˛Incomög_t
 *
pInMsg
)

368 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

369 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

370 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

372 
u16
 
idítifyTime
 = 0;

373 
u16
 
Àn
 = 0;

375 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_ATTRID_IDENTIFY_TIME
, &
Àn
, (
u8
 *)&
idítifyTime
Ë=
ZCL_STA_SUCCESS
){

376 if(
idítifyTime
){

377 
≠s_add_group_ªq_t
 
addGroup
;

379 
addGroup
.
group_addr
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

380 
addGroup
.
ï
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

382 
°©us
 = 
	`≠s_me_group_add_ªq
(&
addGroup
);

383 if(
°©us
 =
APS_STATUS_DUPLICATE_ENTRY
){

384 
°©us
 = 
ZCL_STA_DUPLICATE_EXISTS
;

385 }if(
°©us
 =
APS_STATUS_TABLE_FULL
){

386 
°©us
 = 
ZCL_STA_INSUFFICIENT_SPACE
;

388 
°©us
 = 
ZCL_STA_SUCCESS
;

393  
°©us
;

394 
	}
}

397 
_CODE_ZCL_
 
°©us_t
 
	$z˛_addGroupR•Prc
(
z˛Incomög_t
 *
pInMsg
)

399 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

400 
u8
 *
pD©a
 = 
pInMsg
->pData;

402 if(
pInMsg
->
˛u°îAµCb
){

403 
z˛_addGroupR•_t
 
addGroupR•
;

404 
addGroupR•
.
°©us
 = *
pD©a
++;

405 
addGroupR•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

407 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
addGroupR•
);

410  
°©us
;

411 
	}
}

413 
_CODE_ZCL_
 
°©us_t
 
	$z˛_võwGroupR•Prc
(
z˛Incomög_t
 *
pInMsg
)

415 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

416 
u8
 *
pD©a
 = 
pInMsg
->pData;

418 if(
pInMsg
->
˛u°îAµCb
){

419 
z˛_võwGroupR•_t
 
võwGroupR•
;

420 
võwGroupR•
.
°©us
 = *
pD©a
++;

421 
võwGroupR•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

422 
pD©a
 += 2;

423 if(
võwGroupR•
.
°©us
 =
ZCL_STA_SUCCESS
){

424 
võwGroupR•
.
pGroupName
 = 
pD©a
;

426 
võwGroupR•
.
pGroupName
 = 
NULL
;

429 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
võwGroupR•
);

432  
°©us
;

433 
	}
}

435 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªmoveGroupR•Prc
(
z˛Incomög_t
 *
pInMsg
)

437 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

438 
u8
 *
pD©a
 = 
pInMsg
->pData;

440 if(
pInMsg
->
˛u°îAµCb
){

441 
z˛_ªmoveGroupR•_t
 
ªmoveGroupR•
;

442 
ªmoveGroupR•
.
°©us
 = *
pD©a
++;

443 
ªmoveGroupR•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

445 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªmoveGroupR•
);

448  
°©us
;

449 
	}
}

453 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gëGroupMembîshùR•Prc
(
z˛Incomög_t
 *
pInMsg
)

455 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

456 
u8
 *
pD©a
 = 
pInMsg
->pData;

458 if(
pInMsg
->
˛u°îAµCb
){

459 
z˛_gëGroupMembîshùR•_t
 
gëGroupMembîshùR•
;

460 
gëGroupMembîshùR•
.
ˇ∑côy
 = *
pD©a
++;

461 
gëGroupMembîshùR•
.
groupC¡
 = *
pD©a
++;

462 
gëGroupMembîshùR•
.
pGroupLsô
 = 
pD©a
;

464 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëGroupMembîshùR•
);

467  
°©us
;

468 
	}
}

470 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

472 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

474 
pInMsg
->
hdr
.
cmd
)

476 
ZCL_CMD_GROUP_ADD_GROUP
:

477 
°©us
 = 
	`z˛_addGroupPrc
(
pInMsg
);

479 
ZCL_CMD_GROUP_VIEW_GROUP
:

480 
°©us
 = 
	`z˛_võwGroupPrc
(
pInMsg
);

482 
ZCL_CMD_GROUP_GET_MEMBERSHIP
:

483 
°©us
 = 
	`z˛_gëGroupMembîshùPrc
(
pInMsg
);

485 
ZCL_CMD_GROUP_REMOVE_GROUP
:

486 
°©us
 = 
	`z˛_ªmoveGroupPrc
(
pInMsg
);

488 
ZCL_CMD_GROUP_REMOVE_ALL_GROUP
:

489 
°©us
 = 
	`z˛_ªmoveAŒGroupPrc
(
pInMsg
);

491 
ZCL_CMD_GROUP_ADD_GROUP_IF_IDF
:

492 
°©us
 = 
	`z˛_addGroupIfIdítifyPrc
(
pInMsg
);

495 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

499  
°©us
;

500 
	}
}

502 
_CODE_ZCL_
 
u8
 
	$z˛_group_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

504 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

506 
pInMsg
->
hdr
.
cmd
)

508 
ZCL_CMD_GROUP_ADD_GROUP_RSP
:

509 
°©us
 = 
	`z˛_addGroupR•Prc
(
pInMsg
);

511 
ZCL_CMD_GROUP_VIEW_GROUP_RSP
:

512 
°©us
 = 
	`z˛_võwGroupR•Prc
(
pInMsg
);

514 
ZCL_CMD_GROUP_REMOVE_GROUP_RSP
:

515 
°©us
 = 
	`z˛_ªmoveGroupR•Prc
(
pInMsg
);

517 
ZCL_CMD_GROUP_GET_MEMBERSHIP_RSP
:

518 
°©us
 = 
	`z˛_gëGroupMembîshùR•Prc
(
pInMsg
);

521 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

525  
°©us
;

526 
	}
}

528 
_CODE_ZCL_
 
°©us_t
 
	$z˛_group_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

530 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

531  
	`z˛_group_˛õ¡CmdH™dÀr
(
pInMsg
);

533  
	`z˛_group_£rvîCmdH™dÀr
(
pInMsg
);

535 
	}
}

	@zigbee/zcl/general/zcl_group.h

24 #i‚de‡
ZCL_GROUP_H


25 
	#ZCL_GROUP_H


	)

49 
	#ZCL_CMD_GROUP_ADD_GROUP
 0x00

	)

50 
	#ZCL_CMD_GROUP_VIEW_GROUP
 0x01

	)

51 
	#ZCL_CMD_GROUP_GET_MEMBERSHIP
 0x02

	)

52 
	#ZCL_CMD_GROUP_REMOVE_GROUP
 0x03

	)

53 
	#ZCL_CMD_GROUP_REMOVE_ALL_GROUP
 0x04

	)

54 
	#ZCL_CMD_GROUP_ADD_GROUP_IF_IDF
 0x05

	)

56 
	#ZCL_CMD_GROUP_ADD_GROUP_RSP
 0x00

	)

57 
	#ZCL_CMD_GROUP_VIEW_GROUP_RSP
 0x01

	)

58 
	#ZCL_CMD_GROUP_GET_MEMBERSHIP_RSP
 0x02

	)

59 
	#ZCL_CMD_GROUP_REMOVE_GROUP_RSP
 0x03

	)

65 
	#ZCL_ATTRID_GROUP_NAME_SUPPORT
 0x0000

	)

79 
u16
 
	mgroupId
;

80 
u8
 *
	mpGroupName
;

81 } 
	tz˛_addGroup_t
;

87 
u8
 
	m°©us
;

88 
u16
 
	mgroupId
;

89 } 
	tz˛_addGroupR•_t
;

94 
z˛_addGroupR•_t
 
	tz˛_ªmoveGroupR•_t
;

100 
u8
 
	m°©us
;

101 
u16
 
	mgroupId
;

102 
u8
 *
	mpGroupName
;

103 } 
	tz˛_võwGroupR•_t
;

109 
u8
 
	mˇ∑côy
;

110 
u8
 
	mgroupC¡
;

111 
u8
 *
	mpGroupLsô
;

112 } 
	tz˛_gëGroupMembîshùR•_t
;

122 (*
	tz˛_addGroupR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_addGroupR•_t
 *
	tpAddGroupR•
);

123 (*
	tz˛_võwGroupR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_võwGroupR•_t
 *
	tpVõwGroupR•
);

124 (*
	tz˛_ªmoveGroupR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_ªmoveGroupR•_t
 *
	tpRemoveGroupR•
);

125 (*
	tz˛_gëGroupMembîshùR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_gëGroupMembîshùR•_t
 *
	tpGëGroupMembîshùR•
);

131 
z˛_addGroupR•Cb_t
 
addGroupR•CbFunc
;

132 
z˛_võwGroupR•Cb_t
 
võwGroupR•CbFunc
;

133 
z˛_ªmoveGroupR•Cb_t
 
ªmoveGroupR•CbFunc
;

134 
z˛_gëGroupMembîshùR•Cb_t
 
gëGroupMembîshùR•CbFunc
;

135 } 
	tz˛_group_AµCÆlbacks_t
;

147 
u8
 
z˛_©å_group_«meSuµ‹t
;

151 c⁄° 
z˛AârInfo_t
 
group_©åTbl
[];

153 c⁄° 
u8
 
z˛_group_©åNum
;

170 
°©us_t
 
	`z˛_group_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

184 
°©us_t
 
	`z˛_group_add
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 *
groupName
);

185 
	#z˛_group_addCmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_group_add
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d), (e)))

	)

198 
°©us_t
 
	`z˛_group_võw
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
);

199 
	#z˛_group_võwCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_group_võw
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

212 
°©us_t
 
	`z˛_group_ªmove
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
);

213 
	#z˛_group_ªmoveCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_group_ªmove
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

225 
°©us_t
 
	`z˛_group_ªmoveAŒ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

226 
	#z˛_group_ªmoveAŒCmd
(
a
,
b
,
c
Ë(
	`z˛_group_ªmoveAŒ
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

240 
°©us_t
 
	`z˛_group_gëMembîshù
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
groupC¡
, 
u16
 *
groupLi°
);

241 
	#z˛_group_gëMembîshùCmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_group_gëMembîshù
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d), (e)))

	)

254 
°©us_t
 
	`z˛_group_addIfIdítify
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
groupId
, u8 *
groupName
);

255 
	#z˛_group_addIfIdítifyCmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_group_addIfIdítify
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d), (e)))

	)

	@zigbee/zcl/general/zcl_group_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_GROUP


48 
u8
 
	gz˛_©å_group_«meSuµ‹t
 = 0;

51 c⁄° 
z˛AârInfo_t
 
	ggroup_©åTbl
[] =

53 #ifde‡
ZCL_ATTR_GROUPS_NAME_SUPPORT_ENABLE


54 { 
ZCL_ATTRID_GROUP_NAME_SUPPORT
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_group_«meSuµ‹t
 },

56 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

59 c⁄° 
u8
 
	gz˛_group_©åNum
 = ( (
group_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_identify.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_IDENTIFY


49 
°©us_t
 
z˛_idítify_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_idítify_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
	$z˛_idítify_commissi⁄ögIdítify
(
z˛Incomög_t
 *
pInMsg
, 
u16
 
idítifyTime
)

60 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

62 
˛u°îInfo_t
 *
pClu°î
 = 
	`z˛_födClu°î
(
pApsdeInd
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_IDENTIFY
);

63 if(
pClu°î
 &&ÖClu°î->
˛u°îAµCb
){

64 
z˛_idítifyCmd_t
 
idítify
;

65 
idítify
.
idítifyTime
 = identifyTime;

67 
pClu°î
->
	`˛u°îAµCb
(&(
pInMsg
->
addrInfo
), 
ZCL_CMD_IDENTIFY
, &
idítify
);

69 
	}
}

72 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_idítify
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
idítifyTime
, 
u32
 
m™uCode
)

74  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_CMD_IDENTIFY
, 
TRUE
,

75 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 2, (
u8
*)&
idítifyTime
);

76 
	}
}

78 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_idítifyQuîy
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

80  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_CMD_IDENTIFY_QUERY
, 
TRUE
,

81 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

82 
	}
}

84 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_åiggîEf„˘
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
ef„˘Id
, u8 
ef„˘V¨ü¡
)

86 
u8
 
buf
[2];

88 
buf
[0] = 
ef„˘Id
;

89 
buf
[1] = 
ef„˘V¨ü¡
;

91  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_CMD_TRIGGER_EFFECT
, 
TRUE
,

92 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

93 
	}
}

95 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_idítifyQuîyR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
timeout
)

97  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_IDENTIFY
, 
ZCL_CMD_IDENTIFY_QUERY_RSP
, 
TRUE
,

98 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, (
u8
*)&
timeout
);

99 
	}
}

101 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítifyQuîyPrc
(
z˛Incomög_t
 *
pInMsg
)

103 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

104 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

105 
u16
 
˛u°îId
 = 
pApsdeInd
->
ödInfo
.
˛u°î_id
;

106 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

108 
u16
 
idítifyTime
 = 0;

109 
u16
 
Àn
 = 0;

111 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
˛u°îId
, 
ZCL_ATTRID_IDENTIFY_TIME
, &
Àn
, (
u8
 *)&
idítifyTime
Ë=
ZCL_STA_SUCCESS
){

112 if(
idítifyTime
){

113 
ïInfo_t
 
d°Ep
;

114 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

116 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

117 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

118 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

119 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

120 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

121 if(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
){

122 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

125 
	`z˛_idítify_idítifyQuîyR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
idítifyTime
);

127 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

131  
°©us
;

132 
	}
}

134 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

136 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

138 
z˛_idítify_cmdPaylﬂd_t
 
cmdPaylﬂd
;

139 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_idítify_cmdPaylﬂd_t
));

141 
pInMsg
->
hdr
.
cmd
)

143 
ZCL_CMD_IDENTIFY
:

145 
cmdPaylﬂd
.
idítify
.
idítifyTime
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

147 
ZCL_CMD_IDENTIFY_QUERY
:

148 
°©us
 = 
	`z˛_idítifyQuîyPrc
(
pInMsg
);

150 
ZCL_CMD_TRIGGER_EFFECT
:

152 
cmdPaylﬂd
.
åiggîEf„˘
.
ef„˘Id
 = 
pInMsg
->
pD©a
[0];

153 
cmdPaylﬂd
.
åiggîEf„˘
.
ef„˘V¨ü¡
 = 
pInMsg
->
pD©a
[1];

156 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

160 if(
°©us
 =
ZCL_STA_SUCCESS
){

161 if(
pInMsg
->
˛u°îAµCb
){

162 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

164 
°©us
 = 
ZCL_STA_FAILURE
;

168  
°©us
;

169 
	}
}

171 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

173 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

175 
z˛_idítify_cmdPaylﬂd_t
 
cmdPaylﬂd
;

176 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_idítify_cmdPaylﬂd_t
));

178 
pInMsg
->
hdr
.
cmd
)

180 
ZCL_CMD_IDENTIFY_QUERY_RSP
:

182 
cmdPaylﬂd
.
idítifyR•
.
timeout
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

185 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

189 if(
°©us
 =
ZCL_STA_SUCCESS
){

190 if(
pInMsg
->
˛u°îAµCb
){

191 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

193 
°©us
 = 
ZCL_STA_FAILURE
;

197  
°©us
;

198 
	}
}

200 
_CODE_ZCL_
 
°©us_t
 
	$z˛_idítify_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

202 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

203  
	`z˛_idítify_˛õ¡CmdH™dÀr
(
pInMsg
);

205  
	`z˛_idítify_£rvîCmdH™dÀr
(
pInMsg
);

207 
	}
}

	@zigbee/zcl/general/zcl_identify.h

24 #i‚de‡
ZCL_IDENTIFY_H


25 
	#ZCL_IDENTIFY_H


	)

51 
	#ZCL_CMD_IDENTIFY
 0x00

	)

52 
	#ZCL_CMD_IDENTIFY_QUERY
 0x01

	)

53 
	#ZCL_CMD_TRIGGER_EFFECT
 0x40

	)

56 
	#ZCL_CMD_IDENTIFY_QUERY_RSP
 0x00

	)

64 
	#ZCL_ATTRID_IDENTIFY_TIME
 0x0000

	)

67 
	#DEFAULT_IDENTIFY_DURATION
 5

	)

73 
	mIDENTIFY_EFFECT_BLINK
 = 0x00,

74 
	mIDENTIFY_EFFECT_BREATHE
 = 0x01,

75 
	mIDENTIFY_EFFECT_OKAY
 = 0x02,

76 
	mIDENTIFY_EFFECT_CHANNEL_CHANGE
 = 0x0b,

77 
	mIDENTIFY_EFFECT_FINISH_EFFECT
 = 0xfe,

78 
	mIDENTIFY_EFFECT_STOP_EFFECT
 = 0xff

79 } 
	tef„˘Id_t
;

85 
u8
 
	mef„˘Id
;

86 
u8
 
	mef„˘V¨ü¡
;

87 } 
	tz˛_åiggîEf„˘_t
;

93 
u16
 
	midítifyTime
;

94 } 
	tz˛_idítifyCmd_t
;

100 
u16
 
	mtimeout
;

101 } 
	tz˛_idítifyR•Cmd_t
;

108 
z˛_idítifyCmd_t
 
	midítify
;

109 
z˛_idítifyR•Cmd_t
 
	midítifyR•
;

110 
z˛_åiggîEf„˘_t
 
	måiggîEf„˘
;

111 }
	tz˛_idítify_cmdPaylﬂd_t
;

122 (*
	tz˛_idítifyCb_t
)(
	tu8
 
	tídpoöt
, 
	tu16
 
	t§cAddr
, u16 
	tidítifyTime
);

127 (*
	tz˛_åiggîEf„˘Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_åiggîEf„˘_t
 *
	tpTriggîEf„˘
);

132 (*
	tz˛_idítifyQuîyR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu16
 
	ttimeout
);

140 
z˛_idítifyCb_t
 
idítifyCbFunc
;

141 
z˛_åiggîEf„˘Cb_t
 
åiggîEf„˘CbFunc
;

142 
z˛_idítifyQuîyR•Cb_t
 
idítifyQuîyR•CbFunc
;

143 } 
	tz˛_idítify_AµCÆlbacks_t
;

155 
u16
 
z˛_©å_idítifyTime
;

159 c⁄° 
z˛AârInfo_t
 
idítify_©åTbl
[];

161 c⁄° 
u8
 
z˛_idítify_©åNum
;

179 
°©us_t
 
	`z˛_idítify_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

192 
°©us_t
 
	`z˛_idítify_idítify
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
u16
 
idítifyTime
, 
u32
 
m™uCode
);

193 
	#z˛_idítify_idítifyCmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_idítify_idítify
(◊), (b), (c), 
ZCL_SEQ_NUM
,(d), (e)))

	)

205 
°©us_t
 
	`z˛_idítify_idítifyQuîy
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

206 
	#z˛_idítify_idítifyQuîyCmd
(
a
,
b
,
c
Ë(
	`z˛_idítify_idítifyQuîy
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

220 
°©us_t
 
	`z˛_idítify_åiggîEf„˘
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
ef„˘Id
, u8 
ef„˘V¨ü¡
);

221 
	#z˛_idítify_£ndTriggîCmd
(
a
,
b
,
c
,
d
,
e
Ë
	`z˛_idítify_åiggîEf„˘
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d), (e))

	)

224 
	`z˛_idítify_commissi⁄ögIdítify
(
z˛Incomög_t
 *
pInMsg
, 
u16
 
idítifyTime
);

	@zigbee/zcl/general/zcl_identify_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_IDENTIFY


48 
u16
 
	gz˛_©å_idítifyTime
 = 0;

51 c⁄° 
z˛AârInfo_t
 
	gidítify_©åTbl
[] =

53 #ifde‡
ZCL_ATTRID_IDENTIFY_TIME_ENABLE


54 { 
ZCL_ATTRID_IDENTIFY_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_idítifyTime
 },

56 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

59 c⁄° 
u8
 
	gz˛_idítify_©åNum
 = ( (
idítify_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_level.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_LEVEL_CTRL


49 
z˛_Àvñ_°¨tUpCuºítLevñ
(
u8
 
ídpoöt
);

50 
°©us_t
 
z˛_Àvñ_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

53 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

55 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

57 
°©us
 = 
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_Àvñ_cmdH™dÀr
, 
cb
);

59 if(
°©us
 =
ZCL_STA_SUCCESS
){

60 
	`z˛_Àvñ_°¨tUpCuºítLevñ
(
ídpoöt
);

63  
°©us
;

64 
	}
}

66 
_CODE_ZCL_
 
	$z˛_Àvñ_°¨tUpCuºítLevñ
(
u8
 
ídpoöt
)

68 
u8
 
°¨tUpCuºítLevñ
 = 0;

69 
u8
 
¥eLevñ
 = 0;

70 
u16
 
©åLí
 = 0;

72 if–(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
ZCL_ATTRID_LEVEL_START_UP_CURRENT_LEVEL
, &
©åLí
, (
u8
 *)&
°¨tUpCuºítLevñ
Ë=
ZCL_STA_SUCCESS
) &&

73 (
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
ZCL_ATTRID_LEVEL_CURRENT_LEVEL
, &
©åLí
, (
u8
 *)&
¥eLevñ
Ë=
ZCL_STA_SUCCESS
) ){

74 
u8
 
d°Levñ
 = 0;

76 if(
°¨tUpCuºítLevñ
 =
ZCL_START_UP_CURRENT_LEVEL_TO_MIN
){

77 
d°Levñ
 = 
ZCL_LEVEL_ATTR_MIN_LEVEL
;

78 }if(
°¨tUpCuºítLevñ
 =
ZCL_START_UP_CURRENT_LEVEL_TO_PREVIOUS
){

79 
d°Levñ
 = 
¥eLevñ
;

81 
d°Levñ
 = 
°¨tUpCuºítLevñ
;

84 if(
d°Levñ
 !
¥eLevñ
){

85 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
ZCL_ATTRID_LEVEL_CURRENT_LEVEL
, (
u8
 *)&
d°Levñ
);

88 
	}
}

91 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_move2Àvñ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
moveToLvl_t
 *
pMove2Levñ
)

93 
u8
 
buf
[5];

94 
u8
 *
pBuf
 = 
buf
;

96 *
pBuf
++ = 
pMove2Levñ
->
Àvñ
;

97 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Levñ
->
å™sôi⁄Time
);

98 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Levñ
->
å™sôi⁄Time
);

99 if(
pMove2Levñ
->
›tPª£¡
){

100 *
pBuf
++ = 
pMove2Levñ
->
›ti⁄sMask
;

101 *
pBuf
++ = 
pMove2Levñ
->
›ti⁄sOvîride
;

104  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
cmdId
, 
TRUE
,

105 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

106 
	}
}

108 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_move
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
move_t
 *
pMove
)

110 
u8
 
buf
[4];

111 
u8
 *
pBuf
 = 
buf
;

113 *
pBuf
++ = 
pMove
->
moveMode
;

114 *
pBuf
++ = 
pMove
->
øã
;

115 if(
pMove
->
›tPª£¡
){

116 *
pBuf
++ = 
pMove
->
›ti⁄sMask
;

117 *
pBuf
++ = 
pMove
->
›ti⁄sOvîride
;

120  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
cmdId
, 
TRUE
,

121 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

122 
	}
}

124 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_°ï
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
°ï_t
 *
pSãp
)

126 
u8
 
buf
[6];

127 
u8
 *
pBuf
 = 
buf
;

129 *
pBuf
++ = 
pSãp
->
°ïMode
;

130 *
pBuf
++ = 
pSãp
->
°ïSize
;

131 *
pBuf
++ = 
	`LO_UINT16
(
pSãp
->
å™sôi⁄Time
);

132 *
pBuf
++ = 
	`HI_UINT16
(
pSãp
->
å™sôi⁄Time
);

133 if(
pSãp
->
›tPª£¡
){

134 *
pBuf
++ = 
pSãp
->
›ti⁄sMask
;

135 *
pBuf
++ = 
pSãp
->
›ti⁄sOvîride
;

138  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
cmdId
, 
TRUE
,

139 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

140 
	}
}

142 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_°›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
°›_t
 *
pSt›
)

144 
u8
 
buf
[2];

145 
u8
 *
pBuf
 = 
buf
;

147 if(
pSt›
->
›tPª£¡
){

148 *
pBuf
++ = 
pSt›
->
›ti⁄sMask
;

149 *
pBuf
++ = 
pSt›
->
›ti⁄sOvîride
;

152  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_LEVEL_CONTROL
, 
cmdId
, 
TRUE
,

153 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

154 
	}
}

157 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

159 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

160 
u8
 *
pD©a
 = 
pInMsg
->pData;

162 
z˛_Àvñ_cmdPaylﬂd_t
 
cmdPaylﬂd
;

163 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_Àvñ_cmdPaylﬂd_t
));

165 
pInMsg
->
hdr
.
cmd
)

167 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL
:

168 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL_WITH_ON_OFF
:

169 
cmdPaylﬂd
.
moveToLevñ
.
Àvñ
 = *
pD©a
++;

170 
cmdPaylﬂd
.
moveToLevñ
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

171 
pD©a
 += 2;

172 if(
pInMsg
->
d©aLí
 == 5){

173 
cmdPaylﬂd
.
moveToLevñ
.
›ti⁄sMask
 = *
pD©a
++;

174 
cmdPaylﬂd
.
moveToLevñ
.
›ti⁄sOvîride
 = *
pD©a
++;

175 
cmdPaylﬂd
.
moveToLevñ
.
›tPª£¡
 = 1;

178 
ZCL_CMD_LEVEL_MOVE
:

179 
ZCL_CMD_LEVEL_MOVE_WITH_ON_OFF
:

180 
cmdPaylﬂd
.
move
.
moveMode
 = *
pD©a
++;

181 
cmdPaylﬂd
.
move
.
øã
 = *
pD©a
++;

182 if(
pInMsg
->
d©aLí
 == 4){

183 
cmdPaylﬂd
.
move
.
›ti⁄sMask
 = *
pD©a
++;

184 
cmdPaylﬂd
.
move
.
›ti⁄sOvîride
 = *
pD©a
++;

185 
cmdPaylﬂd
.
move
.
›tPª£¡
 = 1;

188 
ZCL_CMD_LEVEL_STEP
:

189 
ZCL_CMD_LEVEL_STEP_WITH_ON_OFF
:

190 
cmdPaylﬂd
.
°ï
.
°ïMode
 = *
pD©a
++;

191 
cmdPaylﬂd
.
°ï
.
°ïSize
 = *
pD©a
++;

192 
cmdPaylﬂd
.
°ï
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

193 
pD©a
 += 2;

194 if(
pInMsg
->
d©aLí
 == 6){

195 
cmdPaylﬂd
.
°ï
.
›ti⁄sMask
 = *
pD©a
++;

196 
cmdPaylﬂd
.
°ï
.
›ti⁄sOvîride
 = *
pD©a
++;

197 
cmdPaylﬂd
.
°ï
.
›tPª£¡
 = 1;

200 
ZCL_CMD_LEVEL_STOP
:

201 
ZCL_CMD_LEVEL_STOP_WITH_ON_OFF
:

202 if(
pInMsg
->
d©aLí
 == 2){

203 
cmdPaylﬂd
.
°›
.
›ti⁄sMask
 = *
pD©a
++;

204 
cmdPaylﬂd
.
°›
.
›ti⁄sOvîride
 = *
pD©a
++;

205 
cmdPaylﬂd
.
°›
.
›tPª£¡
 = 1;

209 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

213 if(
°©us
 =
ZCL_STA_SUCCESS
){

214 if(
pInMsg
->
˛u°îAµCb
){

215 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

217 #ifde‡
ZCL_SCENE


218 
u16
 
©åLí
 = 0;

219 
u8
 
s˚√VÆid
 = 0;

220 if(
	`z˛_gëAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, &
©åLí
, (
u8
 *)&
s˚√VÆid
Ë=
ZCL_STA_SUCCESS
){

221 
s˚√VÆid
 = 0;

222 
	`z˛_£tAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, (
u8
 *)&
s˚√VÆid
);

228  
°©us
;

229 
	}
}

231 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Àvñ_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

233 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

234  
	`z˛_Àvñ_˛õ¡CmdH™dÀr
(
pInMsg
);

236  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

238 
	}
}

	@zigbee/zcl/general/zcl_level.h

24 #i‚de‡
ZCL_LEVEL_H


25 
	#ZCL_LEVEL_H


	)

48 
	#ZCL_CMD_LEVEL_MOVE_TO_LEVEL
 0x00

	)

49 
	#ZCL_CMD_LEVEL_MOVE
 0x01

	)

50 
	#ZCL_CMD_LEVEL_STEP
 0x02

	)

51 
	#ZCL_CMD_LEVEL_STOP
 0x03

	)

52 
	#ZCL_CMD_LEVEL_MOVE_TO_LEVEL_WITH_ON_OFF
 0x04

	)

53 
	#ZCL_CMD_LEVEL_MOVE_WITH_ON_OFF
 0x05

	)

54 
	#ZCL_CMD_LEVEL_STEP_WITH_ON_OFF
 0x06

	)

55 
	#ZCL_CMD_LEVEL_STOP_WITH_ON_OFF
 0x07

	)

56 
	#ZCL_CMD_LEVEL_MOVE_TO_CLOSEST_FREQUENCY
 0x08

	)

62 
	#LEVEL_MOVE_UP
 0x00

	)

63 
	#LEVEL_MOVE_DOWN
 0x01

	)

69 
	#LEVEL_STEP_UP
 0x00

	)

70 
	#LEVEL_STEP_DOWN
 0x01

	)

77 
	#ZCL_ATTRID_LEVEL_CURRENT_LEVEL
 0x0000

	)

78 
	#ZCL_ATTRID_LEVEL_REMAINING_TIME
 0x0001

	)

79 
	#ZCL_ATTRID_LEVEL_MIN_LEVEL
 0x0002

	)

80 
	#ZCL_ATTRID_LEVEL_MAX_LEVEL
 0x0003

	)

81 
	#ZCL_ATTRID_LEVEL_CURRENT_FREQUENCY
 0x0004

	)

82 
	#ZCL_ATTRID_LEVEL_MIN_FREQUENCY
 0x0005

	)

83 
	#ZCL_ATTRID_LEVEL_MAX_FREQUENCY
 0x0006

	)

84 
	#ZCL_ATTRID_LEVEL_ON_OFF_TRANSITION_TIME
 0x0010

	)

85 
	#ZCL_ATTRID_LEVEL_ON_LEVEL
 0x0011

	)

86 
	#ZCL_ATTRID_LEVEL_ON_TRANSITION_TIME
 0x0012

	)

87 
	#ZCL_ATTRID_LEVEL_OFF_TRANSITION_TIME
 0x0013

	)

88 
	#ZCL_ATTRID_LEVEL_DEFAULT_MOVE_RATE
 0x0014

	)

89 
	#ZCL_ATTRID_LEVEL_OPTIONS
 0x000F

	)

90 
	#ZCL_ATTRID_LEVEL_START_UP_CURRENT_LEVEL
 0x4000

	)

94 
	#ZCL_LEVEL_ATTR_MIN_LEVEL
 0x01

	)

95 
	#ZCL_LEVEL_ATTR_MAX_LEVEL
 0xFE

	)

96 
	#ZCL_LEVEL_ATTR_ON_LEVEL_NO_EFFECT
 0xFF

	)

99 
	#ZCL_START_UP_CURRENT_LEVEL_TO_MIN
 0x00

	)

100 
	#ZCL_START_UP_CURRENT_LEVEL_TO_PREVIOUS
 0xFF

	)

114 
u8
 
	mÀvñ
;

115 
u16
 
	må™sôi⁄Time
;

116 
u8
 
	m›tPª£¡
;

117 
u8
 
	m›ti⁄sMask
;

118 
u8
 
	m›ti⁄sOvîride
;

119 } 
	tmoveToLvl_t
;

125 
u8
 
	mmoveMode
;

126 
u8
 
	møã
;

127 
u8
 
	m›tPª£¡
;

128 
u8
 
	m›ti⁄sMask
;

129 
u8
 
	m›ti⁄sOvîride
;

130 } 
	tmove_t
;

136 
u8
 
	m°ïMode
;

137 
u8
 
	m°ïSize
;

138 
u16
 
	må™sôi⁄Time
;

139 
u8
 
	m›tPª£¡
;

140 
u8
 
	m›ti⁄sMask
;

141 
u8
 
	m›ti⁄sOvîride
;

142 } 
	t°ï_t
;

148 
u8
 
	m›tPª£¡
;

149 
u8
 
	m›ti⁄sMask
;

150 
u8
 
	m›ti⁄sOvîride
;

151 } 
	t°›_t
;

157 
moveToLvl_t
 
	mmoveToLevñ
;

158 
move_t
 
	mmove
;

159 
°ï_t
 
	m°ï
;

160 
°›_t
 
	m°›
;

161 }
	tz˛_Àvñ_cmdPaylﬂd_t
;

171 (*
	tz˛_ÀvñCb_t
)(
	tu8
 
	tcmdId
, 
	tz˛_Àvñ_cmdPaylﬂd_t
 *
	tcmdPaylﬂd
);

177 
z˛_ÀvñCb_t
 
ÀvñCbFunc
;

178 } 
	tz˛_Àvñ_AµCÆlbacks_t
;

193 #ifde‡
ZCL_ATTR_REMAINING_TIME_ENABLE


194 
u16
 
ªmaöögTime
;

196 #ifde‡
ZCL_ATTR_ONOFF_TRANS_TIME_ENABLE


197 
u16
 
⁄OffTønsTime
;

199 #ifde‡
ZCL_ATTR_ON_TRANS_ENABLE


200 
u16
 
⁄Tønsôi⁄Time
;

202 #ifde‡
ZCL_ATTR_OFF_TRANS_ENABLE


203 
u16
 
offTønsôi⁄Time
;

205 #ifde‡
ZCL_ATTR_CURRENT_LEVEL_ENABLE


206 
u8
 
curLevñ
;

208 #ifde‡
ZCL_ATTR_ON_LEVEL_ENABLE


209 
u8
 
⁄Levñ
;

211 #ifde‡
ZCL_ATTR_DEFAULT_MOVE_RATE_ENABLE


212 
u8
 
deÁu…MoveR©e
;

214 #ifde‡
ZCL_ATTR_OPTIONS_ENABLE


215 
u8
 
›ti⁄s
;

217 #ifde‡
ZCL_ATTR_START_UP_CURRENT_LEVEL_ENABLE


218 
u8
 
°¨tUpCuºítLevñ
;

220 } 
	tz˛_ÀvñAâr_t
;

227 
z˛_ÀvñAâr_t
 
z˛_©å_Àvñ
;

228 
	#z˛_ÀvñAârGë
(Ë&
z˛_©å_Àvñ


	)

233 c⁄° 
z˛AârInfo_t
 
Àvñ_©åTbl
[];

235 c⁄° 
u8
 
z˛_Àvñ_©åNum
;

253 
°©us_t
 
	`z˛_Àvñ_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

268 
°©us_t
 
	`z˛_Àvñ_move2Àvñ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
moveToLvl_t
 *
pMove2Levñ
);

269 
	#z˛_Àvñ_move2ÀvñCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_move2Àvñ
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL
, (d)))

	)

270 
	#z˛_Àvñ_move2ÀvñWôhOnOffCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_move2Àvñ
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_MOVE_TO_LEVEL_WITH_ON_OFF
, (d)))

	)

284 
°©us_t
 
	`z˛_Àvñ_move
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
move_t
 *
pMove
);

285 
	#z˛_Àvñ_moveCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_move
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_MOVE
, (d)))

	)

286 
	#z˛_Àvñ_moveWôhOnOffCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_move
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_MOVE_WITH_ON_OFF
, (d)))

	)

300 
°©us_t
 
	`z˛_Àvñ_°ï
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
°ï_t
 *
pSãp
);

301 
	#z˛_Àvñ_°ïCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_°ï
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_STEP
, (d)))

	)

302 
	#z˛_Àvñ_°ïWôhOnOffCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_°ï
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_STEP_WITH_ON_OFF
, (d)))

	)

316 
°©us_t
 
	`z˛_Àvñ_°›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
°›_t
 *
pSt›
);

317 
	#z˛_Àvñ_°›Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_°›
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_STOP
, (d)))

	)

318 
	#z˛_Àvñ_°›WôhOnOffCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Àvñ_°›
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_LEVEL_STOP_WITH_ON_OFF
, (d)))

	)

	@zigbee/zcl/general/zcl_level_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_LEVEL_CTRL


48 
z˛_ÀvñAâr_t
 
	gz˛_©å_Àvñ
 = {

49 #ifde‡
ZCL_ATTR_CURRENT_LEVEL_ENABLE


50 .
curLevñ
 = 
ZCL_LEVEL_ATTR_CURRENT_LEVEL_DEFAULT
,

52 #ifde‡
ZCL_ATTR_REMAINING_TIME_ENABLE


53 .
	gªmaöögTime
 = 0,

55 #ifde‡
ZCL_ATTR_ONOFF_TRANS_TIME_ENABLE


56 .
	g⁄OffTønsTime
 = 0,

58 #ifde‡
ZCL_ATTR_ON_LEVEL_ENABLE


59 .
	g⁄Levñ
 = 
ZCL_LEVEL_ATTR_ON_LEVEL_NO_EFFECT
,

61 #ifde‡
ZCL_ATTR_ON_TRANS_ENABLE


62 .
	g⁄Tønsôi⁄Time
 = 0xFFFF,

64 #ifde‡
ZCL_ATTR_OFF_TRANS_ENABLE


65 .
	goffTønsôi⁄Time
 = 0xFFFF,

67 #ifde‡
ZCL_ATTR_DEFAULT_MOVE_RATE_ENABLE


68 .
	gdeÁu…MoveR©e
 = 0,

70 #ifde‡
ZCL_ATTR_OPTIONS_ENABLE


71 .
	g›ti⁄s
 = 0,

73 #ifde‡
ZCL_ATTR_START_UP_CURRENT_LEVEL_ENABLE


74 .
	g°¨tUpCuºítLevñ
 = 
ZCL_START_UP_CURRENT_LEVEL_TO_PREVIOUS
,

79 c⁄° 
z˛AârInfo_t
 
	gÀvñ_©åTbl
[] =

81 #ifde‡
ZCL_ATTR_CURRENT_LEVEL_ENABLE


82 { 
ZCL_ATTRID_LEVEL_CURRENT_LEVEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛_©å_Àvñ
.
curLevñ
 },

85 #ifde‡
ZCL_ATTR_REMAINING_TIME_ENABLE


86 { 
ZCL_ATTRID_LEVEL_REMAINING_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_Àvñ
.
ªmaöögTime
 },

89 #ifde‡
ZCL_ATTR_ONOFF_TRANS_TIME_ENABLE


90 { 
ZCL_ATTRID_LEVEL_ON_OFF_TRANSITION_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
⁄OffTønsTime
 },

93 #ifde‡
ZCL_ATTR_ON_LEVEL_ENABLE


94 { 
ZCL_ATTRID_LEVEL_ON_LEVEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
⁄Levñ
 },

97 #ifde‡
ZCL_ATTR_ON_TRANS_ENABLE


98 { 
ZCL_ATTRID_LEVEL_ON_TRANSITION_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
⁄Tønsôi⁄Time
 },

101 #ifde‡
ZCL_ATTR_OFF_TRANS_ENABLE


102 { 
ZCL_ATTRID_LEVEL_OFF_TRANSITION_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
offTønsôi⁄Time
 },

105 #ifde‡
ZCL_ATTR_DEFAULT_MOVE_RATE_ENABLE


106 { 
ZCL_ATTRID_LEVEL_DEFAULT_MOVE_RATE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
deÁu…MoveR©e
 },

109 #ifde‡
ZCL_ATTR_OPTIONS_ENABLE


110 { 
ZCL_ATTRID_LEVEL_OPTIONS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
›ti⁄s
 },

113 #ifde‡
ZCL_ATTR_START_UP_CURRENT_LEVEL_ENABLE


114 { 
ZCL_ATTRID_LEVEL_START_UP_CURRENT_LEVEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_Àvñ
.
°¨tUpCuºítLevñ
 },

117 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

120 c⁄° 
u8
 
	gz˛_Àvñ_©åNum
 = ( (
Àvñ_©åTbl
Ë/ (
z˛AârInfo_t
) );

122 
nv_°s_t
 
	$z˛_Àvñ_ßveAâr
()

124  
	`z˛_©å_ÀvñP¨ams_ßve
();

125 
	}
}

127 
nv_°s_t
 
	$z˛_Àvñ_lﬂdAâr
()

129  
	`z˛_©å_ÀvñP¨ams_ª°‹e
();

130 
	}
}

	@zigbee/zcl/general/zcl_multistate_input.c

27 
	~"../z˛_ö˛ude.h
"

30 #i‡
ZCL_MULITSTATE_INPUT


50 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mu…i°©e_öput_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

52  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_MULTISTATE_INPUT_BASIC
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

53 
	}
}

	@zigbee/zcl/general/zcl_multistate_input.h

24 #i‚de‡
ZCL_MULTISTATE_INPUT_H


25 
	#ZCL_MULTISTATE_INPUT_H


	)

36 
	#ZCL_MULTISTATE_INPUT_ATTRID_STATE_TEXT
 0x000E

	)

37 
	#ZCL_MULTISTATE_INPUT_ATTRID_DESCRIPTION
 0x001C

	)

38 
	#ZCL_MULTISTATE_INPUT_ATTRID_NUM_OF_STATES
 0x004A

	)

39 
	#ZCL_MULTISTATE_INPUT_ATTRID_OUT_OF_SERVICE
 0x0051

	)

40 
	#ZCL_MULTISTATE_INPUT_ATTRID_PRESENT_VALUE
 0x0055

	)

41 
	#ZCL_MULTISTATE_INPUT_ATTRID_RELIABLILITY
 0x0067

	)

42 
	#ZCL_MULTISTATE_INPUT_ATTRID_STATUS_FLAGS
 0x006F

	)

43 
	#ZCL_MULTISTATE_INPUT_ATTRID_APP_TYPE
 0x0100

	)

48 
	#ZCL_MULTISTATE_INPUT_MAX_LENGTH
 24

	)

51 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATE_TEXT_ENBLE


52 
u8
 
z˛_©å_mulI≈ut_°©eText
[];

54 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_DESCRIPTION_ENBLE


55 
u8
 
z˛_©å_mulI≈ut_des¸ùti⁄
[];

57 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_NUM_OF_STATES_ENBLE


58 
u16
 
z˛_©å_mulI≈ut_numOfSèãs
;

60 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_OUT_OF_SERVICE_ENBLE


61 
boﬁ
 
z˛_©å_mulI≈ut_outOfSîvi˚
;

63 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_PRESENT_VALUE_ENBLE


64 
u16
 
z˛_©å_mulI≈ut_¥e£¡VÆue
;

66 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_RELIABLILITY_ENBLE


67 
u8
 
z˛_©å_mulI≈ut_ªlübûôy
;

69 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATUS_FLAGS_ENBLE


70 
u8
 
z˛_©å_mulI≈ut_°©usFœgs
;

72 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_APP_TYPE_ENBLE


73 
u32
 
z˛_©å_mulI≈ut_≠pTy≥
;

76 c⁄° 
z˛AârInfo_t
 
mu…i°©e_öput_©åTbl
[];

77 c⁄° 
u8
 
z˛_mu…i°©e_öput_©åNum
;

81 
°©us_t
 
z˛_mu…i°©e_öput_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_multistate_input_attr.c

29 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_MULITSTATE_INPUT


48 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATE_TEXT_ENBLE


49 
u8
 
	gz˛_©å_mulI≈ut_°©eText
[
ZCL_MULTISTATE_INPUT_MAX_LENGTH
] = {0};

51 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_DESCRIPTION_ENBLE


52 
u8
 
	gz˛_©å_mulI≈ut_des¸ùti⁄
[
ZCL_MULTISTATE_INPUT_MAX_LENGTH
] = {0};

54 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_NUM_OF_STATES_ENBLE


55 
u16
 
	gz˛_©å_mulI≈ut_numOfSèãs
 = 0;

57 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_OUT_OF_SERVICE_ENBLE


58 
boﬁ
 
	gz˛_©å_mulI≈ut_outOfSîvi˚
 = 
FALSE
;

60 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_PRESENT_VALUE_ENBLE


61 
u16
 
	gz˛_©å_mulI≈ut_¥e£¡VÆue
 = 0;

63 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_RELIABLILITY_ENBLE


64 
u8
 
	gz˛_©å_mulI≈ut_ªlübûôy
 = 0x00;

66 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATUS_FLAGS_ENBLE


67 
u8
 
	gz˛_©å_mulI≈ut_°©usFœgs
 = 0;

69 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_APP_TYPE_ENBLE


70 
u32
 
	gz˛_©å_mulI≈ut_≠pTy≥
 = 0;

75 c⁄° 
z˛AârInfo_t
 
	gmu…i°©e_öput_©åTbl
[] =

77 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATE_TEXT_ENBLE


78 { 
ZCL_MULTISTATE_INPUT_ATTRID_STATE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_mulI≈ut_°©eText
},

80 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_DESCRIPTION_ENBLE


81 { 
ZCL_MULTISTATE_INPUT_ATTRID_DESCRIPTION
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_mulI≈ut_des¸ùti⁄
},

83 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_NUM_OF_STATES_ENBLE


84 { 
ZCL_MULTISTATE_INPUT_ATTRID_NUM_OF_STATES
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulI≈ut_numOfSèãs
},

86 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_OUT_OF_SERVICE_ENBLE


87 { 
ZCL_MULTISTATE_INPUT_ATTRID_OUT_OF_SERVICE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulI≈ut_outOfSîvi˚
},

89 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_PRESENT_VALUE_ENBLE


90 { 
ZCL_MULTISTATE_INPUT_ATTRID_PRESENT_VALUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulI≈ut_¥e£¡VÆue
},

92 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_RELIABLILITY_ENBLE


93 { 
ZCL_MULTISTATE_INPUT_ATTRID_RELIABLILITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulI≈ut_ªlübûôy
},

95 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_STATUS_FLAGS_ENBLE


96 { 
ZCL_MULTISTATE_INPUT_ATTRID_STATUS_FLAGS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mulI≈ut_°©usFœgs
},

98 #ifde‡
ZCL_MULTISTATE_INPUT_ATTR_APP_TYPE_ENBLE


99 { 
ZCL_MULTISTATE_INPUT_ATTRID_APP_TYPE
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mulI≈ut_≠pTy≥
},

101 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

104 c⁄° 
u8
 
	gz˛_mu…i°©e_öput_©åNum
 = ( (
mu…i°©e_öput_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_multistate_output.c

27 
	~"../z˛_ö˛ude.h
"

30 #i‡
ZCL_MULITSTATE_OUTPUT


51 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mu…i°©e_ouçut_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

53  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_MULTISTATE_OUTPUT_BASIC
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

54 
	}
}

	@zigbee/zcl/general/zcl_multistate_output.h

24 #i‚de‡
ZCL_MULTISTATE_OUTPUT_H


25 
	#ZCL_MULTISTATE_OUTPUT_H


	)

36 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_STATE_TEXT
 0x000E

	)

37 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_DESCRIPTION
 0x001C

	)

38 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_NUM_OF_STATES
 0x004A

	)

39 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_OUT_OF_SERVICE
 0x0051

	)

40 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_PRESENT_VALUE
 0x0055

	)

41 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_PRIORITY_ARRAY
 0x0057

	)

42 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_RELIABLILITY
 0x0067

	)

43 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_RELINQUISH_DEFAULT
 0x0068

	)

44 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_STATUS_FLAGS
 0x006F

	)

45 
	#ZCL_MULTISTATE_OUTPUT_ATTRID_APP_TYPE
 0x0100

	)

50 
	#ZCL_MULTISTATE_OUTPUT_MAX_LENGTH
 24

	)

57 
boﬁ
 
	mboﬁP¨a
;

58 
u16
 
	mu16P¨a
;

59 } 
	tz˛_mulOuçut_¥i‹ôyAºay_t
;

63 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATE_TEXT_ENBLE


64 
u8
 
z˛_©å_mulOuçut_°©eText
[];

66 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_DESCRIPTION_ENBLE


67 
u8
 
z˛_©å_mulOuçut_des¸ùti⁄
[];

69 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_NUM_OF_STATES_ENBLE


70 
u16
 
z˛_©å_mulOuçut_numOfSèãs
;

72 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_OUT_OF_SERVICE_ENBLE


73 
boﬁ
 
z˛_©å_mulOuçut_outOfSîvi˚
;

75 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRESENT_VALUE_ENBLE


76 
u16
 
z˛_©å_mulOuçut_¥e£¡VÆue
;

78 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRIORITY_ARRAY_ENBLE


79 
z˛_mulOuçut_¥i‹ôyAºay_t
 
z˛_©å_mulOuçut_¥i‹ôyAºay
[];

81 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELIABLILITY_ENBLE


82 
u8
 
z˛_©å_mulOuçut_ªlübûôy
;

84 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENBLE


85 
u16
 
z˛_©å_mulOuçut_ªlöquishdDÁu…
;

87 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATUS_FLAGS_ENBLE


88 
u8
 
z˛_©å_mulOuçut_°©usFœgs
;

90 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_APP_TYPE_ENBLE


91 
u32
 
z˛_©å_mulOuçut_≠pTy≥
;

94 c⁄° 
z˛AârInfo_t
 
mu…i°©e_ouçut_©åTbl
[];

95 c⁄° 
u8
 
z˛_mu…i°©e_ouçut_©åNum
;

99 
°©us_t
 
z˛_mu…i°©e_ouçut_Aâribuã_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_multistate_output_attr.c

29 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_MULTISTATE_OUTPUT


48 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATE_TEXT_ENBLE


49 
u8
 
	gz˛_©å_mulOuçut_°©eText
[
ZCL_MULTISTATE_OUTPUT_MAX_LENGTH
] = {0};

51 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_DESCRIPTION_ENBLE


52 
u8
 
	gz˛_©å_mulOuçut_des¸ùti⁄
[
ZCL_MULTISTATE_OUTPUT_MAX_LENGTH
] = {0};

54 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_NUM_OF_STATES_ENBLE


55 
u16
 
	gz˛_©å_mulOuçut_numOfSèãs
 = 0;

57 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_OUT_OF_SERVICE_ENBLE


58 
boﬁ
 
	gz˛_©å_mulOuçut_outOfSîvi˚
 = 
FALSE
;

60 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRESENT_VALUE_ENBLE


61 
u16
 
	gz˛_©å_mulOuçut_¥e£¡VÆue
 = 0;

63 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRIORITY_ARRAY_ENBLE


64 
z˛_mulOuçut_¥i‹ôyAºay_t
 
	gz˛_©å_mulOuçut_¥i‹ôyAºay
[16] = {0};

66 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELIABLILITY_ENBLE


67 
u8
 
	gz˛_©å_mulOuçut_ªlübûôy
 = 0;

69 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENBLE


70 
u16
 
	gz˛_©å_mulOuçut_ªlöquishdDÁu…
 = 0;

72 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATUS_FLAGS_ENBLE


73 
u8
 
	gz˛_©å_mulOuçut_°©usFœgs
 = 0;

75 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_APP_TYPE_ENBLE


76 
u32
 
	gz˛_©å_mulOuçut_≠pTy≥
 = 0;

81 c⁄° 
z˛AârInfo_t
 
	gmu…i°©e_ouçut_©åTbl
[] =

83 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATE_TEXT_ENBLE


84 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_STATE_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_mulOuçut_°©eText
},

86 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_DESCRIPTION_ENBLE


87 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_DESCRIPTION
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_mulOuçut_des¸ùti⁄
},

89 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_NUM_OF_STATES_ENBLE


90 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_NUM_OF_STATES
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulOuçut_numOfSèãs
},

92 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_OUT_OF_SERVICE_ENBLE


93 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_OUT_OF_SERVICE
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulOuçut_outOfSîvi˚
},

95 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRESENT_VALUE_ENBLE


96 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_PRESENT_VALUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulOuçut_¥e£¡VÆue
},

98 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_PRIORITY_ARRAY_ENBLE


99 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_PRIORITY_ARRAY
, 
ZCL_DATA_TYPE_ARRAY
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)
z˛_©å_mulOuçut_¥i‹ôyAºay
},

101 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELIABLILITY_ENBLE


102 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_RELIABLILITY
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulOuçut_ªlübûôy
},

104 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_RELINQUISH_DEFAULT_ENBLE


105 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_RELINQUISH_DEFAULT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_mulOuçut_ªlöquishdDÁu…
},

107 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_STATUS_FLAGS_ENBLE


108 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_STATUS_FLAGS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mulOuçut_°©usFœgs
},

110 #ifde‡
ZCL_MULTISTATE_OUTPUT_ATTR_APP_TYPE_ENBLE


111 { 
ZCL_MULTISTATE_OUTPUT_ATTRID_APP_TYPE
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mulOuçut_≠pTy≥
},

113 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

116 c⁄° 
u8
 
	gz˛_mu…i°©e_ouçut_©åNum
 = ( (
mu…i°©e_ouçut_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_onoff.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_ON_OFF


49 
z˛_⁄Off_°¨tUpOnOff
(
u8
 
ídpoöt
);

50 
°©us_t
 
z˛_⁄Off_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

56 
°©us
 = 
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_⁄Off_cmdH™dÀr
, 
cb
);

58 if(
°©us
 =
ZCL_STA_SUCCESS
){

59 
	`z˛_⁄Off_°¨tUpOnOff
(
ídpoöt
);

62  
°©us
;

63 
	}
}

65 
_CODE_ZCL_
 
	$z˛_⁄Off_°¨tUpOnOff
(
u8
 
ídpoöt
)

67 
u8
 
°¨tUpOnOff
 = 0;

68 
boﬁ
 
¥eOnOff
 = 0;

69 
u16
 
©åLí
 = 0;

71 if–(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_ATTRID_START_UP_ONOFF
, &
©åLí
, (
u8
 *)&
°¨tUpOnOff
Ë=
ZCL_STA_SUCCESS
) &&

72 (
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_ATTRID_ONOFF
, &
©åLí
, (
u8
 *)&
¥eOnOff
Ë=
ZCL_STA_SUCCESS
) ){

73 
boﬁ
 
d°OnOff
 = 0;

75 if(
°¨tUpOnOff
 =
ZCL_START_UP_ONOFF_SET_ONOFF_TO_OFF
){

76 
d°OnOff
 = 
ZCL_ONOFF_STATUS_OFF
;

77 }if(
°¨tUpOnOff
 =
ZCL_START_UP_ONOFF_SET_ONOFF_TO_ON
){

78 
d°OnOff
 = 
ZCL_ONOFF_STATUS_ON
;

79 }if(
°¨tUpOnOff
 =
ZCL_START_UP_ONOFF_SET_ONOFF_TOGGLE
){

80 
d°OnOff
 = (
¥eOnOff
 =
ZCL_ONOFF_STATUS_ON
Ë? 
ZCL_ONOFF_STATUS_OFF
 : ZCL_ONOFF_STATUS_ON;

81 }if(
°¨tUpOnOff
 =
ZCL_START_UP_ONOFF_SET_ONOFF_TO_PREVIOUS
){

82 
d°OnOff
 = 
¥eOnOff
;

85 if(
d°OnOff
 !
¥eOnOff
){

86 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_ATTRID_ONOFF
, (
u8
 *)&
d°OnOff
);

89 
	}
}

92 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

94  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_ONOFF_ON
, 
TRUE
,

95 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

96 
	}
}

98 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_off
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

100  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_ONOFF_OFF
, 
TRUE
,

101 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

102 
	}
}

104 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_toggÀ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

106  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_ONOFF_TOGGLE
, 
TRUE
,

107 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

108 
	}
}

110 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_offWôhEf„˘
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_⁄off_offWôhEf„˘Cmd_t
 *
pOffWôhEf„˘
)

112 
u8
 
buf
[2];

114 
buf
[0] = 
pOffWôhEf„˘
->
ef„˘Id
;

115 
buf
[1] = 
pOffWôhEf„˘
->
ef„˘V¨ü¡
;

117  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_OFF_WITH_EFFECT
, 
TRUE
,

118 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

119 
	}
}

121 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_⁄WôhReˇŒGlobÆS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

123  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_ON_WITH_RECALL_GLOBAL_SCENE
, 
TRUE
,

124 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

125 
	}
}

127 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_⁄WôhTimedOff
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_⁄off_⁄WôhTimeOffCmd_t
 *
pOnWôhTimedOff
)

129 
u8
 
buf
[5];

131 
buf
[0] = 
pOnWôhTimedOff
->
⁄OffCål
.onOffCtrl;

132 
buf
[1] = 
	`LO_UINT16
(
pOnWôhTimedOff
->
⁄Time
);

133 
buf
[2] = 
	`HI_UINT16
(
pOnWôhTimedOff
->
⁄Time
);

134 
buf
[3] = 
	`LO_UINT16
(
pOnWôhTimedOff
->
offWaôTime
);

135 
buf
[4] = 
	`HI_UINT16
(
pOnWôhTimedOff
->
offWaôTime
);

137  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_ON_OFF
, 
ZCL_CMD_ON_WITH_TIMED_OFF
, 
TRUE
,

138 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 5, 
buf
);

139 
	}
}

142 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

144 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

145 
u8
 *
pD©a
 = 
pInMsg
->pData;

147 
z˛_⁄off_cmdPaylﬂd_t
 
cmdPaylﬂd
;

148 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_⁄off_cmdPaylﬂd_t
));

150 
pInMsg
->
hdr
.
cmd
)

152 
ZCL_CMD_ONOFF_OFF
:

153 
ZCL_CMD_ONOFF_ON
:

154 
ZCL_CMD_ONOFF_TOGGLE
:

155 
ZCL_CMD_ON_WITH_RECALL_GLOBAL_SCENE
:

158 
ZCL_CMD_OFF_WITH_EFFECT
:

159 
cmdPaylﬂd
.
offWôhEf„˘
.
ef„˘Id
 = 
pD©a
[0];

160 
cmdPaylﬂd
.
offWôhEf„˘
.
ef„˘V¨ü¡
 = 
pD©a
[1];

162 
ZCL_CMD_ON_WITH_TIMED_OFF
:

163 
cmdPaylﬂd
.
⁄WôhTimeOff
.
⁄OffCål
.⁄OffCå»*
pD©a
++;

164 
cmdPaylﬂd
.
⁄WôhTimeOff
.
⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

165 
pD©a
 += 2;

166 
cmdPaylﬂd
.
⁄WôhTimeOff
.
offWaôTime
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

167 
pD©a
 += 2;

170 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

174 if(
°©us
 =
ZCL_STA_SUCCESS
){

175 if(
pInMsg
->
˛u°îAµCb
){

176 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

178 #ifde‡
ZCL_SCENE


179 
u16
 
©åLí
 = 0;

180 
u8
 
s˚√VÆid
 = 0;

181 if(
	`z˛_gëAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, &
©åLí
, (
u8
 *)&
s˚√VÆid
Ë=
ZCL_STA_SUCCESS
){

182 
s˚√VÆid
 = 0;

183 
	`z˛_£tAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, (
u8
 *)&
s˚√VÆid
);

189  
°©us
;

190 
	}
}

192 
_CODE_ZCL_
 
°©us_t
 
	$z˛_⁄Off_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

194 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

195  
	`z˛_⁄Off_˛õ¡CmdH™dÀr
(
pInMsg
);

197  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

199 
	}
}

	@zigbee/zcl/general/zcl_onoff.h

24 #i‚de‡
ZCL_ON_OFF_H


25 
	#ZCL_ON_OFF_H


	)

48 
	#ZCL_CMD_ONOFF_OFF
 0x00

	)

49 
	#ZCL_CMD_ONOFF_ON
 0x01

	)

50 
	#ZCL_CMD_ONOFF_TOGGLE
 0x02

	)

51 
	#ZCL_CMD_OFF_WITH_EFFECT
 0x40

	)

52 
	#ZCL_CMD_ON_WITH_RECALL_GLOBAL_SCENE
 0x41

	)

53 
	#ZCL_CMD_ON_WITH_TIMED_OFF
 0x42

	)

59 
	#ZCL_ATTRID_ONOFF
 0x0000

	)

60 
	#ZCL_ATTRID_GLOBAL_SCENE_CONTROL
 0x4000

	)

61 
	#ZCL_ATTRID_ON_TIME
 0x4001

	)

62 
	#ZCL_ATTRID_OFF_WAIT_TIME
 0x4002

	)

63 
	#ZCL_ATTRID_START_UP_ONOFF
 0x4003

	)

71 
	#ZCL_ONOFF_STATUS_OFF
 0x00

	)

72 
	#ZCL_ONOFF_STATUS_ON
 0x01

	)

73 
	#ZCL_ONOFF_STATUS_DELAYED_OFF
 0x02

	)

74 
	#ZCL_ONOFF_STATUS_TIMED_ON
 0x03

	)

81 
	#ZCL_OFF_EFFECT_DELAYED_ALL_OFF
 0x00

	)

82 
	#ZCL_OFF_EFFECT_DYING_LIGHT
 0x01

	)

86 
	#ZCL_START_UP_ONOFF_SET_ONOFF_TO_OFF
 0x00

	)

87 
	#ZCL_START_UP_ONOFF_SET_ONOFF_TO_ON
 0x01

	)

88 
	#ZCL_START_UP_ONOFF_SET_ONOFF_TOGGLE
 0x02

	)

89 
	#ZCL_START_UP_ONOFF_SET_ONOFF_TO_PREVIOUS
 0xFF

	)

99 
u8
 
	mef„˘Id
;

100 
u8
 
	mef„˘V¨ü¡
;

101 }
	tz˛_⁄off_offWôhEf„˘Cmd_t
;

105 
u8
 
	mac˚±O∆yWhíOn
:1;

106 
u8
 
	mª£rved
:7;

107 }
	mbôs
;

108 
u8
 
	m⁄OffCål
;

109 }
	tz˛_⁄offCål_t
;

115 
z˛_⁄offCål_t
 
	m⁄OffCål
;

116 
u16
 
	m⁄Time
;

117 
u16
 
	moffWaôTime
;

118 }
	tz˛_⁄off_⁄WôhTimeOffCmd_t
;

124 
z˛_⁄off_offWôhEf„˘Cmd_t
 
	moffWôhEf„˘
;

125 
z˛_⁄off_⁄WôhTimeOffCmd_t
 
	m⁄WôhTimeOff
;

126 }
	tz˛_⁄off_cmdPaylﬂd_t
;

136 (*
	tz˛_OnOffCb_t
)(
	tu8
 
	tcmdId
, 
	tz˛_⁄off_cmdPaylﬂd_t
 *
	tcmdPaylﬂd
);

142 
z˛_OnOffCb_t
 
⁄OffCbFunc
;

143 } 
	tz˛_⁄Off_AµCÆlbacks_t
;

153 #ifde‡
ZCL_ATTR_ON_TIME_ENABLE


154 
u16
 
⁄Time
;

156 #ifde‡
ZCL_ATTR_OFF_WAIT_TIME_ENABLE


157 
u16
 
offWaôTime
;

159 #ifde‡
ZCL_ATTR_ONOFF_ENABLE


160 
u8
 
⁄Off
;

162 #ifde‡
ZCL_ATTR_GLOBAL_SCENE_CONTROL_ENABLE


163 
u8
 
globÆS˚√C⁄åﬁ
;

165 #ifde‡
ZCL_ATTR_START_UP_ONOFF_ENABLE


166 
u8
 
°¨tUpOnOff
;

168 }
	tz˛_⁄off_©å_t
;

177 
z˛_⁄off_©å_t
 
g_z˛OnOffAâr
;

178 
	#z˛_⁄offAârGë
(Ë&
g_z˛OnOffAâr


	)

180 
	#ZCL_ONOFF_ONTIME_SET
(
v
Ë
g_z˛OnOffAâr
.
⁄Time
 = (v)

	)

181 
	#ZCL_ONOFF_ONTIME_GET
(Ë
g_z˛OnOffAâr
.
⁄Time


	)

183 
	#ZCL_ONOFF_GLBSCENEEN_SET
(
v
Ë
g_z˛OnOffAâr
.
globÆS˚√C⁄åﬁ
 = (v)

	)

184 
	#ZCL_ONOFF_GLBSCENEEN_GET
(Ë
g_z˛OnOffAâr
.
globÆS˚√C⁄åﬁ


	)

186 
	#ZCL_ONOFF_ONOFF_SET
(
v
Ë
g_z˛OnOffAâr
.
⁄Off
 = (v)

	)

187 
	#ZCL_ONOFF_ONOFF_GET
(Ë
g_z˛OnOffAâr
.
⁄Off


	)

189 
	#ZCL_ONOFF_OFFWAITTIME_SET
(
v
Ë
g_z˛OnOffAâr
.
offWaôTime
 = (v)

	)

190 
	#ZCL_ONOFF_OFFWAITTIME_GET
(Ë
g_z˛OnOffAâr
.
offWaôTime


	)

195 c⁄° 
z˛AârInfo_t
 
⁄off_©åTbl
[];

197 c⁄° 
u8
 
z˛_⁄Off_©åNum
;

214 
°©us_t
 
	`z˛_⁄Off_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

227 
°©us_t
 
	`z˛_⁄Off_⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

228 
	#z˛_⁄Off_⁄Cmd
(
a
,
b
,
c
Ë(
	`z˛_⁄Off_⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

240 
°©us_t
 
	`z˛_⁄Off_off
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

241 
	#z˛_⁄Off_offCmd
(
a
,
b
,
c
Ë(
	`z˛_⁄Off_off
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

253 
°©us_t
 
	`z˛_⁄Off_toggÀ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

254 
	#z˛_⁄Off_toggÀCmd
(
a
,
b
,
c
Ë(
	`z˛_⁄Off_toggÀ
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

266 
°©us_t
 
	`z˛_⁄Off_offWôhEf„˘
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_⁄off_offWôhEf„˘Cmd_t
 *
pOffWôhEf„˘
);

267 
	#z˛_⁄Off_offWôhEf„˘Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_⁄Off_offWôhEf„˘
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

279 
°©us_t
 
	`z˛_⁄Off_⁄WôhReˇŒGlobÆS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

280 
	#z˛_⁄Off_⁄WôhReˇŒGlobÆS˚√Cmd
(
a
,
b
,
c
Ë(
	`z˛_⁄Off_⁄WôhReˇŒGlobÆS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

292 
°©us_t
 
	`z˛_⁄Off_⁄WôhTimedOff
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_⁄off_⁄WôhTimeOffCmd_t
 *
pOnWôhTimedOff
);

293 
	#z˛_⁄Off_⁄WôhTimedOffCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_⁄Off_⁄WôhTimedOff
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/general/zcl_onoff_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_ON_OFF


48 
z˛_⁄off_©å_t
 
	gg_z˛OnOffAâr
 = {

49 #ifde‡
ZCL_ATTR_ON_TIME_ENABLE


50 .
⁄Time
 = 0,

52 #ifde‡
ZCL_ATTR_OFF_WAIT_TIME_ENABLE


53 .
	goffWaôTime
 = 0,

55 #ifde‡
ZCL_ATTR_ONOFF_ENABLE


56 .
	g⁄Off
 = 0,

58 #ifde‡
ZCL_ATTR_GLOBAL_SCENE_CONTROL_ENABLE


59 .
	gglobÆS˚√C⁄åﬁ
 = 
TRUE
,

61 #ifde‡
ZCL_ATTR_START_UP_ONOFF_ENABLE


62 .
	g°¨tUpOnOff
 = 
ZCL_START_UP_ONOFF_SET_DEFAULT
,

67 c⁄° 
z˛AârInfo_t
 
	g⁄off_©åTbl
[] =

69 #ifde‡
ZCL_ATTR_ONOFF_ENABLE


70 { 
ZCL_ATTRID_ONOFF
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
g_z˛OnOffAâr
.
⁄Off
},

72 #ifde‡
ZCL_ATTR_GLOBAL_SCENE_CONTROL_ENABLE


73 { 
ZCL_ATTRID_GLOBAL_SCENE_CONTROL
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
g_z˛OnOffAâr
.
globÆS˚√C⁄åﬁ
},

75 #ifde‡
ZCL_ATTR_ON_TIME_ENABLE


76 { 
ZCL_ATTRID_ON_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
g_z˛OnOffAâr
.
⁄Time
},

78 #ifde‡
ZCL_ATTR_OFF_WAIT_TIME_ENABLE


79 { 
ZCL_ATTRID_OFF_WAIT_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
g_z˛OnOffAâr
.
offWaôTime
},

81 #ifde‡
ZCL_ATTR_START_UP_ONOFF_ENABLE


82 { 
ZCL_ATTRID_START_UP_ONOFF
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
g_z˛OnOffAâr
.
°¨tUpOnOff
},

84 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

87 c⁄° 
u8
 
	gz˛_⁄Off_©åNum
 = ( (
⁄off_©åTbl
Ë/ (
z˛AârInfo_t
) );

89 
nv_°s_t
 
	$z˛_⁄Off_ßveAâr
()

91  
	`z˛_©å_⁄OffP¨ams_ßve
();

92 
	}
}

94 
nv_°s_t
 
	$z˛_⁄Off_lﬂdAâr
()

96  
	`z˛_©å_⁄OffP¨ams_ª°‹e
();

97 
	}
}

	@zigbee/zcl/general/zcl_pollCtrl.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_POLL_CTRL


49 
°©us_t
 
z˛_pﬁlCål_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_pﬁlCål_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_chkIn
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

60  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
ZCL_CMD_CHK_IN
, 
TRUE
,

61 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

62 
	}
}

64 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_chkInR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_chkInR•_t
 *
pCheckInR•
)

66 
u8
 
buf
[3];

68 
buf
[0] = 
pCheckInR•
->
°¨tFa°Pﬁlög
;

69 
buf
[1] = 
	`LO_UINT16
(
pCheckInR•
->
Á°PﬁlTimeout
);

70 
buf
[2] = 
	`HI_UINT16
(
pCheckInR•
->
Á°PﬁlTimeout
);

72  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
ZCL_CMD_CHK_IN_RSP
, 
TRUE
,

73 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

74 
	}
}

76 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_Á°PﬁlSt›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

78  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
ZCL_CMD_FAST_POLL_STOP
, 
TRUE
,

79 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

80 
	}
}

82 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_£tL⁄gPﬁlI¡îvÆ_t
 *
pSëL⁄gPﬁlI¡îvÆ
)

84 
u8
 
buf
[4];

86 
buf
[0] = 
	`U32_BYTE0
(
pSëL⁄gPﬁlI¡îvÆ
->
√wL⁄gPﬁlI¡îvÆ
);

87 
buf
[1] = 
	`U32_BYTE1
(
pSëL⁄gPﬁlI¡îvÆ
->
√wL⁄gPﬁlI¡îvÆ
);

88 
buf
[2] = 
	`U32_BYTE2
(
pSëL⁄gPﬁlI¡îvÆ
->
√wL⁄gPﬁlI¡îvÆ
);

89 
buf
[3] = 
	`U32_BYTE3
(
pSëL⁄gPﬁlI¡îvÆ
->
√wL⁄gPﬁlI¡îvÆ
);

91  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
ZCL_CMD_SET_LONG_POLL_INTERVAL
, 
TRUE
,

92 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 4, 
buf
);

93 
	}
}

95 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_£tSh‹tPﬁlI¡îvÆ_t
 *
pSëSh‹tPﬁlI¡îvÆ
)

97 
u8
 
buf
[2];

99 
buf
[0] = 
	`LO_UINT16
(
pSëSh‹tPﬁlI¡îvÆ
->
√wSh‹tPﬁlI¡îvÆ
);

100 
buf
[1] = 
	`HI_UINT16
(
pSëSh‹tPﬁlI¡îvÆ
->
√wSh‹tPﬁlI¡îvÆ
);

102  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_POLL_CONTROL
, 
ZCL_CMD_SET_LONG_POLL_INTERVAL
, 
TRUE
,

103 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

104 
	}
}

106 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_chkInR•Prc
(
z˛Incomög_t
 *
pInMsg
)

108 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

110 if(
pInMsg
->
˛u°îAµCb
){

111 
z˛_chkInR•_t
 
∑ylﬂd
;

112 
∑ylﬂd
.
°¨tFa°Pﬁlög
 = 
pInMsg
->
pD©a
[0];

113 
∑ylﬂd
.
Á°PﬁlTimeout
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[1],ÖInMsg->pData[2]);

115 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
∑ylﬂd
);

117 
°©us
 = 
ZCL_STA_FAILURE
;

120  
°©us
;

121 
	}
}

123 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_Á°PﬁlSt›Prc
(
z˛Incomög_t
 *
pInMsg
)

125 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

127 if(
pInMsg
->
˛u°îAµCb
){

128 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

130 
°©us
 = 
ZCL_STA_FAILURE
;

133  
°©us
;

134 
	}
}

136 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆPrc
(
z˛Incomög_t
 *
pInMsg
)

138 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

140 if(
pInMsg
->
˛u°îAµCb
){

141 
z˛_£tL⁄gPﬁlI¡îvÆ_t
 
∑ylﬂd
;

142 
∑ylﬂd
.
√wL⁄gPﬁlI¡îvÆ
 = 
	`BUILD_U32
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1],ÖInMsg->pData[2],ÖInMsg->pData[3]);

144 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
∑ylﬂd
);

146 
°©us
 = 
ZCL_STA_FAILURE
;

149  
°©us
;

150 
	}
}

152 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆPrc
(
z˛Incomög_t
 *
pInMsg
)

154 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

156 if(
pInMsg
->
˛u°îAµCb
){

157 
z˛_£tSh‹tPﬁlI¡îvÆ_t
 
∑ylﬂd
;

158 
∑ylﬂd
.
√wSh‹tPﬁlI¡îvÆ
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

160 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
∑ylﬂd
);

162 
°©us
 = 
ZCL_STA_FAILURE
;

165  
°©us
;

166 
	}
}

168 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_chkInPrc
(
z˛Incomög_t
 *
pInMsg
)

170 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

172 if(
pInMsg
->
˛u°îAµCb
){

173 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

175 
°©us
 = 
ZCL_STA_FAILURE
;

178  
°©us
;

179 
	}
}

181 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

183 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

185 
pInMsg
->
hdr
.
cmd
)

187 
ZCL_CMD_CHK_IN_RSP
:

188 
°©us
 = 
	`z˛_pﬁlCål_chkInR•Prc
(
pInMsg
);

190 
ZCL_CMD_FAST_POLL_STOP
:

191 
°©us
 = 
	`z˛_pﬁlCål_Á°PﬁlSt›Prc
(
pInMsg
);

193 
ZCL_CMD_SET_LONG_POLL_INTERVAL
:

194 
°©us
 = 
	`z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆPrc
(
pInMsg
);

196 
ZCL_CMD_SET_SHORT_POLL_INTERVAL
:

197 
°©us
 = 
	`z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆPrc
(
pInMsg
);

200 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

204  
°©us
;

205 
	}
}

207 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

209 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

211 
pInMsg
->
hdr
.
cmd
)

213 
ZCL_CMD_CHK_IN
:

214 
°©us
 = 
	`z˛_pﬁlCål_chkInPrc
(
pInMsg
);

217 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

221  
°©us
;

222 
	}
}

224 
_CODE_ZCL_
 
°©us_t
 
	$z˛_pﬁlCål_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

226 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

227  
	`z˛_pﬁlCål_˛õ¡CmdH™dÀr
(
pInMsg
);

229  
	`z˛_pﬁlCål_£rvîCmdH™dÀr
(
pInMsg
);

231 
	}
}

	@zigbee/zcl/general/zcl_pollCtrl.h

24 #i‚de‡
ZCL_POLL_CTRL_H


25 
	#ZCL_POLL_CTRL_H


	)

33 
	#ZCL_CMD_CHK_IN_RSP
 0x00

	)

34 
	#ZCL_CMD_FAST_POLL_STOP
 0x01

	)

35 
	#ZCL_CMD_SET_LONG_POLL_INTERVAL
 0x02

	)

36 
	#ZCL_CMD_SET_SHORT_POLL_INTERVAL
 0x03

	)

39 
	#ZCL_CMD_CHK_IN
 0x00

	)

45 
	#ZCL_ATTRID_CHK_IN_INTERVAL
 0x0000

	)

46 
	#ZCL_ATTRID_LONG_POLL_INTERVAL
 0x0001

	)

47 
	#ZCL_ATTRID_SHORT_POLL_INTERVAL
 0x0002

	)

48 
	#ZCL_ATTRID_FAST_POLL_TIMEOUT
 0x0003

	)

49 
	#ZCL_ATTRID_CHK_IN_INTERVAL_MIN
 0x0004

	)

50 
	#ZCL_ATTRID_LONG_POLL_INTERVAL_MIN
 0x0005

	)

51 
	#ZCL_ATTRID_FAST_POLL_TIMEOUT_MAX
 0x0006

	)

57 
boﬁ
 
	m°¨tFa°Pﬁlög
;

58 
u16
 
	mÁ°PﬁlTimeout
;

59 }
	tz˛_chkInR•_t
;

65 
u32
 
	m√wL⁄gPﬁlI¡îvÆ
;

66 }
	tz˛_£tL⁄gPﬁlI¡îvÆ_t
;

72 
u16
 
	m√wSh‹tPﬁlI¡îvÆ
;

73 }
	tz˛_£tSh‹tPﬁlI¡îvÆ_t
;

82 
	$°©us_t
 (*
	tz˛_pﬁlCål_chkInR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_chkInR•_t
 *
	tpCmd
);

83 
	$°©us_t
 (*
	tz˛_pﬁlCål_Á°PﬁlSt›Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

84 
	$°©us_t
 (*
	tz˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_£tL⁄gPﬁlI¡îvÆ_t
 *
	tpCmd
);

85 
	$°©us_t
 (*
	tz˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_£tSh‹tPﬁlI¡îvÆ_t
 *
	tpCmd
);

86 
	$°©us_t
 (*
	tz˛_pﬁlCål_chkInCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 
	t£qNum
);

92 
z˛_pﬁlCål_chkInR•Cb_t
 
pﬁlCålChkInR•CbFunc
;

93 
z˛_pﬁlCål_Á°PﬁlSt›Cb_t
 
pﬁlCålFa°PﬁlSt›CbFunc
;

94 
z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆCb_t
 
pﬁlCålSëL⁄gPﬁlI¡îvÆCbFunc
;

95 
z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆCb_t
 
pﬁlCålSëSh‹tPﬁlI¡îvÆCbFunc
;

96 
z˛_pﬁlCål_chkInCb_t
 
pﬁlCålChkInCbFunc
;

97 }
	tz˛_pﬁlCål_AµCÆlbacks_t
;

104 
u32
 
chkInI¡îvÆ
;

105 
u32
 
l⁄gPﬁlI¡îvÆ
;

106 
u32
 
chkInI¡îvÆMö
;

107 
u32
 
l⁄gPﬁlI¡îvÆMö
;

108 
u16
 
sh‹tPﬁlI¡îvÆ
;

109 
u16
 
Á°PﬁlTimeout
;

110 
u16
 
Á°PﬁlTimeoutMax
;

111 }
	tz˛_pﬁlCål_©å_t
;

116 
z˛_pﬁlCål_©å_t
 
gZ˛PﬁlCålAâr
;

121 c⁄° 
z˛AârInfo_t
 
pﬁlCål_©åTbl
[];

123 c⁄° 
u8
 
z˛_pﬁlCål_©åNum
;

127 
°©us_t
 
	`z˛_pﬁlCål_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

129 
°©us_t
 
	`z˛_pﬁlCål_chkIn
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

130 
	#z˛_pﬁlCål_checkInCmd
(
a
,
b
,
c
Ë(
	`z˛_pﬁlCål_chkIn
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

132 
°©us_t
 
	`z˛_pﬁlCål_chkInR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_chkInR•_t
 *
pCheckInR•
);

133 
	#z˛_pﬁlCål_chkInR•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_pﬁlCål_chkInR•
(◊), (b), (c), (d), (e)))

	)

135 
°©us_t
 
	`z˛_pﬁlCål_Á°PﬁlSt›
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

136 
	#z˛_pﬁlCål_Á°PﬁlSt›Cmd
(
a
,
b
,
c
Ë(
	`z˛_pﬁlCål_Á°PﬁlSt›
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

138 
°©us_t
 
	`z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_£tL⁄gPﬁlI¡îvÆ_t
 *
pSëL⁄gPﬁlI¡îvÆ
);

139 
	#z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_pﬁlCål_£tL⁄gPﬁlI¡îvÆ
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

141 
°©us_t
 
	`z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆ
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_£tSh‹tPﬁlI¡îvÆ_t
 *
pSëSh‹tPﬁlI¡îvÆ
);

142 
	#z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_pﬁlCål_£tSh‹tPﬁlI¡îvÆ
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/general/zcl_pollCtrl_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_POLL_CTRL


49 
z˛_pﬁlCål_©å_t
 
	ggZ˛PﬁlCålAâr
 = {

50 .
chkInI¡îvÆ
 = 0x3840,

51 .
	gl⁄gPﬁlI¡îvÆ
 = 0x14,

52 .
	gsh‹tPﬁlI¡îvÆ
 = 0x02,

53 .
	gÁ°PﬁlTimeout
 = 0x28,

54 .
	gchkInI¡îvÆMö
 = 0x28,

55 .
	gl⁄gPﬁlI¡îvÆMö
 = 0x0c,

56 .
	gÁ°PﬁlTimeoutMax
 = 0xf0,

60 c⁄° 
z˛AârInfo_t
 
	gpﬁlCål_©åTbl
[] =

62 { 
ZCL_ATTRID_CHK_IN_INTERVAL
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
gZ˛PﬁlCålAâr
.
chkInI¡îvÆ
 },

63 { 
ZCL_ATTRID_LONG_POLL_INTERVAL
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
gZ˛PﬁlCålAâr
.
l⁄gPﬁlI¡îvÆ
 },

64 { 
ZCL_ATTRID_SHORT_POLL_INTERVAL
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
gZ˛PﬁlCålAâr
.
sh‹tPﬁlI¡îvÆ
 },

65 { 
ZCL_ATTRID_FAST_POLL_TIMEOUT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
gZ˛PﬁlCålAâr
.
Á°PﬁlTimeout
 },

66 { 
ZCL_ATTRID_CHK_IN_INTERVAL_MIN
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
gZ˛PﬁlCålAâr
.
chkInI¡îvÆMö
},

67 { 
ZCL_ATTRID_LONG_POLL_INTERVAL_MIN
,
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
gZ˛PﬁlCålAâr
.
l⁄gPﬁlI¡îvÆMö
 },

68 { 
ZCL_ATTRID_FAST_POLL_TIMEOUT_MAX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
gZ˛PﬁlCålAâr
.
Á°PﬁlTimeoutMax
},

69 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

72 c⁄° 
u8
 
	gz˛_pﬁlCål_©åNum
 = ( (
pﬁlCål_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_powerCfg.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_POWER_CFG


48 
_CODE_ZCL_
 
°©us_t
 
	$z˛_powîCfg_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

50  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_POWER_CFG
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

51 
	}
}

	@zigbee/zcl/general/zcl_powerCfg.h

24 #i‚de‡
ZCL_POWER_CFG_H


25 
	#ZCL_POWER_CFG_H


	)

30 
	#ZCL_ATTRID_MAINS_VOLTAGE
 0x0000

	)

31 
	#ZCL_ATTRID_MAINS_FREQUENCY
 0x0001

	)

32 
	#ZCL_ATTRID_MAINS_ALARM_MASK
 0x0010

	)

33 
	#ZCL_ATTRID_MAINS_VOLTAGE_MIN_THRESHOLD
 0x0011

	)

34 
	#ZCL_ATTRID_MAINS_VOLTAGE_MAX_THRESHOLD
 0x0012

	)

35 
	#ZCL_ATTRID_MAINS_VOLTAGE_DWELL_TRIP_POINT
 0x0013

	)

36 
	#ZCL_ATTRID_BATTERY_VOLTAGE
 0x0020

	)

37 
	#ZCL_ATTRID_BATTERY_PERCENTAGE_REMAINING
 0x0021

	)

38 
	#ZCL_ATTRID_BATTERY_MANUFACTURER
 0x0030

	)

39 
	#ZCL_ATTRID_BATTERY_SIZE
 0x0031

	)

40 
	#ZCL_ATTRID_BATTERY_A_HR_RATING
 0x0032

	)

41 
	#ZCL_ATTRID_BATTERY_QUANTITY
 0x0033

	)

42 
	#ZCL_ATTRID_BATTERY_RATED_VOLTAGE
 0x0034

	)

43 
	#ZCL_ATTRID_BATTERY_ALARM_MASK
 0x0035

	)

44 
	#ZCL_ATTRID_BATTERY_VOLTAGE_MIN_THRESHOLD
 0x0036

	)

45 
	#ZCL_ATTRID_BATTERY_VOLTAGE_THRESHOLD_1
 0x0037

	)

46 
	#ZCL_ATTRID_BATTERY_VOLTAGE_THRESHOLD_2
 0x0038

	)

47 
	#ZCL_ATTRID_BATTERY_VOLTAGE_THRESHOLD_3
 0x0039

	)

48 
	#ZCL_ATTRID_BATTERY_PERCENTAGE_MIN_THRESHOLD
 0x003A

	)

49 
	#ZCL_ATTRID_BATTERY_PERCENTAGE_THRESHOLD_1
 0x003B

	)

50 
	#ZCL_ATTRID_BATTERY_PERCENTAGE_THRESHOLD_2
 0x003C

	)

51 
	#ZCL_ATTRID_BATTERY_PERCENTAGE_THRESHOLD_3
 0x003D

	)

52 
	#ZCL_ATTRID_BATTERY_ALARM_STATE
 0x003E

	)

58 
°©us_t
 
z˛_powîCfg_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_powerCfg_attr.c

25 
	~"é_comm⁄.h
"

26 
	~"../z˛_ö˛ude.h
"

28 #ifde‡
ZCL_POWER


30 
u16
 
	gz˛_powî_c⁄fig_©å_MaösVﬁège
 ;

31 
u8
 
	gz˛_powî_c⁄fig_©å_MaösFªquícy
 ;

32 
u8
 
	gz˛_powî_c⁄fig_©å_MaösAœrmMask
 ;

33 
u16
 
	gz˛_powî_c⁄fig_©å_MaösVﬁègeMöThªshﬁd
 ;

34 
u16
 
	gz˛_powî_c⁄fig_©å_MaösVﬁègeMaxThªshﬁd
 = 0xffff ;

35 
u16
 
	gz˛_powî_c⁄fig_©å_MaösVﬁègeDwñlTrùPoöt
 ;

36 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryVﬁège
 ;

37 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryPî˚¡ageRemaöög
 ;

38 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryM™uÁ˘uªr
[
ZCL_BATTERYMANUFACTURER_MAX_LENGTH
 + 1] ;

39 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãrySize
 = 0xff ;

40 
u16
 
	gz˛_powî_c⁄fig_©å_B©ãryAHrR©ög
 ;

41 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryQu™tôy
 ;

42 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryR©edVﬁège
 ;

43 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryAœrmMask
 ;

44 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryVﬁègeMöThªshﬁd
 ;

45 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd1
 ;

46 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd2
 ;

47 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd3
 ;

48 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryPî˚¡ageMöThªshﬁd
 ;

49 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd1
 ;

50 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd2
 ;

51 
u8
 
	gz˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd3
 ;

52 
u32
 
	gz˛_powî_c⁄fig_©å_B©ãryAœrmSèã
 ;

55 c⁄° 
z˛AârInfo_t
 
	gpowî_c⁄fig_©åTbl
[] =

57 {
ZCL_POWER_CONFIG_ATTRID_MAINSVOLTAGE
 ,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösVﬁège
 },

58 {
ZCL_POWER_CONFIG_ATTRID_MAINSFREQUENCY
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösFªquícy
 },

59 {
ZCL_POWER_CONFIG_ATTRID_MAINSALARMMASK
 ,
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösAœrmMask
 },

60 {
ZCL_POWER_CONFIG_ATTRID_MAINSVOLTAGEMINTHRESHOLD
 ,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösVﬁègeMöThªshﬁd
 },

61 {
ZCL_POWER_CONFIG_ATTRID_MAINSVOLTAGEMAXTHRESHOLD
 ,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösVﬁègeMaxThªshﬁd
 },

62 {
ZCL_POWER_CONFIG_ATTRID_MAINSVOLTAGEDWELLTRIPPOINT
 ,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_MaösVﬁègeDwñlTrùPoöt
 },

63 {
ZCL_POWER_CONFIG_ATTRID_BATTERYVOLTAGE
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryVﬁège
 },

64 {
ZCL_POWER_CONFIG_ATTRID_BATTERYPERCENTAGEREMAINING
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_REPORTABLE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryPî˚¡ageRemaöög
 },

65 {
ZCL_POWER_CONFIG_ATTRID_BATTERYMANUFACTURER
 ,
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,
z˛_powî_c⁄fig_©å_B©ãryM™uÁ˘uªr
 },

66 {
ZCL_POWER_CONFIG_ATTRID_BATTERYSIZE
 ,
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãrySize
 },

67 {
ZCL_POWER_CONFIG_ATTRID_BATTERYAHRRATING
 ,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryAHrR©ög
 },

68 {
ZCL_POWER_CONFIG_ATTRID_BATTERYQUANTITY
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryQu™tôy
 },

69 {
ZCL_POWER_CONFIG_ATTRID_BATTERYRATEDVOLTAGE
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryR©edVﬁège
 },

70 {
ZCL_POWER_CONFIG_ATTRID_BATTERYALARMMASK
 ,
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryAœrmMask
 },

71 {
ZCL_POWER_CONFIG_ATTRID_BATTERYVOLTAGEMINTHRESHOLD
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryVﬁègeMöThªshﬁd
 },

72 {
ZCL_POWER_CONFIG_ATTRID_BATTERYVOLTAGETHRESHOLD1
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd1
 },

73 {
ZCL_POWER_CONFIG_ATTRID_BATTERYVOLTAGETHRESHOLD2
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd2
 },

74 {
ZCL_POWER_CONFIG_ATTRID_BATTERYVOLTAGETHRESHOLD3
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryVﬁègeThªshﬁd3
 },

75 {
ZCL_POWER_CONFIG_ATTRID_BATTERYPERCENTAGEMINTHRESHOLD
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryPî˚¡ageMöThªshﬁd
 },

76 {
ZCL_POWER_CONFIG_ATTRID_BATTERYPERCENTAGETHRESHOLD1
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd1
 },

77 {
ZCL_POWER_CONFIG_ATTRID_BATTERYPERCENTAGETHRESHOLD2
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd2
 },

78 {
ZCL_POWER_CONFIG_ATTRID_BATTERYPERCENTAGETHRESHOLD3
 ,
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryPî˚¡ageThªshﬁd3
 },

79 {
ZCL_POWER_CONFIG_ATTRID_BATTERYALARMSTATE
 ,
ZCL_DATA_TYPE_BITMAP32
, 
ACCESS_CONTROL_READ
,(
u8
*)&
z˛_powî_c⁄fig_©å_B©ãryAœrmSèã
 },

80 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

83 c⁄° 
u8
 
	gz˛_powîC⁄fig_©åNum
 = ( (
powî_c⁄fig_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/general/zcl_scene.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_SCENE


44 
z˛_s˚√TabÀ_t
 
	gg_z˛_s˚√Tab
[
ZCL_SCENE_TABLE_NUM
];

49 
z˛_s˚√_s˚√TabCÀ¨
();

50 
nv_°s_t
 
z˛_s˚√sRe°‹e
();

51 
nv_°s_t
 
z˛_s˚√sSave
(
u8
 
ídpoöt
);

52 
z˛_s˚√_upd©eS˚√C¡Aâr
(
u8
 
ídpoöt
);

53 
°©us_t
 
z˛_s˚√_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

56 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

58 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

60 if(
	`z˛_s˚√sRe°‹e
(Ë!
NV_SUCC
){

61 
	`z˛_s˚√_s˚√TabCÀ¨
();

64 
°©us
 = 
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_s˚√_cmdH™dÀr
, 
cb
);

66 if(
°©us
 =
ZCL_STA_SUCCESS
){

67 
	`z˛_s˚√_upd©eS˚√C¡Aâr
(
ídpoöt
);

70  
°©us
;

71 
	}
}

74 
_CODE_ZCL_
 
nv_°s_t
 
	$z˛_s˚√sSave
(
u8
 
ídpoöt
)

76 
	`z˛_s˚√_upd©eS˚√C¡Aâr
(
ídpoöt
);

78  
	`z˛_s˚√TabÀ_ßve
();

79 
	}
}

81 
_CODE_ZCL_
 
nv_°s_t
 
	$z˛_s˚√sRe°‹e
()

83  
	`z˛_s˚√TabÀ_ª°‹e
();

84 
	}
}

87 
_CODE_ZCL_
 
	$z˛_s˚√_˛órE¡ry
(
z˛_s˚√TabÀ_t
 *
pS˚√Tab
)

89 if(
pS˚√Tab
){

90 
pS˚√Tab
->
u£d
 = 0;

91 
pS˚√Tab
->
ídpoöt
 = 0xfe;

92 
	`mem£t
((
u8
 *)&
pS˚√Tab
->
s˚√
, 0, (
z˛_s˚√E¡ry_t
));

94 
	}
}

96 
_CODE_ZCL_
 
	$z˛_s˚√_s˚√TabCÀ¨
()

98 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

99 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

101 
	`z˛_s˚√_˛órE¡ry
(
pS˚√Tab
);

103 
	}
}

105 
_CODE_ZCL_
 
z˛_s˚√TabÀ_t
 *
	$z˛_s˚√_gëFªeE¡ry
()

107 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

108 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

110 if(!
pS˚√Tab
->
u£d
){

111  
pS˚√Tab
;

114  
NULL
;

115 
	}
}

117 
_CODE_ZCL_
 
z˛_s˚√TabÀ_t
 *
	$z˛_s˚√_födE¡ry
(
u8
 
ídpoöt
, 
u16
 
groupId
, u8 
s˚√Id
)

119 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

120 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

122 if(
pS˚√Tab
->
u£d
 && (pS˚√Tab->
ídpoöt
 ==Éndpoint)){

123 if((
pS˚√Tab
->
s˚√
.
groupId
 =groupIdË&& (pS˚√Tab->s˚√.
s˚√Id
 == sceneId)){

124  
pS˚√Tab
;

128  
NULL
;

129 
	}
}

131 
_CODE_ZCL_
 
u8
 
	$z˛_s˚√_gëS˚√U£dNum
()

133 
u8
 
˙t
 = 0;

135 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

136 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

138 if(
pS˚√Tab
->
u£d
){

139 
˙t
++;

143  
˙t
;

144 
	}
}

146 
_CODE_ZCL_
 
	$z˛_s˚√_upd©eS˚√C¡Aâr
(
u8
 
ídpoöt
)

148 
u16
 
©åLí
 = 0;

149 
u8
 
s˚√C¡
 = 0;

151 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_COUNT
, &
©åLí
, (
u8
 *)&
s˚√C¡
Ë=
ZCL_STA_SUCCESS
){

152 
s˚√C¡
 = 
	`z˛_s˚√_gëS˚√U£dNum
();

154 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_COUNT
, (
u8
 *)&
s˚√C¡
);

156 
	}
}

158 
_CODE_ZCL_
 
u8
 
	$z˛_s˚√_födAŒS˚√ByGroup
(
u8
 
ídpoöt
, 
u16
 
groupId
, u8 *
s˚√Li°
)

160 
u8
 
˙t
 = 0;

162 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

163 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

165 if(
pS˚√Tab
->
u£d
 && (pS˚√Tab->
ídpoöt
 =ídpoötË&& (pS˚√Tab->
s˚√
.
groupId
 == groupId)){

166 
s˚√Li°
[
˙t
++] = 
pS˚√Tab
->
s˚√
.
s˚√Id
;

170  
˙t
;

171 
	}
}

173 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_addS˚√E¡ry
(
u8
 
ídpoöt
, 
z˛_s˚√E¡ry_t
 *
pS˚√
)

175 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
pS˚√
->
groupId
,ÖS˚√->
s˚√Id
);

176 if(!
pS˚√E¡ry
){

177 
pS˚√E¡ry
 = 
	`z˛_s˚√_gëFªeE¡ry
();

178 if(!
pS˚√E¡ry
){

180  
ZCL_STA_INSUFFICIENT_SPACE
;

185 
pS˚√E¡ry
->
u£d
 = 1;

186 
pS˚√E¡ry
->
ídpoöt
 =Éndpoint;

187 
	`mem˝y
((
u8
 *)&
pS˚√E¡ry
->
s˚√
, (u8 *)
pS˚√
, (
z˛_s˚√E¡ry_t
));

190 
	`z˛_s˚√sSave
(
ídpoöt
);

192  
ZCL_STA_SUCCESS
;

193 
	}
}

195 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_ªmoveS˚√E¡ry
(
u8
 
ídpoöt
, 
u16
 
groupId
, u8 
s˚√Id
)

197 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
groupId
, 
s˚√Id
);

198 if(
pS˚√E¡ry
){

199 
	`z˛_s˚√_˛órE¡ry
(
pS˚√E¡ry
);

202 
	`z˛_s˚√sSave
(
ídpoöt
);

204  
ZCL_STA_SUCCESS
;

206  
ZCL_STA_NOT_FOUND
;

208 
	}
}

210 
_CODE_ZCL_
 
	$z˛_s˚√_ªmoveAŒS˚√E¡ry
(
u8
 
ídpoöt
, 
u16
 
groupId
, 
boﬁ
 
upd©eNV
)

212 
boﬁ
 
föd
 = 
FALSE
;

213 
u8
 
i
 = 0; i < 
ZCL_SCENE_TABLE_NUM
; i++){

214 
z˛_s˚√TabÀ_t
 *
pS˚√Tab
 = &
g_z˛_s˚√Tab
[
i
];

216 if(
pS˚√Tab
->
u£d
 && (pS˚√Tab->
ídpoöt
 =ídpoötË&& (pS˚√Tab->
s˚√
.
groupId
 == groupId)){

217 
	`z˛_s˚√_˛órE¡ry
(
pS˚√Tab
);

219 
föd
 = 
TRUE
;

223 if(
föd
 && 
upd©eNV
){

225 
	`z˛_s˚√sSave
(
ídpoöt
);

227 
	}
}

229 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_c›yS˚√E¡ry
(
u8
 
ídpoöt
, 
c›yS˚√_t
 *
pC›yS˚√
)

231 
u8
 
s˚√C¡
 = 0;

232 
u8
 
s˚√Li°
[
ZCL_SCENE_TABLE_NUM
] = {0};

233 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
NULL
;

234 
z˛_s˚√TabÀ_t
 *
pS˚√ToE¡ry
 = 
NULL
;

236 if(
	`ZB_SCENE_CLUSTER_COPY_SCENE_MODE_ALL
(
pC›yS˚√
->
mode
)){

237 
s˚√C¡
 = 
	`z˛_s˚√_födAŒS˚√ByGroup
(
ídpoöt
, 
pC›yS˚√
->
groupIdFrom
, 
s˚√Li°
);

238 if(
s˚√C¡
 == 0){

240  
ZCL_STA_INVALID_FIELD
;

243 
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
pC›yS˚√
->
groupIdFrom
,ÖC›yS˚√->
s˚√IdFrom
);

244 if(
pS˚√E¡ry
){

245 
s˚√C¡
 = 1;

246 
s˚√Li°
[0] = 
pC›yS˚√
->
s˚√IdFrom
;

249  
ZCL_STA_INVALID_FIELD
;

253 
u8
 
i
 = 0;

254 
u8
 
addC¡
 = 0;

256 
i
 = 0; i < 
s˚√C¡
; i++){

257 if(
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
pC›yS˚√
->
groupIdTo
, 
s˚√Li°
[
i
]Ë=
NULL
){

258 
addC¡
++;

262 if(
addC¡
 > (
ZCL_SCENE_TABLE_NUM
 - 
	`z˛_s˚√_gëS˚√U£dNum
())){

264  
ZCL_STA_INSUFFICIENT_SPACE
;

268 
i
 = 0; i < 
s˚√C¡
; i++){

270 
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
pC›yS˚√
->
groupIdFrom
, 
s˚√Li°
[
i
]);

271 if(
pS˚√E¡ry
){

272 
u8
 
addS˚√Id
 = 
	`ZB_SCENE_CLUSTER_COPY_SCENE_MODE_ALL
(
pC›yS˚√
->
mode
Ë? 
s˚√Li°
[
i
] :ÖC›yS˚√->
s˚√IdTo
;

274 
pS˚√ToE¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
pC›yS˚√
->
groupIdTo
, 
addS˚√Id
);

275 if(!
pS˚√ToE¡ry
){

276 
pS˚√ToE¡ry
 = 
	`z˛_s˚√_gëFªeE¡ry
();

277 if(!
pS˚√ToE¡ry
){

278  
ZCL_STA_INSUFFICIENT_SPACE
;

283 
pS˚√ToE¡ry
->
u£d
 = 1;

284 
pS˚√ToE¡ry
->
ídpoöt
 =Éndpoint;

285 
	`mem˝y
((
u8
 *)&
pS˚√ToE¡ry
->
s˚√
, (u8 *)&
pS˚√E¡ry
->s˚√, (
z˛_s˚√E¡ry_t
));

286 
pS˚√ToE¡ry
->
s˚√
.
s˚√Id
 = 
addS˚√Id
;

287 
pS˚√ToE¡ry
->
s˚√
.
groupId
 = 
pC›yS˚√
->
groupIdTo
;

292 
	`z˛_s˚√sSave
(
ídpoöt
);

294  
ZCL_STA_SUCCESS
;

295 
	}
}

299 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_addS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
addS˚√_t
 *
pAddS˚√
)

301 
u8
 
Àn
 = 5;

302 
Àn
 +(1 + 
pAddS˚√
->
s˚√
.
s˚√Name
[0]);

303 
Àn
 +
pAddS˚√
->
s˚√
.
extFõldLí
;

305 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

306 if(!
buf
){

307  
ZCL_STA_INSUFFICIENT_SPACE
;

310 
u8
 *
pBuf
 = 
buf
;

312 *
pBuf
++ = 
	`LO_UINT16
(
pAddS˚√
->
s˚√
.
groupId
);

313 *
pBuf
++ = 
	`HI_UINT16
(
pAddS˚√
->
s˚√
.
groupId
);

314 *
pBuf
++ = 
pAddS˚√
->
s˚√
.
s˚√Id
;

315 *
pBuf
++ = 
	`LO_UINT16
(
pAddS˚√
->
s˚√
.
å™sTime
);

316 *
pBuf
++ = 
	`HI_UINT16
(
pAddS˚√
->
s˚√
.
å™sTime
);

317 *
pBuf
++ = 
pAddS˚√
->
s˚√
.
s˚√Name
[0];

318 
	`mem˝y
(
pBuf
, &
pAddS˚√
->
s˚√
.
s˚√Name
[1],ÖAddScene->scene.sceneName[0]);

319 
pBuf
 +
pAddS˚√
->
s˚√
.
s˚√Name
[0];

320 if(
pAddS˚√
->
s˚√
.
extFõldLí
){

321 
	`mem˝y
(
pBuf
, 
pAddS˚√
->
s˚√
.
extFõld
,ÖAddS˚√->s˚√.
extFõldLí
);

322 
pBuf
 +
pAddS˚√
->
s˚√
.
extFõldLí
;

325 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
cmdId
, 
TRUE
,

326 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

328 
	`ev_buf_‰ì
(
buf
);

330  
ZCL_STA_SUCCESS
;

331 
	}
}

333 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_võwS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
võwS˚√_t
 *
pVõwS˚√
)

335 
u8
 
buf
[3];

337 
buf
[0] = 
	`LO_UINT16
(
pVõwS˚√
->
groupId
);

338 
buf
[1] = 
	`HI_UINT16
(
pVõwS˚√
->
groupId
);

339 
buf
[2] = 
pVõwS˚√
->
s˚√Id
;

341  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
cmdId
, 
TRUE
,

342 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

343 
	}
}

345 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_ªmoveS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªmoveS˚√_t
 *
pRemoveS˚√
)

347 
u8
 
buf
[3];

349 
buf
[0] = 
	`LO_UINT16
(
pRemoveS˚√
->
groupId
);

350 
buf
[1] = 
	`HI_UINT16
(
pRemoveS˚√
->
groupId
);

351 
buf
[2] = 
pRemoveS˚√
->
s˚√Id
;

353  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_REMOVE_SCENE
, 
TRUE
,

354 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

355 
	}
}

357 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_ªmoveAŒS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªmoveAŒS˚√_t
 *
pRemoveAŒS˚√
)

359 
u8
 
buf
[2];

361 
buf
[0] = 
	`LO_UINT16
(
pRemoveAŒS˚√
->
groupId
);

362 
buf
[1] = 
	`HI_UINT16
(
pRemoveAŒS˚√
->
groupId
);

364  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_REMOVE_ALL_SCENE
, 
TRUE
,

365 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

366 
	}
}

368 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_°‹eS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
°‹eS˚√_t
 *
pSt‹eS˚√
)

370 
u8
 
buf
[3];

372 
buf
[0] = 
	`LO_UINT16
(
pSt‹eS˚√
->
groupId
);

373 
buf
[1] = 
	`HI_UINT16
(
pSt‹eS˚√
->
groupId
);

374 
buf
[2] = 
pSt‹eS˚√
->
s˚√Id
;

376  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_STORE_SCENE
, 
TRUE
,

377 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

378 
	}
}

380 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_ªˇŒS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªˇŒS˚√_t
 *
pReˇŒS˚√
)

382 
u8
 
buf
[5];

384 
u8
 *
pBuf
 = 
buf
;

386 *
pBuf
++ = 
	`LO_UINT16
(
pReˇŒS˚√
->
groupId
);

387 *
pBuf
++ = 
	`HI_UINT16
(
pReˇŒS˚√
->
groupId
);

388 *
pBuf
++ = 
pReˇŒS˚√
->
s˚√Id
;

389 if(
pReˇŒS˚√
->
å™sTime
){

390 *
pBuf
++ = 
	`LO_UINT16
(
pReˇŒS˚√
->
å™sTime
);

391 *
pBuf
++ = 
	`HI_UINT16
(
pReˇŒS˚√
->
å™sTime
);

394  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_RECALL_SCENE
, 
TRUE
,

395 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

396 
	}
}

398 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_gëS˚√Memshù
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëS˚√Memshù_t
 *
pGëMembîshù
)

400 
u8
 
buf
[2];

402 
buf
[0] = 
	`LO_UINT16
(
pGëMembîshù
->
groupId
);

403 
buf
[1] = 
	`HI_UINT16
(
pGëMembîshù
->
groupId
);

405  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_GET_SCENE_MEMSHIP
, 
TRUE
,

406 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

407 
	}
}

409 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_c›yS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
c›yS˚√_t
 *
pC›yS˚√
)

411 
u8
 
buf
[7];

414 if((
pC›yS˚√
->
groupIdFrom
 =pC›yS˚√->
groupIdTo
Ë&& (pC›yS˚√->
s˚√IdFrom
 =pC›yS˚√->
s˚√IdTo
)){

415  
ZCL_STA_INVALID_FIELD
;

418 
buf
[0] = 
pC›yS˚√
->
mode
;

419 
buf
[1] = 
	`LO_UINT16
(
pC›yS˚√
->
groupIdFrom
);

420 
buf
[2] = 
	`HI_UINT16
(
pC›yS˚√
->
groupIdFrom
);

421 
buf
[3] = 
pC›yS˚√
->
s˚√IdFrom
;

422 
buf
[4] = 
	`LO_UINT16
(
pC›yS˚√
->
groupIdTo
);

423 
buf
[5] = 
	`HI_UINT16
(
pC›yS˚√
->
groupIdTo
);

424 
buf
[6] = 
pC›yS˚√
->
s˚√IdTo
;

426  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_COPY_SCENE
, 
TRUE
,

427 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 7, 
buf
);

428 
	}
}

430 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_s˚√R•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, u8 
°©us
, 
u16
 
groupId
, u8 
s˚√Id
)

432 
u8
 
buf
[4];

434 
u8
 *
pBuf
 = 
buf
;

436 *
pBuf
++ = 
°©us
;

437 *
pBuf
++ = 
	`LO_UINT16
(
groupId
);

438 *
pBuf
++ = 
	`HI_UINT16
(
groupId
);

439 if(
cmdId
 !
ZCL_CMD_SCENE_REMOVE_ALL_SCENE_RSP
){

440 *
pBuf
++ = 
s˚√Id
;

443  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
cmdId
, 
TRUE
,

444 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

445 
	}
}

447 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_võwS˚√R•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
,

448 
u8
 
cmdId
, u8 
°©us
, 
u16
 
groupId
, u8 
s˚√Id
, 
z˛_s˚√E¡ry_t
 *
pE¡ry
)

450 
u8
 
Àn
 = 4;

452 if(
°©us
 =
ZCL_STA_SUCCESS
){

453 if(!
pE¡ry
){

454  
ZCL_STA_FAILURE
;

457 
Àn
 += 3;

458 
Àn
 +
pE¡ry
->
s˚√Name
[0];

459 
Àn
 +
pE¡ry
->
extFõldLí
;

462 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

463 if(!
buf
){

464  
ZCL_STA_INSUFFICIENT_SPACE
;

467 
u8
 *
pBuf
 = 
buf
;

469 *
pBuf
++ = 
°©us
;

470 *
pBuf
++ = 
	`LO_UINT16
(
groupId
);

471 *
pBuf
++ = 
	`HI_UINT16
(
groupId
);

472 *
pBuf
++ = 
s˚√Id
;

473 if(
°©us
 =
ZCL_STA_SUCCESS
){

474 
u16
 
å™sTime
 = 
pE¡ry
->transTime;

475 if(
cmdId
 =
ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE_RSP
){

476 
å™sTime
 *= 10;

477 
å™sTime
 +
pE¡ry
->
å™sTime100ms
;

479 *
pBuf
++ = 
	`LO_UINT16
(
å™sTime
);

480 *
pBuf
++ = 
	`HI_UINT16
(
å™sTime
);

481 *
pBuf
++ = 
pE¡ry
->
s˚√Name
[0];

482 
	`mem˝y
(
pBuf
, &
pE¡ry
->
s˚√Name
[1],ÖEntry->sceneName[0]);

483 
pBuf
 +
pE¡ry
->
s˚√Name
[0];

484 
	`mem˝y
(
pBuf
, 
pE¡ry
->
extFõld
,ÖE¡ry->
extFõldLí
);

485 
pBuf
 +
pE¡ry
->
extFõldLí
;

488 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
cmdId
, 
TRUE
,

489 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

491 
	`ev_buf_‰ì
(
buf
);

493  
ZCL_STA_SUCCESS
;

494 
	}
}

496 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_gëS˚√MembîshùR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëS˚√MemR•_t
 *
pGëS˚√MembîshùR•
)

498 
u8
 
Àn
 = 4;

500 if(
pGëS˚√MembîshùR•
->
°©us
 =
ZCL_STA_SUCCESS
){

501 
Àn
++;

502 
Àn
 +
pGëS˚√MembîshùR•
->
s˚√C¡
;

505 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

506 if(!
buf
){

507  
ZCL_STA_INSUFFICIENT_SPACE
;

510 
u8
 *
pBuf
 = 
buf
;

512 *
pBuf
++ = 
pGëS˚√MembîshùR•
->
°©us
;

513 *
pBuf
++ = 
pGëS˚√MembîshùR•
->
ˇ∑côy
;

514 *
pBuf
++ = 
	`LO_UINT16
(
pGëS˚√MembîshùR•
->
groupId
);

515 *
pBuf
++ = 
	`HI_UINT16
(
pGëS˚√MembîshùR•
->
groupId
);

516 if(
pGëS˚√MembîshùR•
->
°©us
 =
ZCL_STA_SUCCESS
){

517 *
pBuf
++ = 
pGëS˚√MembîshùR•
->
s˚√C¡
;

518 
	`mem˝y
(
pBuf
, 
pGëS˚√MembîshùR•
->
s˚√Li°
,ÖGëS˚√MembîshùR•->
s˚√C¡
);

519 
pBuf
 +
pGëS˚√MembîshùR•
->
s˚√C¡
;

522 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_CMD_SCENE_GET_SCENE_MEMSHIP_RSP
, 
TRUE
,

523 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

525 
	`ev_buf_‰ì
(
buf
);

527  
ZCL_STA_SUCCESS
;

528 
	}
}

531 
_CODE_ZCL_
 
	$z˛_addS˚√P¨£
(
u8
 
ídpoöt
, u8 *
pD©a
, 
u16
 
d©aLí
, 
addS˚√_t
 *
pCmd
)

533 
u8
 *
±r
 = 
pD©a
;

535 
pCmd
->
s˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

536 
pD©a
 += 2;

537 
pCmd
->
s˚√
.
s˚√Id
 = *
pD©a
++;

538 
pCmd
->
s˚√
.
å™sTime
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

539 
pD©a
 += 2;

541 
u8
 
«meLí
 = *
pD©a
++;

543 
boﬁ
 
«meSuµ‹t
 = 
FALSE
;

544 
u16
 
©åLí
 = 0;

545 
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_NAME_SUPPORT
, &
©åLí
, (
u8
 *)&
«meSuµ‹t
);

547 if(
«meSuµ‹t
){

548 
pCmd
->
s˚√
.
s˚√Name
[0] = (
«meLí
 > (
ZCL_MAX_SCENE_NAME_LEN
 - 1)) ? (ZCL_MAX_SCENE_NAME_LEN - 1) :ÇameLen;

549 
	`mem˝y
(&
pCmd
->
s˚√
.
s˚√Name
[1], 
pD©a
,ÖCmd->scene.sceneName[0]);

552 
pD©a
 +
«meLí
;

554 
pCmd
->
s˚√
.
extFõldLí
 = 
d©aLí
 - (
pD©a
 - 
±r
);

555 if(
pCmd
->
s˚√
.
extFõldLí
){

556 
pCmd
->
s˚√
.
extFõldLí
 = (pCmd->s˚√.extFõldLí > 
ZCL_MAX_SCENE_EXT_FIELD_SIZE
) ? ZCL_MAX_SCENE_EXT_FIELD_SIZE

557 : 
pCmd
->
s˚√
.
extFõldLí
;

558 
	`mem˝y
(
pCmd
->
s˚√
.
extFõld
, 
pD©a
,ÖCmd->s˚√.
extFõldLí
);

560 
	}
}

562 
_CODE_ZCL_
 
	$z˛_võwS˚√R•P¨£
(
u8
 *
pD©a
, 
u16
 
d©aLí
, 
võwS˚√R•_t
 *
pCmd
)

564 
u8
 *
±r
 = 
pD©a
;

566 
pCmd
->
°©us
 = *
pD©a
++;

567 
pCmd
->
s˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

568 
pD©a
 += 2;

569 
pCmd
->
s˚√
.
s˚√Id
 = *
pD©a
++;

570 if(
pCmd
->
°©us
 =
ZCL_STA_SUCCESS
){

571 
pCmd
->
s˚√
.
å™sTime
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

572 
pD©a
 += 2;

573 
u8
 
«meLí
 = *
pD©a
++;

574 
pCmd
->
s˚√
.
s˚√Name
[0] = (
«meLí
 > (
ZCL_MAX_SCENE_NAME_LEN
 - 1)) ? (ZCL_MAX_SCENE_NAME_LEN - 1) :ÇameLen;

575 
	`mem˝y
(&
pCmd
->
s˚√
.
s˚√Name
[1], 
pD©a
,ÖCmd->scene.sceneName[0]);

577 
pD©a
 +
«meLí
;

579 
pCmd
->
s˚√
.
extFõldLí
 = 
d©aLí
 - (
pD©a
 - 
±r
);

580 if(
pCmd
->
s˚√
.
extFõldLí
){

581 
pCmd
->
s˚√
.
extFõldLí
 = (pCmd->s˚√.extFõldLí > 
ZCL_MAX_SCENE_EXT_FIELD_SIZE
) ? ZCL_MAX_SCENE_EXT_FIELD_SIZE

582 : 
pCmd
->
s˚√
.
extFõldLí
;

583 
	`mem˝y
(
pCmd
->
s˚√
.
extFõld
, 
pD©a
,ÖCmd->s˚√.
extFõldLí
);

586 
	}
}

588 
_CODE_ZCL_
 
	$z˛_gëS˚√MembîshùR•P¨£
(
u8
 *
pD©a
, 
gëS˚√MemR•_t
 *
pCmd
)

590 
pCmd
->
°©us
 = *
pD©a
++;

591 
pCmd
->
ˇ∑côy
 = *
pD©a
++;

592 
pCmd
->
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

593 
pD©a
 += 2;

594 if(
pCmd
->
°©us
 =
ZCL_STA_SUCCESS
){

595 
pCmd
->
s˚√C¡
 = *
pD©a
++;

596 
pCmd
->
s˚√Li°
 = 
pD©a
;

598 
	}
}

600 
_CODE_ZCL_
 
°©us_t
 
	$z˛_addS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

602 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

603 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

604 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

605 
u8
 
cmdId
 = 
pInMsg
->
hdr
.
cmd
;

607 
addS˚√_t
 
addS˚√
;

608 
	`TL_SETSTRUCTCONTENT
(
addS˚√
, 0);

610 
	`z˛_addS˚√P¨£
(
ídpoöt
, 
pInMsg
->
pD©a
,ÖInMsg->
d©aLí
, &
addS˚√
);

612 if(
cmdId
 =
ZCL_CMD_SCENE_ENHANCED_ADD_SCENE
){

613 
addS˚√
.
s˚√
.
å™sTime100ms
 =áddS˚√.s˚√.
å™sTime
 % 10;

614 
addS˚√
.
s˚√
.
å™sTime
 /= 10;

618 if((
addS˚√
.
s˚√
.
groupId
 =0Ë|| 
	`≠s_group_£¨ch
◊ddS˚√.s˚√.groupId, 
ídpoöt
)){

619 
°©us
 = 
	`z˛_s˚√_addS˚√E¡ry
(
ídpoöt
, &
addS˚√
.
s˚√
);

621 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

624 if(
	`UNICAST_MSG
(
pApsdeInd
)){

625 
ïInfo_t
 
d°Ep
;

626 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

628 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

629 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

630 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

631 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

633 
	`z˛_s˚√_s˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
cmdId
, 
°©us
, 
addS˚√
.
s˚√
.
groupId
,áddS˚√.s˚√.
s˚√Id
);

635 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

638  
°©us
;

639 
	}
}

641 
_CODE_ZCL_
 
°©us_t
 
	$z˛_võwS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

643 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

644 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

645 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

646 
u8
 
cmdId
 = 
pInMsg
->
hdr
.
cmd
;

647 
u8
 *
pD©a
 = 
pInMsg
->pData;

649 
võwS˚√_t
 
võwS˚√
;

650 
võwS˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

651 
pD©a
 += 2;

652 
võwS˚√
.
s˚√Id
 = *
pD©a
++;

654 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
võwS˚√
.
groupId
, võwS˚√.
s˚√Id
);

655 if(!
pS˚√E¡ry
){

656 if((
võwS˚√
.
groupId
 !0Ë&& (
	`≠s_group_£¨ch
(võwS˚√.groupId, 
ídpoöt
Ë=
NULL
)){

658 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

660 
°©us
 = 
ZCL_STA_NOT_FOUND
;

663 
°©us
 = 
ZCL_STA_SUCCESS
;

666 if(
	`UNICAST_MSG
(
pApsdeInd
)){

667 
ïInfo_t
 
d°Ep
;

668 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

670 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

671 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

672 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

673 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

675 
z˛_s˚√E¡ry_t
 *
pS˚√
 = (
°©us
 =
ZCL_STA_SUCCESS
Ë? &
pS˚√E¡ry
->
s˚√
 : 
NULL
;

677 
	`z˛_s˚√_võwS˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
cmdId
, 
°©us
, 
võwS˚√
.
groupId
, võwS˚√.
s˚√Id
, 
pS˚√
);

679 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

682  
°©us
;

683 
	}
}

685 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªmoveS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

687 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

688 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

689 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

690 
u8
 *
pD©a
 = 
pInMsg
->pData;

692 
ªmoveS˚√_t
 
ªmoveS˚√
;

693 
ªmoveS˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

694 
pD©a
 += 2;

695 
ªmoveS˚√
.
s˚√Id
 = *
pD©a
++;

697 
°©us
 = 
	`z˛_s˚√_ªmoveS˚√E¡ry
(
ídpoöt
, 
ªmoveS˚√
.
groupId
,ÑemoveS˚√.
s˚√Id
);

698 if(
°©us
 =
ZCL_STA_NOT_FOUND
){

700 if(
	`≠s_group_£¨ch
(
ªmoveS˚√
.
groupId
, 
ídpoöt
Ë=
NULL
){

701 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

705 if(
	`UNICAST_MSG
(
pApsdeInd
)){

706 
ïInfo_t
 
d°Ep
;

707 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

709 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

710 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

711 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

712 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

714 
	`z˛_s˚√_s˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
ZCL_CMD_SCENE_REMOVE_SCENE_RSP
, 
°©us
, 
ªmoveS˚√
.
groupId
,ÑemoveS˚√.
s˚√Id
);

716 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

719  
°©us
;

720 
	}
}

722 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªmoveAŒS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

724 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

725 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

726 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

728 
ªmoveAŒS˚√_t
 
ªmoveAŒS˚√
;

729 
ªmoveAŒS˚√
.
groupId
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

731 if((
ªmoveAŒS˚√
.
groupId
 =0Ë|| 
	`≠s_group_£¨ch
‘emoveAŒS˚√.groupId, 
ídpoöt
)){

732 
	`z˛_s˚√_ªmoveAŒS˚√E¡ry
(
ídpoöt
, 
ªmoveAŒS˚√
.
groupId
, 
TRUE
);

734 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

737 if(
	`UNICAST_MSG
(
pApsdeInd
)){

738 
ïInfo_t
 
d°Ep
;

739 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

741 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

742 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

743 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

744 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

746 
	`z˛_s˚√_s˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
ZCL_CMD_SCENE_REMOVE_ALL_SCENE_RSP
, 
°©us
, 
ªmoveAŒS˚√
.
groupId
, 0);

748 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

751  
°©us
;

752 
	}
}

754 
_CODE_ZCL_
 
°©us_t
 
	$z˛_°‹eS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

756 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

757 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

758 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

759 
u8
 *
pD©a
 = 
pInMsg
->pData;

761 
°‹eS˚√_t
 
°‹eS˚√
;

762 
°‹eS˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

763 
pD©a
 += 2;

764 
°‹eS˚√
.
s˚√Id
 = *
pD©a
++;

766 if((
°‹eS˚√
.
groupId
 =0Ë|| 
	`≠s_group_£¨ch
(°‹eS˚√.groupId, 
ídpoöt
)){

767 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
°‹eS˚√
.
groupId
, st‹eS˚√.
s˚√Id
);

768 if(!
pS˚√E¡ry
){

769 
pS˚√E¡ry
 = 
	`z˛_s˚√_gëFªeE¡ry
();

770 if(!
pS˚√E¡ry
){

772 
°©us
 = 
ZCL_STA_INSUFFICIENT_SPACE
;

776 if(
°©us
 =
ZCL_STA_SUCCESS
){

777 if(
pInMsg
->
˛u°îAµCb
){

779 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
), 
ZCL_CMD_SCENE_STORE_SCENE
, &
pS˚√E¡ry
->
s˚√
);

782 
pS˚√E¡ry
->
u£d
 = 1;

783 
pS˚√E¡ry
->
ídpoöt
 =Éndpoint;

784 
pS˚√E¡ry
->
s˚√
.
groupId
 = 
°‹eS˚√
.groupId;

785 
pS˚√E¡ry
->
s˚√
.
s˚√Id
 = 
°‹eS˚√
.sceneId;

788 
u16
 
©åLí
 = 0;

789 
u8
 
cuºítS˚√
 = 0;

790 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_SCENE
, &
©åLí
, (
u8
 *)&
cuºítS˚√
Ë=
ZCL_STA_SUCCESS
){

791 
cuºítS˚√
 = 
°‹eS˚√
.
s˚√Id
;

792 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_SCENE
, (
u8
 *)&
cuºítS˚√
);

795 
u16
 
cuºítGroup
 = 0;

796 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_GROUP
, &
©åLí
, (
u8
 *)&
cuºítGroup
Ë=
ZCL_STA_SUCCESS
){

797 
cuºítGroup
 = 
°‹eS˚√
.
groupId
;

798 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_GROUP
, (
u8
 *)&
cuºítGroup
);

801 
u8
 
s˚√VÆid
 = 0;

802 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, &
©åLí
, (
u8
 *)&
s˚√VÆid
Ë=
ZCL_STA_SUCCESS
){

803 
s˚√VÆid
 = 1;

804 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, (
u8
 *)&
s˚√VÆid
);

808 
	`z˛_s˚√sSave
(
ídpoöt
);

810 
°©us
 = 
ZCL_STA_FAILURE
;

814 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

817 if(
	`UNICAST_MSG
(
pApsdeInd
)){

818 
ïInfo_t
 
d°Ep
;

819 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

821 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

822 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

823 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

824 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

826 
	`z˛_s˚√_s˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
ZCL_CMD_SCENE_STORE_SCENE_RSP
, 
°©us
, 
°‹eS˚√
.
groupId
, st‹eS˚√.
s˚√Id
);

828 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

831  
°©us
;

832 
	}
}

834 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªˇŒS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

836 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

837 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

838 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

839 
u8
 *
pD©a
 = 
pInMsg
->pData;

841 
ªˇŒS˚√_t
 
ªˇŒS˚√
;

842 
ªˇŒS˚√
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

843 
pD©a
 += 2;

844 
ªˇŒS˚√
.
s˚√Id
 = *
pD©a
++;

846 
z˛_s˚√TabÀ_t
 *
pS˚√E¡ry
 = 
	`z˛_s˚√_födE¡ry
(
ídpoöt
, 
ªˇŒS˚√
.
groupId
,ÑeˇŒS˚√.
s˚√Id
);

847 if(
pS˚√E¡ry
){

848 if(
pInMsg
->
˛u°îAµCb
){

849 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
), 
ZCL_CMD_SCENE_RECALL_SCENE
, &
pS˚√E¡ry
->
s˚√
);

852 
u16
 
©åLí
 = 0;

853 
u8
 
cuºítS˚√
 = 0;

854 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_SCENE
, &
©åLí
, (
u8
 *)&
cuºítS˚√
Ë=
ZCL_STA_SUCCESS
){

855 
cuºítS˚√
 = 
ªˇŒS˚√
.
s˚√Id
;

856 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_SCENE
, (
u8
 *)&
cuºítS˚√
);

859 
u16
 
cuºítGroup
 = 0;

860 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_GROUP
, &
©åLí
, (
u8
 *)&
cuºítGroup
Ë=
ZCL_STA_SUCCESS
){

861 
cuºítGroup
 = 
ªˇŒS˚√
.
groupId
;

862 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_CURRENT_GROUP
, (
u8
 *)&
cuºítGroup
);

865 
u8
 
s˚√VÆid
 = 0;

866 if(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, &
©åLí
, (
u8
 *)&
s˚√VÆid
Ë=
ZCL_STA_SUCCESS
){

867 
s˚√VÆid
 = 1;

868 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, (
u8
 *)&
s˚√VÆid
);

873  
°©us
;

874 
	}
}

876 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gëS˚√MembîshùPrc
(
z˛Incomög_t
 *
pInMsg
)

878 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

879 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

880 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

882 
gëS˚√Memshù_t
 
gëS˚√Membîshù
;

883 
gëS˚√Membîshù
.
groupId
 = 
	`BUILD_U16
(
pInMsg
->
pD©a
[0],ÖInMsg->pData[1]);

885 
u8
 
s˚√C¡
 = 0;

886 
u8
 
s˚√Li°
[
ZCL_SCENE_TABLE_NUM
] = {0};

888 if((
gëS˚√Membîshù
.
groupId
 =0Ë|| 
	`≠s_group_£¨ch
(gëS˚√Membîshù.groupId, 
ídpoöt
)){

889 
s˚√C¡
 = 
	`z˛_s˚√_födAŒS˚√ByGroup
(
ídpoöt
, 
gëS˚√Membîshù
.
groupId
, 
s˚√Li°
);

891 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

894 if(
	`UNICAST_MSG
(
pApsdeInd
)){

895 
ïInfo_t
 
d°Ep
;

896 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

898 
gëS˚√MemR•_t
 
gëS˚√MembîshùR•
;

899 
gëS˚√MembîshùR•
.
°©us
 = status;

900 
gëS˚√MembîshùR•
.
ˇ∑côy
 = 
ZCL_SCENE_TABLE_NUM
 - 
	`z˛_s˚√_gëS˚√U£dNum
();

901 
gëS˚√MembîshùR•
.
groupId
 = 
gëS˚√Membîshù
.groupId;

902 
gëS˚√MembîshùR•
.
s˚√C¡
 = sceneCnt;

903 
gëS˚√MembîshùR•
.
s˚√Li°
 = sceneList;

905 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

906 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

907 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

908 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

910 
	`z˛_s˚√_gëS˚√MembîshùR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, &
gëS˚√MembîshùR•
);

912 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

915  
°©us
;

916 
	}
}

918 
_CODE_ZCL_
 
°©us_t
 
	$z˛_c›yS˚√Prc
(
z˛Incomög_t
 *
pInMsg
)

920 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

921 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

922 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

923 
u8
 *
pD©a
 = 
pInMsg
->pData;

925 
c›yS˚√_t
 
c›yS˚√
;

926 
c›yS˚√
.
mode
 = *
pD©a
++;

927 
c›yS˚√
.
groupIdFrom
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

928 
pD©a
 += 2;

929 
c›yS˚√
.
s˚√IdFrom
 = *
pD©a
++;

930 
c›yS˚√
.
groupIdTo
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

931 
pD©a
 += 2;

932 
c›yS˚√
.
s˚√IdTo
 = *
pD©a
++;

934 if(
	`≠s_group_£¨ch
(
c›yS˚√
.
groupIdFrom
, 
ídpoöt
Ë&&áps_group_£¨ch(c›yS˚√.
groupIdTo
,Éndpoint)){

935 
°©us
 = 
	`z˛_s˚√_c›yS˚√E¡ry
(
ídpoöt
, &
c›yS˚√
);

938 
°©us
 = 
ZCL_STA_INVALID_FIELD
;

941 if(
	`UNICAST_MSG
(
pApsdeInd
)){

942 
ïInfo_t
 
d°Ep
;

943 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

945 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

946 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

947 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

948 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

950 
	`z˛_s˚√_s˚√R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
ZCL_CMD_SCENE_COPY_SCENE_RSP
, 
°©us
, 
c›yS˚√
.
groupIdFrom
, c›yS˚√.
s˚√IdFrom
);

952 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

955  
°©us
;

956 
	}
}

958 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

960 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

962 
pInMsg
->
hdr
.
cmd
)

964 
ZCL_CMD_SCENE_ADD_SCENE
:

965 
ZCL_CMD_SCENE_ENHANCED_ADD_SCENE
:

966 
°©us
 = 
	`z˛_addS˚√Prc
(
pInMsg
);

968 
ZCL_CMD_SCENE_VIEW_SCENE
:

969 
ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE
:

970 
°©us
 = 
	`z˛_võwS˚√Prc
(
pInMsg
);

972 
ZCL_CMD_SCENE_REMOVE_SCENE
:

973 
°©us
 = 
	`z˛_ªmoveS˚√Prc
(
pInMsg
);

975 
ZCL_CMD_SCENE_REMOVE_ALL_SCENE
:

976 
°©us
 = 
	`z˛_ªmoveAŒS˚√Prc
(
pInMsg
);

978 
ZCL_CMD_SCENE_STORE_SCENE
:

979 
°©us
 = 
	`z˛_°‹eS˚√Prc
(
pInMsg
);

981 
ZCL_CMD_SCENE_RECALL_SCENE
:

982 
°©us
 = 
	`z˛_ªˇŒS˚√Prc
(
pInMsg
);

984 
ZCL_CMD_SCENE_GET_SCENE_MEMSHIP
:

985 
°©us
 = 
	`z˛_gëS˚√MembîshùPrc
(
pInMsg
);

987 
ZCL_CMD_SCENE_COPY_SCENE
:

988 
°©us
 = 
	`z˛_c›yS˚√Prc
(
pInMsg
);

991 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

995  
°©us
;

996 
	}
}

998 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1000 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1001 
u8
 *
pD©a
 = 
pInMsg
->pData;

1003 
z˛_s˚√_cmdPaylﬂd_t
 
cmdPaylﬂd
;

1004 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_s˚√_cmdPaylﬂd_t
));

1006 
pInMsg
->
hdr
.
cmd
)

1008 
ZCL_CMD_SCENE_ADD_SCENE_RSP
:

1009 
ZCL_CMD_SCENE_ENHANCED_ADD_SCENE_RSP
:

1011 
cmdPaylﬂd
.
addS˚√R•
.
°©us
 = *
pD©a
++;

1012 
cmdPaylﬂd
.
addS˚√R•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1013 
pD©a
 += 2;

1014 
cmdPaylﬂd
.
addS˚√R•
.
s˚√Id
 = *
pD©a
++;

1016 
ZCL_CMD_SCENE_VIEW_SCENE_RSP
:

1017 
ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE_RSP
:

1019 
	`z˛_võwS˚√R•P¨£
(
pInMsg
->
pD©a
,ÖInMsg->
d©aLí
, &
cmdPaylﬂd
.
võwS˚√R•
);

1021 
ZCL_CMD_SCENE_REMOVE_SCENE_RSP
:

1023 
cmdPaylﬂd
.
ªmoveS˚√R•
.
°©us
 = *
pD©a
++;

1024 
cmdPaylﬂd
.
ªmoveS˚√R•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1025 
pD©a
 += 2;

1026 
cmdPaylﬂd
.
ªmoveS˚√R•
.
s˚√Id
 = *
pD©a
++;

1028 
ZCL_CMD_SCENE_REMOVE_ALL_SCENE_RSP
:

1030 
cmdPaylﬂd
.
ªmoveAŒS˚√R•
.
°©us
 = *
pD©a
++;

1031 
cmdPaylﬂd
.
ªmoveAŒS˚√R•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1032 
pD©a
 += 2;

1034 
ZCL_CMD_SCENE_STORE_SCENE_RSP
:

1036 
cmdPaylﬂd
.
°‹eS˚√R•
.
°©us
 = *
pD©a
++;

1037 
cmdPaylﬂd
.
°‹eS˚√R•
.
groupId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1038 
pD©a
 += 2;

1039 
cmdPaylﬂd
.
°‹eS˚√R•
.
s˚√Id
 = *
pD©a
++;

1041 
ZCL_CMD_SCENE_GET_SCENE_MEMSHIP_RSP
:

1043 
	`z˛_gëS˚√MembîshùR•P¨£
(
pInMsg
->
pD©a
, &
cmdPaylﬂd
.
gëS˚√MembîshùR•
);

1045 
ZCL_CMD_SCENE_COPY_SCENE_RSP
:

1047 
cmdPaylﬂd
.
c›yS˚√R•
.
°©us
 = *
pD©a
++;

1048 
cmdPaylﬂd
.
c›yS˚√R•
.
groupIdFrom
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1049 
pD©a
 += 2;

1050 
cmdPaylﬂd
.
c›yS˚√R•
.
s˚√IdFrom
 = *
pD©a
++;

1053 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1057 if(
°©us
 =
ZCL_STA_SUCCESS
){

1058 if(
pInMsg
->
˛u°îAµCb
){

1059 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

1063  
°©us
;

1064 
	}
}

1066 
_CODE_ZCL_
 
°©us_t
 
	$z˛_s˚√_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1068 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

1069  
	`z˛_s˚√_˛õ¡CmdH™dÀr
(
pInMsg
);

1071  
	`z˛_s˚√_£rvîCmdH™dÀr
(
pInMsg
);

1073 
	}
}

	@zigbee/zcl/general/zcl_scene.h

24 #i‚de‡
ZCL_SCENE_H


25 
	#ZCL_SCENE_H


	)

49 #i‚de‡
ZCL_SCENE_TABLE_NUM


50 
	#ZCL_SCENE_TABLE_NUM
 8

	)

56 
	#ZCL_MAX_SCENE_NAME_LEN
 16

	)

61 
	#ZCL_MAX_SCENE_EXT_FIELD_SIZE
 20

	)

71 
	#ZCL_CMD_SCENE_ADD_SCENE
 0x00

	)

72 
	#ZCL_CMD_SCENE_VIEW_SCENE
 0x01

	)

73 
	#ZCL_CMD_SCENE_REMOVE_SCENE
 0x02

	)

74 
	#ZCL_CMD_SCENE_REMOVE_ALL_SCENE
 0x03

	)

75 
	#ZCL_CMD_SCENE_STORE_SCENE
 0x04

	)

76 
	#ZCL_CMD_SCENE_RECALL_SCENE
 0x05

	)

77 
	#ZCL_CMD_SCENE_GET_SCENE_MEMSHIP
 0x06

	)

78 
	#ZCL_CMD_SCENE_ENHANCED_ADD_SCENE
 0x40

	)

79 
	#ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE
 0x41

	)

80 
	#ZCL_CMD_SCENE_COPY_SCENE
 0x42

	)

82 
	#ZCL_CMD_SCENE_ADD_SCENE_RSP
 0x00

	)

83 
	#ZCL_CMD_SCENE_VIEW_SCENE_RSP
 0x01

	)

84 
	#ZCL_CMD_SCENE_REMOVE_SCENE_RSP
 0x02

	)

85 
	#ZCL_CMD_SCENE_REMOVE_ALL_SCENE_RSP
 0x03

	)

86 
	#ZCL_CMD_SCENE_STORE_SCENE_RSP
 0x04

	)

87 
	#ZCL_CMD_SCENE_GET_SCENE_MEMSHIP_RSP
 0x06

	)

88 
	#ZCL_CMD_SCENE_ENHANCED_ADD_SCENE_RSP
 0x40

	)

89 
	#ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE_RSP
 0x41

	)

90 
	#ZCL_CMD_SCENE_COPY_SCENE_RSP
 0x42

	)

97 
	#ZCL_ATTRID_SCENE_SCENE_COUNT
 0x0000

	)

98 
	#ZCL_ATTRID_SCENE_CURRENT_SCENE
 0x0001

	)

99 
	#ZCL_ATTRID_SCENE_CURRENT_GROUP
 0x0002

	)

100 
	#ZCL_ATTRID_SCENE_SCENE_VALID
 0x0003

	)

101 
	#ZCL_ATTRID_SCENE_NAME_SUPPORT
 0x0004

	)

102 
	#ZCL_ATTRID_SCENE_LAST_CONFIG_BY
 0x0005

	)

111 
	#ZB_SCENE_CLUSTER_COPY_SCENE_MODE_ALL
(
mode
Ë–((modeË& 0x01Ë=0x01 )

	)

117 
u16
 
	mgroupId
;

118 
u8
 
	ms˚√Id
;

119 
u8
 
	ms˚√Name
[
ZCL_MAX_SCENE_NAME_LEN
];

120 
u16
 
	må™sTime
;

121 
u16
 
	må™sTime100ms
;

122 
u8
 
	mextFõldLí
;

123 
u8
 
	mextFõld
[
ZCL_MAX_SCENE_EXT_FIELD_SIZE
];

124 } 
	tz˛_s˚√E¡ry_t
;

130 
z˛_s˚√E¡ry_t
 
	ms˚√
;

131 } 
	taddS˚√_t
;

137 
u16
 
	mgroupId
;

138 
u8
 
	ms˚√Id
;

139 } 
	tvõwS˚√_t
;

145 
u16
 
	mgroupId
;

146 
u8
 
	ms˚√Id
;

147 } 
	tªmoveS˚√_t
;

153 
u16
 
	mgroupId
;

154 } 
	tªmoveAŒS˚√_t
;

160 
u16
 
	mgroupId
;

161 
u8
 
	ms˚√Id
;

162 } 
	t°‹eS˚√_t
;

168 
u16
 
	mgroupId
;

169 
u16
 
	må™sTime
;

170 
u8
 
	ms˚√Id
;

171 } 
	tªˇŒS˚√_t
;

177 
u16
 
	mgroupId
;

178 } 
	tgëS˚√Memshù_t
;

184 
u8
 
	mmode
;

185 
u16
 
	mgroupIdFrom
;

186 
u8
 
	ms˚√IdFrom
;

187 
u16
 
	mgroupIdTo
;

188 
u8
 
	ms˚√IdTo
;

189 } 
	tc›yS˚√_t
;

196 
u8
 
	m°©us
;

197 
u16
 
	mgroupId
;

198 
u8
 
	ms˚√Id
;

199 } 
	taddS˚√R•_t
;

205 
u8
 
	m°©us
;

206 
z˛_s˚√E¡ry_t
 
	ms˚√
;

207 } 
	tvõwS˚√R•_t
;

213 
u8
 
	m°©us
;

214 
u16
 
	mgroupId
;

215 
u8
 
	ms˚√Id
;

216 } 
	tªmoveS˚√R•_t
;

222 
u8
 
	m°©us
;

223 
u16
 
	mgroupId
;

224 } 
	tªmoveAŒS˚√R•_t
;

230 
u8
 
	m°©us
;

231 
u16
 
	mgroupId
;

232 
u8
 
	ms˚√Id
;

233 } 
	t°‹eS˚√R•_t
;

239 
u8
 
	m°©us
;

240 
u8
 
	mˇ∑côy
;

241 
u16
 
	mgroupId
;

242 
u8
 
	ms˚√C¡
;

243 
u8
 *
	ms˚√Li°
;

244 } 
	tgëS˚√MemR•_t
;

250 
u8
 
	m°©us
;

251 
u16
 
	mgroupIdFrom
;

252 
u8
 
	ms˚√IdFrom
;

253 } 
	tc›yS˚√R•_t
;

260 
addS˚√R•_t
 
	maddS˚√R•
;

261 
võwS˚√R•_t
 
	mvõwS˚√R•
;

262 
ªmoveS˚√R•_t
 
	mªmoveS˚√R•
;

263 
ªmoveAŒS˚√R•_t
 
	mªmoveAŒS˚√R•
;

264 
°‹eS˚√R•_t
 
	m°‹eS˚√R•
;

265 
gëS˚√MemR•_t
 
	mgëS˚√MembîshùR•
;

266 
c›yS˚√R•_t
 
	mc›yS˚√R•
;

267 }
	tz˛_s˚√_cmdPaylﬂd_t
;

276 (*
	tz˛_°‹eS˚√Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_s˚√E¡ry_t
 *
	tpS˚√
);

277 (*
	tz˛_ªˇŒS˚√Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz˛_s˚√E¡ry_t
 *
	tpS˚√
);

278 (*
	tz˛_addS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 
	tcmdId
, 
	taddS˚√R•_t
 *
	tpAddS˚√R•
);

279 (*
	tz˛_võwS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 
	tcmdId
, 
	tvõwS˚√R•_t
 *
	tpVõwS˚√R•
);

280 (*
	tz˛_ªmoveS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tªmoveS˚√R•_t
 *
	tpRemoveS˚√R•
);

281 (*
	tz˛_ªmoveAŒS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tªmoveAŒS˚√R•_t
 *
	tpRemoveAŒS˚√R•
);

282 (*
	tz˛_°‹eS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	t°‹eS˚√R•_t
 *
	tpSt‹eS˚√R•
);

283 (*
	tz˛_gëS˚√MembîshùR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëS˚√MemR•_t
 *
	tpGëS˚√MembîshùR•
);

284 (*
	tz˛_c›yS˚√R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tc›yS˚√R•_t
 *
	tpC›yS˚√R•
);

290 
z˛_°‹eS˚√Cb_t
 
°‹eS˚√CbFunc
;

291 
z˛_ªˇŒS˚√Cb_t
 
ªˇŒS˚√CbFunc
;

292 
z˛_addS˚√R•Cb_t
 
addS˚√R•CbFunc
;

293 
z˛_võwS˚√R•Cb_t
 
võwS˚√R•CbFunc
;

294 
z˛_ªmoveS˚√R•Cb_t
 
ªmoveS˚√R•CbFunc
;

295 
z˛_ªmoveAŒS˚√R•Cb_t
 
ªmoveAŒS˚√R•CbFunc
;

296 
z˛_°‹eS˚√R•Cb_t
 
°‹eS˚√R•CbFunc
;

297 
z˛_gëS˚√MembîshùR•Cb_t
 
gëS˚√MembîshùR•CbFunc
;

298 
z˛_c›yS˚√R•Cb_t
 
c›yS˚√R•CbFunc
;

299 } 
	tz˛_s˚√_AµCÆlbacks_t
;

311 
u8
 
s˚√C¡
;

312 
u8
 
cuºítS˚√
;

313 
u16
 
cuºítGroup
;

314 
u8
 
s˚√VÆid
;

315 
u8
 
«meSuµ‹t
;

316 
addrExt_t
 
œ°C⁄figBy
;

317 
z˛_s˚√E¡ry_t
 
s˚√_èbÀ
[
ZCL_SCENE_TABLE_NUM
];

318 } 
	tz˛_s˚√Aâr_t
;

322 
z˛_s˚√Aâr_t
 
z˛_©å_s˚√
;

324 
	#z˛_s˚√AârGë
(Ë&
z˛_©å_s˚√


	)

329 c⁄° 
z˛AârInfo_t
 
s˚√_©åTbl
[];

331 c⁄° 
u8
 
z˛_s˚√_©åNum
;

340 
u8
 
u£d
;

341 
u8
 
ídpoöt
;

342 
z˛_s˚√E¡ry_t
 
s˚√
;

343 } 
	tz˛_s˚√TabÀ_t
;

345 
z˛_s˚√TabÀ_t
 
g_z˛_s˚√Tab
[];

358 
°©us_t
 
	`z˛_s˚√_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

373 
°©us_t
 
	`z˛_s˚√_addS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
addS˚√_t
 *
pAddS˚√
);

374 
	#z˛_s˚√_addS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_addS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_SCENE_ADD_SCENE
, (d)))

	)

375 
	#z˛_s˚√_íh™˚dAddS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_addS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_SCENE_ENHANCED_ADD_SCENE
, (d)))

	)

389 
°©us_t
 
	`z˛_s˚√_võwS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
cmdId
, 
võwS˚√_t
 *
pVõwS˚√
);

390 
	#z˛_s˚√_võwS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_võwS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_SCENE_VIEW_SCENE
, (d)))

	)

391 
	#z˛_s˚√_íh™˚dVõwS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_võwS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, 
ZCL_CMD_SCENE_ENHANCED_VIEW_SCENE
, (d)))

	)

404 
°©us_t
 
	`z˛_s˚√_ªmoveS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªmoveS˚√_t
 *
pRemoveS˚√
);

405 
	#z˛_s˚√_ªmoveS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_ªmoveS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

418 
°©us_t
 
	`z˛_s˚√_ªmoveAŒS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªmoveAŒS˚√_t
 *
pRemoveAŒS˚√
);

419 
	#z˛_s˚√_ªmoveAŒS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_ªmoveAŒS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

432 
°©us_t
 
	`z˛_s˚√_°‹eS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
°‹eS˚√_t
 *
pSt‹eS˚√
);

433 
	#z˛_s˚√_°‹eS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_°‹eS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

446 
°©us_t
 
	`z˛_s˚√_ªˇŒS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
ªˇŒS˚√_t
 *
pReˇŒS˚√
);

447 
	#z˛_s˚√_ªˇŒS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_ªˇŒS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

460 
°©us_t
 
	`z˛_s˚√_gëS˚√Memshù
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëS˚√Memshù_t
 *
pGëMembîshù
);

461 
	#z˛_s˚√_gëS˚√MemshùCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_gëS˚√Memshù
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

474 
°©us_t
 
	`z˛_s˚√_c›yS˚√
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
c›yS˚√_t
 *
pC›yS˚√
);

475 
	#z˛_s˚√_c›yS˚√Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_s˚√_c›yS˚√
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

479 
	`z˛_s˚√_ªmoveAŒS˚√E¡ry
(
u8
 
ídpoöt
, 
u16
 
groupId
, 
boﬁ
 
upd©eNV
);

	@zigbee/zcl/general/zcl_scene_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_SCENE


48 
z˛_s˚√Aâr_t
 
	gz˛_©å_s˚√
 = { 0x00, 0x00, 0x0000, 0x00, 0x00};

51 c⁄° 
z˛AârInfo_t
 
	gs˚√_©åTbl
[] =

53 { 
ZCL_ATTRID_SCENE_SCENE_COUNT
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
s˚√C¡
 },

54 { 
ZCL_ATTRID_SCENE_CURRENT_SCENE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
cuºítS˚√
 },

55 { 
ZCL_ATTRID_SCENE_CURRENT_GROUP
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
cuºítGroup
 },

56 { 
ZCL_ATTRID_SCENE_SCENE_VALID
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
s˚√VÆid
 },

57 { 
ZCL_ATTRID_SCENE_NAME_SUPPORT
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
«meSuµ‹t
 },

58 #ifde‡
ZCL_ATTR_LAST_CONFIG_BY_ENABLE


59 { 
ZCL_ATTRID_SCENE_LAST_CONFIG_BY
, 
ZCL_DATA_TYPE_IEEE_ADDR
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_s˚√
.
œ°C⁄figBy
 },

61 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

64 c⁄° 
u8
 
	gz˛_s˚√_©åNum
 = ( (
s˚√_©åTbl
Ë/ (
z˛AârInfo_t
) );

66 
nv_°s_t
 
	$z˛_s˚√_ßveAâr
()

68  
	`z˛_©å_s˚√P¨ams_ßve
();

69 
	}
}

71 
nv_°s_t
 
	$z˛_s˚√_lﬂdAâr
()

73  
	`z˛_©å_s˚√P¨ams_ª°‹e
();

74 
	}
}

	@zigbee/zcl/general/zcl_time.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_TIME


49 
_CODE_ZCL_
 
°©us_t
 
	$z˛_time_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

51  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_GEN_TIME
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

52 
	}
}

	@zigbee/zcl/general/zcl_time.h

24 #i‚de‡
ZCL_TIME_H


25 
	#ZCL_TIME_H


	)

30 
	#ZCL_ATTRID_TIME
 0x0000

	)

31 
	#ZCL_ATTRID_TIME_STATUS
 0x0001

	)

32 
	#ZCL_ATTRID_TIMEZONE
 0x0002

	)

33 
	#ZCL_ATTRID_DST_START
 0x0003

	)

34 
	#ZCL_ATTRID_DST_END
 0x0004

	)

35 
	#ZCL_ATTRID_DST_SHIFT
 0x0005

	)

36 
	#ZCL_ATTRID_STANDARD_TIME
 0x0006

	)

37 
	#ZCL_ATTRID_LOCAL_TIME
 0x0007

	)

38 
	#ZCL_ATTRID_LAST_SET_TIME
 0x0008

	)

39 
	#ZCL_ATTRID_VALID_UNTIL_TIME
 0x0009

	)

44 
°©us_t
 
z˛_time_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/general/zcl_time_attr.c

25 
	~"é_comm⁄.h
"

26 
	~"../z˛_ö˛ude.h
"

42 #ifde‡
ZCL_TIME


43 
u32
 
	gz˛_©å_time
 = 0xffffffff;

44 
u8
 
	gz˛_©å_timeSètus
 = 0;

45 
s32
 
	gz˛_©å_timez⁄e
 = 0;

46 
u32
 
	gz˛_©å_d°Sèπ
 = 0;

47 
u32
 
	gz˛_©å_d°End
 = 0;

48 
s32
 
	gz˛_©å_d°Shi·
 = 0;

49 
u32
 
	gz˛_©å_°™d¨dTime
 = 0;

50 
u32
 
	gz˛_©å_loˇlTime
 = 0xffffffff;

51 
u32
 
	gz˛_©å_vÆidU¡ûTime
 = 0xffffffff;

54 c⁄° 
z˛AârInfo_t
 
	gtime_©åTbl
[] =

56 #ifde‡
ZCL_ATTR_TIME_ENABLE


57 { 
ZCL_ATTRID_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_time
},

59 #ifde‡
ZCL_ATTR_TIME_STATUS_ENABLE


60 { 
ZCL_ATTRID_TIME_STATUS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_timeSètus
},

62 #ifde‡
ZCL_ATTR_TIMEZONE_ENABLE


63 { 
ZCL_ATTRID_TIMEZONE
, 
ZCL_DATA_TYPE_INT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_timez⁄e
},

65 #ifde‡
ZCL_ATTR_DST_START_ENABLE


66 { 
ZCL_ATTRID_DST_START
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_d°Sèπ
},

68 #ifde‡
ZCL_ATTR_DST_END_ENABLE


69 { 
ZCL_ATTRID_DST_END
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_d°End
},

71 #ifde‡
ZCL_ATTR_DST_SHIFT_ENABLE


72 { 
ZCL_ATTRID_DST_SHIFT
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_d°Shi·
},

74 #ifde‡
ZCL_ATTR_STANDARD_TIME_ENABLE


75 { 
ZCL_ATTRID_STANDARD_TIME
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_°™d¨dTime
},

77 #ifde‡
ZCL_ATTR_LOCAL_TIME_ENABLE


78 { 
ZCL_ATTRID_LOCAL_TIME
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_loˇlTime
},

80 #ifde‡
ZCL_ATTR_LAST_SET_TIME_ENABLE


81 { 
ZCL_ATTRID_LAST_SET_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_loˇlTime
},

83 #ifde‡
ZCL_ATTR_VALID_UNTIL_TIME_ENABLE


84 { 
ZCL_ATTRID_VALID_UNTIL_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_vÆidU¡ûTime
},

86 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

89 c⁄° 
u8
 
	gz˛_time_©åNum
 = ( (
time_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/hvac/zcl_thermostat.c

27 
	~"../z˛_ö˛ude.h
"

29 #ifde‡
ZCL_THERMOSTAT


48 
°©us_t
 
z˛_thîmo°©_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

51 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

53  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
m™uCode
, 
¨πNum
, 
©åTbl
, 
z˛_thîmo°©_cmdH™dÀr
, 
cb
);

54 
	}
}

57 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_£çoötRai£LowîCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_£çoötRai£LowîCmd_t
 *
pCmd
)

59 
u8
 
buf
[2];

60 
u8
 *
pBuf
 = 
buf
;

62 *
pBuf
++ = 
pCmd
->
mode
;

63 *
pBuf
++ = 
pCmd
->
amou¡
;

65  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_SETPOINT_RAISE_LOWER
, 
TRUE
,

66 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

67 
	}
}

69 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_£tWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_£tWìklyScheduÀCmd_t
 *
pCmd
)

71 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

72 
u8
 
Àn
 = 3;

74 if–(
pCmd
->
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
) ||

75 (
pCmd
->
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
) ){

76 
Àn
 +
pCmd
->
numOfTønsF‹Sequí˚
 * 4;

77 }if(
pCmd
->
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

78 
Àn
 +
pCmd
->
numOfTønsF‹Sequí˚
 * 6;

80  
ZCL_STA_FAILURE
;

83 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

84 if(!
buf
){

85  
ZCL_STA_INSUFFICIENT_SPACE
;

88 
u8
 *
pBuf
 = 
buf
;

90 *
pBuf
++ = 
pCmd
->
numOfTønsF‹Sequí˚
;

91 *
pBuf
++ = 
pCmd
->
dayOfWìkF‹Sequí˚
;

92 *
pBuf
++ = 
pCmd
->
modeF‹Sequí˚
;

93 
u8
 
i
 = 0; i < 
pCmd
->
numOfTønsF‹Sequí˚
; i++){

94 if(
pCmd
->
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
){

95 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
å™sTime
);

96 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
å™sTime
);

97 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
hótSëpoöt
);

98 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
hótSëpoöt
);

99 }if(
pCmd
->
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
){

100 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
å™sTime
);

101 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
å™sTime
);

102 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
coﬁSëpoöt
);

103 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
coﬁSëpoöt
);

104 }if(
pCmd
->
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

105 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
å™sTime
);

106 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
å™sTime
);

107 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
hótSëpoöt
);

108 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
hótSëpoöt
);

109 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
coﬁSëpoöt
);

110 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
coﬁSëpoöt
);

112 
°©us
 = 
ZCL_STA_FAILURE
;

116 if(
°©us
 !
ZCL_STA_FAILURE
){

117 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_SET_WEEKLY_SCHEDULE
, 
TRUE
,

118 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

121 
	`ev_buf_‰ì
(
buf
);

123  
°©us
;

124 
	}
}

126 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëWìklyScheduÀCmd_t
 *
pCmd
)

128 
u8
 
buf
[2];

129 
u8
 *
pBuf
 = 
buf
;

131 *
pBuf
++ = 
pCmd
->
daysToRëu∫
;

132 *
pBuf
++ = 
pCmd
->
modeToRëu∫
;

134  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE
, 
TRUE
,

135 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

136 
	}
}

138 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_˛órWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

140  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_CLEAR_WEEKLY_SCHEDULE
, 
TRUE
,

141 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

142 
	}
}

144 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëRñaySètusLogCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

146  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG
, 
TRUE
,

147 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

148 
	}
}

150 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëWìklyScheduÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëWìklyScheduÀR•Cmd_t
 *
pCmd
)

152 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

153 
u8
 
Àn
 = 3;

155 if–(
pCmd
->
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
) ||

156 (
pCmd
->
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
) ){

157 
Àn
 +
pCmd
->
numOfTønsF‹Sequí˚
 * 4;

158 }if(
pCmd
->
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

159 
Àn
 +
pCmd
->
numOfTønsF‹Sequí˚
 * 6;

161  
ZCL_STA_FAILURE
;

164 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

165 if(!
buf
){

166  
ZCL_STA_INSUFFICIENT_SPACE
;

169 
u8
 *
pBuf
 = 
buf
;

171 *
pBuf
++ = 
pCmd
->
numOfTønsF‹Sequí˚
;

172 *
pBuf
++ = 
pCmd
->
dayOfWìkF‹Sequí˚
;

173 *
pBuf
++ = 
pCmd
->
modeF‹Sequí˚
;

174 
u8
 
i
 = 0; i < 
pCmd
->
numOfTønsF‹Sequí˚
; i++){

175 if(
pCmd
->
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
){

176 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
å™sTime
);

177 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
å™sTime
);

178 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
hótSëpoöt
);

179 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pHótMode
[
i
].
hótSëpoöt
);

180 }if(
pCmd
->
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
){

181 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
å™sTime
);

182 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
å™sTime
);

183 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
coﬁSëpoöt
);

184 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pCoﬁMode
[
i
].
coﬁSëpoöt
);

185 }if(
pCmd
->
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

186 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
å™sTime
);

187 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
å™sTime
);

188 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
hótSëpoöt
);

189 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
hótSëpoöt
);

190 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
coﬁSëpoöt
);

191 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£quí˚Mode
.
pBŸhMode
[
i
].
coﬁSëpoöt
);

193 
°©us
 = 
ZCL_STA_FAILURE
;

197 if(
°©us
 !
ZCL_STA_FAILURE
){

198 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE_RSP
, 
TRUE
,

199 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

202 
	`ev_buf_‰ì
(
buf
);

204  
°©us
;

205 
	}
}

207 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëRñaySètusLogR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëRñaySètusLogR•Cmd_t
 *
pCmd
)

209 
u8
 
buf
[11];

210 
u8
 *
pBuf
 = 
buf
;

212 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
timeOfDay
);

213 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
timeOfDay
);

214 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
ªœySètus
);

215 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
ªœySètus
);

216 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
loˇlTemp
);

217 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
loˇlTemp
);

218 *
pBuf
++ = 
pCmd
->
hunidôyInPî˚¡age
;

219 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
£çoöt
);

220 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
£çoöt
);

221 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
uƒódE¡rõs
);

222 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
uƒódE¡rõs
);

224  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_HAVC_THERMOSTAT
, 
ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG_RSP
, 
TRUE
,

225 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 11, 
buf
);

226 
	}
}

230 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_£çoötRai£LowîPrc
(
z˛Incomög_t
 *
pInMsg
)

232 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

233 
u8
 *
pD©a
 = 
pInMsg
->pData;

235 if(
pInMsg
->
˛u°îAµCb
){

236 
z˛_thîmo°©_£çoötRai£LowîCmd_t
 
cmd
;

237 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

239 
cmd
.
mode
 = *
pD©a
++;

240 
cmd
.
amou¡
 = *
pD©a
++;

242 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

244 
°©us
 = 
ZCL_STA_FAILURE
;

247  
°©us
;

248 
	}
}

250 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_£tWìklyScheduÀPrc
(
z˛Incomög_t
 *
pInMsg
)

252 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

253 
u8
 *
pD©a
 = 
pInMsg
->pData;

255 if(
pInMsg
->
˛u°îAµCb
){

256 
z˛_thîmo°©_£tWìklyScheduÀCmd_t
 
cmd
;

257 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

259 
cmd
.
numOfTønsF‹Sequí˚
 = *
pD©a
++;

260 
cmd
.
dayOfWìkF‹Sequí˚
 = *
pD©a
++;

261 
cmd
.
modeF‹Sequí˚
 = *
pD©a
++;

262 if(
cmd
.
numOfTønsF‹Sequí˚
){

263 if(
cmd
.
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
){

264 
cmd
.
£quí˚Mode
.
pHótMode
 = (
hótMode_t
 *)
pD©a
;

265 }if(
cmd
.
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
){

266 
cmd
.
£quí˚Mode
.
pCoﬁMode
 = (
coﬁMode_t
 *)
pD©a
;

267 }if(
cmd
.
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

268 
cmd
.
£quí˚Mode
.
pBŸhMode
 = (
bŸhMode_t
 *)
pD©a
;

272 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

274 
°©us
 = 
ZCL_STA_FAILURE
;

277  
°©us
;

278 
	}
}

280 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëWìklyScheduÀPrc
(
z˛Incomög_t
 *
pInMsg
)

282 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

283 
u8
 *
pD©a
 = 
pInMsg
->pData;

285 if(
pInMsg
->
˛u°îAµCb
){

286 
z˛_thîmo°©_gëWìklyScheduÀCmd_t
 
cmd
;

287 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

289 
cmd
.
daysToRëu∫
 = *
pD©a
++;

290 
cmd
.
modeToRëu∫
 = *
pD©a
++;

292 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

294 
°©us
 = 
ZCL_STA_FAILURE
;

297  
°©us
;

298 
	}
}

300 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_˛órWìklyScheduÀPrc
(
z˛Incomög_t
 *
pInMsg
)

302 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

304 if(
pInMsg
->
˛u°îAµCb
){

305 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

307 
°©us
 = 
ZCL_STA_FAILURE
;

310  
°©us
;

311 
	}
}

313 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëRñaySètusLogPrc
(
z˛Incomög_t
 *
pInMsg
)

315 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

317 if(
pInMsg
->
˛u°îAµCb
){

320 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

322 
°©us
 = 
ZCL_STA_FAILURE
;

325  
°©us
;

326 
	}
}

328 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëWìklyScheduÀR•Prc
(
z˛Incomög_t
 *
pInMsg
)

330 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

331 
u8
 *
pD©a
 = 
pInMsg
->pData;

333 if(
pInMsg
->
˛u°îAµCb
){

334 
z˛_thîmo°©_gëWìklyScheduÀR•Cmd_t
 
cmd
;

335 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

337 
cmd
.
numOfTønsF‹Sequí˚
 = *
pD©a
++;

338 
cmd
.
dayOfWìkF‹Sequí˚
 = *
pD©a
++;

339 
cmd
.
modeF‹Sequí˚
 = *
pD©a
++;

340 if(
cmd
.
numOfTønsF‹Sequí˚
){

341 if(
cmd
.
modeF‹Sequí˚
 =
HEAT_SERPOINT_FIELD_PRESENT
){

342 
cmd
.
£quí˚Mode
.
pHótMode
 = (
hótMode_t
 *)
pD©a
;

343 }if(
cmd
.
modeF‹Sequí˚
 =
COOL_SETPOINT_FIELD_PRESENT
){

344 
cmd
.
£quí˚Mode
.
pCoﬁMode
 = (
coﬁMode_t
 *)
pD©a
;

345 }if(
cmd
.
modeF‹Sequí˚
 =
BOTH_SETPOINT_FIELD_PRESENT
){

346 
cmd
.
£quí˚Mode
.
pBŸhMode
 = (
bŸhMode_t
 *)
pD©a
;

350 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

352 
°©us
 = 
ZCL_STA_FAILURE
;

355  
°©us
;

356 
	}
}

358 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_gëRñaySètusLogR•Prc
(
z˛Incomög_t
 *
pInMsg
)

360 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

361 
u8
 *
pD©a
 = 
pInMsg
->pData;

363 if(
pInMsg
->
˛u°îAµCb
){

364 
z˛_thîmo°©_gëRñaySètusLogR•Cmd_t
 
cmd
;

365 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

367 
cmd
.
timeOfDay
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

368 
pD©a
 += 2;

369 
cmd
.
ªœySètus
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

370 
pD©a
 += 2;

371 
cmd
.
loˇlTemp
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

372 
pD©a
 += 2;

373 
cmd
.
hunidôyInPî˚¡age
 = *
pD©a
++;

374 
cmd
.
£çoöt
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

375 
pD©a
 += 2;

376 
cmd
.
uƒódE¡rõs
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

377 
pD©a
 += 2;

379 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

381 
°©us
 = 
ZCL_STA_FAILURE
;

384  
°©us
;

385 
	}
}

387 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

389 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

391 
pInMsg
->
hdr
.
cmd
)

393 
ZCL_CMD_THERMOSTAT_SETPOINT_RAISE_LOWER
:

394 
°©us
 = 
	`z˛_thîmo°©_£çoötRai£LowîPrc
(
pInMsg
);

396 
ZCL_CMD_THERMOSTAT_SET_WEEKLY_SCHEDULE
:

397 
°©us
 = 
	`z˛_thîmo°©_£tWìklyScheduÀPrc
(
pInMsg
);

399 
ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE
:

400 
°©us
 = 
	`z˛_thîmo°©_gëWìklyScheduÀPrc
(
pInMsg
);

402 
ZCL_CMD_THERMOSTAT_CLEAR_WEEKLY_SCHEDULE
:

403 
°©us
 = 
	`z˛_thîmo°©_˛órWìklyScheduÀPrc
(
pInMsg
);

405 
ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG
:

406 
°©us
 = 
	`z˛_thîmo°©_gëRñaySètusLogPrc
(
pInMsg
);

409 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

413  
°©us
;

414 
	}
}

416 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

418 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

420 
pInMsg
->
hdr
.
cmd
)

422 
ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE_RSP
:

423 
°©us
 = 
	`z˛_thîmo°©_gëWìklyScheduÀR•Prc
(
pInMsg
);

425 
ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG_RSP
:

426 
°©us
 = 
	`z˛_thîmo°©_gëRñaySètusLogR•Prc
(
pInMsg
);

429 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

433  
°©us
;

434 
	}
}

436 
_CODE_ZCL_
 
°©us_t
 
	$z˛_thîmo°©_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

438 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

439  
	`z˛_thîmo°©_˛õ¡CmdH™dÀr
(
pInMsg
);

441  
	`z˛_thîmo°©_£rvîCmdH™dÀr
(
pInMsg
);

443 
	}
}

	@zigbee/zcl/hvac/zcl_thermostat.h

24 #i‚de‡
ZCL_THERMOSTAT_H


25 
	#ZCL_THERMOSTAT_H


	)

33 
	#ZCL_ATTRID_HVAC_THERMOSTAT_LOCAL_TEMPERATURE
 0x0000

	)

34 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OUTDOOR_TEMPERATURE
 0x0001

	)

35 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPANCY
 0x0002

	)

36 
	#ZCL_ATTRID_HVAC_THERMOSTAT_ABS_MIN_HEAT_SETPOINT_LIMIT
 0x0003

	)

37 
	#ZCL_ATTRID_HVAC_THERMOSTAT_ABS_MAX_HEAT_SETPOINT_LIMIT
 0x0004

	)

38 
	#ZCL_ATTRID_HVAC_THERMOSTAT_ABS_MIN_COOL_SETPOINT_LIMIT
 0x0005

	)

39 
	#ZCL_ATTRID_HVAC_THERMOSTAT_ABS_MAX_COOL_SETPOINT_LIMIT
 0x0006

	)

40 
	#ZCL_ATTRID_HVAC_THERMOSTAT_PI_COOLING_DEMAND
 0x0007

	)

41 
	#ZCL_ATTRID_HVAC_THERMOSTAT_PI_HEATING_DEMAND
 0x0008

	)

42 
	#ZCL_ATTRID_HVAC_THERMOSTAT_SYS_TYPE_CONFIGURATION
 0x0009

	)

43 
	#ZCL_ATTRID_HVAC_THERMOSTAT_LOCAL_TEMP_CALIBRATION
 0x0010

	)

44 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPIED_COOLING_SETPOINT
 0x0011

	)

45 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPIED_HEATING_SETPOINT
 0x0012

	)

46 
	#ZCL_ATTRID_HVAC_THERMOSTAT_UNOCCUPIED_COOLING_SETPOINT
 0x0013

	)

47 
	#ZCL_ATTRID_HVAC_THERMOSTAT_UNOCCUPIED_HEATING_SETPOINT
 0x0014

	)

48 
	#ZCL_ATTRID_HVAC_THERMOSTAT_MIN_HEAT_SETPOINT_LIMIT
 0x0015

	)

49 
	#ZCL_ATTRID_HVAC_THERMOSTAT_MAX_HEAT_SETPOINT_LIMIT
 0x0016

	)

50 
	#ZCL_ATTRID_HVAC_THERMOSTAT_MIN_COOL_SETPOINT_LIMIT
 0x0017

	)

51 
	#ZCL_ATTRID_HVAC_THERMOSTAT_MAX_COOL_SETPOINT_LIMIT
 0x0018

	)

52 
	#ZCL_ATTRID_HVAC_THERMOSTAT_MIN_SETPOINT_DEAD_BAND
 0x0019

	)

53 
	#ZCL_ATTRID_HVAC_THERMOSTAT_REMOTE_SENSING
 0x001A

	)

54 
	#ZCL_ATTRID_HVAC_THERMOSTAT_CTRL_SEQUENCE_OF_OPERATION
 0x001B

	)

55 
	#ZCL_ATTRID_HVAC_THERMOSTAT_SYS_MODE
 0x001C

	)

56 
	#ZCL_ATTRID_HVAC_THERMOSTAT_ALARM_MASK
 0x001D

	)

57 
	#ZCL_ATTRID_HVAC_THERMOSTAT_RUNNING_MODE
 0x001E

	)

58 
	#ZCL_ATTRID_HVAC_THERMOSTAT_START_OF_WEEK
 0x0020

	)

59 
	#ZCL_ATTRID_HVAC_THERMOSTAT_NUM_OF_WEEKLY_TRANSITIONS
 0x0021

	)

60 
	#ZCL_ATTRID_HVAC_THERMOSTAT_NUM_OF_DAILY_TRANSITIONS
 0x0022

	)

61 
	#ZCL_ATTRID_HVAC_THERMOSTAT_TEMP_SETPOINT_HOLD
 0x0023

	)

62 
	#ZCL_ATTRID_HVAC_THERMOSTAT_TEMP_SETPOINT_HOLD_DURATION
 0x0024

	)

63 
	#ZCL_ATTRID_HVAC_THERMOSTAT_PROGRAMMING_OPERATION_MODE
 0x0025

	)

64 
	#ZCL_ATTRID_HVAC_THERMOSTAT_RUNNING_STATE
 0x0029

	)

65 
	#ZCL_ATTRID_HVAC_THERMOSTAT_SETPOINT_CHANGE_SOURCE
 0x0030

	)

66 
	#ZCL_ATTRID_HVAC_THERMOSTAT_SETPOINT_CHANGE_AMOUNT
 0x0031

	)

67 
	#ZCL_ATTRID_HVAC_THERMOSTAT_SETPOINT_CHANGE_SRC_TIMESTAMP
 0x0032

	)

68 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPIED_SETBACK
 0x0034

	)

69 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPIED_SETBACK_MIN
 0x0035

	)

70 
	#ZCL_ATTRID_HVAC_THERMOSTAT_OCCUPIED_SETBACK_MAX
 0x0036

	)

71 
	#ZCL_ATTRID_HVAC_THERMOSTAT_UNOCCUPIED_SETBACK
 0x0037

	)

72 
	#ZCL_ATTRID_HVAC_THERMOSTAT_UNOCCUPIED_SETBACK_MIN
 0x0038

	)

73 
	#ZCL_ATTRID_HVAC_THERMOSTAT_UNOCCUPIED_SETBACK_MAX
 0x0039

	)

74 
	#ZCL_ATTRID_HVAC_THERMOSTAT_EMERGENCY_HEAT_DELTA
 0x003A

	)

75 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_TYPE
 0x0040

	)

76 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_CAPACITY
 0x0041

	)

77 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_REFRIGERANT_TYPE
 0x0042

	)

78 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_COMPRESSOR_TYPE
 0x0043

	)

79 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_ERROR_CODE
 0x0044

	)

80 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_LOUVER_POSITION
 0x0045

	)

81 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_COIL_TEMP
 0x0046

	)

82 
	#ZCL_ATTRID_HVAC_THERMOSTAT_AC_CAPACITY_FORMAT
 0x0047

	)

88 
	#ZCL_CMD_THERMOSTAT_SETPOINT_RAISE_LOWER
 0x00

	)

89 
	#ZCL_CMD_THERMOSTAT_SET_WEEKLY_SCHEDULE
 0x01

	)

90 
	#ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE
 0x02

	)

91 
	#ZCL_CMD_THERMOSTAT_CLEAR_WEEKLY_SCHEDULE
 0x03

	)

92 
	#ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG
 0x04

	)

94 
	#ZCL_CMD_THERMOSTAT_GET_WEEKLY_SCHEDULE_RSP
 0x00

	)

95 
	#ZCL_CMD_THERMOSTAT_GET_RELAY_STATUS_LOG_RSP
 0x01

	)

103 
	mADJUST_HEAT_SETPOINT
,

104 
	mADJUST_COOL_SETPOINT
,

105 
	mADJUST_HEAT_COOL_SETPOINT
,

106 }
	t£çoötMode_t
;

110 
£çoötMode_t
 
	mmode
;

111 
s8
 
	mamou¡
;

112 }
	tz˛_thîmo°©_£çoötRai£LowîCmd_t
;

119 
u16
 
	må™sTime
;

120 
u16
 
	mhótSëpoöt
;

121 }
	thótMode_t
;

125 
u16
 
	må™sTime
;

126 
u16
 
	mcoﬁSëpoöt
;

127 }
	tcoﬁMode_t
;

131 
u16
 
	må™sTime
;

132 
u16
 
	mhótSëpoöt
;

133 
u16
 
	mcoﬁSëpoöt
;

134 }
	tbŸhMode_t
;

138 
hótMode_t
 *
	mpHótMode
;

139 
coﬁMode_t
 *
	mpCoﬁMode
;

140 
bŸhMode_t
 *
	mpBŸhMode
;

141 }
	t£quí˚Mode_t
;

143 
	#HEAT_SERPOINT_FIELD_PRESENT
 0x01

	)

144 
	#COOL_SETPOINT_FIELD_PRESENT
 0x02

	)

145 
	#BOTH_SETPOINT_FIELD_PRESENT
 0x03

	)

149 
£quí˚Mode_t
 
	m£quí˚Mode
;

150 
u8
 
	mnumOfTønsF‹Sequí˚
;

151 
u8
 
	mdayOfWìkF‹Sequí˚
;

152 
u8
 
	mmodeF‹Sequí˚
;

153 }
	tz˛_thîmo°©_£tWìklyScheduÀCmd_t
;

160 
u8
 
	mdaysToRëu∫
;

161 
u8
 
	mmodeToRëu∫
;

162 }
	tz˛_thîmo°©_gëWìklyScheduÀCmd_t
;

167 
z˛_thîmo°©_£tWìklyScheduÀCmd_t
 
	tz˛_thîmo°©_gëWìklyScheduÀR•Cmd_t
;

174 
u16
 
	mtimeOfDay
;

175 
u16
 
	mªœySètus
;

176 
s16
 
	mloˇlTemp
;

177 
u16
 
	m£çoöt
;

178 
u16
 
	muƒódE¡rõs
;

179 
u8
 
	mhunidôyInPî˚¡age
;

180 }
	tz˛_thîmo°©_gëRñaySètusLogR•Cmd_t
;

183 
°©us_t
 
z˛_thîmo°©_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

185 
°©us_t
 
z˛_thîmo°©_£çoötRai£LowîCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_£çoötRai£LowîCmd_t
 *
pCmd
);

186 
	#z˛_thîmo°©_£çoötRai£LowîCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_thîmo°©_£çoötRai£LowîCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

188 
°©us_t
 
z˛_thîmo°©_£tWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_£tWìklyScheduÀCmd_t
 *
pCmd
);

189 
	#z˛_thîmo°©_£tWìklyScheduÀCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_thîmo°©_£tWìklyScheduÀCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

191 
°©us_t
 
z˛_thîmo°©_gëWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëWìklyScheduÀCmd_t
 *
pCmd
);

192 
	#z˛_thîmo°©_gëWìklyScheduÀCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_thîmo°©_gëWìklyScheduÀCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

194 
°©us_t
 
z˛_thîmo°©_˛órWìklyScheduÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

195 
	#z˛_thîmo°©_˛órWìklyScheduÀCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_thîmo°©_˛órWìklyScheduÀCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

197 
°©us_t
 
z˛_thîmo°©_gëRñaySètusLogCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

198 
	#z˛_thîmo°©_gëRñaySètusLogCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_thîmo°©_gëRñaySètusLogCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

200 
°©us_t
 
z˛_thîmo°©_gëWìklyScheduÀR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëWìklyScheduÀR•Cmd_t
 *
pCmd
);

201 
	#z˛_thîmo°©_gëWìklyScheduÀR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_thîmo°©_gëWìklyScheduÀR•Cmd
(◊), (b), (c), (d), (e)))

	)

203 
°©us_t
 
z˛_thîmo°©_gëRñaySètusLogR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_thîmo°©_gëRñaySètusLogR•Cmd_t
 *
pCmd
);

204 
	#z˛_thîmo°©_gëRñaySètusLogR•CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_thîmo°©_gëRñaySètusLogR•Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/light_color_control/zcl_light_colorCtrl.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


49 
z˛_lightCﬁ‹Cål_°¨tUpCﬁ‹TempMúeds
(
u8
 
ídpoöt
);

50 
°©us_t
 
z˛_lightCﬁ‹Cål_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

53 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

55 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

57 
°©us
 = 
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_lightCﬁ‹Cål_cmdH™dÀr
, 
cb
);

59 if(
°©us
 =
ZCL_STA_SUCCESS
){

60 
	`z˛_lightCﬁ‹Cål_°¨tUpCﬁ‹TempMúeds
(
ídpoöt
);

63  
°©us
;

64 
	}
}

66 
_CODE_ZCL_
 
	$z˛_lightCﬁ‹Cål_°¨tUpCﬁ‹TempMúeds
(
u8
 
ídpoöt
)

68 
u16
 
°¨tUpCﬁ‹TempMúeds
 = 0;

69 
u16
 
¥eCﬁ‹TempMúeds
 = 0;

70 
u16
 
©åLí
 = 0;

72 if–(
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS
, &
©åLí
, (
u8
 *)&
°¨tUpCﬁ‹TempMúeds
Ë=
ZCL_STA_SUCCESS
) &&

73 (
	`z˛_gëAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS
, &
©åLí
, (
u8
 *)&
¥eCﬁ‹TempMúeds
Ë=
ZCL_STA_SUCCESS
) ){

74 
u16
 
d°Cﬁ‹TempMúeds
 = 0;

76 if(
°¨tUpCﬁ‹TempMúeds
 =
ZCL_START_UP_COLOR_TEMPERATURE_MIREDS_TO_PREVIOUS
){

77 
d°Cﬁ‹TempMúeds
 = 
¥eCﬁ‹TempMúeds
;

79 
d°Cﬁ‹TempMúeds
 = 
°¨tUpCﬁ‹TempMúeds
;

82 if(
d°Cﬁ‹TempMúeds
 !
¥eCﬁ‹TempMúeds
){

83 
	`z˛_£tAârVÆ
(
ídpoöt
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS
, (
u8
 *)&
d°Cﬁ‹TempMúeds
);

86 
	}
}

89 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_move2hue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToHueCmd_t
 *
pMove2Hue
)

91 
u8
 
buf
[6];

92 
u8
 *
pBuf
 = 
buf
;

94 *
pBuf
++ = 
pMove2Hue
->
hue
;

95 *
pBuf
++ = 
pMove2Hue
->
dúe˘i⁄
;

96 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Hue
->
å™sôi⁄Time
);

97 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Hue
->
å™sôi⁄Time
);

98 if(
pMove2Hue
->
›tPª£¡
){

99 *
pBuf
++ = 
pMove2Hue
->
›ti⁄sMask
;

100 *
pBuf
++ = 
pMove2Hue
->
›ti⁄sOvîride
;

103  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE
, 
TRUE
,

104 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

105 
	}
}

107 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_moveHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveHueCmd_t
 *
pMoveHue
)

109 
u8
 
buf
[4];

110 
u8
 *
pBuf
 = 
buf
;

112 *
pBuf
++ = 
pMoveHue
->
moveMode
;

113 *
pBuf
++ = 
pMoveHue
->
øã
;

114 if(
pMoveHue
->
›tPª£¡
){

115 *
pBuf
++ = 
pMoveHue
->
›ti⁄sMask
;

116 *
pBuf
++ = 
pMoveHue
->
›ti⁄sOvîride
;

119  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_HUE
, 
TRUE
,

120 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

121 
	}
}

123 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_°ïHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpHueCmd_t
 *
pSãpHue
)

125 
u8
 
buf
[5];

126 
u8
 *
pBuf
 = 
buf
;

128 *
pBuf
++ = 
pSãpHue
->
°ïMode
;

129 *
pBuf
++ = 
pSãpHue
->
°ïSize
;

130 *
pBuf
++ = 
pSãpHue
->
å™sôi⁄Time
;

131 if(
pSãpHue
->
›tPª£¡
){

132 *
pBuf
++ = 
pSãpHue
->
›ti⁄sMask
;

133 *
pBuf
++ = 
pSãpHue
->
›ti⁄sOvîride
;

136  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_HUE
, 
TRUE
,

137 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

138 
	}
}

140 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_move2ßtuøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 *
pMove2S©
)

142 
u8
 
buf
[5];

143 
u8
 *
pBuf
 = 
buf
;

145 *
pBuf
++ = 
pMove2S©
->
ßtuøti⁄
;

146 *
pBuf
++ = 
	`LO_UINT16
(
pMove2S©
->
å™sôi⁄Time
);

147 *
pBuf
++ = 
	`HI_UINT16
(
pMove2S©
->
å™sôi⁄Time
);

148 if(
pMove2S©
->
›tPª£¡
){

149 *
pBuf
++ = 
pMove2S©
->
›ti⁄sMask
;

150 *
pBuf
++ = 
pMove2S©
->
›ti⁄sOvîride
;

153  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_SATURATION
, 
TRUE
,

154 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

155 
	}
}

157 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_moveS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
 *
pMoveS©
)

159 
u8
 
buf
[4];

160 
u8
 *
pBuf
 = 
buf
;

162 *
pBuf
++ = 
pMoveS©
->
moveMode
;

163 *
pBuf
++ = 
pMoveS©
->
øã
;

164 if(
pMoveS©
->
›tPª£¡
){

165 *
pBuf
++ = 
pMoveS©
->
›ti⁄sMask
;

166 *
pBuf
++ = 
pMoveS©
->
›ti⁄sOvîride
;

169  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_SATURATION
, 
TRUE
,

170 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

171 
	}
}

173 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_°ïS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
 *
pSãpS©
)

175 
u8
 
buf
[5];

176 
u8
 *
pBuf
 = 
buf
;

178 *
pBuf
++ = 
pSãpS©
->
°ïMode
;

179 *
pBuf
++ = 
pSãpS©
->
°ïSize
;

180 *
pBuf
++ = 
pSãpS©
->
å™sôi⁄Time
;

181 if(
pSãpS©
->
›tPª£¡
){

182 *
pBuf
++ = 
pSãpS©
->
›ti⁄sMask
;

183 *
pBuf
++ = 
pSãpS©
->
›ti⁄sOvîride
;

186  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_SATURATION
, 
TRUE
,

187 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

188 
	}
}

190 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_move2hueAndS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 *
pMove2HueAndS©
)

192 
u8
 
buf
[6];

193 
u8
 *
pBuf
 = 
buf
;

195 *
pBuf
++ = 
pMove2HueAndS©
->
hue
;

196 *
pBuf
++ = 
pMove2HueAndS©
->
ßtuøti⁄
;

197 *
pBuf
++ = 
	`LO_UINT16
(
pMove2HueAndS©
->
å™sôi⁄Time
);

198 *
pBuf
++ = 
	`HI_UINT16
(
pMove2HueAndS©
->
å™sôi⁄Time
);

199 if(
pMove2HueAndS©
->
›tPª£¡
){

200 *
pBuf
++ = 
pMove2HueAndS©
->
›ti⁄sMask
;

201 *
pBuf
++ = 
pMove2HueAndS©
->
›ti⁄sOvîride
;

204  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION
, 
TRUE
,

205 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

206 
	}
}

207 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_move2cﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 *
pMove2Cﬁ‹
)

209 
u8
 
buf
[8];

210 
u8
 *
pBuf
 = 
buf
;

212 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Cﬁ‹
->
cﬁ‹X
);

213 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Cﬁ‹
->
cﬁ‹X
);

214 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Cﬁ‹
->
cﬁ‹Y
);

215 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Cﬁ‹
->
cﬁ‹Y
);

216 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Cﬁ‹
->
å™sôi⁄Time
);

217 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Cﬁ‹
->
å™sôi⁄Time
);

218 if(
pMove2Cﬁ‹
->
›tPª£¡
){

219 *
pBuf
++ = 
pMove2Cﬁ‹
->
›ti⁄sMask
;

220 *
pBuf
++ = 
pMove2Cﬁ‹
->
›ti⁄sOvîride
;

223  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR
, 
TRUE
,

224 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

225 
	}
}

227 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_moveCﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveCﬁ‹Cmd_t
 *
pMoveCﬁ‹
)

229 
u8
 
buf
[6];

230 
u8
 *
pBuf
 = 
buf
;

232 *
pBuf
++ = 
	`LO_UINT16
(
pMoveCﬁ‹
->
øãX
);

233 *
pBuf
++ = 
	`HI_UINT16
(
pMoveCﬁ‹
->
øãX
);

234 *
pBuf
++ = 
	`LO_UINT16
(
pMoveCﬁ‹
->
øãY
);

235 *
pBuf
++ = 
	`HI_UINT16
(
pMoveCﬁ‹
->
øãY
);

236 if(
pMoveCﬁ‹
->
›tPª£¡
){

237 *
pBuf
++ = 
pMoveCﬁ‹
->
›ti⁄sMask
;

238 *
pBuf
++ = 
pMoveCﬁ‹
->
›ti⁄sOvîride
;

241  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR
, 
TRUE
,

242 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

243 
	}
}

245 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_°ïCﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpCﬁ‹Cmd_t
 *
pSãpCﬁ‹
)

247 
u8
 
buf
[8];

248 
u8
 *
pBuf
 = 
buf
;

250 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹
->
°ïX
);

251 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹
->
°ïX
);

252 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹
->
°ïY
);

253 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹
->
°ïY
);

254 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹
->
å™sôi⁄Time
);

255 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹
->
å™sôi⁄Time
);

256 if(
pSãpCﬁ‹
->
›tPª£¡
){

257 *
pBuf
++ = 
pSãpCﬁ‹
->
›ti⁄sMask
;

258 *
pBuf
++ = 
pSãpCﬁ‹
->
›ti⁄sOvîride
;

261  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR
, 
TRUE
,

262 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

263 
	}
}

265 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_move2cﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 *
pMove2Cﬁ‹Temp
)

267 
u8
 
buf
[6];

268 
u8
 *
pBuf
 = 
buf
;

270 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Cﬁ‹Temp
->
cﬁ‹Tem≥øtuª
);

271 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Cﬁ‹Temp
->
cﬁ‹Tem≥øtuª
);

272 *
pBuf
++ = 
	`LO_UINT16
(
pMove2Cﬁ‹Temp
->
å™sôi⁄Time
);

273 *
pBuf
++ = 
	`HI_UINT16
(
pMove2Cﬁ‹Temp
->
å™sôi⁄Time
);

274 if(
pMove2Cﬁ‹Temp
->
›tPª£¡
){

275 *
pBuf
++ = 
pMove2Cﬁ‹Temp
->
›ti⁄sMask
;

276 *
pBuf
++ = 
pMove2Cﬁ‹Temp
->
›ti⁄sOvîride
;

279  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR_TEMPERATURE
, 
TRUE
,

280 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

281 
	}
}

283 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_íh™˚dMove2Hue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 *
pEnh™˚dMove2Hue
)

285 
u8
 
buf
[7];

286 
u8
 *
pBuf
 = 
buf
;

288 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dMove2Hue
->
íh™˚dHue
);

289 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dMove2Hue
->
íh™˚dHue
);

290 *
pBuf
++ = 
pEnh™˚dMove2Hue
->
dúe˘i⁄
;

291 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dMove2Hue
->
å™sôi⁄Time
);

292 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dMove2Hue
->
å™sôi⁄Time
);

293 if(
pEnh™˚dMove2Hue
->
›tPª£¡
){

294 *
pBuf
++ = 
pEnh™˚dMove2Hue
->
›ti⁄sMask
;

295 *
pBuf
++ = 
pEnh™˚dMove2Hue
->
›ti⁄sOvîride
;

298  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE
, 
TRUE
,

299 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

300 
	}
}

302 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_íh™˚dMoveHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
 *
pEnh™˚dMoveHue
)

304 
u8
 
buf
[5];

305 
u8
 *
pBuf
 = 
buf
;

307 *
pBuf
++ = 
pEnh™˚dMoveHue
->
moveMode
;

308 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dMoveHue
->
øã
);

309 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dMoveHue
->
øã
);

310 if(
pEnh™˚dMoveHue
->
›tPª£¡
){

311 *
pBuf
++ = 
pEnh™˚dMoveHue
->
›ti⁄sMask
;

312 *
pBuf
++ = 
pEnh™˚dMoveHue
->
›ti⁄sOvîride
;

315  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_HUE
, 
TRUE
,

316 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

317 
	}
}

319 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_íh™˚dSãpHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
 *
pEnh™˚dSãpHue
)

321 
u8
 
buf
[7];

322 
u8
 *
pBuf
 = 
buf
;

324 *
pBuf
++ = 
pEnh™˚dSãpHue
->
°ïMode
;

325 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dSãpHue
->
°ïSize
);

326 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dSãpHue
->
°ïSize
);

327 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dSãpHue
->
å™sôi⁄Time
);

328 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dSãpHue
->
å™sôi⁄Time
);

329 if(
pEnh™˚dSãpHue
->
›tPª£¡
){

330 *
pBuf
++ = 
pEnh™˚dSãpHue
->
›ti⁄sMask
;

331 *
pBuf
++ = 
pEnh™˚dSãpHue
->
›ti⁄sOvîride
;

334  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_STEP_HUE
, 
TRUE
,

335 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

336 
	}
}

338 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_íh™˚dMove2HueAndS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
 *
pEnh™˚dMove2HueAndS©
)

340 
u8
 
buf
[7];

341 
u8
 *
pBuf
 = 
buf
;

343 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dMove2HueAndS©
->
íh™˚dHue
);

344 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dMove2HueAndS©
->
íh™˚dHue
);

345 *
pBuf
++ = 
pEnh™˚dMove2HueAndS©
->
ßtuøti⁄
;

346 *
pBuf
++ = 
	`LO_UINT16
(
pEnh™˚dMove2HueAndS©
->
å™sôi⁄Time
);

347 *
pBuf
++ = 
	`HI_UINT16
(
pEnh™˚dMove2HueAndS©
->
å™sôi⁄Time
);

348 if(
pEnh™˚dMove2HueAndS©
->
›tPª£¡
){

349 *
pBuf
++ = 
pEnh™˚dMove2HueAndS©
->
›ti⁄sMask
;

350 *
pBuf
++ = 
pEnh™˚dMove2HueAndS©
->
›ti⁄sOvîride
;

353  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE_AND_SATURATION
, 
TRUE
,

354 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

355 
	}
}

357 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_cﬁ‹Lo›Së
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
 *
pCﬁ‹Lo›Së
)

359 
u8
 
buf
[9];

360 
u8
 *
pBuf
 = 
buf
;

362 *
pBuf
++ = 
pCﬁ‹Lo›Së
->
upd©eFœgs
.updateFlags;

363 *
pBuf
++ = 
pCﬁ‹Lo›Së
->
a˘i⁄
;

364 *
pBuf
++ = 
pCﬁ‹Lo›Së
->
dúe˘i⁄
;

365 *
pBuf
++ = 
	`LO_UINT16
(
pCﬁ‹Lo›Së
->
time
);

366 *
pBuf
++ = 
	`HI_UINT16
(
pCﬁ‹Lo›Së
->
time
);

367 *
pBuf
++ = 
	`LO_UINT16
(
pCﬁ‹Lo›Së
->
°¨tHue
);

368 *
pBuf
++ = 
	`HI_UINT16
(
pCﬁ‹Lo›Së
->
°¨tHue
);

369 if(
pCﬁ‹Lo›Së
->
›tPª£¡
){

370 *
pBuf
++ = 
pCﬁ‹Lo›Së
->
›ti⁄sMask
;

371 *
pBuf
++ = 
pCﬁ‹Lo›Së
->
›ti⁄sOvîride
;

374  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_COLOR_LOOP_SET
, 
TRUE
,

375 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

376 
	}
}

378 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_°›MoveSãp
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSt›MoveSãpCmd_t
 *
pSt›MoveSãp
)

380 
u8
 
buf
[2];

381 
u8
 *
pBuf
 = 
buf
;

383 if(
pSt›MoveSãp
->
›tPª£¡
){

384 *
pBuf
++ = 
pSt›MoveSãp
->
›ti⁄sMask
;

385 *
pBuf
++ = 
pSt›MoveSãp
->
›ti⁄sOvîride
;

388  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_STOP_MOVE_STEP
, 
TRUE
,

389 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

390 
	}
}

392 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_moveCﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
 *
pMoveCﬁ‹Temp
)

394 
u8
 
buf
[9];

395 
u8
 *
pBuf
 = 
buf
;

397 *
pBuf
++ = 
pMoveCﬁ‹Temp
->
moveMode
;

398 *
pBuf
++ = 
	`LO_UINT16
(
pMoveCﬁ‹Temp
->
øã
);

399 *
pBuf
++ = 
	`HI_UINT16
(
pMoveCﬁ‹Temp
->
øã
);

400 *
pBuf
++ = 
	`LO_UINT16
(
pMoveCﬁ‹Temp
->
cﬁ‹TempMöMúeds
);

401 *
pBuf
++ = 
	`HI_UINT16
(
pMoveCﬁ‹Temp
->
cﬁ‹TempMöMúeds
);

402 *
pBuf
++ = 
	`LO_UINT16
(
pMoveCﬁ‹Temp
->
cﬁ‹TempMaxMúeds
);

403 *
pBuf
++ = 
	`HI_UINT16
(
pMoveCﬁ‹Temp
->
cﬁ‹TempMaxMúeds
);

404 if(
pMoveCﬁ‹Temp
->
›tPª£¡
){

405 *
pBuf
++ = 
pMoveCﬁ‹Temp
->
›ti⁄sMask
;

406 *
pBuf
++ = 
pMoveCﬁ‹Temp
->
›ti⁄sOvîride
;

409  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR_TEMPERATURE
, 
TRUE
,

410 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

411 
	}
}

413 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_°ïCﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
 *
pSãpCﬁ‹Temp
)

415 
u8
 
buf
[11];

416 
u8
 *
pBuf
 = 
buf
;

418 *
pBuf
++ = 
pSãpCﬁ‹Temp
->
°ïMode
;

419 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹Temp
->
°ïSize
);

420 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹Temp
->
°ïSize
);

421 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹Temp
->
å™sôi⁄Time
);

422 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹Temp
->
å™sôi⁄Time
);

423 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹Temp
->
cﬁ‹TempMöMúeds
);

424 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹Temp
->
cﬁ‹TempMöMúeds
);

425 *
pBuf
++ = 
	`LO_UINT16
(
pSãpCﬁ‹Temp
->
cﬁ‹TempMaxMúeds
);

426 *
pBuf
++ = 
	`HI_UINT16
(
pSãpCﬁ‹Temp
->
cﬁ‹TempMaxMúeds
);

427 if(
pSãpCﬁ‹Temp
->
›tPª£¡
){

428 *
pBuf
++ = 
pSãpCﬁ‹Temp
->
›ti⁄sMask
;

429 *
pBuf
++ = 
pSãpCﬁ‹Temp
->
›ti⁄sOvîride
;

432  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
, 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR_TEMPERATURE
, 
TRUE
,

433 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

434 
	}
}

436 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

438 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

439 
u8
 *
pD©a
 = 
pInMsg
->pData;

441 
z˛_cﬁ‹Cål_cmdPaylﬂd_t
 
cmdPaylﬂd
;

442 
	`mem£t
((
u8
 *)&
cmdPaylﬂd
, 0, (
z˛_cﬁ‹Cål_cmdPaylﬂd_t
));

444 
pInMsg
->
hdr
.
cmd
)

446 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE
:

447 
cmdPaylﬂd
.
moveToHue
.
hue
 = *
pD©a
++;

448 
cmdPaylﬂd
.
moveToHue
.
dúe˘i⁄
 = *
pD©a
++;

449 
cmdPaylﬂd
.
moveToHue
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

450 
pD©a
 += 2;

451 if(
pInMsg
->
d©aLí
 == 6){

452 
cmdPaylﬂd
.
moveToHue
.
›ti⁄sMask
 = *
pD©a
++;

453 
cmdPaylﬂd
.
moveToHue
.
›ti⁄sOvîride
 = *
pD©a
++;

454 
cmdPaylﬂd
.
moveToHue
.
›tPª£¡
 = 1;

457 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_HUE
:

458 
cmdPaylﬂd
.
moveHue
.
moveMode
 = *
pD©a
++;

459 
cmdPaylﬂd
.
moveHue
.
øã
 = *
pD©a
++;

460 if(
pInMsg
->
d©aLí
 == 4){

461 
cmdPaylﬂd
.
moveHue
.
›ti⁄sMask
 = *
pD©a
++;

462 
cmdPaylﬂd
.
moveHue
.
›ti⁄sOvîride
 = *
pD©a
++;

463 
cmdPaylﬂd
.
moveHue
.
›tPª£¡
 = 1;

466 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_HUE
:

467 
cmdPaylﬂd
.
°ïHue
.
°ïMode
 = *
pD©a
++;

468 
cmdPaylﬂd
.
°ïHue
.
°ïSize
 = *
pD©a
++;

469 
cmdPaylﬂd
.
°ïHue
.
å™sôi⁄Time
 = *
pD©a
++;

470 if(
pInMsg
->
d©aLí
 == 5){

471 
cmdPaylﬂd
.
°ïHue
.
›ti⁄sMask
 = *
pD©a
++;

472 
cmdPaylﬂd
.
°ïHue
.
›ti⁄sOvîride
 = *
pD©a
++;

473 
cmdPaylﬂd
.
°ïHue
.
›tPª£¡
 = 1;

476 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_SATURATION
:

477 
cmdPaylﬂd
.
moveToS©uøti⁄
.
ßtuøti⁄
 = *
pD©a
++;

478 
cmdPaylﬂd
.
moveToS©uøti⁄
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

479 
pD©a
 += 2;

480 if(
pInMsg
->
d©aLí
 == 5){

481 
cmdPaylﬂd
.
moveToS©uøti⁄
.
›ti⁄sMask
 = *
pD©a
++;

482 
cmdPaylﬂd
.
moveToS©uøti⁄
.
›ti⁄sOvîride
 = *
pD©a
++;

483 
cmdPaylﬂd
.
moveToS©uøti⁄
.
›tPª£¡
 = 1;

486 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_SATURATION
:

487 
cmdPaylﬂd
.
moveS©uøti⁄
.
moveMode
 = *
pD©a
++;

488 
cmdPaylﬂd
.
moveS©uøti⁄
.
øã
 = *
pD©a
++;

489 if(
pInMsg
->
d©aLí
 == 4){

490 
cmdPaylﬂd
.
moveS©uøti⁄
.
›ti⁄sMask
 = *
pD©a
++;

491 
cmdPaylﬂd
.
moveS©uøti⁄
.
›ti⁄sOvîride
 = *
pD©a
++;

492 
cmdPaylﬂd
.
moveS©uøti⁄
.
›tPª£¡
 = 1;

495 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_SATURATION
:

496 
cmdPaylﬂd
.
°ïS©uøti⁄
.
°ïMode
 = *
pD©a
++;

497 
cmdPaylﬂd
.
°ïS©uøti⁄
.
°ïSize
 = *
pD©a
++;

498 
cmdPaylﬂd
.
°ïS©uøti⁄
.
å™sôi⁄Time
 = *
pD©a
++;

499 if(
pInMsg
->
d©aLí
 == 5){

500 
cmdPaylﬂd
.
°ïS©uøti⁄
.
›ti⁄sMask
 = *
pD©a
++;

501 
cmdPaylﬂd
.
°ïS©uøti⁄
.
›ti⁄sOvîride
 = *
pD©a
++;

502 
cmdPaylﬂd
.
°ïS©uøti⁄
.
›tPª£¡
 = 1;

505 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION
:

506 
cmdPaylﬂd
.
moveToHueAndS©uøti⁄
.
hue
 = *
pD©a
++;

507 
cmdPaylﬂd
.
moveToHueAndS©uøti⁄
.
ßtuøti⁄
 = *
pD©a
++;

508 
cmdPaylﬂd
.
moveToHueAndS©uøti⁄
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

509 
pD©a
 += 2;

510 if(
pInMsg
->
d©aLí
 == 6){

511 
cmdPaylﬂd
.
moveToHueAndS©uøti⁄
.
›ti⁄sMask
 = *
pD©a
++;

512 
cmdPaylﬂd
.
moveToHueAndS©uøti⁄
.
›ti⁄sOvîride
 = *
pD©a
++;

513 
cmdPaylﬂd
.
moveToHue
.
›tPª£¡
 = 1;

516 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR
:

517 
cmdPaylﬂd
.
moveToCﬁ‹
.
cﬁ‹X
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

518 
pD©a
 += 2;

519 
cmdPaylﬂd
.
moveToCﬁ‹
.
cﬁ‹Y
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

520 
pD©a
 += 2;

521 
cmdPaylﬂd
.
moveToCﬁ‹
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

522 
pD©a
 += 2;

523 if(
pInMsg
->
d©aLí
 == 8){

524 
cmdPaylﬂd
.
moveToCﬁ‹
.
›ti⁄sMask
 = *
pD©a
++;

525 
cmdPaylﬂd
.
moveToCﬁ‹
.
›ti⁄sOvîride
 = *
pD©a
++;

526 
cmdPaylﬂd
.
moveToCﬁ‹
.
›tPª£¡
 = 1;

529 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR
:

530 
cmdPaylﬂd
.
moveCﬁ‹
.
øãX
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

531 
pD©a
 += 2;

532 
cmdPaylﬂd
.
moveCﬁ‹
.
øãY
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

533 
pD©a
 += 2;

534 if(
pInMsg
->
d©aLí
 == 6){

535 
cmdPaylﬂd
.
moveCﬁ‹
.
›ti⁄sMask
 = *
pD©a
++;

536 
cmdPaylﬂd
.
moveCﬁ‹
.
›ti⁄sOvîride
 = *
pD©a
++;

537 
cmdPaylﬂd
.
moveCﬁ‹
.
›tPª£¡
 = 1;

540 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR
:

541 
cmdPaylﬂd
.
°ïCﬁ‹
.
°ïX
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

542 
pD©a
 += 2;

543 
cmdPaylﬂd
.
°ïCﬁ‹
.
°ïY
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

544 
pD©a
 += 2;

545 
cmdPaylﬂd
.
°ïCﬁ‹
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

546 
pD©a
 += 2;

547 if(
pInMsg
->
d©aLí
 == 8){

548 
cmdPaylﬂd
.
°ïCﬁ‹
.
›ti⁄sMask
 = *
pD©a
++;

549 
cmdPaylﬂd
.
°ïCﬁ‹
.
›ti⁄sOvîride
 = *
pD©a
++;

550 
cmdPaylﬂd
.
°ïCﬁ‹
.
›tPª£¡
 = 1;

553 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR_TEMPERATURE
:

554 
cmdPaylﬂd
.
moveToCﬁ‹Tem≥øtuª
.
cﬁ‹Tem≥øtuª
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

555 
pD©a
 += 2;

556 
cmdPaylﬂd
.
moveToCﬁ‹Tem≥øtuª
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

557 
pD©a
 += 2;

558 if(
pInMsg
->
d©aLí
 == 6){

559 
cmdPaylﬂd
.
moveToCﬁ‹Tem≥øtuª
.
›ti⁄sMask
 = *
pD©a
++;

560 
cmdPaylﬂd
.
moveToCﬁ‹Tem≥øtuª
.
›ti⁄sOvîride
 = *
pD©a
++;

561 
cmdPaylﬂd
.
moveCﬁ‹
.
›tPª£¡
 = 1;

564 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE
:

565 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
íh™˚dHue
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

566 
pD©a
 += 2;

567 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
dúe˘i⁄
 = *
pD©a
++;

568 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

569 
pD©a
 += 2;

570 if(
pInMsg
->
d©aLí
 == 7){

571 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
›ti⁄sMask
 = *
pD©a
++;

572 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
›ti⁄sOvîride
 = *
pD©a
++;

573 
cmdPaylﬂd
.
íh™˚dMoveToHue
.
›tPª£¡
 = 1;

576 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_HUE
:

577 
cmdPaylﬂd
.
íh™˚dMoveHue
.
moveMode
 = *
pD©a
++;

578 
cmdPaylﬂd
.
íh™˚dMoveHue
.
øã
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

579 
pD©a
 += 2;

580 if(
pInMsg
->
d©aLí
 == 5){

581 
cmdPaylﬂd
.
íh™˚dMoveHue
.
›ti⁄sMask
 = *
pD©a
++;

582 
cmdPaylﬂd
.
íh™˚dMoveHue
.
›ti⁄sOvîride
 = *
pD©a
++;

583 
cmdPaylﬂd
.
íh™˚dMoveHue
.
›tPª£¡
 = 1;

586 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_STEP_HUE
:

587 
cmdPaylﬂd
.
íh™˚dSãpHue
.
°ïMode
 = *
pD©a
++;

588 
cmdPaylﬂd
.
íh™˚dSãpHue
.
°ïSize
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

589 
pD©a
 += 2;

590 
cmdPaylﬂd
.
íh™˚dSãpHue
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

591 
pD©a
 += 2;

592 if(
pInMsg
->
d©aLí
 == 7){

593 
cmdPaylﬂd
.
íh™˚dSãpHue
.
›ti⁄sMask
 = *
pD©a
++;

594 
cmdPaylﬂd
.
íh™˚dSãpHue
.
›ti⁄sOvîride
 = *
pD©a
++;

595 
cmdPaylﬂd
.
íh™˚dSãpHue
.
›tPª£¡
 = 1;

598 
ZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE_AND_SATURATION
:

599 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
íh™˚dHue
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

600 
pD©a
 += 2;

601 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
ßtuøti⁄
 = *
pD©a
++;

602 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

603 
pD©a
 += 2;

604 if(
pInMsg
->
d©aLí
 == 7){

605 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
›ti⁄sMask
 = *
pD©a
++;

606 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
›ti⁄sOvîride
 = *
pD©a
++;

607 
cmdPaylﬂd
.
íh™˚dMoveToHueAndS©uøti⁄
.
›tPª£¡
 = 1;

610 
ZCL_CMD_LIGHT_COLOR_CONTROL_COLOR_LOOP_SET
:

611 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
upd©eFœgs
.upd©eFœg†*
pD©a
++;

612 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
a˘i⁄
 = *
pD©a
++;

613 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
dúe˘i⁄
 = *
pD©a
++;

614 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

615 
pD©a
 += 2;

616 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
°¨tHue
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

617 
pD©a
 += 2;

618 if(
pInMsg
->
d©aLí
 == 9){

619 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
›ti⁄sMask
 = *
pD©a
++;

620 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
›ti⁄sOvîride
 = *
pD©a
++;

621 
cmdPaylﬂd
.
cﬁ‹Lo›Së
.
›tPª£¡
 = 1;

624 
ZCL_CMD_LIGHT_COLOR_CONTROL_STOP_MOVE_STEP
:

625 if(
pInMsg
->
d©aLí
 == 2){

626 
cmdPaylﬂd
.
°›MoveSãp
.
›ti⁄sMask
 = *
pD©a
++;

627 
cmdPaylﬂd
.
°›MoveSãp
.
›ti⁄sOvîride
 = *
pD©a
++;

628 
cmdPaylﬂd
.
°›MoveSãp
.
›tPª£¡
 = 1;

631 
ZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR_TEMPERATURE
:

632 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
moveMode
 = *
pD©a
++;

633 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
øã
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

634 
pD©a
 += 2;

635 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
cﬁ‹TempMöMúeds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

636 
pD©a
 += 2;

637 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
cﬁ‹TempMaxMúeds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

638 
pD©a
 += 2;

639 if(
pInMsg
->
d©aLí
 == 9){

640 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
›ti⁄sMask
 = *
pD©a
++;

641 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
›ti⁄sOvîride
 = *
pD©a
++;

642 
cmdPaylﬂd
.
moveCﬁ‹Tem≥øtuª
.
›tPª£¡
 = 1;

645 
ZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR_TEMPERATURE
:

646 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
°ïMode
 = *
pD©a
++;

647 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
°ïSize
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

648 
pD©a
 += 2;

649 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
å™sôi⁄Time
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

650 
pD©a
 += 2;

651 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
cﬁ‹TempMöMúeds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

652 
pD©a
 += 2;

653 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
cﬁ‹TempMaxMúeds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

654 
pD©a
 += 2;

655 if(
pInMsg
->
d©aLí
 == 11){

656 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
›ti⁄sMask
 = *
pD©a
++;

657 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
›ti⁄sOvîride
 = *
pD©a
++;

658 
cmdPaylﬂd
.
°ïCﬁ‹Tem≥øtuª
.
›tPª£¡
 = 1;

662 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

666 if(
°©us
 =
ZCL_STA_SUCCESS
){

667 if(
pInMsg
->
˛u°îAµCb
){

668 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
cmdPaylﬂd
);

670 #ifde‡
ZCL_SCENE


671 
u16
 
©åLí
 = 0;

672 
u8
 
s˚√VÆid
 = 0;

673 if(
	`z˛_gëAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, &
©åLí
, (
u8
 *)&
s˚√VÆid
Ë=
ZCL_STA_SUCCESS
){

674 
s˚√VÆid
 = 0;

675 
	`z˛_£tAârVÆ
(
pInMsg
->
msg
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_SCENES
, 
ZCL_ATTRID_SCENE_SCENE_VALID
, (
u8
 *)&
s˚√VÆid
);

681  
°©us
;

682 
	}
}

684 
_CODE_ZCL_
 
°©us_t
 
	$z˛_lightCﬁ‹Cål_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

686 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

687  
	`z˛_lightCﬁ‹Cål_˛õ¡CmdH™dÀr
(
pInMsg
);

689  
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

691 
	}
}

	@zigbee/zcl/light_color_control/zcl_light_colorCtrl.h

24 #i‚de‡
ZCL_LIGHT_COLOR_CTRL_H


25 
	#ZCL_LIGHT_COLOR_CTRL_H


	)

35 
	#ZCL_ATTRID_CURRENT_HUE
 0x0000

	)

36 
	#ZCL_ATTRID_CURRENT_SATURATION
 0x0001

	)

37 
	#ZCL_ATTRID_REMAINING_TIME
 0x0002

	)

38 
	#ZCL_ATTRID_CURRENT_X
 0x0003

	)

39 
	#ZCL_ATTRID_CURRENT_Y
 0x0004

	)

40 
	#ZCL_ATTRID_DRIFT_COMPENSATION
 0x0005

	)

41 
	#ZCL_ATTRID_COMPENSATION_TEXT
 0x0006

	)

42 
	#ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS
 0x0007

	)

43 
	#ZCL_ATTRID_COLOR_MODE
 0x0008

	)

44 
	#ZCL_ATTRID_COLOR_OPTIONS
 0x000F

	)

45 
	#ZCL_ATTRID_ENHANCED_CURRENT_HUE
 0x4000

	)

46 
	#ZCL_ATTRID_ENHANCED_COLOR_MODE
 0x4001

	)

47 
	#ZCL_ATTRID_COLOR_LOOP_ACTIVE
 0x4002

	)

48 
	#ZCL_ATTRID_COLOR_LOOP_DIRECTION
 0x4003

	)

49 
	#ZCL_ATTRID_COLOR_LOOP_TIME
 0x4004

	)

50 
	#ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE
 0x4005

	)

51 
	#ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE
 0x4006

	)

52 
	#ZCL_ATTRID_COLOR_CAPABILITIES
 0x400A

	)

53 
	#ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS
 0x400B

	)

54 
	#ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS
 0x400C

	)

55 
	#ZCL_ATTRID_COUPLE_COLOR_TEMP_TO_LEVEL_MIN_MIREDS
 0x400D

	)

56 
	#ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS
 0x4010

	)

58 
	#ZCL_ATTRID_NUMBER_OF_PRIMARIES
 0x0010

	)

59 
	#ZCL_ATTRID_PRIMARY1_X
 0x0011

	)

60 
	#ZCL_ATTRID_PRIMARY1_Y
 0x0012

	)

61 
	#ZCL_ATTRID_PRIMARY1_INTENSITY
 0x0013

	)

62 
	#ZCL_ATTRID_RESERVED_1
 0x0014

	)

64 
	#ZCL_ATTRID_PRIMARY2_X
 0x0015

	)

65 
	#ZCL_ATTRID_PRIMARY2_Y
 0x0016

	)

66 
	#ZCL_ATTRID_PRIMARY2_INTENSITY
 0x0017

	)

67 
	#ZCL_ATTRID_RESERVED_2
 0x0018

	)

69 
	#ZCL_ATTRID_PRIMARY3_X
 0x0019

	)

70 
	#ZCL_ATTRID_PRIMARY3_Y
 0x001A

	)

71 
	#ZCL_ATTRID_PRIMARY3_INTENSITY
 0x001B

	)

73 
	#ZCL_ATTRID_PRIMARY4_X
 0x0020

	)

74 
	#ZCL_ATTRID_PRIMARY4_Y
 0x0021

	)

75 
	#ZCL_ATTRID_PRIMARY4_INTENSITY
 0x0022

	)

76 
	#ZCL_ATTRID_RESERVED_4
 0x0023

	)

78 
	#ZCL_ATTRID_PRIMARY5_X
 0x0024

	)

79 
	#ZCL_ATTRID_PRIMARY5_Y
 0x0025

	)

80 
	#ZCL_ATTRID_PRIMARY5_INTENSITY
 0x0026

	)

81 
	#ZCL_ATTRID_RESERVED_5
 0x0027

	)

83 
	#ZCL_ATTRID_PRIMARY6_X
 0x0028

	)

84 
	#ZCL_ATTRID_PRIMARY6_Y
 0x0029

	)

85 
	#ZCL_ATTRID_PRIMARY6_INTENSITY
 0x002A

	)

87 
	#ZCL_ATTRID_WHITE_POINT_X
 0x0030

	)

88 
	#ZCL_ATTRID_WHITE_POINT_Y
 0x0031

	)

89 
	#ZCL_ATTRID_COLOR_POINT_RX
 0x0032

	)

90 
	#ZCL_ATTRID_COLOR_POINT_RY
 0x0033

	)

91 
	#ZCL_ATTRID_COLOR_POINT_RINTENSITY
 0x0034

	)

92 
	#ZCL_ATTRID_RESERVED_7
 0x0035

	)

94 
	#ZCL_ATTRID_COLOR_POINT_GX
 0x0036

	)

95 
	#ZCL_ATTRID_COLOR_POINT_GY
 0x0037

	)

96 
	#ZCL_ATTRID_COLOR_POINT_GINTENSITY
 0x0038

	)

97 
	#ZCL_ATTRID_RESERVED_8
 0x0039

	)

99 
	#ZCL_ATTRID_COLOR_POINT_BX
 0x003A

	)

100 
	#ZCL_ATTRID_COLOR_POINT_BY
 0x003B

	)

101 
	#ZCL_ATTRID_COLOR_POINT_BINTENSITY
 0x003C

	)

108 
	#ZCL_COLOR_ATTR_HUE_MIN
 0

	)

109 
	#ZCL_COLOR_ATTR_HUE_MAX
 0xFE

	)

110 
	#ZCL_COLOR_ATTR_SATURATION_MIN
 0

	)

111 
	#ZCL_COLOR_ATTR_SATURATION_MAX
 0xFE

	)

112 
	#ZCL_COLOR_ATTR_ENHANCED_HUE_MIN
 0

	)

113 
	#ZCL_COLOR_ATTR_ENHANCED_HUE_MAX
 0xFFFF

	)

114 
	#ZCL_COLOR_ATTR_XY_MIN
 0

	)

115 
	#ZCL_COLOR_ATTR_XY_MAX
 0xFEFF

	)

116 
	#ZCL_COLOR_ATTR_TEMPERATURE_MIRDES_MIN
 0

	)

117 
	#ZCL_COLOR_ATTR_TEMPERATURE_MIRDES_MAX
 0xFEFF

	)

121 
	#ZCL_COLOR_MODE_CURRENT_HUE_SATURATION
 0x00

	)

122 
	#ZCL_COLOR_MODE_CURRENT_X_Y
 0x01

	)

123 
	#ZCL_COLOR_MODE_COLOR_TEMPERATURE_MIREDS
 0x02

	)

124 
	#ZCL_ENHANCED_COLOR_MODE_CURRENT_HUE_SATURATION
 0x03

	)

127 
	#ZCL_COLOR_CAPABILITIES_BIT_HUE_SATURATION
 0x0001

	)

128 
	#ZCL_COLOR_CAPABILITIES_BIT_ENHANCED_HUE
 0x0002

	)

129 
	#ZCL_COLOR_CAPABILITIES_BIT_COLOR_LOOP
 0x0004

	)

130 
	#ZCL_COLOR_CAPABILITIES_BIT_X_Y_ATTRIBUTES
 0x0008

	)

131 
	#ZCL_COLOR_CAPABILITIES_BIT_COLOR_TEMPERATURE
 0x0010

	)

134 
	#ZCL_START_UP_COLOR_TEMPERATURE_MIREDS_TO_PREVIOUS
 0xFFFF

	)

143 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE
 = 0x00,

144 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_HUE
 = 0x01,

145 
	mZCL_CMD_LIGHT_COLOR_CONTROL_STEP_HUE
 = 0x02,

146 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_SATURATION
 = 0x03,

147 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_SATURATION
 = 0x04,

148 
	mZCL_CMD_LIGHT_COLOR_CONTROL_STEP_SATURATION
 = 0x05,

149 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION
 = 0x06,

150 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR
 = 0x07,

151 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR
 = 0x08,

152 
	mZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR
 = 0x09,

153 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_TO_COLOR_TEMPERATURE
 = 0x0A,

154 
	mZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE
 = 0x40,

155 
	mZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_HUE
 = 0x41,

156 
	mZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_STEP_HUE
 = 0x42,

157 
	mZCL_CMD_LIGHT_COLOR_CONTROL_ENHANCED_MOVE_TO_HUE_AND_SATURATION
 = 0x43,

158 
	mZCL_CMD_LIGHT_COLOR_CONTROL_COLOR_LOOP_SET
 = 0x44,

159 
	mZCL_CMD_LIGHT_COLOR_CONTROL_STOP_MOVE_STEP
 = 0x47,

160 
	mZCL_CMD_LIGHT_COLOR_CONTROL_MOVE_COLOR_TEMPERATURE
 = 0x4B,

161 
	mZCL_CMD_LIGHT_COLOR_CONTROL_STEP_COLOR_TEMPERATURE
 = 0x4C,

162 } 
	tz˛_cﬁ‹CålCmdId_t
;

167 
	mCOLOR_CTRL_DIRECTION_SHORTEST_DISTANCE
 = 0x00,

168 
	mCOLOR_CTRL_DIRECTION_LONGEST_DISTANCE
 = 0x01,

169 
	mCOLOR_CTRL_DIRECTION_UP
 = 0x02,

170 
	mCOLOR_CTRL_DIRECTION_DOWN
 = 0x03,

171 } 
	tz˛_cﬁ‹CålDú_t
;

176 
	mCOLOR_CTRL_MOVE_STOP
 = 0x00,

177 
	mCOLOR_CTRL_MOVE_UP
 = 0x01,

178 
	mCOLOR_CTRL_MOVE_RESERVED
 = 0x02,

179 
	mCOLOR_CTRL_MOVE_DOWN
 = 0x03,

180 } 
	tz˛_cﬁ‹CålMoveMode_t
;

184 
	mCOLOR_CTRL_STEP_MODE_RESERVED1
 = 0x00,

185 
	mCOLOR_CTRL_STEP_MODE_UP
 = 0x01,

186 
	mCOLOR_CTRL_STEP_MODE_RESERVED2
 = 0x02,

187 
	mCOLOR_CTRL_STEP_MODE_DOWN
 = 0x03,

188 } 
	tz˛_cﬁ‹CålSãpMode_t
;

192 
u8
 
	mupd©eFœgs
;

194 
u8
 
	ma˘i⁄
:1;

195 
u8
 
	mdúe˘i⁄
:1;

196 
u8
 
	mtime
:1;

197 
u8
 
	m°¨tHue
:1;

198 
u8
 
	mª£rved
:4;

199 } 
	mbôs
;

200 } 
	tz˛_cﬁ‹Lo›SëUpd©eFœgs_t
;

204 
	mCOLOR_LOOP_SET_DEACTION
 = 0x00,

205 
	mCOLOR_LOOP_SET_ACTION_FROM_COLOR_LOOP_START_ENHANCED_HUE
 = 0x01,

206 
	mCOLOR_LOOP_SET_ACTION_FROM_ENHANCED_CURRENT_HUE
 = 0x02,

207 } 
	tz˛_cﬁ‹Lo›SëA˘i⁄_t
;

211 
	mCOLOR_LOOP_SET_DECREMENT
 = 0x00,

212 
	mCOLOR_LOOP_SET_INCREMENT
 = 0x01,

213 } 
	tz˛_cﬁ‹Lo›SëDú_t
;

219 
u8
 
	mhue
;

220 
z˛_cﬁ‹CålDú_t
 
	mdúe˘i⁄
;

221 
u16
 
	må™sôi⁄Time
;

222 
u8
 
	m›tPª£¡
;

223 
u8
 
	m›ti⁄sMask
;

224 
u8
 
	m›ti⁄sOvîride
;

225 } 
	tz˛_cﬁ‹CålMoveToHueCmd_t
;

228 
z˛_cﬁ‹CålMoveMode_t
 
	mmoveMode
;

229 
u8
 
	møã
;

230 
u8
 
	m›tPª£¡
;

231 
u8
 
	m›ti⁄sMask
;

232 
u8
 
	m›ti⁄sOvîride
;

233 } 
	tz˛_cﬁ‹CålMoveHueCmd_t
;

236 
z˛_cﬁ‹CålSãpMode_t
 
	m°ïMode
;

237 
u8
 
	m°ïSize
;

238 
u8
 
	må™sôi⁄Time
;

239 
u8
 
	m›tPª£¡
;

240 
u8
 
	m›ti⁄sMask
;

241 
u8
 
	m›ti⁄sOvîride
;

242 } 
	tz˛_cﬁ‹CålSãpHueCmd_t
;

245 
u8
 
	mßtuøti⁄
;

246 
u16
 
	må™sôi⁄Time
;

247 
u8
 
	m›tPª£¡
;

248 
u8
 
	m›ti⁄sMask
;

249 
u8
 
	m›ti⁄sOvîride
;

250 } 
	tz˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
;

253 
z˛_cﬁ‹CålMoveMode_t
 
	mmoveMode
;

254 
u8
 
	møã
;

255 
u8
 
	m›tPª£¡
;

256 
u8
 
	m›ti⁄sMask
;

257 
u8
 
	m›ti⁄sOvîride
;

258 } 
	tz˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
;

261 
z˛_cﬁ‹CålSãpMode_t
 
	m°ïMode
;

262 
u8
 
	m°ïSize
;

263 
u8
 
	må™sôi⁄Time
;

264 
u8
 
	m›tPª£¡
;

265 
u8
 
	m›ti⁄sMask
;

266 
u8
 
	m›ti⁄sOvîride
;

267 } 
	tz˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
;

270 
u8
 
	mhue
;

271 
u8
 
	mßtuøti⁄
;

272 
u16
 
	må™sôi⁄Time
;

273 
u8
 
	m›tPª£¡
;

274 
u8
 
	m›ti⁄sMask
;

275 
u8
 
	m›ti⁄sOvîride
;

276 } 
	tz˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
;

279 
u16
 
	mcﬁ‹X
;

280 
u16
 
	mcﬁ‹Y
;

281 
u16
 
	må™sôi⁄Time
;

282 
u8
 
	m›tPª£¡
;

283 
u8
 
	m›ti⁄sMask
;

284 
u8
 
	m›ti⁄sOvîride
;

285 } 
	tz˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
;

288 
s16
 
	møãX
;

289 
s16
 
	møãY
;

290 
u8
 
	m›tPª£¡
;

291 
u8
 
	m›ti⁄sMask
;

292 
u8
 
	m›ti⁄sOvîride
;

293 } 
	tz˛_cﬁ‹CålMoveCﬁ‹Cmd_t
;

296 
s16
 
	m°ïX
;

297 
s16
 
	m°ïY
;

298 
u16
 
	må™sôi⁄Time
;

299 
u8
 
	m›tPª£¡
;

300 
u8
 
	m›ti⁄sMask
;

301 
u8
 
	m›ti⁄sOvîride
;

302 } 
	tz˛_cﬁ‹CålSãpCﬁ‹Cmd_t
;

305 
u16
 
	mcﬁ‹Tem≥øtuª
;

306 
u16
 
	må™sôi⁄Time
;

307 
u8
 
	m›tPª£¡
;

308 
u8
 
	m›ti⁄sMask
;

309 
u8
 
	m›ti⁄sOvîride
;

310 } 
	tz˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
;

313 
u16
 
	míh™˚dHue
;

314 
u16
 
	må™sôi⁄Time
;

315 
z˛_cﬁ‹CålDú_t
 
	mdúe˘i⁄
;

316 
u8
 
	m›tPª£¡
;

317 
u8
 
	m›ti⁄sMask
;

318 
u8
 
	m›ti⁄sOvîride
;

319 } 
	tz˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
;

322 
z˛_cﬁ‹CålMoveMode_t
 
	mmoveMode
;

323 
u16
 
	møã
;

324 
u8
 
	m›tPª£¡
;

325 
u8
 
	m›ti⁄sMask
;

326 
u8
 
	m›ti⁄sOvîride
;

327 } 
	tz˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
;

330 
z˛_cﬁ‹CålSãpMode_t
 
	m°ïMode
;

331 
u16
 
	m°ïSize
;

332 
u16
 
	må™sôi⁄Time
;

333 
u8
 
	m›tPª£¡
;

334 
u8
 
	m›ti⁄sMask
;

335 
u8
 
	m›ti⁄sOvîride
;

336 } 
	tz˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
;

339 
u16
 
	míh™˚dHue
;

340 
u16
 
	må™sôi⁄Time
;

341 
u8
 
	mßtuøti⁄
;

342 
u8
 
	m›tPª£¡
;

343 
u8
 
	m›ti⁄sMask
;

344 
u8
 
	m›ti⁄sOvîride
;

345 } 
	tz˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
;

348 
u16
 
	mtime
;

349 
u16
 
	m°¨tHue
;

350 
z˛_cﬁ‹Lo›SëUpd©eFœgs_t
 
	mupd©eFœgs
;

351 
z˛_cﬁ‹Lo›SëA˘i⁄_t
 
	ma˘i⁄
;

352 
z˛_cﬁ‹Lo›SëDú_t
 
	mdúe˘i⁄
;

353 
u8
 
	m›tPª£¡
;

354 
u8
 
	m›ti⁄sMask
;

355 
u8
 
	m›ti⁄sOvîride
;

356 } 
	tz˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
;

359 
u8
 
	m›tPª£¡
;

360 
u8
 
	m›ti⁄sMask
;

361 
u8
 
	m›ti⁄sOvîride
;

362 } 
	tz˛_cﬁ‹CålSt›MoveSãpCmd_t
;

365 
u16
 
	møã
;

366 
u16
 
	mcﬁ‹TempMöMúeds
;

367 
u16
 
	mcﬁ‹TempMaxMúeds
;

368 
z˛_cﬁ‹CålMoveMode_t
 
	mmoveMode
;

369 
u8
 
	m›tPª£¡
;

370 
u8
 
	m›ti⁄sMask
;

371 
u8
 
	m›ti⁄sOvîride
;

372 } 
	tz˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
;

375 
u16
 
	m°ïSize
;

376 
u16
 
	må™sôi⁄Time
;

377 
u16
 
	mcﬁ‹TempMöMúeds
;

378 
u16
 
	mcﬁ‹TempMaxMúeds
;

379 
z˛_cﬁ‹CålSãpMode_t
 
	m°ïMode
;

380 
u8
 
	m›tPª£¡
;

381 
u8
 
	m›ti⁄sMask
;

382 
u8
 
	m›ti⁄sOvîride
;

383 } 
	tz˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
;

386 
z˛_cﬁ‹CålMoveToHueCmd_t
 
	mmoveToHue
;

387 
z˛_cﬁ‹CålMoveHueCmd_t
 
	mmoveHue
;

388 
z˛_cﬁ‹CålSãpHueCmd_t
 
	m°ïHue
;

389 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 
	mmoveToS©uøti⁄
;

390 
z˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
 
	mmoveS©uøti⁄
;

391 
z˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
 
	m°ïS©uøti⁄
;

392 
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 
	mmoveToHueAndS©uøti⁄
;

393 
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 
	mmoveToCﬁ‹
;

394 
z˛_cﬁ‹CålMoveCﬁ‹Cmd_t
 
	mmoveCﬁ‹
;

395 
z˛_cﬁ‹CålSãpCﬁ‹Cmd_t
 
	m°ïCﬁ‹
;

396 
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 
	mmoveToCﬁ‹Tem≥øtuª
;

397 
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 
	míh™˚dMoveToHue
;

398 
z˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
 
	míh™˚dMoveHue
;

399 
z˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
 
	míh™˚dSãpHue
;

400 
z˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
 
	míh™˚dMoveToHueAndS©uøti⁄
;

401 
z˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
 
	mcﬁ‹Lo›Së
;

402 
z˛_cﬁ‹CålSt›MoveSãpCmd_t
 
	m°›MoveSãp
;

403 
z˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
 
	mmoveCﬁ‹Tem≥øtuª
;

404 
z˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
 
	m°ïCﬁ‹Tem≥øtuª
;

405 }
	tz˛_cﬁ‹Cål_cmdPaylﬂd_t
;

413 (*
	tz˛_lightCﬁ‹CålCb_t
)(
	tu8
 
	tcmdId
, 
	tz˛_cﬁ‹Cål_cmdPaylﬂd_t
 *
	tcmdPaylﬂd
);

416 
z˛_lightCﬁ‹CålCb_t
 
lightCﬁ‹CålCbFunc
;

417 } 
	tz˛_lightCﬁ‹Cål_AµCÆlbacks_t
;

422 #ifde‡
ZCL_ATTRID_CURRENT_HUE_ENABLE


423 
u8
 
z˛_©å_cuºítHue
;

425 #ifde‡
ZCL_ATTRID_CURRENT_SATURATION_ENABLE


426 
u8
 
z˛_©å_cuºítS©uøti⁄
;

428 #ifde‡
ZCL_ATTRID_COLOR_MODE_ENABLE


429 
u8
 
z˛_©å_cﬁ‹Mode
;

431 #ifde‡
ZCL_ATTRID_COLOR_OPTIONS_ENABLE


432 
u8
 
z˛_©å_›ti⁄s
;

434 #ifde‡
ZCL_ATTRID_REMAINING_TIME_ENABLE


435 
u16
 
z˛_©å_ªmaöögTime
;

437 #ifde‡
ZCL_ATTRID_CURRENT_X_ENABLE


438 
u16
 
z˛_©å_cuºítX
;

440 #ifde‡
ZCL_ATTRID_CURRENT_Y_ENABLE


441 
u16
 
z˛_©å_cuºítY
;

443 #ifde‡
ZCL_ATTRID_DRIFT_COMPENSATION_ENABLE


444 
u8
 
z˛_©å_dri·Comíßti⁄
;

446 #ifde‡
ZCL_ATTRID_COMPENSATION_TEXT_ENABLE


447 
u8
* 
z˛_©å_com≥nßti⁄Text
;

449 #ifde‡
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS_ENABLE


450 
u16
 
z˛_©å_cﬁ‹Tem≥øtuªMúeds
;

452 #ifde‡
ZCL_ATTRID_ENHANCED_CURRENT_HUE_ENABLE


453 
u16
 
z˛_©å_íh™˚dCuºítHue
;

455 #ifde‡
ZCL_ATTRID_ENHANCED_COLOR_MODE_ENABLE


456 
u8
 
z˛_©å_íh™˚dCﬁ‹Mode
;

458 #ifde‡
ZCL_ATTRID_COLOR_LOOP_ACTIVE_ENABLE


459 
u8
 
z˛_©å_cﬁ‹Lo›A˘ive
;

461 #ifde‡
ZCL_ATTRID_COLOR_LOOP_DIRECTION_ENABLE


462 
u8
 
z˛_©å_cﬁ‹Lo›Dúe˘i⁄
;

464 #ifde‡
ZCL_ATTRID_COLOR_LOOP_TIME_ENABLE


465 
u16
 
z˛_©å_cﬁ‹Lo›Time
;

467 #ifde‡
ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE_ENABLE


468 
u16
 
z˛_©å_cﬁ‹Lo›SèπEnh™˚dHue
;

470 #ifde‡
ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE_ENABLE


471 
u16
 
z˛_©å_cﬁ‹Lo›St‹edEnh™˚dHue
;

473 #ifde‡
ZCL_ATTRID_COLOR_CAPABILITIES_ENABLE


474 
u16
 
z˛_©å_cﬁ‹C≠abûôõs
;

476 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS_ENABLE


477 
u16
 
z˛_©å_cﬁ‹TempPhysiˇlMöMúeds
;

479 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS_ENABLE


480 
u16
 
z˛_©å_cﬁ‹TempPhysiˇlMaxMúeds
;

482 #ifde‡
ZCL_ATTRID_COUPLE_COLOR_TEMP_TO_LEVEL_MIN_MIREDS_ENABLE


483 
u16
 
z˛_©å_cou∂eCﬁ‹TempToLevñMöMúeds
;

485 #ifde‡
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS_ENABLE


486 
u16
 
z˛_©å_°¨tUpCﬁ‹Tem≥øtuªMúeds
;

489 #ifde‡
ZCL_ATTRID_NUMBER_OF_PRIMARIES_ENABLE


490 
u8
 
z˛_©å_numOÂrim¨õs
;

492 #ifde‡
ZCL_ATTRID_PRIMARY1_X_ENABLE


493 
u16
 
z˛_©å_¥im¨y1X
;

495 #ifde‡
ZCL_ATTRID_PRIMARY1_Y_ENABLE


496 
u16
 
z˛_©å_¥im¨y1Y
;

498 #ifde‡
ZCL_ATTRID_PRIMARY1_INTENSITY_ENABLE


499 
u8
 
z˛_©å_¥im¨y1I¡ísôy
;

501 #ifde‡
ZCL_ATTRID_PRIMARY2_X_ENABLE


502 
u16
 
z˛_©å_¥im¨y2X
;

504 #ifde‡
ZCL_ATTRID_PRIMARY2_Y_ENABLE


505 
u16
 
z˛_©å_¥im¨y2Y
;

507 #ifde‡
ZCL_ATTRID_PRIMARY2_INTENSITY_ENABLE


508 
u8
 
z˛_©å_¥im¨y2I¡ísôy
;

510 #ifde‡
ZCL_ATTRID_PRIMARY3_X_ENABLE


511 
u16
 
z˛_©å_¥im¨y3X
;

513 #ifde‡
ZCL_ATTRID_PRIMARY3_Y_ENABLE


514 
u16
 
z˛_©å_¥im¨y3Y
;

516 #ifde‡
ZCL_ATTRID_PRIMARY3_INTENSITY_ENABLE


517 
u8
 
z˛_©å_¥im¨y3I¡ísôy
;

519 #ifde‡
ZCL_ATTRID_PRIMARY4_X_ENABLE


520 
u16
 
z˛_©å_¥im¨y4X
;

522 #ifde‡
ZCL_ATTRID_PRIMARY4_Y_ENABLE


523 
u16
 
z˛_©å_¥im¨y4Y
;

525 #ifde‡
ZCL_ATTRID_PRIMARY4_INTENSITY_ENABLE


526 
u8
 
z˛_©å_¥im¨y4I¡ísôy
;

528 #ifde‡
ZCL_ATTRID_PRIMARY5_X_ENABLE


529 
u16
 
z˛_©å_¥im¨y5X
;

531 #ifde‡
ZCL_ATTRID_PRIMARY5_Y_ENABLE


532 
u16
 
z˛_©å_¥im¨y5Y
;

534 #ifde‡
ZCL_ATTRID_PRIMARY5_INTENSITY_ENABLE


535 
u8
 
z˛_©å_¥im¨y5I¡ísôy
;

537 #ifde‡
ZCL_ATTRID_PRIMARY6_X_ENABLE


538 
u16
 
z˛_©å_¥im¨y6X
;

540 #ifde‡
ZCL_ATTRID_PRIMARY6_Y_ENABLE


541 
u16
 
z˛_©å_¥im¨y6Y
;

543 #ifde‡
ZCL_ATTRID_PRIMARY6_INTENSITY_ENABLE


544 
u8
 
z˛_©å_¥im¨y6I¡ísôy
;

547 #ifde‡
ZCL_ATTRID_WHITE_POINT_X_ENABLE


548 
u16
 
z˛_©å_whôePoötX
;

550 #ifde‡
ZCL_ATTRID_WHITE_POINT_Y_ENABLE


551 
u16
 
z˛_©å_whôePoötY
;

553 #ifde‡
ZCL_ATTRID_COLOR_POINT_RX_ENABLE


554 
u16
 
z˛_©å_cﬁ‹PoötRX
;

556 #ifde‡
ZCL_ATTRID_COLOR_POINT_RY_ENABLE


557 
u16
 
z˛_©å_cﬁ‹PoötRY
;

559 #ifde‡
ZCL_ATTRID_COLOR_POINT_RINTENSITY_ENABLE


560 
u8
 
z˛_©å_cﬁ‹PoötRI¡ísôy
;

562 #ifde‡
ZCL_ATTRID_COLOR_POINT_GX_ENABLE


563 
u16
 
z˛_©å_cﬁ‹PoötGX
;

565 #ifde‡
ZCL_ATTRID_COLOR_POINT_GY_ENABLE


566 
u16
 
z˛_©å_cﬁ‹PoötGY
;

568 #ifde‡
ZCL_ATTRID_COLOR_POINT_GINTENSITY_ENABLE


569 
u8
 
z˛_©å_cﬁ‹PoötGI¡ísôy
;

571 #ifde‡
ZCL_ATTRID_COLOR_POINT_BX_ENABLE


572 
u16
 
z˛_©å_cﬁ‹PoötBX
;

574 #ifde‡
ZCL_ATTRID_COLOR_POINT_BY_ENABLE


575 
u16
 
z˛_©å_cﬁ‹PoötBY
;

577 #ifde‡
ZCL_ATTRID_COLOR_POINT_BINTENSITY_ENABLE


578 
u8
 
z˛_©å_cﬁ‹PoötBI¡ísôy
;

580 } 
	tz˛_lightCﬁ‹CålAâr_t
;

583 
z˛_lightCﬁ‹CålAâr_t
 
z˛_©å_lightCﬁ‹Cål
;

584 c⁄° 
z˛AârInfo_t
 
lightCﬁ‹Cål_©åTbl
[];

585 c⁄° 
u8
 
z˛_lightCﬁ‹Cål_©åNum
;

587 
	#z˛_cﬁ‹AârGë
(Ë&
z˛_©å_lightCﬁ‹Cål


	)

591 
°©us_t
 
	`z˛_lightCﬁ‹Cål_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

593 
°©us_t
 
	`z˛_lightCﬁ‹Cål_move2hue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToHueCmd_t
 *
pMove2Hue
);

594 
	#z˛_lightCﬁ‹Cål_move2hueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_move2hue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

596 
°©us_t
 
	`z˛_lightCﬁ‹Cål_moveHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveHueCmd_t
 *
pMoveHue
);

597 
	#z˛_lightCﬁ‹Cål_moveHueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_moveHue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

599 
°©us_t
 
	`z˛_lightCﬁ‹Cål_°ïHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpHueCmd_t
 *
pSãpHue
);

600 
	#z˛_lightCﬁ‹Cål_°ïHueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_°ïHue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

602 
°©us_t
 
	`z˛_lightCﬁ‹Cål_move2ßtuøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToS©uøti⁄Cmd_t
 *
pMove2S©
);

603 
	#z˛_lightCﬁ‹Cål_move2ßtuøti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_move2ßtuøti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

605 
°©us_t
 
	`z˛_lightCﬁ‹Cål_moveS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveS©uøti⁄Cmd_t
 *
pMoveS©
);

606 
	#z˛_lightCﬁ‹Cål_moveS©uøti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_moveS©uøti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

608 
°©us_t
 
	`z˛_lightCﬁ‹Cål_°ïS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpS©uøti⁄Cmd_t
 *
pSãpS©
);

609 
	#z˛_lightCﬁ‹Cål_°ïS©uøti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_°ïS©uøti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

611 
°©us_t
 
	`z˛_lightCﬁ‹Cål_move2hueAndS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToHueAndS©uøti⁄Cmd_t
 *
pMove2HueAndS©
);

612 
	#z˛_lightCﬁ‹Cål_move2hueAndS©uøti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_move2hueAndS©uøti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

614 
°©us_t
 
	`z˛_lightCﬁ‹Cål_move2cﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToCﬁ‹Cmd_t
 *
pMove2Cﬁ‹
);

615 
	#z˛_lightCﬁ‹Cål_move2cﬁ‹Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_move2cﬁ‹
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

617 
°©us_t
 
	`z˛_lightCﬁ‹Cål_moveCﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveCﬁ‹Cmd_t
 *
pMoveCﬁ‹
);

618 
	#z˛_lightCﬁ‹Cål_moveCﬁ‹Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_moveCﬁ‹
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

620 
°©us_t
 
	`z˛_lightCﬁ‹Cål_°ïCﬁ‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpCﬁ‹Cmd_t
 *
pSãpCﬁ‹
);

621 
	#z˛_lightCﬁ‹Cål_°ïCﬁ‹Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_°ïCﬁ‹
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

623 
°©us_t
 
	`z˛_lightCﬁ‹Cål_move2cﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveToCﬁ‹Tem≥øtuªCmd_t
 *
pMove2Cﬁ‹Temp
);

624 
	#z˛_lightCﬁ‹Cål_move2cﬁ‹Tem≥øtuªCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_move2cﬁ‹Tem≥øtuª
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

626 
°©us_t
 
	`z˛_lightCﬁ‹Cål_íh™˚dMove2Hue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveToHueCmd_t
 *
pEnh™˚dMove2Hue
);

627 
	#z˛_lightCﬁ‹Cål_íh™˚dMove2hueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_íh™˚dMove2hue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

629 
°©us_t
 
	`z˛_lightCﬁ‹Cål_íh™˚dMoveHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveHueCmd_t
 *
pEnh™˚dMoveHue
);

630 
	#z˛_lightCﬁ‹Cål_íh™˚dMoveHueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_íh™˚dMoveHue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

632 
°©us_t
 
	`z˛_lightCﬁ‹Cål_íh™˚dSãpHue
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dSãpHueCmd_t
 *
pEnh™˚dSãpHue
);

633 
	#z˛_lightCﬁ‹Cål_íh™˚dSãpHueCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_íh™˚dSãpHue
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

635 
°©us_t
 
	`z˛_lightCﬁ‹Cål_íh™˚dMove2HueAndS©uøti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålEnh™˚dMoveToHueAndS©uøti⁄Cmd_t
 *
pEnh™˚dMove2HueAndS©
);

636 
	#z˛_lightCﬁ‹Cål_íh™˚dMove2HueAndS©uøti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_íh™˚dMove2HueAndS©uøti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

638 
°©us_t
 
	`z˛_lightCﬁ‹Cål_cﬁ‹Lo›Së
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålCﬁ‹Lo›SëCmd_t
 *
pCﬁ‹Lo›Së
);

639 
	#z˛_lightCﬁ‹Cål_cﬁ‹Lo›SëCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_cﬁ‹Lo›Së
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

641 
°©us_t
 
	`z˛_lightCﬁ‹Cål_°›MoveSãp
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSt›MoveSãpCmd_t
 *
pSt›MoveSãp
);

642 
	#z˛_lightCﬁ‹Cål_°›MoveSãpCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_°›MoveSãp
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

644 
°©us_t
 
	`z˛_lightCﬁ‹Cål_moveCﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålMoveCﬁ‹Tem≥øtuªCmd_t
 *
pMoveCﬁ‹Temp
);

645 
	#z˛_lightCﬁ‹Cål_moveCﬁ‹Tem≥øtuªCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_moveCﬁ‹Tem≥øtuª
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

647 
°©us_t
 
	`z˛_lightCﬁ‹Cål_°ïCﬁ‹Tem≥øtuª
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_cﬁ‹CålSãpCﬁ‹Tem≥øtuªCmd_t
 *
pSãpCﬁ‹Temp
);

648 
	#z˛_lightCﬁ‹Cål_°ïCﬁ‹Tem≥øtuªCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_lightCﬁ‹Cål_°ïCﬁ‹Tem≥øtuª
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/light_color_control/zcl_light_colorCtrl_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

47 #ifde‡
ZCL_LIGHT_COLOR_CONTROL


49 
z˛_lightCﬁ‹CålAâr_t
 
	gz˛_©å_lightCﬁ‹Cål
 = {

50 #ifde‡
ZCL_ATTRID_CURRENT_HUE_ENABLE


51 .
z˛_©å_cuºítHue
 = 0,

53 #ifde‡
ZCL_ATTRID_CURRENT_SATURATION_ENABLE


54 .
	gz˛_©å_cuºítS©uøti⁄
 = 0,

56 #ifde‡
ZCL_ATTRID_REMAINING_TIME_ENABLE


57 .
	gz˛_©å_ªmaöögTime
 = 0,

59 #ifde‡
ZCL_ATTRID_CURRENT_X_ENABLE


60 .
	gz˛_©å_cuºítX
 = 0x616B,

62 #ifde‡
ZCL_ATTRID_CURRENT_Y_ENABLE


63 .
	gz˛_©å_cuºítY
 = 0x607D,

65 #ifde‡
ZCL_ATTRID_DRIFT_COMPENSATION_ENABLE


66 .
	gz˛_©å_dri·Comíßti⁄
 = 0,

68 #ifde‡
ZCL_ATTRID_COMPENSATION_TEXT_ENABLE


69 .
	gz˛_©å_com≥nßti⁄Text
 = 
NULL
,

71 #ifde‡
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS_ENABLE


72 .
	gz˛_©å_cﬁ‹Tem≥øtuªMúeds
 = 0x00FA,

74 #ifde‡
ZCL_ATTRID_COLOR_MODE_ENABLE


75 .
	gz˛_©å_cﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
,

77 #ifde‡
ZCL_ATTRID_COLOR_OPTIONS_ENABLE


78 .
	gz˛_©å_›ti⁄s
 = 0,

80 #ifde‡
ZCL_ATTRID_ENHANCED_CURRENT_HUE_ENABLE


81 .
	gz˛_©å_íh™˚dCuºítHue
 = 0,

83 #ifde‡
ZCL_ATTRID_ENHANCED_COLOR_MODE_ENABLE


84 .
	gz˛_©å_íh™˚dCﬁ‹Mode
 = 
ZCL_COLOR_MODE_CURRENT_X_Y
,

86 #ifde‡
ZCL_ATTRID_COLOR_LOOP_ACTIVE_ENABLE


87 .
	gz˛_©å_cﬁ‹Lo›A˘ive
 = 0,

89 #ifde‡
ZCL_ATTRID_COLOR_LOOP_DIRECTION_ENABLE


90 .
	gz˛_©å_cﬁ‹Lo›Dúe˘i⁄
 = 0,

92 #ifde‡
ZCL_ATTRID_COLOR_LOOP_TIME_ENABLE


93 .
	gz˛_©å_cﬁ‹Lo›Time
 = 0x0019,

95 #ifde‡
ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE_ENABLE


96 .
	gz˛_©å_cﬁ‹Lo›SèπEnh™˚dHue
 = 0x2300,

98 #ifde‡
ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE_ENABLE


99 .
	gz˛_©å_cﬁ‹Lo›St‹edEnh™˚dHue
 = 0,

101 #ifde‡
ZCL_ATTRID_COLOR_CAPABILITIES_ENABLE


102 .
	gz˛_©å_cﬁ‹C≠abûôõs
 = 0,

104 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS_ENABLE


105 .
	gz˛_©å_cﬁ‹TempPhysiˇlMöMúeds
 = 0,

107 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS_ENABLE


108 .
	gz˛_©å_cﬁ‹TempPhysiˇlMaxMúeds
 = 0xFEFF,

110 #ifde‡
ZCL_ATTRID_COUPLE_COLOR_TEMP_TO_LEVEL_MIN_MIREDS_ENABLE


111 .
	gz˛_©å_cou∂eCﬁ‹TempToLevñMöMúeds
 = 0x0001,

113 #ifde‡
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS_ENABLE


114 .
	gz˛_©å_°¨tUpCﬁ‹Tem≥øtuªMúeds
 = 
ZCL_START_UP_COLOR_TEMPERATURE_MIREDS_TO_PREVIOUS
,

119 c⁄° 
z˛AârInfo_t
 
	glightCﬁ‹Cål_©åTbl
[] =

122 #ifde‡
ZCL_ATTRID_CURRENT_HUE_ENABLE


123 { 
ZCL_ATTRID_CURRENT_HUE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cuºítHue
 },

125 #ifde‡
ZCL_ATTRID_CURRENT_SATURATION_ENABLE


126 { 
ZCL_ATTRID_CURRENT_SATURATION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cuºítS©uøti⁄
 },

128 #ifde‡
ZCL_ATTRID_REMAINING_TIME_ENABLE


129 { 
ZCL_ATTRID_REMAINING_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_ªmaöögTime
 },

131 #ifde‡
ZCL_ATTRID_CURRENT_X_ENABLE


132 { 
ZCL_ATTRID_CURRENT_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cuºítX
 },

134 #ifde‡
ZCL_ATTRID_CURRENT_Y_ENABLE


135 { 
ZCL_ATTRID_CURRENT_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cuºítY
 },

137 #ifde‡
ZCL_ATTRID_DRIFT_COMPENSATION_ENABLE


138 { 
ZCL_ATTRID_DRIFT_COMPENSATION
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_dri·Comíßti⁄
 },

140 #ifde‡
ZCL_ATTRID_COMPENSATION_TEXT_ENABLE


141 { 
ZCL_ATTRID_COMPENSATION_TEXT
, 
ZCL_DATA_TYPE_CHAR_STR
, 
ACCESS_CONTROL_READ
, (
u8
*Ë
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_com≥nßti⁄Text
 },

143 #ifde‡
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS_ENABLE


144 { 
ZCL_ATTRID_COLOR_TEMPERATURE_MIREDS
,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Tem≥øtuªMúeds
 },

146 #ifde‡
ZCL_ATTRID_COLOR_MODE_ENABLE


147 { 
ZCL_ATTRID_COLOR_MODE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Mode
 },

149 #ifde‡
ZCL_ATTRID_COLOR_OPTIONS_ENABLE


150 { 
ZCL_ATTRID_COLOR_OPTIONS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_›ti⁄s
 },

152 #ifde‡
ZCL_ATTRID_ENHANCED_CURRENT_HUE_ENABLE


153 { 
ZCL_ATTRID_ENHANCED_CURRENT_HUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_íh™˚dCuºítHue
 },

155 #ifde‡
ZCL_ATTRID_ENHANCED_COLOR_MODE_ENABLE


156 { 
ZCL_ATTRID_ENHANCED_COLOR_MODE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_íh™˚dCﬁ‹Mode
 },

158 #ifde‡
ZCL_ATTRID_COLOR_LOOP_ACTIVE_ENABLE


159 { 
ZCL_ATTRID_COLOR_LOOP_ACTIVE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Lo›A˘ive
 },

161 #ifde‡
ZCL_ATTRID_COLOR_LOOP_DIRECTION_ENABLE


162 { 
ZCL_ATTRID_COLOR_LOOP_DIRECTION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Lo›Dúe˘i⁄
 },

164 #ifde‡
ZCL_ATTRID_COLOR_LOOP_TIME_ENABLE


165 { 
ZCL_ATTRID_COLOR_LOOP_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Lo›Time
 },

167 #ifde‡
ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE_ENABLE


168 { 
ZCL_ATTRID_COLOR_LOOP_START_ENHANCED_HUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Lo›SèπEnh™˚dHue
 },

170 #ifde‡
ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE_ENABLE


171 { 
ZCL_ATTRID_COLOR_LOOP_STORED_ENHANCED_HUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹Lo›St‹edEnh™˚dHue
 },

173 #ifde‡
ZCL_ATTRID_COLOR_CAPABILITIES_ENABLE


174 { 
ZCL_ATTRID_COLOR_CAPABILITIES
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹C≠abûôõs
 },

176 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS_ENABLE


177 { 
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MIN_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹TempPhysiˇlMöMúeds
 },

179 #ifde‡
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS_ENABLE


180 { 
ZCL_ATTRID_COLOR_TEMP_PHYSICAL_MAX_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹TempPhysiˇlMaxMúeds
 },

182 #ifde‡
ZCL_ATTRID_COUPLE_COLOR_TEMP_TO_LEVEL_MIN_MIREDS_ENABLE


183 { 
ZCL_ATTRID_COUPLE_COLOR_TEMP_TO_LEVEL_MIN_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cou∂eCﬁ‹TempToLevñMöMúeds
 },

185 #ifde‡
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS_ENABLE


186 { 
ZCL_ATTRID_START_UP_COLOR_TEMPERATURE_MIREDS
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_°¨tUpCﬁ‹Tem≥øtuªMúeds
 },

189 #ifde‡
ZCL_ATTRID_NUMBER_OF_PRIMARIES_ENABLE


190 { 
ZCL_ATTRID_NUMBER_OF_PRIMARIES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_numOÂrim¨õs
 },

192 #ifde‡
ZCL_ATTRID_PRIMARY1_X_ENABLE


193 { 
ZCL_ATTRID_PRIMARY1_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y1X
 },

195 #ifde‡
ZCL_ATTRID_PRIMARY1_Y_ENABLE


196 { 
ZCL_ATTRID_PRIMARY1_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y1Y
 },

198 #ifde‡
ZCL_ATTRID_PRIMARY1_INTENSITY_ENABLE


199 { 
ZCL_ATTRID_PRIMARY1_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y1I¡ísôy
 },

201 #ifde‡
ZCL_ATTRID_PRIMARY2_X_ENABLE


202 { 
ZCL_ATTRID_PRIMARY2_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y2X
 },

204 #ifde‡
ZCL_ATTRID_PRIMARY2_Y_ENABLE


205 { 
ZCL_ATTRID_PRIMARY2_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y2Y
 },

207 #ifde‡
ZCL_ATTRID_PRIMARY2_INTENSITY_ENABLE


208 { 
ZCL_ATTRID_PRIMARY2_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y2I¡ísôy
 },

210 #ifde‡
ZCL_ATTRID_PRIMARY3_X_ENABLE


211 { 
ZCL_ATTRID_PRIMARY3_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y3X
 },

213 #ifde‡
ZCL_ATTRID_PRIMARY3_Y_ENABLE


214 { 
ZCL_ATTRID_PRIMARY3_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y3Y
 },

216 #ifde‡
ZCL_ATTRID_PRIMARY3_INTENSITY_ENABLE


217 { 
ZCL_ATTRID_PRIMARY3_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y3I¡ísôy
 },

220 #ifde‡
ZCL_ATTRID_PRIMARY4_X_ENABLE


221 { 
ZCL_ATTRID_PRIMARY4_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y4X
 },

223 #ifde‡
ZCL_ATTRID_PRIMARY4_Y_ENABLE


224 { 
ZCL_ATTRID_PRIMARY4_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y4Y
 },

226 #ifde‡
ZCL_ATTRID_PRIMARY4_INTENSITY_ENABLE


227 { 
ZCL_ATTRID_PRIMARY4_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y4I¡ísôy
 },

229 #ifde‡
ZCL_ATTRID_PRIMARY5_X_ENABLE


230 { 
ZCL_ATTRID_PRIMARY5_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y5X
 },

232 #ifde‡
ZCL_ATTRID_PRIMARY5_Y_ENABLE


233 { 
ZCL_ATTRID_PRIMARY5_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y5Y
 },

235 #ifde‡
ZCL_ATTRID_PRIMARY5_INTENSITY_ENABLE


236 { 
ZCL_ATTRID_PRIMARY5_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y5I¡ísôy
 },

238 #ifde‡
ZCL_ATTRID_PRIMARY6_X_ENABLE


239 { 
ZCL_ATTRID_PRIMARY6_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y6X
 },

241 #ifde‡
ZCL_ATTRID_PRIMARY6_Y_ENABLE


242 { 
ZCL_ATTRID_PRIMARY6_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y6Y
 },

244 #ifde‡
ZCL_ATTRID_PRIMARY6_INTENSITY_ENABLE


245 { 
ZCL_ATTRID_PRIMARY6_INTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_¥im¨y6I¡ísôy
 },

248 #ifde‡
ZCL_ATTRID_WHITE_POINT_X_ENABLE


249 { 
ZCL_ATTRID_WHITE_POINT_X
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_whôePoötX
 },

251 #ifde‡
ZCL_ATTRID_WHITE_POINT_Y_ENABLE


252 { 
ZCL_ATTRID_WHITE_POINT_Y
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_whôePoötY
 },

254 #ifde‡
ZCL_ATTRID_COLOR_POINT_RX_ENABLE


255 { 
ZCL_ATTRID_COLOR_POINT_RX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötRX
 },

257 #ifde‡
ZCL_ATTRID_COLOR_POINT_RY_ENABLE


258 { 
ZCL_ATTRID_COLOR_POINT_RY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötRY
 },

260 #ifde‡
ZCL_ATTRID_COLOR_POINT_RINTENSITY_ENABLE


261 { 
ZCL_ATTRID_COLOR_POINT_RINTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötRI¡ísôy
 },

263 #ifde‡
ZCL_ATTRID_COLOR_POINT_GX_ENABLE


264 { 
ZCL_ATTRID_COLOR_POINT_GX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötGX
 },

266 #ifde‡
ZCL_ATTRID_COLOR_POINT_GY_ENABLE


267 { 
ZCL_ATTRID_COLOR_POINT_GY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötGY
 },

269 #ifde‡
ZCL_ATTRID_COLOR_POINT_GINTENSITY_ENABLE


270 { 
ZCL_ATTRID_COLOR_POINT_GINTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötGI¡ísôy
 },

272 #ifde‡
ZCL_ATTRID_COLOR_POINT_BX_ENABLE


273 { 
ZCL_ATTRID_COLOR_POINT_BX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötBX
 },

275 #ifde‡
ZCL_ATTRID_COLOR_POINT_BY_ENABLE


276 { 
ZCL_ATTRID_COLOR_POINT_BY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötBY
 },

278 #ifde‡
ZCL_ATTRID_COLOR_POINT_BINTENSITY_ENABLE


279 { 
ZCL_ATTRID_COLOR_POINT_BINTENSITY
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
|
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_lightCﬁ‹Cål
.
z˛_©å_cﬁ‹PoötBI¡ísôy
 },

281 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

284 c⁄° 
u8
 
	gz˛_lightCﬁ‹Cål_©åNum
 = ( (
lightCﬁ‹Cål_©åTbl
Ë/ (
z˛AârInfo_t
) );

286 
nv_°s_t
 
	$z˛_cﬁ‹Cål_ßveAâr
()

288  
	`z˛_©å_cﬁ‹CålP¨ams_ßve
();

289 
	}
}

291 
nv_°s_t
 
	$z˛_cﬁ‹Cål_lﬂdAâr
()

293  
	`z˛_©å_cﬁ‹CålP¨ams_ª°‹e
();

294 
	}
}

	@zigbee/zcl/measument_sensing/zcl_electrical_measurement.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_ELECTRICAL_MEASUREMENT


49 
°©us_t
 
z˛_ñe˘riˇlMósuª_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_ñe˘riˇlMósuª_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëProfûeInfo
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

60  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
, 
ZCL_CMD_GET_PROFILE_INFO
, 
TRUE
,

61 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

62 
	}
}

64 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëMósuªmítProfûe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd_t
 *
pReq
)

66 
u8
 
buf
[7];

67 
u8
 *
pBuf
 = 
buf
;

69 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
©åID
);

70 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
©åID
);

71 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
°¨tTime
);

72 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
°¨tTime
);

73 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
°¨tTime
);

74 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
°¨tTime
);

75 *
pBuf
++ = 
pReq
->
numbîOfI¡îvÆs
;

77  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
, 
ZCL_CMD_GET_MEASUREMENT_PROFILE
, 
TRUE
,

78 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

79 
	}
}

81 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëProfûeInfoR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd_t
 *
pR•
)

83 
u8
 
Àn
 = 1 + 1 + 1 + 
pR•
->
maxNumbîOfI¡îvÆs
 * 2;

85 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

86 if(!
buf
){

87  
ZCL_STA_INSUFFICIENT_SPACE
;

90 
u8
 *
pBuf
 = 
buf
;

92 *
pBuf
++ = 
pR•
->
¥ofûeC¡
;

93 *
pBuf
++ = 
pR•
->
¥ofûeI¡îvÆPîiod
;

94 *
pBuf
++ = 
pR•
->
maxNumbîOfI¡îvÆs
;

95 if(
pR•
->
maxNumbîOfI¡îvÆs
){

96 
	`mem˝y
(
pBuf
, 
pR•
->
li°OfAâribuãs
,ÖR•->
maxNumbîOfI¡îvÆs
 * 2);

97 
pBuf
 +
pR•
->
maxNumbîOfI¡îvÆs
 * 2;

100 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
, 
ZCL_CMD_GET_PROFILE_INFO_RESPONSE
, 
TRUE
,

101 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

103 
	`ev_buf_‰ì
(
buf
);

105  
ZCL_STA_SUCCESS
;

106 
	}
}

108 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd_t
 *
pR•
)

110 
u8
 
Àn
 = 4 + 1 + 1 + 1 + 1 + 
pR•
->
numbîOfI¡îvÆs
 * 2;

112 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

113 if(!
buf
){

114  
ZCL_STA_INSUFFICIENT_SPACE
;

117 
u8
 *
pBuf
 = 
buf
;

119 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
°¨tTime
);

120 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
°¨tTime
);

121 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
°¨tTime
);

122 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
°¨tTime
);

123 *
pBuf
++ = 
pR•
->
°©us
;

124 *
pBuf
++ = 
pR•
->
¥ofûeI¡îvÆPîiod
;

125 *
pBuf
++ = 
pR•
->
numbîOfI¡îvÆs
;

126 *
pBuf
++ = 
pR•
->
©åibuãId
;

127 if(
pR•
->
numbîOfI¡îvÆs
){

128 
	`mem˝y
(
pBuf
, 
pR•
->
öãrvÆs
,ÖR•->
numbîOfI¡îvÆs
 * 2);

129 
pBuf
 +
pR•
->
numbîOfI¡îvÆs
 * 2;

132 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
, 
ZCL_CMD_GET_MEASUREMENT_PROFILE_RESPONSE
, 
TRUE
,

133 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

135 
	`ev_buf_‰ì
(
buf
);

137  
ZCL_STA_SUCCESS
;

138 
	}
}

141 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëProfûeInfoPrc
(
z˛Incomög_t
 *
pInMsg
)

143 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

146 if(
pInMsg
->
˛u°îAµCb
){

147 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

149 
°©us
 = 
ZCL_STA_FAILURE
;

152  
°©us
;

153 
	}
}

155 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëMósuªmítProfûePrc
(
z˛Incomög_t
 *
pInMsg
)

157 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

159 
u8
 *
pD©a
 = 
pInMsg
->pData;

161 if(
pInMsg
->
˛u°îAµCb
){

162 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd_t
 
gëMósuªmítProfûeCmd
;

163 
gëMósuªmítProfûeCmd
.
©åID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

164 
pD©a
 += 2;

165 
gëMósuªmítProfûeCmd
.
°¨tTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

166 
pD©a
 += 4;

167 
gëMósuªmítProfûeCmd
.
numbîOfI¡îvÆs
 = *
pD©a
++;

169 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëMósuªmítProfûeCmd
);

171 
°©us
 = 
ZCL_STA_FAILURE
;

174  
°©us
;

175 
	}
}

177 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Prc
(
z˛Incomög_t
 *
pInMsg
)

179 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

181 
u8
 *
pD©a
 = 
pInMsg
->pData;

183 if(
pInMsg
->
˛u°îAµCb
){

184 
z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd_t
 
gëProfûeInfoR•Cmd
;

185 
gëProfûeInfoR•Cmd
.
¥ofûeC¡
 = *
pD©a
++;

186 
gëProfûeInfoR•Cmd
.
¥ofûeI¡îvÆPîiod
 = *
pD©a
++;

187 
gëProfûeInfoR•Cmd
.
maxNumbîOfI¡îvÆs
 = *
pD©a
++;

188 
gëProfûeInfoR•Cmd
.
li°OfAâribuãs
 = 
pD©a
;

190 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëProfûeInfoR•Cmd
);

192 
°©us
 = 
ZCL_STA_FAILURE
;

195  
°©us
;

196 
	}
}

198 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Prc
(
z˛Incomög_t
 *
pInMsg
)

200 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

202 
u8
 *
pD©a
 = 
pInMsg
->pData;

204 if(
pInMsg
->
˛u°îAµCb
){

205 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd_t
 
gëMósuªmítProfûeR•Cmd
;

206 
gëMósuªmítProfûeR•Cmd
.
°¨tTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

207 
pD©a
 += 4;

208 
gëMósuªmítProfûeR•Cmd
.
°©us
 = *
pD©a
++;

209 
gëMósuªmítProfûeR•Cmd
.
¥ofûeI¡îvÆPîiod
 = *
pD©a
++;

210 
gëMósuªmítProfûeR•Cmd
.
numbîOfI¡îvÆs
 = *
pD©a
++;

211 
gëMósuªmítProfûeR•Cmd
.
©åibuãId
 = *
pD©a
++;

212 
gëMósuªmítProfûeR•Cmd
.
öãrvÆs
 = 
pD©a
;

214 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëMósuªmítProfûeR•Cmd
);

216 
°©us
 = 
ZCL_STA_FAILURE
;

219  
°©us
;

220 
	}
}

222 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

224 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

226 
pInMsg
->
hdr
.
cmd
){

227 
ZCL_CMD_GET_PROFILE_INFO
:

228 
°©us
 = 
	`z˛_ñe˘riˇlMósuª_gëProfûeInfoPrc
(
pInMsg
);

230 
ZCL_CMD_GET_MEASUREMENT_PROFILE
:

231 
°©us
 = 
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûePrc
(
pInMsg
);

234 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

238  
°©us
;

239 
	}
}

241 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

243 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

245 
pInMsg
->
hdr
.
cmd
){

246 
ZCL_CMD_GET_PROFILE_INFO_RESPONSE
:

247 
°©us
 = 
	`z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Prc
(
pInMsg
);

249 
ZCL_CMD_GET_MEASUREMENT_PROFILE_RESPONSE
:

250 
°©us
 = 
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Prc
(
pInMsg
);

253 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

257  
°©us
;

258 
	}
}

260 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ñe˘riˇlMósuª_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

262 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

263  
	`z˛_ñe˘riˇlMósuª_˛õ¡CmdH™dÀr
(
pInMsg
);

265  
	`z˛_ñe˘riˇlMósuª_£rvîCmdH™dÀr
(
pInMsg
);

267 
	}
}

	@zigbee/zcl/measument_sensing/zcl_electrical_measurement.h

24 #i‚de‡
ZCL_ELECTRICAL_MEASUREMENT_H


25 
	#ZCL_ELECTRICAL_MEASUREMENT_H


	)

35 
	#BASIC_INFORMATION
 0x00

	)

36 
	#DC_MEASUREMENT
 0x01

	)

37 
	#DC_FORMATTING
 0x02

	)

38 
	#AC_NON_PHASE_SPEC_MEASUREMENTS
 0x03

	)

39 
	#AC_NON_PHASE_SPEC_FORMATTING
 0x04

	)

40 
	#AC_SINGLE_PHASE_0R_PHASE_A_MEASUREMENTS
 0x05

	)

41 
	#AC_FORMATTING
 0x06

	)

42 
	#DC_MAUFACTURER_THRESHOLD_ALARMS
 0x07

	)

43 
	#AC_MAUFACTURER_THRESHOLD_ALARMS
 0x08

	)

44 
	#AC_PHASE_B_MEASUREMENTS
 0x09

	)

45 
	#AC_PHASE_C_MEASUREMENTS
 0x0A

	)

51 
	#ZCL_ATTRID_MEASUREMENT_TYPE
 0x0000

	)

53 
	#ZCL_ATTRID_DC_VOLTAGE
 0x0100

	)

54 
	#ZCL_ATTRID_DC_VOLTAGE_MIN
 0x0101

	)

55 
	#ZCL_ATTRID_DC_VOLTAGE_MAX
 0x0102

	)

56 
	#ZCL_ATTRID_DC_CURRENT
 0x0103

	)

57 
	#ZCL_ATTRID_DC_CURRENT_MIN
 0x0104

	)

58 
	#ZCL_ATTRID_DC_CURRENT_MAX
 0x0105

	)

59 
	#ZCL_ATTRID_DC_POWER
 0x0106

	)

60 
	#ZCL_ATTRID_DC_POWER_MIN
 0x0107

	)

61 
	#ZCL_ATTRID_DC_POWER_MAX
 0x0108

	)

63 
	#ZCL_ATTRID_DC_VOLTAGE_MULTIPLIER
 0x0200

	)

64 
	#ZCL_ATTRID_DC_VOLTAGE_DIVISOR
 0x0201

	)

65 
	#ZCL_ATTRID_DC_CURRENT_MULTIPLIER
 0x0202

	)

66 
	#ZCL_ATTRID_DC_CURRENT_DIVISOR
 0x0203

	)

67 
	#ZCL_ATTRID_DC_POWER_MULTIPLIER
 0x0204

	)

68 
	#ZCL_ATTRID_DC_POWER_DIVISOR
 0x0205

	)

70 
	#ZCL_ATTRID_AC_FREQUENCY
 0x0300

	)

71 
	#ZCL_ATTRID_AC_FREQUENCY_MIN
 0x0301

	)

72 
	#ZCL_ATTRID_AC_FREQUENCY_MAX
 0x0302

	)

73 
	#ZCL_ATTRID_NEUTRAL_CURRENT
 0x0303

	)

74 
	#ZCL_ATTRID_TOTAL_ACTIVE_POWER
 0x0304

	)

75 
	#ZCL_ATTRID_TOTAL_REACTIVE_POWER
 0x0305

	)

76 
	#ZCL_ATTRID_TOTAL_APPARENT_POWER
 0x0306

	)

77 
	#ZCL_ATTRID_MEASURED_1ST_HARMONIC_CURRENT
 0x0307

	)

78 
	#ZCL_ATTRID_MEASURED_3ST_HARMONIC_CURRENT
 0x0308

	)

79 
	#ZCL_ATTRID_MEASURED_5ST_HARMONIC_CURRENT
 0x0309

	)

80 
	#ZCL_ATTRID_MEASURED_7ST_HARMONIC_CURRENT
 0x030A

	)

81 
	#ZCL_ATTRID_MEASURED_9ST_HARMONIC_CURRENT
 0x030B

	)

82 
	#ZCL_ATTRID_MEASURED_11ST_HARMONIC_CURRENT
 0x030C

	)

83 
	#ZCL_ATTRID_MEASURED_PHASE_1ST_HARMONIC_CURRENT
 0x030D

	)

84 
	#ZCL_ATTRID_MEASURED_PHASE_3ST_HARMONIC_CURRENT
 0x030E

	)

85 
	#ZCL_ATTRID_MEASURED_PHASE_5ST_HARMONIC_CURRENT
 0x030F

	)

86 
	#ZCL_ATTRID_MEASURED_PHASE_7ST_HARMONIC_CURRENT
 0x0310

	)

87 
	#ZCL_ATTRID_MEASURED_PHASE_9ST_HARMONIC_CURRENT
 0x0311

	)

88 
	#ZCL_ATTRID_MEASURED_PHASE_11ST_HARMONIC_CURRENT
 0x0312

	)

90 
	#ZCL_ATTRID_AC_FREQUENCY_MULTIPLIER
 0x0400

	)

91 
	#ZCL_ATTRID_AC_FREQUENCY_DIVISOR
 0x0401

	)

92 
	#ZCL_ATTRID_POWER_MULTIPLIER
 0x0402

	)

93 
	#ZCL_ATTRID_POWER_DIVISOR
 0x0403

	)

94 
	#ZCL_ATTRID_HARMONIC_CURRENT_MULTIPLIER
 0x0404

	)

95 
	#ZCL_ATTRID_PHASE_HARMONIC_CURRENT_MULTIPLIER
 0x0405

	)

97 
	#ZCL_ATTRID_LINE_CURRENT
 0x0501

	)

98 
	#ZCL_ATTRID_ACTIVE_CURRENT
 0x0502

	)

99 
	#ZCL_ATTRID_REACTIVE_CURRENT
 0x0503

	)

100 
	#ZCL_ATTRID_RMS_VOLTAGE
 0x0505

	)

101 
	#ZCL_ATTRID_RMS_VOLTAGE_MIN
 0x0506

	)

102 
	#ZCL_ATTRID_RMS_VOLTAGE_MAX
 0x0507

	)

103 
	#ZCL_ATTRID_RMS_CURRENT
 0x0508

	)

104 
	#ZCL_ATTRID_RMS_CURRENT_MIN
 0x0509

	)

105 
	#ZCL_ATTRID_RMS_CURRENT_MAX
 0x050A

	)

106 
	#ZCL_ATTRID_ACTIVE_POWER
 0x050B

	)

107 
	#ZCL_ATTRID_ACTIVE_POWER_MIN
 0x050C

	)

108 
	#ZCL_ATTRID_ACTIVE_POWER_MAX
 0x050D

	)

109 
	#ZCL_ATTRID_REACTIVE_POWER
 0x050E

	)

110 
	#ZCL_ATTRID_APPARENT_POWER
 0x050F

	)

111 
	#ZCL_ATTRID_POWER_FACTOR
 0x0510

	)

112 
	#ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD
 0x0511

	)

113 
	#ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_COUNTER
 0x0512

	)

114 
	#ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_COUNTER
 0x0513

	)

115 
	#ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_PERIOD
 0x0514

	)

116 
	#ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_PERIOD
 0x0515

	)

117 
	#ZCL_ATTRID_RMS_VOLTAGE_SAG_PERIOD
 0x0516

	)

118 
	#ZCL_ATTRID_RMS_VOLTAGE_SWELL_PERIOD
 0x0517

	)

120 
	#ZCL_ATTRID_AC_VOLTAGE_MULTIPLIER
 0x0600

	)

121 
	#ZCL_ATTRID_AC_VOLTAGE_DIVISOR
 0x0601

	)

122 
	#ZCL_ATTRID_AC_CURRENT_MULTIPLIER
 0x0602

	)

123 
	#ZCL_ATTRID_AC_CURRENT_DIVISOR
 0x0603

	)

124 
	#ZCL_ATTRID_AC_POWER_MULTIPLIER
 0x0604

	)

125 
	#ZCL_ATTRID_AC_POWER_DIVISOR
 0x0605

	)

127 
	#ZCL_ATTRID_DC_OVERLOAD_ALARMS_MASK
 0x0700

	)

128 
	#ZCL_ATTRID_DC_VOLTAGE_OVERLOAD
 0x0701

	)

129 
	#ZCL_ATTRID_DC_CURRENT_OVERLOAD
 0x0702

	)

131 
	#ZCL_ATTRID_AC_ALARMS_MASK
 0x0800

	)

132 
	#ZCL_ATTRID_AC_VOLTAGE_OVERLOAD
 0x0801

	)

133 
	#ZCL_ATTRID_AC_CURRENT_OVERLOAD
 0x0802

	)

134 
	#ZCL_ATTRID_AC_ACTIVE_POWER_OVERLOAD
 0x0803

	)

135 
	#ZCL_ATTRID_AC_REACTIVE_POWER_OVERLOAD
 0x0804

	)

136 
	#ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE
 0x0805

	)

137 
	#ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE
 0x0806

	)

138 
	#ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE
 0x0807

	)

139 
	#ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE
 0x0808

	)

140 
	#ZCL_ATTRID_RMS_VOLTAGE_SAG
 0x0809

	)

141 
	#ZCL_ATTRID_RMS_VOLTAGE_SWELL
 0x080A

	)

143 
	#ZCL_ATTRID_LINE_CURRENT_PHB
 0x0901

	)

144 
	#ZCL_ATTRID_ACTIVE_CURRENT_PHB
 0x0902

	)

145 
	#ZCL_ATTRID_REACTIVE_CURRENT_PHB
 0x0903

	)

146 
	#ZCL_ATTRID_RMS_VOLTAGE_PHB
 0x0905

	)

147 
	#ZCL_ATTRID_RMS_VOLTAGE_MIN_PHB
 0x0906

	)

148 
	#ZCL_ATTRID_RMS_VOLTAGE_MAX_PHB
 0x0907

	)

149 
	#ZCL_ATTRID_RMS_CURRENT_PHB
 0x0908

	)

150 
	#ZCL_ATTRID_RMS_CURRENT_MIN_PHB
 0x0909

	)

151 
	#ZCL_ATTRID_RMS_CURRENT_MAX_PHB
 0x090A

	)

152 
	#ZCL_ATTRID_ACTIVE_POWER_PHB
 0x090B

	)

153 
	#ZCL_ATTRID_ACTIVE_POWER_MIN_PHB
 0x090C

	)

154 
	#ZCL_ATTRID_ACTIVE_POWER_MAX_PHB
 0x090D

	)

155 
	#ZCL_ATTRID_REACTIVE_POWER_PHB
 0x090E

	)

156 
	#ZCL_ATTRID_APPARENT_POWER_PHB
 0x090F

	)

157 
	#ZCL_ATTRID_POWER_FACTOR_PHB
 0x0910

	)

158 
	#ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHB
 0x0911

	)

159 
	#ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHB
 0x0912

	)

160 
	#ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHB
 0x0913

	)

161 
	#ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHB
 0x0914

	)

162 
	#ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHB
 0x0915

	)

163 
	#ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHB
 0x0916

	)

164 
	#ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHB
 0x0917

	)

166 
	#ZCL_ATTRID_LINE_CURRENT_PHC
 0x0A01

	)

167 
	#ZCL_ATTRID_ACTIVE_CURRENT_PHC
 0x0A02

	)

168 
	#ZCL_ATTRID_REACTIVE_CURRENT_PHC
 0x0A03

	)

169 
	#ZCL_ATTRID_RMS_VOLTAGE_PHC
 0x0A05

	)

170 
	#ZCL_ATTRID_RMS_VOLTAGE_MIN_PHC
 0x0A06

	)

171 
	#ZCL_ATTRID_RMS_VOLTAGE_MAX_PHC
 0x0A07

	)

172 
	#ZCL_ATTRID_RMS_CURRENT_PHC
 0x0A08

	)

173 
	#ZCL_ATTRID_RMS_CURRENT_MIN_PHC
 0x0A09

	)

174 
	#ZCL_ATTRID_RMS_CURRENT_MAX_PHC
 0x0A0A

	)

175 
	#ZCL_ATTRID_ACTIVE_POWER_PHC
 0x0A0B

	)

176 
	#ZCL_ATTRID_ACTIVE_POWER_MIN_PHC
 0x0A0C

	)

177 
	#ZCL_ATTRID_ACTIVE_POWER_MAX_PHC
 0x0A0D

	)

178 
	#ZCL_ATTRID_REACTIVE_POWER_PHC
 0x0A0E

	)

179 
	#ZCL_ATTRID_APPARENT_POWER_PHC
 0x0A0F

	)

180 
	#ZCL_ATTRID_POWER_FACTOR_PHC
 0x0A10

	)

181 
	#ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHC
 0x0A11

	)

182 
	#ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHC
 0x0A12

	)

183 
	#ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHC
 0x0A13

	)

184 
	#ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHC
 0x0A14

	)

185 
	#ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHC
 0x0A15

	)

186 
	#ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHC
 0x0A16

	)

187 
	#ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHC
 0x0A17

	)

193 
	#ZCL_CMD_GET_PROFILE_INFO_RESPONSE
 0x00

	)

194 
	#ZCL_CMD_GET_MEASUREMENT_PROFILE_RESPONSE
 0x01

	)

196 
	#ZCL_CMD_GET_PROFILE_INFO
 0x00

	)

197 
	#ZCL_CMD_GET_MEASUREMENT_PROFILE
 0x01

	)

206 
u16
 
	m©åID
;

207 
UTCTime
 
	m°¨tTime
;

208 
u8
 
	mnumbîOfI¡îvÆs
;

209 }
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd_t
;

216 
u8
 
	m¥ofûeC¡
;

217 
u8
 
	m¥ofûeI¡îvÆPîiod
;

218 
u8
 
	mmaxNumbîOfI¡îvÆs
;

219 
u8
 *
	mli°OfAâribuãs
;

220 }
	tz˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd_t
;

227 
UTCTime
 
	m°¨tTime
;

228 
u8
 
	m°©us
;

229 
u8
 
	m¥ofûeI¡îvÆPîiod
;

230 
u8
 
	mnumbîOfI¡îvÆs
;

231 
u8
 
	m©åibuãId
;

232 
u8
 *
	möãrvÆs
;

233 }
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd_t
;

237 
	$°©us_t
 (*
	tz˛_ñe˘riˇlMósuª_gëProfûeInfoCb_t
Ë(
	t≠sdeD©aInd_t
 *
	tpInd
);

238 
	$°©us_t
 (*
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCb_t
Ë(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd_t
 *
	tpCmd
);

239 
	$°©us_t
 (*
	tz˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cb_t
Ë(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd_t
 *
	tpCmd
);

240 
	$°©us_t
 (*
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cb_t
Ë(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd_t
 *
	tpCmd
);

247 
z˛_ñe˘riˇlMósuª_gëProfûeInfoCb_t
 
gëProfûeInfoCbFunc
;

248 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCb_t
 
gëMósuªmítProfûeCbFunc
;

249 
z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cb_t
 
gëProfûeInfoR•CbFunc
;

250 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cb_t
 
gëMósuªmítProfûeR•CbFunc
;

251 }
	tz˛_ñe˘riˇlMósuª_AµCÆlbacks_t
;

254 c⁄° 
z˛AârInfo_t
 
ñe˘riˇlMósuª_©åTbl
[];

255 c⁄° 
u8
 
z˛_ñe˘riˇlMósuª_©åNum
;

259 
°©us_t
 
	`z˛_ñe˘riˇlMósuª_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

261 
°©us_t
 
	`z˛_ñe˘riˇlMósuª_gëProfûeInfo
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

262 
	#z˛_ñe˘riˇlMósuª_gëProfûeInfoCmd
(
a
,
b
,
c
Ë(
	`z˛_ñe˘riˇlMósuª_gëProfûeInfo
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

264 
°©us_t
 
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd_t
 *
pReq
);

265 
	#z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûe
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

267 
°©us_t
 
	`z˛_ñe˘riˇlMósuª_gëProfûeInfoR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd_t
 *
pR•
);

268 
	#z˛_ñe˘riˇlMósuª_gëProfûeInfoR•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_ñe˘riˇlMósuª_gëProfûeInfoR•
(◊), (b), (c), (d), (e)))

	)

270 
°©us_t
 
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd_t
 *
pR•
);

271 
	#z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_ñe˘riˇlMósuª_gëMósuªmítProfûeR•
(◊), (b), (c), (d), (e)))

	)

	@zigbee/zcl/measument_sensing/zcl_electrical_measurement_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_ELECTRICAL_MEASUREMENT


48 
u32
 
	gz˛EÀ˘riˇlMósuª_mósuªmítTy≥
 = 0x00000000;

51 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_ENABLE


52 
s16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁège
 = 0x8000;

54 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_MIN_ENABLE


55 
s16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁègeMö
 = 0x8000;

57 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_MAX_ENABLE


58 
s16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁègeMax
 = 0x8000;

60 #ifde‡
ZCL_ATTRID_DC_CURRENT_ENABLE


61 
s16
 
	gz˛EÀ˘riˇlMósuª_DCCuºít
 = 0x8000;

63 #ifde‡
ZCL_ATTRID_DC_CURRENT_MIN_ENABLE


64 
s16
 
	gz˛EÀ˘riˇlMósuª_DCCuºítMö
 = 0x8000;

66 #ifde‡
ZCL_ATTRID_DC_CURRENT_MAX_ENABLE


67 
s16
 
	gz˛EÀ˘riˇlMósuª_DCCuºítMax
 = 0x8000;

69 #ifde‡
ZCL_ATTRID_DC_POWER_ENABLE


70 
s16
 
	gz˛EÀ˘riˇlMósuª_DCPowî
 = 0x8000;

72 #ifde‡
ZCL_ATTRID_DC_POWER_MIN_ENABLE


73 
s16
 
	gz˛EÀ˘riˇlMósuª_DCPowîMö
 = 0x8000;

75 #ifde‡
ZCL_ATTRID_DC_POWER_MAX_ENABLE


76 
s16
 
	gz˛EÀ˘riˇlMósuª_DCPowîMax
 = 0x8000;

80 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_MULTIPLIER_ENABLE


81 
u16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁègeMu…ùlõr
 = 0x0001;

83 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_DIVISOR_ENABLE


84 
u16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁègeDivis‹
 = 0x0001;

86 #ifde‡
ZCL_ATTRID_DC_CURRENT_MULTIPLIER_ENABLE


87 
u16
 
	gz˛EÀ˘riˇlMósuª_DCCuºítMu…ùlõr
 = 0x0001;

89 #ifde‡
ZCL_ATTRID_DC_CURRENT_DIVISOR_ENABLE


90 
u16
 
	gz˛EÀ˘riˇlMósuª_DCCuºítDivis‹
 = 0x0001;

92 #ifde‡
ZCL_ATTRID_DC_POWER_MULTIPLIER_ENABLE


93 
u16
 
	gz˛EÀ˘riˇlMósuª_DCPowîMu…ùlõr
 = 0x0001;

95 #ifde‡
ZCL_ATTRID_DC_POWER_DIVISOR_ENABLE


96 
u16
 
	gz˛EÀ˘riˇlMósuª_DCPowîDivis‹
 = 0x0001;

100 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_ENABLE


101 
u16
 
	gz˛EÀ˘riˇlMósuª_ACFªquícy
 = 0xFFFF;

103 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MIN_ENABLE


104 
u16
 
	gz˛EÀ˘riˇlMósuª_ACFªquícyMö
 = 0xFFFF;

106 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MAX_ENABLE


107 
u16
 
	gz˛EÀ˘riˇlMósuª_ACFªquícyMax
 = 0xFFFF;

109 #ifde‡
ZCL_ATTRID_NEUTRAL_CURRENT_ENABLE


110 
u16
 
	gz˛EÀ˘riˇlMósuª_√uåÆCuºít
 = 0xFFFF;

112 #ifde‡
ZCL_ATTRID_TOTAL_ACTIVE_POWER_ENABLE


113 
s32
 
	gz˛EÀ˘riˇlMósuª_tŸÆA˘ivePowî
 = 0x0;

115 #ifde‡
ZCL_ATTRID_TOTAL_REACTIVE_POWER_ENABLE


116 
s32
 
	gz˛EÀ˘riˇlMósuª_tŸÆRó˘ivePowî
 = 0x0;

118 #ifde‡
ZCL_ATTRID_TOTAL_APPARENT_POWER_ENABLE


119 
u32
 
	gz˛EÀ˘riˇlMósuª_tŸÆAµ¨ítPowî
 = 0x0;

121 #ifde‡
ZCL_ATTRID_MEASURED_1ST_HARMONIC_CURRENT_ENABLE


122 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd1°H¨m⁄icCuºít
 = 0x8000;

124 #ifde‡
ZCL_ATTRID_MEASURED_3ST_HARMONIC_CURRENT_ENABLE


125 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd3°H¨m⁄icCuºít
 = 0x8000;

127 #ifde‡
ZCL_ATTRID_MEASURED_5ST_HARMONIC_CURRENT_ENABLE


128 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd5°H¨m⁄icCuºít
 = 0x8000;

130 #ifde‡
ZCL_ATTRID_MEASURED_7ST_HARMONIC_CURRENT_ENABLE


131 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd7°H¨m⁄icCuºít
 = 0x8000;

133 #ifde‡
ZCL_ATTRID_MEASURED_9ST_HARMONIC_CURRENT_ENABLE


134 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd9°H¨m⁄icCuºít
 = 0x8000;

136 #ifde‡
ZCL_ATTRID_MEASURED_11ST_HARMONIC_CURRENT_ENABLE


137 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªd11°H¨m⁄icCuºít
 = 0x8000;

139 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_1ST_HARMONIC_CURRENT_ENABLE


140 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£1°H¨m⁄icCuºít
 = 0x8000;

142 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_3ST_HARMONIC_CURRENT_ENABLE


143 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£3°H¨m⁄icCuºít
 = 0x8000;

145 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_5ST_HARMONIC_CURRENT_ENABLE


146 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£5°H¨m⁄icCuºít
 = 0x8000;

148 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_7ST_HARMONIC_CURRENT_ENABLE


149 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£7°H¨m⁄icCuºít
 = 0x8000;

151 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_9ST_HARMONIC_CURRENT_ENABLE


152 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£9°H¨m⁄icCuºít
 = 0x8000;

154 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_11ST_HARMONIC_CURRENT_ENABLE


155 
s16
 
	gz˛EÀ˘riˇlMósuª_mósuªdPha£11°H¨m⁄icCuºít
 = 0x8000;

159 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MULTIPLIER_ENABLE


160 
u16
 
	gz˛EÀ˘riˇlMósuª_ACFªquícyMu…ùlõr
 = 0x0001;

162 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_DIVISOR_ENABLE


163 
u16
 
	gz˛EÀ˘riˇlMósuª_ACFªquícyDivis‹
 = 0x0001;

165 #ifde‡
ZCL_ATTRID_POWER_MULTIPLIER_ENABLE


166 
u32
 
	gz˛EÀ˘riˇlMósuª_powîMu…ùlõr
 = 0x00000001;

168 #ifde‡
ZCL_ATTRID_POWER_DIVISOR_ENABLE


169 
u32
 
	gz˛EÀ˘riˇlMósuª_powîDivis‹
 = 0x00000001;

171 #ifde‡
ZCL_ATTRID_HARMONIC_CURRENT_MULTIPLIER_ENABLE


172 
s8
 
	gz˛EÀ˘riˇlMósuª_h¨m⁄icCuºítMu…ùlõr
 = 0x00;

174 #ifde‡
ZCL_ATTRID_PHASE_HARMONIC_CURRENT_MULTIPLIER_ENABLE


175 
s8
 
	gz˛EÀ˘riˇlMósuª_pha£H¨m⁄icCuºítMu…ùlõr
 = 0x00;

179 #ifde‡
ZCL_ATTRID_LINE_CURRENT_ENABLE


180 
u16
 
	gz˛EÀ˘riˇlMósuª_löeCuºít
 = 0xFFFF;

182 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_ENABLE


183 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘iveCuºít
 = 0x8000;

185 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_ENABLE


186 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘iveCuºít
 = 0x8000;

188 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_ENABLE


189 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁège
 = 0xFFFF;

191 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_ENABLE


192 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMö
 = 0xFFFF;

194 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_ENABLE


195 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMax
 = 0xFFFF;

197 #ifde‡
ZCL_ATTRID_RMS_CURRENT_ENABLE


198 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºít
 = 0xFFFF;

200 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_ENABLE


201 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMö
 = 0xFFFF;

203 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_ENABLE


204 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMax
 = 0xFFFF;

206 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_ENABLE


207 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowî
 = 0x8000;

209 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_ENABLE


210 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMö
 = 0x8000;

212 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_ENABLE


213 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMax
 = 0x8000;

215 #ifde‡
ZCL_ATTRID_REACTIVE_POWER_ENABLE


216 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘ivePowî
 = 0x8000;

218 #ifde‡
ZCL_ATTRID_APPARENT_POWER_ENABLE


219 
u16
 
	gz˛EÀ˘riˇlMósuª_≠∑ª¡Powî
 = 0xFFFF;

221 #ifde‡
ZCL_ATTRID_POWER_FACTOR_ENABLE


222 
s8
 
	gz˛EÀ˘riˇlMósuª_powîFa˘‹
 = 0x00;

224 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_ENABLE


225 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiod
 = 0x0000;

227 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_COUNTER_ENABLE


228 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡î
 = 0x0000;

230 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_COUNTER_ENABLE


231 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡î
 = 0x0000;

233 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_PERIOD_ENABLE


234 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiod
 = 0x0000;

236 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_PERIOD_ENABLE


237 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiod
 = 0x0000;

239 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SAG_PERIOD_ENABLE


240 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiod
 = 0x0000;

242 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SWELL_PERIOD_ENABLE


243 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiod
 = 0x0000;

247 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_MULTIPLIER_ENABLE


248 
u16
 
	gz˛EÀ˘riˇlMósuª_ACVﬁègeMu…ùlõr
 = 0x0001;

250 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_DIVISOR_ENABLE


251 
u16
 
	gz˛EÀ˘riˇlMósuª_ACVﬁègeDivis‹
 = 0x0001;

253 #ifde‡
ZCL_ATTRID_AC_CURRENT_MULTIPLIER_ENABLE


254 
u16
 
	gz˛EÀ˘riˇlMósuª_ACCuºítMu…ùlõr
 = 0x0001;

256 #ifde‡
ZCL_ATTRID_AC_CURRENT_DIVISOR_ENABLE


257 
u16
 
	gz˛EÀ˘riˇlMósuª_ACCuºítDivis‹
 = 0x0001;

259 #ifde‡
ZCL_ATTRID_AC_POWER_MULTIPLIER_ENABLE


260 
u16
 
	gz˛EÀ˘riˇlMósuª_ACPowîMu…ùlõr
 = 0x0001;

262 #ifde‡
ZCL_ATTRID_AC_POWER_DIVISOR_ENABLE


263 
u16
 
	gz˛EÀ˘riˇlMósuª_ACPowîDivis‹
 = 0x0001;

267 #ifde‡
ZCL_ATTRID_DC_OVERLOAD_ALARMS_MASK_ENABLE


268 
u8
 
	gz˛EÀ˘riˇlMósuª_DCOvîlﬂdAœrmsMask
 = 0;

270 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_OVERLOAD_ENABLE


271 
s16
 
	gz˛EÀ˘riˇlMósuª_DCVﬁègeOvîlﬂd
 = 0xFFFF;

273 #ifde‡
ZCL_ATTRID_DC_CURRENT_OVERLOAD_ENABLE


274 
s16
 
	gz˛EÀ˘riˇlMósuª_DCCuºítOvîlﬂd
 = 0xFFFF;

278 #ifde‡
ZCL_ATTRID_AC_ALARMS_MASK_ENABLE


279 
u16
 
	gz˛EÀ˘riˇlMósuª_ACAœrmsMask
 = 0;

281 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_OVERLOAD_ENABLE


282 
s16
 
	gz˛EÀ˘riˇlMósuª_ACVﬁègeOvîlﬂd
 = 0xFFFF;

284 #ifde‡
ZCL_ATTRID_AC_CURRENT_OVERLOAD_ENABLE


285 
s16
 
	gz˛EÀ˘riˇlMósuª_ACCuºítOvîlﬂd
 = 0xFFFF;

287 #ifde‡
ZCL_ATTRID_AC_ACTIVE_POWER_OVERLOAD_ENABLE


288 
s16
 
	gz˛EÀ˘riˇlMósuª_ACA˘ivePowîOvîlﬂd
 = 0xFFFF;

290 #ifde‡
ZCL_ATTRID_AC_REACTIVE_POWER_OVERLOAD_ENABLE


291 
s16
 
	gz˛EÀ˘riˇlMósuª_ACRó˘ivePowîOvîlﬂd
 = 0xFFFF;

293 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_ENABLE


294 
s16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁège
 = 0xFFFF;

296 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_ENABLE


297 
s16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁège
 = 0xFFFF;

299 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_ENABLE


300 
s16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁège
 = 0xFFFF;

302 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_ENABLE


303 
s16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁège
 = 0xFFFF;

305 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SAG_ENABLE


306 
s16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSag
 = 0xFFFF;

308 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SWELL_ENABLE


309 
s16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSwñl
 = 0xFFFF;

313 #ifde‡
ZCL_ATTRID_LINE_CURRENT_PHB_ENABLE


314 
u16
 
	gz˛EÀ˘riˇlMósuª_löeCuºítPhB
 = 0xFFFF;

316 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_PHB_ENABLE


317 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘iveCuºítPhB
 = 0x8000;

319 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_PHB_ENABLE


320 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘iveCuºítPhB
 = 0x8000;

322 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_PHB_ENABLE


323 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègePhB
 = 0xFFFF;

325 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHB_ENABLE


326 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMöPhB
 = 0x8000;

328 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHB_ENABLE


329 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMaxPhB
 = 0x8000;

331 #ifde‡
ZCL_ATTRID_RMS_CURRENT_PHB_ENABLE


332 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítPhB
 = 0xFFFF;

334 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_PHB_ENABLE


335 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMöPhB
 = 0xFFFF;

337 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_PHB_ENABLE


338 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMaxPhB
 = 0xFFFF;

340 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_PHB_ENABLE


341 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîPhB
 = 0x8000;

343 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_PHB_ENABLE


344 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMöPhB
 = 0x8000;

346 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_PHB_ENABLE


347 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMaxPhB
 = 0x8000;

349 #ifde‡
ZCL_ATTRID_REACTIVE_POWER_PHB_ENABLE


350 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘ivePowîPhB
 = 0x8000;

352 #ifde‡
ZCL_ATTRID_APPARENT_POWER_PHB_ENABLE


353 
u16
 
	gz˛EÀ˘riˇlMósuª_≠∑ª¡PowîPhB
 = 0xFFFF;

355 #ifde‡
ZCL_ATTRID_POWER_FACTOR_PHB_ENABLE


356 
s8
 
	gz˛EÀ˘riˇlMósuª_powîFa˘‹PhB
 = 0x00;

358 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHB_ENABLE


359 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiodPhB
 = 0x0000;

361 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHB_ENABLE


362 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡îPhB
 = 0x0000;

364 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHB_ENABLE


365 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡îPhB
 = 0x0000;

367 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHB_ENABLE


368 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiodPhB
 = 0x0000;

370 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHB_ENABLE


371 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiodPhB
 = 0x0000;

373 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHB_ENABLE


374 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiodPhB
 = 0x0000;

376 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHB_ENABLE


377 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiodPhB
 = 0x0000;

381 #ifde‡
ZCL_ATTRID_LINE_CURRENT_PHC_ENABLE


382 
u16
 
	gz˛EÀ˘riˇlMósuª_löeCuºítPhC
 = 0xFFFF;

384 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_PHC_ENABLE


385 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘iveCuºítPhC
 = 0x8000;

387 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_PHC_ENABLE


388 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘iveCuºítPhC
 = 0x8000;

390 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_PHC_ENABLE


391 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègePhC
 = 0xFFFF;

393 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHC_ENABLE


394 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMöPhC
 = 0x8000;

396 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHC_ENABLE


397 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeMaxPhC
 = 0x8000;

399 #ifde‡
ZCL_ATTRID_RMS_CURRENT_PHC_ENABLE


400 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítPhC
 = 0xFFFF;

402 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_PHC_ENABLE


403 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMöPhC
 = 0xFFFF;

405 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_PHC_ENABLE


406 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSCuºítMaxPhC
 = 0xFFFF;

408 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_PHC_ENABLE


409 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîPhC
 = 0x8000;

411 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_PHC_ENABLE


412 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMöPhC
 = 0x8000;

414 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_PHC_ENABLE


415 
s16
 
	gz˛EÀ˘riˇlMósuª_a˘ivePowîMaxPhC
 = 0x8000;

417 #ifde‡
ZCL_ATTRID_REACTIVE_POWER_PHC_ENABLE


418 
s16
 
	gz˛EÀ˘riˇlMósuª_ªa˘ivePowîPhC
 = 0x8000;

420 #ifde‡
ZCL_ATTRID_APPARENT_POWER_PHC_ENABLE


421 
u16
 
	gz˛EÀ˘riˇlMósuª_≠∑ª¡PowîPhC
 = 0xFFFF;

423 #ifde‡
ZCL_ATTRID_POWER_FACTOR_PHC_ENABLE


424 
s8
 
	gz˛EÀ˘riˇlMósuª_powîFa˘‹PhC
 = 0x00;

426 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHC_ENABLE


427 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiodPhC
 = 0x0000;

429 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHC_ENABLE


430 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡îPhC
 = 0x0000;

432 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHC_ENABLE


433 
u16
 
	gz˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡îPhC
 = 0x0000;

435 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHC_ENABLE


436 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiodPhC
 = 0x0000;

438 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHC_ENABLE


439 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiodPhC
 = 0x0000;

441 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHC_ENABLE


442 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiodPhC
 = 0x0000;

444 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHC_ENABLE


445 
u16
 
	gz˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiodPhC
 = 0x0000;

450 c⁄° 
z˛AârInfo_t
 
	gñe˘riˇlMósuª_©åTbl
[] =

452 { 
ZCL_ATTRID_MEASUREMENT_TYPE
, 
ZCL_DATA_TYPE_BITMAP32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªmítTy≥
 },

454 #ifdef 
ZCL_ATTRID_DC_VOLTAGE_ENABLE


455 { 
ZCL_ATTRID_DC_VOLTAGE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁège
 },

457 #ifdef 
ZCL_ATTRID_DC_VOLTAGE_MIN_ENABLE


458 { 
ZCL_ATTRID_DC_VOLTAGE_MIN
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁègeMö
 },

460 #ifdef 
ZCL_ATTRID_DC_VOLTAGE_MAX_ENABLE


461 { 
ZCL_ATTRID_DC_VOLTAGE_MAX
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁègeMax
 },

463 #ifdef 
ZCL_ATTRID_DC_CURRENT_ENABLE


464 { 
ZCL_ATTRID_DC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºít
 },

466 #ifdef 
ZCL_ATTRID_DC_CURRENT_MIN_ENABLE


467 { 
ZCL_ATTRID_DC_CURRENT_MIN
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºítMö
 },

469 #ifdef 
ZCL_ATTRID_DC_CURRENT_MAX_ENABLE


470 { 
ZCL_ATTRID_DC_CURRENT_MAX
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºítMax
 },

472 #ifdef 
ZCL_ATTRID_DC_POWER_ENABLE


473 { 
ZCL_ATTRID_DC_POWER
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCPowî
 },

475 #ifdef 
ZCL_ATTRID_DC_POWER_MIN_ENABLE


476 { 
ZCL_ATTRID_DC_POWER_MIN
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCPowîMö
 },

478 #ifdef 
ZCL_ATTRID_DC_POWER_MAX_ENABLE


479 { 
ZCL_ATTRID_DC_POWER_MAX
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCPowîMax
 },

482 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_MULTIPLIER_ENABLE


483 { 
ZCL_ATTRID_DC_VOLTAGE_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁègeMu…ùlõr
 },

485 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_DIVISOR_ENABLE


486 { 
ZCL_ATTRID_DC_VOLTAGE_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁègeDivis‹
 },

488 #ifde‡
ZCL_ATTRID_DC_CURRENT_MULTIPLIER_ENABLE


489 { 
ZCL_ATTRID_DC_CURRENT_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºítMu…ùlõr
 },

491 #ifde‡
ZCL_ATTRID_DC_CURRENT_DIVISOR_ENABLE


492 { 
ZCL_ATTRID_DC_CURRENT_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºítDivis‹
 },

494 #ifde‡
ZCL_ATTRID_DC_POWER_MULTIPLIER_ENABLE


495 { 
ZCL_ATTRID_DC_POWER_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCPowîMu…ùlõr
 },

497 #ifde‡
ZCL_ATTRID_DC_POWER_DIVISOR_ENABLE


498 { 
ZCL_ATTRID_DC_POWER_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCPowîDivis‹
 },

501 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_ENABLE


502 { 
ZCL_ATTRID_AC_FREQUENCY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACFªquícy
 },

504 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MIN_ENABLE


505 { 
ZCL_ATTRID_AC_FREQUENCY_MIN
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACFªquícyMö
 },

507 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MAX_ENABLE


508 { 
ZCL_ATTRID_AC_FREQUENCY_MAX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACFªquícyMax
 },

510 #ifde‡
ZCL_ATTRID_NEUTRAL_CURRENT_ENABLE


511 { 
ZCL_ATTRID_NEUTRAL_CURRENT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_√uåÆCuºít
 },

513 #ifde‡
ZCL_ATTRID_TOTAL_ACTIVE_POWER_ENABLE


514 { 
ZCL_ATTRID_TOTAL_ACTIVE_POWER
, 
ZCL_DATA_TYPE_INT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_tŸÆA˘ivePowî
 },

516 #ifde‡
ZCL_ATTRID_TOTAL_REACTIVE_POWER_ENABLE


517 { 
ZCL_ATTRID_TOTAL_REACTIVE_POWER
, 
ZCL_DATA_TYPE_INT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_tŸÆRó˘ivePowî
 },

519 #ifde‡
ZCL_ATTRID_TOTAL_APPARENT_POWER_ENABLE


520 { 
ZCL_ATTRID_TOTAL_APPARENT_POWER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_tŸÆAµ¨ítPowî
 },

522 #ifde‡
ZCL_ATTRID_MEASURED_1ST_HARMONIC_CURRENT_ENABLE


523 { 
ZCL_ATTRID_MEASURED_1ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd1°H¨m⁄icCuºít
 },

525 #ifde‡
ZCL_ATTRID_MEASURED_3ST_HARMONIC_CURRENT_ENABLE


526 { 
ZCL_ATTRID_MEASURED_3ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd3°H¨m⁄icCuºít
 },

528 #ifde‡
ZCL_ATTRID_MEASURED_5ST_HARMONIC_CURRENT_ENABLE


529 { 
ZCL_ATTRID_MEASURED_5ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd5°H¨m⁄icCuºít
 },

531 #ifde‡
ZCL_ATTRID_MEASURED_7ST_HARMONIC_CURRENT_ENABLE


532 { 
ZCL_ATTRID_MEASURED_7ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd7°H¨m⁄icCuºít
 },

534 #ifde‡
ZCL_ATTRID_MEASURED_9ST_HARMONIC_CURRENT_ENABLE


535 { 
ZCL_ATTRID_MEASURED_9ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd9°H¨m⁄icCuºít
 },

537 #ifde‡
ZCL_ATTRID_MEASURED_11ST_HARMONIC_CURRENT_ENABLE


538 { 
ZCL_ATTRID_MEASURED_11ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªd11°H¨m⁄icCuºít
 },

540 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_1ST_HARMONIC_CURRENT_ENABLE


541 { 
ZCL_ATTRID_MEASURED_PHASE_1ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£1°H¨m⁄icCuºít
 },

543 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_3ST_HARMONIC_CURRENT_ENABLE


544 { 
ZCL_ATTRID_MEASURED_PHASE_3ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£3°H¨m⁄icCuºít
 },

546 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_5ST_HARMONIC_CURRENT_ENABLE


547 { 
ZCL_ATTRID_MEASURED_PHASE_5ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£5°H¨m⁄icCuºít
 },

549 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_7ST_HARMONIC_CURRENT_ENABLE


550 { 
ZCL_ATTRID_MEASURED_PHASE_7ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£7°H¨m⁄icCuºít
 },

552 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_9ST_HARMONIC_CURRENT_ENABLE


553 { 
ZCL_ATTRID_MEASURED_PHASE_9ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£9°H¨m⁄icCuºít
 },

555 #ifde‡
ZCL_ATTRID_MEASURED_PHASE_11ST_HARMONIC_CURRENT_ENABLE


556 { 
ZCL_ATTRID_MEASURED_PHASE_11ST_HARMONIC_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_mósuªdPha£11°H¨m⁄icCuºít
 },

559 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_MULTIPLIER_ENABLE


560 { 
ZCL_ATTRID_AC_FREQUENCY_MULTIPLIER
,
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACFªquícyMu…ùlõr
 },

562 #ifde‡
ZCL_ATTRID_AC_FREQUENCY_DIVISOR_ENABLE


563 { 
ZCL_ATTRID_AC_FREQUENCY_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACFªquícyDivis‹
 },

565 #ifde‡
ZCL_ATTRID_POWER_MULTIPLIER_ENABLE


566 { 
ZCL_ATTRID_POWER_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_powîMu…ùlõr
 },

568 #ifde‡
ZCL_ATTRID_POWER_DIVISOR_ENABLE


569 { 
ZCL_ATTRID_POWER_DIVISOR
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_powîDivis‹
 },

571 #ifde‡
ZCL_ATTRID_HARMONIC_CURRENT_MULTIPLIER_ENABLE


572 { 
ZCL_ATTRID_HARMONIC_CURRENT_MULTIPLIER
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_h¨m⁄icCuºítMu…ùlõr
 },

574 #ifde‡
ZCL_ATTRID_PHASE_HARMONIC_CURRENT_MULTIPLIER_ENABLE


575 { 
ZCL_ATTRID_PHASE_HARMONIC_CURRENT_MULTIPLIER
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_pha£H¨m⁄icCuºítMu…ùlõr
 },

578 #ifde‡
ZCL_ATTRID_LINE_CURRENT_ENABLE


579 { 
ZCL_ATTRID_LINE_CURRENT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_löeCuºít
 },

581 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_ENABLE


582 { 
ZCL_ATTRID_ACTIVE_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘iveCuºít
 },

584 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_ENABLE


585 { 
ZCL_ATTRID_REACTIVE_CURRENT
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘iveCuºít
 },

587 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_ENABLE


588 { 
ZCL_ATTRID_RMS_VOLTAGE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁège
 },

590 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_ENABLE


591 { 
ZCL_ATTRID_RMS_VOLTAGE_MIN
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMö
 },

593 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_ENABLE


594 { 
ZCL_ATTRID_RMS_VOLTAGE_MAX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMax
 },

596 #ifde‡
ZCL_ATTRID_RMS_CURRENT_ENABLE


597 { 
ZCL_ATTRID_RMS_CURRENT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºít
 },

599 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_ENABLE


600 { 
ZCL_ATTRID_RMS_CURRENT_MIN
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMö
 },

602 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_ENABLE


603 { 
ZCL_ATTRID_RMS_CURRENT_MAX
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMax
 },

605 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_ENABLE


606 { 
ZCL_ATTRID_ACTIVE_POWER
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowî
 },

608 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_ENABLE


609 { 
ZCL_ATTRID_ACTIVE_POWER_MIN
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMö
 },

611 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_ENABLE


612 { 
ZCL_ATTRID_ACTIVE_POWER_MAX
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMax
 },

614 #ifde‡ 
ZCL_ATTRID_REACTIVE_POWER_ENABLE


615 { 
ZCL_ATTRID_REACTIVE_POWER
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘ivePowî
 },

617 #ifde‡
ZCL_ATTRID_APPARENT_POWER_ENABLE


618 { 
ZCL_ATTRID_APPARENT_POWER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_≠∑ª¡Powî
 },

620 #ifde‡
ZCL_ATTRID_POWER_FACTOR_ENABLE


621 { 
ZCL_ATTRID_POWER_FACTOR
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_powîFa˘‹
 },

623 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_ENABLE


624 { 
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiod
 },

626 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_COUNTER_ENABLE


627 { 
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_COUNTER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡î
 },

629 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_COUNTER_ENABLE


630 { 
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_COUNTER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡î
 },

632 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_PERIOD_ENABLE


633 { 
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiod
 },

635 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_PERIOD_ENABLE


636 { 
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiod
 },

638 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SAG_PERIOD_ENABLE


639 { 
ZCL_ATTRID_RMS_VOLTAGE_SAG_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiod
 },

641 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SWELL_PERIOD_ENABLE


642 { 
ZCL_ATTRID_RMS_VOLTAGE_SWELL_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiod
 },

645 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_MULTIPLIER_ENABLE


646 { 
ZCL_ATTRID_AC_VOLTAGE_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACVﬁègeMu…ùlõr
 },

648 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_DIVISOR_ENABLE


649 { 
ZCL_ATTRID_AC_VOLTAGE_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACVﬁègeDivis‹
 },

651 #ifde‡
ZCL_ATTRID_AC_CURRENT_MULTIPLIER_ENABLE


652 { 
ZCL_ATTRID_AC_CURRENT_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACCuºítMu…ùlõr
 },

654 #ifde‡
ZCL_ATTRID_AC_CURRENT_DIVISOR_ENABLE


655 { 
ZCL_ATTRID_AC_CURRENT_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACCuºítDivis‹
 },

657 #ifde‡
ZCL_ATTRID_AC_POWER_MULTIPLIER_ENABLE


658 { 
ZCL_ATTRID_AC_POWER_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACPowîMu…ùlõr
 },

660 #ifde‡
ZCL_ATTRID_AC_POWER_DIVISOR_ENABLE


661 { 
ZCL_ATTRID_AC_POWER_DIVISOR
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACPowîDivis‹
 },

664 #ifde‡
ZCL_ATTRID_DC_OVERLOAD_ALARMS_MASK_ENABLE


665 { 
ZCL_ATTRID_DC_OVERLOAD_ALARMS_MASK
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCOvîlﬂdAœrmsMask
 },

667 #ifde‡
ZCL_ATTRID_DC_VOLTAGE_OVERLOAD_ENABLE


668 { 
ZCL_ATTRID_DC_VOLTAGE_OVERLOAD
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCVﬁègeOvîlﬂd
 },

670 #ifde‡
ZCL_ATTRID_DC_CURRENT_OVERLOAD_ENABLE


671 { 
ZCL_ATTRID_DC_CURRENT_OVERLOAD
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_DCCuºítOvîlﬂd
 },

674 #ifde‡
ZCL_ATTRID_AC_ALARMS_MASK_ENABLE


675 { 
ZCL_ATTRID_AC_ALARMS_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACAœrmsMask
 },

677 #ifde‡
ZCL_ATTRID_AC_VOLTAGE_OVERLOAD_ENABLE


678 { 
ZCL_ATTRID_AC_VOLTAGE_OVERLOAD
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACVﬁègeOvîlﬂd
 },

680 #ifde‡
ZCL_ATTRID_AC_CURRENT_OVERLOAD_ENABLE


681 { 
ZCL_ATTRID_AC_CURRENT_OVERLOAD
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACCuºítOvîlﬂd
 },

683 #ifde‡
ZCL_ATTRID_AC_ACTIVE_POWER_OVERLOAD_ENABLE


684 { 
ZCL_ATTRID_AC_ACTIVE_POWER_OVERLOAD
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACA˘ivePowîOvîlﬂd
 },

686 #ifde‡
ZCL_ATTRID_AC_REACTIVE_POWER_OVERLOAD_ENABLE


687 { 
ZCL_ATTRID_AC_REACTIVE_POWER_OVERLOAD
,
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ACRó˘ivePowîOvîlﬂd
 },

689 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_ENABLE


690 { 
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁège
 },

692 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_ENABLE


693 { 
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁège
 },

695 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE_ENABLE


696 { 
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAGE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁège
 },

698 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE_ENABLE


699 { 
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAGE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁège
 },

701 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SAG_ENABLE


702 { 
ZCL_ATTRID_RMS_VOLTAGE_SAG
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSag
 },

704 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_SWELL_ENABLE


705 { 
ZCL_ATTRID_RMS_VOLTAGE_SWELL
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSwñl
 },

708 #ifde‡
ZCL_ATTRID_LINE_CURRENT_PHB_ENABLE


709 { 
ZCL_ATTRID_LINE_CURRENT_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_löeCuºítPhB
 },

711 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_PHB_ENABLE


712 { 
ZCL_ATTRID_ACTIVE_CURRENT_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘iveCuºítPhB
 },

714 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_PHB_ENABLE


715 { 
ZCL_ATTRID_REACTIVE_CURRENT_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘iveCuºítPhB
 },

717 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_PHB_ENABLE


718 { 
ZCL_ATTRID_RMS_VOLTAGE_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègePhB
 },

720 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHB_ENABLE


721 { 
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMöPhB
 },

723 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHB_ENABLE


724 { 
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMaxPhB
 },

726 #ifde‡
ZCL_ATTRID_RMS_CURRENT_PHB_ENABLE


727 { 
ZCL_ATTRID_RMS_CURRENT_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítPhB
 },

729 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_PHB_ENABLE


730 { 
ZCL_ATTRID_RMS_CURRENT_MIN_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMöPhB
 },

732 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_PHB_ENABLE


733 { 
ZCL_ATTRID_RMS_CURRENT_MAX_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMaxPhB
 },

735 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_PHB_ENABLE


736 { 
ZCL_ATTRID_ACTIVE_POWER_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîPhB
 },

738 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_PHB_ENABLE


739 { 
ZCL_ATTRID_ACTIVE_POWER_MIN_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMöPhB
 },

741 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_PHB_ENABLE


742 { 
ZCL_ATTRID_ACTIVE_POWER_MAX_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMaxPhB
 },

744 #ifde‡
ZCL_ATTRID_REACTIVE_POWER_PHB_ENABLE


745 { 
ZCL_ATTRID_REACTIVE_POWER_PHB
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘ivePowîPhB
 },

747 #ifde‡
ZCL_ATTRID_APPARENT_POWER_PHB_ENABLE


748 { 
ZCL_ATTRID_APPARENT_POWER_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_≠∑ª¡PowîPhB
 },

750 #ifde‡
ZCL_ATTRID_POWER_FACTOR_PHB_ENABLE


751 { 
ZCL_ATTRID_POWER_FACTOR_PHB
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_powîFa˘‹PhB
 },

753 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHB_ENABLE


754 { 
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiodPhB
 },

756 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHB_ENABLE


757 { 
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡îPhB
 },

759 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHB_ENABLE


760 { 
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡îPhB
 },

762 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHB_ENABLE


763 { 
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiodPhB
 },

765 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHB_ENABLE


766 { 
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiodPhB
 },

768 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHB_ENABLE


769 { 
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiodPhB
 },

771 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHB_ENABLE


772 { 
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHB
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiodPhB
 },

775 #ifde‡
ZCL_ATTRID_LINE_CURRENT_PHC_ENABLE


776 { 
ZCL_ATTRID_LINE_CURRENT_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_löeCuºítPhC
 },

778 #ifde‡
ZCL_ATTRID_ACTIVE_CURRENT_PHC_ENABLE


779 { 
ZCL_ATTRID_ACTIVE_CURRENT_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘iveCuºítPhC
 },

781 #ifde‡
ZCL_ATTRID_REACTIVE_CURRENT_PHC_ENABLE


782 { 
ZCL_ATTRID_REACTIVE_CURRENT_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘iveCuºítPhC
 },

784 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_PHC_ENABLE


785 { 
ZCL_ATTRID_RMS_VOLTAGE_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègePhC
 },

787 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHC_ENABLE


788 { 
ZCL_ATTRID_RMS_VOLTAGE_MIN_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMöPhC
 },

790 #ifde‡
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHC_ENABLE


791 { 
ZCL_ATTRID_RMS_VOLTAGE_MAX_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeMaxPhC
 },

793 #ifde‡
ZCL_ATTRID_RMS_CURRENT_PHC_ENABLE


794 { 
ZCL_ATTRID_RMS_CURRENT_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítPhC
 },

796 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MIN_PHC_ENABLE


797 { 
ZCL_ATTRID_RMS_CURRENT_MIN_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMöPhC
 },

799 #ifde‡
ZCL_ATTRID_RMS_CURRENT_MAX_PHC_ENABLE


800 { 
ZCL_ATTRID_RMS_CURRENT_MAX_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSCuºítMaxPhC
 },

802 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_PHC_ENABLE


803 { 
ZCL_ATTRID_ACTIVE_POWER_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîPhC
 },

805 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MIN_PHC_ENABLE


806 { 
ZCL_ATTRID_ACTIVE_POWER_MIN_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMöPhC
 },

808 #ifde‡
ZCL_ATTRID_ACTIVE_POWER_MAX_PHC_ENABLE


809 { 
ZCL_ATTRID_ACTIVE_POWER_MAX_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_a˘ivePowîMaxPhC
 },

811 #ifde‡
ZCL_ATTRID_REACTIVE_POWER_PHC_ENABLE


812 { 
ZCL_ATTRID_REACTIVE_POWER_PHC
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_ªa˘ivePowîPhC
 },

814 #ifde‡
ZCL_ATTRID_APPARENT_POWER_PHC_ENABLE


815 { 
ZCL_ATTRID_APPARENT_POWER_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_≠∑ª¡PowîPhC
 },

817 #ifde‡
ZCL_ATTRID_POWER_FACTOR_PHC_ENABLE


818 { 
ZCL_ATTRID_POWER_FACTOR_PHC
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛EÀ˘riˇlMósuª_powîFa˘‹PhC
 },

820 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHC_ENABLE


821 { 
ZCL_ATTRID_AVERAGE_RMS_VOLTAGE_MEASUREMENT_PERIOD_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSVﬁègeMósuªmítPîiodPhC
 },

823 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHC_ENABLE


824 { 
ZCL_ATTRID_AVERAGE_RMS_OVER_VOLTAGE_CURRENT_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSOvîVﬁègeCou¡îPhC
 },

826 #ifde‡
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHC_ENABLE


827 { 
ZCL_ATTRID_AVERAGE_RMS_UNDER_VOLTAGE_CURRENT_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_avîageRMSUndîVﬁègeCou¡îPhC
 },

829 #ifde‡
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHC_ENABLE


830 { 
ZCL_ATTRID_RMS_EXTREME_OVER_VOLTAHE_PERIOD_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeOvîVﬁègePîiodPhC
 },

832 #ifde‡
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHC_ENABLE


833 { 
ZCL_ATTRID_RMS_EXTREME_UNDER_VOLTAHE_PERIOD_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSExåemeUndîVﬁègePîiodPhC
 },

835 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHC_ENABLE


836 { 
ZCL_ATTRID_RMS_VOLTAHE_SAG_PERIOD_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSagPîiodPhC
 },

838 #ifde‡
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHC_ENABLE


839 { 
ZCL_ATTRID_RMS_VOLTAHE_SWELL_PERIOD_PHC
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛EÀ˘riˇlMósuª_RMSVﬁègeSwñlPîiodPhC
 },

843 c⁄° 
u8
 
	gz˛_ñe˘riˇlMósuª_©åNum
 = ( (
ñe˘riˇlMósuª_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/measument_sensing/zcl_illuminance_measurement.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_ILLUMINANCE_MEASUREMENT


49 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ûlumö™˚Mósuª_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

51  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_MS_ILLUMINANCE_MEASUREMENT
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

52 
	}
}

	@zigbee/zcl/measument_sensing/zcl_illuminance_measurement.h

24 #i‚de‡
ZCL_ILLUMINANCE_MEASUREMENT_H


25 
	#ZCL_ILLUMINANCE_MEASUREMENT_H


	)

35 
	#ZCL_ATTRID_MEASURED_VALUE
 0x0000

	)

36 
	#ZCL_ATTRID_MIN_MEASURED_VALUE
 0x0001

	)

37 
	#ZCL_ATTRID_MAX_MEASURED_VALUE
 0x0002

	)

38 
	#ZCL_ATTRID_TOLERANCE
 0x0003

	)

39 
	#ZCL_ATTRID_LIGHT_SENSOR_TYPE
 0x0004

	)

44 
°©us_t
 
z˛_ûlumö™˚Mósuª_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/measument_sensing/zcl_illuminance_measurement_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_ILLUMINANCE_MEASUREMENT


48 
u16
 
	gz˛_©å_mósuªdVÆ
 = 0;

49 
u16
 
	gz˛_©å_möMósuªdVÆ
 = 0;

50 
u16
 
	gz˛_©å_maxMósuªdVÆ
 = 0;

52 #ifde‡
ZCL_ATTR_TOLERANCE_ENABLE


53 
u16
 
	gz˛_©å_tﬁî™˚
 = 0;

56 #ifde‡
ZCL_ATTR_LIGHT_SENSOR_TYPE_ENABLE


57 
u8
 
	gz˛_©å_lightSís‹Ty≥
 = 0;

62 c⁄° 
z˛AârInfo_t
 
	gûlumö™˚Mósuª_©åTbl
[] =

64 { 
ZCL_ATTRID_MEASURED_VALUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mósuªdVÆ
 },

65 { 
ZCL_ATTRID_MIN_MEASURED_VALUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_möMósuªdVÆ
 },

66 { 
ZCL_ATTRID_MAX_MEASURED_VALUE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_maxMósuªdVÆ
 },

67 #ifde‡
ZCL_ATTR_TOLERANCE_ENABLE


68 { 
ZCL_ATTRID_TOLERANCE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_tﬁî™˚
 },

71 #ifde‡
ZCL_ATTR_LIGHT_SENSOR_TYPE_ENABLE


72 { 
ZCL_ATTRID_LIGHT_SENSOR_TYPE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_lightSís‹Ty≥
 },

74 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

77 c⁄° 
u8
 
	gz˛_ûlumö™˚Mósuª_©åNum
 = ( (
ûlumö™˚Mósuª_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/measument_sensing/zcl_occupancy_sensing.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_OCCUPANCY_SENSING


49 
_CODE_ZCL_
 
°©us_t
 
	$z˛_occu∑ncySísög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

51  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_MS_OCCUPANCY_SENSING
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

52 
	}
}

	@zigbee/zcl/measument_sensing/zcl_occupancy_sensing.h

24 #i‚de‡
ZCL_OCCUPANCY_SENSING_H


25 
	#ZCL_OCCUPANCY_SENSING_H


	)

48 
	#ZCL_ATTRID_OCCUPANCY
 0x0000

	)

49 
	#ZCL_ATTRID_OCCUPANCY_SENSOR_TYPE
 0x0001

	)

50 
	#ZCL_ATTRID_PIR_OCCU2UNOCCU_DELAY
 0x0010

	)

51 
	#ZCL_ATTRID_PIR_UNOCCU2OCCU_DELAY
 0x0011

	)

52 
	#ZCL_ATTRID_PIR_UNOCCU2OCCU_THRES
 0x0012

	)

53 
	#ZCL_ATTRID_ULTRA_OCCU2UNOCCU_DELAY
 0x0020

	)

54 
	#ZCL_ATTRID_ULTRA_UNOCCU2OCCU_DELAY
 0x0021

	)

55 
	#ZCL_ATTRID_ULTRA_UNOCCU2OCCU_THRES
 0x0022

	)

75 
°©us_t
 
z˛_occu∑ncySísög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/measument_sensing/zcl_occupancy_sensing_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_OCCUPANCY_SENSING


47 
u8
 
	gz˛_©å_occup
 = 0;

48 
u8
 
	gz˛_©å_occupSís‹Ty≥
 = 0;

49 
u16
 
	gz˛_©å_púOccu2UncoouD
 = 0;

50 
u16
 
	gz˛_©å_púUnoccu2OccuD
 = 0;

51 
u8
 
	gz˛_©å_púUnoccu2OccuT
 = 1;

52 
u16
 
	gz˛_©å_u…øOccu2UncoouD
 = 0;

53 
u16
 
	gz˛_©å_u…øUnoccu2OccuD
 = 0;

54 
u8
 
	gz˛_©å_u…øUnoccu2OccuT
 = 1;

57 c⁄° 
z˛AârInfo_t
 
	goccu∑ncy_©åTbl
[] =

59 #ifde‡
ZCL_ATTR_OCCUPANCY_ENABLE


60 { 
ZCL_ATTRID_OCCUPANCY
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_occup
},

62 #ifde‡
ZCL_ATTR_OCCUPANCY_SENSOR_TYPE_ENABLE


63 { 
ZCL_ATTRID_OCCUPANCY_SENSOR_TYPE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_occupSís‹Ty≥
},

66 #ifde‡
ZCL_ATTR_PIR_OCCU2UNOCCU_DELAY_ENABLE


67 { 
ZCL_ATTRID_PIR_OCCU2UNOCCU_DELAY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_púOccu2UncoouD
},

69 #ifde‡
ZCL_ATTR_PIR_UNOCCU2OCCU_DELAY_ENABLE


70 { 
ZCL_ATTRID_PIR_UNOCCU2OCCU_DELAY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_púUnoccu2OccuD
},

72 #ifde‡
ZCL_ATTR_PIR_UNOCCU2OCCU_THRES_ENABLE


73 { 
ZCL_ATTRID_PIR_UNOCCU2OCCU_THRES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_púUnoccu2OccuT
},

76 #ifde‡
ZCL_ATTR_ULTRA_OCCU2UNOCCU_DELAY_ENABLE


77 { 
ZCL_ATTRID_ULTRA_OCCU2UNOCCU_DELAY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_u…øOccu2UncoouD
},

79 #ifde‡
ZCL_ATTR_ULTRA_UNOCCU2OCCU_DELAY_ENABLE


80 { 
ZCL_ATTRID_ULTRA_UNOCCU2OCCU_DELAY
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_u…øUnoccu2OccuD
},

82 #ifde‡
ZCL_ATTR_ULTRA_UNOCCU2OCCU_THRES_ENABLE


83 { 
ZCL_ATTRID_ULTRA_UNOCCU2OCCU_THRES
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_u…øUnoccu2OccuT
},

85 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

88 c⁄° 
u8
 
	gz˛_occu∑ncy_©åNum
 = ( (
occu∑ncy_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/measument_sensing/zcl_temperature_measurement.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT


50 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ãm≥øtuª_mósuªmít_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

52  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_MS_TEMPERATURE_MEASUREMENT
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
NULL
, 
cb
);

53 
	}
}

	@zigbee/zcl/measument_sensing/zcl_temperature_measurement.h

24 #i‚de‡
ZCL_TEMPERATURE_MEASUREMENT_H


25 
	#ZCL_TEMPERATURE_MEASUREMENT_H


	)

36 
	#ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MEASUREDVALUE
 0x0000

	)

37 
	#ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MINMEASUREDVALUE
 0x0001

	)

38 
	#ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MAXMEASUREDVALUE
 0x0002

	)

39 
	#ZCL_TEMPERATURE_MEASUREMENT_ATTRID_TOLERANCE
 0x0003

	)

43 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MEASUREDVALUE_ENABLE


44 
s16
 
z˛_©å_MósuªdVÆue
;

46 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MINMEASUREDVALUE_ENABLE


47 
s16
 
z˛_©å_MöMósuªdVÆue
;

49 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MAXMEASUREDVALUE_ENABLE


50 
s16
 
z˛_©å_MaxMósuªdVÆue
;

52 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_TOLERANCE_ENABLE


53 
u16
 
z˛_©å_Tﬁî™˚
;

56 c⁄° 
z˛AârInfo_t
 
ãm≥øtuª_mósuªmít_©åTbl
[];

57 c⁄° 
u8
 
z˛_ãm≥øtuª_mósuªmít_©åNum
;

61 
°©us_t
 
z˛_ãm≥øtuª_mósuªmít_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

	@zigbee/zcl/measument_sensing/zcl_temperature_measurement_attr.c

29 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT


47 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MEASUREDVALUE_ENABLE


48 
s16
 
	gz˛_©å_MósuªdVÆue
 = 0xFFFF;

50 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MINMEASUREDVALUE_ENABLE


51 
s16
 
	gz˛_©å_MöMósuªdVÆue
 = 0x8000;

53 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MAXMEASUREDVALUE_ENABLE


54 
s16
 
	gz˛_©å_MaxMósuªdVÆue
 = 0x8000;

56 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_TOLERANCE_ENABLE


57 
u16
 
	gz˛_©å_Tﬁî™˚
 = 0;

60 c⁄° 
z˛AârInfo_t
 
	gãm≥øtuª_mósuªmít_©åTbl
[] =

62 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MEASUREDVALUE_ENABLE


63 { 
ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MEASUREDVALUE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_REPORTABLE
, (
u8
*)&
z˛_©å_MósuªdVÆue
},

65 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MINMEASUREDVALUE_ENABLE


66 { 
ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MINMEASUREDVALUE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_MöMósuªdVÆue
},

68 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_MAXMEASUREDVALUE_ENABLE


69 { 
ZCL_TEMPERATURE_MEASUREMENT_ATTRID_MAXMEASUREDVALUE
, 
ZCL_DATA_TYPE_INT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_MaxMósuªdVÆue
},

71 #ifde‡
ZCL_TEMPERATURE_MEASUREMENT_ATTR_TOLERANCE_ENABLE


72 { 
ZCL_TEMPERATURE_MEASUREMENT_ATTRID_TOLERANCE
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_Tﬁî™˚
},

74 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

77 c⁄° 
u8
 
	gz˛_ãm≥øtuª_mósuªmít_©åNum
 = ( (
ãm≥øtuª_mósuªmít_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/ota_upgrading/zcl_ota.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_OTA


49 
°©us_t
 
z˛_Ÿa_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

51 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

53  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_OTA
, 
m™uCode
, 
¨πNum
, 
©åTbl
, 
z˛_Ÿa_cmdH™dÀr
, 
cb
);

54 
	}
}

56 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageNŸifySíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageNŸify_t
 *
pReq
)

58 
u8
 
buf
[10];

59 
u8
 *
pBuf
 = 
buf
;

61 *
pBuf
++ = 
pReq
->
∑ylﬂdTy≥
;

62 *
pBuf
++ = 
pReq
->
quîyJôãr
;

63 if(
pReq
->
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERT_JITTER_MFG
){

64 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

65 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

67 if(
pReq
->
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE
){

68 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

69 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

71 if(
pReq
->
∑ylﬂdTy≥
 =
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE_VER
){

72 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
√wFûeVî
);

73 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
√wFûeVî
);

74 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
√wFûeVî
);

75 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
√wFûeVî
);

78  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_IMAGE_NOTIFY
, 
TRUE
,

79 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

80 
	}
}

82 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyNextImageReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyNextImageReq_t
 *
pReq
)

84 
u8
 
buf
[11];

85 
u8
 *
pBuf
 = 
buf
;

87 *
pBuf
++ = 
pReq
->
fc
;

88 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

89 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

90 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

91 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

92 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
curFûeVî
);

93 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
curFûeVî
);

94 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
curFûeVî
);

95 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
curFûeVî
);

96 if(
pReq
->
fc
 & 
IMAGE_FC_BITMASK_HARDWARE_VERSION_PRESENT
){

97 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
hdrw¨eVî
);

98 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
hdrw¨eVî
);

101  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_REQ
, 
TRUE
,

102 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

103 
	}
}

105 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyNextImageR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyNextImageR•_t
 *
pR•
)

107 
u8
 
buf
[13];

108 
u8
 *
pBuf
 = 
buf
;

110 *
pBuf
++ = 
pR•
->
°
;

111 if(
pR•
->
°
 =
ZCL_STA_SUCCESS
){

112 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
m™uCode
);

113 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
m™uCode
);

114 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
imageTy≥
);

115 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
imageTy≥
);

116 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
fûeVî
);

117 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
fûeVî
);

118 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
fûeVî
);

119 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
fûeVî
);

120 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
imageSize
);

121 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
imageSize
);

122 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
imageSize
);

123 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
imageSize
);

126  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_RSP
, 
TRUE
,

127 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

128 
	}
}

130 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageBlockReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageBlockReq_t
 *
pReq
)

132 
u8
 
buf
[24];

133 
u8
 *
pBuf
 = 
buf
;

135 *
pBuf
++ = 
pReq
->
fc
;

136 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

137 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

138 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

139 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

140 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeVî
);

141 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeVî
);

142 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeVî
);

143 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeVî
);

144 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeOff£t
);

145 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeOff£t
);

146 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeOff£t
);

147 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeOff£t
);

148 *
pBuf
++ = 
pReq
->
maxD©aSize
;

149 if(
pReq
->
fc
 & 
BLOCK_FC_BITMASK_NODE_IEEE_PRESENT
){

150 
	`ZB_IEEE_ADDR_COPY
(
pBuf
, 
pReq
->
ªqNodeAddr
);

151 
pBuf
 +
EXT_ADDR_LEN
;

153 if(
pReq
->
fc
 & 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
){

154 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
blockReqDñay
);

155 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
blockReqDñay
);

158  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_IMAGE_BLOCK_REQ
, 
TRUE
,

159 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

160 
	}
}

162 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imagePageReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imagePageReq_t
 *
pReq
)

164 
u8
 
buf
[26];

165 
u8
 *
pBuf
 = 
buf
;

167 *
pBuf
++ = 
pReq
->
fc
;

168 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

169 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

170 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

171 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

172 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeVî
);

173 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeVî
);

174 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeVî
);

175 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeVî
);

176 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeOff£t
);

177 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeOff£t
);

178 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeOff£t
);

179 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeOff£t
);

180 *
pBuf
++ = 
pReq
->
maxD©aSize
;

181 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
∑geSize
);

182 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
∑geSize
);

183 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
r•S∑cög
);

184 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
r•S∑cög
);

185 if(
pReq
->
fc
 & 
PAGE_FC_BITMASK_NODE_IEEE_PRESENT
){

186 
	`ZB_IEEE_ADDR_COPY
(
pBuf
, 
pReq
->
ªqNodeAddr
);

187 
pBuf
 +
EXT_ADDR_LEN
;

190  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_IMAGE_PAGE_REQ
, 
TRUE
,

191 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

192 
	}
}

194 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageBlockR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageBlockR•_t
 *
pR•
)

196 
u8
 
Àn
 = 0;

198 if(
pR•
->
°
 =
ZCL_STA_SUCCESS
){

199 
Àn
 = 14 + 
pR•
->
r•
.
suc˚ss
.
d©aSize
;

200 }if(
pR•
->
°
 =
ZCL_STA_WAIT_FOR_DATA
){

201 
Àn
 = 11;

203 
Àn
 = 1;

206 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

207 if(!
buf
){

208  
ZCL_STA_INSUFFICIENT_SPACE
;

211 
u8
 *
pBuf
 = 
buf
;

213 *
pBuf
++ = 
pR•
->
°
;

214 if(
pR•
->
°
 =
ZCL_STA_SUCCESS
){

215 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
r•
.
suc˚ss
.
m™uCode
);

216 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
r•
.
suc˚ss
.
m™uCode
);

217 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
r•
.
suc˚ss
.
imageTy≥
);

218 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
r•
.
suc˚ss
.
imageTy≥
);

219 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
r•
.
suc˚ss
.
fûeVî
);

220 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
r•
.
suc˚ss
.
fûeVî
);

221 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
r•
.
suc˚ss
.
fûeVî
);

222 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
r•
.
suc˚ss
.
fûeVî
);

223 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
r•
.
suc˚ss
.
fûeOff£t
);

224 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
r•
.
suc˚ss
.
fûeOff£t
);

225 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
r•
.
suc˚ss
.
fûeOff£t
);

226 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
r•
.
suc˚ss
.
fûeOff£t
);

227 *
pBuf
++ = 
pR•
->
r•
.
suc˚ss
.
d©aSize
;

228 
	`mem˝y
(
pBuf
, 
pR•
->
r•
.
suc˚ss
.
d©a
,ÖR•->r•.suc˚ss.
d©aSize
);

229 }if(
pR•
->
°
 =
ZCL_STA_WAIT_FOR_DATA
){

230 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
r•
.
waô
.
cuºTime
);

231 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
r•
.
waô
.
cuºTime
);

232 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
r•
.
waô
.
cuºTime
);

233 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
r•
.
waô
.
cuºTime
);

234 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
r•
.
waô
.
ªqTime
);

235 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
r•
.
waô
.
ªqTime
);

236 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
r•
.
waô
.
ªqTime
);

237 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
r•
.
waô
.
ªqTime
);

238 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
r•
.
waô
.
blockReqDñay
);

239 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
r•
.
waô
.
blockReqDñay
);

242 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_IMAGE_BLOCK_RSP
, 
TRUE
,

243 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

245 
	`ev_buf_‰ì
(
buf
);

247  
ZCL_STA_SUCCESS
;

248 
	}
}

250 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_upgødeEndReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_upgødeEndReq_t
 *
pReq
)

252 
u8
 
buf
[9];

253 
u8
 *
pBuf
 = 
buf
;

255 *
pBuf
++ = 
pReq
->
°
;

256 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

257 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

258 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

259 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

260 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeVî
);

261 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeVî
);

262 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeVî
);

263 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeVî
);

265  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_UPGRADE_END_REQ
, 
TRUE
,

266 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

267 
	}
}

269 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_upgødeEndR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_upgødeEndR•_t
 *
pR•
)

271 
u8
 
buf
[16];

272 
u8
 *
pBuf
 = 
buf
;

274 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
m™uCode
);

275 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
m™uCode
);

276 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
imageTy≥
);

277 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
imageTy≥
);

278 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
fûeVî
);

279 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
fûeVî
);

280 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
fûeVî
);

281 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
fûeVî
);

282 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
cuºítTime
);

283 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
cuºítTime
);

284 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
cuºítTime
);

285 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
cuºítTime
);

286 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
upgødeTime
);

287 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
upgødeTime
);

288 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
upgødeTime
);

289 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
upgødeTime
);

291  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_UPGRADE_END_RSP
, 
TRUE
,

292 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

293 
	}
}

295 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyDevS≥cFûeReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyS≥cFûeReq_t
 *
pReq
)

297 
u8
 
buf
[18];

298 
u8
 *
pBuf
 = 
buf
;

300 
	`ZB_IEEE_ADDR_COPY
(
pBuf
, 
pReq
->
ªqNodeAddr
);

301 
pBuf
 +
EXT_ADDR_LEN
;

302 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
m™uCode
);

303 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
m™uCode
);

304 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
imageTy≥
);

305 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
imageTy≥
);

306 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
fûeVî
);

307 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
fûeVî
);

308 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
fûeVî
);

309 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
fûeVî
);

310 *
pBuf
++ = 
	`LO_UINT16
(
pReq
->
zbSèckVî
);

311 *
pBuf
++ = 
	`HI_UINT16
(
pReq
->
zbSèckVî
);

313  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_REQ
, 
TRUE
,

314 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

315 
	}
}

317 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyDevS≥cFûeR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyS≥cFûeR•_t
 *
pR•
)

319 
u8
 
buf
[13];

320 
u8
 *
pBuf
 = 
buf
;

322 *
pBuf
++ = 
pR•
->
°
;

323 if(
pR•
->
°
 =
ZCL_STA_SUCCESS
){

324 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
m™uCode
);

325 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
m™uCode
);

326 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
imageTy≥
);

327 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
imageTy≥
);

328 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
fûeVî
);

329 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
fûeVî
);

330 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
fûeVî
);

331 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
fûeVî
);

332 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
imageSize
);

333 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
imageSize
);

334 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
imageSize
);

335 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
imageSize
);

338  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_OTA
, 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_RSP
, 
TRUE
,

339 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

340 
	}
}

342 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyNextImageReqPrc
(
z˛Incomög_t
 *
pInMsg
)

344 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

346 
u8
 *
pD©a
 = 
pInMsg
->pData;

348 if(
pInMsg
->
˛u°îAµCb
){

349 
Ÿa_quîyNextImageReq_t
 
ªq
;

350 
ªq
.
fc
 = *
pD©a
++;

351 
ªq
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

352 
pD©a
 += 2;

353 
ªq
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

354 
pD©a
 += 2;

355 
ªq
.
curFûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

356 
pD©a
 += 4;

357 if(
ªq
.
fc
 & 
IMAGE_FC_BITMASK_HARDWARE_VERSION_PRESENT
){

358 
ªq
.
hdrw¨eVî
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

361 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªq
);

363 
°©us
 = 
ZCL_STA_FAILURE
;

366  
°©us
;

367 
	}
}

369 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageBlockReqPrc
(
z˛Incomög_t
 *
pInMsg
)

371 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

373 
u8
 *
pD©a
 = 
pInMsg
->pData;

375 if(
pInMsg
->
˛u°îAµCb
){

376 
Ÿa_imageBlockReq_t
 
ªq
;

377 
ªq
.
fc
 = *
pD©a
++;

378 
ªq
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

379 
pD©a
 += 2;

380 
ªq
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

381 
pD©a
 += 2;

382 
ªq
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

383 
pD©a
 += 4;

384 
ªq
.
fûeOff£t
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

385 
pD©a
 += 4;

386 
ªq
.
maxD©aSize
 = *
pD©a
++;

387 if(
ªq
.
fc
 & 
BLOCK_FC_BITMASK_NODE_IEEE_PRESENT
){

388 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
ªqNodeAddr
, 
pD©a
);

389 
pD©a
 +
EXT_ADDR_LEN
;

391 if(
ªq
.
fc
 & 
BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
){

392 
ªq
.
blockReqDñay
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

395 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªq
);

397 
°©us
 = 
ZCL_STA_FAILURE
;

400  
°©us
;

401 
	}
}

403 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imagePageReqPrc
(
z˛Incomög_t
 *
pInMsg
)

405 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

407 
u8
 *
pD©a
 = 
pInMsg
->pData;

409 if(
pInMsg
->
˛u°îAµCb
){

410 
Ÿa_imagePageReq_t
 
ªq
;

411 
ªq
.
fc
 = *
pD©a
++;

412 
ªq
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

413 
pD©a
 += 2;

414 
ªq
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

415 
pD©a
 += 2;

416 
ªq
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

417 
pD©a
 += 4;

418 
ªq
.
fûeOff£t
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

419 
pD©a
 += 4;

420 
ªq
.
maxD©aSize
 = *
pD©a
++;

421 
ªq
.
∑geSize
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

422 
pD©a
 += 2;

423 
ªq
.
r•S∑cög
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

424 
pD©a
 += 2;

425 if(
ªq
.
fc
 & 
PAGE_FC_BITMASK_NODE_IEEE_PRESENT
){

426 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
ªqNodeAddr
, 
pD©a
);

427 
pD©a
 +
EXT_ADDR_LEN
;

430 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªq
);

432 
°©us
 = 
ZCL_STA_FAILURE
;

435  
°©us
;

436 
	}
}

438 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_upgødeEndReqPrc
(
z˛Incomög_t
 *
pInMsg
)

440 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

442 
u8
 *
pD©a
 = 
pInMsg
->pData;

444 if(
pInMsg
->
˛u°îAµCb
){

445 
Ÿa_upgødeEndReq_t
 
ªq
;

446 
ªq
.
°
 = *
pD©a
++;

447 if(
ªq
.
°
 =
ZCL_STA_SUCCESS
){

448 
ªq
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

449 
pD©a
 += 2;

450 
ªq
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

451 
pD©a
 += 2;

452 
ªq
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

455 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªq
);

457 
°©us
 = 
ZCL_STA_FAILURE
;

460  
°©us
;

461 
	}
}

463 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyDevi˚S≥cificFûeReqPrc
(
z˛Incomög_t
 *
pInMsg
)

465 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

467 
u8
 *
pD©a
 = 
pInMsg
->pData;

469 if(
pInMsg
->
˛u°îAµCb
){

470 
Ÿa_quîyS≥cFûeReq_t
 
ªq
;

471 
	`ZB_IEEE_ADDR_COPY
(
ªq
.
ªqNodeAddr
, 
pD©a
);

472 
pD©a
 +
EXT_ADDR_LEN
;

473 
ªq
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

474 
pD©a
 += 2;

475 
ªq
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

476 
pD©a
 += 2;

477 
ªq
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

478 
pD©a
 += 4;

479 
ªq
.
zbSèckVî
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

480 
pD©a
 += 2;

482 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªq
);

484 
°©us
 = 
ZCL_STA_FAILURE
;

487  
°©us
;

488 
	}
}

490 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageNŸifyPrc
(
z˛Incomög_t
 *
pInMsg
)

492 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

494 
u8
 *
pD©a
 = 
pInMsg
->pData;

496 if(
pInMsg
->
˛u°îAµCb
){

497 
Ÿa_imageNŸify_t
 
imageNŸify
;

498 
imageNŸify
.
∑ylﬂdTy≥
 = *
pD©a
++;

499 
imageNŸify
.
quîyJôãr
 = *
pD©a
++;

501 if(
imageNŸify
.
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERT_JITTER_MFG
){

502 
imageNŸify
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

503 
pD©a
 += 2;

505 if(
imageNŸify
.
∑ylﬂdTy≥
 >
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE
){

506 
imageNŸify
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

507 
pD©a
 += 2;

509 if(
imageNŸify
.
∑ylﬂdTy≥
 =
IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE_VER
){

510 
imageNŸify
.
√wFûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

513 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
imageNŸify
);

515 
°©us
 = 
ZCL_STA_FAILURE
;

518  
°©us
;

519 
	}
}

521 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyNextImageR•Prc
(
z˛Incomög_t
 *
pInMsg
)

523 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

525 
u8
 *
pD©a
 = 
pInMsg
->pData;

527 if(
pInMsg
->
˛u°îAµCb
){

528 
Ÿa_quîyNextImageR•_t
 
r•
;

529 
r•
.
°
 = *
pD©a
++;

530 if(
r•
.
°
 =
ZCL_STA_SUCCESS
){

531 
r•
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

532 
pD©a
 += 2;

533 
r•
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

534 
pD©a
 += 2;

535 
r•
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

536 
pD©a
 += 4;

537 
r•
.
imageSize
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

540 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
r•
);

542 
°©us
 = 
ZCL_STA_FAILURE
;

545  
°©us
;

546 
	}
}

548 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_imageBlockR•Prc
(
z˛Incomög_t
 *
pInMsg
)

550 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

552 
u8
 *
pD©a
 = 
pInMsg
->pData;

554 if(
pInMsg
->
˛u°îAµCb
){

555 
Ÿa_imageBlockR•_t
 
r•
;

556 
r•
.
°
 = *
pD©a
++;

557 if(
r•
.
°
 =
ZCL_STA_SUCCESS
){

558 
r•
.r•.
suc˚ss
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

559 
pD©a
 += 2;

560 
r•
.r•.
suc˚ss
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

561 
pD©a
 += 2;

562 
r•
.r•.
suc˚ss
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

563 
pD©a
 += 4;

564 
r•
.r•.
suc˚ss
.
fûeOff£t
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

565 
pD©a
 += 4;

566 
r•
.r•.
suc˚ss
.
d©aSize
 = *
pD©a
++;

567 
r•
.r•.
suc˚ss
.
d©a
 = 
pD©a
;

568 }if(
r•
.
°
 =
ZCL_STA_WAIT_FOR_DATA
){

569 
r•
.r•.
waô
.
cuºTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

570 
pD©a
 += 4;

571 
r•
.r•.
waô
.
ªqTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

572 
pD©a
 += 4;

573 
r•
.r•.
waô
.
blockReqDñay
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

576 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
r•
);

578 
°©us
 = 
ZCL_STA_FAILURE
;

581  
°©us
;

582 
	}
}

584 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_upgødeEndR•Prc
(
z˛Incomög_t
 *
pInMsg
)

586 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

588 
u8
 *
pD©a
 = 
pInMsg
->pData;

590 if(
pInMsg
->
˛u°îAµCb
){

591 
Ÿa_upgødeEndR•_t
 
r•
;

592 
r•
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

593 
pD©a
 += 2;

594 
r•
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

595 
pD©a
 += 2;

596 
r•
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

597 
pD©a
 += 4;

598 
r•
.
cuºítTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

599 
pD©a
 += 4;

600 
r•
.
upgødeTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

602 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
r•
);

604 
°©us
 = 
ZCL_STA_FAILURE
;

607  
°©us
;

608 
	}
}

610 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_quîyDevi˚S≥cificFûeR•Prc
(
z˛Incomög_t
 *
pInMsg
)

612 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

614 
u8
 *
pD©a
 = 
pInMsg
->pData;

616 if(
pInMsg
->
˛u°îAµCb
){

617 
Ÿa_quîyS≥cFûeR•_t
 
r•
;

618 
r•
.
°
 = *
pD©a
++;

619 if(
r•
.
°
 =
ZCL_STA_SUCCESS
){

620 
r•
.
m™uCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

621 
pD©a
 += 2;

622 
r•
.
imageTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

623 
pD©a
 += 2;

624 
r•
.
fûeVî
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

625 
pD©a
 += 4;

626 
r•
.
imageSize
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

629 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
r•
);

631 
°©us
 = 
ZCL_STA_FAILURE
;

634  
°©us
;

635 
	}
}

637 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

639 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

641 
pInMsg
->
hdr
.
cmd
)

643 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_REQ
:

644 
°©us
 = 
	`z˛_Ÿa_quîyNextImageReqPrc
(
pInMsg
);

646 
ZCL_CMD_OTA_IMAGE_BLOCK_REQ
:

647 
°©us
 = 
	`z˛_Ÿa_imageBlockReqPrc
(
pInMsg
);

649 
ZCL_CMD_OTA_IMAGE_PAGE_REQ
:

650 
°©us
 = 
	`z˛_Ÿa_imagePageReqPrc
(
pInMsg
);

652 
ZCL_CMD_OTA_UPGRADE_END_REQ
:

653 
°©us
 = 
	`z˛_Ÿa_upgødeEndReqPrc
(
pInMsg
);

655 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_REQ
:

656 
°©us
 = 
	`z˛_Ÿa_quîyDevi˚S≥cificFûeReqPrc
(
pInMsg
);

659 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

663  
°©us
;

664 
	}
}

666 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

668 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

670 
pInMsg
->
hdr
.
cmd
)

672 
ZCL_CMD_OTA_IMAGE_NOTIFY
:

673 
°©us
 = 
	`z˛_Ÿa_imageNŸifyPrc
(
pInMsg
);

675 
ZCL_CMD_OTA_QUERY_NEXT_IMAGE_RSP
:

676 
°©us
 = 
	`z˛_Ÿa_quîyNextImageR•Prc
(
pInMsg
);

678 
ZCL_CMD_OTA_IMAGE_BLOCK_RSP
:

679 
°©us
 = 
	`z˛_Ÿa_imageBlockR•Prc
(
pInMsg
);

681 
ZCL_CMD_OTA_UPGRADE_END_RSP
:

682 
°©us
 = 
	`z˛_Ÿa_upgødeEndR•Prc
(
pInMsg
);

684 
ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_RSP
:

685 
°©us
 = 
	`z˛_Ÿa_quîyDevi˚S≥cificFûeR•Prc
(
pInMsg
);

688 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

692  
°©us
;

693 
	}
}

695 
_CODE_ZCL_
 
°©us_t
 
	$z˛_Ÿa_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

697 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

698  
	`z˛_Ÿa_˛õ¡CmdH™dÀr
(
pInMsg
);

700  
	`z˛_Ÿa_£rvîCmdH™dÀr
(
pInMsg
);

702 
	}
}

	@zigbee/zcl/ota_upgrading/zcl_ota.h

24 #i‚de‡
ZCL_OTA_H


25 
	#ZCL_OTA_H


	)

32 
	#ZCL_CMD_OTA_IMAGE_NOTIFY
 0x00

	)

33 
	#ZCL_CMD_OTA_QUERY_NEXT_IMAGE_REQ
 0x01

	)

34 
	#ZCL_CMD_OTA_QUERY_NEXT_IMAGE_RSP
 0x02

	)

35 
	#ZCL_CMD_OTA_IMAGE_BLOCK_REQ
 0x03

	)

36 
	#ZCL_CMD_OTA_IMAGE_PAGE_REQ
 0x04

	)

37 
	#ZCL_CMD_OTA_IMAGE_BLOCK_RSP
 0x05

	)

38 
	#ZCL_CMD_OTA_UPGRADE_END_REQ
 0x06

	)

39 
	#ZCL_CMD_OTA_UPGRADE_END_RSP
 0x07

	)

40 
	#ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_REQ
 0x08

	)

41 
	#ZCL_CMD_OTA_QUERY_DEVICE_SPECIFIC_FILE_RSP
 0x09

	)

46 
	#ZCL_ATTRID_OTA_UPGRADE_SERVER_ID
 0x0000

	)

47 
	#ZCL_ATTRID_OTA_FILE_OFFSET
 0x0001

	)

48 
	#ZCL_ATTRID_OTA_CURRENT_FILE_VER
 0x0002

	)

49 
	#ZCL_ATTRID_OTA_CURRENT_ZIGBEE_STACK_VER
 0x0003

	)

50 
	#ZCL_ATTRID_OTA_DOWNLOAD_FILE_VER
 0x0004

	)

51 
	#ZCL_ATTRID_OTA_DOWNLOAD_ZIGBEE_STACK_VER
 0x0005

	)

52 
	#ZCL_ATTRID_OTA_IMAGE_UPGRADE_STAUS
 0x0006

	)

53 
	#ZCL_ATTRID_OTA_MANUFACTURER_ID
 0x0007

	)

54 
	#ZCL_ATTRID_OTA_IMAGE_TYPE_ID
 0x0008

	)

55 
	#ZCL_ATTRID_OTA_MINIMUM_BLOCK_PERIOD
 0x0009

	)

56 
	#ZCL_ATTRID_OTA_IMAGE_STAMP
 0x000a

	)

61 
	#IMAGE_UPGRADE_STATUS_NORMAL
 0x00

	)

62 
	#IMAGE_UPGRADE_STATUS_DOWNLOAD_IN_PROGRESS
 0x01

	)

63 
	#IMAGE_UPGRADE_STATUS_DOWNLOAD_COMPLETE
 0x02

	)

64 
	#IMAGE_UPGRADE_STATUS_WAITING_TO_UPGRADE
 0x03

	)

65 
	#IMAGE_UPGRADE_STATUS_COUNT_DOWN
 0x04

	)

66 
	#IMAGE_UPGRADE_STATUS_WAIT_FOR_MORE
 0x05

	)

70 
	#IMAGE_FC_BITMASK_HARDWARE_VERSION_PRESENT
 0x01

	)

73 
	#BLOCK_FC_BITMASK_GENERIC
 0x00

	)

74 
	#BLOCK_FC_BITMASK_NODE_IEEE_PRESENT
 0x01

	)

75 
	#BLOCK_FC_BITMASK_MIN_PERIOD_PRESENT
 0x02

	)

78 
	#PAGE_FC_BITMASK_NODE_IEEE_PRESENT
 0x01

	)

81 
	#IMAGE_NOTIFY_QUERY_JITTER
 0x00

	)

82 
	#IMAGE_NOTIFY_QUERT_JITTER_MFG
 0x01

	)

83 
	#IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE
 0x02

	)

84 
	#IMAGE_NOTIFY_QUERY_JITTER_MFG_TYPE_VER
 0x03

	)

88 
u8
 
	m∑ylﬂdTy≥
;

89 
u8
 
	mquîyJôãr
;

90 
u16
 
	mm™uCode
;

91 
u16
 
	mimageTy≥
;

92 
u32
 
	m√wFûeVî
;

93 }
	tŸa_imageNŸify_t
;

96 
u8
 
	mfc
;

97 
u16
 
	mm™uCode
;

98 
u16
 
	mimageTy≥
;

99 
u32
 
	mcurFûeVî
;

100 
u16
 
	mhdrw¨eVî
;

101 }
	tŸa_quîyNextImageReq_t
;

104 
u8
 
	m°
;

105 
u16
 
	mm™uCode
;

106 
u16
 
	mimageTy≥
;

107 
u32
 
	mfûeVî
;

108 
u32
 
	mimageSize
;

109 }
	tŸa_quîyNextImageR•_t
;

112 
u8
 
	mfc
;

113 
u16
 
	mm™uCode
;

114 
u16
 
	mimageTy≥
;

115 
u32
 
	mfûeVî
;

116 
u32
 
	mfûeOff£t
;

117 
u8
 
	mmaxD©aSize
;

118 
addrExt_t
 
	mªqNodeAddr
;

119 
u16
 
	mblockReqDñay
;

120 }
	tŸa_imageBlockReq_t
;

123 
u8
 
	mfc
;

124 
u16
 
	mm™uCode
;

125 
u16
 
	mimageTy≥
;

126 
u32
 
	mfûeVî
;

127 
u32
 
	mfûeOff£t
;

128 
u8
 
	mmaxD©aSize
;

129 
u16
 
	m∑geSize
;

130 
u16
 
	mr•S∑cög
;

131 
addrExt_t
 
	mªqNodeAddr
;

132 }
	tŸa_imagePageReq_t
;

135 
u8
 
	m°
;

136 
u16
 
	mm™uCode
;

137 
u16
 
	mimageTy≥
;

138 
u32
 
	mfûeVî
;

139 }
	tŸa_upgødeEndReq_t
;

142 
u16
 
	mm™uCode
;

143 
u16
 
	mimageTy≥
;

144 
u32
 
	mfûeVî
;

145 
u32
 
	mcuºítTime
;

146 
u32
 
	mupgødeTime
;

147 }
	tŸa_upgødeEndR•_t
;

150 
addrExt_t
 
	mªqNodeAddr
;

151 
u16
 
	mm™uCode
;

152 
u16
 
	mimageTy≥
;

153 
u32
 
	mfûeVî
;

154 
u16
 
	mzbSèckVî
;

155 }
	tŸa_quîyS≥cFûeReq_t
;

158 
u8
 
	m°
;

159 
u16
 
	mm™uCode
;

160 
u16
 
	mimageTy≥
;

161 
u32
 
	mfûeVî
;

162 
u32
 
	mimageSize
;

163 }
	tŸa_quîyS≥cFûeR•_t
;

166 
u16
 
	mm™uCode
;

167 
u16
 
	mimageTy≥
;

168 
u32
 
	mfûeVî
;

169 
u32
 
	mfûeOff£t
;

170 
u8
 
	md©aSize
;

171 
u8
 *
	md©a
;

172 }
	tŸa_imageBlcokR•Suc˚ss_t
;

175 
u32
 
	mcuºTime
;

176 
u32
 
	mªqTime
;

177 
u16
 
	mblockReqDñay
;

178 }
	tŸa_imageBlcokR•Waô_t
;

181 
Ÿa_imageBlcokR•Suc˚ss_t
 
	msuc˚ss
;

182 
Ÿa_imageBlcokR•Waô_t
 
	mwaô
;

183 }
	timageBlockR•_t
;

186 
u8
 
	m°
;

187 
imageBlockR•_t
 
	mr•
;

188 }
	tŸa_imageBlockR•_t
;

194 
	$°©us_t
 (*
	tz˛_Ÿa_imageNŸifyCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_imageNŸify_t
 *
	tpImageNŸify
);

195 
	$°©us_t
 (*
	tz˛_Ÿa_quîyNextImageReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_quîyNextImageReq_t
 *
	tpQuîyNextImageReq
);

196 
	$°©us_t
 (*
	tz˛_Ÿa_quîyNextImageR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_quîyNextImageR•_t
 *
	tpQuîyNextImageR•
);

197 
	$°©us_t
 (*
	tz˛_Ÿa_imageBlockReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_imageBlockReq_t
 *
	tpImageBlockReq
);

198 
	$°©us_t
 (*
	tz˛_Ÿa_imagePageReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_imagePageReq_t
 *
	tpImagePageReq
);

199 
	$°©us_t
 (*
	tz˛_Ÿa_imageBlockR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_imageBlockR•_t
 *
	tpImageBlockR•
);

200 
	$°©us_t
 (*
	tz˛_Ÿa_upgødeEndReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_upgødeEndReq_t
 *
	tpUpgødeEndReq
);

201 
	$°©us_t
 (*
	tz˛_Ÿa_upgødeEndR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_upgødeEndR•_t
 *
	tpUpgødeEndR•
);

202 
	$°©us_t
 (*
	tz˛_Ÿa_quîyDevS≥cFûeReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_quîyS≥cFûeReq_t
 *
	tpQuîyDevS≥cFûeReq
);

203 
	$°©us_t
 (*
	tz˛_Ÿa_quîyDevS≥cFûeR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tŸa_quîyS≥cFûeR•_t
 *
	tpQuîyDevS≥cFûeR•
);

210 
z˛_Ÿa_imageNŸifyCb_t
 
imageNŸifyCbFunc
;

211 
z˛_Ÿa_quîyNextImageReqCb_t
 
quîyNextImageReqCbFunc
;

212 
z˛_Ÿa_quîyNextImageR•Cb_t
 
quîyNextImageR•CbFunc
;

213 
z˛_Ÿa_imageBlockReqCb_t
 
imageBlockReqCbFunc
;

214 
z˛_Ÿa_imagePageReqCb_t
 
imagePageReqCbFunc
;

215 
z˛_Ÿa_imageBlockR•Cb_t
 
imageBlockR•CbFunc
;

216 
z˛_Ÿa_upgødeEndReqCb_t
 
upgødeEndReqCbFunc
;

217 
z˛_Ÿa_upgødeEndR•Cb_t
 
upgødeEndR•CbFunc
;

218 
z˛_Ÿa_quîyDevS≥cFûeReqCb_t
 
quîyDevS≥cFûeReqCbFunc
;

219 
z˛_Ÿa_quîyDevS≥cFûeR•Cb_t
 
quîyDevS≥cFûeR•CbFunc
;

220 }
	tz˛_Ÿa_AµCÆlbacks_t
;

226 
addrExt_t
 
z˛_©å_upgødeSîvîID
;

227 
u32
 
z˛_©å_fûeOff£t
;

228 
u32
 
z˛_©å_cuºFûeVî
;

229 
u16
 
z˛_©å_cuºZigbìSèckVî
;

230 
u32
 
z˛_©å_dow∆ﬂdFûeVî
;

231 
u16
 
z˛_©å_dow∆ﬂdZigbìSèckVî
;

232 
u8
 
z˛_©å_imageUpgødeSètus
;

233 
u16
 
z˛_©å_m™uÁ˘uªrID
;

234 
u16
 
z˛_©å_imageTy≥ID
;

235 
u16
 
z˛_©å_möBlockPîiod
;

241 c⁄° 
z˛AârInfo_t
 
Ÿa_©åTbl
[];

242 c⁄° 
u8
 
z˛_Ÿa_©åNum
;

245 
°©us_t
 
	`z˛_Ÿa_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
¨πNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

247 
°©us_t
 
	`z˛_Ÿa_imageNŸifySíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageNŸify_t
 *
pReq
);

248 
	#z˛_Ÿa_imageNŸifyCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Ÿa_imageNŸifySíd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

250 
°©us_t
 
	`z˛_Ÿa_quîyNextImageReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyNextImageReq_t
 *
pReq
);

251 
	#z˛_Ÿa_quîyNextImageReqCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Ÿa_quîyNextImageReqSíd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

253 
°©us_t
 
	`z˛_Ÿa_quîyNextImageR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyNextImageR•_t
 *
pR•
);

254 
	#z˛_Ÿa_quîyNextImageR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_Ÿa_quîyNextImageR•Síd
(◊), (b), (c), (d), (e)))

	)

256 
°©us_t
 
	`z˛_Ÿa_imageBlockReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageBlockReq_t
 *
pReq
);

257 
	#z˛_Ÿa_imageBlockReqCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Ÿa_imageBlockReqSíd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

259 
°©us_t
 
	`z˛_Ÿa_imagePageReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imagePageReq_t
 *
pReq
);

261 
°©us_t
 
	`z˛_Ÿa_imageBlockR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_imageBlockR•_t
 *
pR•
);

262 
	#z˛_Ÿa_imageBlockR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_Ÿa_imageBlockR•Síd
(◊), (b), (c), (d), (e)))

	)

264 
°©us_t
 
	`z˛_Ÿa_upgødeEndReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_upgødeEndReq_t
 *
pReq
);

265 
	#z˛_Ÿa_upgødeEndReqCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_Ÿa_upgødeEndReqSíd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

267 
°©us_t
 
	`z˛_Ÿa_upgødeEndR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_upgødeEndR•_t
 *
pR•
);

268 
	#z˛_Ÿa_upgødeEndR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_Ÿa_upgødeEndR•Síd
(◊), (b), (c), (d), (e)))

	)

270 
°©us_t
 
	`z˛_Ÿa_quîyDevS≥cFûeReqSíd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyS≥cFûeReq_t
 *
pReq
);

272 
°©us_t
 
	`z˛_Ÿa_quîyDevS≥cFûeR•Síd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
Ÿa_quîyS≥cFûeR•_t
 *
pR•
);

	@zigbee/zcl/ota_upgrading/zcl_ota_attr.c

27 
	~"../z˛_ö˛ude.h
"

43 #ifde‡
ZCL_OTA


46 
addrExt_t
 
	gz˛_©å_upgødeSîvîID
 = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

47 
u32
 
	gz˛_©å_fûeOff£t
 = 0xffffffff;

48 
u32
 
	gz˛_©å_cuºFûeVî
 = 0xffffffff;

49 
u16
 
	gz˛_©å_cuºZigbìSèckVî
 = 0xffff;

50 
u32
 
	gz˛_©å_dow∆ﬂdFûeVî
 = 0xffffffff;

51 
u16
 
	gz˛_©å_dow∆ﬂdZigbìSèckVî
 = 0xffff;

52 
u8
 
	gz˛_©å_imageUpgødeSètus
 = 0;

53 
u16
 
	gz˛_©å_m™uÁ˘uªrID
 = 0;

54 
u16
 
	gz˛_©å_imageTy≥ID
 = 0xffff;

55 
u16
 
	gz˛_©å_möBlockPîiod
 = 0;

59 c⁄° 
z˛AârInfo_t
 
	gŸa_©åTbl
[] =

61 { 
ZCL_ATTRID_OTA_UPGRADE_SERVER_ID
, 
ZCL_DATA_TYPE_IEEE_ADDR
,
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_upgødeSîvîID
 },

62 { 
ZCL_ATTRID_OTA_FILE_OFFSET
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_fûeOff£t
 },

63 { 
ZCL_ATTRID_OTA_CURRENT_FILE_VER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºFûeVî
 },

64 { 
ZCL_ATTRID_OTA_CURRENT_ZIGBEE_STACK_VER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºZigbìSèckVî
 },

65 { 
ZCL_ATTRID_OTA_DOWNLOAD_FILE_VER
, 
ZCL_DATA_TYPE_UINT32
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dow∆ﬂdFûeVî
 },

66 { 
ZCL_ATTRID_OTA_DOWNLOAD_ZIGBEE_STACK_VER
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dow∆ﬂdZigbìSèckVî
 },

67 { 
ZCL_ATTRID_OTA_IMAGE_UPGRADE_STAUS
, 
ZCL_DATA_TYPE_ENUM8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_imageUpgødeSètus
 },

68 { 
ZCL_ATTRID_OTA_MANUFACTURER_ID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_m™uÁ˘uªrID
 },

69 { 
ZCL_ATTRID_OTA_IMAGE_TYPE_ID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_imageTy≥ID
 },

70 { 
ZCL_ATTRID_OTA_MINIMUM_BLOCK_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_möBlockPîiod
 },

72 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

75 c⁄° 
u8
 
	gz˛_Ÿa_©åNum
 = ( (
Ÿa_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/security_safety/zcl_ias_ace.c

27 
	~"../z˛_ö˛ude.h
"

29 #ifde‡
ZCL_IAS_ACE


48 
°©us_t
 
z˛_üsA˚_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

50 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

52  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_üsA˚_cmdH™dÀr
, 
cb
);

53 
	}
}

56 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_¨mR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
¨mNŸifiˇti⁄
)

58 
u8
 
buf
[1];

60 
buf
[0] = 
¨mNŸifiˇti⁄
;

62  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_ARM_RESPONSE
, 
TRUE
,

63 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

64 
	}
}

66 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eIdM≠R•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 *
pZ⁄eIdM≠Se˘i⁄
)

68 
u8
 
buf
[32];

69 
u8
 *
pBuf
 = 
buf
;

71 
u8
 
i
 = 0; i < 16; i++){

72 *
pBuf
++ = 
pZ⁄eIdM≠Se˘i⁄
[1];

73 *
pBuf
++ = 
pZ⁄eIdM≠Se˘i⁄
[0];

74 
pZ⁄eIdM≠Se˘i⁄
 += 2;

77  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_ID_MAP_RESPONSE
, 
TRUE
,

78 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 32, (
u8
*)
buf
);

79 
	}
}

81 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eInfoR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëZ⁄eInfoR•_t
 *
pGëZ⁄eInfoR•
)

83 
u8
 
buf
[36];

84 
u8
 *
pBuf
 = 
buf
;

86 *
pBuf
++ = 
pGëZ⁄eInfoR•
->
z⁄eId
;

87 *
pBuf
++ = 
	`LO_UINT16
(
pGëZ⁄eInfoR•
->
z⁄eTy≥
);

88 *
pBuf
++ = 
	`HI_UINT16
(
pGëZ⁄eInfoR•
->
z⁄eTy≥
);

89 
	`mem˝y
(
pBuf
, 
pGëZ⁄eInfoR•
->
õìAddr
, 8);

90 
pBuf
 += 8;

91 *
pBuf
++ = 
pGëZ⁄eInfoR•
->
z⁄eLabñ
.
°rLí
;

92 if(
pGëZ⁄eInfoR•
->
z⁄eLabñ
.
°rLí
){

93 
	`mem˝y
(
pBuf
, 
pGëZ⁄eInfoR•
->
z⁄eLabñ
.
pSå
,ÖGëZ⁄eInfoR•->z⁄eLabñ.
°rLí
);

94 
pBuf
 +
pGëZ⁄eInfoR•
->
z⁄eLabñ
.
°rLí
;

97  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_INFORMATION_RESPONSE
, 
TRUE
,

98 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

99 
	}
}

101 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_z⁄eSètusCh™ged
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eSètusCh™ged_t
 *
pZ⁄eSètusCh™ged
)

103 
u8
 
buf
[29];

104 
u8
 *
pBuf
 = 
buf
;

106 *
pBuf
++ = 
pZ⁄eSètusCh™ged
->
z⁄eId
;

107 *
pBuf
++ = 
	`LO_UINT16
(
pZ⁄eSètusCh™ged
->
z⁄eSètus
);

108 *
pBuf
++ = 
	`HI_UINT16
(
pZ⁄eSètusCh™ged
->
z⁄eSètus
);

109 *
pBuf
++ = 
pZ⁄eSètusCh™ged
->
audibÀNŸifiˇti⁄
;

110 *
pBuf
++ = 
pZ⁄eSètusCh™ged
->
z⁄eLabñ
.
°rLí
;

111 if(
pZ⁄eSètusCh™ged
->
z⁄eLabñ
.
°rLí
){

112 
	`mem˝y
(
pBuf
, 
pZ⁄eSètusCh™ged
->
z⁄eLabñ
.
pSå
,ÖZ⁄eSètusCh™ged->z⁄eLabñ.
°rLí
);

113 
pBuf
 +
pZ⁄eSètusCh™ged
->
z⁄eLabñ
.
°rLí
;

116  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_ZONE_STATUS_CHANGED
, 
TRUE
,

117 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

118 
	}
}

120 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_∑√lSètusCh™ged
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
∑√lSètusCh™ged_t
 *
pP™ñSètusCh™ged
)

122 
u8
 
buf
[4];

124 
buf
[0] = 
pP™ñSètusCh™ged
->
∑√lSètus
;

125 
buf
[1] = 
pP™ñSètusCh™ged
->
£c⁄dsRemaöög
;

126 
buf
[2] = 
pP™ñSètusCh™ged
->
audibÀNŸifiˇti⁄
;

127 
buf
[3] = 
pP™ñSètusCh™ged
->
Æ¨mSètus
;

129  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_PANEL_STATUS_CHANGED
, 
TRUE
,

130 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 4, 
buf
);

131 
	}
}

133 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëP™ñSètusR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëP™ñSètusR•_t
 *
pGëP™ñSètusR•
)

135 
u8
 
buf
[4];

137 
buf
[0] = 
pGëP™ñSètusR•
->
∑√lSètus
;

138 
buf
[1] = 
pGëP™ñSètusR•
->
£c⁄dsRemaöög
;

139 
buf
[2] = 
pGëP™ñSètusR•
->
audibÀNŸifiˇti⁄
;

140 
buf
[3] = 
pGëP™ñSètusR•
->
∑√lSètus
;

142  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_PANEL_STATUS_RESPONSE
, 
TRUE
,

143 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 4, 
buf
);

144 
	}
}

146 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_£tBy∑s£dZ⁄eLi°
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
£tBy∑s£dZ⁄eLi°_t
 *
pSëBy∑s£dZ⁄eLi°
)

148 
u8
 
Àn
 = 1;

150 if(
pSëBy∑s£dZ⁄eLi°
->
numOfZ⁄es
){

151 
Àn
 +
pSëBy∑s£dZ⁄eLi°
->
numOfZ⁄es
;

154 
u8
 *
buf
 = 
	`ev_buf_Æloˇã
(
Àn
);

155 if(!
buf
){

156  
ZCL_STA_INSUFFICIENT_SPACE
;

159 
u8
 *
pBuf
 = 
buf
;

161 *
pBuf
++ = 
pSëBy∑s£dZ⁄eLi°
->
numOfZ⁄es
;

162 if(
pSëBy∑s£dZ⁄eLi°
->
numOfZ⁄es
){

163 
	`mem˝y
(
pBuf
, 
pSëBy∑s£dZ⁄eLi°
->
z⁄eIds
,ÖSëBy∑s£dZ⁄eLi°->
numOfZ⁄es
);

164 
pBuf
 +
pSëBy∑s£dZ⁄eLi°
->
numOfZ⁄es
;

167 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_SET_BYPASSED_ZONE_LIST
, 
TRUE
,

168 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

170 
	`ev_buf_‰ì
(
buf
);

172  
ZCL_STA_SUCCESS
;

173 
	}
}

175 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_by∑ssRe•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
by∑ssR•_t
 *
pBy∑ssR•
)

177 
u8
 
Àn
 = 1;

179 if(
pBy∑ssR•
->
numOfZ⁄es
){

180 
Àn
 +
pBy∑ssR•
->
numOfZ⁄es
;

183 
u8
 *
buf
 = 
	`ev_buf_Æloˇã
(
Àn
);

184 if(!
buf
){

185  
ZCL_STA_INSUFFICIENT_SPACE
;

188 
u8
 *
pBuf
 = 
buf
;

190 *
pBuf
++ = 
pBy∑ssR•
->
numOfZ⁄es
;

191 if(
pBy∑ssR•
->
numOfZ⁄es
){

192 
	`mem˝y
(
pBuf
, 
pBy∑ssR•
->
z⁄eIds
,ÖBy∑ssR•->
numOfZ⁄es
);

193 
pBuf
 +
pBy∑ssR•
->
numOfZ⁄es
;

196 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_BYPASS_RESPONSE
, 
TRUE
,

197 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

199 
	`ev_buf_‰ì
(
buf
);

201  
ZCL_STA_SUCCESS
;

202 
	}
}

204 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eSètusRe•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëZ⁄eSètusR•_t
 *
pGëZ⁄eSètusR•
)

206 
u8
 
Àn
 = 2;

208 if(
pGëZ⁄eSètusR•
->
numOfZ⁄es
){

209 
Àn
 +(
pGëZ⁄eSètusR•
->
numOfZ⁄es
 * 3);

212 
u8
 *
buf
 = 
	`ev_buf_Æloˇã
(
Àn
);

213 if(!
buf
){

214  
ZCL_STA_INSUFFICIENT_SPACE
;

217 
u8
 *
pBuf
 = 
buf
;

219 *
pBuf
++ = 
pGëZ⁄eSètusR•
->
z⁄eSètusCom∂ëe
;

220 *
pBuf
++ = 
pGëZ⁄eSètusR•
->
numOfZ⁄es
;

221 if(
pGëZ⁄eSètusR•
->
numOfZ⁄es
){

222 
u8
 
i
 = 0; i < 
pGëZ⁄eSètusR•
->
numOfZ⁄es
; i++){

223 
	`mem˝y
(
pBuf
, &
pGëZ⁄eSètusR•
->
z⁄eSètusInfo
[
i
], 3);

224 
pBuf
 += 3;

228 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_STATUS_RESPONSE
, 
TRUE
,

229 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

231 
	`ev_buf_‰ì
(
buf
);

233  
ZCL_STA_SUCCESS
;

234 
	}
}

236 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_¨m
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
¨m_t
 *
pArm
)

238 
u8
 
buf
[11];

239 
bu
 *
pBuf
 = 
buf
;

241 *
pBuf
++ = 
pArm
->
¨mMode
;

242 *
pBuf
++ = 
pArm
->
code
.
°rLí
;

243 if(
pArm
->
code
.
°rLí
){

244 
	`mem˝y
(
pBuf
, 
pArm
->
code
.
pSå
,ÖArm->code.
°rLí
);

245 
pBuf
 +
pArm
->
code
.
°rLí
;

247 *
pBuf
++ = 
pArm
->
z⁄eId
;

249  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_ARM
, 
TRUE
,

250 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

251 
	}
}

253 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_by∑ss
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
by∑ss_t
 *
pBy∑ss
)

255 
u8
 
Àn
 = 10;

257 if(
pBy∑ss
->
numOfZ⁄es
){

258 
Àn
 +
pBy∑ss
->
numOfZ⁄es
;

261 
u8
 *
buf
 = 
	`ev_buf_Æloˇã
(
Àn
);

262 if(!
buf
){

263  
ZCL_STA_INSUFFICIENT_SPACE
;

266 
u8
 *
pBuf
 = 
buf
;

268 *
pBuf
++ = 
pBy∑ss
->
numOfZ⁄es
;

269 if(
pBy∑ss
->
numOfZ⁄es
){

270 
	`mem˝y
(
pBuf
, 
pBy∑ss
->
z⁄eIds
,ÖBy∑ss->
numOfZ⁄es
);

271 
pBuf
 +
pBy∑ss
->
numOfZ⁄es
;

273 *
pBuf
++ = 
pBy∑ss
->
code
.
°rLí
;

274 if(
pBy∑ss
->
code
.
°rLí
){

275 
	`mem˝y
(
pBuf
, 
pBy∑ss
->
code
.
pSå
,ÖBy∑ss->code.
°rLí
);

276 
pBuf
 +
pBy∑ss
->
code
.
°rLí
;

279 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_BYPASS
, 
TRUE
,

280 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
pBuf
 - 
buf
, buf);

282 
	`ev_buf_‰ì
(
buf
);

284  
ZCL_STA_SUCCESS
;

285 
	}
}

287 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_emîgícy
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

289  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_EMERGENCY
, 
TRUE
,

290 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

291 
	}
}

293 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_fúe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

295  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_FIRE
, 
TRUE
,

296 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

297 
	}
}

299 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_∑nic
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

301  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_PANIC
, 
TRUE
,

302 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

303 
	}
}

305 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eIdM≠
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

307  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_ID_MAP
, 
TRUE
,

308 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

309 
	}
}

311 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eInfo
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
Z⁄eId
)

313 
u8
 
buf
[1];

315 
buf
[0] = 
Z⁄eId
;

317  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_INFORMATION
, 
TRUE
,

318 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

319 
	}
}

321 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëP™ñSètus
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

323  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_PANEL_STATUS
, 
TRUE
,

324 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

325 
	}
}

327 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëBy∑s£dZ⁄eLi°
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

329  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_BYPASSED_ZONE_LIST
, 
TRUE
,

330 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

331 
	}
}

333 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eSètus
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëZ⁄eSètus_t
 *
pGëZ⁄eSètus
)

335 
u8
 
buf
[5];

337 
buf
[0] = 
pGëZ⁄eSètus
->
°¨tögZ⁄eId
;

338 
buf
[1] = 
pGëZ⁄eSètus
->
maxNumOfZ⁄eIds
;

339 
buf
[2] = 
pGëZ⁄eSètus
->
z⁄eSètusMaskFœg
;

340 
buf
[3] = 
	`LO_UINT16
(
pGëZ⁄eSètus
->
z⁄eSètusMask
);

341 
buf
[4] = 
	`HI_UINT16
(
pGëZ⁄eSètus
->
z⁄eSètusMask
);

343  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ACE
, 
ZCL_CMD_GET_ZONE_STATUS
, 
TRUE
,

344 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 5, 
buf
);

345 
	}
}

348 
_CODE_ZCL_
 
u8
 
	$z˛_∑r£UTF8Såög
(
u8
 *
pD©a
, 
UTF8Såög_t
 *
pSåög
, u8 
maxLí
)

350 
u8
 
Àn
 = 0;

351 
pSåög
->
°rLí
 = *
pD©a
++;

353 if(
pSåög
->
°rLí
 == 0xFF){

354 
pSåög
->
°rLí
 = 0;

357 if(
pSåög
->
°rLí
 == 0){

358 
pSåög
->
pSå
 = 
NULL
;

360 
Àn
 = 
pSåög
->
°rLí
;

362 
pSåög
->
°rLí
 = (
Àn
 > 
maxLí
) ? maxLen :Üen;

363 
pSåög
->
pSå
 = 
pD©a
;

366  (
Àn
 + 1);

367 
	}
}

369 
_CODE_ZCL_
 
	$z˛_¨mP¨£
(
u8
 *
pD©a
, 
¨m_t
 *
pCmd
)

371 
pCmd
->
¨mMode
 = *
pD©a
++;

373 
u8
 
Àn
 = 
	`z˛_∑r£UTF8Såög
(
pD©a
, &
pCmd
->
code
, 8);

374 
pD©a
 +
Àn
;

376 
pCmd
->
z⁄eId
 = *
pD©a
++;

377 
	}
}

379 
_CODE_ZCL_
 
	$z˛_gëZ⁄eInfoR•P¨£
(
u8
 *
pD©a
, 
gëZ⁄eInfoR•_t
 *
pCmd
)

381 
pCmd
->
z⁄eId
 = *
pD©a
++;

382 
pCmd
->
z⁄eTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

383 
pD©a
 += 2;

384 
	`mem˝y
(
pCmd
->
õìAddr
, 
pD©a
, 8);

385 
pD©a
 += 8;

386 
	`z˛_∑r£UTF8Såög
(
pD©a
, &
pCmd
->
z⁄eLabñ
, 24);

387 
	}
}

389 
_CODE_ZCL_
 
	$z˛_z⁄eSètusCh™gedP¨£
(
u8
 *
pD©a
, 
z⁄eSètusCh™ged_t
 *
pCmd
)

391 
pCmd
->
z⁄eId
 = *
pD©a
++;

392 
pCmd
->
z⁄eSètus
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

393 
pD©a
 += 2;

394 
pCmd
->
audibÀNŸifiˇti⁄
 = *
pD©a
++;

395 
	`z˛_∑r£UTF8Såög
(
pD©a
, &
pCmd
->
z⁄eLabñ
, 24);

396 
	}
}

398 
_CODE_ZCL_
 
	$z˛_by∑ssP¨£
(
u8
 *
pD©a
, 
by∑ss_t
 *
pCmd
)

400 
pCmd
->
numOfZ⁄es
 = *
pD©a
++;

401 
pCmd
->
z⁄eIds
 = 
pD©a
;

402 
pD©a
 +
pCmd
->
numOfZ⁄es
;

404 
	`z˛_∑r£UTF8Såög
(
pD©a
, &
pCmd
->
code
, 8);

405 
	}
}

407 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_¨mPrc
(
z˛Incomög_t
 *
pInMsg
)

409 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

410 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

412 if(
pInMsg
->
˛u°îAµCb
){

413 
u8
 
¨mNŸifiˇti⁄
 = 0xff;

415 
¨m_t
 
¨m
;

416 
	`TL_SETSTRUCTCONTENT
(
¨m
, 0);

418 
	`z˛_¨mP¨£
(
pInMsg
->
pD©a
, &
¨m
);

420 
¨mNŸifiˇti⁄
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
¨m
);

422 if(
¨mNŸifiˇti⁄
 != 0xff){

423 
ïInfo_t
 
d°Ep
;

424 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

426 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

427 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

428 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

429 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

431 
	`z˛_üsA˚_¨mR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, 
¨mNŸifiˇti⁄
);

433 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

435 
°©us
 = 
ZCL_STA_INVALID_VALUE
;

438 
°©us
 = 
ZCL_STA_FAILURE
;

441  
°©us
;

442 
	}
}

444 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_by∑ssPrc
(
z˛Incomög_t
 *
pInMsg
)

446 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

448 if(
pInMsg
->
˛u°îAµCb
){

449 
by∑ss_t
 
by∑ss
;

450 
	`TL_SETSTRUCTCONTENT
(
by∑ss
, 0);

452 
	`z˛_by∑ssP¨£
(
pInMsg
->
pD©a
, &
by∑ss
);

454 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
by∑ss
);

456 
°©us
 = 
ZCL_STA_FAILURE
;

459  
°©us
;

460 
	}
}

462 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_emîgícyPrc
(
z˛Incomög_t
 *
pInMsg
)

464 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

466 if(
pInMsg
->
˛u°îAµCb
){

467 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

469 
°©us
 = 
ZCL_STA_FAILURE
;

472  
°©us
;

473 
	}
}

475 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_fúePrc
(
z˛Incomög_t
 *
pInMsg
)

477 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

479 if(
pInMsg
->
˛u°îAµCb
){

480 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

482 
°©us
 = 
ZCL_STA_FAILURE
;

485  
°©us
;

486 
	}
}

488 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_∑nicPrc
(
z˛Incomög_t
 *
pInMsg
)

490 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

492 if(
pInMsg
->
˛u°îAµCb
){

493 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

495 
°©us
 = 
ZCL_STA_FAILURE
;

498  
°©us
;

499 
	}
}

501 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eIdM≠Prc
(
z˛Incomög_t
 *
pInMsg
)

503 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

504 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

505 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

507 if(
pInMsg
->
˛u°îAµCb
){

508 
u16
 
z⁄eIdM≠Se˘i⁄
[16];

509 
u16
 
£˘i⁄
 = 0;

511 
u8
 
i
 = 0; i < 16; i++){

512 
£˘i⁄
 = 0;

514 
u8
 
j
 = 0; j < 16; j++){

515 
u8
 
z⁄eId
 = 16 * 
i
 + 
j
;

517 if(
	`z˛_födZ⁄eE¡ry
(
ídpoöt
, 
z⁄eId
)){

518 
£˘i⁄
 |(0x01 << 
j
);

522 
z⁄eIdM≠Se˘i⁄
[
i
] = 
£˘i⁄
;

525 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

527 
ïInfo_t
 
d°Ep
;

528 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

530 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

531 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

532 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

533 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

535 
	`z˛_üsA˚_gëZ⁄eIdM≠R•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, (
u8
 *)
z⁄eIdM≠Se˘i⁄
);

537 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

539 
°©us
 = 
ZCL_STA_FAILURE
;

542  
°©us
;

543 
	}
}

545 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eInf‹m©i⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

547 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

548 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

549 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

551 if(
pInMsg
->
˛u°îAµCb
){

552 
u8
 
z⁄eId
 = 
pInMsg
->
pD©a
[0];

554 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
z⁄eId
);

556 
z˛_z⁄eTabÀ_t
 *
pZ⁄eE¡ry
 = 
	`z˛_födZ⁄eE¡ry
(
ídpoöt
, 
z⁄eId
);

557 if(
pZ⁄eE¡ry
){

558 
ïInfo_t
 
d°Ep
;

559 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

561 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

562 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

563 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

564 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

566 
gëZ⁄eInfoR•_t
 
gëZ⁄eInfoR•
;

567 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

569 
gëZ⁄eInfoR•
.
z⁄eId
 = 
pZ⁄eE¡ry
->
z⁄e
.zoneId;

570 
gëZ⁄eInfoR•
.
z⁄eTy≥
 = 
pZ⁄eE¡ry
->
z⁄e
.zoneType;

571 
	`mem˝y
(
gëZ⁄eInfoR•
.
õìAddr
, 
pZ⁄eE¡ry
->
z⁄e
, 8);

574 
	`z˛_üsA˚_gëZ⁄eInfoR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, &
gëZ⁄eInfoR•
);

576 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

578 
°©us
 = 
ZCL_STA_INVALID_VALUE
;

581 
°©us
 = 
ZCL_STA_FAILURE
;

584  
°©us
;

585 
	}
}

587 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëP™ñSètusPrc
(
z˛Incomög_t
 *
pInMsg
)

589 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

591 if(
pInMsg
->
˛u°îAµCb
){

592 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

594 
°©us
 = 
ZCL_STA_FAILURE
;

597  
°©us
;

598 
	}
}

600 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëBy∑s£dZ⁄eLi°Prc
(
z˛Incomög_t
 *
pInMsg
)

602 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

604 if(
pInMsg
->
˛u°îAµCb
){

605 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

607 
°©us
 = 
ZCL_STA_FAILURE
;

610  
°©us
;

611 
	}
}

613 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eSètusPrc
(
z˛Incomög_t
 *
pInMsg
)

615 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

616 
u8
 *
pD©a
 = 
pInMsg
->pData;

618 if(
pInMsg
->
˛u°îAµCb
){

619 
gëZ⁄eSètus_t
 
gëZ⁄eSètus
;

620 
gëZ⁄eSètus
.
°¨tögZ⁄eId
 = *
pD©a
++;

621 
gëZ⁄eSètus
.
maxNumOfZ⁄eIds
 = *
pD©a
++;

622 
gëZ⁄eSètus
.
z⁄eSètusMaskFœg
 = *
pD©a
++;

623 
gëZ⁄eSètus
.
z⁄eSètusMask
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

625 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëZ⁄eSètus
);

627 
°©us
 = 
ZCL_STA_FAILURE
;

630  
°©us
;

631 
	}
}

633 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_¨mR•Prc
(
z˛Incomög_t
 *
pInMsg
)

635 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

637 if(
pInMsg
->
˛u°îAµCb
){

638 
u8
 
¨mNŸifiˇti⁄
 = 
pInMsg
->
pD©a
[0];

640 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
¨mNŸifiˇti⁄
);

642 
°©us
 = 
ZCL_STA_FAILURE
;

645  
°©us
;

646 
	}
}

648 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eIdM≠R•Prc
(
z˛Incomög_t
 *
pInMsg
)

650 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

652 if(
pInMsg
->
˛u°îAµCb
){

653 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
,ÖInMsg->
pD©a
);

655 
°©us
 = 
ZCL_STA_FAILURE
;

658  
°©us
;

659 
	}
}

661 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eInfoR•Prc
(
z˛Incomög_t
 *
pInMsg
)

663 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

665 if(
pInMsg
->
˛u°îAµCb
){

666 
gëZ⁄eInfoR•_t
 
gëZ⁄eInfoR•
;

667 
	`TL_SETSTRUCTCONTENT
(
gëZ⁄eInfoR•
, 0);

669 
	`z˛_gëZ⁄eInfoR•P¨£
(
pInMsg
->
pD©a
, &
gëZ⁄eInfoR•
);

671 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëZ⁄eInfoR•
);

673 
°©us
 = 
ZCL_STA_FAILURE
;

676  
°©us
;

677 
	}
}

679 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_z⁄eSètusCh™gedPrc
(
z˛Incomög_t
 *
pInMsg
)

681 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

683 if(
pInMsg
->
˛u°îAµCb
){

684 
z⁄eSètusCh™ged_t
 
z⁄eSètusCh™ged
;

685 
	`TL_SETSTRUCTCONTENT
(
z⁄eSètusCh™ged
, 0);

687 
	`z˛_z⁄eSètusCh™gedP¨£
(
pInMsg
->
pD©a
, &
z⁄eSètusCh™ged
);

689 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
z⁄eSètusCh™ged
);

691 
°©us
 = 
ZCL_STA_FAILURE
;

694  
°©us
;

695 
	}
}

697 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_∑√lSètusCh™gedPrc
(
z˛Incomög_t
 *
pInMsg
)

699 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

700 
u8
 *
pD©a
 = 
pInMsg
->pData;

702 if(
pInMsg
->
˛u°îAµCb
){

703 
∑√lSètusCh™ged_t
 
∑√lSètusCh™ged
;

704 
∑√lSètusCh™ged
.
∑√lSètus
 = *
pD©a
++;

705 
∑√lSètusCh™ged
.
£c⁄dsRemaöög
 = *
pD©a
++;

706 
∑√lSètusCh™ged
.
audibÀNŸifiˇti⁄
 = *
pD©a
++;

707 
∑√lSètusCh™ged
.
Æ¨mSètus
 = *
pD©a
++;

709 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
∑√lSètusCh™ged
);

711 
°©us
 = 
ZCL_STA_FAILURE
;

714  
°©us
;

715 
	}
}

717 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëP™ñSètusR•Prc
(
z˛Incomög_t
 *
pInMsg
)

719 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

720 
u8
 *
pD©a
 = 
pInMsg
->pData;

722 if(
pInMsg
->
˛u°îAµCb
){

723 
gëP™ñSètusR•_t
 
gëP™ñSètusR•
;

724 
gëP™ñSètusR•
.
∑√lSètus
 = *
pD©a
++;

725 
gëP™ñSètusR•
.
£c⁄dsRemaöög
 = *
pD©a
++;

726 
gëP™ñSètusR•
.
audibÀNŸifiˇti⁄
 = *
pD©a
++;

727 
gëP™ñSètusR•
.
Æ¨mSètus
 = *
pD©a
++;

729 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëP™ñSètusR•
);

731 
°©us
 = 
ZCL_STA_FAILURE
;

734  
°©us
;

735 
	}
}

737 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_£tBy∑s£dZ⁄eLi°Prc
(
z˛Incomög_t
 *
pInMsg
)

739 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

740 
u8
 *
pD©a
 = 
pInMsg
->pData;

742 if(
pInMsg
->
˛u°îAµCb
){

743 
£tBy∑s£dZ⁄eLi°_t
 
£tBy∑s£dZ⁄eLi°
;

744 
£tBy∑s£dZ⁄eLi°
.
numOfZ⁄es
 = *
pD©a
++;

745 
£tBy∑s£dZ⁄eLi°
.
z⁄eIds
 = sëBy∑s£dZ⁄eLi°.
numOfZ⁄es
 ? 
pD©a
 : 
NULL
;

747 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
£tBy∑s£dZ⁄eLi°
);

749 
°©us
 = 
ZCL_STA_FAILURE
;

752  
°©us
;

753 
	}
}

755 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_by∑ssR•Prc
(
z˛Incomög_t
 *
pInMsg
)

757 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

758 
u8
 *
pD©a
 = 
pInMsg
->pData;

760 if(
pInMsg
->
˛u°îAµCb
){

761 
by∑ssR•_t
 
by∑ssR•
;

762 
by∑ssR•
.
numOfZ⁄es
 = *
pD©a
++;

763 
by∑ssR•
.
z⁄eIds
 = by∑ssR•.
numOfZ⁄es
 ? 
pD©a
 : 
NULL
;

765 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
by∑ssR•
);

767 
°©us
 = 
ZCL_STA_FAILURE
;

770  
°©us
;

771 
	}
}

773 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_gëZ⁄eSètusR•Prc
(
z˛Incomög_t
 *
pInMsg
)

775 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

776 
u8
 *
pD©a
 = 
pInMsg
->pData;

778 if(
pInMsg
->
˛u°îAµCb
){

779 
gëZ⁄eSètusR•_t
 
gëZ⁄eSètusR•
;

780 
gëZ⁄eSètusR•
.
z⁄eSètusCom∂ëe
 = *
pD©a
++;

781 
gëZ⁄eSètusR•
.
numOfZ⁄es
 = *
pD©a
++;

782 
gëZ⁄eSètusR•
.
z⁄eSètusInfo
 = gëZ⁄eSètusR•.
numOfZ⁄es
 ? 
pD©a
 : 
NULL
;

784 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëZ⁄eSètusR•
);

786 
°©us
 = 
ZCL_STA_FAILURE
;

789  
°©us
;

790 
	}
}

792 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

794 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

796 
pInMsg
->
hdr
.
cmd
)

798 
ZCL_CMD_ARM
:

799 
°©us
 = 
	`z˛_üsA˚_¨mPrc
(
pInMsg
);

801 
ZCL_CMD_BYPASS
:

802 
°©us
 = 
	`z˛_üsA˚_by∑ssPrc
(
pInMsg
);

804 
ZCL_CMD_EMERGENCY
:

805 
°©us
 = 
	`z˛_üsA˚_emîgícyPrc
(
pInMsg
);

807 
ZCL_CMD_FIRE
:

808 
°©us
 = 
	`z˛_üsA˚_fúePrc
(
pInMsg
);

810 
ZCL_CMD_PANIC
:

811 
°©us
 = 
	`z˛_üsA˚_∑nicPrc
(
pInMsg
);

813 
ZCL_CMD_GET_ZONE_ID_MAP
:

814 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eIdM≠Prc
(
pInMsg
);

816 
ZCL_CMD_GET_ZONE_INFORMATION
:

817 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eInf‹m©i⁄Prc
(
pInMsg
);

819 
ZCL_CMD_GET_PANEL_STATUS
:

820 
°©us
 = 
	`z˛_üsA˚_gëP™ñSètusPrc
(
pInMsg
);

822 
ZCL_CMD_GET_BYPASSED_ZONE_LIST
:

823 
°©us
 = 
	`z˛_üsA˚_gëBy∑s£dZ⁄eLi°Prc
(
pInMsg
);

825 
ZCL_CMD_GET_ZONE_STATUS
:

826 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eSètusPrc
(
pInMsg
);

829 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

833  
°©us
;

834 
	}
}

836 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

838 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

840 
pInMsg
->
hdr
.
cmd
)

842 
ZCL_CMD_ARM_RESPONSE
:

843 
°©us
 = 
	`z˛_üsA˚_¨mR•Prc
(
pInMsg
);

845 
ZCL_CMD_GET_ZONE_ID_MAP_RESPONSE
:

846 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eIdM≠R•Prc
(
pInMsg
);

848 
ZCL_CMD_GET_ZONE_INFORMATION_RESPONSE
:

849 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eInfoR•Prc
(
pInMsg
);

851 
ZCL_CMD_ZONE_STATUS_CHANGED
:

852 
°©us
 = 
	`z˛_üsA˚_z⁄eSètusCh™gedPrc
(
pInMsg
);

854 
ZCL_CMD_PANEL_STATUS_CHANGED
:

855 
°©us
 = 
	`z˛_üsA˚_∑√lSètusCh™gedPrc
(
pInMsg
);

857 
ZCL_CMD_GET_PANEL_STATUS_RESPONSE
:

858 
°©us
 = 
	`z˛_üsA˚_gëP™ñSètusR•Prc
(
pInMsg
);

860 
ZCL_CMD_SET_BYPASSED_ZONE_LIST
:

861 
°©us
 = 
	`z˛_üsA˚_£tBy∑s£dZ⁄eLi°Prc
(
pInMsg
);

863 
ZCL_CMD_BYPASS_RESPONSE
:

864 
°©us
 = 
	`z˛_üsA˚_by∑ssR•Prc
(
pInMsg
);

866 
ZCL_CMD_GET_ZONE_STATUS_RESPONSE
:

867 
°©us
 = 
	`z˛_üsA˚_gëZ⁄eSètusR•Prc
(
pInMsg
);

870 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

874  
°©us
;

875 
	}
}

877 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsA˚_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

879 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

880  
	`z˛_üsA˚_˛õ¡CmdH™dÀr
(
pInMsg
);

882  
	`z˛_üsA˚_£rvîCmdH™dÀr
(
pInMsg
);

884 
	}
}

	@zigbee/zcl/security_safety/zcl_ias_ace.h

24 #i‚de‡
ZCL_IAS_ACE_H


25 
	#ZCL_IAS_ACE_H


	)

34 
	#ZCL_CMD_ARM
 0x00

	)

35 
	#ZCL_CMD_BYPASS
 0x01

	)

36 
	#ZCL_CMD_EMERGENCY
 0x02

	)

37 
	#ZCL_CMD_FIRE
 0x03

	)

38 
	#ZCL_CMD_PANIC
 0x04

	)

39 
	#ZCL_CMD_GET_ZONE_ID_MAP
 0x05

	)

40 
	#ZCL_CMD_GET_ZONE_INFORMATION
 0x06

	)

41 
	#ZCL_CMD_GET_PANEL_STATUS
 0x07

	)

42 
	#ZCL_CMD_GET_BYPASSED_ZONE_LIST
 0x08

	)

43 
	#ZCL_CMD_GET_ZONE_STATUS
 0x09

	)

46 
	#ZCL_CMD_ARM_RESPONSE
 0x00

	)

47 
	#ZCL_CMD_GET_ZONE_ID_MAP_RESPONSE
 0x01

	)

48 
	#ZCL_CMD_GET_ZONE_INFORMATION_RESPONSE
 0x02

	)

49 
	#ZCL_CMD_ZONE_STATUS_CHANGED
 0x03

	)

50 
	#ZCL_CMD_PANEL_STATUS_CHANGED
 0x04

	)

51 
	#ZCL_CMD_GET_PANEL_STATUS_RESPONSE
 0x05

	)

52 
	#ZCL_CMD_SET_BYPASSED_ZONE_LIST
 0x06

	)

53 
	#ZCL_CMD_BYPASS_RESPONSE
 0x07

	)

54 
	#ZCL_CMD_GET_ZONE_STATUS_RESPONSE
 0x08

	)

64 
UTF8Såög_t
 
	mcode
;

65 
u8
 
	m¨mMode
;

66 
u8
 
	mz⁄eId
;

67 } 
	t¨m_t
;

73 
u8
 *
	mz⁄eIds
;

74 
UTF8Såög_t
 
	mcode
;

75 
u8
 
	mnumOfZ⁄es
;

76 } 
	tby∑ss_t
;

82 
u16
 
	mz⁄eSètusMask
;

83 
u8
 
	m°¨tögZ⁄eId
;

84 
u8
 
	mmaxNumOfZ⁄eIds
;

85 
boﬁ
 
	mz⁄eSètusMaskFœg
;

86 } 
	tgëZ⁄eSètus_t
;

92 
UTF8Såög_t
 
	mz⁄eLabñ
;

93 
u8
 
	mz⁄eId
;

94 
u16
 
	mz⁄eTy≥
;

95 
extAddr_t
 
	mõìAddr
;

96 } 
	tgëZ⁄eInfoR•_t
;

102 
UTF8Såög_t
 
	mz⁄eLabñ
;

103 
u8
 
	mz⁄eId
;

104 
u16
 
	mz⁄eSètus
;

105 
u8
 
	maudibÀNŸifiˇti⁄
;

106 } 
	tz⁄eSètusCh™ged_t
;

112 
u8
 
	m∑√lSètus
;

113 
u8
 
	m£c⁄dsRemaöög
;

114 
u8
 
	maudibÀNŸifiˇti⁄
;

115 
u8
 
	mÆ¨mSètus
;

116 } 
	t∑√lSètusCh™ged_t
;

122 
u8
 
	m∑√lSètus
;

123 
u8
 
	m£c⁄dsRemaöög
;

124 
u8
 
	maudibÀNŸifiˇti⁄
;

125 
u8
 
	mÆ¨mSètus
;

126 } 
	tgëP™ñSètusR•_t
;

132 
u8
 *
	mz⁄eIds
;

133 
u8
 
	mnumOfZ⁄es
;

134 } 
	t£tBy∑s£dZ⁄eLi°_t
;

140 
u8
 *
	mz⁄eIds
;

141 
u8
 
	mnumOfZ⁄es
;

142 } 
	tby∑ssR•_t
;

148 
u8
 *
	mz⁄eSètusInfo
;

149 
u8
 
	mz⁄eSètusCom∂ëe
;

150 
u8
 
	mnumOfZ⁄es
;

151 } 
	tgëZ⁄eSètusR•_t
;

155 
	$u8
 (*
	tz˛_¨mCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	t¨m_t
 *
	tpArm
);

156 (*
	tz˛_by∑ssCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tby∑ss_t
 *
	tpBy∑ss
);

157 (*
	tz˛_emîgícyCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

158 (*
	tz˛_fúeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

159 (*
	tz˛_∑nicCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

160 (*
	tz˛_gëZ⁄eIdM≠Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

161 (*
	tz˛_gëZ⁄eInf‹m©i⁄Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 
	tz⁄eId
);

162 (*
	tz˛_gëP™ñSètusCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

163 (*
	tz˛_gëBy∑ssZ⁄eLi°Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

164 (*
	tz˛_gëZ⁄eSètusCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëZ⁄eSètus_t
 *
	tpGëZ⁄eSètus
);

165 (*
	tz˛_¨mR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 
	t¨mNŸifiˇti⁄
);

166 (*
	tz˛_gëZ⁄eIdM≠R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tu8
 *
	tpZ⁄eIdM≠R•
);

167 (*
	tz˛_gëZ⁄eInf‹m©i⁄R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëZ⁄eInfoR•_t
 *
	tpGëZ⁄eInfoR•
);

168 (*
	tz˛_z⁄eSètusCh™gedCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz⁄eSètusCh™ged_t
 *
	tpZ⁄eSètusCh™ged
);

169 (*
	tz˛_∑√lSètusCh™gedCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	t∑√lSètusCh™ged_t
 *
	tpP™ñSètusCh™ged
);

170 (*
	tz˛_gëP™ñSètusR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëP™ñSètusR•_t
 *
	tpGëP™ñSètusR•
);

171 (*
	tz˛_£tBy∑s£dZ⁄eLi°Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	t£tBy∑s£dZ⁄eLi°_t
 *
	tpSëBy∑s£dZ⁄eLi°
);

172 (*
	tz˛_by∑ssR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tby∑ssR•_t
 *
	tpBy∑ssR•
);

173 (*
	tz˛_gëZ⁄eSètusR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tgëZ⁄eSètusR•_t
 *
	tpGëZ⁄eSètusR•
);

179 
z˛_¨mCb_t
 
¨mCbFunc
;

180 
z˛_by∑ssCb_t
 
by∑ssCbFunc
;

181 
z˛_emîgícyCb_t
 
emîgícyCbFunc
;

182 
z˛_fúeCb_t
 
fúeCbFunc
;

183 
z˛_∑nicCb_t
 
∑nicCbFunc
;

184 
z˛_gëZ⁄eIdM≠Cb_t
 
gëZ⁄eIdM≠CbFunc
;

185 
z˛_gëZ⁄eInf‹m©i⁄Cb_t
 
gëZ⁄eInf‹m©i⁄CbFunc
;

186 
z˛_gëP™ñSètusCb_t
 
gëP™ñSètusCbFunc
;

187 
z˛_gëBy∑ssZ⁄eLi°Cb_t
 
gëBy∑ssZ⁄eLi°CbFunc
;

188 
z˛_gëZ⁄eSètusCb_t
 
gëZ⁄eSètusCbFunc
;

189 
z˛_¨mR•Cb_t
 
¨mR•CbFunc
;

190 
z˛_gëZ⁄eIdM≠R•Cb_t
 
gëZ⁄eIdM≠R•CbFunc
;

191 
z˛_gëZ⁄eInf‹m©i⁄R•Cb_t
 
gëZ⁄eInf‹m©i⁄R•CbFunc
;

192 
z˛_z⁄eSètusCh™gedCb_t
 
z⁄eSètusCh™gedCbFunc
;

193 
z˛_∑√lSètusCh™gedCb_t
 
∑√lSètusCh™gedCbFunc
;

194 
z˛_gëP™ñSètusR•Cb_t
 
gëP™ñSètusR•CbFunc
;

195 
z˛_£tBy∑s£dZ⁄eLi°Cb_t
 
£tBy∑s£dZ⁄eLi°CbFunc
;

196 
z˛_by∑ssR•Cb_t
 
by∑ssR•CbFunc
;

197 
z˛_gëZ⁄eSètusR•Cb_t
 
gëZ⁄eSètusR•CbFunc
;

198 } 
	tz˛_üsA˚_AµCÆlbacks_t
;

201 
°©us_t
 
	`z˛_üsA˚_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

203 
°©us_t
 
	`z˛_üsA˚_z⁄eSètusCh™ged
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eSètusCh™ged_t
 *
pZ⁄eSètusCh™ged
);

205 
°©us_t
 
	`z˛_üsA˚_∑√lSètusCh™ged
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
∑√lSètusCh™ged_t
 *
pP™ñSètusCh™ged
);

207 
°©us_t
 
	`z˛_üsA˚_gëP™ñSètusR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëP™ñSètusR•_t
 *
pGëP™ñSètusR•
);

209 
°©us_t
 
	`z˛_üsA˚_£tBy∑s£dZ⁄eLi°
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
£tBy∑s£dZ⁄eLi°_t
 *
pSëBy∑s£dZ⁄eLi°
);

211 
°©us_t
 
	`z˛_üsA˚_by∑ssRe•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
by∑ssR•_t
 *
pBy∑ssR•
);

213 
°©us_t
 
	`z˛_üsA˚_gëZ⁄eSètusRe•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëZ⁄eSètusR•_t
 *
pGëZ⁄eSètusR•
);

215 
°©us_t
 
	`z˛_üsA˚_¨m
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
¨m_t
 *
pArm
);

216 
	#z˛_üsA˚_¨mCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsA˚_¨m
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

218 
°©us_t
 
	`z˛_üsA˚_by∑ss
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
by∑ss_t
 *
pBy∑ss
);

219 
	#z˛_üsA˚_by∑ssCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsA˚_by∑ss
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

221 
°©us_t
 
	`z˛_üsA˚_emîgícy
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

222 
	#z˛_üsA˚_emîgícyCmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_emîgícy
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

224 
°©us_t
 
	`z˛_üsA˚_fúe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

225 
	#z˛_üsA˚_fúeCmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_fúe
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

227 
°©us_t
 
	`z˛_üsA˚_∑nic
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

228 
	#z˛_üsA˚_∑nicCmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_∑nic
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

230 
°©us_t
 
	`z˛_üsA˚_gëZ⁄eIdM≠
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

231 
	#z˛_üsA˚_gëZ⁄eIdM≠Cmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_gëZ⁄eIdM≠
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

233 
°©us_t
 
	`z˛_üsA˚_gëZ⁄eInfo
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, u8 
Z⁄eId
);

234 
	#z˛_üsA˚_gëZ⁄eInfoCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsA˚_gëZ⁄eInfo
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

236 
°©us_t
 
	`z˛_üsA˚_gëP™ñSètus
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

237 
	#z˛_üsA˚_gëP™ñSètusCmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_gëP™ñSètus
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

239 
°©us_t
 
	`z˛_üsA˚_gëBy∑s£dZ⁄eLi°
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

240 
	#z˛_üsA˚_gëBy∑s£dZ⁄eLi°Cmd
(
a
,
b
,
c
Ë(
	`z˛_üsA˚_gëBy∑s£dZ⁄eLi°
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

242 
°©us_t
 
	`z˛_üsA˚_gëZ⁄eSètus
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
gëZ⁄eSètus_t
 *
pGëZ⁄eSètus
);

243 
	#z˛_üsA˚_gëZ⁄eSètusCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsA˚_gëZ⁄eSètus
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/security_safety/zcl_ias_wd.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_IAS_WD


49 
°©us_t
 
z˛_üsWd_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

51 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsWd_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_SS_IAS_WD
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_üsWD_cmdH™dÀr
, 
cb
);

55 
	}
}

57 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsWd_°¨tW¨nög
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
°¨tW¨nög_t
 *
pSèπW¨nög
)

59 
u8
 
buf
[5];

61 
buf
[0] = 
pSèπW¨nög
->
w¨nög
.
byã
;

62 
buf
[1] = 
	`LO_UINT16
(
pSèπW¨nög
->
w¨nögDuøti⁄
);

63 
buf
[2] = 
	`HI_UINT16
(
pSèπW¨nög
->
w¨nögDuøti⁄
);

64 
buf
[3] = 
pSèπW¨nög
->
°robeDutyCy˛e
;

65 
buf
[4] = 
pSèπW¨nög
->
°robeLevñ
;

67  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_WD
, 
ZCL_CMD_START_WARNING
, 
TRUE
,

68 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 5, 
buf
);

69 
	}
}

72 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsWd_squawk
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
squawk_t
 *
pSquawk
)

74 
u8
 
buf
[1];

76 
buf
[0] = 
pSquawk
->
byã
;

78  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_WD
,
ZCL_CMD_SQUAWK
, 
TRUE
,

79 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

80 
	}
}

83 
_CODE_ZCL_
 
°©us_t
 
	$z˛_°¨tW¨nögPrc
(
z˛Incomög_t
 *
pInMsg
)

85 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

86 
u8
 *
pD©a
 = 
pInMsg
->pData;

88 if(
pInMsg
->
˛u°îAµCb
){

89 
°¨tW¨nög_t
 
°¨tW¨nög
;

90 
°¨tW¨nög
.
w¨nög
.
byã
 = *
pD©a
++;

91 
°¨tW¨nög
.
w¨nögDuøti⁄
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

92 
pD©a
 += 2;

93 
°¨tW¨nög
.
°robeDutyCy˛e
 = *
pD©a
++;

94 
°¨tW¨nög
.
°robeLevñ
 = *
pD©a
++;

96 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
°¨tW¨nög
);

98 
°©us
 = 
ZCL_STA_FAILURE
;

101  
°©us
;

102 
	}
}

104 
_CODE_ZCL_
 
°©us_t
 
	$z˛_squawkPrc
(
z˛Incomög_t
 *
pInMsg
)

106 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

108 if(
pInMsg
->
˛u°îAµCb
){

109 
squawk_t
 
squawk
;

110 
squawk
.
byã
 = 
pInMsg
->
pD©a
[0];

112 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
squawk
);

114 
°©us
 = 
ZCL_STA_FAILURE
;

117  
°©us
;

118 
	}
}

120 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsWd_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

122 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

124 
pInMsg
->
hdr
.
cmd
)

126 
ZCL_CMD_START_WARNING
:

127 
°©us
 = 
	`z˛_°¨tW¨nögPrc
(
pInMsg
);

129 
ZCL_CMD_SQUAWK
:

130 
°©us
 = 
	`z˛_squawkPrc
(
pInMsg
);

133 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

137  
°©us
;

138 
	}
}

140 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsWd_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

142 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

143  
	`z˛_üsWd_˛õ¡CmdH™dÀr
(
pInMsg
);

145  
ZCL_STA_UNSUP_GENERAL_COMMAND
;

147 
	}
}

	@zigbee/zcl/security_safety/zcl_ias_wd.h

24 #i‚de‡
ZCL_IAS_WD_H


25 
	#ZCL_IAS_WD_H


	)

35 
	#ZCL_CMD_START_WARNING
 0x00

	)

36 
	#ZCL_CMD_SQUAWK
 0x01

	)

40 
	#ZCL_ATTRID_WD_MAX_DURATION
 0x0000

	)

48 
u8
 
	mbyã
;

50 
u8
 
	mw¨nögMode
:4;

51 
u8
 
	m°robe
:2;

52 
u8
 
	msúíLevñ
:2;

53 }
	mbôs
;

54 } 
	tw¨nög_t
;

60 
u16
 
	mw¨nögDuøti⁄
;

61 
w¨nög_t
 
	mw¨nög
;

62 
u8
 
	m°robeDutyCy˛e
;

63 
u8
 
	m°robeLevñ
;

64 } 
	t°¨tW¨nög_t
;

70 
u8
 
	mbyã
;

72 
u8
 
	msquawk
:4;

73 
u8
 
	m°robe
:1;

74 
u8
 
	mª£rved
:1;

75 
u8
 
	msquawkLevñ
:2;

76 }
	mbôs
;

77 } 
	tsquawk_t
;

81 (*
	tz˛_°¨tW¨nögCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	t°¨tW¨nög_t
 *
	tpSèπW¨nög
);

82 (*
	tz˛_SquawkCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tsquawk_t
 *
	tpSquawk
);

88 
z˛_°¨tW¨nögCb_t
 
°¨tW¨nögCbFunc
;

89 
z˛_SquawkCb_t
 
squawkCbFunc
;

90 } 
	tz˛_üsWd_AµCÆlbacks_t
;

94 
u16
 
z˛_©å_MaxDuøti⁄
;

96 c⁄° 
z˛AârInfo_t
 
üsWD_©åTbl
[];

98 c⁄° 
u8
 
z˛_üsWD_©åNum
;

102 
°©us_t
 
	`z˛_üsWd_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

105 
°©us_t
 
	`z˛_üsWd_°¨tW¨nög
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
°¨tW¨nög_t
 *
pSèπW¨nög
);

106 
	#z˛_üsWd_°¨tW¨nögCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsWd_°¨tW¨nög
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

108 
°©us_t
 
	`z˛_üsWd_squawk
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
squawk_t
 *
pSquawk
);

109 
	#z˛_üsWd_squawkCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsWd_squawk
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

	@zigbee/zcl/security_safety/zcl_ias_wd_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

45 #ifde‡
ZCL_IAS_WD


48 
u16
 
	gz˛_©å_MaxDuøti⁄
 = 240;

52 c⁄° 
z˛AârInfo_t
 
	güsWD_©åTbl
[] =

54 { 
ZCL_ATTRID_WD_MAX_DURATION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
| 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_MaxDuøti⁄
},

55 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

58 c⁄° 
u8
 
	gz˛_üsWD_©åNum
 = ( (
üsWD_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/security_safety/zcl_ias_zone.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_IAS_ZONE


44 
z˛_z⁄eTabÀ_t
 
	gg_z˛_z⁄eTab
[
ZCL_ZONE_TABLE_NUM
];

49 
z˛_z⁄eTabCÀ¨
();

51 
°©us_t
 
z˛_üsZ⁄e_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

54 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

56 
	`z˛_z⁄eTabCÀ¨
();

58  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_üsZ⁄e_cmdH™dÀr
, 
cb
);

59 
	}
}

62 
_CODE_ZCL_
 
boﬁ
 
	$z˛_z⁄eTy≥M©ched
(
u16
 
z⁄eTy≥
)

64 
z⁄eTy≥
){

65 
ZONE_TYPE_STANDARD_CIE
:

66 
ZONE_TYPE_MOTION_SENSOR
:

67 
ZONE_TYPE_CONTACT_SWITCH
:

68 
ZONE_TYPE_DOOR_WINDOW_HANDLE
:

69 
ZONE_TYPE_FIRE_SENSOR
:

70 
ZONE_TYPE_WATER_SENSOR
:

71 
ZONE_TYPE_CARBON_MONOXIDE_SENSOR
:

72 
ZONE_TYPE_PERSONAL_EMERGENCY_DEV
:

73 
ZONE_TYPE_VIBRATION_MOVEMENT_SENSOR
:

74 
ZONE_TYPE_REMOTE_CONTROL
:

75 
ZONE_TYPE_KEY_FOB
:

76 
ZONE_TYPE_KEY_PAD
:

77 
ZONE_TYPE_STANDARD_WARNING_DEV
:

78 
ZONE_TYPE_GLASS_BREAK_SENSOR
:

79 
ZONE_TYPE_SECURITY_REPEATER
:

80  
TRUE
;

84  
FALSE
;

87 
	}
}

89 
_CODE_ZCL_
 
	$z˛_z⁄eCÀ¨E¡ry
(
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
)

91 if(
pZ⁄eTab
){

92 
pZ⁄eTab
->
u£d
 = 0;

93 
pZ⁄eTab
->
ídpoöt
 = 0xfe;

94 
	`mem£t
((
u8
 *)&
pZ⁄eTab
->
z⁄e
, 0, (
z˛_z⁄eTabE¡ry_t
));

96 
	}
}

98 
_CODE_ZCL_
 
	$z˛_z⁄eTabCÀ¨
()

100 
u8
 
i
 = 0; i < 
ZCL_ZONE_TABLE_NUM
; i++){

101 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = &
g_z˛_z⁄eTab
[
i
];

103 
	`z˛_z⁄eCÀ¨E¡ry
(
pZ⁄eTab
);

105 
	}
}

107 
_CODE_ZCL_
 
z˛_z⁄eTabÀ_t
 *
	$z˛_gëZ⁄eFªeE¡ry
()

109 
u8
 
i
 = 0; i < 
ZCL_ZONE_TABLE_NUM
; i++){

110 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = &
g_z˛_z⁄eTab
[
i
];

112 if(!
pZ⁄eTab
->
u£d
){

113  
pZ⁄eTab
;

117  
NULL
;

118 
	}
}

120 
_CODE_ZCL_
 
u8
 
	$z˛_gëZ⁄eId
()

122 
u8
 
z⁄eId
 = 0;

125 
u8
 
i
 = 0;

126 
i
 = 0; i < 
ZCL_ZONE_TABLE_NUM
; i++){

127 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = &
g_z˛_z⁄eTab
[
i
];

129 if(
pZ⁄eTab
->
u£d
 && (pZ⁄eTab->
z⁄e
.
z⁄eId
 == zoneId)){

133 if(
i
 >
ZCL_ZONE_TABLE_NUM
){

134  
z⁄eId
;

136 }++
z⁄eId
 < 
ZCL_ZONE_ID_INVALID
);

138  
ZCL_ZONE_ID_INVALID
;

139 
	}
}

141 
_CODE_ZCL_
 
z˛_z⁄eTabÀ_t
 *
	$z˛_addZ⁄eE¡ry
(
u8
 
ídpoöt
, 
u16
 
z⁄eTy≥
, u8 *
r•Code
)

143 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = 
	`z˛_gëZ⁄eFªeE¡ry
();

144 if(!
pZ⁄eTab
){

145 *
r•Code
 = 
ZONE_ENROLL_TOO_MANY_ZONES
;

146  
NULL
;

149 
u8
 
z⁄eId
 = 
	`z˛_gëZ⁄eId
();

150 if(
z⁄eId
 =
ZCL_ZONE_ID_INVALID
){

151 *
r•Code
 = 
ZONE_ENROLL_TOO_MANY_ZONES
;

152  
NULL
;

155 
pZ⁄eTab
->
u£d
 = 1;

156 
pZ⁄eTab
->
ídpoöt
 =Éndpoint;

157 
pZ⁄eTab
->
z⁄e
.
z⁄eTy≥
 = zoneType;

158 
pZ⁄eTab
->
z⁄e
.
z⁄eId
 = zoneId;

159 
	`mem£t
(
pZ⁄eTab
->
z⁄e
.
z⁄eAddr
, 0xff, 8);

161 *
r•Code
 = 
ZONE_ENROLL_SUCC
;

162  
pZ⁄eTab
;

163 
	}
}

165 
_CODE_ZCL_
 
z˛_z⁄eTabÀ_t
 *
	$z˛_födZ⁄eE¡ry
(
u8
 
ídpoöt
, u8 
z⁄eId
)

167 
u8
 
i
 = 0; i < 
ZCL_ZONE_TABLE_NUM
; i++){

168 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = &
g_z˛_z⁄eTab
[
i
];

170 if(
pZ⁄eTab
->
u£d
 && (pZ⁄eTab->
ídpoöt
 =ídpoötË&& (pZ⁄eTab->
z⁄e
.
z⁄eId
 == zoneId)){

171  
pZ⁄eTab
;

175  
NULL
;

176 
	}
}

178 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_írﬁlR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eEƒﬁlR•_t
 *
pEƒﬁlR•
)

180 
u8
 
buf
[2];

182 
buf
[0] = 
pEƒﬁlR•
->
code
;

183 
buf
[1] = 
pEƒﬁlR•
->
z⁄eId
;

185  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
ZCL_CMD_ZONE_ENROLL_RSP
, 
TRUE
,

186 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

187 
	}
}

189 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_öôN‹mÆO≥øti⁄Mode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

191  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
ZCL_CMD_INIT_NORMAL_OPERATION_MODE
, 
TRUE
,

192 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

193 
	}
}

195 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_öôTe°Mode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eInôTe°Mode_t
 *
pInôTe°Mode
)

197 
u8
 
buf
[2];

199 
buf
[0] = 
pInôTe°Mode
->
ã°ModeDuøti⁄
;

200 
buf
[1] = 
pInôTe°Mode
->
cuºZ⁄eSísLevñ
;

202  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
ZCL_CMD_INIT_TEST_MODE
, 
TRUE
,

203 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

204 
	}
}

206 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_írﬁlReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eEƒﬁlReq_t
 *
pEƒﬁlReq
)

208 
u8
 
buf
[4];

210 
buf
[0] = 
	`LO_UINT16
(
pEƒﬁlReq
->
z⁄eTy≥
);

211 
buf
[1] = 
	`HI_UINT16
(
pEƒﬁlReq
->
z⁄eTy≥
);

212 
buf
[2] = 
	`LO_UINT16
(
pEƒﬁlReq
->
m™uÁ˘uªrCode
);

213 
buf
[3] = 
	`HI_UINT16
(
pEƒﬁlReq
->
m™uÁ˘uªrCode
);

215  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
ZCL_CMD_ZONE_ENROLL_REQ
, 
TRUE
,

216 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 4, 
buf
);

217 
	}
}

219 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_°©usCh™geNŸifiˇti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eSètusCh™geNŸi_t
 *
pSètusCh™geNŸi
)

221 
u8
 
buf
[6];

223 
buf
[0] = 
	`LO_UINT16
(
pSètusCh™geNŸi
->
z⁄eSètus
);

224 
buf
[1] = 
	`HI_UINT16
(
pSètusCh™geNŸi
->
z⁄eSètus
);

225 
buf
[2] = 
pSètusCh™geNŸi
->
extSètus
;

226 
buf
[3] = 
pSètusCh™geNŸi
->
z⁄eId
;

227 
buf
[4] = 
	`LO_UINT16
(
pSètusCh™geNŸi
->
dñay
);

228 
buf
[5] = 
	`HI_UINT16
(
pSètusCh™geNŸi
->
dñay
);

230  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SS_IAS_ZONE
, 
ZCL_CMD_ZONE_STATUS_CHANGE_NOTIFICATION
, 
TRUE
,

231 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 6, 
buf
);

232 
	}
}

235 
_CODE_ZCL_
 
°©us_t
 
	$z˛_írﬁlR•Prc
(
z˛Incomög_t
 *
pInMsg
)

237 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

239 if(
pInMsg
->
˛u°îAµCb
){

240 
z⁄eEƒﬁlR•_t
 
z⁄eEƒﬁlR•
;

241 
z⁄eEƒﬁlR•
.
code
 = 
pInMsg
->
pD©a
[0];

242 
z⁄eEƒﬁlR•
.
z⁄eId
 = 
pInMsg
->
pD©a
[1];

244 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
z⁄eEƒﬁlR•
);

247  
°©us
;

248 
	}
}

250 
_CODE_ZCL_
 
°©us_t
 
	$z˛_öôN‹mÆO≥øti⁄ModePrc
(
z˛Incomög_t
 *
pInMsg
)

252 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

254 if(
pInMsg
->
˛u°îAµCb
){

255 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

258  
°©us
;

259 
	}
}

261 
_CODE_ZCL_
 
°©us_t
 
	$z˛_öôTe°ModePrc
(
z˛Incomög_t
 *
pInMsg
)

263 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

265 if(
pInMsg
->
˛u°îAµCb
){

266 
z⁄eInôTe°Mode_t
 
z⁄eInôTe°Mode
;

267 
z⁄eInôTe°Mode
.
ã°ModeDuøti⁄
 = 
pInMsg
->
pD©a
[0];

268 
z⁄eInôTe°Mode
.
cuºZ⁄eSísLevñ
 = 
pInMsg
->
pD©a
[1];

270 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
z⁄eInôTe°Mode
);

273  
°©us
;

274 
	}
}

276 
_CODE_ZCL_
 
°©us_t
 
	$z˛_z⁄eSètusCh™geNŸifiˇti⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

278 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

279 
u8
 *
pD©a
 = 
pInMsg
->pData;

281 if(
pInMsg
->
˛u°îAµCb
){

282 
z⁄eSètusCh™geNŸi_t
 
°©usCh™geNŸi
;

283 
°©usCh™geNŸi
.
z⁄eSètus
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

284 
pD©a
 += 2;

285 
°©usCh™geNŸi
.
extSètus
 = *
pD©a
++;

286 
°©usCh™geNŸi
.
z⁄eId
 = *
pD©a
++;

287 
°©usCh™geNŸi
.
dñay
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

288 
pD©a
 += 2;

290 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
°©usCh™geNŸi
);

293  
°©us
;

294 
	}
}

296 
_CODE_ZCL_
 
°©us_t
 
	$z˛_z⁄eEƒﬁlReqPrc
(
z˛Incomög_t
 *
pInMsg
)

298 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

299 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

300 
u8
 
ídpoöt
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

301 
u8
 *
pD©a
 = 
pInMsg
->pData;

303 
z⁄eEƒﬁlReq_t
 
írﬁlReq
;

305 
írﬁlReq
.
z⁄eTy≥
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

306 
pD©a
 += 2;

307 
írﬁlReq
.
m™uÁ˘uªrCode
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

308 
pD©a
 += 2;

310 
z⁄eEƒﬁlR•_t
 
írﬁlR•
;

311 
	`mem£t
((
u8
 *)&
írﬁlR•
, 0, (
z⁄eEƒﬁlR•_t
));

312 
írﬁlR•
.
z⁄eId
 = 0xFF;

314 if(
	`z˛_z⁄eTy≥M©ched
(
írﬁlReq
.
z⁄eTy≥
)){

315 
z˛_z⁄eTabÀ_t
 *
pZ⁄eTab
 = 
	`z˛_addZ⁄eE¡ry
(
ídpoöt
, 
írﬁlReq
.
z⁄eTy≥
, &(
írﬁlR•
.
code
));

316 if(
pZ⁄eTab
 && (
írﬁlR•
.
code
 =
ZONE_ENROLL_SUCC
)){

318 
	`zb_addªss_õì_by_sh‹t
(
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
, 
pZ⁄eTab
->
z⁄e
.
z⁄eAddr
);

320 
írﬁlR•
.
z⁄eId
 = 
pZ⁄eTab
->
z⁄e
.zoneId;

323 
írﬁlR•
.
code
 = 
ZONE_ENROLL_NOT_SUPPORTED
;

326 if(
pInMsg
->
˛u°îAµCb
){

327 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
írﬁlReq
);

330 
ïInfo_t
 
d°Ep
;

331 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

333 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

334 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

335 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

336 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

338 
	`z˛_üsZ⁄e_írﬁlR•
(
ídpoöt
, &
d°Ep
, 
TRUE
, 
pInMsg
->
hdr
.
£qNum
, &
írﬁlR•
);

340 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

342  
°©us
;

343 
	}
}

345 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

347 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

349 
pInMsg
->
hdr
.
cmd
)

351 
ZCL_CMD_ZONE_ENROLL_RSP
:

352 
°©us
 = 
	`z˛_írﬁlR•Prc
(
pInMsg
);

354 
ZCL_CMD_INIT_NORMAL_OPERATION_MODE
:

355 
°©us
 = 
	`z˛_öôN‹mÆO≥øti⁄ModePrc
(
pInMsg
);

357 
ZCL_CMD_INIT_TEST_MODE
:

358 
°©us
 = 
	`z˛_öôTe°ModePrc
(
pInMsg
);

361 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

365  
°©us
;

366 
	}
}

368 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

370 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

372 
pInMsg
->
hdr
.
cmd
)

374 
ZCL_CMD_ZONE_STATUS_CHANGE_NOTIFICATION
:

375 
°©us
 = 
	`z˛_z⁄eSètusCh™geNŸifiˇti⁄Prc
(
pInMsg
);

377 
ZCL_CMD_ZONE_ENROLL_REQ
:

378 
°©us
 = 
	`z˛_z⁄eEƒﬁlReqPrc
(
pInMsg
);

381 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

385  
°©us
;

386 
	}
}

388 
_CODE_ZCL_
 
°©us_t
 
	$z˛_üsZ⁄e_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

390 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

391  
	`z˛_üsZ⁄e_˛õ¡CmdH™dÀr
(
pInMsg
);

393  
	`z˛_üsZ⁄e_£rvîCmdH™dÀr
(
pInMsg
);

395 
	}
}

	@zigbee/zcl/security_safety/zcl_ias_zone.h

24 #i‚de‡
ZCL_IAS_ZONE_H


25 
	#ZCL_IAS_ZONE_H


	)

34 #i‚de‡
ZCL_ZONE_TABLE_NUM


35 
	#ZCL_ZONE_TABLE_NUM
 5

	)

41 
	#ZCL_CMD_ZONE_ENROLL_RSP
 0x00

	)

42 
	#ZCL_CMD_INIT_NORMAL_OPERATION_MODE
 0x01

	)

43 
	#ZCL_CMD_INIT_TEST_MODE
 0x02

	)

46 
	#ZCL_CMD_ZONE_STATUS_CHANGE_NOTIFICATION
 0x00

	)

47 
	#ZCL_CMD_ZONE_ENROLL_REQ
 0x01

	)

51 
	#ZCL_ATTRID_ZONE_STATE
 0x0000

	)

52 
	#ZCL_ATTRID_ZONE_TYPE
 0x0001

	)

53 
	#ZCL_ATTRID_ZONE_STATUS
 0x0002

	)

54 
	#ZCL_ATTRID_IAS_CIE_ADDR
 0x0010

	)

55 
	#ZCL_ATTRID_ZONE_ID
 0x0011

	)

59 
	#ZONE_STATE_NOT_ENROLLED
 0x00

	)

60 
	#ZONE_STATE_ENROLLED
 0x01

	)

64 
	#ZONE_TYPE_STANDARD_CIE
 0x0000

	)

65 
	#ZONE_TYPE_MOTION_SENSOR
 0x000D

	)

66 
	#ZONE_TYPE_CONTACT_SWITCH
 0x0015

	)

67 
	#ZONE_TYPE_DOOR_WINDOW_HANDLE
 0x0016

	)

68 
	#ZONE_TYPE_FIRE_SENSOR
 0x0028

	)

69 
	#ZONE_TYPE_WATER_SENSOR
 0x002A

	)

70 
	#ZONE_TYPE_CARBON_MONOXIDE_SENSOR
 0x002B

	)

71 
	#ZONE_TYPE_PERSONAL_EMERGENCY_DEV
 0x002C

	)

72 
	#ZONE_TYPE_VIBRATION_MOVEMENT_SENSOR
 0x002D

	)

73 
	#ZONE_TYPE_REMOTE_CONTROL
 0x010F

	)

74 
	#ZONE_TYPE_KEY_FOB
 0x0115

	)

75 
	#ZONE_TYPE_KEY_PAD
 0x021D

	)

76 
	#ZONE_TYPE_STANDARD_WARNING_DEV
 0x0225

	)

77 
	#ZONE_TYPE_GLASS_BREAK_SENSOR
 0x0226

	)

78 
	#ZONE_TYPE_SECURITY_REPEATER
 0x0229

	)

79 
	#ZONE_TYPE_INVALID_ZONE_TYPE
 0xFFFF

	)

83 
	#ZONE_STATUS_BIT_ALARM1
 0x0001

	)

84 
	#ZONE_STATUS_BIT_ALARM2
 0x0002

	)

85 
	#ZONE_STATUS_BIT_TAMPER
 0x0004

	)

86 
	#ZONE_STATUS_BIT_BATTERY
 0x0008

	)

87 
	#ZONE_STATUS_BIT_SUPERVISION_NOTIFY
 0x0010

	)

88 
	#ZONE_STATUS_BIT_RESTORE_NOTIFY
 0x0020

	)

89 
	#ZONE_STATUS_BIT_TROUBLE
 0x0040

	)

90 
	#ZONE_STATUS_BIT_AC_MAINS
 0x0080

	)

91 
	#ZONE_STATUS_TEST
 0x0100

	)

92 
	#ZONE_STATUS_BATTERY_DEFECT
 0x0200

	)

96 
	#ZONE_ENROLL_SUCC
 0x00

	)

97 
	#ZONE_ENROLL_NOT_SUPPORTED
 0x01

	)

98 
	#ZONE_ENROLL_NOT_ENROLL_PERMIT
 0x02

	)

99 
	#ZONE_ENROLL_TOO_MANY_ZONES
 0x03

	)

105 
	#ZCL_ZONE_MAX_ZONE_ID
 0xFE

	)

106 
	#ZCL_ZONE_ID_INVALID
 0xFF

	)

121 
u8
 
	mcode
;

122 
u8
 
	mz⁄eId
;

123 } 
	tz⁄eEƒﬁlR•_t
;

129 
u8
 
	mã°ModeDuøti⁄
;

130 
u8
 
	mcuºZ⁄eSísLevñ
;

131 } 
	tz⁄eInôTe°Mode_t
;

137 
u16
 
	mz⁄eSètus
;

138 
u8
 
	mextSètus
;

139 
u8
 
	mz⁄eId
;

140 
u16
 
	mdñay
;

141 } 
	tz⁄eSètusCh™geNŸi_t
;

147 
u16
 
	mz⁄eTy≥
;

148 
u16
 
	mm™uÁ˘uªrCode
;

149 } 
	tz⁄eEƒﬁlReq_t
;

156 
u8
 
	mz⁄eId
;

157 
u16
 
	mz⁄eTy≥
;

158 
addrExt_t
 
	mz⁄eAddr
;

159 } 
	tz˛_z⁄eTabE¡ry_t
;

165 
u8
 
	mu£d
;

166 
u8
 
	mídpoöt
;

167 
z˛_z⁄eTabE¡ry_t
 
	mz⁄e
;

168 } 
	tz˛_z⁄eTabÀ_t
;

170 
z˛_z⁄eTabÀ_t
 
g_z˛_z⁄eTab
[];

174 (*
	tz˛_írﬁlR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz⁄eEƒﬁlR•_t
 *
	tpZ⁄eEƒﬁlR•
);

175 
	$°©us_t
 (*
	tz˛_öôN‹mÆO≥øti⁄ModeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
);

176 
	$°©us_t
 (*
	tz˛_öôTe°ModeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz⁄eInôTe°Mode_t
 *
	tpZ⁄eInôTe°Mode
);

177 (*
	tz˛_°©usCh™geNŸifiˇti⁄Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz⁄eSètusCh™geNŸi_t
 *
	tpSètusCh™geNŸi
);

178 (*
	tz˛_írﬁlReqCb_t
)(
	t≠sdeD©aInd_t
 *
	tpApsdeInd
, 
	tz⁄eEƒﬁlReq_t
 *
	tpZ⁄eEƒﬁlReq
);

184 
z˛_írﬁlR•Cb_t
 
írﬁlR•CbFunc
;

185 
z˛_öôN‹mÆO≥øti⁄ModeCb_t
 
öôN‹mÆO≥øti⁄ModeCbFunc
;

186 
z˛_öôTe°ModeCb_t
 
öôTe°ModeCbFunc
;

187 
z˛_°©usCh™geNŸifiˇti⁄Cb_t
 
°©usCh™geNŸifiˇti⁄CbFunc
;

188 
z˛_írﬁlReqCb_t
 
írﬁlReqCbFunc
;

189 } 
	tz˛_üsZ⁄e_AµCÆlbacks_t
;

195 
u8
 
z˛_©å_z⁄eSèã
;

196 
u16
 
z˛_©å_z⁄eTy≥
;

197 
u16
 
z˛_©å_z⁄eSètus
;

198 
u8
 
z˛_©å_üsCõAddr
[8];

199 
u8
 
z˛_©å_z⁄eID
;

204 c⁄° 
z˛AârInfo_t
 
üsZ⁄e_©åTbl
[];

206 c⁄° 
u8
 
z˛_üsZ⁄e_©åNum
;

210 
°©us_t
 
	`z˛_üsZ⁄e_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

213 
°©us_t
 
	`z˛_üsZ⁄e_írﬁlReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eEƒﬁlReq_t
 *
pEƒﬁlReq
);

214 
	#z˛_üsZ⁄e_írﬁlReqCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsZ⁄e_írﬁlReq
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

216 
°©us_t
 
	`z˛_üsZ⁄e_öôN‹mÆO≥øti⁄Mode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

217 
	#z˛_üsZ⁄e_öôN‹mÆO≥øti⁄ModeCmd
(
a
,
b
,
c
Ë(
	`z˛_üsZ⁄e_öôN‹mÆO≥øti⁄Mode
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

219 
°©us_t
 
	`z˛_üsZ⁄e_öôTe°Mode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eInôTe°Mode_t
 *
pInôTe°Mode
);

220 
	#z˛_üsZ⁄e_öôTe°ModeCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsZ⁄e_öôTe°Mode
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

222 
°©us_t
 
	`z˛_üsZ⁄e_°©usCh™geNŸifiˇti⁄
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z⁄eSètusCh™geNŸi_t
 *
pSètusCh™geNŸi
);

223 
	#z˛_üsZ⁄e_°©usCh™geNŸifiˇti⁄Cmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_üsZ⁄e_°©usCh™geNŸifiˇti⁄
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

226 
z˛_z⁄eTabÀ_t
 *
	`z˛_födZ⁄eE¡ry
(
u8
 
ídpoöt
, u8 
z⁄eId
);

	@zigbee/zcl/security_safety/zcl_ias_zone_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_IAS_ZONE


49 
u8
 
	gz˛_©å_z⁄eSèã
 = 
ZONE_STATE_NOT_ENROLLED
;

50 
u16
 
	gz˛_©å_z⁄eTy≥
 = 0;

51 
u16
 
	gz˛_©å_z⁄eSètus
 = 0;

52 
u8
 
	gz˛_©å_üsCõAddr
[8] = {0};

53 
u8
 
	gz˛_©å_z⁄eID
 = 0xFF;

56 c⁄° 
z˛AârInfo_t
 
	güsZ⁄e_©åTbl
[] =

58 { 
ZCL_ATTRID_ZONE_STATE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_z⁄eSèã
 },

59 { 
ZCL_ATTRID_ZONE_TYPE
, 
ZCL_DATA_TYPE_ENUM16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_z⁄eTy≥
 },

60 { 
ZCL_ATTRID_ZONE_STATUS
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_z⁄eSètus
 },

61 { 
ZCL_ATTRID_IAS_CIE_ADDR
, 
ZCL_DATA_TYPE_IEEE_ADDR
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, 
z˛_©å_üsCõAddr
 },

62 { 
ZCL_ATTRID_ZONE_ID
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_z⁄eID
},

63 { 
ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_globÆ_˛u°îRevisi⁄
},

66 c⁄° 
u8
 
	gz˛_üsZ⁄e_©åNum
 = ( (
üsZ⁄e_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/smart_energy/zcl_metering.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_METERING


49 
°©us_t
 
z˛_mëîög_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

52 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

54  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_SE_METERING
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_mëîög_cmdH™dÀr
, 
cb
);

55 
	}
}

58 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_gëProfûe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_gëProfûeCmd_t
 *
pReq
)

60 
u8
 
buf
[6];

61 
u8
 *
pBuf
 = 
buf
;

63 *
pBuf
++ = 
pReq
->
öãrvÆCh™√l
;

64 *
pBuf
++ = 
	`U32_BYTE0
(
pReq
->
ídTime
);

65 *
pBuf
++ = 
	`U32_BYTE1
(
pReq
->
ídTime
);

66 *
pBuf
++ = 
	`U32_BYTE2
(
pReq
->
ídTime
);

67 *
pBuf
++ = 
	`U32_BYTE3
(
pReq
->
ídTime
);

68 *
pBuf
++ = 
pReq
->
numbîOfPîiods
;

70  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_GET_PROFILE
, 
TRUE
,

71 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

72 
	}
}

74 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Múr‹R•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Múr‹R•Cmd_t
 *
pR•
)

76 
u8
 
buf
[2];

77 
u8
 *
pBuf
 = 
buf
;

79 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
ídPoötId
);

80 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
ídPoötId
);

82  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_REQUEST_MIRROR_RESPONSE
, 
TRUE
,

83 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

84 
	}
}

86 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_múr‹Removed
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_múr‹RemovedCmd_t
 *
pR•
)

88 
u8
 
buf
[2];

89 
u8
 *
pBuf
 = 
buf
;

91 *
pBuf
++ = 
	`LO_UINT16
(
pR•
->
ªmovedEndPoötId
);

92 *
pBuf
++ = 
	`HI_UINT16
(
pR•
->
ªmovedEndPoötId
);

94  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_MIRROR_REMOVED
, 
TRUE
,

95 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

96 
	}
}

98 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Fa°PﬁlMode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Fa°PﬁlModeCmd_t
 *
pReq
)

100 
u8
 
buf
[2];

101 
u8
 *
pBuf
 = 
buf
;

103 *
pBuf
++ = 
pReq
->
Á°PﬁlUpd©ePîiod
;

104 *
pBuf
++ = 
pReq
->
duøti⁄
;

106  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_REQUEST_FAST_POLL_MODE
, 
TRUE
,

107 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

108 
	}
}

110 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_gëProfûeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_gëProfûeR•Cmd_t
 *
pR•
)

112 
u8
 
Àn
 = 4 + 1 + 1 + 1 + 
pR•
->
numbîOfPîiodsDñived
 * 3;

114 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

115 if(!
buf
){

116  
ZCL_STA_INSUFFICIENT_SPACE
;

119 
u8
 *
pBuf
 = 
buf
;

121 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
ídTime
);

122 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
ídTime
);

123 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
ídTime
);

124 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
ídTime
);

125 *
pBuf
++ = 
pR•
->
°©us
;

126 *
pBuf
++ = 
pR•
->
¥ofûeI¡îvÆPîiod
;

127 *
pBuf
++ = 
pR•
->
numbîOfPîiodsDñived
;

128 
	`mem˝y
(
pBuf
, 
pR•
->
öãrvÆs
,ÖR•->
numbîOfPîiodsDñived
 * 3);

129 
pBuf
 +(
pR•
->
numbîOfPîiodsDñived
 * 3);

131 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_GET_PROFILE_RESPONSE
, 
TRUE
,

132 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

134 
	`ev_buf_‰ì
(
buf
);

136  
ZCL_STA_SUCCESS
;

137 
	}
}

139 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Múr‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

141  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_REQUEST_MIRROR
, 
TRUE
,

142 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

143 
	}
}

145 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªmoveMúr‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

147  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_REMOVE_MIRROR
, 
TRUE
,

148 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

149 
	}
}

151 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Fa°PﬁlModeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Fa°PﬁlModeR•Cmd_t
 *
pR•
)

153 
u8
 
buf
[5];

154 
u8
 *
pBuf
 = 
buf
;

156 *
pBuf
++ = 
pR•
->
≠∂õdUpd©ePîiod
;

157 *
pBuf
++ = 
	`U32_BYTE0
(
pR•
->
Á°PﬁlModeEndTime
);

158 *
pBuf
++ = 
	`U32_BYTE1
(
pR•
->
Á°PﬁlModeEndTime
);

159 *
pBuf
++ = 
	`U32_BYTE2
(
pR•
->
Á°PﬁlModeEndTime
);

160 *
pBuf
++ = 
	`U32_BYTE3
(
pR•
->
Á°PﬁlModeEndTime
);

162  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_SE_METERING
, 
ZCL_CMD_REQUEST_FAST_POLL_MODE_RESPONSE
, 
TRUE
,

163 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, (
u8
)(
pBuf
 - 
buf
), buf);

164 
	}
}

167 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_gëProfûePrc
(
z˛Incomög_t
 *
pInMsg
)

169 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

171 
u8
 *
pD©a
 = 
pInMsg
->pData;

173 if(
pInMsg
->
˛u°îAµCb
){

174 
z˛_mëîög_gëProfûeCmd_t
 
gëProfûeCmd
;

175 
gëProfûeCmd
.
öãrvÆCh™√l
 = *
pD©a
++;

176 
gëProfûeCmd
.
ídTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

177 
pD©a
 += 4;

178 
gëProfûeCmd
.
numbîOfPîiods
 = *
pD©a
++;

180 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëProfûeCmd
);

182 
°©us
 = 
ZCL_STA_FAILURE
;

185  
°©us
;

186 
	}
}

188 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Múr‹R•Prc
(
z˛Incomög_t
 *
pInMsg
)

190 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

192 
u8
 *
pD©a
 = 
pInMsg
->pData;

194 if(
pInMsg
->
˛u°îAµCb
){

195 
z˛_mëîög_ªque°Múr‹R•Cmd_t
 
ªque°Múr‹R•Cmd
;

196 
ªque°Múr‹R•Cmd
.
ídPoötId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

198 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªque°Múr‹R•Cmd
);

200 
°©us
 = 
ZCL_STA_FAILURE
;

203  
°©us
;

204 
	}
}

206 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_múr‹RemovedPrc
(
z˛Incomög_t
 *
pInMsg
)

208 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

210 
u8
 *
pD©a
 = 
pInMsg
->pData;

212 if(
pInMsg
->
˛u°îAµCb
){

213 
z˛_mëîög_múr‹RemovedCmd_t
 
múr‹RemovedCmd
;

214 
múr‹RemovedCmd
.
ªmovedEndPoötId
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

216 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
múr‹RemovedCmd
);

218 
°©us
 = 
ZCL_STA_FAILURE
;

221  
°©us
;

222 
	}
}

224 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Fa°PﬁlModePrc
(
z˛Incomög_t
 *
pInMsg
)

226 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

228 
u8
 *
pD©a
 = 
pInMsg
->pData;

230 if(
pInMsg
->
˛u°îAµCb
){

231 
z˛_mëîög_ªque°Fa°PﬁlModeCmd_t
 
ªque°Fa°PﬁlModeCmd
;

232 
ªque°Fa°PﬁlModeCmd
.
Á°PﬁlUpd©ePîiod
 = *
pD©a
++;

233 
ªque°Fa°PﬁlModeCmd
.
duøti⁄
 = *
pD©a
++;

235 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªque°Fa°PﬁlModeCmd
);

237 
°©us
 = 
ZCL_STA_FAILURE
;

240  
°©us
;

241 
	}
}

243 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_gëProfûeR•Prc
(
z˛Incomög_t
 *
pInMsg
)

245 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

247 
u8
 *
pD©a
 = 
pInMsg
->pData;

249 if(
pInMsg
->
˛u°îAµCb
){

250 
z˛_mëîög_gëProfûeR•Cmd_t
 
gëProfûeR•Cmd
;

251 
gëProfûeR•Cmd
.
ídTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

252 
pD©a
 += 4;

253 
gëProfûeR•Cmd
.
°©us
 = *
pD©a
++;

254 
gëProfûeR•Cmd
.
¥ofûeI¡îvÆPîiod
 = *
pD©a
++;

255 
gëProfûeR•Cmd
.
numbîOfPîiodsDñived
 = *
pD©a
++;

256 
gëProfûeR•Cmd
.
öãrvÆs
 = 
pD©a
;

258 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
gëProfûeR•Cmd
);

260 
°©us
 = 
ZCL_STA_FAILURE
;

263  
°©us
;

264 
	}
}

266 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Múr‹Prc
(
z˛Incomög_t
 *
pInMsg
)

268 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

272 if(
pInMsg
->
˛u°îAµCb
){

273 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

275 
°©us
 = 
ZCL_STA_FAILURE
;

278  
°©us
;

279 
	}
}

281 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªmoveMúr‹Prc
(
z˛Incomög_t
 *
pInMsg
)

283 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

287 if(
pInMsg
->
˛u°îAµCb
){

288 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

290 
°©us
 = 
ZCL_STA_FAILURE
;

293  
°©us
;

294 
	}
}

296 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_ªque°Fa°PﬁlModeR•Prc
(
z˛Incomög_t
 *
pInMsg
)

298 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

300 
u8
 *
pD©a
 = 
pInMsg
->pData;

302 if(
pInMsg
->
˛u°îAµCb
){

303 
z˛_mëîög_ªque°Fa°PﬁlModeR•Cmd_t
 
ªque°Fa°PﬁlModeR•Cmd
;

304 
ªque°Fa°PﬁlModeR•Cmd
.
≠∂õdUpd©ePîiod
 = *
pD©a
++;

305 
ªque°Fa°PﬁlModeR•Cmd
.
Á°PﬁlModeEndTime
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

307 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
ªque°Fa°PﬁlModeR•Cmd
);

309 
°©us
 = 
ZCL_STA_FAILURE
;

312  
°©us
;

313 
	}
}

315 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

317 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

319 
pInMsg
->
hdr
.
cmd
){

320 
ZCL_CMD_GET_PROFILE
:

321 
°©us
 = 
	`z˛_mëîög_gëProfûePrc
(
pInMsg
);

323 
ZCL_CMD_REQUEST_MIRROR_RESPONSE
:

324 
°©us
 = 
	`z˛_mëîög_ªque°Múr‹R•Prc
(
pInMsg
);

326 
ZCL_CMD_MIRROR_REMOVED
:

327 
°©us
 = 
	`z˛_mëîög_múr‹RemovedPrc
(
pInMsg
);

329 
ZCL_CMD_REQUEST_FAST_POLL_MODE
:

330 
°©us
 = 
	`z˛_mëîög_ªque°Fa°PﬁlModePrc
(
pInMsg
);

333 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

337  
°©us
;

338 
	}
}

340 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

342 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

344 
pInMsg
->
hdr
.
cmd
){

345 
ZCL_CMD_GET_PROFILE_RESPONSE
:

346 
°©us
 = 
	`z˛_mëîög_gëProfûeR•Prc
(
pInMsg
);

348 
ZCL_CMD_REQUEST_MIRROR
:

349 
°©us
 = 
	`z˛_mëîög_ªque°Múr‹Prc
(
pInMsg
);

351 
ZCL_CMD_REMOVE_MIRROR
:

352 
°©us
 = 
	`z˛_mëîög_ªmoveMúr‹Prc
(
pInMsg
);

354 
ZCL_CMD_REQUEST_FAST_POLL_MODE_RESPONSE
:

355 
°©us
 = 
	`z˛_mëîög_ªque°Fa°PﬁlModeR•Prc
(
pInMsg
);

358 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

362  
°©us
;

363 
	}
}

365 
_CODE_ZCL_
 
°©us_t
 
	$z˛_mëîög_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

367 if(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
){

368  
	`z˛_mëîög_˛õ¡CmdH™dÀr
(
pInMsg
);

370  
	`z˛_mëîög_£rvîCmdH™dÀr
(
pInMsg
);

372 
	}
}

	@zigbee/zcl/smart_energy/zcl_metering.h

24 #i‚de‡
ZCL_METERING_H


25 
	#ZCL_METERING_H


	)

35 
	#READING_INFORMATION_SET
 0x00

	)

36 
	#TOU_INFORMATION_SET
 0x01

	)

37 
	#METER_STATUS
 0x02

	)

38 
	#FORMATTING
 0x03

	)

39 
	#HISTORICAL_CONSUMPTION
 0x04

	)

40 
	#LOAD_PROFILE_CONFIGURATION
 0x05

	)

41 
	#SUPPLY_LIMIT
 0x06

	)

42 
	#BLOCK_INFORMATION
 0x07

	)

43 
	#ALARMS
 0x08

	)

49 
	#ZCL_ATTRID_CURRENT_SUMMATION_DELIVERD
 0x0000

	)

50 
	#ZCL_ATTRID_CURRENT_SUMMATION_RECEIVED
 0x0001

	)

51 
	#ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD
 0x0002

	)

52 
	#ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED
 0x0003

	)

53 
	#ZCL_ATTRID_DFT_SUMMATION
 0x0004

	)

54 
	#ZCL_ATTRID_DAILY_FREEZE_TIME
 0x0005

	)

55 
	#ZCL_ATTRID_METERING_POWER_FACTOR
 0x0006

	)

56 
	#ZCL_ATTRID_READING_SNAP_SHORT_TIME
 0x0007

	)

57 
	#ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_TIME
 0x0008

	)

58 
	#ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_TIME
 0x0009

	)

59 
	#ZCL_ATTRID_DEFAULT_UPDATE_PERIOD
 0x000A

	)

60 
	#ZCL_ATTRID_FAST_POLL_UPDATE_PERIOD
 0x000B

	)

61 
	#ZCL_ATTRID_CURRENT_BLOCK_PERIOD_CONSUMPTION_DELIVERD
 0x000C

	)

62 
	#ZCL_ATTRID_DAILY_CONSUMPTION_TARGET
 0x000D

	)

63 
	#ZCL_ATTRID_CURRENT_BLOCK
 0x000E

	)

64 
	#ZCL_ATTRID_PROFILE_INTERVAL_PERIOD
 0x000F

	)

65 
	#ZCL_ATTRID_INTERVAL_READ_REPORTING_PERIOD
 0x0010

	)

66 
	#ZCL_ATTRID_PRESENT_READING_TIME
 0x0011

	)

67 
	#ZCL_ATTRID_VOLUME_PER_REPORT
 0x0012

	)

68 
	#ZCL_ATTRID_FLOW_RESTRICTION
 0x0013

	)

69 
	#ZCL_ATTRID_SUPPLY_STATUS
 0x0014

	)

70 
	#ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_SUMMATION
 0x0015

	)

71 
	#ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_SUMMATION
 0x0016

	)

72 
	#ZCL_ATTRID_INLET_TEMPERATURE
 0x0017

	)

73 
	#ZCL_ATTRID_OUTLET_TEMPERATURE
 0x0018

	)

74 
	#ZCL_ATTRID_CONTROL_TEMPERATURE
 0x0019

	)

75 
	#ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_DEMAND
 0x001A

	)

76 
	#ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_DEMAND
 0x001B

	)

77 
	#ZCL_ATTRID_PREVIOUS_BLOCK_PERIOD_CONSUMPTION_DELIVERD
 0x001C

	)

79 
	#ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_DELIVERD
 0x0100

	)

80 
	#ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_RECEIVED
 0x0101

	)

81 
	#ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_DELIVERD
 0x0102

	)

82 
	#ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_RECEIVED
 0x0103

	)

83 
	#ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_DELIVERD
 0x0104

	)

84 
	#ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_RECEIVED
 0x0105

	)

85 
	#ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_DELIVERD
 0x0106

	)

86 
	#ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_RECEIVED
 0x0107

	)

87 
	#ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_DELIVERD
 0x0108

	)

88 
	#ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_RECEIVED
 0x0109

	)

89 
	#ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_DELIVERD
 0x010A

	)

90 
	#ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_RECEIVED
 0x010B

	)

91 
	#ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_DELIVERD
 0x010C

	)

92 
	#ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_RECEIVED
 0x010D

	)

93 
	#ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_DELIVERD
 0x010E

	)

94 
	#ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_RECEIVED
 0x010F

	)

95 
	#ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_DELIVERD
 0x0110

	)

96 
	#ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_RECEIVED
 0x0111

	)

97 
	#ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_DELIVERD
 0x0112

	)

98 
	#ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_RECEIVED
 0x0113

	)

99 
	#ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_DELIVERD
 0x0114

	)

100 
	#ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_RECEIVED
 0x0115

	)

101 
	#ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_DELIVERD
 0x0116

	)

102 
	#ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_RECEIVED
 0x0117

	)

103 
	#ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_DELIVERD
 0x0118

	)

104 
	#ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_RECEIVED
 0x0119

	)

105 
	#ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_DELIVERD
 0x011A

	)

106 
	#ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_RECEIVED
 0x011B

	)

107 
	#ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_DELIVERD
 0x011C

	)

108 
	#ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_RECEIVED
 0x011D

	)

110 
	#ZCL_ATTRID_STATUS
 0x0200

	)

111 
	#ZCL_ATTRID_REMAINING_BATTERY_LIFE
 0x0201

	)

112 
	#ZCL_ATTRID_HOURS_IN_OPERATION
 0x0202

	)

113 
	#ZCL_ATTRID_HOURS_IN_FAULT
 0x0203

	)

115 
	#ZCL_ATTRID_UNIT_OF_MEASURE
 0x0300

	)

116 
	#ZCL_ATTRID_MULTIPLIER
 0x0301

	)

117 
	#ZCL_ATTRID_DIVISOR
 0x0302

	)

118 
	#ZCL_ATTRID_SUMMATION_FORMATTING
 0x0303

	)

119 
	#ZCL_ATTRID_DEMAND_FORMATTING
 0x0304

	)

120 
	#ZCL_ATTRID_HISTORICAL_CONSUMPTION_FORMATTING
 0x0305

	)

121 
	#ZCL_ATTRID_METERING_DEVICE_TYPE
 0x0306

	)

122 
	#ZCL_ATTRID_SITE_ID
 0x0307

	)

123 
	#ZCL_ATTRID_METER_SERIAL_NUMBER
 0x0308

	)

124 
	#ZCL_ATTRID_ENERGY_CARRIER_UNIT_OF_MEASURE
 0x0309

	)

125 
	#ZCL_ATTRID_ENERGY_CARRIER_SUMMATION_FORMATTING
 0x030A

	)

126 
	#ZCL_ATTRID_ENERGY_CARRIER_DEMAND_FORMATTING
 0x030B

	)

127 
	#ZCL_ATTRID_TEMPERATURE_UNIT_OF_MEASURE
 0x030C

	)

128 
	#ZCL_ATTRID_TEMPERATURE_FORMATTING
 0x030D

	)

130 
	#ZCL_ATTRID_INSTANTANEOUS_DEMAND
 0x0400

	)

131 
	#ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_DELIVERD
 0x0401

	)

132 
	#ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_RECEIVED
 0x0402

	)

133 
	#ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_DELIVERD
 0x0403

	)

134 
	#ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_RECEIVED
 0x0404

	)

135 
	#ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_DELIVERD
 0x0405

	)

136 
	#ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_REVEIVED
 0x0406

	)

137 
	#ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_DELIVERD
 0x0407

	)

138 
	#ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_REVEIVED
 0x0408

	)

139 
	#ZCL_ATTRID_CURRENT_DAY_MAX_PRESSURE
 0x0409

	)

140 
	#ZCL_ATTRID_CURRENT_DAY_MIN_PRESSURE
 0x040A

	)

141 
	#ZCL_ATTRID_PREVIOUS_DAY_MAX_PRESSURE
 0x040B

	)

142 
	#ZCL_ATTRID_PREVIOUS_DAY_MIN_PRESSURE
 0x040C

	)

143 
	#ZCL_ATTRID_CURRENT_DAY_MAX_DEMAND
 0x040D

	)

144 
	#ZCL_ATTRID_PREVIOUS_DAY_MAX_DEMAND
 0x040E

	)

145 
	#ZCL_ATTRID_CURRENT_MONTH_MAX_DEMAND
 0x040F

	)

146 
	#ZCL_ATTRID_CURRENT_YEAR_MAX_DEMAND
 0x0410

	)

147 
	#ZCL_ATTRID_CURRENT_DAY_MAX_ENERGY_CARRIER_DEMAND
 0x0411

	)

148 
	#ZCL_ATTRID_PREVIOUS_DAY_MAX_ENERGY_CARRIER_DEMAND
 0x0412

	)

149 
	#ZCL_ATTRID_CURRENT_MONTH_MAX_ENERGY_CARRIER_DEMAND
 0x0413

	)

150 
	#ZCL_ATTRID_CURRENT_MONTH_MIN_ENERGY_CARRIER_DEMAND
 0x0414

	)

151 
	#ZCL_ATTRID_CURRENT_YEAR_MAX_ENERGY_CARRIER_DEMAND
 0x0415

	)

152 
	#ZCL_ATTRID_CURRENT_YEAR_MIN_ENERGY_CARRIER_DEMAND
 0x0416

	)

154 
	#ZCL_ATTRID_MAX_NUMBER_OF_PERIODS_DELIVERD
 0x0500

	)

156 
	#ZCL_ATTRID_CURRENT_DEMAND_DELIVERD
 0x0600

	)

157 
	#ZCL_ATTRID_DEMAND_LIMIT
 0x0601

	)

158 
	#ZCL_ATTRID_DEMAND_INTEGRATION_PERIOD
 0x0602

	)

159 
	#ZCL_ATTRID_NUMBER_OF_DEMAND_SUB_INTERVALS
 0x0603

	)

161 
	#ZCL_ATTRID_CURRENT_NO_TIER_BLOCK_1_SUMMATION_DELIVERD
 0x0700

	)

162 
	#ZCL_ATTRID_CURRENT_TIER_1_BLOCK_1_SUMMATION_DELIVERD
 0x0710

	)

163 
	#ZCL_ATTRID_CURRENT_TIER_2_BLOCK_1_SUMMATION_DELIVERD
 0x0720

	)

164 
	#ZCL_ATTRID_CURRENT_TIER_3_BLOCK_1_SUMMATION_DELIVERD
 0x0730

	)

165 
	#ZCL_ATTRID_CURRENT_TIER_4_BLOCK_1_SUMMATION_DELIVERD
 0x0740

	)

166 
	#ZCL_ATTRID_CURRENT_TIER_5_BLOCK_1_SUMMATION_DELIVERD
 0x0750

	)

167 
	#ZCL_ATTRID_CURRENT_TIER_6_BLOCK_1_SUMMATION_DELIVERD
 0x0760

	)

168 
	#ZCL_ATTRID_CURRENT_TIER_7_BLOCK_1_SUMMATION_DELIVERD
 0x0770

	)

169 
	#ZCL_ATTRID_CURRENT_TIER_8_BLOCK_1_SUMMATION_DELIVERD
 0x0780

	)

170 
	#ZCL_ATTRID_CURRENT_TIER_9_BLOCK_1_SUMMATION_DELIVERD
 0x0790

	)

171 
	#ZCL_ATTRID_CURRENT_TIER_10_BLOCK_1_SUMMATION_DELIVERD
 0x07A0

	)

172 
	#ZCL_ATTRID_CURRENT_TIER_11_BLOCK_1_SUMMATION_DELIVERD
 0x07B0

	)

173 
	#ZCL_ATTRID_CURRENT_TIER_12_BLOCK_1_SUMMATION_DELIVERD
 0x07C0

	)

174 
	#ZCL_ATTRID_CURRENT_TIER_13_BLOCK_1_SUMMATION_DELIVERD
 0x07D0

	)

175 
	#ZCL_ATTRID_CURRENT_TIER_14_BLOCK_1_SUMMATION_DELIVERD
 0x07E0

	)

176 
	#ZCL_ATTRID_CURRENT_TIER_15_BLOCK_1_SUMMATION_DELIVERD
 0x07F0

	)

178 
	#ZCL_ATTRID_GENERIC_ALARM_MASK
 0x0800

	)

179 
	#ZCL_ATTRID_ELECTRICITY_ALARM_MASK
 0x0801

	)

180 
	#ZCL_ATTRID_GENERIC_FLOW_PRESSURE_ALARM_MASK
 0x0802

	)

181 
	#ZCL_ATTRID_WATER_SPEC_ALARM_MASK
 0x0803

	)

182 
	#ZCL_ATTRID_HEAT_AND_COOLING_SPEC_ALARM_MASK
 0x0804

	)

183 
	#ZCL_ATTRID_GAS_SPEC_ALARM_MASK
 0x0805

	)

189 
	#ZCL_CMD_GET_PROFILE_RESPONSE
 0x00

	)

190 
	#ZCL_CMD_REQUEST_MIRROR
 0x01

	)

191 
	#ZCL_CMD_REMOVE_MIRROR
 0x02

	)

192 
	#ZCL_CMD_REQUEST_FAST_POLL_MODE_RESPONSE
 0x03

	)

194 
	#ZCL_CMD_GET_PROFILE
 0x00

	)

195 
	#ZCL_CMD_REQUEST_MIRROR_RESPONSE
 0x01

	)

196 
	#ZCL_CMD_MIRROR_REMOVED
 0x02

	)

197 
	#ZCL_CMD_REQUEST_FAST_POLL_MODE
 0x03

	)

205 
UTCTime
 
	mídTime
;

206 
u8
 
	möãrvÆCh™√l
;

207 
u8
 
	mnumbîOfPîiods
;

208 }
	tz˛_mëîög_gëProfûeCmd_t
;

215 
u16
 
	mídPoötId
;

216 }
	tz˛_mëîög_ªque°Múr‹R•Cmd_t
;

223 
u16
 
	mªmovedEndPoötId
;

224 }
	tz˛_mëîög_múr‹RemovedCmd_t
;

231 
u8
 
	mÁ°PﬁlUpd©ePîiod
;

232 
u8
 
	mduøti⁄
;

233 }
	tz˛_mëîög_ªque°Fa°PﬁlModeCmd_t
;

240 
UTCTime
 
	mídTime
;

241 
u8
 
	m°©us
;

242 
u8
 
	m¥ofûeI¡îvÆPîiod
;

243 
u8
 
	mnumbîOfPîiodsDñived
;

244 
u8
 *
	möãrvÆs
;

245 }
	tz˛_mëîög_gëProfûeR•Cmd_t
;

252 
UTCTime
 
	mÁ°PﬁlModeEndTime
;

253 
u8
 
	m≠∂õdUpd©ePîiod
;

254 }
	tz˛_mëîög_ªque°Fa°PﬁlModeR•Cmd_t
;

257 
	$°©us_t
 (*
	tz˛_mëîög_gëProfûeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_gëProfûeCmd_t
 *
	tpCmd
);

258 
	$°©us_t
 (*
	tz˛_mëîög_ªque°Múr‹R•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_ªque°Múr‹R•Cmd_t
 *
	tpCmd
);

259 
	$°©us_t
 (*
	tz˛_mëîög_múr‹RemovedCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_múr‹RemovedCmd_t
 *
	tpCmd
);

260 
	$°©us_t
 (*
	tz˛_mëîög_ªque°Fa°PﬁlModeCb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_ªque°Fa°PﬁlModeCmd_t
 *
	tpCmd
);

261 
	$°©us_t
 (*
	tz˛_mëîög_gëProfûeR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_gëProfûeR•Cmd_t
 *
	tpCmd
);

262 
	$°©us_t
 (*
	tz˛_mëîög_ªque°Múr‹Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
);

263 
	$°©us_t
 (*
	tz˛_mëîög_ªmoveMúr‹Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
);

264 
	$°©us_t
 (*
	tz˛_mëîög_ªque°Fa°PﬁlModeR•Cb_t
)(
	t≠sdeD©aInd_t
 *
	tpInd
, 
	tz˛_mëîög_ªque°Fa°PﬁlModeR•Cmd_t
 *
	tpCmd
);

271 
z˛_mëîög_gëProfûeCb_t
 
gëProfûeCbFunc
;

272 
z˛_mëîög_ªque°Múr‹R•Cb_t
 
ªque°Múr‹R•CbFunc
;

273 
z˛_mëîög_múr‹RemovedCb_t
 
múr‹RemovedCbFunc
;

274 
z˛_mëîög_ªque°Fa°PﬁlModeCb_t
 
ªque°Fa°PﬁlModeCbFunc
;

275 
z˛_mëîög_gëProfûeR•Cb_t
 
gëProfûeR•CbFunc
;

276 
z˛_mëîög_ªque°Múr‹Cb_t
 
ªque°Múr‹CbFunc
;

277 
z˛_mëîög_ªmoveMúr‹Cb_t
 
ªmoveMúr‹CbFunc
;

278 
z˛_mëîög_ªque°Fa°PﬁlModeR•Cb_t
 
ªque°Fa°PﬁlModeR•CbFunc
;

279 }
	tz˛_mëîög_AµCÆlbacks_t
;

283 c⁄° 
z˛AârInfo_t
 
mëîög_©åTbl
[];

284 c⁄° 
u8
 
z˛_mëîög_©åNum
;

288 
°©us_t
 
	`z˛_mëîög_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

290 
°©us_t
 
	`z˛_mëîög_gëProfûe
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_gëProfûeCmd_t
 *
pReq
);

291 
	#z˛_mëîög_gëProfûeCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_mëîög_gëProfûe
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

293 
	`z˛_mëîög_ªque°Múr‹R•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Múr‹R•Cmd_t
 *
pR•
);

294 
	#z˛_mëîög_ªque°Múr‹R•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_mëîög_ªque°Múr‹R•
(◊), (b), (c), (d), (e)))

	)

296 
	`z˛_mëîög_múr‹Removed
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_múr‹RemovedCmd_t
 *
pR•
);

297 
	#z˛_mëîög_múr‹RemovedCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_mëîög_múr‹Removed
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

299 
	`z˛_mëîög_ªque°Fa°PﬁlMode
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Fa°PﬁlModeCmd_t
 *
pReq
);

300 
	#z˛_mëîög_ªque°Fa°PﬁlModeCmd
(
a
,
b
,
c
,
d
Ë(
	`z˛_mëîög_ªque°Fa°PﬁlMode
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

302 
	`z˛_mëîög_gëProfûeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_gëProfûeR•Cmd_t
 *
pR•
);

303 
	#z˛_mëîög_gëProfûeR•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_mëîög_gëProfûeR•
(◊), (b), (c), (d), (e)))

	)

305 
	`z˛_mëîög_ªque°Múr‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

306 
	#z˛_mëîög_ªque°Múr‹Cmd
(
a
,
b
,
c
Ë(
	`z˛_mëîög_ªque°Múr‹
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

308 
	`z˛_mëîög_ªmoveMúr‹
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

309 
	#z˛_mëîög_ªmoveMúr‹Cmd
(
a
,
b
,
c
Ë(
	`z˛_mëîög_ªmoveMúr‹
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

311 
	`z˛_mëîög_ªque°Fa°PﬁlModeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_mëîög_ªque°Fa°PﬁlModeR•Cmd_t
 *
pR•
);

312 
	#z˛_mëîög_ªque°Fa°PﬁlModeR•Cmd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_mëîög_ªque°Fa°PﬁlModeR•
(◊), (b), (c), (d), (e)))

	)

	@zigbee/zcl/smart_energy/zcl_metering_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_METERING


49 #ifde‡
ZCL_ATTRID_CURRENT_SUMMATION_DELIVERD_ENABLE


50 
u8
 
	gz˛_©å_cuºítSumm©i⁄Dñivîed
[6] = {0};

52 #ifde‡
ZCL_ATTRID_CURRENT_SUMMATION_RECEIVED_ENABLE


53 
u8
 
	gz˛_©å_cuºítSumm©i⁄Re˚ived
[6] = {0};

55 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_ENABLE


56 
u8
 
	gz˛_©å_cuºítMaxDem™dDñivîed
[6] = {0};

58 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_ENABLE


59 
u8
 
	gz˛_©å_cuºítMaxDem™dRe˚ived
[6] = {0};

61 #ifde‡
ZCL_ATTRID_DFT_SUMMATION_ENABLE


62 
u8
 
	gz˛_©å_DFTSumm©i⁄
[6] = {0};

64 #ifde‡
ZCL_ATTRID_DAILY_FREEZE_TIME_ENABLE


65 
u16
 
	gz˛_©å_daûyFªezeTime
 = 0x0000;

67 #ifde‡
ZCL_ATTRID_METERING_POWER_FACTOR_ENABLE


68 
s8
 
	gz˛_©å_mëîög_powîFa˘‹
 = 0x00;

70 #ifde‡
ZCL_ATTRID_READING_SNAP_SHORT_TIME_ENABLE


71 
UTCTime
 
	gz˛_©å_ªadögS«pShŸTime
 = 0x0;

73 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_TIME_ENABLE


74 
UTCTime
 
	gz˛_©å_cuºítMaxDem™dDñivîedTime
 = 0x0;

76 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_TIME_ENABLE


77 
UTCTime
 
	gz˛_©å_cuºítMaxDem™dRe˚ivedTime
 = 0x0;

79 #ifde‡
ZCL_ATTRID_DEFAULT_UPDATE_PERIOD_ENABLE


80 
u8
 
	gz˛_©å_deÁu…Upd©ePîiod
 = 0x1E;

82 #ifde‡
ZCL_ATTRID_FAST_POLL_UPDATE_PERIOD_ENABLE


83 
u8
 
	gz˛_©å_Á°PﬁlUpd©ePîiod
 = 0x05;

85 #ifde‡
ZCL_ATTRID_CURRENT_BLOCK_PERIOD_CONSUMPTION_DELIVERD_ENABLE


86 
u8
 
	gz˛_©å_cuºítBlockPîiodC⁄sum±i⁄Dñivîed
[6] = {0};

88 #ifde‡
ZCL_ATTRID_DAILY_CONSUMPTION_TARGET_ENABLE


89 
u24
 
	gz˛_©å_daûyC⁄sum±i⁄T¨gë
 = 0x000000;

91 #ifde‡
ZCL_ATTRID_CURRENT_BLOCK_ENABLE


92 
u8
 
	gz˛_©å_cuºítBlock
 = 0x00;

94 #ifde‡
ZCL_ATTRID_PROFILE_INTERVAL_PERIOD_ENABLE


95 
u8
 
	gz˛_©å_¥ofûeI¡îvÆPîiod
 = 0x00;

97 #ifde‡
ZCL_ATTRID_INTERVAL_READ_REPORTING_PERIOD_ENABLE


98 
u16
 
	gz˛_©å_öãrvÆRódRï‹tögPîiod
 = 0x0000;

100 #ifde‡
ZCL_ATTRID_PRESENT_READING_TIME_ENABLE


101 
u16
 
	gz˛_©å_¥e£tRódögTime
 = 0x0000;

103 #ifde‡
ZCL_ATTRID_VOLUME_PER_REPORT_ENABLE


104 
u16
 
	gz˛_©å_vﬁumePîRï‹t
 = 0x0000;

106 #ifde‡
ZCL_ATTRID_FLOW_RESTRICTION_ENABLE


107 
u8
 
	gz˛_©å_ÊowRe°ri˘i⁄
 = 0x05;

109 #ifde‡
ZCL_ATTRID_SUPPLY_STATUS_ENABLE


110 
u8
 
	gz˛_©å_suµlySètus
 = 0x00;

112 #ifde‡
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_SUMMATION_ENABLE


113 
u8
 
	gz˛_©å_cuºítI∆ëE√rgyC¨rõrSumm©i⁄
[6] = {0};

115 #ifde‡
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_SUMMATION_ENABLE


116 
u8
 
	gz˛_©å_cuºítOuéëE√rgyC¨rõrSumm©i⁄
[6] = {0};

118 #ifde‡
ZCL_ATTRID_INLET_TEMPERATURE_ENABLE


119 
s24
 
	gz˛_©å_öÀtTem≥øtuª
 = 0x000000;

121 #ifde‡
ZCL_ATTRID_OUTLET_TEMPERATURE_ENABLE


122 
s24
 
	gz˛_©å_ouéëTem≥øtuª
 = 0x000000;

124 #ifde‡
ZCL_ATTRID_CONTROL_TEMPERATURE_ENABLE


125 
s24
 
	gz˛_©å_c⁄åﬁTem≥øtuª
 = 0x000000;

127 #ifde‡
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_DEMAND_ENABLE


128 
s24
 
	gz˛_©å_cuºítI∆ëE√rgyC¨rõrDem™d
 = 0x000000;

130 #ifde‡
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_DEMAND_ENABLE


131 
s24
 
	gz˛_©å_cuºítOuéëE√rgyC¨rõrDem™d
 = 0x000000;

133 #ifde‡
ZCL_ATTRID_PREVIOUS_BLOCK_PERIOD_CONSUMPTION_DELIVERD_ENABLE


134 
u8
 
	gz˛_©å_¥eviousBlockPîiodC⁄sum±i⁄Dñivîed
[6] = {0};

138 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_DELIVERD_ENABLE


139 
u8
 
	gz˛_©å_cuºítTõr1Summ©i⁄Dñivîed
[6] = {0};

141 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_RECEIVED_ENABLE


142 
u8
 
	gz˛_©å_cuºítTõr1Summ©i⁄Re˚ived
[6] = {0};

144 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_DELIVERD_ENABLE


145 
u8
 
	gz˛_©å_cuºítTõr2Summ©i⁄Dñivîed
[6] = {0};

147 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_RECEIVED_ENABLE


148 
u8
 
	gz˛_©å_cuºítTõr2Summ©i⁄Re˚ived
[6] = {0};

150 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_DELIVERD_ENABLE


151 
u8
 
	gz˛_©å_cuºítTõr3Summ©i⁄Dñivîed
[6] = {0};

153 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_RECEIVED_ENABLE


154 
u8
 
	gz˛_©å_cuºítTõr3Summ©i⁄Re˚ived
[6] = {0};

156 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_DELIVERD_ENABLE


157 
u8
 
	gz˛_©å_cuºítTõr4Summ©i⁄Dñivîed
[6] = {0};

159 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_RECEIVED_ENABLE


160 
u8
 
	gz˛_©å_cuºítTõr4Summ©i⁄Re˚ived
[6] = {0};

162 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_DELIVERD_ENABLE


163 
u8
 
	gz˛_©å_cuºítTõr5Summ©i⁄Dñivîed
[6] = {0};

165 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_RECEIVED_ENABLE


166 
u8
 
	gz˛_©å_cuºítTõr5Summ©i⁄Re˚ived
[6] = {0};

168 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_DELIVERD_ENABLE


169 
u8
 
	gz˛_©å_cuºítTõr6Summ©i⁄Dñivîed
[6] = {0};

171 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_RECEIVED_ENABLE


172 
u8
 
	gz˛_©å_cuºítTõr6Summ©i⁄Re˚ived
[6] = {0};

174 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_DELIVERD_ENABLE


175 
u8
 
	gz˛_©å_cuºítTõr7Summ©i⁄Dñivîed
[6] = {0};

177 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_RECEIVED_ENABLE


178 
u8
 
	gz˛_©å_cuºítTõr7Summ©i⁄Re˚ived
[6] = {0};

180 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_DELIVERD_ENABLE


181 
u8
 
	gz˛_©å_cuºítTõr8Summ©i⁄Dñivîed
[6] = {0};

183 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_RECEIVED_ENABLE


184 
u8
 
	gz˛_©å_cuºítTõr8Summ©i⁄Re˚ived
[6] = {0};

186 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_DELIVERD_ENABLE


187 
u8
 
	gz˛_©å_cuºítTõr9Summ©i⁄Dñivîed
[6] = {0};

189 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_RECEIVED_ENABLE


190 
u8
 
	gz˛_©å_cuºítTõr9Summ©i⁄Re˚ived
[6] = {0};

192 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_DELIVERD_ENABLE


193 
u8
 
	gz˛_©å_cuºítTõr10Summ©i⁄Dñivîed
[6] = {0};

195 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_RECEIVED_ENABLE


196 
u8
 
	gz˛_©å_cuºítTõr10Summ©i⁄Re˚ived
[6] = {0};

198 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_DELIVERD_ENABLE


199 
u8
 
	gz˛_©å_cuºítTõr11Summ©i⁄Dñivîed
[6] = {0};

201 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_RECEIVED_ENABLE


202 
u8
 
	gz˛_©å_cuºítTõr11Summ©i⁄Re˚ived
[6] = {0};

204 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_DELIVERD_ENABLE


205 
u8
 
	gz˛_©å_cuºítTõr12Summ©i⁄Dñivîed
[6] = {0};

207 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_RECEIVED_ENABLE


208 
u8
 
	gz˛_©å_cuºítTõr12Summ©i⁄Re˚ived
[6] = {0};

210 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_DELIVERD_ENABLE


211 
u8
 
	gz˛_©å_cuºítTõr13Summ©i⁄Dñivîed
[6] = {0};

213 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_RECEIVED_ENABLE


214 
u8
 
	gz˛_©å_cuºítTõr13Summ©i⁄Re˚ived
[6] = {0};

216 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_DELIVERD_ENABLE


217 
u8
 
	gz˛_©å_cuºítTõr14Summ©i⁄Dñivîed
[6] = {0};

219 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_RECEIVED_ENABLE


220 
u8
 
	gz˛_©å_cuºítTõr14Summ©i⁄Re˚ived
[6] = {0};

222 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_DELIVERD_ENABLE


223 
u8
 
	gz˛_©å_cuºítTõr15Summ©i⁄Dñivîed
[6] = {0};

225 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_RECEIVED_ENABLE


226 
u8
 
	gz˛_©å_cuºítTõr15Summ©i⁄Re˚ived
[6] = {0};

230 #ifde‡
ZCL_ATTRID_STATUS_ENABLE


231 
u8
 
	gz˛_©å_°©us
 = 0x00;

233 #ifde‡
ZCL_ATTRID_REMAINING_BATTERY_LIFE_ENABLE


234 
u8
 
	gz˛_©å_ªmaöögB©ãryLi„
 = 0x00;

236 #ifde‡
ZCL_ATTRID_HOURS_IN_OPERATION_ENABLE


237 
u24
 
	gz˛_©å_hoursInO≥øti⁄
 = 0x00;

239 #ifde‡
ZCL_ATTRID_HOURS_IN_FAULT_ENABLE


240 
u24
 
	gz˛_©å_hoursInFau…
 = 0x00;

244 #ifde‡
ZCL_ATTRID_UNIT_OF_MEASURE_ENABLE


245 
u8
 
	gz˛_©å_unôOfMósuª
 = 0x00;

247 #ifde‡
ZCL_ATTRID_MULTIPLIER_ENABLE


248 
u24
 
	gz˛_©å_mu…ùlõr
 = 0x0;

250 #ifde‡
ZCL_ATTRID_DIVISOR_ENABLE


251 
u24
 
	gz˛_©å_divis‹
 = 0x0;

253 #ifde‡
ZCL_ATTRID_SUMMATION_FORMATTING_ENABLE


254 
u8
 
	gz˛_©å_summ©i⁄F‹m©tög
 = 0x00;

256 #ifde‡
ZCL_ATTRID_DEMAND_FORMATTING_ENABLE


257 
u8
 
	gz˛_©å_dem™dF‹m©tög
 = 0x00;

259 #ifde‡
ZCL_ATTRID_HISTORICAL_CONSUMPTION_FORMATTING_ENABLE


260 
u8
 
	gz˛_©å_hi°‹iˇlC⁄sum±i⁄F‹m©tög
 = 0x00;

262 #ifde‡
ZCL_ATTRID_METERING_DEVICE_TYPE_ENABLE


263 
u8
 
	gz˛_©å_mëîögDevi˚Ty≥
 = 0x00;

265 #ifde‡
ZCL_ATTRID_SITE_ID_ENABLE


266 
u8
 
	gz˛_©å_sôeID
[33] = {0};

268 #ifde‡
ZCL_ATTRID_METER_SERIAL_NUMBER_ENABLE


269 
u8
 
	gz˛_©å_mëîSîülNumbî
[25] = {0};

271 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_UNIT_OF_MEASURE_ENABLE


272 
u8
 
	gz˛_©å_íîgyC¨rõrUnôOfMósuª
 = 0x00;

274 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_SUMMATION_FORMATTING_ENABLE


275 
u8
 
	gz˛_©å_íîgyC¨rõrSumm©i⁄F‹m©tög
 = 0x00;

277 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_DEMAND_FORMATTING_ENABLE


278 
u8
 
	gz˛_©å_íîgyC¨rõrDem™dF‹m©tög
 = 0x00;

280 #ifde‡
ZCL_ATTRID_TEMPERATURE_UNIT_OF_MEASURE_ENABLE


281 
u8
 
	gz˛_©å_ãm≥øtuªUnôOfMósuª
 = 0x00;

283 #ifde‡
ZCL_ATTRID_TEMPERATURE_FORMATTING_ENABLE


284 
u8
 
	gz˛_©å_ãm≥øtuªF‹m©tög
 = 0x00;

288 #ifde‡
ZCL_ATTRID_INSTANTANEOUS_DEMAND_ENABLE


289 
s24
 
	gz˛_©å_ö°™è√ousDem™d
 = 0x0;

291 #ifde‡
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_DELIVERD_ENABLE


292 
u24
 
	gz˛_©å_cuºítDayC⁄sum±i⁄Dñivîed
 = 0x0;

294 #ifde‡
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_RECEIVED_ENABLE


295 
u24
 
	gz˛_©å_cuºítDayC⁄sum±i⁄Re˚ived
 = 0x0;

297 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_DELIVERD_ENABLE


298 
u24
 
	gz˛_©å_¥eviousDayC⁄sum±i⁄Dñivîed
 = 0x0;

300 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_RECEIVED_ENABLE


301 
u24
 
	gz˛_©å_¥eviousDayC⁄sum±i⁄Re˚ived
 = 0x0;

303 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_DELIVERD_ENABLE


304 
UTCTime
 
	gz˛_©å_cuºítP¨tülProfûeI¡îvÆSèπTimeDñivîed
 = 0x0;

306 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_REVEIVED_ENABLE


307 
UTCTime
 
	gz˛_©å_cuºítP¨tülProfûeI¡îvÆSèπTimeRe˚ived
 = 0x0;

309 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_DELIVERD_ENABLE


310 
u24
 
	gz˛_©å_cuºítP¨tülProfûeI¡îvÆVÆueDñivîed
 = 0x0;

312 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_REVEIVED_ENABLE


313 
u24
 
	gz˛_©å_cuºítP¨tülProfûeI¡îvÆVÆueRe˚ived
 = 0x0;

315 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_PRESSURE_ENABLE


316 
u8
 
	gz˛_©å_cuºítDayMaxPªssuª
[6] = {0};

318 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MIN_PRESSURE_ENABLE


319 
u8
 
	gz˛_©å_cuºítDayMöPªssuª
[6] = {0};

321 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_PRESSURE_ENABLE


322 
u8
 
	gz˛_©å_¥eviousDayMaxPªssuª
[6] = {0};

324 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MIN_PRESSURE_ENABLE


325 
u8
 
	gz˛_©å_¥eviousDayMöPªssuª
[6] = {0};

327 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_DEMAND_ENABLE


328 
s24
 
	gz˛_©å_cuºítDayMaxDem™d
 = 0x0;

330 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_DEMAND_ENABLE


331 
s24
 
	gz˛_©å_¥eviousDayMaxDem™d
 = 0x0;

333 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MAX_DEMAND_ENABLE


334 
s24
 
	gz˛_©å_cuºítM⁄thMaxDem™d
 = 0x0;

336 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MAX_DEMAND_ENABLE


337 
s24
 
	gz˛_©å_cuºítYórMaxDem™d
 = 0x0;

339 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_ENERGY_CARRIER_DEMAND_ENABLE


340 
s24
 
	gz˛_©å_cuºítDayMaxE√rgyC¨rõrDem™d
 = 0x0;

342 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_ENERGY_CARRIER_DEMAND_ENABLE


343 
s24
 
	gz˛_©å_¥eviousDayMaxE√rgyC¨rõrDem™d
 = 0x0;

345 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MAX_ENERGY_CARRIER_DEMAND_ENABLE


346 
s24
 
	gz˛_©å_cuºítM⁄thMaxE√rgyC¨rõrDem™d
 = 0x0;

348 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MIN_ENERGY_CARRIER_DEMAND_ENABLE


349 
s24
 
	gz˛_©å_cuºítM⁄thMöE√rgyC¨rõrDem™d
 = 0x0;

351 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MAX_ENERGY_CARRIER_DEMAND_ENABLE


352 
s24
 
	gz˛_©å_cuºítYórMaxE√rgyC¨rõrDem™d
 = 0x0;

354 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MIN_ENERGY_CARRIER_DEMAND_ENABLE


355 
s24
 
	gz˛_©å_cuºítYórMöE√rgyC¨rõrDem™d
 = 0x0;

359 #ifde‡
ZCL_ATTRID_MAX_NUMBER_OF_PERIODS_DELIVERD_ENABLE


360 
u8
 
	gz˛_©å_maxNumbîOfPîiodsDñivîed
 = 0x18;

364 #ifde‡
ZCL_ATTRID_CURRENT_DEMAND_DELIVERD_ENABLE


365 
u24
 
	gz˛_©å_cuºítDem™dDñivîed
 = 0x0;

367 #ifde‡
ZCL_ATTRID_DEMAND_LIMIT_ENABLE


368 
u24
 
	gz˛_©å_dem™dLimô
 = 0x0;

370 #ifde‡
ZCL_ATTRID_DEMAND_INTEGRATION_PERIOD_ENABLE


371 
u8
 
	gz˛_©å_dem™dI¡egøti⁄Pîiod
 = 0x0;

373 #ifde‡
ZCL_ATTRID_NUMBER_OF_DEMAND_SUB_INTERVALS_ENABLE


374 
u8
 
	gz˛_©å_numbîOfDem™dSuböãrvÆs
 = 0x0;

378 #ifde‡
ZCL_ATTRID_CURRENT_NO_TIER_BLOCK_1_SUMMATION_DELIVERD_ENABLE


379 
u8
 
	gz˛_©å_cuºítNoTõrBlock1Summ©i⁄Dñivîed
[6] = {0};

381 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_BLOCK_1_SUMMATION_DELIVERD_ENABLE


382 
u8
 
	gz˛_©å_cuºítTõr1Block1Summ©i⁄Dñivîed
[6] = {0};

384 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_BLOCK_1_SUMMATION_DELIVERD_ENABLE


385 
u8
 
	gz˛_©å_cuºítTõr2Block1Summ©i⁄Dñivîed
[6] = {0};

387 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_BLOCK_1_SUMMATION_DELIVERD_ENABLE


388 
u8
 
	gz˛_©å_cuºítTõr3Block1Summ©i⁄Dñivîed
[6] = {0};

390 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_BLOCK_1_SUMMATION_DELIVERD_ENABLE


391 
u8
 
	gz˛_©å_cuºítTõr4Block1Summ©i⁄Dñivîed
[6] = {0};

393 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_BLOCK_1_SUMMATION_DELIVERD_ENABLE


394 
u8
 
	gz˛_©å_cuºítTõr5Block1Summ©i⁄Dñivîed
[6] = {0};

396 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_BLOCK_1_SUMMATION_DELIVERD_ENABLE


397 
u8
 
	gz˛_©å_cuºítTõr6Block1Summ©i⁄Dñivîed
[6] = {0};

399 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_BLOCK_1_SUMMATION_DELIVERD_ENABLE


400 
u8
 
	gz˛_©å_cuºítTõr7Block1Summ©i⁄Dñivîed
[6] = {0};

402 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_BLOCK_1_SUMMATION_DELIVERD_ENABLE


403 
u8
 
	gz˛_©å_cuºítTõr8Block1Summ©i⁄Dñivîed
[6] = {0};

405 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_BLOCK_1_SUMMATION_DELIVERD_ENABLE


406 
u8
 
	gz˛_©å_cuºítTõr9Block1Summ©i⁄Dñivîed
[6] = {0};

408 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_BLOCK_1_SUMMATION_DELIVERD_ENABLE


409 
u8
 
	gz˛_©å_cuºítTõr10Block1Summ©i⁄Dñivîed
[6] = {0};

411 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_BLOCK_1_SUMMATION_DELIVERD_ENABLE


412 
u8
 
	gz˛_©å_cuºítTõr11Block1Summ©i⁄Dñivîed
[6] = {0};

414 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_BLOCK_1_SUMMATION_DELIVERD_ENABLE


415 
u8
 
	gz˛_©å_cuºítTõr12Block1Summ©i⁄Dñivîed
[6] = {0};

417 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_BLOCK_1_SUMMATION_DELIVERD_ENABLE


418 
u8
 
	gz˛_©å_cuºítTõr13Block1Summ©i⁄Dñivîed
[6] = {0};

420 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_BLOCK_1_SUMMATION_DELIVERD_ENABLE


421 
u8
 
	gz˛_©å_cuºítTõr14Block1Summ©i⁄Dñivîed
[6] = {0};

423 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_BLOCK_1_SUMMATION_DELIVERD_ENABLE


424 
u8
 
	gz˛_©å_cuºítTõr15Block1Summ©i⁄Dñivîed
[6] = {0};

428 #ifde‡
ZCL_ATTRID_GENERIC_ALARM_MASK_ENABLE


429 
u16
 
	gz˛_©å_gíîicAœrmMask
 = 0xFFFF;

431 #ifde‡
ZCL_ATTRID_ELECTRICITY_ALARM_MASK_ENABLE


432 
u32
 
	gz˛_©å_ñe˘ricôyAœrmMask
 = 0xFFFFFFFF;

434 #ifde‡
ZCL_ATTRID_GENERIC_FLOW_PRESSURE_ALARM_MASK_ENABLE


435 
u16
 
	gz˛_©å_gíîicFlowPªssuªAœrmMask
 = 0xFFFF;

437 #ifde‡
ZCL_ATTRID_WATER_SPEC_ALARM_MASK_ENABLE


438 
u16
 
	gz˛_©å_w©îS≥cificAœrmMask
 = 0xFFFF;

440 #ifde‡
ZCL_ATTRID_HEAT_AND_COOLING_SPEC_ALARM_MASK_ENABLE


441 
u16
 
	gz˛_©å_hótAndCoﬁögS≥cificAœrmMask
 = 0xFFFF;

443 #ifde‡
ZCL_ATTRID_GAS_SPEC_ALARM_MASK_ENABLE


444 
u16
 
	gz˛_©å_gasS≥cificAœrmMask
 = 0xFFFF;

448 c⁄° 
z˛AârInfo_t
 
	gmëîög_©åTbl
[] =

451 #ifde‡
ZCL_ATTRID_CURRENT_SUMMATION_DELIVERD_ENABLE


452 { 
ZCL_ATTRID_CURRENT_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítSumm©i⁄Dñivîed
 },

454 #ifde‡
ZCL_ATTRID_CURRENT_SUMMATION_RECEIVED_ENABLE


455 { 
ZCL_ATTRID_CURRENT_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítSumm©i⁄Re˚ived
 },

457 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_ENABLE


458 { 
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítMaxDem™dDñivîed
 },

460 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_ENABLE


461 { 
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítMaxDem™dRe˚ived
 },

463 #ifde‡
ZCL_ATTRID_DFT_SUMMATION_ENABLE


464 { 
ZCL_ATTRID_DFT_SUMMATION
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_DFTSumm©i⁄
 },

466 #ifde‡
ZCL_ATTRID_DAILY_FREEZE_TIME_ENABLE


467 { 
ZCL_ATTRID_DAILY_FREEZE_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_daûyFªezeTime
 },

469 #ifde‡
ZCL_ATTRID_METERING_POWER_FACTOR_ENABLE


470 { 
ZCL_ATTRID_METERING_POWER_FACTOR
, 
ZCL_DATA_TYPE_INT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mëîög_powîFa˘‹
 },

472 #ifde‡
ZCL_ATTRID_READING_SNAP_SHORT_TIME_ENABLE


473 { 
ZCL_ATTRID_READING_SNAP_SHORT_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ªadögS«pShŸTime
 },

475 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_TIME_ENABLE


476 { 
ZCL_ATTRID_CURRENT_MAX_DEMAND_DELIVERD_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítMaxDem™dDñivîedTime
 },

478 #ifde‡
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_TIME_ENABLE


479 { 
ZCL_ATTRID_CURRENT_MAX_DEMAND_RECEIVED_TIME
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítMaxDem™dRe˚ivedTime
 },

481 #ifde‡
ZCL_ATTRID_DEFAULT_UPDATE_PERIOD_ENABLE


482 { 
ZCL_ATTRID_DEFAULT_UPDATE_PERIOD
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_deÁu…Upd©ePîiod
 },

484 #ifde‡
ZCL_ATTRID_FAST_POLL_UPDATE_PERIOD_ENABLE


485 { 
ZCL_ATTRID_FAST_POLL_UPDATE_PERIOD
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_Á°PﬁlUpd©ePîiod
 },

487 #ifde‡
ZCL_ATTRID_CURRENT_BLOCK_PERIOD_CONSUMPTION_DELIVERD_ENABLE


488 { 
ZCL_ATTRID_CURRENT_BLOCK_PERIOD_CONSUMPTION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítBlockPîiodC⁄sum±i⁄Dñivîed
 },

490 #ifde‡
ZCL_ATTRID_DAILY_CONSUMPTION_TARGET_ENABLE


491 { 
ZCL_ATTRID_DAILY_CONSUMPTION_TARGET
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_daûyC⁄sum±i⁄T¨gë
 },

493 #ifde‡
ZCL_ATTRID_CURRENT_BLOCK_ENABLE


494 { 
ZCL_ATTRID_CURRENT_BLOCK
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítBlock
 },

496 #ifde‡
ZCL_ATTRID_PROFILE_INTERVAL_PERIOD_ENABLE


497 { 
ZCL_ATTRID_PROFILE_INTERVAL_PERIOD
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥ofûeI¡îvÆPîiod
 },

499 #ifde‡
ZCL_ATTRID_INTERVAL_READ_REPORTING_PERIOD_ENABLE


500 { 
ZCL_ATTRID_INTERVAL_READ_REPORTING_PERIOD
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_öãrvÆRódRï‹tögPîiod
 },

502 #ifde‡
ZCL_ATTRID_PRESENT_READING_TIME_ENABLE


503 { 
ZCL_ATTRID_PRESENT_READING_TIME
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥e£tRódögTime
 },

505 #ifde‡
ZCL_ATTRID_VOLUME_PER_REPORT_ENABLE


506 { 
ZCL_ATTRID_VOLUME_PER_REPORT
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_vﬁumePîRï‹t
 },

508 #ifde‡
ZCL_ATTRID_FLOW_RESTRICTION_ENABLE


509 { 
ZCL_ATTRID_FLOW_RESTRICTION
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ÊowRe°ri˘i⁄
 },

511 #ifde‡
ZCL_ATTRID_SUPPLY_STATUS_ENABLE


512 { 
ZCL_ATTRID_SUPPLY_STATUS
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_suµlySètus
 },

514 #ifde‡
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_SUMMATION_ENABLE


515 { 
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_SUMMATION
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítI∆ëE√rgyC¨rõrSumm©i⁄
 },

517 #ifde‡
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_SUMMATION_ENABLE


518 { 
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_SUMMATION
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítOuéëE√rgyC¨rõrSumm©i⁄
 },

520 #ifde‡
ZCL_ATTRID_INLET_TEMPERATURE_ENABLE


521 { 
ZCL_ATTRID_INLET_TEMPERATURE
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_öÀtTem≥øtuª
 },

523 #ifde‡
ZCL_ATTRID_OUTLET_TEMPERATURE_ENABLE


524 { 
ZCL_ATTRID_OUTLET_TEMPERATURE
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ouéëTem≥øtuª
 },

526 #ifde‡
ZCL_ATTRID_CONTROL_TEMPERATURE_ENABLE


527 { 
ZCL_ATTRID_CONTROL_TEMPERATURE
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_c⁄åﬁTem≥øtuª
 },

529 #ifde‡
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_DEMAND_ENABLE


530 { 
ZCL_ATTRID_CURRENT_INLET_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítI∆ëE√rgyC¨rõrDem™d
 },

532 #ifde‡
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_DEMAND_ENABLE


533 { 
ZCL_ATTRID_CURRENT_OUTLET_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítOuéëE√rgyC¨rõrDem™d
 },

535 #ifde‡
ZCL_ATTRID_PREVIOUS_BLOCK_PERIOD_CONSUMPTION_DELIVERD_ENABLE


536 { 
ZCL_ATTRID_PREVIOUS_BLOCK_PERIOD_CONSUMPTION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_¥eviousBlockPîiodC⁄sum±i⁄Dñivîed
 },

540 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_DELIVERD_ENABLE


541 { 
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr1Summ©i⁄Dñivîed
 },

543 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_RECEIVED_ENABLE


544 { 
ZCL_ATTRID_CURRENT_TIER_1_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr1Summ©i⁄Re˚ived
 },

546 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_DELIVERD_ENABLE


547 { 
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr2Summ©i⁄Dñivîed
 },

549 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_RECEIVED_ENABLE


550 { 
ZCL_ATTRID_CURRENT_TIER_2_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr2Summ©i⁄Re˚ived
 },

552 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_DELIVERD_ENABLE


553 { 
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr3Summ©i⁄Dñivîed
 },

555 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_RECEIVED_ENABLE


556 { 
ZCL_ATTRID_CURRENT_TIER_3_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr3Summ©i⁄Re˚ived
 },

558 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_DELIVERD_ENABLE


559 { 
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr4Summ©i⁄Dñivîed
 },

561 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_RECEIVED_ENABLE


562 { 
ZCL_ATTRID_CURRENT_TIER_4_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr4Summ©i⁄Re˚ived
 },

564 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_DELIVERD_ENABLE


565 { 
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr5Summ©i⁄Dñivîed
 },

567 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_RECEIVED_ENABLE


568 { 
ZCL_ATTRID_CURRENT_TIER_5_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr5Summ©i⁄Re˚ived
 },

570 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_DELIVERD_ENABLE


571 { 
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr6Summ©i⁄Dñivîed
 },

573 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_RECEIVED_ENABLE


574 { 
ZCL_ATTRID_CURRENT_TIER_6_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr6Summ©i⁄Re˚ived
 },

576 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_DELIVERD_ENABLE


577 { 
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr7Summ©i⁄Dñivîed
 },

579 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_RECEIVED_ENABLE


580 { 
ZCL_ATTRID_CURRENT_TIER_7_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr7Summ©i⁄Re˚ived
 },

582 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_DELIVERD_ENABLE


583 { 
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr8Summ©i⁄Dñivîed
 },

585 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_RECEIVED_ENABLE


586 { 
ZCL_ATTRID_CURRENT_TIER_8_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr8Summ©i⁄Re˚ived
 },

588 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_DELIVERD_ENABLE


589 { 
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr9Summ©i⁄Dñivîed
 },

591 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_RECEIVED_ENABLE


592 { 
ZCL_ATTRID_CURRENT_TIER_9_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr9Summ©i⁄Re˚ived
 },

594 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_DELIVERD_ENABLE


595 { 
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr10Summ©i⁄Dñivîed
 },

597 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_RECEIVED_ENABLE


598 { 
ZCL_ATTRID_CURRENT_TIER_10_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr10Summ©i⁄Re˚ived
 },

600 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_DELIVERD_ENABLE


601 { 
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr11Summ©i⁄Dñivîed
 },

603 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_RECEIVED_ENABLE


604 { 
ZCL_ATTRID_CURRENT_TIER_11_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr11Summ©i⁄Re˚ived
 },

606 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_DELIVERD_ENABLE


607 { 
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr12Summ©i⁄Dñivîed
 },

609 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_RECEIVED_ENABLE


610 { 
ZCL_ATTRID_CURRENT_TIER_12_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr12Summ©i⁄Re˚ived
 },

612 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_DELIVERD_ENABLE


613 { 
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr13Summ©i⁄Dñivîed
 },

615 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_RECEIVED_ENABLE


616 { 
ZCL_ATTRID_CURRENT_TIER_13_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr13Summ©i⁄Re˚ived
 },

618 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_DELIVERD_ENABLE


619 { 
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr14Summ©i⁄Dñivîed
 },

621 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_RECEIVED_ENABLE


622 { 
ZCL_ATTRID_CURRENT_TIER_14_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr14Summ©i⁄Re˚ived
 },

624 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_DELIVERD_ENABLE


625 { 
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr15Summ©i⁄Dñivîed
 },

627 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_RECEIVED_ENABLE


628 { 
ZCL_ATTRID_CURRENT_TIER_15_SUMMATION_RECEIVED
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr15Summ©i⁄Re˚ived
 },

632 #ifde‡
ZCL_ATTRID_STATUS_ENABLE


633 { 
ZCL_ATTRID_STATUS
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_°©us
 },

635 #ifde‡
ZCL_ATTRID_REMAINING_BATTERY_LIFE_ENABLE


636 { 
ZCL_ATTRID_REMAINING_BATTERY_LIFE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ªmaöögB©ãryLi„
 },

638 #ifde‡
ZCL_ATTRID_HOURS_IN_OPERATION_ENABLE


639 { 
ZCL_ATTRID_HOURS_IN_OPERATION
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_hoursInO≥øti⁄
 },

641 #ifde‡
ZCL_ATTRID_HOURS_IN_FAULT_ENABLE


642 { 
ZCL_ATTRID_HOURS_IN_FAULT
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_hoursInFau…
 },

646 #ifde‡
ZCL_ATTRID_UNIT_OF_MEASURE_ENABLE


647 { 
ZCL_ATTRID_UNIT_OF_MEASURE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_unôOfMósuª
 },

649 #ifde‡
ZCL_ATTRID_MULTIPLIER_ENABLE


650 { 
ZCL_ATTRID_MULTIPLIER
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mu…ùlõr
 },

652 #ifde‡
ZCL_ATTRID_DIVISOR_ENABLE


653 { 
ZCL_ATTRID_DIVISOR
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_divis‹
 },

655 #ifde‡
ZCL_ATTRID_SUMMATION_FORMATTING_ENABLE


656 { 
ZCL_ATTRID_SUMMATION_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_summ©i⁄F‹m©tög
 },

658 #ifde‡
ZCL_ATTRID_DEMAND_FORMATTING_ENABLE


659 { 
ZCL_ATTRID_DEMAND_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dem™dF‹m©tög
 },

661 #ifde‡
ZCL_ATTRID_HISTORICAL_CONSUMPTION_FORMATTING_ENABLE


662 { 
ZCL_ATTRID_HISTORICAL_CONSUMPTION_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_hi°‹iˇlC⁄sum±i⁄F‹m©tög
 },

664 #ifde‡
ZCL_ATTRID_METERING_DEVICE_TYPE_ENABLE


665 { 
ZCL_ATTRID_METERING_DEVICE_TYPE
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_mëîögDevi˚Ty≥
 },

667 #ifde‡
ZCL_ATTRID_SITE_ID_ENABLE


668 { 
ZCL_ATTRID_SITE_ID
, 
ZCL_DATA_TYPE_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_sôeID
 },

670 #ifde‡
ZCL_ATTRID_METER_SERIAL_NUMBER_ENABLE


671 { 
ZCL_ATTRID_METER_SERIAL_NUMBER
, 
ZCL_DATA_TYPE_OCTET_STR
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_mëîSîülNumbî
 },

673 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_UNIT_OF_MEASURE_ENABLE


674 { 
ZCL_ATTRID_ENERGY_CARRIER_UNIT_OF_MEASURE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_íîgyC¨rõrUnôOfMósuª
 },

676 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_SUMMATION_FORMATTING_ENABLE


677 { 
ZCL_ATTRID_ENERGY_CARRIER_SUMMATION_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_íîgyC¨rõrSumm©i⁄F‹m©tög
 },

679 #ifde‡
ZCL_ATTRID_ENERGY_CARRIER_DEMAND_FORMATTING_ENABLE


680 { 
ZCL_ATTRID_ENERGY_CARRIER_DEMAND_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_íîgyC¨rõrDem™dF‹m©tög
 },

682 #ifde‡
ZCL_ATTRID_TEMPERATURE_UNIT_OF_MEASURE_ENABLE


683 { 
ZCL_ATTRID_TEMPERATURE_UNIT_OF_MEASURE
, 
ZCL_DATA_TYPE_ENUM8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ãm≥øtuªUnôOfMósuª
 },

685 #ifde‡
ZCL_ATTRID_TEMPERATURE_FORMATTING_ENABLE


686 { 
ZCL_ATTRID_TEMPERATURE_FORMATTING
, 
ZCL_DATA_TYPE_BITMAP8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ãm≥øtuªF‹m©tög
 },

690 #ifde‡
ZCL_ATTRID_INSTANTANEOUS_DEMAND_ENABLE


691 { 
ZCL_ATTRID_INSTANTANEOUS_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_ö°™è√ousDem™d
 },

693 #ifde‡
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_DELIVERD_ENABLE


694 { 
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_DELIVERD
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítDayC⁄sum±i⁄Dñivîed
 },

696 #ifde‡
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_RECEIVED_ENABLE


697 { 
ZCL_ATTRID_CURRENT_DAY_CONSUMPTION_RECEIVED
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítDayC⁄sum±i⁄Re˚ived
 },

699 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_DELIVERD_ENABLE


700 { 
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_DELIVERD
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥eviousDayC⁄sum±i⁄Dñivîed
 },

702 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_RECEIVED_ENABLE


703 { 
ZCL_ATTRID_PREVIOUS_DAY_CONSUMPTION_RECEIVED
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥eviousDayC⁄sum±i⁄Re˚ived
 },

705 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_DELIVERD_ENABLE


706 { 
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_DELIVERD
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítP¨tülProfûeI¡îvÆSèπTimeDñivîed
 },

708 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_REVEIVED_ENABLE


709 { 
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_START_TIME_REVEIVED
, 
ZCL_DATA_TYPE_UTC
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítP¨tülProfûeI¡îvÆSèπTimeRe˚ived
 },

711 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_DELIVERD_ENABLE


712 { 
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_DELIVERD
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítP¨tülProfûeI¡îvÆVÆueDñivîed
 },

714 #ifde‡
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_REVEIVED_ENABLE


715 { 
ZCL_ATTRID_CUR_PARTITAL_PROFILE_INT_VALUE_REVEIVED
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítP¨tülProfûeI¡îvÆVÆueRe˚ived
 },

717 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_PRESSURE_ENABLE


718 { 
ZCL_ATTRID_CURRENT_DAY_MAX_PRESSURE
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítDayMaxPªssuª
 },

720 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MIN_PRESSURE_ENABLE


721 { 
ZCL_ATTRID_CURRENT_DAY_MIN_PRESSURE
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítDayMöPªssuª
 },

723 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_PRESSURE_ENABLE


724 { 
ZCL_ATTRID_PREVIOUS_DAY_MAX_PRESSURE
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_¥eviousDayMaxPªssuª
 },

726 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MIN_PRESSURE_ENABLE


727 { 
ZCL_ATTRID_PREVIOUS_DAY_MIN_PRESSURE
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_¥eviousDayMöPªssuª
 },

729 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_DEMAND_ENABLE


730 { 
ZCL_ATTRID_CURRENT_DAY_MAX_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítDayMaxDem™d
 },

732 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_DEMAND_ENABLE


733 { 
ZCL_ATTRID_PREVIOUS_DAY_MAX_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥eviousDayMaxDem™d
 },

735 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MAX_DEMAND_ENABLE


736 { 
ZCL_ATTRID_CURRENT_MONTH_MAX_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítM⁄thMaxDem™d
 },

738 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MAX_DEMAND_ENABLE


739 { 
ZCL_ATTRID_CURRENT_YEAR_MAX_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítYórMaxDem™d
 },

741 #ifde‡
ZCL_ATTRID_CURRENT_DAY_MAX_ENERGY_CARRIER_DEMAND_ENABLE


742 { 
ZCL_ATTRID_CURRENT_DAY_MAX_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítDayMaxE√rgyC¨rõrDem™d
 },

744 #ifde‡
ZCL_ATTRID_PREVIOUS_DAY_MAX_ENERGY_CARRIER_DEMAND_ENABLE


745 { 
ZCL_ATTRID_PREVIOUS_DAY_MAX_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_¥eviousDayMaxE√rgyC¨rõrDem™d
 },

747 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MAX_ENERGY_CARRIER_DEMAND_ENABLE


748 { 
ZCL_ATTRID_CURRENT_MONTH_MAX_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítM⁄thMaxE√rgyC¨rõrDem™d
 },

750 #ifde‡
ZCL_ATTRID_CURRENT_MONTH_MIN_ENERGY_CARRIER_DEMAND_ENABLE


751 { 
ZCL_ATTRID_CURRENT_MONTH_MIN_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítM⁄thMöE√rgyC¨rõrDem™d
 },

753 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MAX_ENERGY_CARRIER_DEMAND_ENABLE


754 { 
ZCL_ATTRID_CURRENT_YEAR_MAX_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítYórMaxE√rgyC¨rõrDem™d
 },

756 #ifde‡
ZCL_ATTRID_CURRENT_YEAR_MIN_ENERGY_CARRIER_DEMAND_ENABLE


757 { 
ZCL_ATTRID_CURRENT_YEAR_MIN_ENERGY_CARRIER_DEMAND
, 
ZCL_DATA_TYPE_INT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítYórMöE√rgyC¨rõrDem™d
 },

761 #ifde‡
ZCL_ATTRID_MAX_NUMBER_OF_PERIODS_DELIVERD_ENABLE


762 { 
ZCL_ATTRID_MAX_NUMBER_OF_PERIODS_DELIVERD
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_maxNumbîOfPîiodsDñivîed
 },

766 #ifde‡
ZCL_ATTRID_CURRENT_DEMAND_DELIVERD_ENABLE


767 { 
ZCL_ATTRID_CURRENT_DEMAND_DELIVERD
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_cuºítDem™dDñivîed
 },

769 #ifde‡
ZCL_ATTRID_DEMAND_LIMIT_ENABLE


770 { 
ZCL_ATTRID_DEMAND_LIMIT
, 
ZCL_DATA_TYPE_UINT24
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dem™dLimô
 },

772 #ifde‡
ZCL_ATTRID_DEMAND_INTEGRATION_PERIOD_ENABLE


773 { 
ZCL_ATTRID_DEMAND_INTEGRATION_PERIOD
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_dem™dI¡egøti⁄Pîiod
 },

775 #ifde‡
ZCL_ATTRID_NUMBER_OF_DEMAND_SUB_INTERVALS_ENABLE


776 { 
ZCL_ATTRID_NUMBER_OF_DEMAND_SUB_INTERVALS
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_numbîOfDem™dSuböãrvÆs
 },

780 #ifde‡
ZCL_ATTRID_CURRENT_NO_TIER_BLOCK_1_SUMMATION_DELIVERD_ENABLE


781 { 
ZCL_ATTRID_CURRENT_NO_TIER_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítNoTõrBlock1Summ©i⁄Dñivîed
 },

783 #ifde‡
ZCL_ATTRID_CURRENT_TIER_1_BLOCK_1_SUMMATION_DELIVERD_ENABLE


784 { 
ZCL_ATTRID_CURRENT_TIER_1_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr1Block1Summ©i⁄Dñivîed
 },

786 #ifde‡
ZCL_ATTRID_CURRENT_TIER_2_BLOCK_1_SUMMATION_DELIVERD_ENABLE


787 { 
ZCL_ATTRID_CURRENT_TIER_2_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr2Block1Summ©i⁄Dñivîed
 },

789 #ifde‡
ZCL_ATTRID_CURRENT_TIER_3_BLOCK_1_SUMMATION_DELIVERD_ENABLE


790 { 
ZCL_ATTRID_CURRENT_TIER_3_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr3Block1Summ©i⁄Dñivîed
 },

792 #ifde‡
ZCL_ATTRID_CURRENT_TIER_4_BLOCK_1_SUMMATION_DELIVERD_ENABLE


793 { 
ZCL_ATTRID_CURRENT_TIER_4_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr4Block1Summ©i⁄Dñivîed
 },

795 #ifde‡
ZCL_ATTRID_CURRENT_TIER_5_BLOCK_1_SUMMATION_DELIVERD_ENABLE


796 { 
ZCL_ATTRID_CURRENT_TIER_5_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr5Block1Summ©i⁄Dñivîed
 },

798 #ifde‡
ZCL_ATTRID_CURRENT_TIER_6_BLOCK_1_SUMMATION_DELIVERD_ENABLE


799 { 
ZCL_ATTRID_CURRENT_TIER_6_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr6Block1Summ©i⁄Dñivîed
 },

801 #ifde‡
ZCL_ATTRID_CURRENT_TIER_7_BLOCK_1_SUMMATION_DELIVERD_ENABLE


802 { 
ZCL_ATTRID_CURRENT_TIER_7_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr7Block1Summ©i⁄Dñivîed
 },

804 #ifde‡
ZCL_ATTRID_CURRENT_TIER_8_BLOCK_1_SUMMATION_DELIVERD_ENABLE


805 { 
ZCL_ATTRID_CURRENT_TIER_8_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr8Block1Summ©i⁄Dñivîed
 },

807 #ifde‡
ZCL_ATTRID_CURRENT_TIER_9_BLOCK_1_SUMMATION_DELIVERD_ENABLE


808 { 
ZCL_ATTRID_CURRENT_TIER_9_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr9Block1Summ©i⁄Dñivîed
 },

810 #ifde‡
ZCL_ATTRID_CURRENT_TIER_10_BLOCK_1_SUMMATION_DELIVERD_ENABLE


811 { 
ZCL_ATTRID_CURRENT_TIER_10_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr10Block1Summ©i⁄Dñivîed
 },

813 #ifde‡
ZCL_ATTRID_CURRENT_TIER_11_BLOCK_1_SUMMATION_DELIVERD_ENABLE


814 { 
ZCL_ATTRID_CURRENT_TIER_11_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr11Block1Summ©i⁄Dñivîed
 },

816 #ifde‡
ZCL_ATTRID_CURRENT_TIER_12_BLOCK_1_SUMMATION_DELIVERD_ENABLE


817 { 
ZCL_ATTRID_CURRENT_TIER_12_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr12Block1Summ©i⁄Dñivîed
 },

819 #ifde‡
ZCL_ATTRID_CURRENT_TIER_13_BLOCK_1_SUMMATION_DELIVERD_ENABLE


820 { 
ZCL_ATTRID_CURRENT_TIER_13_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr13Block1Summ©i⁄Dñivîed
 },

822 #ifde‡
ZCL_ATTRID_CURRENT_TIER_14_BLOCK_1_SUMMATION_DELIVERD_ENABLE


823 { 
ZCL_ATTRID_CURRENT_TIER_14_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr14Block1Summ©i⁄Dñivîed
 },

825 #ifde‡
ZCL_ATTRID_CURRENT_TIER_15_BLOCK_1_SUMMATION_DELIVERD_ENABLE


826 { 
ZCL_ATTRID_CURRENT_TIER_15_BLOCK_1_SUMMATION_DELIVERD
, 
ZCL_DATA_TYPE_UINT48
, 
ACCESS_CONTROL_READ
, (
u8
*)
z˛_©å_cuºítTõr15Block1Summ©i⁄Dñivîed
 },

830 #ifde‡
ZCL_ATTRID_GENERIC_ALARM_MASK_ENABLE


831 { 
ZCL_ATTRID_GENERIC_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_gíîicAœrmMask
 },

833 #ifde‡
ZCL_ATTRID_ELECTRICITY_ALARM_MASK_ENABLE


834 { 
ZCL_ATTRID_ELECTRICITY_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP32
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_ñe˘ricôyAœrmMask
 },

836 #ifde‡
ZCL_ATTRID_GENERIC_FLOW_PRESSURE_ALARM_MASK_ENABLE


837 { 
ZCL_ATTRID_GENERIC_FLOW_PRESSURE_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_gíîicFlowPªssuªAœrmMask
 },

839 #ifde‡
ZCL_ATTRID_WATER_SPEC_ALARM_MASK_ENABLE


840 { 
ZCL_ATTRID_WATER_SPEC_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_w©îS≥cificAœrmMask
 },

842 #ifde‡
ZCL_ATTRID_HEAT_AND_COOLING_SPEC_ALARM_MASK_ENABLE


843 { 
ZCL_ATTRID_HEAT_AND_COOLING_SPEC_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_hótAndCoﬁögS≥cificAœrmMask
 },

845 #ifde‡
ZCL_ATTRID_GAS_SPEC_ALARM_MASK_ENABLE


846 { 
ZCL_ATTRID_GAS_SPEC_ALARM_MASK
, 
ZCL_DATA_TYPE_BITMAP16
, 
ACCESS_CONTROL_READ
 | 
ACCESS_CONTROL_WRITE
, (
u8
*)&
z˛_©å_gasS≥cificAœrmMask
 },

850 c⁄° 
u8
 
	gz˛_mëîög_©åNum
 = ( (
mëîög_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/zcl.c

27 
	~"z˛_ö˛ude.h
"

44 
z˛_˘æ_t
 
	gz˛_v¨s
;

45 
u8
 
	gz˛_£qNum
;

47 c⁄° 
u16
 
	gz˛_©å_globÆ_˛u°îRevisi⁄
 = 
ZCL_ATTR_GLOBAL_CLUSTER_REVISION_DEFAULT
;

52 #ifde‡
ZCL_READ


53 
u8
 
z˛_ªadH™dÀr
(
z˛Incomög_t
 *
pCmd
);

54 
u8
 
z˛_ªadR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

56 #ifde‡
ZCL_WRITE


57 
u8
 
z˛_wrôeH™dÀr
(
z˛Incomög_t
 *
pCmd
);

58 
u8
 
z˛_wrôeUndividedH™dÀr
(
z˛Incomög_t
 *
pCmd
);

59 
u8
 
z˛_wrôeR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

61 #ifde‡
ZCL_REPORT


62 
u8
 
z˛_c⁄figRï‹tH™dÀr
(
z˛Incomög_t
 *
pCmd
);

63 
u8
 
z˛_c⁄figRï‹tR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

64 
u8
 
z˛_ªadRï‹tCfgH™dÀr
(
z˛Incomög_t
 *
pCmd
);

65 
u8
 
z˛_ªadRï‹tCfgR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

66 
u8
 
z˛_ªp‹tH™dÀr
(
z˛Incomög_t
 *
pCmd
);

68 #ifde‡
ZCL_DISCOVER


69 
u8
 
z˛_discAârsH™dÀr
(
z˛Incomög_t
 *
pCmd
);

70 
u8
 
z˛_discAârsR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

71 
u8
 
z˛_discCmdsH™dÀr
(
z˛Incomög_t
 *
pCmd
);

72 
u8
 
z˛_discAârsExãndedH™dÀr
(
z˛Incomög_t
 *
pCmd
);

73 
u8
 
z˛_discAârsExtR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

75 
u8
 
z˛_dÊtR•H™dÀr
(
z˛Incomög_t
 *
pCmd
);

76 
u8
 
z˛_£ndDÊtR•
(
z˛Incomög_t
 *
öMsg
, u8 
cmdId
, u8 
°©us
);

87 
_CODE_ZCL_
 
	$z˛_ª£t
()

89 
z˛_v¨s
.
hookFn
 = 
NULL
;

92 
z˛_v¨s
.
˛u°îNum
 = 0;

93 
u8
 
i
 = 0; i < 
ZCL_CLUSTER_NUM_MAX
; i++)

95 
z˛_v¨s
.
˛u°îLi°
[
i
].
ídpoöt
 = 0xfe;

96 
z˛_v¨s
.
˛u°îLi°
[
i
].
˛u°îID
 = 0xffff;

97 
z˛_v¨s
.
˛u°îLi°
[
i
].
©åNum
 = 0;

98 
z˛_v¨s
.
˛u°îLi°
[
i
].
©åTabÀ
 = 
NULL
;

99 
z˛_v¨s
.
˛u°îLi°
[
i
].
cmdH™dÀrFunc
 = 
NULL
;

100 
z˛_v¨s
.
˛u°îLi°
[
i
].
˛u°îAµCb
 = 
NULL
;

102 
	}
}

111 
_CODE_ZCL_
 
	$z˛_öô
(
z˛_hookFn_t
 
‚
)

114 
	`z˛_ª£t
();

115 
z˛_£qNum
 = (
u8
)
	`zb_øndom
();

116 
z˛_v¨s
.
hookFn
 = 
‚
;

117 
	}
}

126 
_CODE_ZCL_
 
	$z˛_ªgi°î
(
u8
 
ídpoöt
, u8 
˛u°îNum
, 
z˛_•ecClu°îInfo_t
 *
öfo
)

128 
z˛_•ecClu°îInfo_t
 *
p
 = 
öfo
;

129 
u32
 
i
 = 0; i < 
˛u°îNum
; i++)

131 i‡(
p
->
˛u°îRegi°îFunc
)

133 i‡(
p
->
	`˛u°îRegi°îFunc
(
ídpoöt
,Ö->
m™uCode
,Ö->
©åNum
,Ö->
©åTbl
,Ö->
˛u°îAµCb
Ë=
ZCL_STA_INSUFFICIENT_SPACE
)

138 
p
++;

140 
	}
}

152 
_CODE_ZCL_
 
˛u°îInfo_t
 *
	$z˛_födClu°î
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
)

154 
u8
 
i
 = 0; i < 
ZCL_CLUSTER_NUM_MAX
; i++)

156 i‡((
z˛_v¨s
.
˛u°îLi°
[
i
].
ídpoöt
 =ídpoötË&& (z˛_v¨s.˛u°îLi°[i].
˛u°îID
 =
˛u°îId
))

158  &
z˛_v¨s
.
˛u°îLi°
[
i
];

161  
NULL
;

162 
	}
}

177 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªgi°îClu°î
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 *
pAârTbl
, 
˛u°î_cmdHdÃ_t
 
cmdHdÃFn
, 
˛u°î_f‹AµCb_t
 
cb
)

179 i‡(
z˛_v¨s
.
˛u°îNum
 >
ZCL_CLUSTER_NUM_MAX
)

181  
ZCL_STA_INSUFFICIENT_SPACE
;

184 i‡(
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
))

186  
ZCL_STA_DUPLICATE_EXISTS
;

189 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
ídpoöt
 =Éndpoint;

190 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
˛u°îID
 = 
˛u°îId
;

191 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
m™uCode
 = manuCode;

192 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
©åNum
 =áttrNum;

193 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
cmdH™dÀrFunc
 = 
cmdHdÃFn
;

194 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
].
˛u°îAµCb
 = 
cb
;

195 
z˛_v¨s
.
˛u°îLi°
[z˛_v¨s.
˛u°îNum
++].
©åTabÀ
 = 
pAârTbl
;

197  
ZCL_STA_SUCCESS
;

198 
	}
}

209 
_CODE_ZCL_
 
u8
 
	$z˛_gëD©aTy≥Lí
(
u8
 
d©aTy≥
)

211 
d©aTy≥
)

213 
ZCL_DATA_TYPE_BOOLEAN
:

214  (
u8
);

216 
ZCL_DATA_TYPE_DATA8
:

217 
ZCL_DATA_TYPE_BITMAP8
:

218 
ZCL_DATA_TYPE_UINT8
:

219 
ZCL_DATA_TYPE_INT8
:

220 
ZCL_DATA_TYPE_ENUM8
:

221  (
u8
);

223 
ZCL_DATA_TYPE_DATA16
:

224 
ZCL_DATA_TYPE_BITMAP16
:

225 
ZCL_DATA_TYPE_UINT16
:

226 
ZCL_DATA_TYPE_INT16
:

227 
ZCL_DATA_TYPE_ENUM16
:

228 
ZCL_DATA_TYPE_SEMI_PREC
:

229 
ZCL_DATA_TYPE_CLUSTER_ID
:

230 
ZCL_DATA_TYPE_ATTR_ID
:

231  (
u16
);

233 
ZCL_DATA_TYPE_DATA24
:

234 
ZCL_DATA_TYPE_BITMAP24
:

235 
ZCL_DATA_TYPE_UINT24
:

236 
ZCL_DATA_TYPE_INT24
:

239 
ZCL_DATA_TYPE_DATA32
:

240 
ZCL_DATA_TYPE_BITMAP32
:

241 
ZCL_DATA_TYPE_UINT32
:

242 
ZCL_DATA_TYPE_INT32
:

243 
ZCL_DATA_TYPE_SINGLE_PREC
:

244 
ZCL_DATA_TYPE_UTC
:

245 
ZCL_DATA_TYPE_DATE
:

246 
ZCL_DATA_TYPE_BAC_OID
:

247  (
u32
);

249 
ZCL_DATA_TYPE_DATA40
:

250 
ZCL_DATA_TYPE_BITMAP40
:

251 
ZCL_DATA_TYPE_UINT40
:

252 
ZCL_DATA_TYPE_INT40
:

255 
ZCL_DATA_TYPE_DATA48
:

256 
ZCL_DATA_TYPE_BITMAP48
:

257 
ZCL_DATA_TYPE_UINT48
:

258 
ZCL_DATA_TYPE_INT48
:

261 
ZCL_DATA_TYPE_DATA56
:

262 
ZCL_DATA_TYPE_BITMAP56
:

263 
ZCL_DATA_TYPE_UINT56
:

264 
ZCL_DATA_TYPE_INT56
:

267 
ZCL_DATA_TYPE_DATA64
:

268 
ZCL_DATA_TYPE_BITMAP64
:

269 
ZCL_DATA_TYPE_UINT64
:

270 
ZCL_DATA_TYPE_INT64
:

271 
ZCL_DATA_TYPE_DOUBLE_PREC
:

272 
ZCL_DATA_TYPE_IEEE_ADDR
:

275 
ZCL_DATA_TYPE_128_BIT_SEC_KEY
:

278 
ZCL_DATA_TYPE_NO_DATA
:

279 
ZCL_DATA_TYPE_UNKNOWN
:

284 
	}
}

295 
_CODE_ZCL_
 
boﬁ
 
	$z˛_™ÆogD©aTy≥
(
u8
 
d©aTy≥
)

297 
d©aTy≥
)

299 
ZCL_DATA_TYPE_UINT8
:

300 
ZCL_DATA_TYPE_UINT16
:

301 
ZCL_DATA_TYPE_UINT24
:

302 
ZCL_DATA_TYPE_UINT32
:

303 
ZCL_DATA_TYPE_UINT40
:

304 
ZCL_DATA_TYPE_UINT48
:

305 
ZCL_DATA_TYPE_UINT56
:

306 
ZCL_DATA_TYPE_UINT64
:

307 
ZCL_DATA_TYPE_INT8
:

308 
ZCL_DATA_TYPE_INT16
:

309 
ZCL_DATA_TYPE_INT24
:

310 
ZCL_DATA_TYPE_INT32
:

311 
ZCL_DATA_TYPE_INT40
:

312 
ZCL_DATA_TYPE_INT48
:

313 
ZCL_DATA_TYPE_INT56
:

314 
ZCL_DATA_TYPE_INT64
:

315 
ZCL_DATA_TYPE_SEMI_PREC
:

316 
ZCL_DATA_TYPE_SINGLE_PREC
:

317 
ZCL_DATA_TYPE_DOUBLE_PREC
:

318 
ZCL_DATA_TYPE_TOD
:

319 
ZCL_DATA_TYPE_DATE
:

320 
ZCL_DATA_TYPE_UTC
:

321  
TRUE
;

325  
FALSE
;

328 
	}
}

340 
_CODE_ZCL_
 
u16
 
	$z˛_gëAârSize
(
u8
 
d©aTy≥
, u8 *
pD©a
)

342 
u16
 
d©aLí
 = 0;

344 i‡((
d©aTy≥
 =
ZCL_DATA_TYPE_LONG_CHAR_STR
Ë|| (d©aTy≥ =
ZCL_DATA_TYPE_LONG_OCTET_STR
))

346 
d©aLí
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]) + 2;

348 i‡((
d©aTy≥
 =
ZCL_DATA_TYPE_CHAR_STR
Ë|| (d©aTy≥ =
ZCL_DATA_TYPE_OCTET_STR
))

350 
d©aLí
 = *
pD©a
 + 1;

352 i‡(
d©aTy≥
 =
ZCL_DATA_TYPE_STRUCT
)

354 
u8
 
ôemNum
 = *
pD©a
;

355 
d©aLí
 += 2;

356 
u8
 
i
 = 0; i < 
ôemNum
; i++)

358 
u8
 
dtUni⁄
 = 
pD©a
[
d©aLí
];

359 
u8
 
ÀnTemp
 = 
	`z˛_gëD©aTy≥Lí
(
dtUni⁄
);

360 
d©aLí
 +(
ÀnTemp
 + 1);

365 
d©aLí
 = 
	`z˛_gëD©aTy≥Lí
(
d©aTy≥
);

368  
d©aLí
;

369 
	}
}

380 
_CODE_ZCL_
 
	$isLôéeEndünMachöeCheck
()

382 
u16
 
ã°
 = 0x0001;

383  (*((
u8
 *)(&
ã°
)));

384 
	}
}

397 
_CODE_ZCL_
 
	$z˛_™ÆogD©aBuûd
(
u8
 
d©aTy≥
, u8 *
pD©a
, u8 *
pBuf
)

399 
curByãIdx
;

400 
ªmaöögByãs
;

401 
°ï
;

403 
ªmaöögByãs
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pD©a
);

405 i‡(
	`isLôéeEndünMachöeCheck
())

407 
°ï
 = 1;

408 
curByãIdx
 = 0;

412 
°ï
 = -1;

413 
curByãIdx
 = 
ªmaöögByãs
 - 1;

416 
ªmaöögByãs
--)

418 
pD©a
[
curByãIdx
] = *(
pBuf
++);

419 
curByãIdx
 +
°ï
;

421 
	}
}

434 
_CODE_ZCL_
 
z˛AârInfo_t
 *
	$z˛_födAâribuã
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
)

436 
˛u°îInfo_t
 *
pClu°îLi°
 = 
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
);

437 i‡(!
pClu°îLi°
)

439  
NULL
;

442 
u8
 
i
 = 0; i < 
pClu°îLi°
->
©åNum
; i++)

444 i‡(
pClu°îLi°
->
©åTabÀ
[
i
].
id
 =
©åId
)

446  (
z˛AârInfo_t
 *)&
pClu°îLi°
->
©åTabÀ
[
i
];

450  
NULL
;

451 
	}
}

466 
_CODE_ZCL_
 
°©us_t
 
	$z˛_gëAârVÆ
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
, u16 *
Àn
, u8 *
vÆ
)

468 
z˛AârInfo_t
 *
pAârLi°
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
©åId
);

469 i‡(!
pAârLi°
)

472 *
Àn
 = 0;

473  
ZCL_STA_NOT_FOUND
;

476 i‡(!
pAârLi°
->
d©a
)

479 *
Àn
 = 0;

480  
ZCL_STA_NOT_FOUND
;

484 *
Àn
 = 
	`z˛_gëAârSize
(
pAârLi°
->
ty≥
,ÖAârLi°->
d©a
);

485 
	`mem˝y
(
vÆ
, 
pAârLi°
->
d©a
, *
Àn
);

487  
ZCL_STA_SUCCESS
;

489 
	}
}

503 
_CODE_ZCL_
 
°©us_t
 
	$z˛_£tAârVÆ
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
, u8 *
vÆ
)

505 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
©åId
);

506 i‡(!
pAârE¡ry
)

508  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

511 
u16
 
Àn
 = 
	`z˛_gëAârSize
(
pAârE¡ry
->
ty≥
, 
vÆ
);

512 
	`mem˝y
(
pAârE¡ry
->
d©a
, 
vÆ
, 
Àn
);

514  
ZCL_STA_SUCCESS
;

515 
	}
}

529 
_CODE_ZCL_
 
z˛AârInfo_t
 *
	$z˛_©åRód
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
, 
°©us_t
 *
°©us
)

531 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
©åId
);

532 i‡(!
pAârE¡ry
)

535 *
°©us
 = 
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

537 i‡(!(
pAârE¡ry
->
ac˚ss
 & 
ACCESS_CONTROL_READ
))

539 *
°©us
 = 
ZCL_STA_WRITE_ONLY
;

541 i‡(!
pAârE¡ry
->
d©a
)

543 *
°©us
 = 
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

547 *
°©us
 = 
ZCL_STA_SUCCESS
;

550 i‡(*
°©us
 =
ZCL_STA_SUCCESS
)

552  
pAârE¡ry
;

556  
NULL
;

558 
	}
}

572 
_CODE_ZCL_
 
°©us_t
 
	$z˛_©åWrôe
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, 
z˛WrôeRec_t
 *
pWrôeRec
, 
boﬁ
 
íabÀ
)

574 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
pWrôeRec
->
©åID
);

575 i‡(!
pAârE¡ry
)

578  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

581 i‡(
pAârE¡ry
->
ty≥
 !
pWrôeRec
->
d©aTy≥
)

583  
ZCL_STA_INVALID_DATA_TYPE
;

586 i‡(!(
pAârE¡ry
->
ac˚ss
 & 
ACCESS_CONTROL_WRITE
))

588  
ZCL_STA_READ_ONLY
;

591 i‡(!
pAârE¡ry
->
d©a
)

593  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

596 i‡(
íabÀ
)

598  
	`z˛_£tAârVÆ
(
ídpoöt
, 
˛u°îId
, 
pWrôeRec
->
©åID
,ÖWrôeRec->
©åD©a
);

602  
ZCL_STA_SUCCESS
;

604 
	}
}

615 
_CODE_ZCL_
 
u8
 
	$z˛_buûdHdr
(
u8
 *
buf
, u8 
˛u°îS≥c
, u8 
dú
, u8 
disDefR•
, 
u16
 
m™ufCode
, u8 
£qNum
, u8 
cmd
)

617 
u8
 *
pBuf
 = 
buf
;

619 ((
z˛FrmCål_t
 *)
pBuf
)->
bf
.
ty≥
 = (
˛u°îS≥c
Ë? 
ZCL_FRAME_TYPE_SPECIFIC_CMD
 : 
ZCL_FRAME_TYPE_PROFILE_CMD
;

620 ((
z˛FrmCål_t
 *)
pBuf
)->
bf
.
m™ufS≥c
 = 
m™ufCode
 ? 1 : 0;

621 ((
z˛FrmCål_t
 *)
pBuf
)->
bf
.
dú
 = dir;

622 ((
z˛FrmCål_t
 *)
pBuf
)->
bf
.
disDefRe•
 = 
disDefR•
;

623 ((
z˛FrmCål_t
 *)
pBuf
)->
bf
.
ª£rved
 = 0;

625 
pBuf
++;

626 i‡(
m™ufCode
)

628 *
pBuf
++ = 
	`LO_UINT16
(
m™ufCode
);

629 *
pBuf
++ = 
	`HI_UINT16
(
m™ufCode
);

631 *
pBuf
++ = 
£qNum
;

632 *
pBuf
++ = 
cmd
;

634  (
pBuf
 - 
buf
);

635 
	}
}

659 
_CODE_ZCL_
 
°©us_t
 
	$z˛_£ndCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u8 
cmd
, u8 
•ecific
,

660 
u8
 
dúe˘i⁄
, u8 
dißbÀDeÁu…R•
, 
u16
 
m™uCode
, u8 
£qNo
, u16 
cmdPldLí
, u8 *
cmdPld
)

662 
u8
 *
asdu
 = (u8 *)
	`ev_buf_Æloˇã
((
z˛Hdr_t
Ë+ 
cmdPldLí
);

663 i‡(!
asdu
)

665  
ZCL_STA_INSUFFICIENT_SPACE
;

668 
u8
 *
pAsdu
 = 
asdu
;

671 
pAsdu
 +
	`z˛_buûdHdr
(
asdu
, 
•ecific
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
cmd
);

674 
	`mem˝y
(
pAsdu
, 
cmdPld
, 
cmdPldLí
);

675 
u16
 
asduÀngth
 = 
pAsdu
 - 
asdu
 + 
cmdPldLí
;

677 
u8
 
≠sC¡
 = 0;

678 
u8
 
°©us
 = 
	`af_d©aSíd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
asduÀngth
, 
asdu
, &
≠sC¡
);

680 
	`ev_buf_‰ì
(
asdu
);

682  (
°©us
 =
RET_OK
Ë? 
ZCL_STA_SUCCESS
 : 
ZCL_STA_INSUFFICIENT_SPACE
;

683 
	}
}

685 
_CODE_ZCL_
 
°©us_t
 
	$z˛_£ndI¡îPANCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u8 
cmd
, u8 
•ecific
,

686 
u8
 
dúe˘i⁄
, u8 
dißbÀDeÁu…R•
, 
u16
 
m™uCode
, u8 
£qNo
, u16 
cmdPldLí
, u8 *
cmdPld
)

688 
u8
 *
asdu
 = (u8 *)
	`ev_buf_Æloˇã
(8 + 
cmdPldLí
);

689 i‡(!
asdu
)

691  
ZCL_STA_INSUFFICIENT_SPACE
;

694 
u8
 *
pAsdu
 = 
asdu
;

697 
pAsdu
 +
	`z˛_buûdHdr
(
asdu
, 
•ecific
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
cmd
);

700 
	`mem˝y
(
pAsdu
, 
cmdPld
, 
cmdPldLí
);

701 
u16
 
asduÀngth
 = 
pAsdu
 - 
asdu
 + 
cmdPldLí
;

703 i‡(
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
 =
˛u°îId
)

705 
pD°EpInfo
->
txO±i⁄s
 |
APS_TX_OPT_INTRA_PAN
;

708 
u8
 
≠sC¡
 = 0;

709 
u8
 
°©us
 = 
	`af_d©aSíd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
asduÀngth
, 
asdu
, &
≠sC¡
);

711 
	`ev_buf_‰ì
(
asdu
);

713  (
°©us
 =
RET_OK
Ë? 
ZCL_STA_SUCCESS
 : 
ZCL_STA_INSUFFICIENT_SPACE
;

714 
	}
}

725 
_CODE_ZCL_
 
°©us_t
 
	$z˛_found©i⁄CmdH™dÀr
(
z˛Incomög_t
 *
pCmd
)

727 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

729 
pCmd
->
hdr
.
cmd
)

731 #ifde‡
ZCL_READ


732 
ZCL_CMD_READ
:

733 
°©us
 = 
	`z˛_ªadH™dÀr
(
pCmd
);

735 
ZCL_CMD_READ_RSP
:

736 
°©us
 = 
	`z˛_ªadR•H™dÀr
(
pCmd
);

739 #ifde‡
ZCL_WRITE


740 
ZCL_CMD_WRITE
:

741 
°©us
 = 
	`z˛_wrôeH™dÀr
(
pCmd
);

743 
ZCL_CMD_WRITE_UNDIVIDED
:

744 
°©us
 = 
	`z˛_wrôeUndividedH™dÀr
(
pCmd
);

746 
ZCL_CMD_WRITE_RSP
:

747 
°©us
 = 
	`z˛_wrôeR•H™dÀr
(
pCmd
);

749 
ZCL_CMD_WRITE_NO_RSP
:

750 
°©us
 = 
	`z˛_wrôeH™dÀr
(
pCmd
);

753 #ifde‡
ZCL_REPORT


754 
ZCL_CMD_CONFIG_REPORT
:

755 
°©us
 = 
	`z˛_c⁄figRï‹tH™dÀr
(
pCmd
);

757 
ZCL_CMD_CONFIG_REPORT_RSP
:

758 
°©us
 = 
	`z˛_c⁄figRï‹tR•H™dÀr
(
pCmd
);

760 
ZCL_CMD_READ_REPORT_CFG
:

761 
°©us
 = 
	`z˛_ªadRï‹tCfgH™dÀr
(
pCmd
);

763 
ZCL_CMD_READ_REPORT_CFG_RSP
:

764 
°©us
 = 
	`z˛_ªadRï‹tCfgR•H™dÀr
(
pCmd
);

766 
ZCL_CMD_REPORT
:

767 
°©us
 = 
	`z˛_ªp‹tH™dÀr
(
pCmd
);

770 
ZCL_CMD_DEFAULT_RSP
:

771 
°©us
 = 
	`z˛_dÊtR•H™dÀr
(
pCmd
);

773 #ifde‡
ZCL_DISCOVER


774 
ZCL_CMD_DISCOVER_ATTR
:

775 
°©us
 = 
	`z˛_discAârsH™dÀr
(
pCmd
);

777 
ZCL_CMD_DISCOVER_ATTR_RSP
:

778 
°©us
 = 
	`z˛_discAârsR•H™dÀr
(
pCmd
);

780 
ZCL_CMD_DISCOVER_CMDS_RCVD
:

781 
ZCL_CMD_DISCOVER_CMDS_RCVD_RSP
:

782 
ZCL_CMD_DISCOVER_CMDS_GEN
:

783 
ZCL_CMD_DISCOVER_CMDS_GEN_RSP
:

784 
°©us
 = (
pCmd
->
hdr
.
m™ufCode
 =
MANUFACTURER_CODE_NONE
Ë? 
ZCL_STA_UNSUP_GENERAL_COMMAND
 : 
ZCL_STA_UNSUP_MANU_GENERAL_COMMAND
;

786 
ZCL_CMD_DISCOVER_ATTR_EXTD
:

787 
°©us
 = 
	`z˛_discAârsExãndedH™dÀr
(
pCmd
);

789 
ZCL_CMD_DISCOVER_ATTR_EXTD_RSP
:

790 
°©us
 = 
	`z˛_discAârsExtR•H™dÀr
(
pCmd
);

794 
°©us
 = (
pCmd
->
hdr
.
m™ufCode
 =
MANUFACTURER_CODE_NONE
Ë? 
ZCL_STA_UNSUP_GENERAL_COMMAND
 : 
ZCL_STA_UNSUP_MANU_GENERAL_COMMAND
;

798  
°©us
;

799 
	}
}

810 
_CODE_ZCL_
 
	$z˛_cmdH™dÀr
(*
pCmd
)

812 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_à*)
pCmd
;

813 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

814 
u8
 
toAµFlg
 = 0;

816 
z˛Incomög_t
 
öMsg
;

817 
	`TL_SETSTRUCTCONTENT
(
öMsg
, 0);

818 
öMsg
.
msg
 = 
pApsdeInd
;

821 i‡(
pApsdeInd
->
asdu
[0] & 
ZCL_FRAME_CONTROL_MANU_SPECIFIC
)

823 i‡(
pApsdeInd
->
asduLí
 >= 5)

825 
öMsg
.
hdr
.
‰mCål
.
byã
 = 
pApsdeInd
->
asdu
[0];

826 
öMsg
.
hdr
.
m™ufCode
 = 
	`BUILD_U16
(
pApsdeInd
->
asdu
[1],ÖApsdeInd->asdu[2]);

827 
öMsg
.
hdr
.
£qNum
 = 
pApsdeInd
->
asdu
[3];

828 
öMsg
.
hdr
.
cmd
 = 
pApsdeInd
->
asdu
[4];

829 
öMsg
.
pD©a
 = &
pApsdeInd
->
asdu
[5];

830 
öMsg
.
d©aLí
 = 
pApsdeInd
->
asduLí
 - 5;

834 
°©us
 = 
ZCL_STA_FAILURE
;

839 i‡(
pApsdeInd
->
asduLí
 >= 3)

841 
öMsg
.
hdr
.
‰mCål
.
byã
 = 
pApsdeInd
->
asdu
[0];

842 
öMsg
.
hdr
.
m™ufCode
 = 0;

843 
öMsg
.
hdr
.
£qNum
 = 
pApsdeInd
->
asdu
[1];

844 
öMsg
.
hdr
.
cmd
 = 
pApsdeInd
->
asdu
[2];

845 
öMsg
.
pD©a
 = &
pApsdeInd
->
asdu
[3];

846 
öMsg
.
d©aLí
 = 
pApsdeInd
->
asduLí
 - 3;

850 
°©us
 = 
ZCL_STA_FAILURE
;

854 i‡(
°©us
 =
ZCL_STA_FAILURE
)

856 
	`ev_buf_‰ì
(
pCmd
);

860 #ifde‡
ZCL_WWAH


861 
°©us
 = 
	`z˛_wwah_ac˚±Check
(&
öMsg
);

864 
u16
 
devE«bÀAârLí
 = 0;

865 
boﬁ
 
devE«bÀ
 = 
TRUE
;

867 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

870 i‡(
öMsg
.
hdr
.
‰mCål
.
bf
.
ty≥
 =
ZCL_FRAME_TYPE_PROFILE_CMD
)

872 
°©us
 = 
	`z˛_found©i⁄CmdH™dÀr
(&
öMsg
);

873 i‡((
°©us
 !
ZCL_STA_UNSUP_GENERAL_COMMAND
Ë&& (°©u†!
ZCL_STA_UNSUP_MANU_GENERAL_COMMAND
) &&

874 (
°©us
 !
ZCL_STA_SUCCESS
Ë&& (°©u†!
ZCL_STA_CMD_HAS_RESP
))

876 
°©us
 = 
ZCL_STA_FAILURE
;

878 
toAµFlg
 = 1;

882 
˛u°îInfo_t
 *
pClu°î
 = 
	`z˛_födClu°î
(
pApsdeInd
->
ödInfo
.
d°_ï
,ÖApsdeInd->ödInfo.
˛u°î_id
);

884 i‡(!
pClu°î
 || (pClu°î && (pClu°î->
m™uCode
 !
öMsg
.
hdr
.
m™ufCode
)))

886 
°©us
 = (
öMsg
.
hdr
.
m™ufCode
 =
MANUFACTURER_CODE_NONE
Ë? 
ZCL_STA_UNSUP_CLUSTER_COMMAND
 : 
ZCL_STA_UNSUP_MANU_CLUSTER_COMMAND
;

891 
	`z˛_gëAârVÆ
(
pApsdeInd
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_GEN_BASIC
, 
ZCL_ATTRID_BASIC_DEV_ENABLED
, &
devE«bÀAârLí
, &
devE«bÀ
);

893 i‡(
devE«bÀ
 || (
pClu°î
->
˛u°îID
 =
ZCL_CLUSTER_GEN_IDENTIFY
))

895 
öMsg
.
˛u°îAµCb
 = 
pClu°î
->clusterAppCb;

896 
öMsg
.
addrInfo
.
dúClu°î
 = inMsg.
hdr
.
‰mCål
.
bf
.
dú
;

897 
öMsg
.
addrInfo
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

898 
öMsg
.
addrInfo
.
§cAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

899 
öMsg
.
addrInfo
.
d°Addr
 = 
pApsdeInd
->
ödInfo
.
d°_addr
;

900 
öMsg
.
addrInfo
.
§cEp
 = 
pApsdeInd
->
ödInfo
.
§c_ï
;

901 
öMsg
.
addrInfo
.
d°Ep
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

902 
öMsg
.
addrInfo
.
£qNum
 = inMsg.
hdr
.seqNum;

904 
°©us
 = 
pClu°î
->
	`cmdH™dÀrFunc
(&
öMsg
);

906 
devE«bÀ
 = 
TRUE
;

912 i‡(
devE«bÀ
)

914 i‡((
öMsg
.
hdr
.
‰mCål
.
bf
.
disDefRe•
 =0 || 
°©us
 !
ZCL_STA_SUCCESS
Ë&& 
	`UNICAST_MSG
(öMsg.
msg
Ë&& (°©u†!
ZCL_STA_CMD_HAS_RESP
))

917 
	`z˛_£ndDÊtR•
(&
öMsg
, inMsg.
hdr
.
cmd
, 
°©us
);

921 i‡(
z˛_v¨s
.
hookFn
 && 
toAµFlg
 && 
öMsg
.
©åCmd
)

923 
z˛_v¨s
.
	`hookFn
(&
öMsg
);

924 
	`ev_buf_‰ì
(
öMsg
.
©åCmd
);

927 
	`ev_buf_‰ì
(
pCmd
);

928 
	}
}

939 
_CODE_ZCL_
 
	$z˛_rx_h™dÀr
(*
pD©a
)

941 
	`TL_SCHEDULE_TASK
(
z˛_cmdH™dÀr
, 
pD©a
);

942 
	}
}

947 #ifde‡
ZCL_READ


963 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªad
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódCmd_t
 *
ªadCmd
)

965 
u16
 
Àn
 = 
ªadCmd
->
numAâr
 * 2;

967 i‡(
Àn
 == 0)

969  
ZCL_STA_INVALID_FIELD
;

972 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

973 i‡(!
buf
)

975  
ZCL_STA_INSUFFICIENT_SPACE
;

978 
u8
 *
pBuf
 = 
buf
;

980 
u8
 
i
 = 0; i < 
ªadCmd
->
numAâr
; i++)

982 *
pBuf
++ = 
	`LO_UINT16
(
ªadCmd
->
©åID
[
i
]);

983 *
pBuf
++ = 
	`HI_UINT16
(
ªadCmd
->
©åID
[
i
]);

986 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_READ
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

988 
	`ev_buf_‰ì
(
buf
);

990  
°©us
;

991 
	}
}

993 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódR•Cmd_t
 *
ªadR•Cmd
)

995 
u16
 
Àn
 = 0;

996 
z˛RódR•Sètus_t
 *
pRódR•Sètus
 = 
NULL
;

998 
u8
 
i
 = 0; i < 
ªadR•Cmd
->
numAâr
; i++)

1000 
pRódR•Sètus
 = &(
ªadR•Cmd
->
©åLi°
[
i
]);

1001 
Àn
 += 2 + 1;

1002 i‡(
pRódR•Sètus
->
°©us
 =
ZCL_STA_SUCCESS
)

1004 
Àn
++;

1005 i‡(
pRódR•Sètus
->
d©a
 !
NULL
)

1007 
Àn
 +
	`z˛_gëAârSize
(
pRódR•Sètus
->
d©aTy≥
,ÖRódR•Sètus->
d©a
);

1012  
ZCL_STA_INVALID_FIELD
;

1017 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1018 i‡(!
buf
)

1020  
ZCL_STA_INSUFFICIENT_SPACE
;

1023 
u8
 *
pBuf
 = 
buf
;

1025 
u8
 
i
 = 0; i < 
ªadR•Cmd
->
numAâr
; i++)

1027 
pRódR•Sètus
 = &(
ªadR•Cmd
->
©åLi°
[
i
]);

1029 *
pBuf
++ = 
	`LO_UINT16
(
pRódR•Sètus
->
©åID
);

1030 *
pBuf
++ = 
	`HI_UINT16
(
pRódR•Sètus
->
©åID
);

1032 *
pBuf
++ = 
pRódR•Sètus
->
°©us
;

1034 i‡(
pRódR•Sètus
->
°©us
 =
ZCL_STA_SUCCESS
)

1037 *
pBuf
++ = 
pRódR•Sètus
->
d©aTy≥
;

1039 i‡(
pRódR•Sètus
->
d©a
 !
NULL
)

1041 
u16
 
d©aLí
 = 
	`z˛_gëAârSize
(
pRódR•Sètus
->
d©aTy≥
,ÖRódR•Sètus->
d©a
);

1042 
	`mem˝y
(
pBuf
, 
pRódR•Sètus
->
d©a
, 
d©aLí
);

1043 
pBuf
 +
d©aLí
;

1048 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_READ_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1050 
	`ev_buf_‰ì
(
buf
);

1052  
°©us
;

1053 
	}
}

1055 
_CODE_ZCL_
 
z˛RódR•Cmd_t
 *
	$z˛_∑r£InRódR•Cmd
(
z˛Incomög_t
 *
pCmd
)

1057 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

1058 
u8
 
numAâr
 = 0;

1059 
u16
 
d©aLí
 = 0;

1060 
u16
 
©åD©aLí
 = 0;

1061 
z˛RódR•Sètus_t
 *
pRódR•Sètus
 = 
NULL
;

1063 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

1065 
u8
 
°©us
;

1067 
numAâr
++;

1068 
pBuf
 += 2;

1070 
°©us
 = *
pBuf
++;

1071 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1073 
u8
 
d©aTy≥
 = *
pBuf
++;

1074 
©åD©aLí
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pBuf
);

1075 
pBuf
 +
©åD©aLí
;

1077 
d©aLí
 +
©åD©aLí
;

1082 
u16
 
Àn
 = (
z˛RódR•Cmd_t
Ë+ 
numAâr
 * (
z˛RódR•Sètus_t
);

1083 
z˛RódR•Cmd_t
 *
p
 = (z˛RódR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
 + 
d©aLí
);

1084 i‡(
p
 !
NULL
)

1086 
pBuf
 = 
pCmd
->
pD©a
;

1087 
u8
 *
pD©a
 = (u8 *)((u8 *)
p
 + 
Àn
);

1089 
p
->
numAâr
 =ÇumAttr;

1090 
u8
 
i
 = 0; i < 
p
->
numAâr
; i++)

1092 
pRódR•Sètus
 = &(
p
->
©åLi°
[
i
]);

1094 
pRódR•Sètus
->
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1095 
pBuf
 += 2;

1097 
pRódR•Sètus
->
°©us
 = *
pBuf
++;

1098 i‡(
pRódR•Sètus
->
°©us
 =
ZCL_STA_SUCCESS
)

1101 
pRódR•Sètus
->
d©aTy≥
 = *
pBuf
++;

1103 
©åD©aLí
 = 
	`z˛_gëAârSize
(
pRódR•Sètus
->
d©aTy≥
, 
pBuf
);

1104 
	`mem˝y
(
pD©a
, 
pBuf
, 
©åD©aLí
);

1105 
pRódR•Sètus
->
d©a
 = 
pD©a
;

1106 
pBuf
 +
©åD©aLí
;

1108 
pD©a
 +
©åD©aLí
;

1113  
p
;

1114 
	}
}

1116 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

1118 
z˛RódR•Cmd_t
 *
pRódR•Cmd
 = 
NULL
;

1121 
pRódR•Cmd
 = 
	`z˛_∑r£InRódR•Cmd
(
pCmd
);

1122 i‡(
pRódR•Cmd
 =
NULL
)

1124  
ZCL_STA_INSUFFICIENT_SPACE
;

1128 
pCmd
->
©åCmd
 = (*)
pRódR•Cmd
;

1131  
ZCL_STA_SUCCESS
;

1132 
	}
}

1134 
_CODE_ZCL_
 
z˛RódCmd_t
 *
	$z˛_∑r£InRódCmd
(
z˛Incomög_t
 *
pCmd
)

1136 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

1138 
z˛RódCmd_t
 *
p
 = (z˛RódCmd_à*)
	`ev_buf_Æloˇã
((z˛RódCmd_tË+ 
pCmd
->
d©aLí
);

1139 i‡(
p
 !
NULL
)

1141 
p
->
numAâr
 = 
pCmd
->
d©aLí
 / 2;

1142 
u8
 
i
 = 0; i < 
p
->
numAâr
; i++)

1144 
p
->
©åID
[
i
] = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1145 
pBuf
 += 2;

1149  
p
;

1150 
	}
}

1152 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadH™dÀr
(
z˛Incomög_t
 *
pCmd
)

1154 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1155 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

1156 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

1159 
g_sysDügs
.
œ°MesßgeLQI
 = 
pCmd
->
msg
->
ödInfo
.
lqi
;

1161 
g_sysDügs
.
œ°MesßgeRSSI
 = 
pCmd
->
msg
->
ödInfo
.
rssi
;

1164 
z˛RódCmd_t
 *
pRódCmd
 = 
	`z˛_∑r£InRódCmd
(
pCmd
);

1165 i‡(
pRódCmd
 =
NULL
)

1167  
ZCL_STA_INSUFFICIENT_SPACE
;

1171 
pCmd
->
©åCmd
 = (*)
pRódCmd
;

1174 i‡(!
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
)

1176  
ZCL_STA_FAILURE
;

1180 
u16
 
Àn
 = (
z˛RódR•Cmd_t
Ë+ (
pRódCmd
->
numAâr
 * (
z˛RódR•Sètus_t
));

1181 
z˛RódR•Cmd_t
 *
pRódR•Cmd
 = (z˛RódR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

1182 i‡(!
pRódR•Cmd
)

1184  
ZCL_STA_INSUFFICIENT_SPACE
;

1187 
pRódR•Cmd
->
numAâr
 = 
pRódCmd
->numAttr;

1189 
u8
 
i
 = 0; i < 
pRódCmd
->
numAâr
; i++)

1191 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_©åRód
(
ídpoöt
, 
˛u°îId
, 
pRódCmd
->
©åID
[
i
], &
°©us
);

1192 i‡(
pAârE¡ry
)

1194 
pRódR•Cmd
->
©åLi°
[
i
].
d©aTy≥
 = 
pAârE¡ry
->
ty≥
;

1195 
pRódR•Cmd
->
©åLi°
[
i
].
d©a
 = 
pAârE¡ry
->data;

1197 
pRódR•Cmd
->
©åLi°
[
i
].
©åID
 = 
pRódCmd
->attrID[i];

1198 
pRódR•Cmd
->
©åLi°
[
i
].
°©us
 = status;

1201 
ïInfo_t
 
d°Ep
;

1202 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1204 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

1205 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

1206 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1207 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

1208 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1209 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

1211 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1214 
°©us
 = 
	`z˛_ªadR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pRódR•Cmd
);

1216 
	`ev_buf_‰ì
((*)
pRódR•Cmd
);

1218 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1220 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1223  
°©us
;

1224 
	}
}

1230 #ifde‡
ZCL_WRITE


1247 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wrôeReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
cmd
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛WrôeCmd_t
 *
wrôeCmd
)

1249 
u16
 
Àn
 = 0;

1250 
z˛WrôeRec_t
 *
pWrôeRec
 = 
NULL
;

1252 
u8
 
i
 = 0; i < 
wrôeCmd
->
numAâr
; i++)

1254 
pWrôeRec
 = &(
wrôeCmd
->
©åLi°
[
i
]);

1255 
Àn
 += 2 + 1;

1256 
Àn
 +
	`z˛_gëAârSize
(
pWrôeRec
->
d©aTy≥
,ÖWrôeRec->
©åD©a
);

1259 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1260 i‡(!
buf
)

1262  
ZCL_STA_INSUFFICIENT_SPACE
;

1265 
u8
 *
pBuf
 = 
buf
;

1267 
u8
 
i
 = 0; i < 
wrôeCmd
->
numAâr
; i++)

1269 
pWrôeRec
 = &(
wrôeCmd
->
©åLi°
[
i
]);

1271 *
pBuf
++ = 
	`LO_UINT16
(
pWrôeRec
->
©åID
);

1272 *
pBuf
++ = 
	`HI_UINT16
(
pWrôeRec
->
©åID
);

1274 *
pBuf
++ = 
pWrôeRec
->
d©aTy≥
;

1276 
u16
 
d©aLí
 = 
	`z˛_gëAârSize
(
pWrôeRec
->
d©aTy≥
,ÖWrôeRec->
©åD©a
);

1277 
	`mem˝y
(
pBuf
, 
pWrôeRec
->
©åD©a
, 
d©aLí
);

1278 
pBuf
 +
d©aLí
;

1281 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
cmd
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1283 
	`ev_buf_‰ì
(
buf
);

1285  
°©us
;

1286 
	}
}

1288 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wrôeR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛WrôeR•Cmd_t
 *
wrôeR•Cmd
)

1290 
u16
 
Àn
 = 
wrôeR•Cmd
->
numAâr
 * (1 + 2);

1292 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1293 i‡(!
buf
)

1295  
ZCL_STA_INSUFFICIENT_SPACE
;

1298 
u8
 *
pBuf
 = 
buf
;

1300 
u8
 
i
 = 0; i < 
wrôeR•Cmd
->
numAâr
; i++)

1302 *
pBuf
++ = 
wrôeR•Cmd
->
©åLi°
[
i
].
°©us
;

1303 *
pBuf
++ = 
	`LO_UINT16
(
wrôeR•Cmd
->
©åLi°
[
i
].
©åID
);

1304 *
pBuf
++ = 
	`HI_UINT16
(
wrôeR•Cmd
->
©åLi°
[
i
].
©åID
);

1307 i‡((
wrôeR•Cmd
->
numAâr
 =1Ë&& (wrôeR•Cmd->
©åLi°
[0].
°©us
 =
ZCL_STA_SUCCESS
))

1309 
Àn
 = 1;

1312 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_WRITE_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1314 
	`ev_buf_‰ì
(
buf
);

1316  
°©us
;

1317 
	}
}

1319 
_CODE_ZCL_
 
z˛WrôeR•Cmd_t
 *
	$z˛_∑r£InWrôeR•Cmd
(
z˛Incomög_t
 *
pCmd
)

1321 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

1322 
u8
 
i
 = 0;

1324 
u16
 
Àn
 = (
z˛WrôeR•Cmd_t
Ë+ 
pCmd
->
d©aLí
;

1325 
z˛WrôeR•Cmd_t
 *
p
 = (z˛WrôeR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

1326 i‡(
p
 !
NULL
)

1328 i‡(
pCmd
->
d©aLí
 == 1)

1330 
p
->
©åLi°
[
i
++].
°©us
 = *
pBuf
;

1334 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

1336 
p
->
©åLi°
[
i
].
°©us
 = *
pBuf
++;

1337 
p
->
©åLi°
[
i
++].
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1338 
pBuf
 += 2;

1341 
p
->
numAâr
 = 
i
;

1344  
p
;

1345 
	}
}

1347 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wrôeR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

1349 
z˛WrôeR•Cmd_t
 *
pWrôeR•Cmd
 = 
NULL
;

1352 
pWrôeR•Cmd
 = 
	`z˛_∑r£InWrôeR•Cmd
(
pCmd
);

1353 i‡(
pWrôeR•Cmd
 =
NULL
)

1355  
ZCL_STA_INSUFFICIENT_SPACE
;

1359 
pCmd
->
©åCmd
 = (*)
pWrôeR•Cmd
;

1362  
ZCL_STA_SUCCESS
;

1363 
	}
}

1365 
_CODE_ZCL_
 
z˛WrôeCmd_t
 *
	$z˛_∑r£InWrôeCmd
(
z˛Incomög_t
 *
pCmd
)

1367 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

1368 
u8
 
numAâr
 = 0;

1369 
u16
 
d©aLí
 = 0;

1370 
u16
 
©åD©aLí
 = 0;

1372 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

1374 
numAâr
++;

1375 
pBuf
 += 2;

1377 
u8
 
d©aTy≥
 = *
pBuf
++;

1379 
©åD©aLí
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pBuf
);

1380 
pBuf
 +
©åD©aLí
;

1382 
d©aLí
 +
©åD©aLí
;

1386 
u16
 
Àn
 = (
z˛WrôeCmd_t
Ë+ 
numAâr
 * (
z˛WrôeRec_t
);

1387 
z˛WrôeCmd_t
 *
p
 = (z˛WrôeCmd_à*)
	`ev_buf_Æloˇã
(
Àn
 + 
d©aLí
);

1388 i‡(
p
 !
NULL
)

1390 
pBuf
 = 
pCmd
->
pD©a
;

1391 
u8
 *
pD©a
 = (u8 *)((u8 *)
p
 + 
Àn
);

1393 
p
->
numAâr
 =ÇumAttr;

1394 
u8
 
i
 = 0; i < 
numAâr
; i++)

1396 
z˛WrôeRec_t
 *
pWrôeRec
 = &(
p
->
©åLi°
[
i
]);

1398 
pWrôeRec
->
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1399 
pBuf
 += 2;

1401 
pWrôeRec
->
d©aTy≥
 = *
pBuf
++;

1403 
©åD©aLí
 = 
	`z˛_gëAârSize
(
pWrôeRec
->
d©aTy≥
, 
pBuf
);

1404 
	`mem˝y
(
pD©a
, 
pBuf
, 
©åD©aLí
);

1405 
pWrôeRec
->
©åD©a
 = 
pD©a
;

1407 
pBuf
 +
©åD©aLí
;

1409 
pD©a
 +
©åD©aLí
;

1413  
p
;

1414 
	}
}

1416 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wrôeH™dÀr
(
z˛Incomög_t
 *
pCmd
)

1418 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1419 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

1420 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

1421 
z˛WrôeR•Cmd_t
 *
pWrôeR•Cmd
 = 
NULL
;

1422 
u8
 
succWrôeAârC¡
 = 0;

1423 
u8
 
ÁûWrôeAârC¡
 = 0;

1424 
boﬁ
 
r•Síd
 = 
FALSE
;

1427 
z˛WrôeCmd_t
 *
pWrôeCmd
 = 
	`z˛_∑r£InWrôeCmd
(
pCmd
);

1428 i‡(
pWrôeCmd
 =
NULL
)

1430  
ZCL_STA_INSUFFICIENT_SPACE
;

1434 
pCmd
->
©åCmd
 = (*)
pWrôeCmd
;

1437 i‡(
pCmd
->
hdr
.
cmd
 =
ZCL_CMD_WRITE
)

1440 
u16
 
Àn
 = (
z˛WrôeR•Cmd_t
Ë+ (
pWrôeCmd
->
numAâr
 * (
z˛WrôeR•Sètus_t
));

1441 
pWrôeR•Cmd
 = (
z˛WrôeR•Cmd_t
 *)
	`ev_buf_Æloˇã
(
Àn
);

1442 i‡(!
pWrôeR•Cmd
)

1444  
ZCL_STA_INSUFFICIENT_SPACE
;

1447 
r•Síd
 = 
TRUE
;

1450 
u8
 
i
 = 0; i < 
pWrôeCmd
->
numAâr
; i++)

1452 
z˛WrôeRec_t
 *
pWrôeRec
 = &(
pWrôeCmd
->
©åLi°
[
i
]);

1454 
°©us
 = 
	`z˛_©åWrôe
(
ídpoöt
, 
˛u°îId
, 
pWrôeRec
, 
TRUE
);

1456 i‡(
r•Síd
)

1458 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1460 
succWrôeAârC¡
++;

1464 
pWrôeR•Cmd
->
©åLi°
[
ÁûWrôeAârC¡
].
°©us
 = status;

1465 
pWrôeR•Cmd
->
©åLi°
[
ÁûWrôeAârC¡
++].
©åID
 = 
pWrôeRec
->attrID;

1470 i‡(
r•Síd
)

1472 i‡(
pWrôeCmd
->
numAâr
 =
succWrôeAârC¡
)

1474 
pWrôeR•Cmd
->
numAâr
 = 1;

1475 
pWrôeR•Cmd
->
©åLi°
[0].
°©us
 = 
ZCL_STA_SUCCESS
;

1479 
pWrôeR•Cmd
->
numAâr
 = 
ÁûWrôeAârC¡
;

1482 
ïInfo_t
 
d°Ep
;

1483 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1485 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

1486 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

1487 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1488 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

1489 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1490 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

1492 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1495 
°©us
 = 
	`z˛_wrôeR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pWrôeR•Cmd
);

1497 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1498 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1500 
	`ev_buf_‰ì
((*)
pWrôeR•Cmd
);

1503  
°©us
;

1504 
	}
}

1506 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wrôeUndividedH™dÀr
(
z˛Incomög_t
 *
pCmd
)

1508 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1509 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

1510 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

1511 
z˛WrôeRec_t
 *
pWrôeRec
 = 
NULL
;

1512 
boﬁ
 
√edWrôe
 = 
TRUE
;

1515 
z˛WrôeCmd_t
 *
pWrôeCmd
 = 
	`z˛_∑r£InWrôeCmd
(
pCmd
);

1516 i‡(
pWrôeCmd
 =
NULL
)

1518  
ZCL_STA_INSUFFICIENT_SPACE
;

1522 
pCmd
->
©åCmd
 = (*)
pWrôeCmd
;

1525 
u16
 
Àn
 = (
z˛WrôeR•Cmd_t
Ë+ 
pWrôeCmd
->
numAâr
 * (
z˛WrôeR•Sètus_t
);

1526 
z˛WrôeR•Cmd_t
 *
pWrôeR•Cmd
 = (z˛WrôeR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

1527 i‡(!
pWrôeR•Cmd
)

1529  
ZCL_STA_INSUFFICIENT_SPACE
;

1532 
u8
 
i
 = 0; i < 
pWrôeCmd
->
numAâr
; i++)

1534 
pWrôeRec
 = &(
pWrôeCmd
->
©åLi°
[
i
]);

1536 
°©us
 = 
	`z˛_©åWrôe
(
ídpoöt
, 
˛u°îId
, 
pWrôeRec
, 
FALSE
);

1538 
pWrôeR•Cmd
->
©åLi°
[
i
].
°©us
 = status;

1539 
pWrôeR•Cmd
->
©åLi°
[
i
].
©åID
 = 
pWrôeRec
->attrID;

1541 i‡(
°©us
 !
ZCL_STA_SUCCESS
)

1543 
√edWrôe
 = 
FALSE
;

1547 
pWrôeR•Cmd
->
numAâr
 = 
pWrôeCmd
->numAttr;

1549 i‡(
√edWrôe
)

1551 
u8
 
i
 = 0; i < 
pWrôeCmd
->
numAâr
; i++)

1553 
pWrôeRec
 = &(
pWrôeCmd
->
©åLi°
[
i
]);

1555 
	`z˛_©åWrôe
(
ídpoöt
, 
˛u°îId
, 
pWrôeRec
, 
TRUE
);

1558 
pWrôeR•Cmd
->
numAâr
 = 1;

1559 
pWrôeR•Cmd
->
©åLi°
[0].
°©us
 = 
ZCL_STA_SUCCESS
;

1562 
ïInfo_t
 
d°Ep
;

1563 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1565 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

1566 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

1567 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1568 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

1569 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

1571 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1574 
°©us
 = 
	`z˛_wrôeR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pWrôeR•Cmd
);

1576 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

1577 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1579 
	`ev_buf_‰ì
((*)
pWrôeR•Cmd
);

1581  
°©us
;

1582 
	}
}

1588 #ifde‡
ZCL_REPORT


1589 
_CODE_ZCL_
 
°©us_t
 
	$z˛_c⁄figRï‹t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛CfgRï‹tCmd_t
 *
cfgRï‹tCmd
)

1591 
u16
 
Àn
 = 0;

1592 
z˛CfgRï‹tRec_t
 *
pRï‹tRec
 = 
NULL
;

1594 
u8
 
i
 = 0; i < 
cfgRï‹tCmd
->
numAâr
; i++)

1596 
pRï‹tRec
 = &(
cfgRï‹tCmd
->
©åLi°
[
i
]);

1598 
Àn
 += 1 + 2;

1600 i‡(
pRï‹tRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1602 
Àn
 += 1 + 2 + 2;

1604 i‡(
	`z˛_™ÆogD©aTy≥
(
pRï‹tRec
->
d©aTy≥
))

1606 
Àn
 +
	`z˛_gëAârSize
(
pRï‹tRec
->
d©aTy≥
,ÖRï‹tRec->
ªp‹èbÀCh™ge
);

1611 
Àn
 += 2;

1615 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1616 i‡(!
buf
)

1618  
ZCL_STA_INSUFFICIENT_SPACE
;

1621 
u8
 *
pBuf
 = 
buf
;

1623 
u8
 
i
 = 0; i < 
cfgRï‹tCmd
->
numAâr
; i++)

1625 
pRï‹tRec
 = &(
cfgRï‹tCmd
->
©åLi°
[
i
]);

1627 *
pBuf
++ = 
pRï‹tRec
->
dúe˘i⁄
;

1628 *
pBuf
++ = 
	`LO_UINT16
(
pRï‹tRec
->
©åID
);

1629 *
pBuf
++ = 
	`HI_UINT16
(
pRï‹tRec
->
©åID
);

1631 i‡(
pRï‹tRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1633 *
pBuf
++ = 
pRï‹tRec
->
d©aTy≥
;

1634 *
pBuf
++ = 
	`LO_UINT16
(
pRï‹tRec
->
möRï‹tI¡
);

1635 *
pBuf
++ = 
	`HI_UINT16
(
pRï‹tRec
->
möRï‹tI¡
);

1636 *
pBuf
++ = 
	`LO_UINT16
(
pRï‹tRec
->
maxRï‹tI¡
);

1637 *
pBuf
++ = 
	`HI_UINT16
(
pRï‹tRec
->
maxRï‹tI¡
);

1639 i‡(
	`z˛_™ÆogD©aTy≥
(
pRï‹tRec
->
d©aTy≥
))

1641 
u16
 
d©aLí
 = 
	`z˛_gëAârSize
(
pRï‹tRec
->
d©aTy≥
,ÖRï‹tRec->
ªp‹èbÀCh™ge
);

1642 
	`mem˝y
(
pBuf
, 
pRï‹tRec
->
ªp‹èbÀCh™ge
, 
d©aLí
);

1643 
pBuf
 +
d©aLí
;

1648 *
pBuf
++ = 
	`LO_UINT16
(
pRï‹tRec
->
timeoutPîiod
);

1649 *
pBuf
++ = 
	`HI_UINT16
(
pRï‹tRec
->
timeoutPîiod
);

1653 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_CONFIG_REPORT
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1655 
	`ev_buf_‰ì
(
buf
);

1657  
°©us
;

1658 
	}
}

1660 
_CODE_ZCL_
 
°©us_t
 
	$z˛_c⁄figRï‹tR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛CfgRï‹tR•Cmd_t
 *
cfgRï‹tR•Cmd
)

1662 
u16
 
Àn
 = 
cfgRï‹tR•Cmd
->
numAâr
 * (1 + 1 + 2);

1664 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1665 i‡(!
buf
)

1667  
ZCL_STA_INSUFFICIENT_SPACE
;

1670 
u8
 *
pBuf
 = 
buf
;

1672 
u8
 
i
 = 0; i < 
cfgRï‹tR•Cmd
->
numAâr
; i++)

1674 *
pBuf
++ = 
cfgRï‹tR•Cmd
->
©åLi°
[
i
].
°©us
;

1675 *
pBuf
++ = 
cfgRï‹tR•Cmd
->
©åLi°
[
i
].
dúe˘i⁄
;

1676 *
pBuf
++ = 
	`LO_UINT16
(
cfgRï‹tR•Cmd
->
©åLi°
[
i
].
©åID
);

1677 *
pBuf
++ = 
	`HI_UINT16
(
cfgRï‹tR•Cmd
->
©åLi°
[
i
].
©åID
);

1680 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_CONFIG_REPORT_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1682 
	`ev_buf_‰ì
(
buf
);

1684  
°©us
;

1685 
	}
}

1687 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadRï‹tC⁄fig
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódRï‹tCfgCmd_t
 *
ªadRï‹tCfgCmd
)

1689 
u16
 
Àn
 = 
ªadRï‹tCfgCmd
->
numAâr
 * (1 + 2);

1691 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1692 i‡(!
buf
)

1694  
ZCL_STA_INSUFFICIENT_SPACE
;

1697 
u8
 *
pBuf
 = 
buf
;

1699 
u8
 
i
 = 0; i < 
ªadRï‹tCfgCmd
->
numAâr
; i++)

1701 *
pBuf
++ = 
ªadRï‹tCfgCmd
->
©åLi°
[
i
].
dúe˘i⁄
;

1702 *
pBuf
++ = 
	`LO_UINT16
(
ªadRï‹tCfgCmd
->
©åLi°
[
i
].
©åID
);

1703 *
pBuf
++ = 
	`HI_UINT16
(
ªadRï‹tCfgCmd
->
©åLi°
[
i
].
©åID
);

1706 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_READ_REPORT_CFG
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1708 
	`ev_buf_‰ì
(
buf
);

1710  
°©us
;

1711 
	}
}

1713 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadRï‹tC⁄figR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódRï‹tCfgR•Cmd_t
 *
ªadRï‹tCfgR•Cmd
)

1715 
u16
 
Àn
 = 0;

1716 
z˛Rï‹tCfgR•Rec_t
 *
pRec
 = 
NULL
;

1718 
u8
 
i
 = 0; i < 
ªadRï‹tCfgR•Cmd
->
numAâr
; i++)

1720 
pRec
 = &(
ªadRï‹tCfgR•Cmd
->
©åLi°
[
i
]);

1722 
Àn
 += 1 + 1 + 2;

1724 i‡(
pRec
->
°©us
 =
ZCL_STA_SUCCESS
)

1726 i‡(
pRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1728 
Àn
 += 1 + 2 + 2;

1729 i‡(
	`z˛_™ÆogD©aTy≥
(
pRec
->
d©aTy≥
))

1731 
Àn
 +
	`z˛_gëAârSize
(
pRec
->
d©aTy≥
,ÖRec->
ªp‹èbÀCh™ge
);

1736 
Àn
 += 2;

1741 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1742 i‡(!
buf
)

1744  
ZCL_STA_INSUFFICIENT_SPACE
;

1747 
u8
 *
pBuf
 = 
buf
;

1749 
u8
 
i
 = 0; i < 
ªadRï‹tCfgR•Cmd
->
numAâr
; i++)

1751 
pRec
 = &(
ªadRï‹tCfgR•Cmd
->
©åLi°
[
i
]);

1753 *
pBuf
++ = 
pRec
->
°©us
;

1754 *
pBuf
++ = 
pRec
->
dúe˘i⁄
;

1755 *
pBuf
++ = 
	`LO_UINT16
(
pRec
->
©åID
);

1756 *
pBuf
++ = 
	`HI_UINT16
(
pRec
->
©åID
);

1758 i‡(
pRec
->
°©us
 =
ZCL_STA_SUCCESS
)

1760 i‡(
pRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1762 *
pBuf
++ = 
pRec
->
d©aTy≥
;

1763 *
pBuf
++ = 
	`LO_UINT16
(
pRec
->
möRï‹tI¡
);

1764 *
pBuf
++ = 
	`HI_UINT16
(
pRec
->
möRï‹tI¡
);

1765 *
pBuf
++ = 
	`LO_UINT16
(
pRec
->
maxRï‹tI¡
);

1766 *
pBuf
++ = 
	`HI_UINT16
(
pRec
->
maxRï‹tI¡
);

1768 i‡(
	`z˛_™ÆogD©aTy≥
(
pRec
->
d©aTy≥
))

1770 
u16
 
d©aLí
 = 
	`z˛_gëAârSize
(
pRec
->
d©aTy≥
,ÖRec->
ªp‹èbÀCh™ge
);

1771 
	`mem˝y
(
pBuf
, 
pRec
->
ªp‹èbÀCh™ge
, 
d©aLí
);

1772 
pBuf
 +
d©aLí
;

1777 *
pBuf
++ = 
	`LO_UINT16
(
pRec
->
timeoutPîiod
);

1778 *
pBuf
++ = 
	`HI_UINT16
(
pRec
->
timeoutPîiod
);

1783 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_READ_REPORT_CFG_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1785 
	`ev_buf_‰ì
(
buf
);

1787  
°©us
;

1788 
	}
}

1790 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªp‹t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
u16
 
m™uCode
, u16 
˛u°îId
, u16 
©åID
, u8 
d©aTy≥
, u8 *
pD©a
)

1792 
u16
 
Àn
 = 0;

1793 
u8
 
©åSize
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pD©a
);

1795 
Àn
 += 2 + 1;

1796 
Àn
 +
©åSize
;

1798 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

1799 i‡(!
buf
)

1801  
ZCL_STA_INSUFFICIENT_SPACE
;

1804 
u8
 *
pBuf
 = 
buf
;

1806 *
pBuf
++ = 
	`LO_UINT16
(
©åID
);

1807 *
pBuf
++ = 
	`HI_UINT16
(
©åID
);

1808 *
pBuf
++ = 
d©aTy≥
;

1809 
	`mem˝y
(
pBuf
, 
pD©a
, 
©åSize
);

1811 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_REPORT
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

1813 
	`ev_buf_‰ì
(
buf
);

1815  
°©us
;

1816 
	}
}

1818 
_CODE_ZCL_
 
z˛CfgRï‹tCmd_t
 *
	$z˛_∑r£InCfgRï‹tCmd
(
z˛Incomög_t
 *
pCmd
)

1820 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

1821 
u8
 
dúe˘i⁄
;

1822 
u8
 
d©aTy≥
;

1823 
u8
 
numAâr
 = 0;

1824 
u8
 
ªp‹tCh™geLí
;

1825 
u16
 
d©aLí
 = 0;

1826 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
 = 
NULL
;

1828 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

1830 
numAâr
++;

1832 
dúe˘i⁄
 = *
pBuf
++;

1833 
pBuf
 += 2;

1835 i‡(
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1837 
d©aTy≥
 = *
pBuf
++;

1838 
pBuf
 += 4;

1840 i‡(
	`z˛_™ÆogD©aTy≥
(
d©aTy≥
))

1842 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
d©aTy≥
);

1843 
pBuf
 +
ªp‹tCh™geLí
;

1845 
d©aLí
 +
ªp‹tCh™geLí
;

1849 
pBuf
++;

1854 
pBuf
 += 2;

1858 
u8
 
Àn
 = (
z˛CfgRï‹tCmd_t
Ë+ 
numAâr
 * (
z˛CfgRï‹tRec_t
);

1859 
z˛CfgRï‹tCmd_t
 *
p
 = (z˛CfgRï‹tCmd_à*)
	`ev_buf_Æloˇã
(
Àn
 + 
d©aLí
);

1860 i‡(
p
 !
NULL
)

1862 
	`mem£t
((
u8
 *)
p
, 0, 
Àn
 + 
d©aLí
);

1864 
pBuf
 = 
pCmd
->
pD©a
;

1865 
u8
 *
pD©a
 = (u8 *)((u8 *)
p
 + 
Àn
);

1867 
p
->
numAâr
 =ÇumAttr;

1869 
u8
 
i
 = 0; i < 
numAâr
; i++)

1871 
pCfgRï‹tRec
 = &(
p
->
©åLi°
[
i
]);

1873 
pCfgRï‹tRec
->
dúe˘i⁄
 = *
pBuf
++;

1874 
pCfgRï‹tRec
->
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1875 
pBuf
 += 2;

1876 i‡(
pCfgRï‹tRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

1878 
pCfgRï‹tRec
->
d©aTy≥
 = *
pBuf
++;

1879 
pCfgRï‹tRec
->
möRï‹tI¡
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1880 
pBuf
 += 2;

1881 
pCfgRï‹tRec
->
maxRï‹tI¡
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1882 
pBuf
 += 2;

1884 i‡(
	`z˛_™ÆogD©aTy≥
(
pCfgRï‹tRec
->
d©aTy≥
))

1886 
	`z˛_™ÆogD©aBuûd
(
pCfgRï‹tRec
->
d©aTy≥
, 
pD©a
, 
pBuf
);

1887 
pCfgRï‹tRec
->
ªp‹èbÀCh™ge
 = 
pD©a
;

1889 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
pCfgRï‹tRec
->
d©aTy≥
);

1890 
pBuf
 +
ªp‹tCh™geLí
;

1892 
pD©a
 +
ªp‹tCh™geLí
;

1897 
pCfgRï‹tRec
->
timeoutPîiod
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

1898 
pBuf
 += 2;

1903  
p
;

1904 
	}
}

1906 
_CODE_ZCL_
 
°©us_t
 
	$z˛_c⁄figuªRï‹tög
(
u8
 
ídpoöt
, 
u16
 
¥ofûeId
, u16 
˛u°îId
, 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
)

1908 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
pCfgRï‹tRec
->
©åID
);

1909 i‡(!
pAârE¡ry
)

1911  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

1914 i‡(
pAârE¡ry
->
ty≥
 !
pCfgRï‹tRec
->
d©aTy≥
)

1916  
ZCL_STA_INVALID_DATA_TYPE
;

1919 i‡(!(
pAârE¡ry
->
ac˚ss
 & 
ACCESS_CONTROL_REPORTABLE
))

1921  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

1924 i‡(
pCfgRï‹tRec
->
dúe˘i⁄
 =
ZCL_EXPECT_ATTR_REPORTS
)

1927  
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

1930 
ªp‹tCfgInfo_t
 *
pE¡ry
 = 
	`z˛_ªp‹tCfgInfoE¡ryFöd
(
ídpoöt
, 
˛u°îId
, 
pCfgRï‹tRec
->
©åID
);

1932 i‡(
pCfgRï‹tRec
->
maxRï‹tI¡
 == 0xFFFF)

1935 i‡(!
pE¡ry
)

1937  
ZCL_STA_NOT_FOUND
;

1940 i‡(
pCfgRï‹tRec
->
maxRï‹tI¡
 == 0)

1942 i‡(
pCfgRï‹tRec
->
möRï‹tI¡
 == 0xFFFF)

1945 i‡(!
pE¡ry
)

1947  
ZCL_STA_NOT_FOUND
;

1951 
	`z˛_ªp‹tCfgInfoE¡ryR°
(
pE¡ry
);

1952  
ZCL_STA_SUCCESS
;

1957 i‡(!
pE¡ry
)

1959 
pE¡ry
 = 
	`z˛_ªp‹tCfgInfoE¡ryFªeGë
();

1960 i‡(!
pE¡ry
)

1962  
ZCL_STA_INSUFFICIENT_SPACE
;

1966 
	`z˛_ªp‹tCfgInfoE¡ryUpd©e
(
pE¡ry
, 
ídpoöt
, 
¥ofûeId
, 
˛u°îId
, 
pCfgRï‹tRec
);

1968  
ZCL_STA_SUCCESS
;

1969 
	}
}

1971 
_CODE_ZCL_
 
°©us_t
 
	$z˛_c⁄figRï‹tH™dÀr
(
z˛Incomög_t
 *
pCmd
)

1973 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1974 
u16
 
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

1975 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

1976 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

1977 
u8
 
cfgRï‹tCh™ge
 = 0;

1980 
z˛CfgRï‹tCmd_t
 *
pCfgRï‹tCmd
 = 
	`z˛_∑r£InCfgRï‹tCmd
(
pCmd
);

1981 i‡(
pCfgRï‹tCmd
 =
NULL
)

1983  
ZCL_STA_INSUFFICIENT_SPACE
;

1987 
pCmd
->
©åCmd
 = (*)
pCfgRï‹tCmd
;

1990 i‡(
pCfgRï‹tCmd
->
numAâr
 == 0)

1992  
ZCL_STA_INVALID_FIELD
;

1995 
u8
 
Àn
 = (
z˛CfgRï‹tR•Cmd_t
Ë+ 
pCfgRï‹tCmd
->
numAâr
 * (
z˛CfgRï‹tSètus_t
);

1996 
z˛CfgRï‹tR•Cmd_t
 *
pCfgRï‹tR•Cmd
 = (z˛CfgRï‹tR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

1997 i‡(!
pCfgRï‹tR•Cmd
)

1999  
ZCL_STA_INSUFFICIENT_SPACE
;

2002 
pCfgRï‹tR•Cmd
->
numAâr
 = 
pCfgRï‹tCmd
->numAttr;

2004 
u8
 
i
 = 0; i < 
pCfgRï‹tCmd
->
numAâr
; i++)

2006 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
 = &(
pCfgRï‹tCmd
->
©åLi°
[
i
]);

2008 
°©us
 = 
	`z˛_c⁄figuªRï‹tög
(
ídpoöt
, 
¥ofûeId
, 
˛u°îId
, 
pCfgRï‹tRec
);

2009 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2011 
cfgRï‹tCh™ge
 = 1;

2014 
pCfgRï‹tR•Cmd
->
©åLi°
[
i
].
°©us
 = status;

2015 
pCfgRï‹tR•Cmd
->
©åLi°
[
i
].
©åID
 = 
pCfgRï‹tRec
->attrID;

2016 
pCfgRï‹tR•Cmd
->
©åLi°
[
i
].
dúe˘i⁄
 = 
pCfgRï‹tRec
->direction;

2019 i‡(
cfgRï‹tCh™ge
)

2021 
cfgRï‹tCh™ge
 = 0;

2022 
	`z˛_ªp‹tögTab_ßve
();

2025 
ïInfo_t
 
d°Ep
;

2026 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

2028 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

2029 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

2030 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

2031 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

2032 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

2034 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

2037 
°©us
 = 
	`z˛_c⁄figRï‹tR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pCfgRï‹tR•Cmd
);

2039 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2040 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

2042 
	`ev_buf_‰ì
((*)
pCfgRï‹tR•Cmd
);

2044  
°©us
;

2045 
	}
}

2047 
_CODE_ZCL_
 
z˛CfgRï‹tR•Cmd_t
 *
	$z˛_∑r£InCfgRï‹tR•Cmd
(
z˛Incomög_t
 *
pCmd
)

2049 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2050 
u8
 
numAâr
 = 
pCmd
->
d©aLí
 / (1 + 1 + 2);

2052 
u16
 
Àn
 = (
z˛CfgRï‹tR•Cmd_t
Ë+ 
numAâr
 * (
z˛CfgRï‹tSètus_t
);

2053 
z˛CfgRï‹tR•Cmd_t
 *
p
 = (z˛CfgRï‹tR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2054 i‡(
p
 !
NULL
)

2056 
p
->
numAâr
 =ÇumAttr;

2057 
u8
 
i
 = 0; i < 
p
->
numAâr
; i++)

2059 
p
->
©åLi°
[
i
].
°©us
 = *
pBuf
++;

2060 
p
->
©åLi°
[
i
].
dúe˘i⁄
 = *
pBuf
++;

2061 
p
->
©åLi°
[
i
].
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2062 
pBuf
 += 2;

2066  
p
;

2067 
	}
}

2069 
_CODE_ZCL_
 
u8
 
	$z˛_c⁄figRï‹tR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

2071 
z˛CfgRï‹tR•Cmd_t
 *
pCfgRï‹tR•Cmd
 = 
NULL
;

2074 
pCfgRï‹tR•Cmd
 = 
	`z˛_∑r£InCfgRï‹tR•Cmd
(
pCmd
);

2075 i‡(
pCfgRï‹tR•Cmd
 =
NULL
)

2077  
ZCL_STA_INSUFFICIENT_SPACE
;

2081 
pCmd
->
©åCmd
 = (*)
pCfgRï‹tR•Cmd
;

2084  
ZCL_STA_SUCCESS
;

2085 
	}
}

2087 
_CODE_ZCL_
 
z˛RódRï‹tCfgCmd_t
 *
	$z˛_∑r£InRódRï‹tCfgCmd
(
z˛Incomög_t
 *
pCmd
)

2089 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2090 
u8
 
numAâr
 = 
pCmd
->
d©aLí
 / (1 + 2);

2092 
u16
 
Àn
 = (
z˛RódRï‹tCfgCmd_t
Ë+ 
numAâr
 * (
z˛RódRï‹tCfgRec_t
);

2093 
z˛RódRï‹tCfgCmd_t
 *
p
 = (z˛RódRï‹tCfgCmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2094 i‡(
p
 !
NULL
)

2096 
p
->
numAâr
 =ÇumAttr;

2097 
u8
 
i
 = 0; i < 
numAâr
; i++)

2099 
p
->
©åLi°
[
i
].
dúe˘i⁄
 = *
pBuf
++;

2100 
p
->
©åLi°
[
i
].
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2101 
pBuf
 += 2;

2105  
p
;

2106 
	}
}

2108 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadRï‹tCfgH™dÀr
(
z˛Incomög_t
 *
pCmd
)

2110 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

2111 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

2112 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

2115 
z˛RódRï‹tCfgCmd_t
 *
pRódRï‹tCfgCmd
 = 
	`z˛_∑r£InRódRï‹tCfgCmd
(
pCmd
);

2116 i‡(
pRódRï‹tCfgCmd
 =
NULL
)

2118  
ZCL_STA_INSUFFICIENT_SPACE
;

2122 
pCmd
->
©åCmd
 = (*)
pRódRï‹tCfgCmd
;

2125 
u8
 
Àn
 = (
z˛RódRï‹tCfgR•Cmd_t
Ë+ 
pRódRï‹tCfgCmd
->
numAâr
 * (
z˛Rï‹tCfgR•Rec_t
);

2126 
z˛RódRï‹tCfgR•Cmd_t
 *
pRódRï‹tCfgR•Cmd
 = (z˛RódRï‹tCfgR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2127 i‡(!
pRódRï‹tCfgR•Cmd
)

2129  
ZCL_STA_INSUFFICIENT_SPACE
;

2132 
pRódRï‹tCfgR•Cmd
->
numAâr
 = 
pRódRï‹tCfgCmd
->numAttr;

2134 
u8
 
i
 = 0; i < 
pRódRï‹tCfgCmd
->
numAâr
; i++)

2136 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
ídpoöt
, 
˛u°îId
, 
pRódRï‹tCfgCmd
->
©åLi°
[
i
].
©åID
);

2137 i‡(
pAârE¡ry
)

2139 i‡(
pRódRï‹tCfgCmd
->
©åLi°
[
i
].
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

2141 i‡(!(
pAârE¡ry
->
ac˚ss
 & 
ACCESS_CONTROL_REPORTABLE
))

2143 
°©us
 = 
ZCL_STA_UNREPORTABLE_ATTRIBUTE
;

2147 
ªp‹tCfgInfo_t
 *
pE¡ry
 = 
	`z˛_ªp‹tCfgInfoE¡ryFöd
(
ídpoöt
, 
˛u°îId
, 
pRódRï‹tCfgCmd
->
©åLi°
[
i
].
©åID
);

2148 i‡(!
pE¡ry
)

2150 
°©us
 = 
ZCL_STA_NOT_FOUND
;

2154 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
d©aTy≥
 = 
pE¡ry
->dataType;

2155 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
möRï‹tI¡
 = 
pE¡ry
->
möI¡îvÆ
;

2156 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
maxRï‹tI¡
 = 
pE¡ry
->
maxI¡îvÆ
;

2157 i‡(
	`z˛_™ÆogD©aTy≥
(
pE¡ry
->
d©aTy≥
))

2159 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
ªp‹èbÀCh™ge
 = 
pE¡ry
->reportableChange;

2167 
°©us
 = 
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

2172 
°©us
 = 
ZCL_STA_UNSUPPORTED_ATTRIBUTE
;

2175 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
°©us
 = status;

2176 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
dúe˘i⁄
 = 
pRódRï‹tCfgCmd
->attrList[i].direction;

2177 
pRódRï‹tCfgR•Cmd
->
©åLi°
[
i
].
©åID
 = 
pRódRï‹tCfgCmd
->attrList[i].attrID;

2180 
ïInfo_t
 
d°Ep
;

2181 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

2183 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

2184 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

2185 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

2186 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

2187 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

2189 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

2192 
°©us
 = 
	`z˛_ªadRï‹tC⁄figR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pRódRï‹tCfgR•Cmd
);

2194 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2195 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

2197 
	`ev_buf_‰ì
((
u8
 *)
pRódRï‹tCfgR•Cmd
);

2199  
°©us
;

2200 
	}
}

2202 
_CODE_ZCL_
 
z˛RódRï‹tCfgR•Cmd_t
 *
	$z˛_∑r£InRódRï‹tCfgR•Cmd
(
z˛Incomög_t
 *
pCmd
)

2204 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2205 
u8
 
numAâr
 = 0;

2206 
u8
 
°©us
;

2207 
u8
 
dúe˘i⁄
;

2208 
u8
 
d©aTy≥
;

2209 
u8
 
ªp‹tCh™geLí
 = 0;

2210 
u16
 
d©aLí
 = 0;

2211 
z˛Rï‹tCfgR•Rec_t
 *
pRec
 = 
NULL
;

2213 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

2215 
numAâr
++;

2217 
°©us
 = *
pBuf
++;

2218 
dúe˘i⁄
 = *
pBuf
++;

2219 
pBuf
 += 2;

2221 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2223 i‡(
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

2225 
d©aTy≥
 = *
pBuf
++;

2226 
pBuf
 += 4;

2228 i‡(
	`z˛_™ÆogD©aTy≥
(
d©aTy≥
))

2230 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
d©aTy≥
);

2231 
pBuf
 +
ªp‹tCh™geLí
;

2233 
d©aLí
 +
ªp‹tCh™geLí
;

2238 
pBuf
 += 2;

2243 
u16
 
Àn
 = (
z˛RódRï‹tCfgR•Cmd_t
Ë+ 
numAâr
 * (
z˛Rï‹tCfgR•Rec_t
);

2244 
z˛RódRï‹tCfgR•Cmd_t
 *
p
 = (z˛RódRï‹tCfgR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
 + 
d©aLí
);

2245 i‡(
p
 !
NULL
)

2247 
pBuf
 = 
pCmd
->
pD©a
;

2248 
u8
 *
pD©a
 = (u8 *)((u8 *)
p
 + 
Àn
);

2250 
p
->
numAâr
 =ÇumAttr;

2251 
u8
 
i
 = 0; i < 
numAâr
; i++)

2253 
pRec
 = &(
p
->
©åLi°
[
i
]);

2255 
pRec
->
°©us
 = *
pBuf
++;

2256 
pRec
->
dúe˘i⁄
 = *
pBuf
++;

2257 
pRec
->
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2258 
pBuf
 += 2;

2260 i‡(
pRec
->
°©us
 =
ZCL_STA_SUCCESS
)

2262 i‡(
pRec
->
dúe˘i⁄
 =
ZCL_SEND_ATTR_REPORTS
)

2264 
pRec
->
d©aTy≥
 = *
pBuf
++;

2265 
pRec
->
möRï‹tI¡
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2266 
pBuf
 += 2;

2267 
pRec
->
maxRï‹tI¡
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2268 
pBuf
 += 2;

2269 i‡(
	`z˛_™ÆogD©aTy≥
(
pRec
->
d©aTy≥
))

2271 
	`z˛_™ÆogD©aBuûd
(
pRec
->
d©aTy≥
, 
pD©a
, 
pBuf
);

2272 
pRec
->
ªp‹èbÀCh™ge
 = 
pD©a
;

2274 
ªp‹tCh™geLí
 = 
	`z˛_gëD©aTy≥Lí
(
pRec
->
d©aTy≥
);

2275 
pBuf
 +
ªp‹tCh™geLí
;

2277 
pD©a
 +
ªp‹tCh™geLí
;

2282 
pRec
->
timeoutPîiod
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2283 
pBuf
 += 2;

2289  
p
;

2290 
	}
}

2292 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªadRï‹tCfgR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

2294 
z˛RódRï‹tCfgR•Cmd_t
 *
pRódRï‹tCfgR•Cmd
 = 
NULL
;

2297 
pRódRï‹tCfgR•Cmd
 = 
	`z˛_∑r£InRódRï‹tCfgR•Cmd
(
pCmd
);

2298 i‡(
pRódRï‹tCfgR•Cmd
 =
NULL
)

2300  
ZCL_STA_INSUFFICIENT_SPACE
;

2304 
pCmd
->
©åCmd
 = (*)
pRódRï‹tCfgR•Cmd
;

2307  
ZCL_STA_SUCCESS
;

2308 
	}
}

2310 
_CODE_ZCL_
 
z˛Rï‹tCmd_t
 *
	$z˛_∑r£InRï‹tCmd
(
z˛Incomög_t
 *
pCmd
)

2312 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2313 
u8
 
numAâr
 = 0;

2314 
u8
 
d©aTy≥
;

2315 
u16
 
©åD©aLí
 = 0;

2316 
u16
 
d©aLí
 = 0;

2317 
z˛Rï‹t_t
 *
pRï‹tRec
 = 
NULL
;

2319 
pBuf
 < (
pCmd
->
pD©a
 +ÖCmd->
d©aLí
))

2321 
numAâr
++;

2322 
pBuf
 += 2;

2324 
d©aTy≥
 = *
pBuf
++;

2326 
©åD©aLí
 = 
	`z˛_gëAârSize
(
d©aTy≥
, 
pBuf
);

2327 
pBuf
 +
©åD©aLí
;

2329 
d©aLí
 +
©åD©aLí
;

2332 
u16
 
Àn
 = (
z˛Rï‹tCmd_t
Ë+ 
numAâr
 * (
z˛Rï‹t_t
);

2333 
z˛Rï‹tCmd_t
 *
p
 = (z˛Rï‹tCmd_à*)
	`ev_buf_Æloˇã
(
Àn
 + 
d©aLí
);

2334 i‡(
p
 !
NULL
)

2336 
pBuf
 = 
pCmd
->
pD©a
;

2337 
u8
 *
pD©a
 = (u8 *)((u8 *)
p
 + 
Àn
);

2339 
p
->
numAâr
 =ÇumAttr;

2340 
u8
 
i
 = 0; i < 
numAâr
; i++)

2342 
pRï‹tRec
 = &(
p
->
©åLi°
[
i
]);

2344 
pRï‹tRec
->
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2345 
pBuf
 += 2;

2346 
pRï‹tRec
->
d©aTy≥
 = *
pBuf
++;

2348 
©åD©aLí
 = 
	`z˛_gëAârSize
(
pRï‹tRec
->
d©aTy≥
, 
pBuf
);

2349 
	`mem˝y
(
pD©a
, 
pBuf
, 
©åD©aLí
);

2351 
pRï‹tRec
->
©åD©a
 = 
pD©a
;

2353 
pBuf
 +
©åD©aLí
;

2354 
pD©a
 +
©åD©aLí
;

2358  
p
;

2359 
	}
}

2361 
_CODE_ZCL_
 
°©us_t
 
	$z˛_ªp‹tH™dÀr
(
z˛Incomög_t
 *
pCmd
)

2363 
z˛Rï‹tCmd_t
 *
pRï‹tCmd
 = 
NULL
;

2366 
pRï‹tCmd
 = 
	`z˛_∑r£InRï‹tCmd
(
pCmd
);

2367 i‡(
pRï‹tCmd
 =
NULL
)

2369  
ZCL_STA_INSUFFICIENT_SPACE
;

2373 
pCmd
->
©åCmd
 = (*)
pRï‹tCmd
;

2376  
ZCL_STA_SUCCESS
;

2377 
	}
}

2384 
_CODE_ZCL_
 
°©us_t
 
	$z˛_£ndDÊtR•
(
z˛Incomög_t
 *
öMsg
, 
u8
 
cmdId
, u8 
°©us
)

2386 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_à*)
öMsg
->
msg
;

2387 
u8
 
§cEp
 = 
pApsdeInd
->
ödInfo
.
d°_ï
;

2388 
u8
 
buf
[2];

2390 
ïInfo_t
 
d°Ep
;

2391 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

2393 
u8
 
dú
 = 
öMsg
->
hdr
.
‰mCål
.
bf
.dir ? 0 : 1;

2395 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

2396 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

2397 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

2398 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

2399 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

2400 i‡(
öMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

2402 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

2405 
buf
[0] = 
cmdId
;

2406 
buf
[1] = 
°©us
;

2408  
	`z˛_£ndCmd
(
§cEp
, &
d°Ep
, 
pApsdeInd
->
ödInfo
.
˛u°î_id
, 
ZCL_CMD_DEFAULT_RSP
, 
FALSE
, 
dú
, 
TRUE
, 
öMsg
->
hdr
.
m™ufCode
, inMsg->hdr.
£qNum
, 2, 
buf
);

2409 
	}
}

2411 
_CODE_ZCL_
 
z˛DeÁu…R•Cmd_t
 *
	$z˛_∑r£InD·R•Cmd
(
z˛Incomög_t
 *
pCmd
)

2413 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2415 
z˛DeÁu…R•Cmd_t
 *
p
 = (z˛DeÁu…R•Cmd_à*)
	`ev_buf_Æloˇã
((zclDefaultRspCmd_t));

2416 i‡(
p
 !
NULL
)

2418 
p
->
comm™dID
 = *
pBuf
++;

2419 
p
->
°©usCode
 = *
pBuf
;

2422  
p
;

2423 
	}
}

2425 
_CODE_ZCL_
 
°©us_t
 
	$z˛_dÊtR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

2427 
z˛DeÁu…R•Cmd_t
 *
pDÊtR•Cmd
 = 
NULL
;

2429 i‡(!
pCmd
->
hdr
.
‰mCål
.
bf
.
disDefRe•
)

2431 
pCmd
->
hdr
.
‰mCål
.
bf
.
disDefRe•
 = 1;

2435 
pDÊtR•Cmd
 = 
	`z˛_∑r£InD·R•Cmd
(
pCmd
);

2436 i‡(
pDÊtR•Cmd
 =
NULL
)

2438  
ZCL_STA_INSUFFICIENT_SPACE
;

2442 
pCmd
->
©åCmd
 = (*)
pDÊtR•Cmd
;

2445  
ZCL_STA_SUCCESS
;

2446 
	}
}

2451 #ifde‡
ZCL_DISCOVER


2453 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârs
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârCmd_t
 *
discAârCmd
)

2455 
u8
 
buf
[3];

2457 
buf
[0] = 
	`LO_UINT16
(
discAârCmd
->
°¨tAâr
);

2458 
buf
[1] = 
	`HI_UINT16
(
discAârCmd
->
°¨tAâr
);

2459 
buf
[2] = 
discAârCmd
->
maxAârIDs
;

2461  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_DISCOVER_ATTR
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 3, 
buf
);

2462 
	}
}

2464 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârR•Cmd_t
 *
discAârR•Cmd
)

2466 
u16
 
Àn
 = 1;

2468 
Àn
 +
discAârR•Cmd
->
numAâr
 * (2 + 1);

2470 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

2471 i‡(!
buf
)

2473  
ZCL_STA_INSUFFICIENT_SPACE
;

2476 
u8
 *
pBuf
 = 
buf
;

2478 *
pBuf
++ = 
discAârR•Cmd
->
discCom∂ëe
;

2479 
u8
 
i
 = 0; i < 
discAârR•Cmd
->
numAâr
; i++)

2481 *
pBuf
++ = 
	`LO_UINT16
(
discAârR•Cmd
->
©åLi°
[
i
].
©åID
);

2482 *
pBuf
++ = 
	`HI_UINT16
(
discAârR•Cmd
->
©åLi°
[
i
].
©åID
);

2483 *
pBuf
++ = 
discAârR•Cmd
->
©åLi°
[
i
].
d©aTy≥
;

2486 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_DISCOVER_ATTR_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

2488 
	`ev_buf_‰ì
(
buf
);

2490  
°©us
;

2491 
	}
}

2493 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsExãnded
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârCmd_t
 *
discAârCmd
)

2495 
u8
 
buf
[3];

2497 
buf
[0] = 
	`LO_UINT16
(
discAârCmd
->
°¨tAâr
);

2498 
buf
[1] = 
	`HI_UINT16
(
discAârCmd
->
°¨tAâr
);

2499 
buf
[2] = 
discAârCmd
->
maxAârIDs
;

2501  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_DISCOVER_ATTR_EXTD
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 3, 
buf
);

2502 
	}
}

2504 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsExãndedR•
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârExtR•Cmd_t
 *
discAârExtR•Cmd
)

2506 
u16
 
Àn
 = 1;

2508 
Àn
 +
discAârExtR•Cmd
->
numAâr
 * (2 + 1 + 1);

2510 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

2511 i‡(!
buf
)

2513  
ZCL_STA_INSUFFICIENT_SPACE
;

2516 
u8
 *
pBuf
 = 
buf
;

2518 *
pBuf
++ = 
discAârExtR•Cmd
->
discCom∂ëe
;

2519 
u8
 
i
 = 0; i < 
discAârExtR•Cmd
->
numAâr
; i++)

2521 *
pBuf
++ = 
	`LO_UINT16
(
discAârExtR•Cmd
->
extAârInfo
[
i
].
©åID
);

2522 *
pBuf
++ = 
	`HI_UINT16
(
discAârExtR•Cmd
->
extAârInfo
[
i
].
©åID
);

2523 *
pBuf
++ = 
discAârExtR•Cmd
->
extAârInfo
[
i
].
d©aTy≥
;

2524 *
pBuf
++ = 
discAârExtR•Cmd
->
extAârInfo
[
i
].
ac˚ssC⁄åﬁ
;

2527 
u8
 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
˛u°îId
, 
ZCL_CMD_DISCOVER_ATTR_EXTD_RSP
, 
FALSE
, 
dúe˘i⁄
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

2529 
	`ev_buf_‰ì
(
buf
);

2531  
°©us
;

2532 
	}
}

2534 
_CODE_ZCL_
 
z˛DiscovîAârCmd_t
 *
	$z˛_∑r£InDiscAârsCmd
(
z˛Incomög_t
 *
pCmd
)

2536 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2538 
z˛DiscovîAârCmd_t
 *
p
 = (z˛DiscovîAârCmd_à*)
	`ev_buf_Æloˇã
((zclDiscoverAttrCmd_t));

2539 i‡(
p
 !
NULL
)

2541 
p
->
°¨tAâr
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2542 
pBuf
 += 2;

2543 
p
->
maxAârIDs
 = *
pBuf
;

2546  
p
;

2547 
	}
}

2549 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsH™dÀr
(
z˛Incomög_t
 *
pCmd
)

2551 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

2552 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

2553 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

2554 
u8
 
numAâr
 = 0;

2555 
boﬁ
 
°©us_disCom∂ëe
 = 
TRUE
;

2558 
z˛DiscovîAârCmd_t
 *
pDiscAârCmd
 = 
	`z˛_∑r£InDiscAârsCmd
(
pCmd
);

2559 i‡(
pDiscAârCmd
 =
NULL
)

2561  
ZCL_STA_INSUFFICIENT_SPACE
;

2565 
pCmd
->
©åCmd
 = (*)
pDiscAârCmd
;

2569 
˛u°îInfo_t
 *
pClu°î
 = 
NULL
;

2570 
z˛AârInfo_t
 *
pAârE¡ry
 = 
NULL
;

2572 
pClu°î
 = 
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
);

2573 i‡(
pClu°î
)

2575 
u8
 
i
 = 0; i < 
pClu°î
->
©åNum
; i++)

2577 i‡(
numAâr
 >
pDiscAârCmd
->
maxAârIDs
)

2582 
pAârE¡ry
 = (
z˛AârInfo_t
 *)&
pClu°î
->
©åTabÀ
[
i
];

2584 i‡(
pAârE¡ry
->
id
 >
pDiscAârCmd
->
°¨tAâr
)

2586 
numAâr
++;

2591 
u16
 
Àn
 = (
z˛DiscovîAârR•Cmd_t
Ë+ 
numAâr
 * (
z˛DiscovîAârInfo_t
);

2592 
z˛DiscovîAârR•Cmd_t
 *
pDiscAârR•Cmd
 = (z˛DiscovîAârR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2593 i‡(!
pDiscAârR•Cmd
)

2595  
ZCL_STA_INSUFFICIENT_SPACE
;

2598 i‡(
numAâr
 > 0)

2600 
u8
 
j
 = 0;

2601 
pClu°î
 = 
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
);

2602 i‡(
pClu°î
)

2604 
u8
 
i
 = 0; i < 
pClu°î
->
©åNum
; i++)

2606 
pAârE¡ry
 = (
z˛AârInfo_t
 *)&
pClu°î
->
©åTabÀ
[
i
];

2608 i‡(
pAârE¡ry
->
id
 >
pDiscAârCmd
->
°¨tAâr
)

2610 i‡(
j
 >
numAâr
)

2612 
°©us_disCom∂ëe
 = 
FALSE
;

2615 
pDiscAârR•Cmd
->
©åLi°
[
j
].
©åID
 = 
pAârE¡ry
->
id
;

2616 
pDiscAârR•Cmd
->
©åLi°
[
j
++].
d©aTy≥
 = 
pAârE¡ry
->
ty≥
;

2621 
pDiscAârR•Cmd
->
discCom∂ëe
 = 
°©us_disCom∂ëe
;

2622 
pDiscAârR•Cmd
->
numAâr
 =ÇumAttr;

2624 
ïInfo_t
 
d°Ep
;

2625 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

2627 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

2628 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

2629 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

2630 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

2631 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

2633 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

2636 
°©us
 = 
	`z˛_discAârsR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pDiscAârR•Cmd
);

2638 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2639 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

2641 
	`ev_buf_‰ì
((*)
pDiscAârR•Cmd
);

2643  
°©us
;

2644 
	}
}

2646 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsExãndedH™dÀr
(
z˛Incomög_t
 *
pCmd
)

2648 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

2649 
u16
 
˛u°îId
 = 
pCmd
->
msg
->
ödInfo
.
˛u°î_id
;

2650 
u8
 
ídpoöt
 = 
pCmd
->
msg
->
ödInfo
.
d°_ï
;

2651 
u8
 
numAâr
 = 0;

2652 
boﬁ
 
°©us_discCom∂ëe
 = 
TRUE
;

2655 
z˛DiscovîAârCmd_t
 *
pDiscAârCmd
 = 
	`z˛_∑r£InDiscAârsCmd
(
pCmd
);

2656 i‡(
pDiscAârCmd
 =
NULL
)

2658  
ZCL_STA_INSUFFICIENT_SPACE
;

2662 
pCmd
->
©åCmd
 = (*)
pDiscAârCmd
;

2666 
˛u°îInfo_t
 *
pClu°î
 = 
NULL
;

2667 
z˛AârInfo_t
 *
pAârE¡ry
 = 
NULL
;

2669 
pClu°î
 = 
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
);

2670 i‡(
pClu°î
)

2672 
u8
 
i
 = 0; i < 
pClu°î
->
©åNum
; i++)

2674 i‡(
numAâr
 >
pDiscAârCmd
->
maxAârIDs
)

2679 
pAârE¡ry
 = (
z˛AârInfo_t
 *)&
pClu°î
->
©åTabÀ
[
i
];

2681 i‡(
pAârE¡ry
->
id
 >
pDiscAârCmd
->
°¨tAâr
)

2683 
numAâr
++;

2688 
u16
 
Àn
 = (
z˛DiscovîAârExtR•Cmd_t
Ë+ 
numAâr
 * (
z˛ExtAârInfo_t
);

2689 
z˛DiscovîAârExtR•Cmd_t
 *
pDiscAârExtR•Cmd
 = (z˛DiscovîAârExtR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2690 i‡(!
pDiscAârExtR•Cmd
)

2692  
ZCL_STA_INSUFFICIENT_SPACE
;

2695 i‡(
numAâr
 > 0)

2697 
u8
 
j
 = 0;

2698 
pClu°î
 = 
	`z˛_födClu°î
(
ídpoöt
, 
˛u°îId
);

2699 i‡(
pClu°î
)

2701 
u8
 
i
 = 0; i < 
pClu°î
->
©åNum
; i++)

2703 
pAârE¡ry
 = (
z˛AârInfo_t
 *)&
pClu°î
->
©åTabÀ
[
i
];

2705 i‡(
pAârE¡ry
->
id
 >
pDiscAârCmd
->
°¨tAâr
)

2707 i‡(
j
 >
numAâr
)

2709 
°©us_discCom∂ëe
 = 
FALSE
;

2712 
pDiscAârExtR•Cmd
->
extAârInfo
[
j
].
©åID
 = 
pAârE¡ry
->
id
;

2713 
pDiscAârExtR•Cmd
->
extAârInfo
[
j
].
d©aTy≥
 = 
pAârE¡ry
->
ty≥
;

2714 
pDiscAârExtR•Cmd
->
extAârInfo
[
j
++].
ac˚ssC⁄åﬁ
 = 
pAârE¡ry
->
ac˚ss
 & 
ACCESS_CONTROL_EXT_MASK
;

2719 
pDiscAârExtR•Cmd
->
discCom∂ëe
 = 
°©us_discCom∂ëe
;

2720 
pDiscAârExtR•Cmd
->
numAâr
 =ÇumAttr;

2722 
ïInfo_t
 
d°Ep
;

2723 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

2725 
d°Ep
.d°E∞
pCmd
->
msg
->
ödInfo
.
§c_ï
;

2726 
d°Ep
.
¥ofûeId
 = 
pCmd
->
msg
->
ödInfo
.
¥ofûe_id
;

2727 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

2728 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pCmd
->
msg
->
ödInfo
.
§c_sh‹t_addr
;

2729 i‡(
pCmd
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)

2731 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

2734 
°©us
 = 
	`z˛_discAârsExãndedR•
(
ídpoöt
, &
d°Ep
, 
˛u°îId
, 
pCmd
->
hdr
.
m™ufCode
, 
TRUE
, !pCmd->hdr.
‰mCål
.
bf
.
dú
,ÖCmd->hdr.
£qNum
, 
pDiscAârExtR•Cmd
);

2736 i‡(
°©us
 =
ZCL_STA_SUCCESS
)

2737 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

2739 
	`ev_buf_‰ì
((*)
pDiscAârExtR•Cmd
);

2741  
°©us
;

2742 
	}
}

2744 
_CODE_ZCL_
 
z˛DiscovîAârR•Cmd_t
 *
	$z˛_∑r£InDiscAârsR•Cmd
(
z˛Incomög_t
 *
pCmd
)

2746 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2747 
u8
 
numAâr
 = (
pCmd
->
d©aLí
 - 1 ) / (2 + 1);

2749 
u16
 
Àn
 = (
z˛DiscovîAârR•Cmd_t
Ë+ 
numAâr
 * (
z˛DiscovîAârInfo_t
);

2750 
z˛DiscovîAârR•Cmd_t
 *
p
 = (z˛DiscovîAârR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2751 i‡(
p
 !
NULL
)

2753 
p
->
discCom∂ëe
 = *
pBuf
++;

2754 
p
->
numAâr
 =ÇumAttr;

2755 
u8
 
i
 = 0; i < 
numAâr
; i++)

2757 
p
->
©åLi°
[
i
].
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2758 
pBuf
 += 2;

2759 
p
->
©åLi°
[
i
].
d©aTy≥
 = *
pBuf
++;

2763  
p
;

2764 
	}
}

2766 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

2768 
z˛DiscovîAârR•Cmd_t
 *
pDiscAârR•Cmd
 = 
NULL
;

2771 
pDiscAârR•Cmd
 = 
	`z˛_∑r£InDiscAârsR•Cmd
(
pCmd
);

2772 i‡(
pDiscAârR•Cmd
 =
NULL
)

2774  
ZCL_STA_INSUFFICIENT_SPACE
;

2778 
pCmd
->
©åCmd
 = (*)
pDiscAârR•Cmd
;

2781  
ZCL_STA_SUCCESS
;

2782 
	}
}

2784 
_CODE_ZCL_
 
z˛DiscovîCmdsCmd_t
 *
	$z˛_∑r£InDiscCmdsCmd
(
z˛Incomög_t
 *
pCmd
)

2786 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2788 
z˛DiscovîCmdsCmd_t
 *
p
 = (z˛DiscovîCmdsCmd_à*)
	`ev_buf_Æloˇã
((zclDiscoverCmdsCmd_t));

2789 i‡(
p
 !
NULL
)

2791 
p
->
°¨tCmdID
 = *
pBuf
++;

2792 
p
->
maxCmdID
 = *
pBuf
++;

2795  
p
;

2796 
	}
}

2798 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discCmdsH™dÀr
(
z˛Incomög_t
 *
pCmd
)

2801  
ZCL_STA_SUCCESS
;

2802 
	}
}

2804 
_CODE_ZCL_
 
z˛DiscovîAârExtR•Cmd_t
 *
	$z˛_∑r£InDiscAârsExtR•Cmd
(
z˛Incomög_t
 *
pCmd
)

2806 
u8
 *
pBuf
 = 
pCmd
->
pD©a
;

2807 
u8
 
numAâr
 = (
pCmd
->
d©aLí
 - 1 ) / (2 + 1 + 1);

2809 
u16
 
Àn
 = (
z˛DiscovîAârExtR•Cmd_t
Ë+ 
numAâr
 * (
z˛ExtAârInfo_t
);

2810 
z˛DiscovîAârExtR•Cmd_t
 *
p
 = (z˛DiscovîAârExtR•Cmd_à*)
	`ev_buf_Æloˇã
(
Àn
);

2811 i‡(
p
 !
NULL
)

2813 
p
->
discCom∂ëe
 = *
pBuf
++;

2814 
p
->
numAâr
 =ÇumAttr;

2815 
u8
 
i
 = 0; i < 
numAâr
; i++)

2817 
p
->
extAârInfo
[
i
].
©åID
 = 
	`BUILD_U16
(
pBuf
[0],ÖBuf[1]);

2818 
pBuf
 += 2;

2819 
p
->
extAârInfo
[
i
].
d©aTy≥
 = *
pBuf
++;

2820 
p
->
extAârInfo
[
i
].
ac˚ssC⁄åﬁ
 = *
pBuf
++;

2824  
p
;

2825 
	}
}

2827 
_CODE_ZCL_
 
°©us_t
 
	$z˛_discAârsExtR•H™dÀr
(
z˛Incomög_t
 *
pCmd
)

2829 
z˛DiscovîAârExtR•Cmd_t
 *
pDiscAârExtR•Cmd
 = 
NULL
;

2832 
pDiscAârExtR•Cmd
 = 
	`z˛_∑r£InDiscAârsExtR•Cmd
(
pCmd
);

2833 i‡(
pDiscAârExtR•Cmd
 =
NULL
)

2835  
ZCL_STA_INSUFFICIENT_SPACE
;

2839 
pCmd
->
©åCmd
 = (*)
pDiscAârExtR•Cmd
;

2842  
ZCL_STA_SUCCESS
;

2843 
	}
}

	@zigbee/zcl/zcl.h

24 #i‚de‡
ZCL_H


25 
	#ZCL_H


	)

41 
	#MANUFACTURER_CODE_NONE
 0x0000

	)

42 
	#MANUFACTURER_CODE_AMAZON
 0x1217

	)

46 
	#ZCL_ATTR_GLOBAL_CLUSTER_REVISION_DEFAULT
 0x0001

	)

53 
	#ZCL_CMD_READ
 0x00

	)

54 
	#ZCL_CMD_READ_RSP
 0x01

	)

55 
	#ZCL_CMD_WRITE
 0x02

	)

56 
	#ZCL_CMD_WRITE_UNDIVIDED
 0x03

	)

57 
	#ZCL_CMD_WRITE_RSP
 0x04

	)

58 
	#ZCL_CMD_WRITE_NO_RSP
 0x05

	)

59 
	#ZCL_CMD_CONFIG_REPORT
 0x06

	)

60 
	#ZCL_CMD_CONFIG_REPORT_RSP
 0x07

	)

61 
	#ZCL_CMD_READ_REPORT_CFG
 0x08

	)

62 
	#ZCL_CMD_READ_REPORT_CFG_RSP
 0x09

	)

63 
	#ZCL_CMD_REPORT
 0x0a

	)

64 
	#ZCL_CMD_DEFAULT_RSP
 0x0b

	)

65 
	#ZCL_CMD_DISCOVER_ATTR
 0x0c

	)

66 
	#ZCL_CMD_DISCOVER_ATTR_RSP
 0x0d

	)

67 
	#ZCL_CMD_READ_STRUCTURED
 0x0e

	)

68 
	#ZCL_CMD_WRITE_STRUCTURED
 0x0f

	)

69 
	#ZCL_CMD_WRITE_STRUCTURED_RSP
 0x10

	)

70 
	#ZCL_CMD_DISCOVER_CMDS_RCVD
 0x11

	)

71 
	#ZCL_CMD_DISCOVER_CMDS_RCVD_RSP
 0x12

	)

72 
	#ZCL_CMD_DISCOVER_CMDS_GEN
 0x13

	)

73 
	#ZCL_CMD_DISCOVER_CMDS_GEN_RSP
 0x14

	)

74 
	#ZCL_CMD_DISCOVER_ATTR_EXTD
 0x15

	)

75 
	#ZCL_CMD_DISCOVER_ATTR_EXTD_RSP
 0x16

	)

76 
	#ZCL_CMD_MAX
 
ZCL_CMD_DISCOVER_ATTR_EXTD_RSP


	)

83 
	#ZCL_FRAME_CONTROL_TYPE
 0x03

	)

84 
	#ZCL_FRAME_CONTROL_MANU_SPECIFIC
 0x04

	)

85 
	#ZCL_FRAME_CONTROL_DIRECTION
 0x08

	)

86 
	#ZCL_FRAME_CONTROL_DISABLE_DEFAULT_RSP
 0x10

	)

94 
	#ZCL_FRAME_TYPE_PROFILE_CMD
 0x00

	)

95 
	#ZCL_FRAME_TYPE_SPECIFIC_CMD
 0x01

	)

102 
	#ZCL_FRAME_CLIENT_SERVER_DIR
 0x00

	)

103 
	#ZCL_FRAME_SERVER_CLIENT_DIR
 0x01

	)

112 
	#DFLT_APS_TX_OPTIONS
 0x00

	)

113 
	#DFLT_APS_RADIUS
 0xf

	)

120 
	#UNICAST_MSG
(
msg
Ë–((msg)->
ödInfo
.
d°_addr
 < 
NWK_BROADCAST_ROUTER_COORDINATOR
Ë&& (((msg)->ödInfo.
d°_addr_mode
Ë!
APS_SHORT_GROUPADDR_NOEP
Ë)

	)

129 
	sz˛AârInfo


131 
u16
 
	mid
;

132 
u8
 
	mty≥
;

133 
u8
 
	mac˚ss
;

134 
u8
 *
	md©a
;

135 } 
	tz˛AârInfo_t
;

140 
	uz˛FrmCål


143 
u8
 
	mty≥
:2;

144 
u8
 
	mm™ufS≥c
:1;

145 
u8
 
	mdú
:1;

146 
u8
 
	mdisDefRe•
:1;

147 
u8
 
	mª£rved
:3;

148 } 
	mbf
;

149 
u8
 
	mbyã
;

150 } 
	tz˛FrmCål_t
;

155 
	sz˛Hdr


157 
z˛FrmCål_t
 
	m‰mCål
;

158 
u16
 
	mm™ufCode
;

159 
u8
 
	m£qNum
;

160 
u8
 
	mcmd
;

161 } 
	tz˛Hdr_t
;

168 
u8
 
	mnumAâr
;

169 
u16
 
	m©åID
[];

170 } 
	tz˛RódCmd_t
;

177 
u16
 
	m©åID
;

178 
u8
 
	m°©us
;

179 
u8
 
	md©aTy≥
;

180 
u8
 *
	md©a
;

182 } 
	tz˛RódR•Sètus_t
;

189 
u8
 
	mnumAâr
;

190 
z˛RódR•Sètus_t
 
	m©åLi°
[];

191 } 
	tz˛RódR•Cmd_t
;

198 
u16
 
	m©åID
;

199 
u8
 
	md©aTy≥
;

200 
u8
 *
	m©åD©a
;

201 } 
	tz˛WrôeRec_t
;

208 
u8
 
	mnumAâr
;

209 
z˛WrôeRec_t
 
	m©åLi°
[];

210 } 
	tz˛WrôeCmd_t
;

217 
u8
 
	m°©us
;

218 
u16
 
	m©åID
;

219 } 
	tz˛WrôeR•Sètus_t
;

226 
u8
 
	mnumAâr
;

227 
z˛WrôeR•Sètus_t
 
	m©åLi°
[];

228 } 
	tz˛WrôeR•Cmd_t
;

235 
u8
 
	mdúe˘i⁄
;

236 
u16
 
	m©åID
;

237 
u8
 
	md©aTy≥
;

238 
u16
 
	mmöRï‹tI¡
;

239 
u16
 
	mmaxRï‹tI¡
;

240 
u16
 
	mtimeoutPîiod
;

241 
u8
 *
	mªp‹èbÀCh™ge
;

242 } 
	tz˛CfgRï‹tRec_t
;

249 
u8
 
	mnumAâr
;

250 
z˛CfgRï‹tRec_t
 
	m©åLi°
[];

251 } 
	tz˛CfgRï‹tCmd_t
;

258 
u8
 
	m°©us
;

259 
u8
 
	mdúe˘i⁄
;

260 
u16
 
	m©åID
;

261 } 
	tz˛CfgRï‹tSètus_t
;

268 
u8
 
	mnumAâr
;

269 
z˛CfgRï‹tSètus_t
 
	m©åLi°
[];

270 } 
	tz˛CfgRï‹tR•Cmd_t
;

277 
u8
 
	mdúe˘i⁄
;

278 
u16
 
	m©åID
;

279 } 
	tz˛RódRï‹tCfgRec_t
;

286 
u8
 
	mnumAâr
;

287 
z˛RódRï‹tCfgRec_t
 
	m©åLi°
[];

288 } 
	tz˛RódRï‹tCfgCmd_t
;

295 
u8
 
	m°©us
;

296 
u8
 
	mdúe˘i⁄
;

297 
u16
 
	m©åID
;

298 
u8
 
	md©aTy≥
;

299 
u16
 
	mmöRï‹tI¡
;

300 
u16
 
	mmaxRï‹tI¡
;

301 
u16
 
	mtimeoutPîiod
;

302 
u8
 *
	mªp‹èbÀCh™ge
;

303 } 
	tz˛Rï‹tCfgR•Rec_t
;

310 
u8
 
	mnumAâr
;

311 
z˛Rï‹tCfgR•Rec_t
 
	m©åLi°
[];

312 } 
	tz˛RódRï‹tCfgR•Cmd_t
;

319 
u16
 
	m©åID
;

320 
u8
 
	md©aTy≥
;

321 
u8
 *
	m©åD©a
;

322 } 
	tz˛Rï‹t_t
;

329 
u8
 
	mnumAâr
;

330 
z˛Rï‹t_t
 
	m©åLi°
[];

331 } 
	tz˛Rï‹tCmd_t
;

338 
u8
 
	mcomm™dID
;

339 
u8
 
	m°©usCode
;

340 } 
	tz˛DeÁu…R•Cmd_t
;

347 
u16
 
	m°¨tAâr
;

348 
u8
 
	mmaxAârIDs
;

349 } 
	tz˛DiscovîAârCmd_t
;

356 
u16
 
	m©åID
;

357 
u8
 
	md©aTy≥
;

358 } 
	tz˛DiscovîAârInfo_t
;

366 
u8
 
	mdiscCom∂ëe
;

367 
u8
 
	mnumAâr
;

368 
z˛DiscovîAârInfo_t
 
	m©åLi°
[];

369 } 
	tz˛DiscovîAârR•Cmd_t
;

376 
u8
 *
	mpSå
;

377 
u8
 
	m°rLí
;

378 } 
	tUTF8Såög_t
;

385 
u8
 
	m°¨tCmdID
;

386 
u8
 
	mmaxCmdID
;

387 } 
	tz˛DiscovîCmdsCmd_t
;

394 
u8
 
	mdiscCom∂ëe
;

395 
u8
 
	mcmdTy≥
;

396 
u8
 
	mnumCmd
;

397 
u8
 *
	mpCmdID
;

398 } 
	tz˛DiscovîCmdsR•Cmd_t
;

405 
u16
 
	m©åID
;

406 
u8
 
	md©aTy≥
;

407 
u8
 
	mac˚ssC⁄åﬁ
;

408 } 
	tz˛ExtAârInfo_t
;

415 
u8
 
	mdiscCom∂ëe
;

416 
u8
 
	mnumAâr
;

417 
z˛ExtAârInfo_t
 
	mextAârInfo
[];

418 } 
	tz˛DiscovîAârExtR•Cmd_t
;

421 
	#REPORTABLE_CHANGE_MAX_ANALOG_SIZE
 8

	)

430 
u16
 
	m¥ofûeID
;

431 
u16
 
	m˛u°îID
;

432 
u16
 
	m©åID
;

433 
u16
 
	mmöI¡D·
;

434 
u16
 
	mmaxI¡D·
;

435 
u16
 
	mmöI¡îvÆ
;

436 
u16
 
	mmaxI¡îvÆ
;

437 
u16
 
	mmöI¡C¡
;

438 
u16
 
	mmaxI¡C¡
;

439 
u8
 
	mídPoöt
;

440 
u8
 
	md©aTy≥
;

441 
u8
 
	mªp‹èbÀCh™ge
[
REPORTABLE_CHANGE_MAX_ANALOG_SIZE
];

442 
u8
 
	m¥evD©a
[
REPORTABLE_CHANGE_MAX_ANALOG_SIZE
];

443 
u8
 
	mu£d
;

444 } 
	tªp‹tCfgInfo_t
;

450 
u8
 
	mªp‹tNum
;

451 
ªp‹tCfgInfo_t
 
	mªp‹tCfgInfo
[
ZCL_REPORTING_TABLE_NUM
];

452 } 
	tz˛_ªp‹tögTab_t
;

454 
z˛_ªp‹tögTab_t
 
ªp‹tögTab
;

460 
u16
 
	m¥ofûeId
;

461 
u16
 
	m§cAddr
;

462 
u16
 
	md°Addr
;

463 
u8
 
	m§cEp
;

464 
u8
 
	md°Ep
;

465 
u8
 
	m£qNum
;

466 
u8
 
	mdúClu°î
:1;

467 
u8
 
	m≠sSec
:1;

468 
u8
 
	mª£rved
:6;

469 } 
	tz˛IncomögAddrInfo_t
;

474 
	$°©us_t
 (*
	t˛u°î_f‹AµCb_t
)(
	tz˛IncomögAddrInfo_t
 *
	tpAddrInfo
, 
	tu8
 
	tcmdId
, *
	tcmdPaylﬂd
);

481 
˛u°î_f‹AµCb_t
 
˛u°îAµCb
;

482 
≠sdeD©aInd_t
 *
msg
;

483 
u8
 *
pD©a
;

484 *
©åCmd
;

485 
u16
 
d©aLí
;

486 
z˛IncomögAddrInfo_t
 
addrInfo
;

487 
z˛Hdr_t
 
hdr
;

488 } 
	tz˛Incomög_t
;

493 
	$°©us_t
 (*
	t˛u°î_cmdHdÃ_t
)(
	tz˛Incomög_t
 *
	tpInHdÃMsg
);

499 
	$°©us_t
 (*
	t˛u°î_ªgi°îFunc_t
)(
	tu8
 
	tídpoöt
, 
	tu16
 
	tm™uCode
, u8 
	t©åNum
, c⁄° 
	tz˛AârInfo_t
 
	t©åTbl
[], 
	t˛u°î_f‹AµCb_t
 
	tcb
);

504 (*
	tz˛_hookFn_t
)(
	tz˛Incomög_t
 *
	tpInHdÃMsg
);

511 c⁄° 
z˛AârInfo_t
 *
©åTabÀ
;

512 
˛u°î_cmdHdÃ_t
 
cmdH™dÀrFunc
;

513 
˛u°î_f‹AµCb_t
 
˛u°îAµCb
;

514 
u16
 
˛u°îID
;

515 
u16
 
m™uCode
;

516 
u8
 
ídpoöt
;

517 
u8
 
©åNum
;

518 } 
	t˛u°îInfo_t
;

521 
u16
 
˛u°îId
;

522 
u16
 
m™uCode
;

523 
u16
 
©åNum
;

524 c⁄° 
z˛AârInfo_t
 *
©åTbl
;

525 
˛u°î_ªgi°îFunc_t
 
˛u°îRegi°îFunc
;

526 
˛u°î_f‹AµCb_t
 
˛u°îAµCb
;

527 } 
	tz˛_•ecClu°îInfo_t
;

530 #i‚de‡
ZCL_CLUSTER_NUM_MAX


531 
	#ZCL_CLUSTER_NUM_MAX
 8

	)

535 
z˛_hookFn_t
 
hookFn
;

536 
u16
 
ª£rved
;

537 
u8
 
curSèã
;

538 
u8
 
˛u°îNum
;

539 
˛u°îInfo_t
 
˛u°îLi°
[
ZCL_CLUSTER_NUM_MAX
];

540 } 
	tz˛_˘æ_t
;

546 
u8
 
z˛_£qNum
;

547 
	#ZCL_SEQ_NUM
 (
z˛_£qNum
++)

	)

549 c⁄° 
u16
 
z˛_©å_globÆ_˛u°îRevisi⁄
;

563 
	`z˛_ª£t
();

572 
	`z˛_öô
(
z˛_hookFn_t
 
‚
);

586 
	`z˛_ªgi°î
(
u8
 
ídpoöt
, u8 
˛u°îNum
, 
z˛_•ecClu°îInfo_t
 *
öfo
);

597 
˛u°îInfo_t
 *
	`z˛_födClu°î
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
);

611 
°©us_t
 
	`z˛_ªgi°îClu°î
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 *
pAârTbl
, 
˛u°î_cmdHdÃ_t
 
cmdHdÃFn
, 
˛u°î_f‹AµCb_t
 
cb
);

630 
°©us_t
 
	`z˛_£ndCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u8 
cmd
, u8 
•ecific
,

631 
u8
 
dúe˘i⁄
, u8 
dißbÀDeÁu…R•
, 
u16
 
m™uCode
, u8 
£qNo
, u16 
cmdPldLí
, u8 *
cmdPld
);

634 
°©us_t
 
	`z˛_£ndI¡îPANCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u8 
cmd
, u8 
•ecific
,

635 
u8
 
dúe˘i⁄
, u8 
dißbÀDeÁu…R•
, 
u16
 
m™uCode
, u8 
£qNo
, u16 
cmdPldLí
, u8 *
cmdPld
);

644 
	`z˛_rx_h™dÀr
(*
pD©a
);

653 
boﬁ
 
	`z˛_™ÆogD©aTy≥
(
u8
 
d©aTy≥
);

662 
u8
 
	`z˛_gëD©aTy≥Lí
(u8 
d©aTy≥
);

672 
u16
 
	`z˛_gëAârSize
(
u8
 
d©aTy≥
, u8 *
pD©a
);

685 
°©us_t
 
	`z˛_gëAârVÆ
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
, u16 *
Àn
, u8 *
vÆ
);

697 
°©us_t
 
	`z˛_£tAârVÆ
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
, u8 *
vÆ
);

708 
z˛AârInfo_t
 *
	`z˛_födAâribuã
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åId
);

717 #ifde‡
ZCL_READ


732 
°©us_t
 
	`z˛_ªad
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódCmd_t
 *
ªadCmd
);

733 
	#z˛_£ndRódCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_ªad
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

734 
	#z˛_£ndRódWôhMfgCodeCmd
(
a
,
b
,
c
,
d
,
e
,
f
,
g
Ë(
	`z˛_ªad
(◊), (b), (c), (d), (e), (f), 
ZCL_SEQ_NUM
, (g)))

	)

738 #ifde‡
ZCL_WRITE


754 
°©us_t
 
	`z˛_wrôeReq
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
cmd
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛WrôeCmd_t
 *
wrôeCmd
);

755 
	#z˛_£ndWrôeCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_wrôeReq
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, 
ZCL_CMD_WRITE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

756 
	#z˛_£ndWrôeWôhMfgCodeCmd
(
a
,
b
,
c
,
d
,
e
,
f
,
g
Ë(
	`z˛_wrôeReq
(◊), (b), (c), (d), 
ZCL_CMD_WRITE
, (e), (f), 
ZCL_SEQ_NUM
, (g)))

	)

757 
	#z˛_£ndWrôeUndividedCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_wrôeReq
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, 
ZCL_CMD_WRITE_UNDIVIDED
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

758 
	#z˛_£ndWrôeNoR•Cmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_wrôeReq
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, 
ZCL_CMD_WRITE_NO_RSP
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

762 #ifde‡
ZCL_REPORT


777 
°©us_t
 
	`z˛_c⁄figRï‹t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛CfgRï‹tCmd_t
 *
cfgRï‹tCmd
);

778 
	#z˛_£ndCfgRï‹tCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_c⁄figRï‹t
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

780 
°©us_t
 
	`z˛_ªadRï‹tC⁄fig
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛RódRï‹tCfgCmd_t
 *
ªadRï‹tCfgCmd
);

781 
	#z˛_£ndRódRï‹tCfgCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_ªadRï‹tC⁄fig
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

783 
°©us_t
 
	`z˛_ªp‹t
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
u16
 
m™uCode
, u16 
˛u°îId
, u16 
©åID
, u8 
d©aTy≥
, u8 *
pD©a
);

784 
	#z˛_£ndRï‹tCmd
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
Ë(
	`z˛_ªp‹t
(◊), (b), (c), (d), 
ZCL_SEQ_NUM
, 
MANUFACTURER_CODE_NONE
, (e), (f), (g), (h)))

	)

787 
	`z˛_ªp‹tögTabInô
();

788 
u8
 
	`z˛_ªp‹tögE¡ryA˘iveNumGë
();

789 
ªp‹tCfgInfo_t
 *
	`z˛_ªp‹tCfgInfoE¡ryFöd
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åID
);

790 
ªp‹tCfgInfo_t
 *
	`z˛_ªp‹tCfgInfoE¡ryFªeGë
();

791 
	`z˛_ªp‹tCfgInfoE¡ryCÀ¨
(
ªp‹tCfgInfo_t
 *
pE¡ry
);

792 
	`z˛_ªp‹tCfgInfoE¡ryR°
(
ªp‹tCfgInfo_t
 *
pE¡ry
);

793 
	`z˛_ªp‹tCfgInfoE¡ryUpd©e
(
ªp‹tCfgInfo_t
 *
pE¡ry
, 
u8
 
ídPoöt
, 
u16
 
¥ofûeId
, u16 
˛u°îId
, 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
);

794 
°©us_t
 
	`z˛_c⁄figuªRï‹tög
(
u8
 
ídpoöt
, 
u16
 
¥ofûeId
, u16 
˛u°îId
, 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
);

797 
boﬁ
 
	`ªp‹èbÀCh™geVÆueChk
(
u8
 
d©aTy≥
, u8 *
curVÆue
, u8 *
¥evVÆue
, u8 *
ªp‹èbÀCh™ge
);

798 
	`ªp‹tNoMöLimô
();

799 
	`ªp‹tAârTimîSèπ
(
u16
 
£c⁄ds
);

800 
	`ªp‹tAârTimîSt›
();

804 #ifde‡
ZCL_DISCOVER


819 
°©us_t
 
	`z˛_discAârs
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârCmd_t
 *
discAârCmd
);

820 
	#z˛_£ndDiscAârsCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_discAârs
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

822 
°©us_t
 
	`z˛_discAârsExãnded
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
˛u°îId
, u16 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
dúe˘i⁄
, u8 
£qNo
, 
z˛DiscovîAârCmd_t
 *
discAârCmd
);

823 
	#z˛_£ndDiscAârsExãndedCmd
(
a
,
b
,
c
,
d
,
e
,
f
Ë(
	`z˛_discAârsExãnded
(◊), (b), (c), 
MANUFACTURER_CODE_NONE
, (d), (e), 
ZCL_SEQ_NUM
, (f)))

	)

	@zigbee/zcl/zcl_config.h

24 #i‚de‡
ZCL_CONFIG_H


25 
	#ZCL_CONFIG_H


	)

28 
	~"é_comm⁄.h
"

31 
	#ZCL_READ


	)

32 
	#ZCL_WRITE


	)

33 
	#ZCL_REPORT


	)

34 
	#ZCL_DISCOVER


	)

39 
	#ZCL_BASIC


	)

42 #i‡
ZCL_POWER_CFG_SUPPORT


43 
	#ZCL_POWER_CFG


	)

47 #i‡
ZCL_DEV_TEMPERATURE_CFG_SUPPORT


48 
	#ZCL_DEV_TEMPERATURE_CFG


	)

52 
	#ZCL_IDENTIFY


	)

55 #i‡
ZCL_GROUP_SUPPORT


56 
	#ZCL_GROUP


	)

60 #i‡
ZCL_SCENE_SUPPORT


61 
	#ZCL_SCENE


	)

65 #i‡
ZCL_ON_OFF_SUPPORT


66 
	#ZCL_ON_OFF


	)

70 #i‡
ZCL_ON_OFF_SWITCH_CFG_SUPPORT


71 
	#ZCL_ON_OFF_SWITCH_CFG


	)

75 #i‡
ZCL_LEVEL_CTRL_SUPPORT


76 
	#ZCL_LEVEL_CTRL


	)

80 #i‡
ZCL_ALARMS_SUPPORT


81 
	#ZCL_ALARMS


	)

85 #i‡
ZCL_TIME_SUPPORT


86 
	#ZCL_TIME


	)

90 #i‡
ZCL_RSSI_LOCATION_SUPPORT


91 
	#ZCL_RSSI_LOCATION


	)

95 #i‡
ZCL_DIAGNOSTICS_SUPPORT


96 
	#ZCL_DIAGNOSTICS


	)

100 #i‡
ZCL_POLL_CTRL_SUPPORT


101 
	#ZCL_POLL_CTRL


	)

105 #i‡
GP_SUPPORT_ENABLE


106 
	#ZCL_GREEN_POWER


	)

110 #i‡
ZCL_BINARY_INPUT_SUPPORT


111 
	#ZCL_BINARY_INPUT


	)

115 #i‡
ZCL_BINARY_OUTPUT_SUPPORT


116 
	#ZCL_BINARY_OUTPUT


	)

120 #i‡
ZCL_MULITSTATE_INPUT_SUPPORT


121 
	#ZCL_MULITSTATE_INPUT


	)

125 #i‡
ZCL_MULITSTATE_OUTPUT_SUPPORT


126 
	#ZCL_MULITSTATE_OUTPUT


	)

131 #i‡
ZCL_ILLUMINANCE_MEASUREMENT_SUPPORT


132 
	#ZCL_ILLUMINANCE_MEASUREMENT


	)

136 #i‡
ZCL_ILLUMINANCE_LEVEL_SENSING_SUPPORT


137 
	#ZCL_ILLUMINANCE_LEVEL_SENSING


	)

141 #i‡
ZCL_TEMPERATURE_MEASUREMENT_SUPPORT


142 
	#ZCL_TEMPERATURE_MEASUREMENT


	)

146 #i‡
ZCL_OCCUPANCY_SENSING_SUPPORT


147 
	#ZCL_OCCUPANCY_SENSING


	)

151 #i‡
ZCL_ELECTRICAL_MEASUREMENT_SUPPORT


152 
	#ZCL_ELECTRICAL_MEASUREMENT


	)

158 #i‡
ZCL_LIGHT_COLOR_CONTROL_SUPPORT


159 
	#ZCL_LIGHT_COLOR_CONTROL


	)

168 #i‡
ZCL_THERMOSTAT_SUPPORT


169 
	#ZCL_THERMOSTAT


	)

174 #i‡
ZCL_DOOR_LOCK_SUPPORT


175 
	#ZCL_DOOR_LOCK


	)

179 #i‡
ZCL_WINDOW_COVERING_SUPPORT


180 
	#ZCL_WINDOW_COVERING


	)

186 #i‡
ZCL_IAS_ZONE_SUPPORT


187 
	#ZCL_IAS_ZONE


	)

191 #i‡
ZCL_IAS_ACE_SUPPORT


192 
	#ZCL_IAS_ACE


	)

196 #i‡
ZCL_IAS_WD_SUPPORT


197 
	#ZCL_IAS_WD


	)

203 #i‡
ZCL_METERING_SUPPORT


204 
	#ZCL_METERING


	)

211 #i‡
ZCL_OTA_SUPPORT


212 
	#ZCL_OTA


	)

221 #i‡
ZCL_ZLL_COMMISSIONING_SUPPORT


222 
	#ZCL_ZLL_COMMISSIONING


	)

228 #i‡
ZCL_WWAH_SUPPORT


229 
	#ZCL_WWAH


	)

	@zigbee/zcl/zcl_const.h

24 #i‚de‡
ZCL_CONST_H


25 
	#ZCL_CONST_H


	)

41 
	#ZCL_ATTRID_GLOBAL_CLUSTER_REVISION
 0xFFFD

	)

42 
	#ZCL_ATTRID_GLOBAL_ATTR_REPORTING_STATUS
 0xFFFE

	)

47 
	#ZCL_CLUSTER_GEN_BASIC
 0x0000

	)

48 
	#ZCL_CLUSTER_GEN_POWER_CFG
 0x0001

	)

49 
	#ZCL_CLUSTER_GEN_DEVICE_TEMP_CONFIG
 0x0002

	)

50 
	#ZCL_CLUSTER_GEN_IDENTIFY
 0x0003

	)

51 
	#ZCL_CLUSTER_GEN_GROUPS
 0x0004

	)

52 
	#ZCL_CLUSTER_GEN_SCENES
 0x0005

	)

53 
	#ZCL_CLUSTER_GEN_ON_OFF
 0x0006

	)

54 
	#ZCL_CLUSTER_GEN_ON_OFF_SWITCH_CONFIG
 0x0007

	)

55 
	#ZCL_CLUSTER_GEN_LEVEL_CONTROL
 0x0008

	)

56 
	#ZCL_CLUSTER_GEN_ALARMS
 0x0009

	)

57 
	#ZCL_CLUSTER_GEN_TIME
 0x000A

	)

58 
	#ZCL_CLUSTER_GEN_LOCATION
 0x000B

	)

59 
	#ZCL_CLUSTER_GEN_ANALOG_INPUT_BASIC
 0x000C

	)

60 
	#ZCL_CLUSTER_GEN_ANALOG_OUTPUT_BASIC
 0x000D

	)

61 
	#ZCL_CLUSTER_GEN_ANALOG_VALUE_BASIC
 0x000E

	)

62 
	#ZCL_CLUSTER_GEN_BINARY_INPUT_BASIC
 0x000F

	)

63 
	#ZCL_CLUSTER_GEN_BINARY_OUTPUT_BASIC
 0x0010

	)

64 
	#ZCL_CLUSTER_GEN_BINARY_VALUE_BASIC
 0x0011

	)

65 
	#ZCL_CLUSTER_GEN_MULTISTATE_INPUT_BASIC
 0x0012

	)

66 
	#ZCL_CLUSTER_GEN_MULTISTATE_OUTPUT_BASIC
 0x0013

	)

67 
	#ZCL_CLUSTER_GEN_MULTISTATE_VALUE_BASIC
 0x0014

	)

68 
	#ZCL_CLUSTER_GEN_COMMISSIONING
 0x0015

	)

69 
	#ZCL_CLUSTER_GEN_PARTITION
 0x0016

	)

70 
	#ZCL_CLUSTER_OTA
 0x0019

	)

71 
	#ZCL_CLUSTER_GEN_POWER_PROFILE
 0x001A

	)

72 
	#ZCL_CLUSTER_GEN_APPLIANCE_CONTROL
 0x001B

	)

73 
	#ZCL_CLUSTER_GEN_POLL_CONTROL
 0x0020

	)

74 
	#ZCL_CLUSTER_GEN_GREEN_POWER
 0x0021

	)

75 
	#ZCL_CLUSTER_GEN_KEEP_ALIVE
 0x0025

	)

76 
	#ZCL_CLUSTER_GEN_DIAGNOSTICS
 0x0B05

	)

79 
	#ZCL_CLUSTER_CLOSURES_SHADE_CONFIG
 0x0100

	)

80 
	#ZCL_CLUSTER_CLOSURES_DOOR_LOCK
 0x0101

	)

81 
	#ZCL_CLUSTER_CLOSURES_WINDOW_COVERING
 0x0102

	)

84 
	#ZCL_CLUSTER_HVAC_PUMP_CONFIG_CONTROL
 0x0200

	)

85 
	#ZCL_CLUSTER_HAVC_THERMOSTAT
 0x0201

	)

86 
	#ZCL_CLUSTER_HAVC_FAN_CONTROL
 0x0202

	)

87 
	#ZCL_CLUSTER_HAVC_DIHUMIDIFICATION_CONTROL
 0x0203

	)

88 
	#ZCL_CLUSTER_HAVC_USER_INTERFACE_CONFIG
 0x0204

	)

91 
	#ZCL_CLUSTER_LIGHTING_COLOR_CONTROL
 0x0300

	)

92 
	#ZCL_CLUSTER_LIGHTING_BALLAST_CONFIG
 0x0301

	)

95 
	#ZCL_CLUSTER_MS_ILLUMINANCE_MEASUREMENT
 0x0400

	)

96 
	#ZCL_CLUSTER_MS_ILLUMINANCE_LEVEL_SENSING_CONFIG
 0x0401

	)

97 
	#ZCL_CLUSTER_MS_TEMPERATURE_MEASUREMENT
 0x0402

	)

98 
	#ZCL_CLUSTER_MS_PRESSURE_MEASUREMENT
 0x0403

	)

99 
	#ZCL_CLUSTER_MS_FLOW_MEASUREMENT
 0x0404

	)

100 
	#ZCL_CLUSTER_MS_RELATIVE_HUMIDITY
 0x0405

	)

101 
	#ZCL_CLUSTER_MS_OCCUPANCY_SENSING
 0x0406

	)

102 
	#ZCL_CLUSTER_MS_LEAF_WETNESS
 0x0407

	)

103 
	#ZCL_CLUSTER_MS_SOIL_MOISTURE
 0x0408

	)

104 
	#ZCL_CLUSTER_MS_ELECTRICAL_MEASUREMENT
 0x0B04

	)

107 
	#ZCL_CLUSTER_SS_IAS_ZONE
 0x0500

	)

108 
	#ZCL_CLUSTER_SS_IAS_ACE
 0x0501

	)

109 
	#ZCL_CLUSTER_SS_IAS_WD
 0x0502

	)

112 
	#ZCL_CLUSTER_PI_GENERIC_TUNNEL
 0x0600

	)

113 
	#ZCL_CLUSTER_PI_BACNET_PROTOCOL_TUNNEL
 0x0601

	)

114 
	#ZCL_CLUSTER_PI_ANALOG_INPUT_BACNET_REG
 0x0602

	)

115 
	#ZCL_CLUSTER_PI_ANALOG_INPUT_BACNET_EXT
 0x0603

	)

116 
	#ZCL_CLUSTER_PI_ANALOG_OUTPUT_BACNET_REG
 0x0604

	)

117 
	#ZCL_CLUSTER_PI_ANALOG_OUTPUT_BACNET_EXT
 0x0605

	)

118 
	#ZCL_CLUSTER_PI_ANALOG_VALUE_BACNET_REG
 0x0606

	)

119 
	#ZCL_CLUSTER_PI_ANALOG_VALUE_BACNET_EXT
 0x0607

	)

120 
	#ZCL_CLUSTER_PI_BINARY_INPUT_BACNET_REG
 0x0608

	)

121 
	#ZCL_CLUSTER_PI_BINARY_INPUT_BACNET_EXT
 0x0609

	)

122 
	#ZCL_CLUSTER_PI_BINARY_OUTPUT_BACNET_REG
 0x060A

	)

123 
	#ZCL_CLUSTER_PI_BINARY_OUTPUT_BACNET_EXT
 0x060B

	)

124 
	#ZCL_CLUSTER_PI_BINARY_VALUE_BACNET_REG
 0x060C

	)

125 
	#ZCL_CLUSTER_PI_BINARY_VALUE_BACNET_EXT
 0x060D

	)

126 
	#ZCL_CLUSTER_PI_MULTISTATE_INPUT_BACNET_REG
 0x060E

	)

127 
	#ZCL_CLUSTER_PI_MULTISTATE_INPUT_BACNET_EXT
 0x060F

	)

128 
	#ZCL_CLUSTER_PI_MULTISTATE_OUTPUT_BACNET_REG
 0x0610

	)

129 
	#ZCL_CLUSTER_PI_MULTISTATE_OUTPUT_BACNET_EXT
 0x0611

	)

130 
	#ZCL_CLUSTER_PI_MULTISTATE_VALUE_BACNET_REG
 0x0612

	)

131 
	#ZCL_CLUSTER_PI_MULTISTATE_VALUE_BACNET_EXT
 0x0613

	)

132 
	#ZCL_CLUSTER_PI_11073_PROTOCOL_TUNNEL
 0x0614

	)

135 
	#ZCL_CLUSTER_SE_PRICE
 0x0700

	)

136 
	#ZCL_CLUSTER_SE_Dem™d_RSP_AND_LOAD_CONTROL
 0x0701

	)

137 
	#ZCL_CLUSTER_SE_METERING
 0x0702

	)

138 
	#ZCL_CLUSTER_SE_MESSAGING
 0x0703

	)

139 
	#ZCL_CLUSTER_SE_SE_TUNNELING
 0x0704

	)

140 
	#ZCL_CLUSTER_SE_PREPAYMENT
 0x0705

	)

141 
	#ZCL_CLUSTER_GEN_KEY_ESTABLISHMENT
 0x0800

	)

144 
	#ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
 0x1000

	)

147 
	#ZCL_CLUSTER_WWAH
 0xFC57

	)

151 
	#ZCL_CLUSTER_TELINK_SDK_TEST
 0xFF00

	)

152 
	#ZCL_CLUSTER_TELINK_SDK_TEST_REQ
 0xFF01

	)

153 
	#ZCL_CLUSTER_TELINK_SDK_TEST_RSP
 0xFF02

	)

154 
	#ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_REQ
 0xFF03

	)

155 
	#ZCL_CLUSTER_TELINK_SDK_TEST_CLEAR_RSP
 0xFF04

	)

164 
	#ZCL_DATA_TYPE_NO_DATA
 0x00

	)

165 
	#ZCL_DATA_TYPE_DATA8
 0x08

	)

166 
	#ZCL_DATA_TYPE_DATA16
 0x09

	)

167 
	#ZCL_DATA_TYPE_DATA24
 0x0a

	)

168 
	#ZCL_DATA_TYPE_DATA32
 0x0b

	)

169 
	#ZCL_DATA_TYPE_DATA40
 0x0c

	)

170 
	#ZCL_DATA_TYPE_DATA48
 0x0d

	)

171 
	#ZCL_DATA_TYPE_DATA56
 0x0e

	)

172 
	#ZCL_DATA_TYPE_DATA64
 0x0f

	)

173 
	#ZCL_DATA_TYPE_BOOLEAN
 0x10

	)

174 
	#ZCL_DATA_TYPE_BITMAP8
 0x18

	)

175 
	#ZCL_DATA_TYPE_BITMAP16
 0x19

	)

176 
	#ZCL_DATA_TYPE_BITMAP24
 0x1a

	)

177 
	#ZCL_DATA_TYPE_BITMAP32
 0x1b

	)

178 
	#ZCL_DATA_TYPE_BITMAP40
 0x1c

	)

179 
	#ZCL_DATA_TYPE_BITMAP48
 0x1d

	)

180 
	#ZCL_DATA_TYPE_BITMAP56
 0x1e

	)

181 
	#ZCL_DATA_TYPE_BITMAP64
 0x1f

	)

182 
	#ZCL_DATA_TYPE_UINT8
 0x20

	)

183 
	#ZCL_DATA_TYPE_UINT16
 0x21

	)

184 
	#ZCL_DATA_TYPE_UINT24
 0x22

	)

185 
	#ZCL_DATA_TYPE_UINT32
 0x23

	)

186 
	#ZCL_DATA_TYPE_UINT40
 0x24

	)

187 
	#ZCL_DATA_TYPE_UINT48
 0x25

	)

188 
	#ZCL_DATA_TYPE_UINT56
 0x26

	)

189 
	#ZCL_DATA_TYPE_UINT64
 0x27

	)

190 
	#ZCL_DATA_TYPE_INT8
 0x28

	)

191 
	#ZCL_DATA_TYPE_INT16
 0x29

	)

192 
	#ZCL_DATA_TYPE_INT24
 0x2a

	)

193 
	#ZCL_DATA_TYPE_INT32
 0x2b

	)

194 
	#ZCL_DATA_TYPE_INT40
 0x2c

	)

195 
	#ZCL_DATA_TYPE_INT48
 0x2d

	)

196 
	#ZCL_DATA_TYPE_INT56
 0x2e

	)

197 
	#ZCL_DATA_TYPE_INT64
 0x2f

	)

198 
	#ZCL_DATA_TYPE_ENUM8
 0x30

	)

199 
	#ZCL_DATA_TYPE_ENUM16
 0x31

	)

200 
	#ZCL_DATA_TYPE_SEMI_PREC
 0x38

	)

201 
	#ZCL_DATA_TYPE_SINGLE_PREC
 0x39

	)

202 
	#ZCL_DATA_TYPE_DOUBLE_PREC
 0x3a

	)

203 
	#ZCL_DATA_TYPE_OCTET_STR
 0x41

	)

204 
	#ZCL_DATA_TYPE_CHAR_STR
 0x42

	)

205 
	#ZCL_DATA_TYPE_LONG_OCTET_STR
 0x43

	)

206 
	#ZCL_DATA_TYPE_LONG_CHAR_STR
 0x44

	)

207 
	#ZCL_DATA_TYPE_ARRAY
 0x48

	)

208 
	#ZCL_DATA_TYPE_STRUCT
 0x4c

	)

209 
	#ZCL_DATA_TYPE_SET
 0x50

	)

210 
	#ZCL_DATA_TYPE_BAG
 0x51

	)

211 
	#ZCL_DATA_TYPE_TOD
 0xe0

	)

212 
	#ZCL_DATA_TYPE_DATE
 0xe1

	)

213 
	#ZCL_DATA_TYPE_UTC
 0xe2

	)

214 
	#ZCL_DATA_TYPE_CLUSTER_ID
 0xe8

	)

215 
	#ZCL_DATA_TYPE_ATTR_ID
 0xe9

	)

216 
	#ZCL_DATA_TYPE_BAC_OID
 0xó

	)

217 
	#ZCL_DATA_TYPE_IEEE_ADDR
 0xf0

	)

218 
	#ZCL_DATA_TYPE_128_BIT_SEC_KEY
 0xf1

	)

219 
	#ZCL_DATA_TYPE_UNKNOWN
 0xff

	)

227 
	#ACCESS_CONTROL_READ
 0x01

	)

228 
	#ACCESS_CONTROL_WRITE
 0x02

	)

229 
	#ACCESS_CONTROL_REPORTABLE
 0x04

	)

230 
	#ACCESS_CONTROL_SCENE
 0x08

	)

231 
	#ACCESS_CONTROL_AUTH_READ
 0x10

	)

232 
	#ACCESS_CONTROL_AUTH_WRITE
 0x20

	)

233 
	#ACCESS_CONTROL_COMMAND
 0x40

	)

235 
	#ACCESS_CONTROL_CLIENT_ATTR
 0x80

	)

238 
	#ACCESS_CONTROL_EXT_MASK
 0x07

	)

243 
	#ZCL_SEND_ATTR_REPORTS
 0x00

	)

244 
	#ZCL_EXPECT_ATTR_REPORTS
 0x01

	)

251 
	#ZCL_STA_SUCCESS
 0x00

	)

252 
	#ZCL_STA_FAILURE
 0x01

	)

255 
	#ZCL_STA_NOT_AUTHORIZED
 0x7E

	)

256 
	#ZCL_STA_MALFORMED_COMMAND
 0x80

	)

257 
	#ZCL_STA_UNSUP_CLUSTER_COMMAND
 0x81

	)

258 
	#ZCL_STA_UNSUP_GENERAL_COMMAND
 0x82

	)

259 
	#ZCL_STA_UNSUP_MANU_CLUSTER_COMMAND
 0x83

	)

260 
	#ZCL_STA_UNSUP_MANU_GENERAL_COMMAND
 0x84

	)

261 
	#ZCL_STA_INVALID_FIELD
 0x85

	)

262 
	#ZCL_STA_UNSUPPORTED_ATTRIBUTE
 0x86

	)

263 
	#ZCL_STA_INVALID_VALUE
 0x87

	)

264 
	#ZCL_STA_READ_ONLY
 0x88

	)

265 
	#ZCL_STA_INSUFFICIENT_SPACE
 0x89

	)

266 
	#ZCL_STA_DUPLICATE_EXISTS
 0x8a

	)

267 
	#ZCL_STA_NOT_FOUND
 0x8b

	)

268 
	#ZCL_STA_UNREPORTABLE_ATTRIBUTE
 0x8c

	)

269 
	#ZCL_STA_INVALID_DATA_TYPE
 0x8d

	)

270 
	#ZCL_STA_INVALID_SELECTOR
 0x8e

	)

271 
	#ZCL_STA_WRITE_ONLY
 0x8f

	)

272 
	#ZCL_STA_INCONSISTENT_STARTUP_STATE
 0x90

	)

273 
	#ZCL_STA_DEFINED_OUT_OF_BAND
 0x91

	)

274 
	#ZCL_STA_INCONSISTENT
 0x92

	)

275 
	#ZCL_STA_ACTION_DENIED
 0x93

	)

276 
	#ZCL_STA_TIMEOUT
 0x94

	)

277 
	#ZCL_STA_ABORT
 0x95

	)

278 
	#ZCL_STA_INVALID_IMAGE
 0x96

	)

279 
	#ZCL_STA_WAIT_FOR_DATA
 0x97

	)

280 
	#ZCL_STA_NO_IMAGE_AVAILABLE
 0x98

	)

281 
	#ZCL_STA_REQUIRE_MORE_IMAGE
 0x99

	)

284 
	#ZCL_STA_HARDWARE_FAILURE
 0xc0

	)

285 
	#ZCL_STA_SOFTWARE_FAILURE
 0xc1

	)

286 
	#ZCL_STA_CALIBRATION_ERROR
 0xc2

	)

288 
	#ZCL_STA_CMD_HAS_RESP
 0xFF

289 

	)

	@zigbee/zcl/zcl_include.h

24 #i‚de‡
ZCL_INCLUDE_H


25 
	#ZCL_INCLUDE_H


	)

27 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

29 
	~"z˛_c⁄fig.h
"

30 
	~"z˛_c⁄°.h
"

31 
	~"z˛_nv.h
"

32 
	~"z˛.h
"

35 
	~"gíîÆ/z˛_basic.h
"

36 
	~"gíîÆ/z˛_powîCfg.h
"

37 
	~"gíîÆ/z˛_devTem≥øtuªCfg.h
"

38 
	~"gíîÆ/z˛_idítify.h
"

39 
	~"gíîÆ/z˛_group.h
"

40 
	~"gíîÆ/z˛_s˚√.h
"

41 
	~"gíîÆ/z˛_⁄off.h
"

42 
	~"gíîÆ/z˛_Àvñ.h
"

43 
	~"gíîÆ/z˛_Æ¨m.h
"

44 
	~"gíîÆ/z˛_time.h
"

45 
	~"gíîÆ/z˛_dügno°ics.h
"

46 
	~"gíîÆ/z˛_pﬁlCål.h
"

47 
	~"gíîÆ/z˛_gªíPowî.h
"

50 
	~"˛osuªs/z˛_wödow_covîög.h
"

51 
	~"˛osuªs/z˛_do‹_lock.h
"

54 
	~"£curôy_ß„ty/z˛_üs_z⁄e.h
"

55 
	~"£curôy_ß„ty/z˛_üs_a˚.h
"

56 
	~"£curôy_ß„ty/z˛_üs_wd.h
"

59 
	~"mósumít_£nsög/z˛_ûlumö™˚_mósuªmít.h
"

60 
	~"mósumít_£nsög/z˛_occu∑ncy_£nsög.h
"

61 
	~"mósumít_£nsög/z˛_ãm≥øtuª_mósuªmít.h
"

62 
	~"mósumít_£nsög/z˛_ñe˘riˇl_mósuªmít.h
"

65 
	~"light_cﬁ‹_c⁄åﬁ/z˛_light_cﬁ‹Cål.h
"

68 
	~"hvac/z˛_thîmo°©.h
"

71 
	~"sm¨t_íîgy/z˛_mëîög.h
"

74 
	~"commissi⁄ög/z˛_commissi⁄ög.h
"

77 
	~"zŒ_commissi⁄ög/z˛_zŒ_commissi⁄ög.h
"

78 
	~"zŒ_commissi⁄ög/z˛_touchlök_©å.h
"

81 
	~"Ÿa_upgødög/z˛_Ÿa.h
"

84 
	~"z˛_wwah/z˛_wwah.h
"

	@zigbee/zcl/zcl_nv.c

27 
	~"z˛_ö˛ude.h
"

49 #ifde‡
ZCL_REPORT


59 
nv_°s_t
 
	$z˛_ªp‹tögTab_ßve
()

61 
nv_°s_t
 
°
 = 
NV_SUCC
;

63 #i‡
NV_ENABLE


64 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_REPORT
, (
z˛_ªp‹tögTab_t
), (
u8
*)&
ªp‹tögTab
);

66 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

69  
°
;

70 
	}
}

81 
nv_°s_t
 
	$z˛_ªp‹tögTab_ª°‹e
()

83 
nv_°s_t
 
°
 = 
NV_SUCC
;

85 #i‡
NV_ENABLE


86 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_REPORT
, (
z˛_ªp‹tögTab_t
), (
u8
*)&
ªp‹tögTab
);

87 
u8
 
i
 = 0; i < 
ªp‹tögTab
.
ªp‹tNum
; i++){

88 
	`mem£t
(
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
¥evD©a
, 0, 
REPORTABLE_CHANGE_MAX_ANALOG_SIZE
);

91 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

94  
°
;

95 
	}
}

107 
nv_°s_t
 
	$z˛_s˚√TabÀ_ßve
()

109 
nv_°s_t
 
°
 = 
NV_SUCC
;

111 #ifde‡
ZCL_SCENE


112 #i‡
NV_ENABLE


113 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_SCENE_TABLE
, (
z˛_s˚√TabÀ_t
Ë* 
ZCL_SCENE_TABLE_NUM
, (
u8
*)&
g_z˛_s˚√Tab
);

115 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

119  
°
;

120 
	}
}

131 
nv_°s_t
 
	$z˛_s˚√TabÀ_ª°‹e
()

133 
nv_°s_t
 
°
 = 
NV_SUCC
;

135 #ifde‡
ZCL_SCENE


136 #i‡
NV_ENABLE


137 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_SCENE_TABLE
, (
z˛_s˚√TabÀ_t
Ë* 
ZCL_SCENE_TABLE_NUM
, (
u8
*)&
g_z˛_s˚√Tab
);

139 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

143  
°
;

144 
	}
}

146 #ifde‡
ZCL_WWAH


156 
nv_°s_t
 
	$z˛_≠sLökKeyAuthInfo_ßve
()

158 
nv_°s_t
 
°
 = 
NV_SUCC
;

160 #i‡
NV_ENABLE


161 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_APS_AUTH_INFO
, (
wwah_≠sLökKeyAuthInfo_t
), (
u8
*)&
g_z˛_≠sLökKeyAuthInfo
);

163 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

166  
°
;

167 
	}
}

178 
nv_°s_t
 
	$z˛_≠sLökKeyAuthInfo_ª°‹e
()

180 
nv_°s_t
 
°
 = 
NV_SUCC
;

182 #i‡
NV_ENABLE


183 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_APS_AUTH_INFO
, (
wwah_≠sLökKeyAuthInfo_t
), (
u8
*)&
g_z˛_≠sLökKeyAuthInfo
);

185 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

188  
°
;

189 
	}
}

200 
nv_°s_t
 
	$z˛_≠sAcksRequúeInfo_ßve
()

202 
nv_°s_t
 
°
 = 
NV_SUCC
;

204 #i‡
NV_ENABLE


205 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_APS_ACKS_INFO
, (
wwah_≠sAcksRequúeInfo_t
), (
u8
*)&
g_z˛_≠sAcksRequúeInfo
);

207 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

210  
°
;

211 
	}
}

222 
nv_°s_t
 
	$z˛_≠sAcksRequúeInfo_ª°‹e
()

224 
nv_°s_t
 
°
 = 
NV_SUCC
;

226 #i‡
NV_ENABLE


227 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_APS_ACKS_INFO
, (
wwah_≠sAcksRequúeInfo_t
), (
u8
*)&
g_z˛_≠sAcksRequúeInfo
);

229 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

232  
°
;

233 
	}
}

244 
nv_°s_t
 
	$z˛_u£TCF‹Clu°îInfo_ßve
()

246 
nv_°s_t
 
°
 = 
NV_SUCC
;

248 #i‡
NV_ENABLE


249 
°
 = 
	`nv_ÊashWrôeNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_USE_TC_CLUSTER_INFO
, (
wwah_u£TCF‹Clu°îInfo_t
), (
u8
*)&
g_z˛_u£TCF‹Clu°îInfo
);

251 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

254  
°
;

255 
	}
}

266 
nv_°s_t
 
	$z˛_u£TCF‹Clu°îInfo_ª°‹e
()

268 
nv_°s_t
 
°
 = 
NV_SUCC
;

270 #i‡
NV_ENABLE


271 
°
 = 
	`nv_ÊashRódNew
(1, 
NV_MODULE_ZCL
, 
NV_ITEM_ZCL_WWAH_USE_TC_CLUSTER_INFO
, (
wwah_u£TCF‹Clu°îInfo_t
), (
u8
*)&
g_z˛_u£TCF‹Clu°îInfo
);

273 
°
 = 
NV_ENABLE_PROTECT_ERROR
;

276  
°
;

277 
	}
}

	@zigbee/zcl/zcl_nv.h

24 #i‚de‡
ZCL_NV_H


25 
	#ZCL_NV_H


	)

36 
nv_°s_t
 
z˛_ªp‹tögTab_ßve
();

46 
nv_°s_t
 
z˛_ªp‹tögTab_ª°‹e
();

56 
nv_°s_t
 
z˛_s˚√TabÀ_ßve
();

66 
nv_°s_t
 
z˛_s˚√TabÀ_ª°‹e
();

76 
nv_°s_t
 
z˛_≠sLökKeyAuthInfo_ßve
();

86 
nv_°s_t
 
z˛_≠sLökKeyAuthInfo_ª°‹e
();

96 
nv_°s_t
 
z˛_≠sAcksRequúeInfo_ßve
();

106 
nv_°s_t
 
z˛_≠sAcksRequúeInfo_ª°‹e
();

116 
nv_°s_t
 
z˛_u£TCF‹Clu°îInfo_ßve
();

126 
nv_°s_t
 
z˛_u£TCF‹Clu°îInfo_ª°‹e
();

	@zigbee/zcl/zcl_reporting.c

27 
	~"z˛_ö˛ude.h
"

32 
z˛_ªp‹tögTab_t
 
	gªp‹tögTab
;

37 
ev_timî_evít_t
 *
	gªp‹tAârTimîEvt
 = 
NULL
;

52 
_CODE_ZCL_
 
	$z˛_ªp‹tCfgInfoE¡ryCÀ¨
(
ªp‹tCfgInfo_t
 *
pE¡ry
)

54 if(
pE¡ry
){

55 
	`mem£t
((
u8
 *)
pE¡ry
, 0, (
ªp‹tCfgInfo_t
));

57 
	}
}

68 
_CODE_ZCL_
 
	$z˛_ªp‹tögTabInô
()

70 if(
	`z˛_ªp‹tögTab_ª°‹e
(Ë!
NV_SUCC
){

71 
ªp‹tögTab
.
ªp‹tNum
 = 0;

73 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

74 
ªp‹tCfgInfo_t
 *
pE¡ry
 = &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

76 
	`z˛_ªp‹tCfgInfoE¡ryCÀ¨
(
pE¡ry
);

79 
	}
}

90 
_CODE_ZCL_
 
u8
 
	$z˛_ªp‹tögE¡ryA˘iveNumGë
()

92 
u8
 
˙t
 = 0;

94 if(
ªp‹tögTab
.
ªp‹tNum
){

95 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

96 if(
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
u£d
 && (ªp‹tögTab.ªp‹tCfgInfo[i].
maxI¡îvÆ
 != 0xFFFF)){

97 
˙t
++;

102  
˙t
;

103 
	}
}

115 
_CODE_ZCL_
 
ªp‹tCfgInfo_t
 *
	$z˛_ªp‹tCfgInfoE¡ryFöd
(
u8
 
ídpoöt
, 
u16
 
˛u°îId
, u16 
©åID
)

117 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

118 if(
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
u£d
){

119 if–(
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
˛u°îID
 =
˛u°îId
) &&

120 (
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
©åID
 ==áttrID) &&

121 (
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
ídPoöt
 =
ídpoöt
) ){

122  &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

127  
NULL
;

128 
	}
}

139 
_CODE_ZCL_
 
ªp‹tCfgInfo_t
 *
	$z˛_ªp‹tCfgInfoE¡ryFªeGë
()

141 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

142 if(
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
].
u£d
 == 0){

143  &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

147  
NULL
;

148 
	}
}

159 
_CODE_ZCL_
 
	$z˛_ªp‹tCfgInfoE¡ryR°
(
ªp‹tCfgInfo_t
 *
pE¡ry
)

161 if(
pE¡ry
->
u£d
){

162 
pE¡ry
->
möI¡îvÆ
 =ÖE¡ry->
möI¡D·
;

163 
pE¡ry
->
maxI¡îvÆ
 =ÖE¡ry->
maxI¡D·
;

164 
pE¡ry
->
möI¡C¡
 =ÖE¡ry->
möI¡D·
;

165 
pE¡ry
->
maxI¡C¡
 =ÖE¡ry->
maxI¡D·
;

166 
	`mem£t
(
pE¡ry
->
ªp‹èbÀCh™ge
, 0, 
REPORTABLE_CHANGE_MAX_ANALOG_SIZE
);

168 
	}
}

183 
_CODE_ZCL_
 
	$z˛_ªp‹tCfgInfoE¡ryUpd©e
(
ªp‹tCfgInfo_t
 *
pE¡ry
, 
u8
 
ídPoöt
, 
u16
 
¥ofûeId
, u16 
˛u°îId
, 
z˛CfgRï‹tRec_t
 *
pCfgRï‹tRec
)

185 if(!
pE¡ry
->
u£d
){

187 
pE¡ry
->
¥ofûeID
 = 
¥ofûeId
;

188 
pE¡ry
->
˛u°îID
 = 
˛u°îId
;

189 
pE¡ry
->
ídPoöt
 =ÉndPoint;

190 
pE¡ry
->
©åID
 = 
pCfgRï‹tRec
->attrID;

191 
pE¡ry
->
möI¡D·
 = 
pCfgRï‹tRec
->
möRï‹tI¡
;

192 
pE¡ry
->
maxI¡D·
 = 
pCfgRï‹tRec
->
maxRï‹tI¡
;

193 
pE¡ry
->
möI¡îvÆ
 = 
pCfgRï‹tRec
->
möRï‹tI¡
;

194 
pE¡ry
->
maxI¡îvÆ
 = 
pCfgRï‹tRec
->
maxRï‹tI¡
;

195 
pE¡ry
->
d©aTy≥
 = 
pCfgRï‹tRec
->dataType;

196 if(
	`z˛_™ÆogD©aTy≥
(
pE¡ry
->
d©aTy≥
)){

197 
	`mem˝y
(
pE¡ry
->
ªp‹èbÀCh™ge
, 
pCfgRï‹tRec
->ªp‹èbÀCh™ge, 
	`z˛_gëD©aTy≥Lí
’E¡ry->
d©aTy≥
));

200 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
pE¡ry
->
ídPoöt
,ÖE¡ry->
˛u°îID
,ÖE¡ry->
©åID
);

201 if(!
pAârE¡ry
){

203 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_ZB_ZCL_ENTRY
);

208 
pE¡ry
->
möI¡C¡
 = 
pCfgRï‹tRec
->
möRï‹tI¡
;

209 
pE¡ry
->
maxI¡C¡
 = 
pCfgRï‹tRec
->
maxRï‹tI¡
;

210 
pE¡ry
->
u£d
 = 1;

212 
ªp‹tögTab
.
ªp‹tNum
++;

215 
pE¡ry
->
möI¡îvÆ
 = 
pCfgRï‹tRec
->
möRï‹tI¡
;

216 
pE¡ry
->
maxI¡îvÆ
 = 
pCfgRï‹tRec
->
maxRï‹tI¡
;

217 
pE¡ry
->
möI¡C¡
 = 
pCfgRï‹tRec
->
möRï‹tI¡
;

218 
pE¡ry
->
maxI¡C¡
 = 
pCfgRï‹tRec
->
maxRï‹tI¡
;

219 if(
	`z˛_™ÆogD©aTy≥
(
pE¡ry
->
d©aTy≥
)){

220 
	`mem˝y
(
pE¡ry
->
ªp‹èbÀCh™ge
, 
pCfgRï‹tRec
->ªp‹èbÀCh™ge, 
	`z˛_gëD©aTy≥Lí
’E¡ry->
d©aTy≥
));

223 
	}
}

237 
_CODE_ZCL_
 
boﬁ
 
	$ªp‹èbÀCh™geVÆueChk
(
u8
 
d©aTy≥
, u8 *
curVÆue
, u8 *
¥evVÆue
, u8 *
ªp‹èbÀCh™ge
)

239 
boﬁ
 
√edRï‹t
 = 
FALSE
;

241 
d©aTy≥
)

243 
ZCL_DATA_TYPE_UINT8
:

245 
u8
 
P
 = 
¥evVÆue
[0];

246 
u8
 
C
 = 
curVÆue
[0];

247 
u8
 
R
 = 
ªp‹èbÀCh™ge
[0];

248 if(
P
 >
C
){

249 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

251 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

255 
ZCL_DATA_TYPE_UINT16
:

257 
u16
 
P
 = 
	`BUILD_U16
(
¥evVÆue
[0],ÖrevValue[1]);

258 
u16
 
C
 = 
	`BUILD_U16
(
curVÆue
[0], curValue[1]);

259 
u16
 
R
 = 
	`BUILD_U16
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1]);

261 if(
P
 >
C
){

262 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

264 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

268 
ZCL_DATA_TYPE_UINT24
:

270 
u24
 
P
 = 
	`BUILD_U24
(
¥evVÆue
[0],ÖrevValue[1],ÖrevValue[2]);

271 
u24
 
C
 = 
	`BUILD_U24
(
curVÆue
[0], curValue[1], curValue[2]);

272 
u24
 
R
 = 
	`BUILD_U24
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1],ÑeportableChange[2]);

273 if(
P
 >
C
){

274 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

276 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

280 
ZCL_DATA_TYPE_UINT32
:

282 
u32
 
P
 = 
	`BUILD_U32
(
¥evVÆue
[0],ÖrevValue[1],ÖrevValue[2],ÖrevValue[3]);

283 
u32
 
C
 = 
	`BUILD_U32
(
curVÆue
[0], curValue[1], curValue[2], curValue[3]);

284 
u32
 
R
 = 
	`BUILD_U32
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1],ÑeportableChange[2],ÑeportableChange[3]);

285 if(
P
 >
C
){

286 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

288 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

292 
ZCL_DATA_TYPE_INT8
:

294 
s8
 
P
 = (s8)
¥evVÆue
[0];

295 
s8
 
C
 = (s8)
curVÆue
[0];

296 
s8
 
R
 = (s8)
ªp‹èbÀCh™ge
[0];

297 if(
P
 >
C
){

298 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

300 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

304 
ZCL_DATA_TYPE_INT16
:

306 
s16
 
P
 = 
	`BUILD_S16
(
¥evVÆue
[0],ÖrevValue[1]);

307 
s16
 
C
 = 
	`BUILD_S16
(
curVÆue
[0], curValue[1]);

308 
s16
 
R
 = 
	`BUILD_S16
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1]);

310 if(
P
 >
C
){

311 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

313 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

317 
ZCL_DATA_TYPE_INT24
:

319 
s24
 
P
 = 
	`BUILD_S24
(
¥evVÆue
[0],ÖrevValue[1],ÖrevValue[2]);

320 
s24
 
C
 = 
	`BUILD_S24
(
curVÆue
[0], curValue[1], curValue[2]);

321 
s24
 
R
 = 
	`BUILD_S24
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1],ÑeportableChange[2]);

322 if(
P
 >
C
){

323 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

325 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

329 
ZCL_DATA_TYPE_INT32
:

331 
s32
 
P
 = 
	`BUILD_S32
(
¥evVÆue
[0],ÖrevValue[1],ÖrevValue[2],ÖrevValue[3]);

332 
s32
 
C
 = 
	`BUILD_S32
(
curVÆue
[0], curValue[1], curValue[2], curValue[3]);

333 
s32
 
R
 = 
	`BUILD_S32
(
ªp‹èbÀCh™ge
[0],ÑeportableChange[1],ÑeportableChange[2],ÑeportableChange[3]);

334 if(
P
 >
C
){

335 
√edRï‹t
 = ((
P
 - 
C
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

337 
√edRï‹t
 = ((
C
 - 
P
Ë> 
R
Ë? 
TRUE
 : 
FALSE
;

371  
√edRï‹t
;

372 
	}
}

383 
_CODE_ZCL_
 
	$ªp‹tAâr
(
ªp‹tCfgInfo_t
 *
pE¡ry
)

385 if(!
	`zb_bödögTblSórched
(
pE¡ry
->
˛u°îID
,ÖE¡ry->
ídPoöt
)){

389 
ïInfo_t
 
d°EpInfo
;

390 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

392 
d°EpInfo
.
d°AddrMode
 = 
APS_DSTADDR_EP_NOTPRESETNT
;

393 
d°EpInfo
.
¥ofûeId
 = 
pE¡ry
->
¥ofûeID
;

395 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
pE¡ry
->
ídPoöt
,ÖE¡ry->
˛u°îID
,ÖE¡ry->
©åID
);

396 if(!
pAârE¡ry
){

398 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_ZB_ZCL_ENTRY
);

402 
u16
 
Àn
 = 
	`z˛_gëAârSize
(
pAârE¡ry
->
ty≥
,ÖAârE¡ry->
d©a
);

404 
Àn
 = (len>8) ? (8):(len);

407 
	`mem˝y
(
pE¡ry
->
¥evD©a
, 
pAârE¡ry
->
d©a
, 
Àn
);

409 
	`z˛_£ndRï‹tCmd
(
pE¡ry
->
ídPoöt
, &
d°EpInfo
, 
TRUE
, 
ZCL_FRAME_SERVER_CLIENT_DIR
,

410 
pE¡ry
->
˛u°îID
, 
pAârE¡ry
->
id
,ÖAârE¡ry->
ty≥
,ÖAârE¡ry->
d©a
);

411 
	}
}

422 
_CODE_ZCL_
 
	$ªp‹tNoMöLimô
()

424 if(
	`z˛_ªp‹tögE¡ryA˘iveNumGë
()){

425 
z˛AârInfo_t
 *
pAârE¡ry
 = 
NULL
;

426 
u16
 
Àn
 = 0;

428 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

429 
ªp‹tCfgInfo_t
 *
pE¡ry
 = &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

430 if(
pE¡ry
->
u£d
 && (pE¡ry->
maxI¡îvÆ
 !0xFFFFË&& (pE¡ry->
möI¡îvÆ
 == 0)){

432 
pAârE¡ry
 = 
	`z˛_födAâribuã
(
pE¡ry
->
ídPoöt
,ÖE¡ry->
˛u°îID
,ÖE¡ry->
©åID
);

433 if(!
pAârE¡ry
){

435 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_ZB_ZCL_ENTRY
);

439 
Àn
 = 
	`z˛_gëAârSize
(
pAârE¡ry
->
ty≥
,ÖAârE¡ry->
d©a
);

440 
Àn
 = (len>8) ? (8):(len);

442 if–(!
	`z˛_™ÆogD©aTy≥
(
pAârE¡ry
->
ty≥
Ë&& (
	`memcmp
(
pE¡ry
->
¥evD©a
,ÖAârE¡ry->
d©a
, 
Àn
Ë!
SUCCESS
))

443 || ((
	`z˛_™ÆogD©aTy≥
(
pAârE¡ry
->
ty≥
)

444 && 
	`ªp‹èbÀCh™geVÆueChk
(
pAârE¡ry
->
ty≥
,ÖAârE¡ry->
d©a
, 
pE¡ry
->
¥evD©a
,ÖE¡ry->
ªp‹èbÀCh™ge
)))

446 
	`ªp‹tAâr
(
pE¡ry
);

448 
pE¡ry
->
möI¡C¡
 =ÖE¡ry->
möI¡îvÆ
;

449 
pE¡ry
->
maxI¡C¡
 =ÖE¡ry->
maxI¡îvÆ
;

454 
	}
}

465 
_CODE_ZCL_
 
s32
 
	$ªp‹tAârTimîCb
(*
¨g
)

467 if(
	`z˛_ªp‹tögE¡ryA˘iveNumGë
()){

468 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

469 
ªp‹tCfgInfo_t
 *
pE¡ry
 = &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

470 if(
pE¡ry
->
u£d
 && (pE¡ry->
möI¡îvÆ
 || (pE¡ry->
maxI¡îvÆ
 && (pEntry->maxInterval != 0xFFFF)))){

471 if(
pE¡ry
->
möI¡C¡
){

472 
pE¡ry
->
möI¡C¡
--;

474 if(
pE¡ry
->
maxI¡C¡
){

475 
pE¡ry
->
maxI¡C¡
--;

478 if(
pE¡ry
->
maxI¡îvÆ
 && !pE¡ry->
maxI¡C¡
){

479 
	`ªp‹tAâr
(
pE¡ry
);

481 
pE¡ry
->
möI¡C¡
 =ÖE¡ry->
möI¡îvÆ
;

482 
pE¡ry
->
maxI¡C¡
 =ÖE¡ry->
maxI¡îvÆ
;

483 }if(
pE¡ry
->
möI¡îvÆ
 && !pE¡ry->
möI¡C¡
){

484 
z˛AârInfo_t
 *
pAârE¡ry
 = 
	`z˛_födAâribuã
(
pE¡ry
->
ídPoöt
,ÖE¡ry->
˛u°îID
,ÖE¡ry->
©åID
);

485 if(!
pAârE¡ry
){

487 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_ZB_ZCL_ENTRY
);

491 
u8
 
Àn
 = 
	`z˛_gëAârSize
(
pAârE¡ry
->
ty≥
,ÖAârE¡ry->
d©a
);

493 
Àn
 = (len>8) ? (8):(len);

495 if–(!
	`z˛_™ÆogD©aTy≥
(
pAârE¡ry
->
ty≥
Ë&& (
	`memcmp
(
pE¡ry
->
¥evD©a
,ÖAârE¡ry->
d©a
, 
Àn
Ë!
SUCCESS
))

496 || ((
	`z˛_™ÆogD©aTy≥
(
pAârE¡ry
->
ty≥
)

497 && 
	`ªp‹èbÀCh™geVÆueChk
(
pAârE¡ry
->
ty≥
,ÖAârE¡ry->
d©a
, 
pE¡ry
->
¥evD©a
,ÖE¡ry->
ªp‹èbÀCh™ge
)))

499 
	`ªp‹tAâr
(
pE¡ry
);

501 
pE¡ry
->
möI¡C¡
 =ÖE¡ry->
möI¡îvÆ
;

502 
pE¡ry
->
maxI¡C¡
 =ÖE¡ry->
maxI¡îvÆ
;

510 
ªp‹tAârTimîEvt
 = 
NULL
;

513 
	}
}

524 
_CODE_ZCL_
 
	$ªp‹tAârTimîSèπ
(
u16
 
£c⁄ds
)

526 if(
	`z˛_ªp‹tögE¡ryA˘iveNumGë
(Ë&& !
ªp‹tAârTimîEvt
){

527 
u8
 
i
 = 0; i < 
ZCL_REPORTING_TABLE_NUM
; i++){

528 
ªp‹tCfgInfo_t
 *
pE¡ry
 = &
ªp‹tögTab
.
ªp‹tCfgInfo
[
i
];

529 if(
pE¡ry
->
u£d
 && (pE¡ry->
möI¡îvÆ
 || (pE¡ry->
maxI¡îvÆ
 && (pEntry->maxInterval != 0xFFFF)))){

530 if(
	`zb_bödögTblSórched
(
pE¡ry
->
˛u°îID
,ÖE¡ry->
ídPoöt
)){

531 
ªp‹tAârTimîEvt
 = 
	`TL_ZB_TIMER_SCHEDULE
(
ªp‹tAârTimîCb
, 
NULL
, 
£c⁄ds
 * 1000);

537 
	}
}

548 
_CODE_ZCL_
 
	$ªp‹tAârTimîSt›
()

550 if(
ªp‹tAârTimîEvt
){

551 
	`TL_ZB_TIMER_CANCEL
(&
ªp‹tAârTimîEvt
);

553 
	}
}

	@zigbee/zcl/zcl_wwah/zcl_wwah.c

27 
	~"../z˛_ö˛ude.h
"

30 #ifde‡
ZCL_WWAH


44 
wwah_≠sLökKeyAuthInfo_t
 
	gg_z˛_≠sLökKeyAuthInfo
;

45 
wwah_≠sAcksRequúeInfo_t
 
	gg_z˛_≠sAcksRequúeInfo
;

46 
wwah_u£TCF‹Clu°îInfo_t
 
	gg_z˛_u£TCF‹Clu°îInfo
;

48 
boﬁ
 
	gg_wwah_RouãrCheckedFœg
 = 
TRUE
;

53 
z˛_wwah_≠sLökKeyAuthInfoCÀ¨
();

54 
nv_°s_t
 
z˛_wwah_≠sLökKeyAuthInfoRe°‹e
();

55 
z˛_wwah_≠sAcksRequúeInfoCÀ¨
();

56 
nv_°s_t
 
z˛_wwah_≠sAcksRequúeInfoRe°‹e
();

57 
z˛_wwah_u£TCF‹Clu°îInfoCÀ¨
();

58 
nv_°s_t
 
z˛_wwah_u£TCF‹Clu°îInfoRe°‹e
();

59 
°©us_t
 
z˛_wwah_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
);

62 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
)

64 if(
	`z˛_wwah_≠sLökKeyAuthInfoRe°‹e
(Ë!
NV_SUCC
){

65 
	`z˛_wwah_≠sLökKeyAuthInfoCÀ¨
();

67 if(
	`z˛_wwah_≠sAcksRequúeInfoRe°‹e
(Ë!
NV_SUCC
){

68 
	`z˛_wwah_≠sAcksRequúeInfoCÀ¨
();

70 if(
	`z˛_wwah_u£TCF‹Clu°îInfoRe°‹e
(Ë!
NV_SUCC
){

71 
	`z˛_wwah_u£TCF‹Clu°îInfoCÀ¨
();

74  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_WWAH
, 
m™uCode
, 
©åNum
, 
©åTbl
, 
z˛_wwah_cmdH™dÀr
, 
cb
);

75 
	}
}

77 
_CODE_ZCL_
 
	$z˛_wwah_≠sLökKeyAuthInfoCÀ¨
()

79 
g_z˛_≠sLökKeyAuthInfo
.
°©us
 = 
APS_LINK_KEY_AUTH_DISABLE
;

80 
g_z˛_≠sLökKeyAuthInfo
.
num
 = 0;

81 
	`mem£t
((
u8
 *)
g_z˛_≠sLökKeyAuthInfo
.
˛u°îID
, 0, (
u16
Ë* 
CLUSTER_ID_MAX_NUM
);

82 
	}
}

84 
_CODE_ZCL_
 
nv_°s_t
 
	$z˛_wwah_≠sLökKeyAuthInfoRe°‹e
()

86  
	`z˛_≠sLökKeyAuthInfo_ª°‹e
();

87 
	}
}

89 
_CODE_ZCL_
 
	$z˛_wwah_≠sLökKeyAuthInfoSave
(*
¨g
)

91 
	`z˛_≠sLökKeyAuthInfo_ßve
();

92 
	}
}

94 
_CODE_ZCL_
 
	$z˛_wwah_≠sAcksRequúeInfoCÀ¨
()

96 
g_z˛_≠sAcksRequúeInfo
.
num
 = 0;

97 
	`mem£t
((
u8
 *)
g_z˛_≠sAcksRequúeInfo
.
˛u°îID
, 0, (
u16
Ë* 
CLUSTER_ID_MAX_NUM
);

98 
	}
}

100 
_CODE_ZCL_
 
nv_°s_t
 
	$z˛_wwah_≠sAcksRequúeInfoRe°‹e
()

102  
	`z˛_≠sAcksRequúeInfo_ª°‹e
();

103 
	}
}

105 
_CODE_ZCL_
 
	$z˛_wwah_≠sAcksRequúeInfoSave
(*
¨g
)

107 
	`z˛_≠sAcksRequúeInfo_ßve
();

108 
	}
}

110 
_CODE_ZCL_
 
	$z˛_wwah_u£TCF‹Clu°îInfoCÀ¨
()

112 
g_z˛_u£TCF‹Clu°îInfo
.
num
 = 0;

113 
	`mem£t
((
u8
 *)
g_z˛_u£TCF‹Clu°îInfo
.
˛u°îID
, 0, (
u16
Ë* 
CLUSTER_ID_MAX_NUM
);

114 
	}
}

116 
_CODE_ZCL_
 
nv_°s_t
 
	$z˛_wwah_u£TCF‹Clu°îInfoRe°‹e
()

118  
	`z˛_u£TCF‹Clu°îInfo_ª°‹e
();

119 
	}
}

121 
_CODE_ZCL_
 
	$z˛_wwah_u£TCF‹Clu°îInfoSave
(*
¨g
)

123 
	`z˛_u£TCF‹Clu°îInfo_ßve
();

124 
	}
}

127 
_CODE_ZCL_
 
≠sLökKeyAuthSètus_t
 
	$z˛_wwah_≠sLökKeyAuthSórch
(
u16
 
˛u°îID
)

129 
u8
 
föd
 = 0;

130 
u8
 
i
 = 0; i < 
g_z˛_≠sLökKeyAuthInfo
.
num
; i++){

131 if(
g_z˛_≠sLökKeyAuthInfo
.
˛u°îID
[
i
] == clusterID){

132 
föd
 = 1;

137  (
föd
 ? (!
g_z˛_≠sLökKeyAuthInfo
.
°©us
) : g_zcl_apsLinkKeyAuthInfo.status);

138 
	}
}

140 
_CODE_ZCL_
 
boﬁ
 
	$z˛_wwah_≠sLökKeyAuthCheck
(
u16
 
˛u°îID
, 
boﬁ
 
≠sU£Sec
)

142 
boﬁ
 
ac˚±
;

144 if(
g_z˛_≠sLökKeyAuthInfo
.
°©us
 =
APS_LINK_KEY_AUTH_DISABLE
){

145 
ac˚±
 = 
TRUE
;

147 
u8
 
i
 = 0; i < 
g_z˛_≠sLökKeyAuthInfo
.
num
; i++){

148 if((
g_z˛_≠sLökKeyAuthInfo
.
˛u°îID
[
i
] =˛u°îIDË&& !
≠sU£Sec
){

149 
ac˚±
 = 
FALSE
;

154 if(
≠sU£Sec
){

155  
TRUE
;

158 
ac˚±
 = 
FALSE
;

160 
u8
 
i
 = 0; i < 
g_z˛_≠sLökKeyAuthInfo
.
num
; i++){

161 if(
g_z˛_≠sLökKeyAuthInfo
.
˛u°îID
[
i
] == clusterID){

162 
ac˚±
 = 
TRUE
;

168  
ac˚±
;

169 
	}
}

171 
_CODE_ZCL_
 
boﬁ
 
	$z˛_wwah_touchlökE«bÀd
(
u8
 
ï
)

173 
boﬁ
 
íabÀ
 = 
TRUE
;

174 
u16
 
Àn
;

176 if(
	`z˛_gëAârVÆ
(
ï
, 
ZCL_CLUSTER_WWAH
, 
ZCL_ATTRID_WWAH_TOUCHLINK_INTERPAN_ENABLED
, &
Àn
, (
u8
 *)&
íabÀ
Ë=
ZCL_STA_SUCCESS
){

177  
íabÀ
;

179  
TRUE
;

180 
	}
}

182 
_CODE_ZCL_
 
	$z˛_wwah_≥riodicRouãrChecked
()

184 
g_wwah_RouãrCheckedFœg
 = 
TRUE
;

185 
	}
}

187 
_CODE_ZCL_
 
boﬁ
 
	$z˛_wwah_gëRouãrCheckedFœg
()

189  
g_wwah_RouãrCheckedFœg
;

190 
	}
}

192 
_CODE_ZCL_
 
	$z˛_wwah_˛órRouãrCheckedFœg
()

194 
g_wwah_RouãrCheckedFœg
 = 
FALSE
;

195 
	}
}

197 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ac˚±Check
(
z˛Incomög_t
 *
pInMsg
)

199 
≠sdeD©aInd_t
 *
pApsdeInd
 = 
pInMsg
->
msg
;

202 if(
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
 == 0x0000){

203 
	`z˛_wwah_≥riodicRouãrChecked
();

207 if(
pApsdeInd
->
ödInfo
.
˛u°î_id
 =
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
){

208 if(!
	`z˛_wwah_touchlökE«bÀd
(
pApsdeInd
->
ödInfo
.
d°_ï
)){

209  
ZCL_STA_NOT_AUTHORIZED
;

214 if(
	`z˛_wwah_≠sLökKeyAuthCheck
(
pApsdeInd
->
ödInfo
.
˛u°î_id
,ÖApsdeInd->ödInfo.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
Ë=
FALSE
){

215  
ZCL_STA_NOT_AUTHORIZED
;

218  
ZCL_STA_SUCCESS
;

219 
	}
}

223 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀApsLökKeyAuthCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
)

225 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

226 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îsToExem±
 * (
u16
);

228 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

229 if(!
buf
){

230  
ZCL_STA_INSUFFICIENT_SPACE
;

233 
u8
 *
pBuf
 = 
buf
;

235 *
pBuf
++ = 
pCmd
->
numOfClu°îsToExem±
;

236 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îsToExem±
; i++){

237 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

238 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

241 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
, 
TRUE
,

242 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

244 
	`ev_buf_‰ì
(
buf
);

246  
°©us
;

247 
	}
}

249 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀApsLökKeyAuthCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
)

251 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

252 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îsToExem±
 * (
u16
);

254 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

255 if(!
buf
){

256  
ZCL_STA_INSUFFICIENT_SPACE
;

259 
u8
 *
pBuf
 = 
buf
;

261 *
pBuf
++ = 
pCmd
->
numOfClu°îsToExem±
;

262 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îsToExem±
; i++){

263 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

264 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

267 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_APS_LINK_KEY_AUTH
, 
TRUE
,

268 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

270 
	`ev_buf_‰ì
(
buf
);

272  
°©us
;

273 
	}
}

275 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_≠sLökKeyAuthQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_≠sLökKeyAuthQuîyCmd_t
 *
pCmd
)

277 
u8
 
buf
[2];

278 
u8
 *
pBuf
 = 
buf
;

280 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
˛u°îID
);

281 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
˛u°îID
);

283  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY
, 
TRUE
,

284 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

285 
	}
}

287 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ªque°NewApsLökKeyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

289  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_REQUEST_NEW_APS_LINK_KEY
, 
TRUE
,

290 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

291 
	}
}

293 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd_t
 *
pCmd
)

295 
u8
 
buf
[7];

296 
u8
 *
pBuf
 = 
buf
;

298 *
pBuf
++ = 
pCmd
->
fú°BackoffTimeInSec⁄ds
;

299 *
pBuf
++ = 
pCmd
->
backoffSequí˚Comm⁄R©io
;

300 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

301 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

302 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

303 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

304 *
pBuf
++ = 
pCmd
->
maxReDñivîyAâïts
;

306  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_APP_EVT_RETRY_ALGORITHM
, 
TRUE
,

307 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 7, 
buf
);

308 
	}
}

310 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀAµEvtRëryAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

312  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_APP_EVT_RETRY_ALGORITHM
, 
TRUE
,

313 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

314 
	}
}

316 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ªque°TimeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

318  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_REQUEST_TIME
, 
TRUE
,

319 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

320 
	}
}

322 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀRejoöAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀRejoöAlg‹ôhmCmd_t
 *
pCmd
)

324 
u8
 
buf
[10];

325 
u8
 *
pBuf
 = 
buf
;

327 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
Á°RejoöTimeoutInSec⁄ds
);

328 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
Á°RejoöTimeoutInSec⁄ds
);

329 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
duøti⁄BëwìnEachRejoöInSec⁄ds
);

330 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
duøti⁄BëwìnEachRejoöInSec⁄ds
);

331 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
Á°RejoöFú°BackoffInSec⁄ds
);

332 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
Á°RejoöFú°BackoffInSec⁄ds
);

333 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

334 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
maxBackoffTimeInSec⁄ds
);

335 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
maxBackoffIãøti⁄s
);

336 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
maxBackoffIãøti⁄s
);

338  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_REJOIN_ALGORITHM
, 
TRUE
,

339 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 10, 
buf
);

340 
	}
}

342 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀRejoöAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

344  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_REJOIN_ALGORITHM
, 
TRUE
,

345 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

346 
	}
}

348 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd_t
 *
pCmd
)

350 
u8
 
buf
[1];

352 
buf
[0] = (
u8
)
pCmd
->
írﬁlmítMode
;

354  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SET_IAS_ZONE_ENROLLMENT_METHOD
, 
TRUE
,

355 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

356 
	}
}

358 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_˛órBödögTabÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

360  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_CLEAR_BINDING_TABLE
, 
TRUE
,

361 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

362 
	}
}

364 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀPîiodicRouãrCheckInsCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
 *
pCmd
)

366 
u8
 
buf
[2];

367 
u8
 *
pBuf
 = 
buf
;

369 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
checkInI¡îvÆ
);

370 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
checkInI¡îvÆ
);

372  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_PERIODIC_ROUTER_CHECK_INS
, 
TRUE
,

373 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

374 
	}
}

376 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀPîiodicRouãrCheckInsCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

378  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_PERIODIC_ROUTER_CHECK_INS
, 
TRUE
,

379 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

380 
	}
}

382 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd_t
 *
pCmd
)

384 
u8
 
buf
[1];

386 
buf
[0] = 
pCmd
->
waôTime
;

388  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SET_MAC_POLL_FAILURE_WAIT_TIME
, 
TRUE
,

389 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

390 
	}
}

392 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_£tPídögNwkUpd©eCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tPídögNwkUpd©eCmd_t
 *
pCmd
)

394 
u8
 
buf
[3];

395 
u8
 *
pBuf
 = 
buf
;

397 *
pBuf
++ = 
pCmd
->
ch™√l
;

398 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
∑nID
);

399 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
∑nID
);

401  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SET_PENDING_NWK_UPDATE
, 
TRUE
,

402 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 3, 
buf
);

403 
	}
}

405 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ªquúeApsAcksOnUniˇ°sCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
)

407 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

408 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îsToExem±
 * (
u16
);

410 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

411 if(!
buf
){

412  
ZCL_STA_INSUFFICIENT_SPACE
;

415 
u8
 *
pBuf
 = 
buf
;

417 *
pBuf
++ = 
pCmd
->
numOfClu°îsToExem±
;

418 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îsToExem±
; i++){

419 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

420 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

423 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_REQUIRE_APS_ACKS_ON_UNICASTS
, 
TRUE
,

424 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

426 
	`ev_buf_‰ì
(
buf
);

428  
°©us
;

429 
	}
}

431 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

433  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_REMOVE_APS_ACKS_ON_UNICASTS_REQUIREMENT
, 
TRUE
,

434 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

435 
	}
}

437 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_≠sAckRequúemítQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

439  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY
, 
TRUE
,

440 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

441 
	}
}

443 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_debugRï‹tQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_debugRï‹tQuîyCmd_t
 *
pCmd
)

445 
u8
 
buf
[1];

447 
buf
[0] = 
pCmd
->
debugRï‹tID
;

449  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DEBUG_REPORT_QUERY
, 
TRUE
,

450 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

451 
	}
}

453 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_surveyBóc⁄sCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_surveyBóc⁄sCmd_t
 *
pCmd
)

455 
u8
 
buf
[1];

457 
buf
[0] = 
pCmd
->
°™d¨dBóc⁄s
;

459  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SURVEY_BEACONS
, 
TRUE
,

460 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 1, 
buf
);

461 
	}
}

463 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀOèDowngødesCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

465  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_OTA_DOWNGRADES
, 
TRUE
,

466 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

467 
	}
}

469 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀMgmtLóveWôhoutRejoöCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

471  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
, 
TRUE
,

472 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

473 
	}
}

475 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀTouchlökI¡î∑nMsgCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

477  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_TOUCHLINK_INTERPAN_MSG_SUPPORT
, 
TRUE
,

478 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

479 
	}
}

481 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀP¨ítCœssifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

483  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_PARENT_CLASSIFICATION
, 
TRUE
,

484 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

485 
	}
}

487 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀP¨ítCœssifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

489  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_PARENT_CLASSIFICATION
, 
TRUE
,

490 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

491 
	}
}

493 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀTcSecurôyOnNwkKeyRŸ©i⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

495  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_TC_SECURITY_ON_NWK_KEY_ROTATION
, 
TRUE
,

496 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

497 
	}
}

499 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀBadP¨ítRecovîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

501  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_BAD_PARENT_RECOVERY
, 
TRUE
,

502 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

503 
	}
}

505 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀBadP¨ítRecovîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

507  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_BAD_PARENT_RECOVERY
, 
TRUE
,

508 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

509 
	}
}

511 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_íabÀC⁄figuøti⁄ModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

513  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_ENABLE_CONFIGURATION_MODE
, 
TRUE
,

514 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

515 
	}
}

517 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_dißbÀC⁄figuøti⁄ModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

519  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DISABLE_CONFIGURATION_MODE
, 
TRUE
,

520 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

521 
	}
}

523 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_u£Tru°CíãrF‹Clu°îCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_u£Tru°CíãrF‹Clu°îCmd_t
 *
pCmd
)

525 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

526 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îs
 * (
u16
);

528 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

529 if(!
buf
){

530  
ZCL_STA_INSUFFICIENT_SPACE
;

533 
u8
 *
pBuf
 = 
buf
;

535 *
pBuf
++ = 
pCmd
->
numOfClu°îs
;

536 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îs
; i++){

537 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

538 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

541 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_USE_TRUST_CENTER_FOR_CLUSTER
, 
TRUE
,

542 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

544 
	`ev_buf_‰ì
(
buf
);

546  
°©us
;

547 
	}
}

549 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
)

551  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY
, 
TRUE
,

552 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 0, 
NULL
);

553 
	}
}

555 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_≠sLökKeyAuthQuîyR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_≠sLökKeyAuthQuîyR•Cmd_t
 *
pCmd
)

557 
u8
 
buf
[3];

558 
u8
 *
pBuf
 = 
buf
;

560 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
˛u°îID
);

561 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
˛u°îID
);

562 *
pBuf
++ = 
pCmd
->
°©us
;

564  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY_RSP
, 
TRUE
,

565 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 3, 
buf
);

566 
	}
}

568 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_powîögOffNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîögNŸifiˇti⁄Cmd_t
 *
pCmd
)

570 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

571 
u8
 
Àn
 = 4 + 
pCmd
->
m™uPowîNŸiRós⁄Lí
;

573 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

574 if(!
buf
){

575  
ZCL_STA_INSUFFICIENT_SPACE
;

578 
u8
 *
pBuf
 = 
buf
;

580 *
pBuf
++ = (
u8
)
pCmd
->
powîNŸiRós⁄
;

581 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
m™uID
);

582 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
m™uID
);

583 *
pBuf
++ = 
pCmd
->
m™uPowîNŸiRós⁄Lí
;

584 if(
pCmd
->
m™uPowîNŸiRós⁄Lí
){

585 
	`mem˝y
(
pBuf
, 
pCmd
->
pM™uPowîNŸiRós⁄
,ÖCmd->
m™uPowîNŸiRós⁄Lí
);

586 
pBuf
 +
pCmd
->
m™uPowîNŸiRós⁄Lí
;

589 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_POWERING_OFF_NOTIFICATION
, 
TRUE
,

590 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

592 
	`ev_buf_‰ì
(
buf
);

594  
°©us
;

595 
	}
}

597 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_powîögOnNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîögNŸifiˇti⁄Cmd_t
 *
pCmd
)

599 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

600 
u8
 
Àn
 = 4 + 
pCmd
->
m™uPowîNŸiRós⁄Lí
;

602 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

603 if(!
buf
){

604  
ZCL_STA_INSUFFICIENT_SPACE
;

607 
u8
 *
pBuf
 = 
buf
;

609 *
pBuf
++ = (
u8
)
pCmd
->
powîNŸiRós⁄
;

610 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
m™uID
);

611 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
m™uID
);

612 *
pBuf
++ = 
pCmd
->
m™uPowîNŸiRós⁄Lí
;

613 if(
pCmd
->
m™uPowîNŸiRós⁄Lí
){

614 
	`mem˝y
(
pBuf
, 
pCmd
->
pM™uPowîNŸiRós⁄
,ÖCmd->
m™uPowîNŸiRós⁄Lí
);

615 
pBuf
 +
pCmd
->
m™uPowîNŸiRós⁄Lí
;

618 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_POWERING_ON_NOTIFICATION
, 
TRUE
,

619 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

621 
	`ev_buf_‰ì
(
buf
);

623  
°©us
;

624 
	}
}

626 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_sh‹tAddrCh™geCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_sh‹tAddrCh™geCmd_t
 *
pCmd
)

628 
u8
 
buf
[10];

629 
u8
 *
pBuf
 = 
buf
;

631 
	`ZB_64BIT_ADDR_COPY
(
pBuf
, 
pCmd
->
devi˚EUI64
);

632 
pBuf
 +
EXT_ADDR_LEN
;

633 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
devi˚Sh‹t
);

634 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
devi˚Sh‹t
);

636  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SHORT_ADDRESS_CHANGE
, 
TRUE
,

637 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 10, 
buf
);

638 
	}
}

640 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_≠sAckRequúemítQuîyR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
)

642 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

643 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îsToExem±
 * (
u16
);

645 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

646 if(!
buf
){

647  
ZCL_STA_INSUFFICIENT_SPACE
;

650 
u8
 *
pBuf
 = 
buf
;

652 *
pBuf
++ = 
pCmd
->
numOfClu°îsToExem±
;

653 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îsToExem±
; i++){

654 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

655 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

658 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY_RSP
, 
TRUE
,

659 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

661 
	`ev_buf_‰ì
(
buf
);

663  
°©us
;

664 
	}
}

666 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_powîDes¸ùt‹Ch™geCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîDescCh™geCmd_t
 *
pCmd
)

668 
u8
 
buf
[2];

669 
u8
 *
pBuf
 = 
buf
;

671 *
pBuf
++ = (
pCmd
->
cuºítPowîMode
 << 4Ë+ÖCmd->
avaûabÀPowîSrcs
;

672 *
pBuf
++ = (
pCmd
->
cuºítPowîSrc
 << 4Ë+ÖCmd->
cuºítPowîSrcLevñ
;

674  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_POWER_DESCRIPTOR_CHANGE
, 
TRUE
,

675 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 2, 
buf
);

676 
	}
}

678 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_√wDebugRï‹tNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_√wDbgRï‹tNŸiCmd_t
 *
pCmd
)

680 
u8
 
buf
[5];

681 
u8
 *
pBuf
 = 
buf
;

683 *
pBuf
++ = 
pCmd
->
dbgRï‹tID
;

684 *
pBuf
++ = 
	`U32_BYTE0
(
pCmd
->
sizeOfRï‹t
);

685 *
pBuf
++ = 
	`U32_BYTE1
(
pCmd
->
sizeOfRï‹t
);

686 *
pBuf
++ = 
	`U32_BYTE2
(
pCmd
->
sizeOfRï‹t
);

687 *
pBuf
++ = 
	`U32_BYTE3
(
pCmd
->
sizeOfRï‹t
);

689  
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_NEW_DEBUG_REPORT_NOTIFICATION
, 
TRUE
,

690 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 5, 
buf
);

691 
	}
}

693 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_debugRï‹tQuîyR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
m™uCode
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_dbgRï‹tQuîyR•Cmd_t
 *
pCmd
)

695 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

696 
u8
 
Àn
 = 1 + 
pCmd
->
ªp‹tD©aLí
;

698 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

699 if(!
buf
){

700  
ZCL_STA_INSUFFICIENT_SPACE
;

703 
u8
 *
pBuf
 = 
buf
;

705 *
pBuf
++ = 
pCmd
->
dbgRï‹tID
;

706 if(
pCmd
->
ªp‹tD©aLí
){

707 
	`mem˝y
(
pBuf
, 
pCmd
->
pRï‹tD©a
,ÖCmd->
ªp‹tD©aLí
);

708 
pBuf
 +
pCmd
->
ªp‹tD©aLí
;

711 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_DEBUG_REPORT_QUERY_RSP
, 
TRUE
,

712 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 
m™uCode
, 
£qNo
, 
Àn
, 
buf
);

714 
	`ev_buf_‰ì
(
buf
);

716  
°©us
;

717 
	}
}

719 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, 
u16
 
m™ufCode
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_tcF‹Clu°îSîvîQuîyR•Cmd_t
 *
pCmd
)

721 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

722 
u8
 
Àn
 = 1 + 
pCmd
->
numOfClu°îs
 * (
u16
);

724 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

725 if(!
buf
){

726  
ZCL_STA_INSUFFICIENT_SPACE
;

729 
u8
 *
pBuf
 = 
buf
;

731 *
pBuf
++ = 
pCmd
->
numOfClu°îs
;

732 
u8
 
i
 = 0; i < 
pCmd
->
numOfClu°îs
; i++){

733 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pClu°îID
[
i
]);

734 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pClu°îID
[
i
]);

737 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY_RSP
, 
TRUE
,

738 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 
m™ufCode
, 
£qNo
, 
Àn
, 
buf
);

740 
	`ev_buf_‰ì
(
buf
);

742  
°©us
;

743 
	}
}

745 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_surveyBóc⁄sR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_surveyBóc⁄sR•Cmd_t
 *
pCmd
)

747 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

748 
u8
 
Àn
 = 1 + 
pCmd
->
numOfBóc⁄s
 * 4;

750 
u8
 *
buf
 = (u8 *)
	`ev_buf_Æloˇã
(
Àn
);

751 if(!
buf
){

752  
ZCL_STA_INSUFFICIENT_SPACE
;

755 
u8
 *
pBuf
 = 
buf
;

757 *
pBuf
++ = 
pCmd
->
numOfBóc⁄s
;

758 
u8
 
i
 = 0; i < 
pCmd
->
numOfBóc⁄s
; i++){

759 *
pBuf
++ = 
	`LO_UINT16
(
pCmd
->
pBóc⁄
[
i
].
devi˚Sh‹t
);

760 *
pBuf
++ = 
	`HI_UINT16
(
pCmd
->
pBóc⁄
[
i
].
devi˚Sh‹t
);

761 *
pBuf
++ = 
pCmd
->
pBóc⁄
[
i
].
rssi
;

762 *
pBuf
++ = 
pCmd
->
pBóc⁄
[
i
].
˛assifiˇti⁄Mask
;

765 
°©us
 = 
	`z˛_£ndCmd
(
§cEp
, 
pD°EpInfo
, 
ZCL_CLUSTER_WWAH
, 
ZCL_CMD_WWAH_SURVEY_BEACONS_RSP
, 
TRUE
,

766 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
dißbÀDeÁu…R•
, 0, 
£qNo
, 
Àn
, 
buf
);

768 
	`ev_buf_‰ì
(
buf
);

770  
°©us
;

771 
	}
}

775 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_˛u°îsToExem±Prc
(
z˛Incomög_t
 *
pInMsg
)

777 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

778 
u8
 *
pD©a
 = 
pInMsg
->pData;

780 if–(
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
) ||

781 (
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_DISABLE_APS_LINK_KEY_AUTH
) ){

782 if(!(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)){

783  
ZCL_STA_NOT_AUTHORIZED
;

787 if–(
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
) ||

788 (
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_DISABLE_APS_LINK_KEY_AUTH
) ){

789 
g_z˛_≠sLökKeyAuthInfo
.
°©us
 = (
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
Ë? 
APS_LINK_KEY_AUTH_ENABLE


790 : 
APS_LINK_KEY_AUTH_DISABLE
;

791 
g_z˛_≠sLökKeyAuthInfo
.
num
 = *
pD©a
++;

792 
g_z˛_≠sLökKeyAuthInfo
.
num
 = (g_z˛_≠sLökKeyAuthInfo.num > 
CLUSTER_ID_MAX_NUM
) ? CLUSTER_ID_MAX_NUM

793 : 
g_z˛_≠sLökKeyAuthInfo
.
num
;

794 
u8
 
i
 = 0; i < 
g_z˛_≠sLökKeyAuthInfo
.
num
; i++){

795 
g_z˛_≠sLökKeyAuthInfo
.
˛u°îID
[
i
] = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

796 
pD©a
 += 2;

799 
	`TL_SCHEDULE_TASK
(
z˛_wwah_≠sLökKeyAuthInfoSave
, 
NULL
);

800 }if(
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_REQUIRE_APS_ACKS_ON_UNICASTS
){

801 
g_z˛_≠sAcksRequúeInfo
.
num
 = *
pD©a
++;

802 
g_z˛_≠sAcksRequúeInfo
.
num
 = (g_z˛_≠sAcksRequúeInfo.num > 
CLUSTER_ID_MAX_NUM
) ? CLUSTER_ID_MAX_NUM

803 : 
g_z˛_≠sAcksRequúeInfo
.
num
;

804 
u8
 
i
 = 0; i < 
g_z˛_≠sAcksRequúeInfo
.
num
; i++){

805 
g_z˛_≠sAcksRequúeInfo
.
˛u°îID
[
i
] = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

806 
pD©a
 += 2;

809 
	`TL_SCHEDULE_TASK
(
z˛_wwah_≠sAcksRequúeInfoSave
, 
NULL
);

812  
°©us
;

813 
	}
}

815 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_≠sLökKeyAuthQuîyPrc
(
z˛Incomög_t
 *
pInMsg
)

817 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

818 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

819 
u8
 *
pD©a
 = 
pInMsg
->pData;

821 if(
	`UNICAST_MSG
(
pApsdeInd
)){

822 
z˛_wwah_≠sLökKeyAuthQuîyR•Cmd_t
 
quîyR•
;

824 
quîyR•
.
˛u°îID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

825 
quîyR•
.
°©us
 = (
boﬁ
)
	`z˛_wwah_≠sLökKeyAuthSórch
(quîyR•.
˛u°îID
);

827 
ïInfo_t
 
d°Ep
;

828 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

830 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

831 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

832 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

833 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

834 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

835 if(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
){

836 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

839 
°©us
 = 
	`z˛_wwah_≠sLökKeyAuthQuîyR•Cmd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
pInMsg
->
hdr
.
m™ufCode
, 
TRUE
,ÖInMsg->hdr.
£qNum
, &
quîyR•
);

841 if(
°©us
 =
ZCL_STA_SUCCESS
){

842 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

846  
°©us
;

847 
	}
}

849 
_CODE_ZCL_
 
u8
 
	$z˛_cmdNoPaylﬂdPrc
(
z˛Incomög_t
 *
pInMsg
)

851 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

852 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

854 if–(
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_DISABLE_PERIODIC_ROUTER_CHECK_INS
) ||

855 (
pInMsg
->
hdr
.
cmd
 =
ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
) ){

856 if(!(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)){

857  
ZCL_STA_NOT_AUTHORIZED
;

861 if(
	`UNICAST_MSG
(
pApsdeInd
)){

862 if(
pInMsg
->
˛u°îAµCb
){

865 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

867 
°©us
 = 
ZCL_STA_FAILURE
;

871  
°©us
;

872 
	}
}

874 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_íabÀAµEvtRëryAlg‹ôhmPrc
(
z˛Incomög_t
 *
pInMsg
)

876 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

877 
u8
 *
pD©a
 = 
pInMsg
->pData;

879 if(
pInMsg
->
˛u°îAµCb
){

880 
z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd_t
 
cmd
;

881 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

883 
cmd
.
fú°BackoffTimeInSec⁄ds
 = *
pD©a
++;

884 
cmd
.
backoffSequí˚Comm⁄R©io
 = *
pD©a
++;

885 
cmd
.
maxBackoffTimeInSec⁄ds
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

886 
pD©a
 += 4;

887 
cmd
.
maxReDñivîyAâïts
 = *
pD©a
++;

889 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

891 
°©us
 = 
ZCL_STA_FAILURE
;

894  
°©us
;

895 
	}
}

897 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_íabÀRejoöAlg‹ôhmPrc
(
z˛Incomög_t
 *
pInMsg
)

899 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

900 
u8
 *
pD©a
 = 
pInMsg
->pData;

902 if(
pInMsg
->
˛u°îAµCb
){

903 
z˛_wwah_íabÀRejoöAlg‹ôhmCmd_t
 
cmd
;

904 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

906 
cmd
.
Á°RejoöTimeoutInSec⁄ds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

907 
pD©a
 += 2;

908 
cmd
.
duøti⁄BëwìnEachRejoöInSec⁄ds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

909 
pD©a
 += 2;

910 
cmd
.
Á°RejoöFú°BackoffInSec⁄ds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

911 
pD©a
 += 2;

912 
cmd
.
maxBackoffTimeInSec⁄ds
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

913 
pD©a
 += 2;

914 
cmd
.
maxBackoffIãøti⁄s
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

915 
pD©a
 += 2;

917 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

919 
°©us
 = 
ZCL_STA_FAILURE
;

922  
°©us
;

923 
	}
}

925 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodPrc
(
z˛Incomög_t
 *
pInMsg
)

927 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

928 
u8
 *
pD©a
 = 
pInMsg
->pData;

930 if(
pInMsg
->
˛u°îAµCb
){

931 
z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd_t
 
cmd
;

932 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

934 
cmd
.
írﬁlmítMode
 = *
pD©a
++;

936 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

938 
°©us
 = 
ZCL_STA_FAILURE
;

941  
°©us
;

942 
	}
}

944 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_˛órBödögTabÀPrc
(
z˛Incomög_t
 *
pInMsg
)

946 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

947 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

954 if(
	`UNICAST_MSG
(
pApsdeInd
)){

955 
	`≠s_bödögTab_˛ór
();

958  
°©us
;

959 
	}
}

961 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_íabÀPîiodicRouãrCheckInsPrc
(
z˛Incomög_t
 *
pInMsg
)

963 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

964 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

965 
u8
 *
pD©a
 = 
pInMsg
->pData;

967 if(!(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)){

968  
ZCL_STA_NOT_AUTHORIZED
;

971 if(
	`UNICAST_MSG
(
pApsdeInd
)){

972 if(
pInMsg
->
˛u°îAµCb
){

973 
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
 
cmd
;

975 
cmd
.
checkInI¡îvÆ
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

977 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

979 
°©us
 = 
ZCL_STA_FAILURE
;

983  
°©us
;

984 
	}
}

986 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_£tMacPﬁlFaûuªWaôTimePrc
(
z˛Incomög_t
 *
pInMsg
)

988 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

989 
u8
 *
pD©a
 = 
pInMsg
->pData;

991 if(
pInMsg
->
˛u°îAµCb
){

992 
z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd_t
 
cmd
;

993 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

995 
cmd
.
waôTime
 = *
pD©a
++;

997 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

999 
°©us
 = 
ZCL_STA_FAILURE
;

1002  
°©us
;

1003 
	}
}

1005 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_£tPídögNwkUpd©ePrc
(
z˛Incomög_t
 *
pInMsg
)

1007 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1008 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1009 
u8
 *
pD©a
 = 
pInMsg
->pData;

1011 if(!(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)){

1012  
ZCL_STA_NOT_AUTHORIZED
;

1015 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1016 if(
pInMsg
->
˛u°îAµCb
){

1017 
z˛_wwah_£tPídögNwkUpd©eCmd_t
 
cmd
;

1018 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1020 
cmd
.
ch™√l
 = *
pD©a
++;

1021 
cmd
.
∑nID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1023 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1025 
°©us
 = 
ZCL_STA_FAILURE
;

1029  
°©us
;

1030 
	}
}

1032 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítPrc
(
z˛Incomög_t
 *
pInMsg
)

1034 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1035 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1037 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1038 
	`z˛_wwah_≠sAcksRequúeInfoCÀ¨
();

1039 
	`TL_SCHEDULE_TASK
(
z˛_wwah_≠sAcksRequúeInfoSave
, 
NULL
);

1042  
°©us
;

1043 
	}
}

1045 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_≠sAckRequúemítQuîyPrc
(
z˛Incomög_t
 *
pInMsg
)

1047 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1048 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1050 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1051 
˛u°îsToExem±_t
 
˛u°îsToExem±
;

1052 
	`TL_SETSTRUCTCONTENT
(
˛u°îsToExem±
, 0);

1054 
˛u°îsToExem±
.
numOfClu°îsToExem±
 = 
g_z˛_≠sAcksRequúeInfo
.
num
;

1055 
˛u°îsToExem±
.
pClu°îID
 = 
g_z˛_≠sAcksRequúeInfo
.
˛u°îID
;

1057 
ïInfo_t
 
d°Ep
;

1058 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1060 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1061 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

1062 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

1063 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

1064 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1065 if(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
){

1066 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1069 
°©us
 = 
	`z˛_wwah_≠sAckRequúemítQuîyR•Cmd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
pInMsg
->
hdr
.
m™ufCode
, 
TRUE
,ÖInMsg->hdr.
£qNum
, &
˛u°îsToExem±
);

1071 if(
°©us
 =
ZCL_STA_SUCCESS
){

1072 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1076  
°©us
;

1077 
	}
}

1079 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_debugRï‹tQuîyPrc
(
z˛Incomög_t
 *
pInMsg
)

1081 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1082 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1083 
u8
 *
pD©a
 = 
pInMsg
->pData;

1085 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1086 
u8
 
curDbgRï‹tID
;

1087 
u16
 
Àn
;

1089 if(
	`z˛_gëAârVÆ
(
pApsdeInd
->
ödInfo
.
d°_ï
, 
ZCL_CLUSTER_WWAH
, 
ZCL_ATTRID_WWAH_CURRENT_DEBUG_REPORT_ID
, &
Àn
, (
u8
 *)&
curDbgRï‹tID
Ë!
ZCL_STA_SUCCESS
){

1090  
ZCL_STA_NOT_FOUND
;

1093 
u8
 
debugRï‹tID
 = *
pD©a
++;

1095 if(
debugRï‹tID
 !
curDbgRï‹tID
){

1096  
ZCL_STA_NOT_FOUND
;

1099 
u8
 
ªp‹tBuf
[] = "TEST\0";

1100 
z˛_wwah_dbgRï‹tQuîyR•Cmd_t
 
dbgRï‹tQuîyR•Cmd
;

1101 
	`TL_SETSTRUCTCONTENT
(
dbgRï‹tQuîyR•Cmd
, 0);

1103 
dbgRï‹tQuîyR•Cmd
.
dbgRï‹tID
 = 
debugRï‹tID
;

1104 
dbgRï‹tQuîyR•Cmd
.
ªp‹tD©aLí
 = (
ªp‹tBuf
);

1105 
dbgRï‹tQuîyR•Cmd
.
pRï‹tD©a
 = 
ªp‹tBuf
;

1107 
ïInfo_t
 
d°Ep
;

1108 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1110 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1111 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

1112 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

1113 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

1114 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1115 if(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
){

1116 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1119 
	`z˛_wwah_debugRï‹tQuîyR•Cmd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
pInMsg
->
hdr
.
m™ufCode
, 
TRUE
,ÖInMsg->hdr.
£qNum
, &
dbgRï‹tQuîyR•Cmd
);

1121 if(
°©us
 =
ZCL_STA_SUCCESS
){

1122 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1126  
°©us
;

1127 
	}
}

1129 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_surveyBóc⁄sPrc
(
z˛Incomög_t
 *
pInMsg
)

1131 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1132 
u8
 *
pD©a
 = 
pInMsg
->pData;

1134 if(
pInMsg
->
˛u°îAµCb
){

1135 
z˛_wwah_surveyBóc⁄sCmd_t
 
cmd
;

1136 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1138 
cmd
.
°™d¨dBóc⁄s
 = *
pD©a
++;

1140 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1142 
°©us
 = 
ZCL_STA_FAILURE
;

1145  
°©us
;

1146 
	}
}

1152 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_dißbÀMgmtLóveWôhoutRejoöPrc
(
z˛Incomög_t
 *
pInMsg
)

1154 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1155 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1157 if(!(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
)){

1158  
ZCL_STA_NOT_AUTHORIZED
;

1161 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1162 if(
pInMsg
->
˛u°îAµCb
){

1165 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, 
NULL
);

1167 
°©us
 = 
ZCL_STA_FAILURE
;

1171  
°©us
;

1172 
	}
}

1175 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_u£Tru°CíãrF‹Clu°îPrc
(
z˛Incomög_t
 *
pInMsg
)

1177 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1178 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1179 
u8
 *
pD©a
 = 
pInMsg
->pData;

1181 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1182 
wwah_u£TCF‹Clu°îInfo_t
 
u£TCF‹Clu°îInfo
;

1183 
	`TL_SETSTRUCTCONTENT
(
u£TCF‹Clu°îInfo
, 0);

1185 
u8
 
numOfClu°î
 = *
pD©a
++;

1186 
numOfClu°î
 = (numOfClu°î > 
CLUSTER_ID_MAX_NUM
) ? CLUSTER_ID_MAX_NUM :ÇumOfCluster;

1188 
˛u°îInfo_t
 *
pClu°î
 = 
NULL
;

1189 
u8
 
i
 = 0; i < 
numOfClu°î
; i++){

1190 
pClu°î
 = 
	`z˛_födClu°î
(
pApsdeInd
->
ödInfo
.
d°_ï
, 
	`BUILD_U16
(
pD©a
[0],ÖData[1]));

1191 if(
pClu°î
){

1192 
u£TCF‹Clu°îInfo
.
˛u°îID
[u£TCF‹Clu°îInfo.
num
++] = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1194 
pD©a
 += 2;

1197 
g_z˛_u£TCF‹Clu°îInfo
.
num
 = 
u£TCF‹Clu°îInfo
.num;

1198 
u8
 
i
 = 0; i < 
u£TCF‹Clu°îInfo
.
num
; i++){

1199 
g_z˛_u£TCF‹Clu°îInfo
.
˛u°îID
[
i
] = 
u£TCF‹Clu°îInfo
.clusterID[i];

1202 
	`TL_SCHEDULE_TASK
(
z˛_wwah_u£TCF‹Clu°îInfoSave
, 
NULL
);

1204 if(
pInMsg
->
˛u°îAµCb
 && 
u£TCF‹Clu°îInfo
.
num
){

1205 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &
g_z˛_u£TCF‹Clu°îInfo
);

1209  
°©us
;

1210 
	}
}

1212 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyPrc
(
z˛Incomög_t
 *
pInMsg
)

1214 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1215 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

1217 if(
	`UNICAST_MSG
(
pApsdeInd
)){

1218 
z˛_wwah_tcF‹Clu°îSîvîQuîyR•Cmd_t
 
tcF‹Clu°îSîvîQuîyR•Cmd
;

1219 
	`TL_SETSTRUCTCONTENT
(
tcF‹Clu°îSîvîQuîyR•Cmd
, 0);

1221 
tcF‹Clu°îSîvîQuîyR•Cmd
.
numOfClu°îs
 = 
g_z˛_u£TCF‹Clu°îInfo
.
num
;

1222 
tcF‹Clu°îSîvîQuîyR•Cmd
.
pClu°îID
 = 
g_z˛_u£TCF‹Clu°îInfo
.
˛u°îID
;

1224 
ïInfo_t
 
d°Ep
;

1225 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

1227 
d°Ep
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

1228 
d°Ep
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

1229 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

1230 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

1231 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_ACK_TX
;

1232 if(
pInMsg
->
msg
->
ödInfo
.
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
){

1233 
d°Ep
.
txO±i⁄s
 |
APS_TX_OPT_SECURITY_ENABLED
;

1236 
°©us
 = 
	`z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyR•Cmd
(
pApsdeInd
->
ödInfo
.
d°_ï
, &
d°Ep
, 
pInMsg
->
hdr
.
m™ufCode
, 
TRUE
,ÖInMsg->hdr.
£qNum
, &
tcF‹Clu°îSîvîQuîyR•Cmd
);

1238 if(
°©us
 =
ZCL_STA_SUCCESS
){

1239 
°©us
 = 
ZCL_STA_CMD_HAS_RESP
;

1243  
°©us
;

1244 
	}
}

1246 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_≠sLökKeyAuthQuîyR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1248 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1249 
u8
 *
pD©a
 = 
pInMsg
->pData;

1251 if(
pInMsg
->
˛u°îAµCb
){

1252 
z˛_wwah_≠sLökKeyAuthQuîyR•Cmd_t
 
cmd
;

1253 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1255 
cmd
.
˛u°îID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1256 
pD©a
 += 2;

1257 
cmd
.
°©us
 = *
pD©a
++;

1259 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1261 
°©us
 = 
ZCL_STA_FAILURE
;

1264  
°©us
;

1265 
	}
}

1267 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_powîögNŸifiˇti⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

1269 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1270 
u8
 *
pD©a
 = 
pInMsg
->pData;

1272 if(
pInMsg
->
˛u°îAµCb
){

1273 
z˛_wwah_powîögNŸifiˇti⁄Cmd_t
 
cmd
;

1274 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1276 
cmd
.
powîNŸiRós⁄
 = *
pD©a
++;

1277 
cmd
.
m™uID
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1278 
pD©a
 += 2;

1279 
cmd
.
m™uPowîNŸiRós⁄Lí
 = *
pD©a
++;

1280 
cmd
.
pM™uPowîNŸiRós⁄
 = cmd.
m™uPowîNŸiRós⁄Lí
 ? 
pD©a
 : 
NULL
;

1282 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1284 
°©us
 = 
ZCL_STA_FAILURE
;

1287  
°©us
;

1288 
	}
}

1290 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_sh‹tAddªssCh™gePrc
(
z˛Incomög_t
 *
pInMsg
)

1292 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1293 
u8
 *
pD©a
 = 
pInMsg
->pData;

1295 if(
pInMsg
->
˛u°îAµCb
){

1296 
z˛_wwah_sh‹tAddrCh™geCmd_t
 
cmd
;

1297 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1299 
	`ZB_64BIT_ADDR_COPY
(
cmd
.
devi˚EUI64
, 
pD©a
);

1300 
pD©a
 +
EXT_ADDR_LEN
;

1301 
cmd
.
devi˚Sh‹t
 = 
	`BUILD_U16
(
pD©a
[0],ÖData[1]);

1302 
pD©a
 += 2;

1304 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1306 
°©us
 = 
ZCL_STA_FAILURE
;

1309  
°©us
;

1310 
	}
}

1312 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_≠sAckRequúemítQuîyR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1314 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1315 
u8
 *
pD©a
 = 
pInMsg
->pData;

1317 if(
pInMsg
->
˛u°îAµCb
){

1318 
˛u°îsToExem±_t
 
cmd
;

1319 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1321 
cmd
.
numOfClu°îsToExem±
 = *
pD©a
++;

1322 
cmd
.
pClu°îID
 = cmd.
numOfClu°îsToExem±
 ? (
u16
 *)
pD©a
 : 
NULL
;

1324 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1326 
°©us
 = 
ZCL_STA_FAILURE
;

1329  
°©us
;

1330 
	}
}

1332 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_powîDes¸ùt‹Ch™gePrc
(
z˛Incomög_t
 *
pInMsg
)

1334 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1335 
u8
 *
pD©a
 = 
pInMsg
->pData;

1337 if(
pInMsg
->
˛u°îAµCb
){

1338 
z˛_wwah_powîDescCh™geCmd_t
 
cmd
;

1339 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1341 
cmd
.
cuºítPowîMode
 = (
pD©a
[0] & 0xf0) >> 4;

1342 
cmd
.
avaûabÀPowîSrcs
 = 
pD©a
[0] & 0x0f;

1343 
cmd
.
cuºítPowîSrc
 = (
pD©a
[1] & 0xf0) >> 4;

1344 
cmd
.
cuºítPowîSrcLevñ
 = 
pD©a
[1] & 0x0f;

1346 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1348 
°©us
 = 
ZCL_STA_FAILURE
;

1351  
°©us
;

1352 
	}
}

1354 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_√wDebugRï‹tNŸifiˇti⁄Prc
(
z˛Incomög_t
 *
pInMsg
)

1356 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1357 
u8
 *
pD©a
 = 
pInMsg
->pData;

1359 if(
pInMsg
->
˛u°îAµCb
){

1360 
z˛_wwah_√wDbgRï‹tNŸiCmd_t
 
cmd
;

1361 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1363 
cmd
.
dbgRï‹tID
 = *
pD©a
++;

1364 
cmd
.
sizeOfRï‹t
 = 
	`BUILD_U32
(
pD©a
[0],ÖData[1],ÖData[2],ÖData[3]);

1365 
pD©a
 += 4;

1367 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1369 
°©us
 = 
ZCL_STA_FAILURE
;

1372  
°©us
;

1373 
	}
}

1375 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_debugRï‹tQuîyR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1377 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1378 
u8
 *
pD©a
 = 
pInMsg
->pData;

1380 if(
pInMsg
->
˛u°îAµCb
){

1381 
z˛_wwah_dbgRï‹tQuîyR•Cmd_t
 
cmd
;

1382 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1384 
cmd
.
dbgRï‹tID
 = *
pD©a
++;

1385 
cmd
.
ªp‹tD©aLí
 = *
pD©a
++;

1386 
cmd
.
pRï‹tD©a
 = cmd.
ªp‹tD©aLí
 ? 
pD©a
 : 
NULL
;

1388 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1390 
°©us
 = 
ZCL_STA_FAILURE
;

1393  
°©us
;

1394 
	}
}

1396 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1398 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1399 
u8
 *
pD©a
 = 
pInMsg
->pData;

1401 if(
pInMsg
->
˛u°îAµCb
){

1402 
z˛_wwah_tcF‹Clu°îSîvîQuîyR•Cmd_t
 
cmd
;

1403 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1405 
cmd
.
numOfClu°îs
 = *
pD©a
++;

1406 
cmd
.
pClu°îID
 = cmd.
numOfClu°îs
 ? (
u16
 *)
pD©a
 : 
NULL
;

1408 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1410 
°©us
 = 
ZCL_STA_FAILURE
;

1413  
°©us
;

1414 
	}
}

1416 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_surveyBóc⁄sR•Prc
(
z˛Incomög_t
 *
pInMsg
)

1418 
°©us_t
 
°©us
 = 
ZCL_STA_SUCCESS
;

1419 
u8
 *
pD©a
 = 
pInMsg
->pData;

1421 if(
pInMsg
->
˛u°îAµCb
){

1422 
z˛_wwah_surveyBóc⁄sR•Cmd_t
 
cmd
;

1423 
	`TL_SETSTRUCTCONTENT
(
cmd
, 0);

1425 
cmd
.
numOfBóc⁄s
 = *
pD©a
++;

1426 
cmd
.
pBóc⁄
 = cmd.
numOfBóc⁄s
 ? (
bóc⁄Survey_t
 *)
pD©a
 : 
NULL
;

1428 
°©us
 = 
pInMsg
->
	`˛u°îAµCb
(&’InMsg->
addrInfo
),ÖInMsg->
hdr
.
cmd
, &cmd);

1430 
°©us
 = 
ZCL_STA_FAILURE
;

1433  
°©us
;

1434 
	}
}

1436 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_˛õ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1438 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1440 
pInMsg
->
hdr
.
cmd
)

1442 
ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
:

1443 
ZCL_CMD_WWAH_DISABLE_APS_LINK_KEY_AUTH
:

1444 
ZCL_CMD_WWAH_REQUIRE_APS_ACKS_ON_UNICASTS
:

1445 
°©us
 = 
	`z˛_wwah_˛u°îsToExem±Prc
(
pInMsg
);

1447 
ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY
:

1448 
°©us
 = 
	`z˛_wwah_≠sLökKeyAuthQuîyPrc
(
pInMsg
);

1450 
ZCL_CMD_WWAH_REQUEST_NEW_APS_LINK_KEY
:

1451 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1453 
ZCL_CMD_WWAH_ENABLE_APP_EVT_RETRY_ALGORITHM
:

1454 
°©us
 = 
	`z˛_wwah_íabÀAµEvtRëryAlg‹ôhmPrc
(
pInMsg
);

1456 
ZCL_CMD_WWAH_DISABLE_APP_EVT_RETRY_ALGORITHM
:

1457 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1459 
ZCL_CMD_WWAH_REQUEST_TIME
:

1460 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1462 
ZCL_CMD_WWAH_ENABLE_REJOIN_ALGORITHM
:

1463 
°©us
 = 
	`z˛_wwah_íabÀRejoöAlg‹ôhmPrc
(
pInMsg
);

1465 
ZCL_CMD_WWAH_DISABLE_REJOIN_ALGORITHM
:

1466 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1468 
ZCL_CMD_WWAH_SET_IAS_ZONE_ENROLLMENT_METHOD
:

1469 
°©us
 = 
	`z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodPrc
(
pInMsg
);

1471 
ZCL_CMD_WWAH_CLEAR_BINDING_TABLE
:

1472 
°©us
 = 
	`z˛_wwah_˛órBödögTabÀPrc
(
pInMsg
);

1474 
ZCL_CMD_WWAH_ENABLE_PERIODIC_ROUTER_CHECK_INS
:

1475 
°©us
 = 
	`z˛_wwah_íabÀPîiodicRouãrCheckInsPrc
(
pInMsg
);

1477 
ZCL_CMD_WWAH_DISABLE_PERIODIC_ROUTER_CHECK_INS
:

1478 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1480 
ZCL_CMD_WWAH_SET_MAC_POLL_FAILURE_WAIT_TIME
:

1481 
°©us
 = 
	`z˛_wwah_£tMacPﬁlFaûuªWaôTimePrc
(
pInMsg
);

1483 
ZCL_CMD_WWAH_SET_PENDING_NWK_UPDATE
:

1484 
°©us
 = 
	`z˛_wwah_£tPídögNwkUpd©ePrc
(
pInMsg
);

1486 
ZCL_CMD_WWAH_REMOVE_APS_ACKS_ON_UNICASTS_REQUIREMENT
:

1487 
°©us
 = 
	`z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítPrc
(
pInMsg
);

1489 
ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY
:

1490 
°©us
 = 
	`z˛_wwah_≠sAckRequúemítQuîyPrc
(
pInMsg
);

1492 
ZCL_CMD_WWAH_DEBUG_REPORT_QUERY
:

1493 
°©us
 = 
	`z˛_wwah_debugRï‹tQuîyPrc
(
pInMsg
);

1495 
ZCL_CMD_WWAH_SURVEY_BEACONS
:

1496 
°©us
 = 
	`z˛_wwah_surveyBóc⁄sPrc
(
pInMsg
);

1498 
ZCL_CMD_WWAH_DISABLE_OTA_DOWNGRADES
:

1499 
ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
:

1500 
ZCL_CMD_WWAH_DISABLE_TOUCHLINK_INTERPAN_MSG_SUPPORT
:

1501 
ZCL_CMD_WWAH_ENABLE_PARENT_CLASSIFICATION
:

1502 
ZCL_CMD_WWAH_DISABLE_PARENT_CLASSIFICATION
:

1503 
ZCL_CMD_WWAH_ENABLE_TC_SECURITY_ON_NWK_KEY_ROTATION
:

1504 
ZCL_CMD_WWAH_ENABLE_BAD_PARENT_RECOVERY
:

1505 
ZCL_CMD_WWAH_DISABLE_BAD_PARENT_RECOVERY
:

1506 
ZCL_CMD_WWAH_ENABLE_CONFIGURATION_MODE
:

1507 
ZCL_CMD_WWAH_DISABLE_CONFIGURATION_MODE
:

1508 
°©us
 = 
	`z˛_cmdNoPaylﬂdPrc
(
pInMsg
);

1510 
ZCL_CMD_WWAH_USE_TRUST_CENTER_FOR_CLUSTER
:

1511 
°©us
 = 
	`z˛_wwah_u£Tru°CíãrF‹Clu°îPrc
(
pInMsg
);

1513 
ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY
:

1514 
°©us
 = 
	`z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyPrc
(
pInMsg
);

1517 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1521  
°©us
;

1522 
	}
}

1524 
_CODE_ZCL_
 
u8
 
	$z˛_wwah_£rvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1526 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

1528 
pInMsg
->
hdr
.
cmd
)

1530 
ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY_RSP
:

1531 
°©us
 = 
	`z˛_wwah_≠sLökKeyAuthQuîyR•Prc
(
pInMsg
);

1533 
ZCL_CMD_WWAH_POWERING_OFF_NOTIFICATION
:

1534 
ZCL_CMD_WWAH_POWERING_ON_NOTIFICATION
:

1535 
°©us
 = 
	`z˛_wwah_powîögNŸifiˇti⁄Prc
(
pInMsg
);

1537 
ZCL_CMD_WWAH_SHORT_ADDRESS_CHANGE
:

1538 
°©us
 = 
	`z˛_wwah_sh‹tAddªssCh™gePrc
(
pInMsg
);

1540 
ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY_RSP
:

1541 
°©us
 = 
	`z˛_wwah_≠sAckRequúemítQuîyR•Prc
(
pInMsg
);

1543 
ZCL_CMD_WWAH_POWER_DESCRIPTOR_CHANGE
:

1544 
°©us
 = 
	`z˛_wwah_powîDes¸ùt‹Ch™gePrc
(
pInMsg
);

1546 
ZCL_CMD_WWAH_NEW_DEBUG_REPORT_NOTIFICATION
:

1547 
°©us
 = 
	`z˛_wwah_√wDebugRï‹tNŸifiˇti⁄Prc
(
pInMsg
);

1549 
ZCL_CMD_WWAH_DEBUG_REPORT_QUERY_RSP
:

1550 
°©us
 = 
	`z˛_wwah_debugRï‹tQuîyR•Prc
(
pInMsg
);

1552 
ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY_RSP
:

1553 
°©us
 = 
	`z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyR•Prc
(
pInMsg
);

1555 
ZCL_CMD_WWAH_SURVEY_BEACONS_RSP
:

1556 
°©us
 = 
	`z˛_wwah_surveyBóc⁄sR•Prc
(
pInMsg
);

1559 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

1563  
°©us
;

1564 
	}
}

1566 
_CODE_ZCL_
 
°©us_t
 
	$z˛_wwah_cmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
)

1568 i‡(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
) {

1569  
	`z˛_wwah_˛õ¡CmdH™dÀr
(
pInMsg
);

1571  
	`z˛_wwah_£rvîCmdH™dÀr
(
pInMsg
);

1573 
	}
}

	@zigbee/zcl/zcl_wwah/zcl_wwah.h

24 #i‚de‡
ZCL_WWAH_H


25 
	#ZCL_WWAH_H


	)

32 
	#ZCL_ATTRID_WWAH_DISABLE_OTA_DOWNGRADES
 0x0002

	)

33 
	#ZCL_ATTRID_WWAH_MGMT_LEAVE_WITHOUT_REJOIN_ENABLED
 0x0003

	)

34 
	#ZCL_ATTRID_WWAH_NWK_RETRY_COUNT
 0x0004

	)

35 
	#ZCL_ATTRID_WWAH_MAC_RETRY_COUNT
 0x0005

	)

36 
	#ZCL_ATTRID_WWAH_ROUTER_CHECK_IN_ENABLED
 0x0006

	)

37 
	#ZCL_ATTRID_WWAH_TOUCHLINK_INTERPAN_ENABLED
 0x0007

	)

38 
	#ZCL_ATTRID_WWAH_PARENT_CLASSIFICATION_ENABLED
 0x0008

	)

39 
	#ZCL_ATTRID_WWAH_APP_EVT_RETRY_ENABLED
 0x0009

	)

40 
	#ZCL_ATTRID_WWAH_APP_EVT_RETRY_QUEUE_SIZE
 0x000A

	)

41 
	#ZCL_ATTRID_WWAH_REJOIN_ENABLED
 0x000B

	)

42 
	#ZCL_ATTRID_WWAH_MAC_POLL_FAILURE_WAIT_TIME
 0x000C

	)

43 
	#ZCL_ATTRID_WWAH_CONFIGURATION_MODE_ENABLED
 0x000D

	)

44 
	#ZCL_ATTRID_WWAH_CURRENT_DEBUG_REPORT_ID
 0x000E

	)

45 
	#ZCL_ATTRID_WWAH_TC_SECURITY_ON_NWK_KEY_ROTATION_ENABLED
 0x000F

	)

46 
	#ZCL_ATTRID_WWAH_BAD_PARENT_RECOVERY_ENABLED
 0x0010

	)

47 
	#ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_CHANNEL
 0x0011

	)

48 
	#ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_PANID
 0x0012

	)

49 
	#ZCL_ATTRID_WWAH_OTA_MAX_OFFLINE_DURATION
 0x0013

	)

55 
	#ZCL_CMD_WWAH_ENABLE_APS_LINK_KEY_AUTH
 0x00

	)

56 
	#ZCL_CMD_WWAH_DISABLE_APS_LINK_KEY_AUTH
 0x01

	)

57 
	#ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY
 0x02

	)

58 
	#ZCL_CMD_WWAH_REQUEST_NEW_APS_LINK_KEY
 0x03

	)

59 
	#ZCL_CMD_WWAH_ENABLE_APP_EVT_RETRY_ALGORITHM
 0x04

	)

60 
	#ZCL_CMD_WWAH_DISABLE_APP_EVT_RETRY_ALGORITHM
 0x05

	)

61 
	#ZCL_CMD_WWAH_REQUEST_TIME
 0x06

	)

62 
	#ZCL_CMD_WWAH_ENABLE_REJOIN_ALGORITHM
 0x07

	)

63 
	#ZCL_CMD_WWAH_DISABLE_REJOIN_ALGORITHM
 0x08

	)

64 
	#ZCL_CMD_WWAH_SET_IAS_ZONE_ENROLLMENT_METHOD
 0x09

	)

65 
	#ZCL_CMD_WWAH_CLEAR_BINDING_TABLE
 0x0A

	)

66 
	#ZCL_CMD_WWAH_ENABLE_PERIODIC_ROUTER_CHECK_INS
 0x0B

	)

67 
	#ZCL_CMD_WWAH_DISABLE_PERIODIC_ROUTER_CHECK_INS
 0x0C

	)

68 
	#ZCL_CMD_WWAH_SET_MAC_POLL_FAILURE_WAIT_TIME
 0x0D

	)

69 
	#ZCL_CMD_WWAH_SET_PENDING_NWK_UPDATE
 0x0E

	)

70 
	#ZCL_CMD_WWAH_REQUIRE_APS_ACKS_ON_UNICASTS
 0x0F

	)

71 
	#ZCL_CMD_WWAH_REMOVE_APS_ACKS_ON_UNICASTS_REQUIREMENT
 0x10

	)

72 
	#ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY
 0x11

	)

73 
	#ZCL_CMD_WWAH_DEBUG_REPORT_QUERY
 0x12

	)

74 
	#ZCL_CMD_WWAH_SURVEY_BEACONS
 0x13

	)

75 
	#ZCL_CMD_WWAH_DISABLE_OTA_DOWNGRADES
 0x14

	)

76 
	#ZCL_CMD_WWAH_DISABLE_MGMT_LEAVE_WITHOUT_REJOIN
 0x15

	)

77 
	#ZCL_CMD_WWAH_DISABLE_TOUCHLINK_INTERPAN_MSG_SUPPORT
 0x16

	)

78 
	#ZCL_CMD_WWAH_ENABLE_PARENT_CLASSIFICATION
 0x17

	)

79 
	#ZCL_CMD_WWAH_DISABLE_PARENT_CLASSIFICATION
 0x18

	)

80 
	#ZCL_CMD_WWAH_ENABLE_TC_SECURITY_ON_NWK_KEY_ROTATION
 0x19

	)

81 
	#ZCL_CMD_WWAH_ENABLE_BAD_PARENT_RECOVERY
 0x1A

	)

82 
	#ZCL_CMD_WWAH_DISABLE_BAD_PARENT_RECOVERY
 0x1B

	)

83 
	#ZCL_CMD_WWAH_ENABLE_CONFIGURATION_MODE
 0x1C

	)

84 
	#ZCL_CMD_WWAH_DISABLE_CONFIGURATION_MODE
 0x1D

	)

85 
	#ZCL_CMD_WWAH_USE_TRUST_CENTER_FOR_CLUSTER
 0x1E

	)

86 
	#ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY
 0x1F

	)

88 
	#ZCL_CMD_WWAH_APS_LINK_KEY_AUTH_QUERY_RSP
 0x00

	)

89 
	#ZCL_CMD_WWAH_POWERING_OFF_NOTIFICATION
 0x01

	)

90 
	#ZCL_CMD_WWAH_POWERING_ON_NOTIFICATION
 0x02

	)

91 
	#ZCL_CMD_WWAH_SHORT_ADDRESS_CHANGE
 0x03

	)

92 
	#ZCL_CMD_WWAH_APS_ACK_REQUIREMENT_QUERY_RSP
 0x04

	)

93 
	#ZCL_CMD_WWAH_POWER_DESCRIPTOR_CHANGE
 0x05

	)

94 
	#ZCL_CMD_WWAH_NEW_DEBUG_REPORT_NOTIFICATION
 0x06

	)

95 
	#ZCL_CMD_WWAH_DEBUG_REPORT_QUERY_RSP
 0x07

	)

96 
	#ZCL_CMD_WWAH_TRUST_CENTER_FOR_CLUSTER_SERVER_QUERY_RSP
 0x08

	)

97 
	#ZCL_CMD_WWAH_SURVEY_BEACONS_RSP
 0x09

	)

101 
u16
 *
	mpClu°îID
;

102 
u8
 
	mnumOfClu°îsToExem±
;

103 }
	t˛u°îsToExem±_t
;

106 
u16
 
	m˛u°îID
;

107 }
	tz˛_wwah_≠sLökKeyAuthQuîyCmd_t
;

110 
u32
 
	mmaxBackoffTimeInSec⁄ds
;

111 
u8
 
	mfú°BackoffTimeInSec⁄ds
;

112 
u8
 
	mbackoffSequí˚Comm⁄R©io
;

113 
u8
 
	mmaxReDñivîyAâïts
;

114 }
	tz˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd_t
;

117 
u16
 
	mÁ°RejoöTimeoutInSec⁄ds
;

118 
u16
 
	mduøti⁄BëwìnEachRejoöInSec⁄ds
;

119 
u16
 
	mÁ°RejoöFú°BackoffInSec⁄ds
;

120 
u16
 
	mmaxBackoffTimeInSec⁄ds
;

121 
u16
 
	mmaxBackoffIãøti⁄s
;

122 }
	tz˛_wwah_íabÀRejoöAlg‹ôhmCmd_t
;

125 
	mTRIP_TO_PAIR
,

126 
	mAUTO_ENROLL_RSP
,

127 
	mAUTO_ENROLL_REQ
,

128 }
	tírﬁlmítMode_t
;

131 
írﬁlmítMode_t
 
	mírﬁlmítMode
;

132 }
	tz˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd_t
;

135 
u16
 
	mcheckInI¡îvÆ
;

136 }
	tz˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
;

139 
u8
 
	mwaôTime
;

140 }
	tz˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd_t
;

143 
u16
 
	m∑nID
;

144 
u8
 
	mch™√l
;

145 }
	tz˛_wwah_£tPídögNwkUpd©eCmd_t
;

148 
u8
 
	mdebugRï‹tID
;

149 }
	tz˛_wwah_debugRï‹tQuîyCmd_t
;

152 
boﬁ
 
	m°™d¨dBóc⁄s
;

153 }
	tz˛_wwah_surveyBóc⁄sCmd_t
;

156 
u16
 *
	mpClu°îID
;

157 
u8
 
	mnumOfClu°îs
;

158 }
	tz˛_wwah_u£Tru°CíãrF‹Clu°îCmd_t
;

161 
u16
 
	m˛u°îID
;

162 
boﬁ
 
	m°©us
;

163 }
	tz˛_wwah_≠sLökKeyAuthQuîyR•Cmd_t
;

166 
	mUNKNOWN
,

167 
	mBATTERY
,

168 
	mBROWNOUT
,

169 
	mWATCHDOG
,

170 
	mRESET_PIN
,

171 
	mMEMORY_OR_HW_FAULT
,

172 
	mSOFTWARE_EXCEPTION
,

173 
	mOTA_OR_BOOTLOAD_SUCCESS
,

174 
	mSOFTWARE_RESET
,

175 
	mPOWER_BUTTON
,

176 
	mTEMPERATURE
,

177 
	mBOOTLOAD_FAILURE
,

178 }
	tpowîNŸiRós⁄_t
;

181 
u8
 *
	mpM™uPowîNŸiRós⁄
;

182 
u16
 
	mm™uID
;

183 
powîNŸiRós⁄_t
 
	mpowîNŸiRós⁄
;

184 
u8
 
	mm™uPowîNŸiRós⁄Lí
;

185 }
	tz˛_wwah_powîögNŸifiˇti⁄Cmd_t
;

188 
addrExt_t
 
	mdevi˚EUI64
;

189 
u16
 
	mdevi˚Sh‹t
;

190 }
	tz˛_wwah_sh‹tAddrCh™geCmd_t
;

193 
u8
 
	mcuºítPowîMode
:4;

194 
u8
 
	mavaûabÀPowîSrcs
:4;

195 
u8
 
	mcuºítPowîSrc
:4;

196 
u8
 
	mcuºítPowîSrcLevñ
:4;

197 }
	tz˛_wwah_powîDescCh™geCmd_t
;

200 
u32
 
	msizeOfRï‹t
;

201 
u8
 
	mdbgRï‹tID
;

202 }
	tz˛_wwah_√wDbgRï‹tNŸiCmd_t
;

205 
u8
 *
	mpRï‹tD©a
;

206 
u8
 
	mdbgRï‹tID
;

207 
u8
 
	mªp‹tD©aLí
;

208 }
	tz˛_wwah_dbgRï‹tQuîyR•Cmd_t
;

211 
u16
 *
	mpClu°îID
;

212 
u8
 
	mnumOfClu°îs
;

213 }
	tz˛_wwah_tcF‹Clu°îSîvîQuîyR•Cmd_t
;

216 
u16
 
	mdevi˚Sh‹t
;

217 
s8
 
	mrssi
;

218 
u8
 
	m˛assifiˇti⁄Mask
;

219 }
	tbóc⁄Survey_t
;

222 
bóc⁄Survey_t
 *
	mpBóc⁄
;

223 
u8
 
	mnumOfBóc⁄s
;

224 }
	tz˛_wwah_surveyBóc⁄sR•Cmd_t
;

227 
	#CLUSTER_ID_MAX_NUM
 10

	)

230 
	mAPS_LINK_KEY_AUTH_DISABLE
,

231 
	mAPS_LINK_KEY_AUTH_ENABLE
,

232 }
	t≠sLökKeyAuthSètus_t
;

235 
u16
 
	m˛u°îID
[
CLUSTER_ID_MAX_NUM
];

236 
u8
 
	mnum
;

237 
≠sLökKeyAuthSètus_t
 
	m°©us
;

238 }
	twwah_≠sLökKeyAuthInfo_t
;

241 
u16
 
	m˛u°îID
[
CLUSTER_ID_MAX_NUM
];

242 
u8
 
	mnum
;

243 }
	twwah_≠sAcksRequúeInfo_t
;

246 
u16
 
	m˛u°îID
[
CLUSTER_ID_MAX_NUM
];

247 
u8
 
	mnum
;

248 }
	twwah_u£TCF‹Clu°îInfo_t
;

250 
wwah_≠sLökKeyAuthInfo_t
 
g_z˛_≠sLökKeyAuthInfo
;

251 
wwah_≠sAcksRequúeInfo_t
 
g_z˛_≠sAcksRequúeInfo
;

252 
wwah_u£TCF‹Clu°îInfo_t
 
g_z˛_u£TCF‹Clu°îInfo
;

258 
boﬁ
 
z˛_©å_wwah_dißbÀOTADowngødes
;

259 
boﬁ
 
z˛_©å_wwah_mgmtLóveWôhoutRejoöE«bÀd
;

260 
u8
 
z˛_©å_wwah_nwkRëryCou¡
;

261 
u8
 
z˛_©å_wwah_macRëryCou¡
;

262 
boﬁ
 
z˛_©å_wwah_rouãrCheckInE«bÀd
;

263 
boﬁ
 
z˛_©å_wwah_touchlökI¡î∑nE«bÀd
;

264 
boﬁ
 
z˛_©å_wwah_∑ª¡Cœssifiˇti⁄E«bÀd
;

265 
boﬁ
 
z˛_©å_wwah_≠pEvtRëryE«bÀd
;

266 
u8
 
z˛_©å_wwah_≠pEvtRëryQueueSize
;

267 
boﬁ
 
z˛_©å_wwah_ªjoöE«bÀd
;

268 
u8
 
z˛_©å_wwah_macPﬁlFaûuªWaôTime
;

269 
boﬁ
 
z˛_©å_wwah_c⁄figuøti⁄ModeE«bÀd
;

270 
u8
 
z˛_©å_wwah_cuºítDebugRï‹tID
;

271 
boﬁ
 
z˛_©å_wwah_tcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
;

272 
boﬁ
 
z˛_©å_wwah_badP¨ítRecovîyE«bÀd
;

273 
u8
 
z˛_©å_wwah_≥ndögNwkUpd©eCh™√l
;

274 
u16
 
z˛_©å_wwah_≥ndögNwkUpd©eP™ID
;

275 
u16
 
z˛_©å_wwah_ŸaMaxOfÊöeDuøti⁄
;

280 c⁄° 
z˛AârInfo_t
 
wwah_©åTbl
[];

281 c⁄° 
u8
 
z˛_wwah_©åNum
;

285 
z˛_wwah_˛órRouãrCheckedFœg
();

286 
boﬁ
 
z˛_wwah_gëRouãrCheckedFœg
();

287 
°©us_t
 
z˛_wwah_ac˚±Check
(
z˛Incomög_t
 *
pInMsg
);

290 
°©us_t
 
z˛_wwah_ªgi°î
(
u8
 
ídpoöt
, 
u16
 
m™uCode
, u8 
©åNum
, c⁄° 
z˛AârInfo_t
 
©åTbl
[], 
˛u°î_f‹AµCb_t
 
cb
);

292 
°©us_t
 
z˛_wwah_íabÀApsLökKeyAuthCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
);

293 
	#z˛_wwah_íabÀApsLökKeyAuthCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_íabÀApsLökKeyAuthCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

295 
°©us_t
 
z˛_wwah_dißbÀApsLökKeyAuthCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
);

296 
	#z˛_wwah_dißbÀApsLökKeyAuthCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_dißbÀApsLökKeyAuthCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

298 
°©us_t
 
z˛_wwah_≠sLökKeyAuthQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_≠sLökKeyAuthQuîyCmd_t
 *
pCmd
);

299 
	#z˛_wwah_≠sLökKeyAuthQuîyCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_≠sLökKeyAuthQuîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

301 
°©us_t
 
z˛_wwah_ªque°NewApsLökKeyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

302 
	#z˛_wwah_ªque°NewApsLökKeyCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_ªque°NewApsLökKeyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

304 
°©us_t
 
z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd_t
 *
pCmd
);

305 
	#z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_íabÀAµEvtRëryAlg‹ôhmCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

307 
°©us_t
 
z˛_wwah_dißbÀAµEvtRëryAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

308 
	#z˛_wwah_dißbÀAµEvtRëryAlg‹ôhmCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀAµEvtRëryAlg‹ôhmCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

310 
°©us_t
 
z˛_wwah_ªque°TimeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

311 
	#z˛_wwah_ªque°TimeCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_ªque°TimeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

313 
°©us_t
 
z˛_wwah_íabÀRejoöAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀRejoöAlg‹ôhmCmd_t
 *
pCmd
);

314 
	#z˛_wwah_íabÀRejoöAlg‹ôhmCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_íabÀRejoöAlg‹ôhmCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

316 
°©us_t
 
z˛_wwah_dißbÀRejoöAlg‹ôhmCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

317 
	#z˛_wwah_dißbÀRejoöAlg‹ôhmCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀRejoöAlg‹ôhmCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

319 
°©us_t
 
z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd_t
 *
pCmd
);

320 
	#z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_£tIasZ⁄eEƒﬁlmítMëhodCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

322 
°©us_t
 
z˛_wwah_˛órBödögTabÀCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

323 
	#z˛_wwah_˛órBödögTabÀCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_˛órBödögTabÀCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

325 
°©us_t
 
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_íabÀPîiodicRouãrCheckInsCmd_t
 *
pCmd
);

326 
	#z˛_wwah_íabÀPîiodicRouãrCheckInsCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_íabÀPîiodicRouãrCheckInsCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

328 
°©us_t
 
z˛_wwah_dißbÀPîiodicRouãrCheckInsCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

329 
	#z˛_wwah_dißbÀPîiodicRouãrCheckInsCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀPîiodicRouãrCheckInsCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

331 
°©us_t
 
z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd_t
 *
pCmd
);

332 
	#z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_£tMacPﬁlFaûuªWaôTimeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

334 
°©us_t
 
z˛_wwah_£tPídögNwkUpd©eCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_£tPídögNwkUpd©eCmd_t
 *
pCmd
);

335 
	#z˛_wwah_£tPídögNwkUpd©eCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_£tPídögNwkUpd©eCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

337 
°©us_t
 
z˛_wwah_ªquúeApsAcksOnUniˇ°sCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
˛u°îsToExem±_t
 *
pCmd
);

338 
	#z˛_wwah_ªquúeApsAcksOnUniˇ°sCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_ªquúeApsAcksOnUniˇ°sCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

340 
°©us_t
 
z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

341 
	#z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_ªmoveApsAcksOnUniˇ°sRequúemítCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

343 
°©us_t
 
z˛_wwah_≠sAckRequúemítQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

344 
	#z˛_wwah_≠sAckRequúemítQuîyCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_≠sAckRequúemítQuîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

346 
°©us_t
 
z˛_wwah_debugRï‹tQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_debugRï‹tQuîyCmd_t
 *
pCmd
);

347 
	#z˛_wwah_debugRï‹tQuîyCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_debugRï‹tQuîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

349 
°©us_t
 
z˛_wwah_surveyBóc⁄sCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_surveyBóc⁄sCmd_t
 *
pCmd
);

350 
	#z˛_wwah_surveyBóc⁄sCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_surveyBóc⁄sCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

352 
°©us_t
 
z˛_wwah_dißbÀOèDowngødesCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

353 
	#z˛_wwah_dißbÀOèDowngødesCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀOèDowngødesCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

355 
°©us_t
 
z˛_wwah_dißbÀMgmtLóveWôhoutRejoöCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

356 
	#z˛_wwah_dißbÀMgmtLóveWôhoutRejoöCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀMgmtLóveWôhoutRejoöCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

358 
°©us_t
 
z˛_wwah_dißbÀTouchlökI¡î∑nMsgCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

359 
	#z˛_wwah_dißbÀTouchlökI¡î∑nMsgCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀTouchlökI¡î∑nMsgCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

361 
°©us_t
 
z˛_wwah_íabÀP¨ítCœssifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

362 
	#z˛_wwah_íabÀP¨ítCœssifiˇti⁄CmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_íabÀP¨ítCœssifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

364 
°©us_t
 
z˛_wwah_dißbÀP¨ítCœssifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

365 
	#z˛_wwah_dißbÀP¨ítCœssifiˇti⁄CmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀP¨ítCœssifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

367 
°©us_t
 
z˛_wwah_íabÀTcSecurôyOnNwkKeyRŸ©i⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

368 
	#z˛_wwah_íabÀTcSecurôyOnNwkKeyRŸ©i⁄CmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_íabÀTcSecurôyOnNwkKeyRŸ©i⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

370 
°©us_t
 
z˛_wwah_íabÀBadP¨ítRecovîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

371 
	#z˛_wwah_íabÀBadP¨ítRecovîyCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_íabÀBadP¨ítRecovîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

373 
°©us_t
 
z˛_wwah_dißbÀBadP¨ítRecovîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

374 
	#z˛_wwah_dißbÀBadP¨ítRecovîyCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀBadP¨ítRecovîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

376 
°©us_t
 
z˛_wwah_íabÀC⁄figuøti⁄ModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

377 
	#z˛_wwah_íabÀC⁄figuøti⁄ModeCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_íabÀC⁄figuøti⁄ModeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

379 
°©us_t
 
z˛_wwah_dißbÀC⁄figuøti⁄ModeCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

380 
	#z˛_wwah_dißbÀC⁄figuøti⁄ModeCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_dißbÀC⁄figuøti⁄ModeCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

382 
°©us_t
 
z˛_wwah_u£Tru°CíãrF‹Clu°îCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_u£Tru°CíãrF‹Clu°îCmd_t
 *
pCmd
);

383 
	#z˛_wwah_u£Tru°CíãrF‹Clu°îCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_u£Tru°CíãrF‹Clu°îCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

385 
°©us_t
 
z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
);

386 
	#z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyCmdSíd
(
a
,
b
,
c
Ë(
	`z˛_wwah_åu°CíãrF‹Clu°îSîvîQuîyCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
))

	)

388 
°©us_t
 
z˛_wwah_powîögOffNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîögNŸifiˇti⁄Cmd_t
 *
pCmd
);

389 
	#z˛_wwah_powîögOffNŸifiˇti⁄CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_powîögOffNŸifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

391 
°©us_t
 
z˛_wwah_powîögOnNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîögNŸifiˇti⁄Cmd_t
 *
pCmd
);

392 
	#z˛_wwah_powîögOnNŸifiˇti⁄CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_powîögOnNŸifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

394 
°©us_t
 
z˛_wwah_sh‹tAddrCh™geCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_sh‹tAddrCh™geCmd_t
 *
pCmd
);

395 
	#z˛_wwah_sh‹tAddrCh™geCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_sh‹tAddrCh™geCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

397 
°©us_t
 
z˛_wwah_powîDes¸ùt‹Ch™geCmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_powîDescCh™geCmd_t
 *
pCmd
);

398 
	#z˛_wwah_powîDes¸ùt‹Ch™geCmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_powîDes¸ùt‹Ch™geCmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

400 
°©us_t
 
z˛_wwah_√wDebugRï‹tNŸifiˇti⁄Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_√wDbgRï‹tNŸiCmd_t
 *
pCmd
);

401 
	#z˛_wwah_√wDebugRï‹tNŸifiˇti⁄CmdSíd
(
a
,
b
,
c
,
d
Ë(
	`z˛_wwah_√wDebugRï‹tNŸifiˇti⁄Cmd
(◊), (b), (c), 
ZCL_SEQ_NUM
, (d)))

	)

403 
°©us_t
 
z˛_wwah_surveyBóc⁄sR•Cmd
(
u8
 
§cEp
, 
ïInfo_t
 *
pD°EpInfo
, u8 
dißbÀDeÁu…R•
, u8 
£qNo
, 
z˛_wwah_surveyBóc⁄sR•Cmd_t
 *
pCmd
);

404 
	#z˛_wwah_surveyBóc⁄sR•CmdSíd
(
a
,
b
,
c
,
d
,
e
Ë(
	`z˛_wwah_surveyBóc⁄sR•Cmd
(◊), (b), (c), (d), (e)))

	)

	@zigbee/zcl/zcl_wwah/zcl_wwah_attr.c

25 
	~"é_comm⁄.h
"

30 
	~"../z˛_ö˛ude.h
"

46 #ifde‡
ZCL_WWAH


49 
boﬁ
 
	gz˛_©å_wwah_dißbÀOTADowngødes
 = 
FALSE
;

50 
boﬁ
 
	gz˛_©å_wwah_mgmtLóveWôhoutRejoöE«bÀd
 = 
TRUE
;

51 
u8
 
	gz˛_©å_wwah_nwkRëryCou¡
 = 3;

52 
u8
 
	gz˛_©å_wwah_macRëryCou¡
 = 3;

53 
boﬁ
 
	gz˛_©å_wwah_rouãrCheckInE«bÀd
 = 
FALSE
;

54 
boﬁ
 
	gz˛_©å_wwah_touchlökI¡î∑nE«bÀd
 = 
TRUE
;

55 
boﬁ
 
	gz˛_©å_wwah_∑ª¡Cœssifiˇti⁄E«bÀd
 = 
FALSE
;

56 
boﬁ
 
	gz˛_©å_wwah_≠pEvtRëryE«bÀd
 = 
TRUE
;

57 
u8
 
	gz˛_©å_wwah_≠pEvtRëryQueueSize
 = 10;

58 
boﬁ
 
	gz˛_©å_wwah_ªjoöE«bÀd
 = 
FALSE
;

59 
u8
 
	gz˛_©å_wwah_macPﬁlFaûuªWaôTime
 = 3;

60 
boﬁ
 
	gz˛_©å_wwah_c⁄figuøti⁄ModeE«bÀd
 = 
TRUE
;

61 
u8
 
	gz˛_©å_wwah_cuºítDebugRï‹tID
 = 0;

62 
boﬁ
 
	gz˛_©å_wwah_tcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
 = 
FALSE
;

63 
boﬁ
 
	gz˛_©å_wwah_badP¨ítRecovîyE«bÀd
 = 
FALSE
;

64 
u8
 
	gz˛_©å_wwah_≥ndögNwkUpd©eCh™√l
 = 0xFF;

65 
u16
 
	gz˛_©å_wwah_≥ndögNwkUpd©eP™ID
 = 0xFFFF;

66 
u16
 
	gz˛_©å_wwah_ŸaMaxOfÊöeDuøti⁄
 = 0;

69 c⁄° 
z˛AârInfo_t
 
	gwwah_©åTbl
[] =

71 { 
ZCL_ATTRID_WWAH_DISABLE_OTA_DOWNGRADES
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_dißbÀOTADowngødes
 },

72 { 
ZCL_ATTRID_WWAH_MGMT_LEAVE_WITHOUT_REJOIN_ENABLED
,
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_mgmtLóveWôhoutRejoöE«bÀd
 },

73 { 
ZCL_ATTRID_WWAH_NWK_RETRY_COUNT
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_nwkRëryCou¡
 },

74 { 
ZCL_ATTRID_WWAH_MAC_RETRY_COUNT
, 
ZCL_DATA_TYPE_UINT8
 , 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_macRëryCou¡
 },

75 { 
ZCL_ATTRID_WWAH_ROUTER_CHECK_IN_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_rouãrCheckInE«bÀd
 },

76 { 
ZCL_ATTRID_WWAH_TOUCHLINK_INTERPAN_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_touchlökI¡î∑nE«bÀd
 },

77 { 
ZCL_ATTRID_WWAH_PARENT_CLASSIFICATION_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_∑ª¡Cœssifiˇti⁄E«bÀd
 },

78 { 
ZCL_ATTRID_WWAH_APP_EVT_RETRY_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_≠pEvtRëryE«bÀd
 },

79 { 
ZCL_ATTRID_WWAH_APP_EVT_RETRY_QUEUE_SIZE
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_≠pEvtRëryQueueSize
 },

80 { 
ZCL_ATTRID_WWAH_REJOIN_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_ªjoöE«bÀd
 },

81 { 
ZCL_ATTRID_WWAH_MAC_POLL_FAILURE_WAIT_TIME
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_macPﬁlFaûuªWaôTime
 },

82 { 
ZCL_ATTRID_WWAH_CONFIGURATION_MODE_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_c⁄figuøti⁄ModeE«bÀd
 },

83 { 
ZCL_ATTRID_WWAH_CURRENT_DEBUG_REPORT_ID
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_cuºítDebugRï‹tID
 },

84 { 
ZCL_ATTRID_WWAH_TC_SECURITY_ON_NWK_KEY_ROTATION_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_tcSecurôyOnNwkKeyRŸ©i⁄E«bÀd
 },

85 { 
ZCL_ATTRID_WWAH_BAD_PARENT_RECOVERY_ENABLED
, 
ZCL_DATA_TYPE_BOOLEAN
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_badP¨ítRecovîyE«bÀd
 },

86 { 
ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_CHANNEL
, 
ZCL_DATA_TYPE_UINT8
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_≥ndögNwkUpd©eCh™√l
 },

87 { 
ZCL_ATTRID_WWAH_PENDING_NWK_UPDATE_PANID
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_≥ndögNwkUpd©eP™ID
 },

88 { 
ZCL_ATTRID_WWAH_OTA_MAX_OFFLINE_DURATION
, 
ZCL_DATA_TYPE_UINT16
, 
ACCESS_CONTROL_READ
, (
u8
*)&
z˛_©å_wwah_ŸaMaxOfÊöeDuøti⁄
 },

91 c⁄° 
u8
 
	gz˛_wwah_©åNum
 = ( (
wwah_©åTbl
Ë/ (
z˛AârInfo_t
) );

	@zigbee/zcl/zll_commissioning/zcl_touchlink_attr.h

24 #i‚de‡
ZCL_TOUCHLINK_ATTR_H


25 
	#ZCL_TOUCHLINK_ATTR_H


	)

32 
	#ZB_INTER_PAN_TRANS_ID_LIFETIME
 (8 * 1000)

	)

33 
	#ZB_MAX_PERMIT_JOIN_DURATION
 (60* 1000)

	)

34 
	#ZB_MAX_LOST_PARENT_RETRY_ATTEMPTS
 (10)

	)

35 
	#ZB_MIN_STARTUP_DELAY_TIME
 (2 * 1000)

36 
	#ZB_RX_WINDOW_DURATION
 (5 * 1000)

37 
	#ZB_SCAN_TIME_BASE_DURATION
 (250)

38 

	)

44 
	mLL_ROLE_COORD
,

45 
	mLL_ROLE_ROUTER
,

46 
	mLL_ROLE_END_DEVICE


47 } 
	tŒ_rﬁe_t
;

52 
	mDEVELOPMENT_KEY
 = 0,

53 
	mMASTER_KEY
 = 4,

54 
	mCERTIFICATION_KEY
 = 15

55 }
	tTOUCHLINK_KEY_TYPE
;

62 
u16
 
	mmagicNum
;

63 
boﬁ
 
	misFa˘‹yNew
;

64 
u8
 
	mcuºítCh™√l
;

65 
u16
 
	m∑nId
;

66 
u16
 
	mnwkAddr
;

67 
addrExt_t
 
	mõìAddr
;

68 
extPANId_t
 
	mextP™Id
;

69 
u8
 
	m∑ª¡Ref
;

70 
u16
 
	m‰ìNwkAddªssR™geBegö
;

71 
u16
 
	m‰ìNwkAddªssR™geEnd
;

72 
u16
 
	m‰ìGroupAddªssR™geBegö
;

73 
u16
 
	m‰ìGroupAddªssR™geEnd
;

74 
u16
 
	mba£_√ighb‹_u£d
;

75 
u16
 
	mext_√ighb‹_u£d
;

76 
u8
 
	mchûd_num
;

77 
u8
 
	med_chûd_num
;

78 
u16
 
	mn_ñemíts
;

79 
u16
 
	mn_s‹ãd_ñemíts
;

81 #ifde‡
ZB_SECURITY


82 
ss_m©îül_£t_t
 
	m£cur_m©îül_£t
[
SECUR_N_SECUR_MATERIAL
];

83 
u8
 
	ma˘ive_key_£q_numbî
;

84 
u8
 
	m£curôy_Àvñ
:4;

85 
u8
 
	m£cuª_Æl_‰ames
:1;

86 
u8
 
	ma˘ive_£cur_m©îül_i
:2;

88 } 
	tzŒ_nv_∑øms_t
;

94 
u16
 
	m‰ìNwkAddªssR™geBegö
;

95 
u16
 
	m‰ìNwkAddªssR™geEnd
;

96 
u16
 
	m‰ìGroupAddªssR™geBegö
;

97 
u16
 
	m‰ìGroupAddªssR™geEnd
;

98 } 
	ttouchlök_©å_t
;

109 
Œ_ª£t
();

110 
Œ_gë_í¸y±ed_√tw‹k_key
(
u8
 
key_ödex
, 
u32
 
å™ß˘i⁄_ID
,

111 
u32
 
ª•⁄£_ID
, 
u8
 *
í¸y±ed_√tw‹k_key
);

112 
Œ_de¸y±_√tw‹k_key
(
u8
 
key_ödex
, u8 *
í¸y±ed_√tw‹k_key
,

113 
u32
 
å™ß˘i⁄_ID
, u32 
ª•⁄£_ID
);

	@zigbee/zcl/zll_commissioning/zcl_toucklink_security.c

27 
	~"../z˛_ö˛ude.h
"

49 
	$Œ_ª£t
()

52 
	}
}

54 
	$Œ_zŒAârCÃ
(){

55 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 = 0x00;

56 
g_touchlökAâr
.
‰ìNwkAddªssR™geEnd
 = 0x00;

57 
g_touchlökAâr
.
‰ìGroupAddªssR™geBegö
 = 0x00;

58 
g_touchlökAâr
.
‰ìGroupAddªssR™geEnd
 = 0x00;

59 
	}
}

61 
	$Œ_d©aSídCnfCb
(
u8
 
°
, u8 
h™dÀ
){

63 
	}
}

65 #ifde‡
ZB_SECURITY


67 
	$Œ_ˇlcuœã_AES_öput
(
u8
 *
AES_key
, 
TOUCHLINK_KEY_TYPE
 
Æg‹ôhm
, u8 *
å™ß˘i⁄_id
, u8 *
ª•⁄£_id
)

69 
u8
 
pos
 = 0;

70 
u8
 *
byã_0_3
;

71 
u8
 *
byã_8_11
;

73 if(
Æg‹ôhm
 =
DEVELOPMENT_KEY
)

75 
byã_0_3
 = (
u8
 *)"PhLi";

76 
byã_8_11
 = (
u8
 *)"CLSN";

80 
byã_0_3
 = 
å™ß˘i⁄_id
;

81 
byã_8_11
 = 
ª•⁄£_id
;

83 
	`mem˝y
(
AES_key
, 
byã_0_3
, 4);
pos
 += 4;

84 
	`mem˝y
(
AES_key
 + 
pos
, 
å™ß˘i⁄_id
, 4);pos += 4;

85 
	`mem˝y
(
AES_key
 + 
pos
, 
byã_8_11
, 4);pos += 4;

86 
	`mem˝y
(
AES_key
 + 
pos
, 
ª•⁄£_id
, 4);

87 
	}
}

89 
	$Œ_de¸y±_√tw‹k_key
(
u8
 
key_ödex
, u8 *
í¸y±ed_√tw‹k_key
, 
u32
 
å™ß˘i⁄ID
, u32 
ª•⁄£ID
)

91 
u8
 
å™ß˘i⁄_ID
[4];

92 
u8
 
ª•⁄£_ID
[4];

93 
u8
 
AES_öput
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

94 
u8
 
å™•‹t_key
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

95 
u8
 
√tw‹k_key
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) = {0};

97 
å™ß˘i⁄_ID
[0] = 
	`U32_BYTE3
(
å™ß˘i⁄ID
);

98 
å™ß˘i⁄_ID
[1] = 
	`U32_BYTE2
(
å™ß˘i⁄ID
);

99 
å™ß˘i⁄_ID
[2] = 
	`U32_BYTE1
(
å™ß˘i⁄ID
);

100 
å™ß˘i⁄_ID
[3] = 
	`U32_BYTE0
(
å™ß˘i⁄ID
);

102 
ª•⁄£_ID
[0] = 
	`U32_BYTE3
(
ª•⁄£ID
);

103 
ª•⁄£_ID
[1] = 
	`U32_BYTE2
(
ª•⁄£ID
);

104 
ª•⁄£_ID
[2] = 
	`U32_BYTE1
(
ª•⁄£ID
);

105 
ª•⁄£_ID
[3] = 
	`U32_BYTE0
(
ª•⁄£ID
);

107 
	`Œ_ˇlcuœã_AES_öput
(
AES_öput
, 
key_ödex
, 
å™ß˘i⁄_ID
, 
ª•⁄£_ID
);

109 if(
key_ödex
 =
DEVELOPMENT_KEY
)

111 
	`´s_de¸y±
(
AES_öput
, 
í¸y±ed_√tw‹k_key
, 
√tw‹k_key
);

113 if(
key_ödex
 =
MASTER_KEY
)

116 
	`´s_í¸y±
(
	`SS_IB
().
touchLökKey
, 
AES_öput
, 
å™•‹t_key
);

117 
	`´s_de¸y±
(
å™•‹t_key
, 
í¸y±ed_√tw‹k_key
, 
√tw‹k_key
);

119 if(
key_ödex
 =
CERTIFICATION_KEY
)

121 
	`´s_í¸y±
(
	`SS_IB
().
touchLökKey
, 
AES_öput
, 
å™•‹t_key
);

122 
	`´s_de¸y±
(
å™•‹t_key
, 
í¸y±ed_√tw‹k_key
, 
√tw‹k_key
);

125 
	`mem˝y
(
í¸y±ed_√tw‹k_key
, 
√tw‹k_key
, 
CCM_KEY_SIZE
);

127 i‡(!
	`APS_IB
().
≠s_authítiˇãd
){

128 
	`APS_IB
().
≠s_authítiˇãd
 = 1;

130 
	}
}

132 
	$Œ_gë_í¸y±ed_√tw‹k_key
(
u8
 
key_ödex
, 
u32
 
å™ß˘i⁄ID
, u32 
ª•⁄£ID
, u8 *
í¸y±ed_√tw‹k_key
)

134 
u8
 
å™ß˘i⁄_ID
[4];

135 
u8
 
ª•⁄£_ID
[4];

136 
u8
 
AES_öput
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

137 
u8
 
å™•‹t_key
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

138 
u8
 
√tw‹k_key
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

140 
å™ß˘i⁄_ID
[0] = 
	`U32_BYTE3
(
å™ß˘i⁄ID
);

141 
å™ß˘i⁄_ID
[1] = 
	`U32_BYTE2
(
å™ß˘i⁄ID
);

142 
å™ß˘i⁄_ID
[2] = 
	`U32_BYTE1
(
å™ß˘i⁄ID
);

143 
å™ß˘i⁄_ID
[3] = 
	`U32_BYTE0
(
å™ß˘i⁄ID
);

145 
ª•⁄£_ID
[0] = 
	`U32_BYTE3
(
ª•⁄£ID
);

146 
ª•⁄£_ID
[1] = 
	`U32_BYTE2
(
ª•⁄£ID
);

147 
ª•⁄£_ID
[2] = 
	`U32_BYTE1
(
ª•⁄£ID
);

148 
ª•⁄£_ID
[3] = 
	`U32_BYTE0
(
ª•⁄£ID
);

150 
	`Œ_ˇlcuœã_AES_öput
(
AES_öput
, 
key_ödex
, 
å™ß˘i⁄_ID
, 
ª•⁄£_ID
);

154 if(
g_zbNwkCtx
.
is_Á˘‹y_√w
){

155 
	`ss_nwkKeyGíî©e
(
√tw‹k_key
);

159 
	`mem˝y
(
√tw‹k_key
, 
	`SS_IB
().
nwkSecurM©îülSë
[0].
key
, 
CCM_KEY_SIZE
);

163 if(
key_ödex
 =
DEVELOPMENT_KEY
)

165 
	`´s_í¸y±
(
AES_öput
, 
√tw‹k_key
, 
í¸y±ed_√tw‹k_key
);

167 if(
key_ödex
 =
MASTER_KEY
)

169 
	`´s_í¸y±
(
	`SS_IB
().
touchLökKey
, 
AES_öput
, 
å™•‹t_key
);

170 
	`´s_í¸y±
(
å™•‹t_key
, 
√tw‹k_key
, 
í¸y±ed_√tw‹k_key
);

172 if(
key_ödex
 =
CERTIFICATION_KEY
)

174 
	`´s_í¸y±
(
	`SS_IB
().
touchLökKey
, 
AES_öput
, 
å™•‹t_key
);

175 
	`´s_í¸y±
(
å™•‹t_key
, 
√tw‹k_key
, 
í¸y±ed_√tw‹k_key
);

178 i‡(!
	`APS_IB
().
≠s_authítiˇãd
){

179 
	`APS_IB
().
≠s_authítiˇãd
 = 1;

181 
	}
}

	@zigbee/zcl/zll_commissioning/zcl_zllTouchLinkDiscovery.c

27 
	~"../z˛_ö˛ude.h
"

28 
	~"z˛_zŒ_commissi⁄ög_öã∫Æ.h
"

30 
	#ZB_PRIMARY_CHANNEL_1
 11

	)

31 
	#ZB_PRIMARY_CHANNEL_2
 15

	)

32 
	#ZB_PRIMARY_CHANNEL_3
 20

	)

33 
	#ZB_PRIMARY_CHANNEL_4
 25

	)

35 
_CODE_ZCL_
 
z˛_zŒTouchLökDiscoveySt›
();

36 
_CODE_ZCL_
 
z˛_zŒTouchLökDiscoveySèπ
();

37 
z˛_zŒCommissi⁄_t
 
g_zŒCommissi⁄
;

38 
boﬁ
 
sˇnReqProfûeI¡î›
;

39 
u8
 
	gª£t2Fa˘‹yFœg
 = 0;

41 
s32
 
	$z˛_touchLökIdítifyReque°D⁄e
(*
¨g
){

42 
u32
 
°a
 = (u32)
¨g
;

43 
	`z˛_zŒTouchLökFöish
(
°a
);

45 
	}
}

55 
_CODE_ZCL_
 
	$z˛_zŒTouchLökIdítifyReque°
(*
¨g
){

56 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

57 
ïInfo_t
 
d°Ep
;

58 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

60 
	`mem˝y
((
u8
 *)&
d°Ep
,(u8 *)&
≥îInfo
->dstEp, (dstEp));

62 
z˛_zŒTouchLökIdítifyReq_t
 
ªq
;

63 
ªq
.
å™sId
 = 
g_zŒTouchLök
.transId;

64 
ªq
.
idítifyDuøti⁄
 = 3;

66 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_IDENTIFY
;

67 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_IDENTIFY
, 
TRUE
,

68 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökIdítifyReq_t
), (
u8
 *)&
ªq
);

70 if(
	`BDB_ATTR
().
nodeIsOnANëw‹k
){

71 if(
	`ZB_EXTPANID_CMP
(
≥îInfo
->
ï™Id
, 
	`NWK_NIB
().
extPANId
)){

73 if(
≥îInfo
->
nwkUpd©eId
 < 
	`NWK_NIB
().
upd©eId
){

75 
z˛_zŒTouchLökNëw‹kUpd©eReq_t
 
√tw‹kUpd©eCmd
;

76 
√tw‹kUpd©eCmd
.
å™sId
 = 
g_zŒTouchLök
.transId;

77 
	`ZB_EXTPANID_COPY
(
√tw‹kUpd©eCmd
.
ï™Id
, 
	`NWK_NIB
().
extPANId
);

78 
√tw‹kUpd©eCmd
.
nwkUpd©eId
 = 
	`NWK_NIB
().
upd©eId
;

79 
√tw‹kUpd©eCmd
.
logiˇlCh™√l
 = 
	`MAC_IB
().
phyCh™√lCur
;

80 
√tw‹kUpd©eCmd
.
∑nId
 = 
	`NWK_NIB
().panId;

81 
√tw‹kUpd©eCmd
.
nwkAddr
 = 
	`NWK_NIB
().nwkAddr;

82 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_UPDATE
, 
TRUE
,

83 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökNëw‹kUpd©eReq_t
), (
u8
 *)&
√tw‹kUpd©eCmd
);

87 if(
≥îInfo
->
nwkUpd©eId
 > 
	`NWK_NIB
().
upd©eId
){

88 
	`NWK_NIB
().
upd©eId
 = 
≥îInfo
->
nwkUpd©eId
;

89 
	`zdo_∆meCh™√lShi·
(
≥îInfo
->
logiˇlCh™√l
);

92 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_touchLökIdítifyReque°D⁄e
, (*)
ZCL_ZLL_TOUCH_LINK_STA_EXIST
, 5);

96 if(!
	`ss_£curôyModeIsDi°ribuãd
()){

97 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NOT_PERMITTED
);

104 if(
g_zŒTouchLök
.
zŒInfo
.
bf
.
addrAssign
 == 0){

105 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NO_CAPACITY
);

109 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökNëw‹kSèπOrJoö
, 
NULL
);

110 
	}
}

121 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°
(*
¨g
){

122 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

123 
ïInfo_t
 
d°Ep
;

124 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

126 
	`mem˝y
((
u8
 *)&
d°Ep
,(u8 *)&
≥îInfo
->dstEp, (dstEp));

129 
z˛_zŒTouchLökDevi˚InfoReq_t
 
ªq
;

130 
ªq
.
å™sId
 = 
g_zŒTouchLök
.transId;

131 
ªq
.
°¨tIdx
 = (
u8
)((
u32
)
¨g
);

132 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION
, 
TRUE
,

133 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökDevi˚InfoReq_t
), (
u8
 *)&
ªq
);

134 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DEVICE_INFO_EXCHANGE
;

136 
	}
}

148 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°H™dÀr
(
ïInfo_t
 *
d°Ep
,
u8
 
°¨tEpIdx
){

152 
af_ídpoöt_des¸ùt‹_t
 *
´d
 = 
	`af_ïDes¸ùt‹Gë
();

153 
u8
 
M©chE≤umOn˚
 = 0;

154 
u8
 
tŸÆM©chE≤um
 = 0;

155 
u8
 
m©chEpIdx
[
MAX_ACTIVE_EP_NUMBER
] = {0};

156 
u8
 
i
 = 0; i < 
	`af_avaûabÀEpNumGë
(); i++){

157 if(
	`af_˛suãrIdM©ched
(
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
)){

158 
m©chEpIdx
[
tŸÆM©chE≤um
++] = 
i
;

162 if(
tŸÆM©chE≤um
 > 
°¨tEpIdx
){

163 
M©chE≤umOn˚
 = 
tŸÆM©chE≤um
 - 
°¨tEpIdx
;

164 
M©chE≤umOn˚
 = (MatchEpnumOnce >= 5) ? 5 : MatchEpnumOnce;

167 
u8
 
Àn
 = 
M©chE≤umOn˚
 * (
z˛_zŒDevi˚InfoRec_t
Ë+ (
z˛_zŒTouchLökDevi˚InfoRe•_t
);

168 
z˛_zŒTouchLökDevi˚InfoRe•_t
 *
ª•
 = (z˛_zŒTouchLökDevi˚InfoRe•_à*)
	`ev_buf_Æloˇã
(
Àn
);

169 if(
ª•
){

170 
	`mem£t
(
ª•
, 0, 
Àn
);

171 
ª•
->
numOfSubdevi˚s
 = 
tŸÆM©chE≤um
;

172 
ª•
->
å™sId
 = 
g_zŒTouchLök
.transId;

173 
ª•
->
devi˚InfoRec‹dC¡
 = 
M©chE≤umOn˚
;

174 
ª•
->
°¨tIdx
 = 
°¨tEpIdx
;

175 if(
M©chE≤umOn˚
 > 0)

177 
z˛_zŒDevi˚InfoRec_t
 *
ªc
 = 
ª•
->rec;

178 
u8
 
i
 = 0; i < 
M©chE≤umOn˚
; i++){

179 
u8
 
ïIdx
 = 
m©chEpIdx
[
°¨tEpIdx
 + 
i
];

180 
ªc
->
devi˚Id
 = 
´d
[
ïIdx
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_id
;

181 
ªc
->
ïId
 = 
´d
[
ïIdx
].
ï
;

182 
ªc
->
groupIdC¡
 = 0;

183 if(
sˇnReqProfûeI¡î›
){

184 
ªc
->
¥ofûeId
 = 
´d
[
ïIdx
].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
;

186 
ªc
->
¥ofûeId
 = 
LL_PROFILE_ID
;

188 
ªc
->
s‹t
 = 0;

189 
ªc
->
vîsi⁄
 = 
´d
[
ïIdx
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_vî
;

190 
	`mem˝y
(
ªc
->
õìAddr
, 
	`MAC_IB
().
extAddªss
, 8);

191 
ªc
++;

195 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION_RSP
, 
TRUE
,

196 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, 
Àn
, (
u8
 *)
ª•
);

197 
	`ev_buf_‰ì
((
u8
 *)
ª•
);

199 
	}
}

210 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDevi˚Inf‹m©i⁄Re•⁄£H™dÀr
(
z˛_zŒTouchLökDevi˚InfoRe•_t
 *
devInfoRe•
){

212 if(
devInfoRe•
->
°¨tIdx
 + devInfoRe•->
devi˚InfoRec‹dC¡
 >devInfoRe•->
numOfSubdevi˚s
)

215 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökIdítifyReque°
, 
NULL
);

219 
u32
 
√xtIndex
 = 
devInfoRe•
->
°¨tIdx
 + devInfoRe•->
devi˚InfoRec‹dC¡
;

220 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°
, (*)
√xtIndex
);

223 
	}
}

235 
_CODE_ZCL_
 
	$z˛_zŒTouchLökSˇnReque°H™dÀr
(
ïInfo_t
 *
§cEp
, 
u8
 
£qNo
){

237 #i‡(
ZB_ED_ROLE
)

239 if(
	`zb_isUndîRejoöMode
()){

242 
	`zb_£tPﬁlR©e
(0);

248 
	`z˛_zŒTouchLökDiscoveySt›
();

250 
z˛_zŒTouchLökSˇnRe•_t
 
ª•
;

251 
	`TL_SETSTRUCTCONTENT
(
ª•
,0);

252 
u8
 
sˇnRe•Lí
 = (
z˛_zŒTouchLökSˇnRe•_t
Ë- (
z˛_zŒSubdevi˚Info_t
);

254 
ª•
.
å™sId
 = 
g_zŒTouchLök
.transId;

255 
ª•
.
rssiC‹ª˘i⁄
 = 0;

257 
ª•
.
zbInfo
.
bf
.
logicDevTy≥
 = 
	`af_nodeDevTy≥Gë
();

258 
ª•
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
 = (
	`af_nodeMacC≠abûôyGë
(Ë& 
MAC_CAP_RX_ON_WHEN_IDLE
) ? 1 : 0;

260 if(
	`is_devi˚_Á˘‹y_√w
())

262 
g_zŒTouchLök
.
zŒInfo
.
bf
.
Á˘‹yNew
 = 1;

265 
g_zŒTouchLök
.
zŒInfo
.
bf
.
Á˘‹yNew
 = 0;

267 
g_zŒTouchLök
.
zŒInfo
.
bf
.
¥ofûeI¡î›
 = 1;

268 
	`mem˝y
(&
ª•
.
zŒInfo
, &
g_zŒTouchLök
.zllInfo, 1);

270 if(!
	`is_devi˚_Á˘‹y_√w
()){

271 
	`mem˝y
(
ª•
.
ï™Id
, 
	`NWK_NIB
().
extPANId
, (
addrExt_t
));

272 
ª•
.
nwkUpd©eId
 = 
	`NWK_NIB
().
upd©eId
;

273 
ª•
.
∑nId
 = 
	`MAC_IB
().panId;

274 
ª•
.
nwkAddr
 = 
	`NIB_NETWORK_ADDRESS
();

276 
ª•
.
nwkUpd©eId
 = 0;

277 
	`mem£t
(
ª•
.
ï™Id
, 0, 8);

278 if(
	`MAC_IB
().
∑nId
 =
MAC_INVALID_PANID
){

279 
	`MAC_IB
().
∑nId
 = 
	`ZB_RANDOM
();

281 
ª•
.
∑nId
 = 
	`MAC_IB
().panId;

284 
ª•
.
keyBômask
 = 0;

285 #ifde‡
ZB_SECURITY


286 
ª•
.
keyBômask
 |(1 << 
g_zŒTouchLök
.
keyTy≥
);

289 
ª•
.
ª•Id
 = 
g_zŒTouchLök
.respId;

290 
ª•
.
logiˇlCh™√l
 = 
	`MAC_IB
().
phyCh™√lCur
;

291 
ª•
.
tŸÆGroupIds
 = 0;

293 
af_ídpoöt_des¸ùt‹_t
 *
´d
 = 
	`af_ïDes¸ùt‹Gë
();

295 
u8
 
i
 = 0; i < 
	`af_avaûabÀEpNumGë
(); i++){

296 if(
	`af_˛suãrIdM©ched
(
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
)){

297 
ª•
.
numOfSubdevi˚s
++;

304 if(1 =
ª•
.
numOfSubdevi˚s
){

305 
u8
 
i
 = 0; i < 
	`af_avaûabÀEpNumGë
(); i++){

306 if(
	`af_˛suãrIdM©ched
(
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
)){

307 
ª•
.
subDevInfo
.
ïId
 = 
´d
[
i
].
ï
;

308 if(
sˇnReqProfûeI¡î›
){

309 
ª•
.
subDevInfo
.
¥ofûeId
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
;

311 
ª•
.
subDevInfo
.
¥ofûeId
 = 
LL_PROFILE_ID
;

313 
ª•
.
subDevInfo
.
devi˚Id
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_id
;

314 
ª•
.
subDevInfo
.
vîsi⁄
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_vî
;

315 
ª•
.
subDevInfo
.
groupIdC¡
 = 0;

316 
sˇnRe•Lí
 +(
z˛_zŒSubdevi˚Info_t
);

323 
	`MAC_IB
().
rxOnWhíIdÀ
 = 1;

324 
g_zŒTouchLök
.
touchLökCh™
 = 
	`MAC_IB
().
phyCh™√lCur
;

327 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
§cEp
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_SCAN_RSP
, 
TRUE
,

328 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
TRUE
, 0, 
£qNo
, 
sˇnRe•Lí
, (
u8
 *)&
ª•
);

331 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

332 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

334 
g_zŒTouchLök
.
å™sIdLi„Timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökTimeout
, 
NULL
, 
ZB_INTER_PAN_TRANS_ID_LIFETIME
);

337 if(
g_zŒCommissi⁄
.
≠pCb
->
touchLökCÆlback
){

338 
g_zŒCommissi⁄
.
≠pCb
->
	`touchLökCÆlback
(
ZCL_ZLL_TOUCH_LINK_STA_TARGET_START
, 
NULL
);

340 
	}
}

352 
_CODE_ZCL_
 
	$z˛_zŒTouchLökSˇnRe•⁄£H™dÀr
(
z˛_zŒTouchLökSˇnRe•_t
 *
ª•
, 
ïInfo_t
 *
d°Ep
){

353 
z˛_zŒTouchLökSˇnRe•_t
 *
p
 = 
ª•
;

355 
u8
 
idx
 = 
g_zŒTouchLök
.
disc
->
èrgëNum
;

356 if(
idx
 >
g_zŒTouchLök
.
sˇnLi°Num
){

360 #ifde‡
ZB_SECURITY


361 
u16
 
m©ched_Æg‹ôhms
 = 0;

362 if((
m©ched_Æg‹ôhms
 = 
p
->
keyBômask
 & (1 << 
g_zŒTouchLök
.
keyTy≥
)) == 0){

367 
zŒ_touchLökSˇnInfo
 *
sˇnInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[
idx
];

370 
zŒ_touchLökSˇnInfo
 *
li°
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[0];

371 
u8
 
i
 = 0;

372 
i
 = 0; i < 
idx
; i++){

373 if(
	`ZB_64BIT_ADDR_CMP
(
li°
->
d°Ep
.
d°Addr
.
extAddr
, dstEp->dstAddr.extAddr)){

374 if(
p
->
ª•Id
 !
li°
->respId){

375 
sˇnInfo
 = 
li°
;

379 
li°
++;

382 if(
i
 >
idx
){

383 
g_zŒTouchLök
.
disc
->
èrgëNum
++;

386 
	`ZB_EXTPANID_COPY
(
sˇnInfo
->
ï™Id
, 
p
->epanId);

387 
sˇnInfo
->
∑nId
 = 
p
->panId;

388 
sˇnInfo
->
nwkAddr
 = 
p
->nwkAddr;

389 
sˇnInfo
->
zbInfo
.
byã
 = 
p
->zbInfo.byte;

390 
sˇnInfo
->
zŒInfo
.
byã
 = 
p
->zllInfo.byte;

391 
sˇnInfo
->
logiˇlCh™√l
 = 
p
->logicalChannel;

392 
sˇnInfo
->
numOfSubdevi˚s
 = 
p
->numOfSubdevices;

393 
sˇnInfo
->
tŸÆGroupIds
 = 
p
->totalGroupIds;

394 
sˇnInfo
->
ª•Id
 = 
p
->respId;

395 
sˇnInfo
->
nwkUpd©eId
 = 
p
->nwkUpdateId;

396 
	`mem˝y
((
u8
 *)&
sˇnInfo
->
d°Ep
, (u8 *)d°Ep, (
ïInfo_t
));

397 if(
sˇnInfo
->
numOfSubdevi˚s
 == 1){

398 
	`mem˝y
(&
sˇnInfo
->
devInfo
, &
p
->
subDevInfo
, (
z˛_zŒSubdevi˚Info_t
));

401 #ifde‡
ZB_SECURITY


403 
i
 = 0; i <
CERTIFICATION_KEY
; i++){

404 if((
m©ched_Æg‹ôhms
 & (1 << 
i
)Ë&& ((ò=
DEVELOPMENT_KEY
Ë|| (ò=
MASTER_KEY
Ë|| (ò=
CERTIFICATION_KEY
))){

405 
sˇnInfo
->
keyIdx
 = 
i
;

409 
	}
}

420 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDiscovîyd⁄e
(*
¨g
){

421 
z˛_zŒTouckLökDisc_t
 *
pDisc
 = 
g_zŒTouchLök
.
disc
;

423 if(
pDisc
->
èrgëNum
){

424 
g_zŒTouchLök
.
›Idx
 = 0;

425 
zŒ_touchLökSˇnInfo
 *
pSˇnInfo
 = &
pDisc
->
sˇnLi°
[
g_zŒTouchLök
.
›Idx
];

426 
u32
 
i
 = 0; i < 
pDisc
->
èrgëNum
; i++){

427 if(
pSˇnInfo
->
zŒInfo
.
bf
.
¥i‹ôyReq
){

428 
g_zŒTouchLök
.
›Idx
 = 
i
;

431 
pSˇnInfo
++;

434 
pSˇnInfo
 = &
pDisc
->
sˇnLi°
[
g_zŒTouchLök
.
›Idx
];

437 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
pSˇnInfo
->
logiˇlCh™√l
);

438 
g_zŒTouchLök
.
touchLökCh™
 = 
pSˇnInfo
->
logiˇlCh™√l
;

445 
g_zŒTouchLök
.
ª•Id
 = 
pSˇnInfo
->respId;

447 if(
ª£t2Fa˘‹yFœg
){

448 
	`z˛_zŒTouchLökRe£tFa˘‹yReq
(
NULL
);

449 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_SUCC
);

453 if(
pSˇnInfo
->
numOfSubdevi˚s
 > 1)

455 
u32
 
°¨t_idx
 = 0;

456 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°
, (*)
°¨t_idx
);

460 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökIdítifyReque°
, 
NULL
);

463 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NO_SERVER
);

465 
	}
}

476 
_CODE_ZCL_
 
s32
 
	$z˛_touchLökSˇnSèπ
(*
¨g
){

477 
z˛_zŒTouckLökDisc_t
 *
pDisc
 = 
g_zŒTouchLök
.
disc
;

478 
ïInfo_t
 
d°EpInfo
;

479 
u32
 
i
 = 0;

481 
	`TL_SETSTRUCTCONTENT
(
d°EpInfo
, 0);

483 
d°EpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

484 
d°EpInfo
.
d°Ep
 = 0;

485 
d°EpInfo
.
d°Addr
.
sh‹tAddr
 = 
MAC_SHORT_ADDR_BROADCAST
;

486 
d°EpInfo
.
¥ofûeId
 = 
LL_PROFILE_ID
;

487 
d°EpInfo
.
txO±i⁄s
 = 0;

488 
d°EpInfo
.
ødius
 = 0;

490 if(
g_zŒTouchLök
.
IsFú°Ch™√l
){

491 
pDisc
->
sˇnC¡
 = 5;

493 if(
g_zŒTouchLök
.
IsFú°Ch™√l
 || 
pDisc
->
sˇnC¡
 == 0){

494 
i
 = 
TL_ZB_MAC_CHANNEL_START
; i < 
TL_ZB_MAC_CHANNEL_STOP
+1; i++){

495 if(
pDisc
->
unsˇ¬edCh™√lMask
 & (1 << 
i
)){

496 
pDisc
->
cuºítSˇ¬Ch™√l
 = 
i
;

497 
g_zŒTouchLök
.
IsFú°Ch™√l
 = 0;

498 
pDisc
->
unsˇ¬edCh™√lMask
 &~(1 << 
i
);

503 if(
pDisc
->
sˇnC¡
 > 0){

504 
pDisc
->
sˇnC¡
--;

507 if(
i
 =
TL_ZB_MAC_CHANNEL_STOP
+1){

508 
pDisc
->
¥im¨yCh™√lSˇnCom∂ëe
 = 1;

511 if(!
pDisc
->
¥im¨yCh™√lSˇnCom∂ëe
){

513 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
pDisc
->
cuºítSˇ¬Ch™√l
);

516 
z˛_zŒTouchLökSˇnReq_t
 
sˇnReq
;

517 
sˇnReq
.
å™sId
 = 
g_zŒTouchLök
.transId;

518 
sˇnReq
.
zbInfo
.
byã
 = 
g_zŒTouchLök
.zbInfo.byte;

519 
sˇnReq
.
zŒInfo
.
byã
 = 
g_zŒTouchLök
.zllInfo.byte;

520 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
 , &
d°EpInfo
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_SCAN
, 
TRUE
, 
ZCL_FRAME_CLIENT_SERVER_DIR
, TRUE, 0,

521 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökSˇnReq_t
), (
u8
 *)&
sˇnReq
);

523 if(
g_zŒTouchLök
.
vDoPrim¨ySˇn
){

524 
g_zŒTouchLök
.
vDoPrim¨ySˇn
 = 0;

525 
pDisc
->
unsˇ¬edCh™√lMask
 = 
	`BDB_ATTR
().
£c⁄d¨yCh™√lSë
;

526 
pDisc
->
¥im¨yCh™√lSˇnCom∂ëe
 = 0;

527 if(
pDisc
->
unsˇ¬edCh™√lMask
){

528  
ZB_SCAN_TIME_BASE_DURATION
;

531 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökDiscovîyd⁄e
, 
NULL
);

532 
g_zŒTouchLök
.
runTimî
 = 
NULL
;

536  
ZB_SCAN_TIME_BASE_DURATION
;

537 
	}
}

547 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDiscoveySèπ
(){

549 if(
g_zŒTouchLök
.
runTimî
){

550 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
runTimî
);

552 
g_zŒTouchLök
.
runTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_touchLökSˇnSèπ
, 
NULL
, 5);

555 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

556 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

558 
g_zŒTouchLök
.
å™sIdLi„Timî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökTimeout
, 
NULL
, 
ZB_INTER_PAN_TRANS_ID_LIFETIME
);

559 
	}
}

570 
_CODE_ZCL_
 
	$z˛_zŒTouchLökDiscoveySt›
(){

571 if(
g_zŒTouchLök
.
runTimî
){

572 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
runTimî
);

575 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

576 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

579 if(
g_zŒTouchLök
.
disc
){

580 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
disc
);

581 
g_zŒTouchLök
.
disc
 = 
NULL
;

583 
	}
}

	@zigbee/zcl/zll_commissioning/zcl_zllTouchLinkJoinOrStart.c

27 
	~"../z˛_ö˛ude.h
"

28 
	~"z˛_zŒ_commissi⁄ög_öã∫Æ.h
"

30 
_CODE_ZCL_
 
z˛_zŒTouchLöNëw‹kSèπRe•CmdSíd
(*
¨g
);

40 
_CODE_ZCL_
 
	$é_zbNwkZŒCommissi⁄SˇnC⁄fúm
(*
¨g
){

41 
u8
 
ch™√l
 = 0xff;

42 
u8
 
∑nNumOnCh™√l
[16] = {0};

43 
u8
 
nodesOnCh™√l
 = 0xff;

45 
u32
 
i
 = 0;

46 
u8
 
√ighb‹Num
 = 
	`é_zbAddôi⁄Neighb‹TabÀNumGë
();

47 
é_zb_addôi⁄_√ighb‹_íåy_t
 *
pE¡ry
 = 
NULL
;

49 
i
 = 0; i < 
√ighb‹Num
; i++){

50 
pE¡ry
 = 
	`é_zbAddôi⁄Neighb‹E¡ryGëFromIdx
(
i
);

51 if(
pE¡ry
 &&ÖE¡ry->
logicCh™√l
 >
TL_ZB_MAC_CHANNEL_START
 &&ÖE¡ry->logicCh™√»<
TL_ZB_MAC_CHANNEL_STOP
){

52 
∑nNumOnCh™√l
[
pE¡ry
->
logicCh™√l
-
TL_ZB_MAC_CHANNEL_START
]++;

57 
i
 = 
TL_ZB_MAC_CHANNEL_START
 ; i <
TL_ZB_MAC_CHANNEL_STOP
 ; i++){

58 if((
g_zŒTouchLök
.
sˇnCh™Mask
 & (1 << 
i
)Ë&& 
∑nNumOnCh™√l
[i-
TL_ZB_MAC_CHANNEL_START
] < 
nodesOnCh™√l
){

59 
nodesOnCh™√l
 = 
∑nNumOnCh™√l
[
i
-
TL_ZB_MAC_CHANNEL_START
];

60 
ch™√l
 = 
i
;

65 
u32
 
unique_∑n_id
 = 0x00;

66 
u16
 
∑nId
 = 
	`ZB_RANDOM
();

67 !
unique_∑n_id
){

68 if(
∑nId
 =
MAC_INVALID_PANID
){

69 
∑nId
 = 
	`ZB_RANDOM
();

72 
i
 = 0; i < 
√ighb‹Num
; i++){

73 
pE¡ry
 = 
	`é_zbAddôi⁄Neighb‹E¡ryGëFromIdx
(
i
);

74 if(
pE¡ry
->
∑nId
 ==ÖanId){

75 
∑nId
++;

79 if(
i
 =
√ighb‹Num
){

80 
unique_∑n_id
 = 1;

84 
extPANId_t
 
extP™Id
;

85 
u16
 
øndom
[4] = {0};

86 
u32
 
i
 = 0; i < 4; i++){

87 
øndom
[
i
] = 
	`zb_øndom
();

89 
	`ZB_EXTPANID_COPY
(
extP™Id
, 
øndom
);

92 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
 = 
ch™√l
;

93 
	`é_zbAddôi⁄Neighb‹Re£t
();

96 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
g_zŒTouchLök
.
touchLökCh™
);

98 if(
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_INITIATOR
){

99 
	`NWK_NIB
().
∑nId
 =ÖanId;

100 
	`MAC_IB
().
∑nId
 =ÖanId;

101 
	`ZB_EXTPANID_COPY
(
	`NWK_NIB
().
extPANId
, 
extP™Id
);

102 
g_zbMacCtx
.
curCh™√l
 = 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
;

104 
u16
 
nwkAddr
 = 0xffff;

105 if(
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 == 0x0000){

106 
nwkAddr
 = 
	`é_zbNwkStocha°icAddrCÆ
();

108 
nwkAddr
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

110 
	`MAC_IB
().
sh‹tAddªss
 = 
nwkAddr
;

111 
	`NWK_NIB
().
nwkAddr
 = 
	`MAC_IB
().
sh‹tAddªss
;

114 
	`zb_rouãrSèπ
();

117 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
°¨tP¨ams
 = (z˛_zŒTouchLökNëw‹kSèπReq_à*)&
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

118 if(
	`ZB_EXTPANID_IS_ZERO
(
°¨tP¨ams
->
ï™Id
)){

119 
	`mem˝y
(
°¨tP¨ams
->
ï™Id
, 
extP™Id
, 8);

121 if(
°¨tP¨ams
->
∑nId
 == 0){

122 
°¨tP¨ams
->
∑nId
 =ÖanId;

124 
°¨tP¨ams
->
logiˇlCh™√l
 = 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
;

126 if(
g_zŒTouchLök
.
å™sId
 !0 && 
ch™√l
 != 0xff){

127 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLöNëw‹kSèπRe•CmdSíd
, (*)
SUCCESS
);

130 
	}
}

133 
	$touchlök_discovîy_√tw‹k
(
u32
 
ch™Mask
){

134 
∆me_nwkDisc_ªq_t
 
ªq
;

135 
	`TL_SETSTRUCTCONTENT
(
ªq
,0);

136 if(0 =
ch™Mask
){

137 
ªq
.
sˇnCh™√ls
 = 
	`BDB_ATTR
().
¥im¨yCh™√lSë
;

139 
ªq
.
sˇnCh™√ls
 = 
ch™Mask
;

141 
ªq
.
sˇnDuøti⁄
 = 
	`BDB_ATTR
().scanDuration;

143 
g_zŒTouchLök
.
sˇnCh™Mask
 = 
ch™Mask
;

144 
	`zb_nwkDiscReq
(&
ªq
, 
NLME_STATE_ZLL_COMMISSION
);

145 
	}
}

156 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimeout
(*
¨g
){

157 
g_zŒTouchLök
.
runTimî
 = 
NULL
;

158 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_STARTORJOIN_TIMEOUT
);

160 
	}
}

172 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimîSt›
(){

173 if(
g_zŒTouchLök
.
runTimî
){

174 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
runTimî
);

178 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

179 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

183 
	}
}

195 
_CODE_ZCL_
 
	$z˛_zŒTouchLökNëw‹kSèπDúe˘Joö
(*
¨g
){

196 if(
g_zŒTouchLök
.
å™sId
){

197 
g_zbNwkCtx
.
joöed
 = 1;

199 #ifde‡
ZB_ROUTER_ROLE


200 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
pInôüt‹
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

202 if((
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
)

203 && (
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
.
öôüt‹NwkAddr
 != 0)){

204 #ifde‡
ZB_ROUTER_ROLE


205 
∆me_dúe˘Joö_ªq_t
 
ªq
;

206 
ªq
.
nwkAddr
 = 
pInôüt‹
->
öôüt‹NwkAddr
;

207 
	`mem˝y
(
ªq
.
devi˚Addr
, 
pInôüt‹
->
öôüt‹IìeAddr
 , 8);

208 
ªq
.
ˇ∑bûôyInfo
.
devTy≥
 = (
g_zŒTouchLök
.
zbInfo
.
bf
.
logicDevTy≥
 & 0x02) ? 0 : 1;;

209 
ªq
.
ˇ∑bûôyInfo
.
rcvOnWhíIdÀ
 = 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
;

211 if(
	`zb_nwkDúe˘Joö
(
ªq
Ë!
RET_OK
){

212 if(
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_IDLE
){

213 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_FAIL
);

219 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_SUCC
);

222 if(
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_IDLE
){

223 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_FAIL
);

227 
	}
}

237 
_CODE_ZCL_
 
	$z˛_zŒTouchLökSèπRouãReque°
(){

238 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
°¨tP¨ams
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

242 
	`ss_nwkKeySt‹e
(
°¨tP¨ams
->
í¸y±edNwkKey
);

245 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 = 
°¨tP¨ams
->
‰ìNwkAddrR™geBegö
;

246 
g_touchlökAâr
.
‰ìNwkAddªssR™geEnd
 = 
°¨tP¨ams
->
‰ìNwkAddrR™geEnd
;

247 
g_touchlökAâr
.
‰ìGroupAddªssR™geBegö
 = 
°¨tP¨ams
->
‰ìGroupIdR™geBegö
;

248 
g_touchlökAâr
.
‰ìGroupAddªssR™geEnd
 = 
°¨tP¨ams
->
‰ìGroupIdR™geEnd
;

250 
	`MAC_IB
().
phyCh™√lCur
 = 
°¨tP¨ams
->
logiˇlCh™√l
;

251 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
	`MAC_IB
().
phyCh™√lCur
);

253 
	`NIB_NETWORK_ADDRESS
(Ë
°¨tP¨ams
->
nwkAddr
;

254 
	`ZB_PIB_SHORT_ADDRESS
(Ë
	`NIB_NETWORK_ADDRESS
();

255 
	`NWK_NIB
().
∑nId
 = 
°¨tP¨ams
->panId;

256 
	`NWK_NIB
().
nwkAddr
 = 
	`NIB_NETWORK_ADDRESS
();

257 
	`MAC_IB
().
∑nId
 = 
°¨tP¨ams
->panId;

258 
	`ZB_EXTPANID_COPY
(
	`NWK_NIB
().
extPANId
, 
°¨tP¨ams
->
ï™Id
);

259 
	`ZB_EXTPANID_COPY
(
≠s_ib
.
≠s_u£_ext_∑nid
, 
	`NWK_NIB
().
extPANId
);

262 
	`zb_rouãrSèπ
();

263 
	}
}

274 
_CODE_ZCL_
 
	$z˛_zŒTouchLökNëw‹kJoöRóljoö
(){

276 
z˛_zŒTouchLökNëw‹kJoöReq_t
 *
pReq
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kJoöCmd
;

279 
	`ss_nwkKeySt‹e
(
pReq
->
í¸y±edNwkKey
);

282 
	`MAC_IB
().
phyCh™√lCur
 = 
pReq
->
logiˇlCh™√l
;

283 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
	`MAC_IB
().
phyCh™√lCur
);

284 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
 = 
pReq
->
logiˇlCh™√l
;

287 
	`ZB_EXTPANID_COPY
(
	`NWK_NIB
().
extPANId
, 
pReq
->
ï™Id
);

288 
	`ZB_EXTPANID_COPY
(
≠s_ib
.
≠s_u£_ext_∑nid
, 
	`NWK_NIB
().
extPANId
);

291 
	`MAC_IB
().
∑nId
 = 
pReq
->panId;

294 
	`NIB_NETWORK_ADDRESS
(Ë
pReq
->
nwkAddr
;

295 
	`ZB_PIB_SHORT_ADDRESS
(Ë
	`NIB_NETWORK_ADDRESS
();

297 
	`NWK_NIB
().
∑nId
 = 
	`MAC_IB
().panId;

298 
	`NWK_NIB
().
nwkAddr
 = 
	`NIB_NETWORK_ADDRESS
();

301 
	`NWK_NIB
().
upd©eId
 = 
pReq
->
nwkUpd©eId
;

303 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 = 
pReq
->
‰ìNwkAddrR™geBegö
;

304 
g_touchlökAâr
.
‰ìNwkAddªssR™geEnd
 = 
pReq
->
‰ìNwkAddrR™geEnd
;

305 
g_touchlökAâr
.
‰ìGroupAddªssR™geBegö
 = 
pReq
->
‰ìGroupIdR™geBegö
;

306 
g_touchlökAâr
.
‰ìGroupAddªssR™geEnd
 = 
pReq
->
‰ìGroupIdR™geEnd
;

308 if(
	`af_nodeDevTy≥Gë
(Ë=
DEVICE_TYPE_END_DEVICE
){

309 
≠s_ib
.
≠s_authítiˇãd
 = 1;

310 
	`MAC_IB
().
rxOnWhíIdÀ
 = 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
;

311 
	`zb_ªjoö_mode_£t
(
REJOIN_SECURITY
);

312 
	`zdo_nwk_ªjoö_ªq
(
NLME_REJOIN_METHOD_REJOIN
, (1 << 
	`MAC_IB
().
phyCh™√lCur
));

313 }if(
	`af_nodeDevTy≥Gë
(Ë=
DEVICE_TYPE_ROUTER
){

315 
	`zb_rouãrSèπ
();

317 
	}
}

319 
_CODE_ZCL_
 
boﬁ
 
	$z˛_zŒTouchLökLóveCnfCb
(
∆me_Àave_˙f_t
 *
pLóveCnf
){

320 if(!
g_zŒTouchLök
.
√tw‹kSèπInfo
){

321  
FALSE
;

324 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
){

325 
	`z˛_zŒTouchLökSèπRouãReque°
();

326 }if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_JOIN
){

327 
	`z˛_zŒTouchLökNëw‹kJoöRóljoö
();

330  
TRUE
;

331 
	}
}

342 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökNëw‹kSèπOrJoöNwkLóve
(*
¨g
){

344 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

345 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

348 if(!
	`is_devi˚_Á˘‹y_√w
()){

349 
∆me_Àave_ªq_t
 
ÀaveReq
;

350 
ÀaveReq
.
ªjoö
 = 0;

351 
ÀaveReq
.
ªmoveChûdªn
 = 0;

352 
	`ZB_64BIT_ADDR_ZERO
(
ÀaveReq
.
devi˚Addr
);

353 
	`zb_∆meLóveReq
(&
ÀaveReq
);

355 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
){

356 
	`z˛_zŒTouchLökSèπRouãReque°
();

357 }if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_JOIN
){

358 
	`z˛_zŒTouchLökNëw‹kJoöRóljoö
();

363 
	}
}

373 
_CODE_ZCL_
 
	$z˛_zŒTouchLöNëw‹kSèπRe•CmdSíd
(*
¨g
){

374 if(!
g_zŒTouchLök
.
√tw‹kSèπInfo
){

377 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
.
å™sId
 == 0){

381 #ifde‡
ZB_ROUTER_ROLE


382 
u32
 
°©us
 = (u32)
¨g
;

383 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
°¨tP¨ams
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

384 
u8
 
tcAddr
[8] = { 0 };

385 
z˛_zŒTouchLökNëw‹kSèπRe•_t
 
°¨tRe•
 = { 0 };

387 
ïInfo_t
 
d°Ep
;

388 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

390 
	`mem˝y
(&
d°Ep
, &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
öôüt‹EpInfo
, (
ïInfo_t
));

392 #ifde‡
ZB_SECURITY


393 
	`mem£t
(
tcAddr
, 0xff, 8);

394 
	`ZB_IEEE_ADDR_COPY
(
ss_ib
.
åu°_˚¡î_addªss
, 
tcAddr
);

397 
°¨tRe•
.
å™sId
 = 
g_zŒTouchLök
.transId;

398 
°¨tRe•
.
°©us
 = (
u8
)status;

399 
°¨tRe•
.
nwkUpd©eId
 = 
	`NWK_NIB
().
upd©eId
;

400 
°¨tRe•
.
logiˇlCh™√l
 = 
°¨tP¨ams
->logicalChannel;

401 
°¨tRe•
.
∑nId
 = 
°¨tP¨ams
->panId;

402 
	`mem˝y
(
°¨tRe•
.
ï™Id
, 
°¨tP¨ams
->epanId, 8);

405 
u8
 
£qNo
 = 
g_zŒTouchLök
.
√tw‹kSèπInfo
->seqNo;

406 
u8
 
pktLí
 = (
z˛_zŒTouchLökNëw‹kSèπRe•_t
);

407 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START_RSP
, 
TRUE
,

408 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
TRUE
, 0, 
£qNo
, 
pktLí
, (
u8
 *)&
°¨tRe•
);

415 if(
°©us
 =
SUCCESS
){

416 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökNëw‹kSèπOrJoöNwkLóve
, 
NULL
, 100);

418 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_FAIL
);

422 
	}
}

433 
_CODE_ZCL_
 
	$z˛_zŒTouchLökNëw‹kSèπRequ°H™dÀr
(
u8
 
logicCh™√l
){

435 if(!
g_zŒTouchLök
.
°¨tNëw‹kAŒowed
){

436 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLöNëw‹kSèπRe•CmdSíd
, (*)
FAILURE
);

444 if(
logicCh™√l
 >
TL_ZB_MAC_CHANNEL_START
 &&ÜogicCh™√»<
TL_ZB_MAC_CHANNEL_STOP
){

445 
	`touchlök_discovîy_√tw‹k
(1 << (
logicCh™√l
));

447 
	`touchlök_discovîy_√tw‹k
(
ZB_ZLL_PRIMARY_CHANNELS_MASK
);

449 
	}
}

461 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökNëw‹kSèπRe•⁄£H™dÀr
(*
¨g
){

462 
z˛_zŒTouchLökNëw‹kSèπRe•_t
 *
p
 = (z˛_zŒTouchLökNëw‹kSèπRe•_à*)
¨g
;

463 if(
p
->
°©us
 =
SUCCESS
){

465 
	`MAC_IB
().
rxOnWhíIdÀ
 = 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
;

466 
	`zb_ªjoö_mode_£t
(
REJOIN_SECURITY
);

467 
	`zdo_nwk_ªjoö_ªq
(
NLME_REJOIN_METHOD_REJOIN
, 1<<(
p
->
logiˇlCh™√l
));

469 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NO_SERVER
);

478 
	`ev_buf_‰ì
((
u8
 *)
¨g
);

480 
	}
}

491 
_CODE_ZCL_
 
	$z˛_zŒTouchLökNëw‹kJoöReque°H™dÀr
(
u8
 
cmd
){

496 
z˛_zŒTouchLökNëw‹kJoöRe•_t
 
joöRe•
 = { 0 };

497 
ïInfo_t
 
d°Ep
;

498 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

500 
	`mem˝y
(&
d°Ep
, &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
öôüt‹EpInfo
, (
ïInfo_t
));

502 if(!
g_zŒTouchLök
.
°¨tNëw‹kAŒowed
)

505 
joöRe•
.
°©us
 = 
FAILURE
;

509 
joöRe•
.
°©us
 = 
SUCCESS
;

512 if(!
	`ss_£curôyModeIsDi°ribuãd
(Ë&& 
	`BDB_ATTR
().
nodeIsOnANëw‹k
){

513 
joöRe•
.
°©us
 = 
FAILURE
;

516 
joöRe•
.
å™sId
 = 
g_zŒTouchLök
.transId;

518 
u8
 
£qNo
 = 
g_zŒTouchLök
.
√tw‹kSèπInfo
->seqNo;

519 
u8
 
pktLí
 = (
z˛_zŒTouchLökNëw‹kJoöRe•_t
);

520 
u8
 
ª•Cmd
 = 0xff;

521 if(
cmd
 =
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER
){

522 
ª•Cmd
 = 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER_RSP
;

523 }if(
cmd
 =
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE
){

524 
ª•Cmd
 = 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE_RSP
;

526 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ª•Cmd
, 
TRUE
,

527 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
TRUE
, 0, 
£qNo
, 
pktLí
, (
u8
 *)&
joöRe•
);

530 if(
joöRe•
.
°©us
 =
FAILURE
)

532 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NOT_PERMITTED
);

539 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökNëw‹kSèπOrJoöNwkLóve
, 
NULL
, 100);

542 
	}
}

555 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökNëwokJoöRe•⁄£H™dÀr
(*
¨g
){

556 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_SUCC
);

558 
	}
}

572 
_CODE_ZCL_
 
	$z˛_zŒTouchLökNëw‹kSèπOrJoö
(*
¨g
){

573 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

574 
ïInfo_t
 
d°Ep
;

575 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

577 
	`mem˝y
((
u8
 *)&
d°Ep
,(u8 *)&
≥îInfo
->dstEp, (dstEp));

579 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
g_zŒTouchLök
.
touchLökCh™
);

581 #ifde‡
ZB_SECURITY


583 
u8
 
í¸y±edNwkKey
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4) ;

584 
	`Œ_gë_í¸y±ed_√tw‹k_key
(
≥îInfo
->
keyIdx
, 
g_zŒTouchLök
.
å™sId
, g_zŒTouchLök.
ª•Id
, 
í¸y±edNwkKey
);

587 if(!
	`BDB_ATTR
().
nodeIsOnANëw‹k
){

588 
u8
 
£lfF‹m
 = 0;

589 if(
g_zŒTouchLök
.
zbInfo
.
bf
.
logicDevTy≥
 =
DEVICE_TYPE_ROUTER
){

591 
	`touchlök_discovîy_√tw‹k
(
ZB_ZLL_PRIMARY_CHANNELS_MASK
);

593 
£lfF‹m
 = 1;

599 if–
≥îInfo
->
zbInfo
.
bf
.
logicDevTy≥
 =
DEVICE_TYPE_END_DEVICE
){

600 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_NO_SERVER
);

607 if(!
£lfF‹m
){

608 
z˛_zŒTouchLökNëw‹kSèπReq_t
 
°¨tReq
 = { 0 };

609 
°¨tReq
.
å™sId
 = 
g_zŒTouchLök
.transId;

610 
	`mem˝y
(
°¨tReq
.
ï™Id
, 
	`NWK_NIB
().
extPANId
, (
addrExt_t
));

611 
°¨tReq
.
∑nId
 = 0x0000;

612 
°¨tReq
.
logiˇlCh™√l
 = 
	`MAC_IB
().
phyCh™√lCur
;

613 
	`mem˝y
(
°¨tReq
.
öôüt‹IìeAddr
, 
	`NIB_IEEE_ADDRESS
(), (
addrExt_t
));

615 
°¨tReq
.
groupIdbegö
 = 
APS_GROUP_TABLE_SIZE
 + 1;

616 
°¨tReq
.
groupIdEnd
 = 
APS_GROUP_TABLE_SIZE
 + 
≥îInfo
->
tŸÆGroupIds
 + 1;

621 
°¨tReq
.
groupIdbegö
 = 
APS_GROUP_TABLE_SIZE
 + 1;

622 
°¨tReq
.
groupIdEnd
 = 
APS_GROUP_TABLE_SIZE
 + 
≥îInfo
->
tŸÆGroupIds
 + 1;

624 
u16
 
nwkAddr
 = 0;

625 if(
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 == 0x0000){

626 
nwkAddr
 = 
	`é_zbNwkStocha°icAddrCÆ
();

627 
°¨tReq
.
öôüt‹NwkAddr
 = 
nwkAddr
;

628 
°¨tReq
.
nwkAddr
 =ÇwkAddr + 1;

630 
°¨tReq
.
öôüt‹NwkAddr
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

631 
°¨tReq
.
nwkAddr
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

633 if(
≥îInfo
->
zŒInfo
.
bf
.
addrAssign
){

634 
°¨tReq
.
‰ìNwkAddrR™geBegö
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

635 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 +
ZB_ADDR_RANGE_ASSIGNED_FOR_TARGET
;

636 
°¨tReq
.
‰ìNwkAddrR™geEnd
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

639 
°¨tReq
.
‰ìGroupIdR™geBegö
 = 0;

640 
°¨tReq
.
‰ìGroupIdR™geEnd
 = 0;

643 
≥îInfo
->
nwkAddr
 = 
°¨tReq
.nwkAddr;

645 #ifde‡
ZB_SECURITY


646 
°¨tReq
.
keyIdx
 = 
≥îInfo
->keyIdx;

647 
	`mem˝y
(
°¨tReq
.
í¸y±edNwkKey
,Én¸y±edNwkKey, 
CCM_KEY_SIZE
);

650 
	`NWK_NIB
().
nwkAddr
 = 
°¨tReq
.
öôüt‹NwkAddr
;

651 
	`MAC_IB
().
sh‹tAddªss
 = 
	`NWK_NIB
().
nwkAddr
;

654 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_START
;

655 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START
, 
TRUE
,

656 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökNëw‹kSèπReq_t
), (
u8
 *)&
°¨tReq
);

662 
z˛_zŒTouchLökNëw‹kJoöReq_t
 
joöReq
 = { 0 };

663 
joöReq
.
å™sId
 = 
g_zŒTouchLök
.transId;

664 
joöReq
.
nwkUpd©eId
 = 
	`NWK_NIB
().
upd©eId
;

665 #ifde‡
ZB_SECURITY


666 
joöReq
.
keyIdx
 = 
≥îInfo
->keyIdx;

667 
	`mem˝y
(
joöReq
.
í¸y±edNwkKey
,Én¸y±edNwkKey, 
CCM_KEY_SIZE
);

669 
	`mem˝y
(
joöReq
.
ï™Id
, 
	`NWK_NIB
().
extPANId
, (
addrExt_t
));

670 
joöReq
.
∑nId
 = 
	`MAC_IB
().panId;

671 
joöReq
.
logiˇlCh™√l
 = 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
;

673 
joöReq
.
groupIdBegö
 = 
APS_GROUP_TABLE_SIZE
 + 1;

674 
joöReq
.
groupIdEnd
 = 
APS_GROUP_TABLE_SIZE
 + 
≥îInfo
->
tŸÆGroupIds
 + 1;

676 if(
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 == 0x0000){

677 
u16
 
nwkAddr
 = 
	`é_zbNwkStocha°icAddrCÆ
();

678 
joöReq
.
nwkAddr
 =ÇwkAddr;

680 
joöReq
.
nwkAddr
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

681 if(
≥îInfo
->
zŒInfo
.
bf
.
addrAssign
){

682 
joöReq
.
‰ìNwkAddrR™geBegö
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

683 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 +
ZB_ADDR_RANGE_ASSIGNED_FOR_TARGET
;

684 
joöReq
.
‰ìNwkAddrR™geEnd
 = 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
++;

687 
joöReq
.
‰ìGroupIdR™geBegö
 = 0;

688 
joöReq
.
‰ìGroupIdR™geEnd
 = 0;

691 
≥îInfo
->
nwkAddr
 = 
joöReq
.nwkAddr;

692 
u8
 
∂dLí
 = (
z˛_zŒTouchLökNëw‹kJoöReq_t
);

693 
u8
 
cmd
 = 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER
;

694 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ROUTE
;

695 if(
≥îInfo
->
zbInfo
.
bf
.
logicDevTy≥
 =
DEVICE_TYPE_END_DEVICE
){

696 
cmd
 = 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE
;

697 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ED
;

700 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
cmd
, 
TRUE
,

701 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, 
∂dLí
, (
u8
 *)&
joöReq
);

710 if(
g_zŒTouchLök
.
runTimî
){

711 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
runTimî
);

713 
g_zŒTouchLök
.
runTimî
 = 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimeout
, 
NULL
, 
ZB_RX_WINDOW_DURATION
);

714 
	}
}

717 
s32
 
	$z˛_touchLökDevSèπIndiˇã
(*
¨g
){

720 
u32
 
°¨tSètus
 = (u32)
¨g
;

722 if(
°¨tSètus
 =
SUCCESS
){

723 if(
g_zŒTouchLök
.
zbInfo
.
bf
.
logicDevTy≥
 =
DEVICE_TYPE_END_DEVICE
){

724 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_SUCC
);

726 if(
g_bdbCtx
.
rﬁe
 =
BDB_COMMISSIONING_ROLE_INITIATOR
){

727 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökNëw‹kSèπOrJoö
, 
NULL
);

729 
	`TL_SCHEDULE_TASK
(
z˛_zŒTouchLökNëw‹kSèπDúe˘Joö
, 
NULL
);

733 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_FAIL
);

736 
	}
}

738 
_CODE_ZCL_
 
	$z˛_zŒTouchLökRe£tFa˘‹yReq
(*
¨g
){

739 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

740 
ïInfo_t
 
d°Ep
;

741 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

743 
	`mem˝y
((
u8
 *)&
d°Ep
,(u8 *)&
≥îInfo
->dstEp, (dstEp));

745 
z˛_zŒTouchLökRe£tFa˘‹yReq_t
 
ªq
;

746 
ªq
.
å™sId
 = 
g_zŒTouchLök
.transId;

748 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_IDENTIFY
;

749 
	`z˛_£ndI¡îPANCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, &
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_RESET_TO_FACTORY_NEW
, 
TRUE
,

750 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒTouchLökRe£tFa˘‹yReq_t
), (
u8
 *)&
ªq
);

751 
	}
}

	@zigbee/zcl/zll_commissioning/zcl_zll_commissioning.c

27 
	~"../z˛_ö˛ude.h
"

28 
	~"z˛_zŒ_commissi⁄ög_öã∫Æ.h
"

33 
	#DEBUG_TOUCHLINK_EN
 0

	)

48 
z˛_zŒTouckLök_t
 
	gg_zŒTouchLök
 = {

49 .
lqiThªshﬁd
 = 0xa0,

50 .
	gcommissi⁄TxPowî
 = 
ZB_RADIO_TX_0DBM
,

51 .
	gkeyTy≥
 = 
MASTER_KEY
,

54 
boﬁ
 
	gsˇnReqProfûeI¡î›
 = 0;

56 
z˛_zŒCommissi⁄_t
 
	gg_zŒCommissi⁄
;

58 
touchlök_©å_t
 
	gg_touchlökAârD·
 = { 0x0001, 0xfff7, 0x0001, 0xfeff };

60 
zdo_touchLökCb_t
 
	gtouchLökCb
 = {
z˛_zŒTouchLökLóveCnfCb
};

62 
nwkF‹TouchlökCb_t
 
	gg_nwkTouchlökCb
 = {

63 .
sˇnC⁄fCb
 = 
é_zbNwkZŒCommissi⁄SˇnC⁄fúm
,

64 .
	g©åCÃCb
 = 
Œ_zŒAârCÃ
,

67 
	#TOUCHLIK_INITIATOR_SET
(
mode
Ë
g_zŒTouchLök
.
zŒInfo
.
bf
.
lökInôüt‹
 = 
	)
mode

68 
	#TOUCHLIK_ADDR_ASSIGN_SET
(
mode
Ë
g_zŒTouchLök
.
zŒInfo
.
bf
.
addrAssign
 = 
	)
mode

69 
	#TOUCHLIK_FACTORY_NEW_SET
(
mode
Ë
g_zŒTouchLök
.
zŒInfo
.
bf
.
Á˘‹yNew
 = 
	)
mode

70 
	#TOUCHLIK_PROFILE_INTEROP_SET
(
mode
Ë
g_zŒTouchLök
.
zŒInfo
.
bf
.
¥ofûeI¡î›
 = 
	)
mode

80 
_CODE_ZCL_
 
	$z˛_zŒGëGroupIdítifõrsReque°
(
ïInfo_t
* 
pD°EpInfo
, 
u8
 
°¨tIdx
){

81 
u8
 
buf
[1];

82 
buf
[0] = 
°¨tIdx
;

83 
	`z˛_£ndCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
pD°EpInfo
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS
, 
TRUE
,

84 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, 1, 
buf
);

85 
	}
}

96 
_CODE_ZCL_
 
	$z˛_zŒGëGroupIdítifõrsReque°H™dÀr
(
u8
 
°¨tIdx
, 
ïInfo_t
 *
d°EpInfo
){

97 
z˛_zŒUtûôyGëGroupIdsRe•_t
 *
pRe•
 = 
NULL
;

98 
u8
 
groupsNum
 = 0;

99 
u16
 
groupIds
[
APS_GROUP_TABLE_SIZE
];

101 
	`≠s_group_li°_gë
(&
groupsNum
, 
groupIds
);

103 
u8
 
pktLí
 = 
groupsNum
 * (
z˛_groupInfo
) + 3;

104 
pRe•
 = (
z˛_zŒUtûôyGëGroupIdsRe•_t
 *)
	`ev_buf_Æloˇã
(
pktLí
);

105 if(
pRe•
){

106 
pRe•
->
tŸÆ
 = 
groupsNum
;

107 
pRe•
->
°¨tIdx
 = (°¨tIdx >
groupsNum
)? 0 : startIdx;

108 
pRe•
->
cou¡
 = 0;

109 
z˛_groupInfo
 *
pLi°
 = (z˛_groupInfÿ*)&
pRe•
->
groupInfoRec‹d
;

110 
s32
 
i
 = 0; i < 
groupsNum
; i++){

111 if(
i
 >
°¨tIdx
){

112 
pLi°
->
groupId
 = 
groupIds
[
i
];

113 
pLi°
->
groupTy≥
 = 0x00;

114 
pRe•
->
cou¡
++;

115 
pLi°
++;

118 
	`z˛_£ndCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
d°EpInfo
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS_RSP
, 
TRUE
,

119 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
FALSE
, 0, 
g_zŒTouchLök
.
£qNo
++, 
pktLí
, (
u8
 *)
pRe•
);

121 
	`ev_buf_‰ì
((
u8
 *)
pRe•
);

123 
	}
}

134 
_CODE_ZCL_
 
	$z˛_zŒGëGroupIdítifõrsRe•⁄£H™dÀr
(
z˛_zŒUtûôyGëGroupIdsRe•_t
 *
ª•
){

135 if(
g_zŒCommissi⁄
.
≠pCb
->
utûôyAµCÆlback
){

136 
g_zŒCommissi⁄
.
≠pCb
->
	`utûôyAµCÆlback
(
ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS_RSP
, 
ª•
);

138 
	}
}

149 
_CODE_ZCL_
 
	$z˛_zŒGëEndpoötLi°Reque°
(
ïInfo_t
* 
pD°EpInfo
, 
u8
 
°¨tIdx
){

150 
u8
 
˘x
 = 
°¨tIdx
;

151 
	`z˛_£ndCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
pD°EpInfo
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST
, 
TRUE
,

152 
ZCL_FRAME_CLIENT_SERVER_DIR
, 
TRUE
, 0, 
g_zŒTouchLök
.
£qNo
++, 1, &
˘x
);

153 
	}
}

164 
_CODE_ZCL_
 
	$z˛_zŒGëEndpoötLi°Reque°H™dÀr
(
u8
 
°¨tIdx
, 
ïInfo_t
 *
d°EpInfo
){

165 
z˛_zŒUtûôyGëEpLi°Re•_t
 *
pRe•
 = 
NULL
;

166 
u8
 
avaEpNum
 = 
	`af_avaûabÀEpNumGë
();

168 
u16
 
Àn
 = (
avaEpNum
 * (
z˛_zŒEndpoötInfo_t
) + 3);

169 
pRe•
 = (
z˛_zŒUtûôyGëEpLi°Re•_t
 *)
	`ev_buf_Æloˇã
(
Àn
);

170 if(
pRe•
){

171 
pRe•
->
tŸÆ
 = 
avaEpNum
;

172 
pRe•
->
°¨tIdx
 = (°¨tIdx >
avaEpNum
) ? 0 : startIdx;

173 
pRe•
->
cou¡
 = 0;

174 
af_ídpoöt_des¸ùt‹_t
 *
´d
 = 
	`af_ïDes¸ùt‹Gë
();

176 
z˛_zŒEndpoötInfo_t
 *
pLi°
 = (z˛_zŒEndpoötInfo_à*)&
pRe•
->
ïInfoRec‹d
;

177 
s32
 
i
 = 
°¨tIdx
; i < 
avaEpNum
; i++){

178 
pLi°
->
nwkAddr
 = 
	`NIB_NETWORK_ADDRESS
();

179 
pLi°
->
ïId
 = 
´d
[
i
].
ï
;

180 
pLi°
->
devi˚Id
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_id
;

181 
pLi°
->
¥ofûeId
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
;

182 
pLi°
->
vîsi⁄
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_vî
;

183 
pLi°
++;

184 
pRe•
->
cou¡
++;

187 
	`z˛_£ndCmd
(
g_zŒTouchLök
.
devInfo
.
ïId
, 
d°EpInfo
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST_RSP
, 
TRUE
,

188 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
FALSE
, 0, 
g_zŒTouchLök
.
£qNo
++, 
Àn
, (
u8
 *)
pRe•
);

190 
	`ev_buf_‰ì
((
u8
 *)
pRe•
);

192 
	}
}

204 
_CODE_ZCL_
 
	$z˛_zŒGëEndpoötLi°Re•⁄£H™dÀr
(
z˛_zŒUtûôyGëEpLi°Re•_t
 *
ª•
){

205 if(
g_zŒCommissi⁄
.
≠pCb
->
utûôyAµCÆlback
){

206 
g_zŒCommissi⁄
.
≠pCb
->
	`utûôyAµCÆlback
(
ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST_RSP
, 
ª•
);

208 
	}
}

219 
_CODE_ZCL_
 
	$z˛_zŒEndpoötInf‹m©i⁄
(
ïInfo_t
 *
d°Ep
){

220 
z˛_zŒUtûôyEndpoötInfo_t
 
ïInfoCmd
;

221 
af_ídpoöt_des¸ùt‹_t
 *
´d
 = 
	`af_ïDes¸ùt‹Gë
();

222 
	`mem˝y
(
ïInfoCmd
.
õìAddr
, 
	`NIB_IEEE_ADDRESS
(), (
addrExt_t
));

223 
ïInfoCmd
.
öfo
.
nwkAddr
 = 
	`NIB_NETWORK_ADDRESS
();

224 
ïInfoCmd
.
öfo
.
ïId
 = 
´d
[0].
ï
;

225 
ïInfoCmd
.
öfo
.
devi˚Id
 = 
´d
[0].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_id
;

226 
ïInfoCmd
.
öfo
.
¥ofûeId
 = 
´d
[0].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
;

227 
ïInfoCmd
.
öfo
.
vîsi⁄
 = 
´d
[0].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_vî
;

229 
	`z˛_£ndCmd
(
´d
[0].
ï
, 
d°Ep
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
ZCL_CMD_ZLL_COMMISSIONING_ENDPOINT_INFORMATION
, 
TRUE
,

230 
ZCL_FRAME_SERVER_CLIENT_DIR
, 
FALSE
, 0, 
g_zŒTouchLök
.
£qNo
++, (
z˛_zŒUtûôyEndpoötInfo_t
), (
u8
 *)&
ïInfoCmd
);

231 
	}
}

241 
_CODE_ZCL_
 
	$z˛_zŒEndpoötInf‹m©i⁄H™dÀr
(
z˛_zŒUtûôyEndpoötInfo_t
 *
ïInfo
){

242 if(
g_zŒCommissi⁄
.
≠pCb
->
utûôyAµCÆlback
){

243 
g_zŒCommissi⁄
.
≠pCb
->
	`utûôyAµCÆlback
(
ZCL_CMD_ZLL_COMMISSIONING_ENDPOINT_INFORMATION
, 
ïInfo
);

245 
	}
}

256 
_CODE_ZCL_
 
	$z˛_zŒTouchLökFöish
(
u8
 
°©us
){

257 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_IDLE
;

258 
g_zŒTouchLök
.
°©us
 = status;

260 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
g_zŒTouchLök
.
w‹kögCh™√lBackUp
);

261 
	`MAC_IB
().
rxOnWhíIdÀ
 = 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
;

263 
	`rf_£tTxPowî
(
g_zb_txPowîSë
);

264 #ifde‡
ZB_ED_ROLE


266 
	`zb_£tPﬁlR©e
(
RESPONSE_POLL_RATE
);

269 
g_zŒTouchLök
.
å™sId
 = 0;

270 
ïInfo_t
 
≥îEpInfo
;

271 
	`TL_SETSTRUCTCONTENT
(
≥îEpInfo
,0);

273 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
){

274 
	`mem˝y
(&
≥îEpInfo
, &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
öôüt‹EpInfo
, (
ïInfo_t
));

275 
≥îEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

276 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 =
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
){

277 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
pSèπReq
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

278 
≥îEpInfo
.
d°Addr
.
sh‹tAddr
 = 
pSèπReq
->
nwkAddr
;

280 
z˛_zŒTouchLökNëw‹kJoöReq_t
 *
pJoöReq
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kJoöCmd
;

281 
≥îEpInfo
.
d°Addr
.
sh‹tAddr
 = 
pJoöReq
->
nwkAddr
;

284 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
√tw‹kSèπInfo
);

285 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = 
NULL
;

288 if(
g_zŒTouchLök
.
disc
){

289 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

290 
≥îEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

291 
≥îEpInfo
.
d°Addr
.
sh‹tAddr
 = 
≥îInfo
->
nwkAddr
;

292 
≥îEpInfo
.
d°Ep
 = 
≥îInfo
->
devInfo
.
ïId
;

293 
≥îEpInfo
.
¥ofûeId
 = 
≥îInfo
->
devInfo
.profileId;

294 
≥îEpInfo
.
ødius
 = 0;

295 
≥îEpInfo
.
txO±i⁄s
 = 0;

296 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
disc
);

297 
g_zŒTouchLök
.
disc
 = 
NULL
;

300 if(
g_zŒTouchLök
.
å™sIdLi„Timî
){

301 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
å™sIdLi„Timî
);

304 if(
g_zŒTouchLök
.
runTimî
){

305 
	`TL_ZB_TIMER_CANCEL
(&
g_zŒTouchLök
.
runTimî
);

308 if(
g_zŒCommissi⁄
.
≠pCb
->
touchLökCÆlback
){

310 if(
≥îEpInfo
.
d°AddrMode
 == 0){

311 
g_zŒCommissi⁄
.
≠pCb
->
	`touchLökCÆlback
(
°©us
, 
NULL
);

313 
g_zŒCommissi⁄
.
≠pCb
->
	`touchLökCÆlback
(
°©us
, &
≥îEpInfo
);

316 
	`TOUCHLIK_INITIATOR_SET
(0);

317 
	`TOUCHLIK_ADDR_ASSIGN_SET
(0);

318 
	`TOUCHLIK_FACTORY_NEW_SET
(
	`is_devi˚_Á˘‹y_√w
());

319 
	}
}

329 
_CODE_ZCL_
 
s32
 
	$z˛_zŒTouchLökTimeout
(*
¨g
){

330 
g_zŒTouchLök
.
å™sIdLi„Timî
 = 
NULL
;

331 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_TIMEOUT
);

333 
	}
}

343 
_CODE_ZCL_
 
u8
 
	$z˛_touchLökClõ¡CmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
){

344 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

345 
u8
 
cmd
 = 
pInMsg
->
hdr
.cmd;

346 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

348 
ïInfo_t
 
§cEpInfo
;

350 
	`TL_SETSTRUCTCONTENT
(
§cEpInfo
, 0);

352 
§cEpInfo
.
d°AddrMode
 = 
APS_LONG_DSTADDR_WITHEP
;

353 
	`mem˝y
(
§cEpInfo
.
d°Addr
.
extAddr
, 
pApsdeInd
->
ödInfo
.
§c_ext_addr
, 8);

354 
§cEpInfo
.
d°Ep
 = 
pApsdeInd
->
ödInfo
.
§c_ï
;

355 
§cEpInfo
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

356 
§cEpInfo
.
ødius
 = 0;

357 
§cEpInfo
.
txO±i⁄s
 = 0;

359 
cmd
) {

360 
ZCL_CMD_ZLL_COMMISSIONING_SCAN
:

371 if(
pApsdeInd
->
ödInfo
.
lqi
 < 
g_zŒTouchLök
.
lqiThªshﬁd
){

375 
z˛_zŒTouchLökSˇnReq_t
 
sˇnReq
;

376 
	`mem˝y
((
u8
 *)&
sˇnReq
, 
pInMsg
->
pD©a
,(scanReq));

377 if(
sˇnReq
.
å™sId
 =
g_zŒTouchLök
.å™sId || (g_zŒTouchLök.
°©e
 & 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_STARTORJOIN
) == ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_STARTORJOIN){

380 if(!
	`is_devi˚_Á˘‹y_√w
(Ë&& 
g_zŒTouchLök
.
°©e
 =
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
){

383 if(
sˇnReq
.
zŒInfo
.
bf
.
lökInôüt‹
 != 1)

389 
g_zŒTouchLök
.
ª•Id
 = 
	`ZB_RANDOM
() << 16;

390 
g_zŒTouchLök
.
ª•Id
 +
	`ZB_RANDOM
();

391 
g_zŒTouchLök
.
å™sId
 = 
sˇnReq
.transId;

392 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
;

393 
sˇnReqProfûeI¡î›
 = 
sˇnReq
.
zŒInfo
.
bf
.
¥ofûeI¡î›
;

395 
	`z˛_zŒTouchLökSˇnReque°H™dÀr
(&
§cEpInfo
, 
pInMsg
->
hdr
.
£qNum
);

400 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START
:

405 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = (
z˛_zŒTouckLökNëw‹kSèπP¨ams
 *)
	`ev_buf_Æloˇã
((zcl_zllTouckLinkNetworkStartParams));

406 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
){

407 
	`mem£t
((
u8
 *)
g_zŒTouchLök
.
√tw‹kSèπInfo
, 0, (
z˛_zŒTouckLökNëw‹kSèπP¨ams
));

408 
z˛_zŒTouchLökNëw‹kSèπReq_t
 *
pReq
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kSèπCmd
;

409 
	`mem˝y
(
pReq
, (
u8
 *)
pInMsg
->
pD©a
, (
z˛_zŒTouchLökNëw‹kSèπReq_t
));

411 if(
pReq
->
å™sId
 =
g_zŒTouchLök
.transId){

412 #ifde‡
ZB_SECURITY


413 
u8
 
í¸y±edNwkKey
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4);

414 
	`mem˝y
(
í¸y±edNwkKey
, 
pReq
->í¸y±edNwkKey, 
CCM_KEY_SIZE
);

415 
	`Œ_de¸y±_√tw‹k_key
(
pReq
->
keyIdx
, 
í¸y±edNwkKey
, 
g_zŒTouchLök
.
å™sId
, g_zŒTouchLök.
ª•Id
);

416 
	`mem˝y
(
pReq
->
í¸y±edNwkKey
,Én¸y±edNwkKey, 
CCM_KEY_SIZE
);

418 
g_zŒTouchLök
.
√tw‹kSèπInfo
->
£qNo
 = 
pInMsg
->
hdr
.
£qNum
;

419 
	`mem˝y
(&
g_zŒTouchLök
.
√tw‹kSèπInfo
->
öôüt‹EpInfo
, &
§cEpInfo
, (
ïInfo_t
));

420 
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 = 
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
;

421 
	`z˛_zŒTouchLökNëw‹kSèπRequ°H™dÀr
(
pReq
->
logiˇlCh™√l
);

423 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
√tw‹kSèπInfo
);

424 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = 
NULL
;

432 #ifde‡
ZB_ROUTER_ROLE


433 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER
:

436 #ifde‡
ZB_ED_ROLE


437 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE
:

443 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = (
z˛_zŒTouckLökNëw‹kSèπP¨ams
 *)
	`ev_buf_Æloˇã
((zcl_zllTouckLinkNetworkStartParams));

444 if(
g_zŒTouchLök
.
√tw‹kSèπInfo
){

445 
z˛_zŒTouchLökNëw‹kJoöReq_t
 *
pReq
 = &
g_zŒTouchLök
.
√tw‹kSèπInfo
->
∑øms
.
√tw‹kJoöCmd
;

446 
	`mem˝y
(
pReq
, (
u8
 *)
pInMsg
->
pD©a
, (
z˛_zŒTouchLökNëw‹kJoöReq_t
));

448 if(
pReq
->
å™sId
 =
g_zŒTouchLök
.transId){

449 #ifde‡
ZB_SECURITY


450 
u8
 
í¸y±edNwkKey
[
CCM_KEY_SIZE
] 
	`_©åibuã_Æig√d_
(4);

451 
	`mem˝y
(
í¸y±edNwkKey
, 
pReq
->í¸y±edNwkKey, 
CCM_KEY_SIZE
);

452 
	`Œ_de¸y±_√tw‹k_key
(
pReq
->
keyIdx
, 
í¸y±edNwkKey
, 
g_zŒTouchLök
.
å™sId
, g_zŒTouchLök.
ª•Id
);

453 
	`mem˝y
(
pReq
->
í¸y±edNwkKey
,Én¸y±edNwkKey, 
CCM_KEY_SIZE
);

455 
g_zŒTouchLök
.
√tw‹kSèπInfo
->
£qNo
 = 
pInMsg
->
hdr
.
£qNum
;

456 
	`mem˝y
(&
g_zŒTouchLök
.
√tw‹kSèπInfo
->
öôüt‹EpInfo
, &
§cEpInfo
, (
ïInfo_t
));

457 
g_zŒTouchLök
.
√tw‹kSèπInfo
->
joöNëw‹kMode
 = 
ZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_JOIN
;

458 
	`z˛_zŒTouchLökNëw‹kJoöReque°H™dÀr
(
cmd
);

460 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
√tw‹kSèπInfo
);

461 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = 
NULL
;

468 
ZCL_CMD_ZLL_COMMISSIONING_RESET_TO_FACTORY_NEW
:

470 
u32
 
å™sId
 = 0xFFFFFFFF;

471 
	`mem˝y
(&
å™sId
, 
pInMsg
->
pD©a
, (
u32
));

472 if(
å™sId
 =
g_zŒTouchLök
.transId){

473 if(!
	`is_devi˚_Á˘‹y_√w
()){

474 if(
	`ss_£curôyModeIsDi°ribuãd
()){

475 
∆me_Àave_ªq_t
 
ÀaveReq
;

476 
ÀaveReq
.
ªjoö
 = 0;

477 
ÀaveReq
.
ªmoveChûdªn
 = 0;

478 
	`mem£t
(
ÀaveReq
.
devi˚Addr
,0,(
addrExt_t
));

479 
	`zb_∆meLóveReq
(&
ÀaveReq
);

481 #ifde‡
ZLL_DEVICE_INITIATOR_CAPABLE


482 
g_touchlökAâr
.
‰ìNwkAddªssR™geBegö
 = 0x0001;

483 
g_touchlökAâr
.
‰ìNwkAddªssR™geEnd
 = 0xfff7;

484 
g_touchlökAâr
.
‰ìGroupAddªssR™geBegö
 = 0x0001;

485 
g_touchlökAâr
.
‰ìGroupAddªssR™geEnd
 = 0xfeff;

488 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_EXIST
);

496 
ZCL_CMD_ZLL_COMMISSIONING_IDENTIFY
:

498 
z˛_zŒTouchLökIdítifyReq_t
 
ªq
;

499 
	`mem˝y
(&
ªq
, (
u8
 *)
pInMsg
->
pD©a
, (
z˛_zŒTouchLökIdítifyReq_t
));

500 if(
ªq
.
å™sId
 =
g_zŒTouchLök
.transId){

501 
u16
 
idítifyTime
 = 0;

503 if(
ªq
.
idítifyDuøti⁄
 == 0){

504 
idítifyTime
 = 0;

505 }i‡(
ªq
.
idítifyDuøti⁄
 >0x0001 &&Ñeq.idítifyDuøti⁄ <
NWK_BROADCAST_RESERVED
){

506 
idítifyTime
 = 
ªq
.
idítifyDuøti⁄
;

507 }if(
ªq
.
idítifyDuøti⁄
 == 0xffff ){

508 
idítifyTime
 = 
DEFAULT_IDENTIFY_DURATION
;

511 
	`z˛_idítify_commissi⁄ögIdítify
(
pInMsg
, 
idítifyTime
);

516 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_UPDATE
:

518 
z˛_zŒTouchLökNëw‹kUpd©eReq_t
 
ªq
;

519 
	`mem˝y
(&
ªq
, (
u8
 *)
pInMsg
->
pD©a
, (
z˛_zŒTouchLökNëw‹kUpd©eReq_t
));

520 if(
ªq
.
å™sId
 =
g_zŒTouchLök
.transId){

521 if(
	`ZB_EXTPANID_CMP
(
ªq
.
ï™Id
, 
	`NWK_NIB
().
extPANId
Ë&&Ñeq.
∑nId
 =
	`MAC_IB
().panId){

522 if(
ªq
.
nwkUpd©eId
 > 
	`NWK_NIB
().
upd©eId
){

523 
	`NWK_NIB
().
upd©eId
 = 
ªq
.
nwkUpd©eId
;

524 
	`zdo_∆meCh™√lShi·
(
ªq
.
logiˇlCh™√l
);

528 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_STA_EXIST
);

532 
ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION
:

534 
z˛_zŒTouchLökDevi˚InfoReq_t
 
ªq
;

535 
	`mem˝y
(&
ªq
, (
u8
 *)
pInMsg
->
pD©a
, (
z˛_zŒTouchLökDevi˚InfoReq_t
));

536 if(
ªq
.
å™sId
 =
g_zŒTouchLök
.transId){

537 
	`z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°H™dÀr
(&
§cEpInfo
,
ªq
.
°¨tIdx
);

543 
ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS
:

545 
u8
 
°¨tIdx
 = *(u8 *)
pInMsg
->
pD©a
;

546 
§cEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

547 
§cEpInfo
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

548 
	`z˛_zŒGëGroupIdítifõrsReque°H™dÀr
(
°¨tIdx
, &
§cEpInfo
);

552 
ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST
:

554 
u8
 
°¨tIdx
 = *(u8 *)
pInMsg
->
pD©a
;

555 
§cEpInfo
.
d°AddrMode
 = 
APS_SHORT_DSTADDR_WITHEP
;

556 
§cEpInfo
.
d°Addr
.
sh‹tAddr
 = 
pApsdeInd
->
ödInfo
.
§c_sh‹t_addr
;

557 
	`z˛_zŒGëEndpoötLi°Reque°H™dÀr
(
°¨tIdx
, &
§cEpInfo
);

562 
°©us
 = 
ZCL_STA_UNSUP_CLUSTER_COMMAND
;

566  
°©us
;

567 
	}
}

578 
_CODE_ZCL_
 
u8
 
	$z˛_zŒCommissi⁄SîvîCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
){

579 
u8
 
°©us
 = 
ZCL_STA_SUCCESS
;

580 
u8
 
cmd
 = 
pInMsg
->
hdr
.cmd;

582 
≠sdeD©aInd_t
 *
pApsdeInd
 = (≠sdeD©aInd_t*)
pInMsg
->
msg
;

583 
ïInfo_t
 
d°Ep
;

585 
	`TL_SETSTRUCTCONTENT
(
d°Ep
, 0);

587 
d°Ep
.
d°AddrMode
 = 
APS_LONG_DSTADDR_WITHEP
;

588 
	`mem˝y
(
d°Ep
.
d°Addr
.
extAddr
, 
pApsdeInd
->
ödInfo
.
§c_ext_addr
, 8);

589 
d°Ep
.d°E∞
pApsdeInd
->
ödInfo
.
§c_ï
;

590 
d°Ep
.
¥ofûeId
 = 
pApsdeInd
->
ödInfo
.
¥ofûe_id
;

591 
d°Ep
.
ødius
 = 0;

592 
d°Ep
.
txO±i⁄s
 = 0;

595 if(
g_zŒTouchLök
.
°©e
 > 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
){

596 
zŒ_touchLökSˇnInfo
 *
≥îInfo
 = &
g_zŒTouchLök
.
disc
->
sˇnLi°
[g_zŒTouchLök.
›Idx
];

597 if(!
	`ZB_64BIT_ADDR_CMP
(
≥îInfo
->
d°Ep
.
d°Addr
.
extAddr
, dstEp.dstAddr.extAddr)){

598  
ZCL_STA_FAILURE
;

602 
cmd
) {

603 
ZCL_CMD_ZLL_COMMISSIONING_SCAN_RSP
:

605 
z˛_zŒTouchLökSˇnRe•_t
 
ª•
;

606 
	`mem˝y
((
u8
 *)&
ª•
, 
pInMsg
->
pD©a
, (
z˛_zŒTouchLökSˇnRe•_t
));

607 if(
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
 || 
ª•
.
å™sId
 !g_zŒTouchLök.å™sId || !g_zŒTouchLök.
disc
){

608 
°©us
 = 
ZCL_STA_INVALID_VALUE
;

611 
	`z˛_zŒTouchLökSˇnRe•⁄£H™dÀr
(&
ª•
, &
d°Ep
);

616 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START_RSP
:

618 if(
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_START
){

622 
z˛_zŒTouchLökNëw‹kSèπRe•_t
 *
ns¸
 = (z˛_zŒTouchLökNëw‹kSèπRe•_à*)
	`ev_buf_Æloˇã
((zcl_zllTouchLinkNetworkStartResp_t));

623 if(!
ns¸
 ){

626 
	`mem˝y
((
u8
 *)
ns¸
, 
pInMsg
->
pD©a
, (
z˛_zŒTouchLökNëw‹kSèπRe•_t
));

627 if(
ns¸
->
å™sId
 =
g_zŒTouchLök
.transId){

628 if(
	`is_devi˚_Á˘‹y_√w
(Ë&& 
ns¸
->
°©us
 =
SUCCESS
){

629 
	`mem˝y
(
	`NWK_NIB
().
extPANId
, 
ns¸
->
ï™Id
, 8);

630 
	`mem˝y
(
≠s_ib
.
≠s_u£_ext_∑nid
, 
	`NWK_NIB
().
extPANId
, 8);

631 
	`MAC_IB
().
∑nId
 = 
ns¸
->panId;

632 
	`MAC_IB
().
phyCh™√lCur
 = 
ns¸
->
logiˇlCh™√l
;

633 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
 = 
ns¸
->
logiˇlCh™√l
;

635 
	`z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimîSt›
();

636 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökNëw‹kSèπRe•⁄£H™dÀr
, 
ns¸
, 
ZB_MIN_STARTUP_DELAY_TIME
 + 1000);

638 
	`ev_buf_‰ì
((
u8
 *)
ns¸
);

644 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER_RSP
:

645 
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE_RSP
:

647 if(
cmd
 =
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER_RSP
 && 
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ROUTE
){

650 if(
cmd
 =
ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE_RSP
 && 
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ED
){

654 
z˛_zŒTouchLökNëw‹kJoöRe•_t
 
ª•
 ;

655 
	`mem˝y
((
u8
 *)&
ª•
, 
pInMsg
->
pD©a
, (
z˛_zŒTouchLökNëw‹kJoöRe•_t
));

656 if(
ª•
.
å™sId
 =
g_zŒTouchLök
.å™sId &&Ñe•.
°©us
 =
SUCCESS
){

657 
	`z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimîSt›
();

658 
	`TL_ZB_TIMER_SCHEDULE
(
z˛_zŒTouchLökNëwokJoöRe•⁄£H™dÀr
, 
NULL
, 
ZB_MIN_STARTUP_DELAY_TIME
);

662 
	`z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimîSt›
();

663 
	`z˛_zŒTouchLökFöish
(
ZCL_ZLL_TOUCH_LINK_FAIL
);

666 #ifde‡
ZB_ED_ROLE


667 
	`ZB_TRANSCEIVER_SET_CHANNEL
(
g_zŒTouchLök
.
w‹kögCh™√lBackUp
);

668 
	`MAC_IB
().
rxOnWhíIdÀ
 = 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
;

669 
	`rf_£tTxPowî
(
g_zb_txPowîSë
);

670 
	`zb_£tPﬁlR©e
(
RESPONSE_POLL_RATE
);

675 
ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION_RSP
:

677 
z˛_zŒTouchLökDevi˚InfoRe•_t
 
ª•
;

678 
	`mem˝y
((
u8
 *)&
ª•
, 
pInMsg
->
pD©a
, (
z˛_zŒTouchLökDevi˚InfoRe•_t
));

679 if(
ª•
.
å™sId
 =
g_zŒTouchLök
.å™sId && g_zŒTouchLök.
°©e
 =
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DEVICE_INFO_EXCHANGE
){

681 if(
ª•
.
numOfSubdevi˚s
 == 1){

682 
z˛_zŒDevi˚InfoRec_t
 
ªc
;

683 
	`mem˝y
((
u8
 *)&
ªc
, 
pInMsg
->
pD©a
+(
z˛_zŒTouchLökDevi˚InfoRe•_t
), (
z˛_zŒDevi˚InfoRec_t
));

685 
	`z˛_zŒTouchLökDevi˚Inf‹m©i⁄Re•⁄£H™dÀr
(&
ª•
);

691 
ZCL_CMD_ZLL_COMMISSIONING_ENDPOINT_INFORMATION
:

693 
z˛_zŒUtûôyEndpoötInfo_t
 
ïInfo
;

694 
	`mem˝y
((
u8
 *)&
ïInfo
, 
pInMsg
->
pD©a
, (
z˛_zŒUtûôyEndpoötInfo_t
));

695 
	`z˛_zŒEndpoötInf‹m©i⁄H™dÀr
(&
ïInfo
);

699 
ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS_RSP
:

701 
z˛_zŒUtûôyGëGroupIdsRe•_t
 
ª•
;

702 
	`mem˝y
((
u8
 *)&
ª•
, 
pInMsg
->
pD©a
, (
z˛_zŒUtûôyGëGroupIdsRe•_t
));

704 
u16
 
∂dLí
 = 
ª•
.
cou¡
 * (
z˛_groupInfo
);

705 
z˛_groupInfo
 *
groupLi°
 = (z˛_groupInfÿ*)
	`ev_buf_Æloˇã
(
∂dLí
);

706 if(
groupLi°
){

707 
ª•
.
groupInfoRec‹d
 = 
groupLi°
;

708 
	`mem˝y
((
u8
 *)
groupLi°
, 
pInMsg
->
pD©a
+3, 
∂dLí
);

710 
	`z˛_zŒGëGroupIdítifõrsRe•⁄£H™dÀr
(&
ª•
);

711 if(
groupLi°
){

712 
	`ev_buf_‰ì
((
u8
 *)
groupLi°
);

717 
ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST_RSP
:

719 
z˛_zŒUtûôyGëEpLi°Re•_t
 
ïLi°Re•
;

720 
	`mem˝y
((
u8
 *)&
ïLi°Re•
, 
pInMsg
->
pD©a
, (
z˛_zŒUtûôyGëEpLi°Re•_t
));

721 
ïLi°Re•
.
ïInfoRec‹d
 = 
NULL
;

723 
u16
 
∂dLí
 = 
ïLi°Re•
.
cou¡
 * (
z˛_zŒEndpoötInfo_t
);

724 
z˛_zŒEndpoötInfo_t
 *
ïLi°
 = (z˛_zŒEndpoötInfo_à*)
	`ev_buf_Æloˇã
(
∂dLí
);

725 if(
ïLi°
){

726 
ïLi°Re•
.
ïInfoRec‹d
 = 
ïLi°
;

727 
	`mem˝y
((
u8
 *)
ïLi°
, 
pInMsg
->
pD©a
+3, 
∂dLí
);

729 
	`z˛_zŒGëEndpoötLi°Re•⁄£H™dÀr
(&
ïLi°Re•
);

730 if(
ïLi°
){

731 
	`ev_buf_‰ì
((
u8
 *)
ïLi°
);

737 
°©us
 = 
ZCL_STA_FAILURE
;

741  
°©us
;

742 
	}
}

744 
_CODE_ZCL_
 
u8
 
	$z˛_touchLökInô
(){

745 if(
	`zb_isDevi˚Fa˘‹yNew
()){

746 
	`mem˝y
(&
g_touchlökAâr
, &
g_touchlökAârD·
, (
touchlök_©å_t
));

749 
	`zdo_touchLökCbRegi°î
(&
touchLökCb
);

751 
g_zŒTouchLök
.
zbInfo
.
byã
 = 0;

752 
g_zŒTouchLök
.
zbInfo
.
bf
.
rxOnWihÀIdÀ
 = (
	`af_nodeMacC≠abûôyGë
(Ë& 
MAC_CAP_RX_ON_WHEN_IDLE
) ? 1 : 0;

753 
g_zŒTouchLök
.
zbInfo
.
bf
.
logicDevTy≥
 = 
	`af_nodeDevTy≥Gë
();

754 
g_zŒTouchLök
.
°¨tNëw‹kAŒowed
 = 1;

755 
g_zŒTouchLök
.
zŒInfo
.
byã
 = 0;

758 
g_zŒTouchLök
.
sˇnLi°Num
 = (
LARGE_BUFFER
 - 
	`OFFSETOF
(
z˛_zŒTouckLökDisc_t
, 
sˇnLi°
))/(
zŒ_touchLökSˇnInfo
);

760 
af_ídpoöt_des¸ùt‹_t
 *
´d
 = 
	`af_ïDes¸ùt‹Gë
();

762 
u8
 
i
 = 0; i < 
	`af_avaûabÀEpNumGë
(); i++){

763 if(
	`af_˛suãrIdM©ched
(
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
)){

764 
g_zŒTouchLök
.
devInfo
.
ïId
 = 
´d
[
i
].
ï
;

765 
g_zŒTouchLök
.
devInfo
.
¥ofûeId
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_¥ofûe_id
;

766 
g_zŒTouchLök
.
devInfo
.
devi˚Id
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_id
;

767 
g_zŒTouchLök
.
devInfo
.
vîsi⁄
 = 
´d
[
i
].
c‹ª•⁄d_sim∂e_desc
->
≠p_dev_vî
;

769  
ZCL_STA_SUCCESS
;

773  
ZCL_STA_FAILURE
;

774 
	}
}

786 
_CODE_ZCL_
 
	$z˛_touchLökSèπ
(){

787 
	`DEBUG
(
DEBUG_TOUCHLINK_EN
, "ZLLÅriggîÅouchÜök o≥øti⁄, cuºíà°©ê%d\n", 
g_zŒTouchLök
.
°©e
);

788 if(
g_zŒTouchLök
.
°©e
 !
ZCL_ZLL_COMMISSION_STATE_IDLE
){

789 if(
g_zŒCommissi⁄
.
≠pCb
->
touchLökCÆlback
){

790 
g_zŒCommissi⁄
.
≠pCb
->
	`touchLökCÆlback
(
ZCL_ZLL_TOUCH_LINK_BUSY
, 
NULL
);

795 
g_zŒTouchLök
.
vDoPrim¨ySˇn
 = 1;

796 
g_zŒTouchLök
.
IsFú°Ch™√l
 = 1;

797 
u32
 
sˇnCh™Mask
 = 0;

798 if(
	`BDB_ATTR
().
¥im¨yCh™√lSë
 == 0){

799 
g_zŒTouchLök
.
vDoPrim¨ySˇn
 = 0;

800 
sˇnCh™Mask
 = 
	`BDB_ATTR
().
£c⁄d¨yCh™√lSë
;

802 
sˇnCh™Mask
 = 
	`BDB_ATTR
().
¥im¨yCh™√lSë
;

804 if(
sˇnCh™Mask
 == 0){

805 if(
g_zŒCommissi⁄
.
≠pCb
->
touchLökCÆlback
){

806 
g_zŒCommissi⁄
.
≠pCb
->
	`touchLökCÆlback
(
ZCL_ZLL_TOUCH_LINK_STA_NO_CAPACITY
, 
NULL
);

811 if(
g_zŒTouchLök
.
disc
){

812 
	`ev_buf_‰ì
((
u8
 *)
g_zŒTouchLök
.
disc
);

813 
g_zŒTouchLök
.
disc
 = 
NULL
;

815 
g_zŒTouchLök
.
disc
 = (
z˛_zŒTouckLökDisc_t
 *)
	`ev_buf_Æloˇã
(
LARGE_BUFFER
);

816 if(!
g_zŒTouchLök
.
disc
){

817 
	`ZB_EXCEPTION_POST
(
SYS_EXCEPTTION_ZB_BUFFER_OVERFLOWN
);

822 
z˛_zŒTouckLökDisc_t
 *
pDisc
 = 
g_zŒTouchLök
.
disc
;

823 
pDisc
->
èrgëNum
 = 0;

824 
pDisc
->
¥im¨yCh™√lSˇnCom∂ëe
 = 
Ál£
;

825 
pDisc
->
cuºítSˇ¬Ch™√l
 = 0;

826 
pDisc
->
sˇnC¡
 = 0;

827 
pDisc
->
unsˇ¬edCh™√lMask
 = 
sˇnCh™Mask
;

829 
g_zŒTouchLök
.
å™sId
 == 0){

830 
g_zŒTouchLök
.
å™sId
 = 
	`ZB_RANDOM
() | (ZB_RANDOM() << 16);

833 
g_zŒTouchLök
.
zŒInfo
.
bf
.
lökInôüt‹
 = 1;

834 
g_zŒTouchLök
.
zŒInfo
.
bf
.
addrAssign
 = 1;

835 
g_zŒTouchLök
.
zŒInfo
.
bf
.
¥ofûeI¡î›
 = 1;

838 
g_zŒTouchLök
.
√tw‹kSèπInfo
 = 
NULL
;

839 
g_zŒTouchLök
.
£qNo
 = 0;

840 
g_zŒTouchLök
.
°©e
 = 
ZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
;

842 if(
	`is_devi˚_Á˘‹y_√w
()){

843 
g_zŒTouchLök
.
zŒInfo
.
bf
.
Á˘‹yNew
 = 1;

844 
	`MAC_IB
().
∑nId
 = 
	`zb_øndom
();

848 
g_zŒTouchLök
.
zŒInfo
.
bf
.
Á˘‹yNew
 = 0;

851 
	`rf_£tTxPowî
(
g_zŒTouchLök
.
commissi⁄TxPowî
);

853 
	`zb_£tPﬁlR©e
(0);

858 
	`MAC_IB
().
rxOnWhíIdÀ
 = 1;

859 
g_zŒTouchLök
.
w‹kögCh™√lBackUp
 = 
	`MAC_IB
().
phyCh™√lCur
;

861 
	`z˛_zŒTouchLökDiscoveySèπ
();

862 
	}
}

865 
_CODE_ZCL_
 
	$touchlök_lqiThªshﬁdSë
(
u8
 
lqi
){

866 
g_zŒTouchLök
.
lqiThªshﬁd
 = 
lqi
;

867 
	}
}

870 
_CODE_ZCL_
 
	$touchlök_keyModeSë
(
u8
 
keyTy≥
, u8 *
key
){

871 
g_zŒTouchLök
.
keyTy≥
 = keyType;

872 
ss_ib
.
touchLökKey
 = 
key
;

873 
	}
}

875 
_CODE_ZCL_
 
	$touchlök_commissi⁄TxPowîSë
(
u8
 
powî
){

876 
g_zŒTouchLök
.
commissi⁄TxPowî
 = 
powî
;

877 
	}
}

883 
_CODE_ZCL_
 
u8
 
	$z˛_touchLökCmdH™dÀr
(
z˛Incomög_t
 *
pInMsg
){

884 i‡(
pInMsg
->
hdr
.
‰mCål
.
bf
.
dú
 =
ZCL_FRAME_CLIENT_SERVER_DIR
) {

885  
	`z˛_touchLökClõ¡CmdH™dÀr
(
pInMsg
);

887  
	`z˛_zŒCommissi⁄SîvîCmdH™dÀr
(
pInMsg
);

889 
	}
}

896 
_CODE_ZCL_
 
°©us_t
 
	$z˛_touchlök_ªgi°î
(
u8
 
ídpoöt
, c⁄° 
z˛_touchlökAµCÆlbacks_t
 *
cb
){

897 
g_zŒCommissi⁄
.
≠pCb
 = 
cb
;

898 
	`z˛_touchLökInô
();

899 
	`é_nwkTouchLökCbRegi°î
(&
g_nwkTouchlökCb
);

900  
	`z˛_ªgi°îClu°î
(
ídpoöt
, 
ZCL_CLUSTER_TOUCHLINK_COMMISSIONING
, 0, 0, 
NULL
, 
z˛_touchLökCmdH™dÀr
, NULL);

901 
	}
}

904 
u8
 
	gdevi˚InfoR•
 = 0;

	@zigbee/zcl/zll_commissioning/zcl_zll_commissioning.h

24 #i‚de‡
ZCL_ZLL_COMMOSSIONING_H


25 
	#ZCL_ZLL_COMMOSSIONING_H


	)

29 
	#RF_POWER_FOR_COMMISSION
 
RF_POWER_m0P6dBm


30 

	)

49 
	#ZB_ADDR_RANGE_ASSIGNED_FOR_TARGET
 5

	)

50 
	#ZB_ZLL_PRIMARY_CHANNELS_MASK
 0x02108800

	)

51 
	#ZB_ZLL_SECONDARY_CHANNELS_MASK
 0x05EF7000

	)

52 
	#ZB_ZLL_COMMISSION_UNSCANEDCHANNEL_MASK
 0x07fff800

	)

63 
	#ZCL_CMD_ZLL_COMMISSIONING_SCAN
 0x00

64 
	#ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION
 0x02

65 
	#ZCL_CMD_ZLL_COMMISSIONING_IDENTIFY
 0x06

66 
	#ZCL_CMD_ZLL_COMMISSIONING_RESET_TO_FACTORY_NEW
 0x07

67 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START
 0x10

68 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER
 0x12

69 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE
 0x14

70 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_UPDATE
 0x16

71 

	)

73 
	#ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS
 0x41

74 
	#ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST
 0x42

75 

	)

79 
	#ZCL_CMD_ZLL_COMMISSIONING_SCAN_RSP
 0x01

80 
	#ZCL_CMD_ZLL_COMMISSIONING_DEVICE_INFORMATION_RSP
 0x03

81 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_START_RSP
 0x11

82 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_ROUTER_RSP
 0x13

83 
	#ZCL_CMD_ZLL_COMMISSIONING_NETWORK_JOIN_END_DEVICE_RSP
 0x15

84 

	)

86 
	#ZCL_CMD_ZLL_COMMISSIONING_ENDPOINT_INFORMATION
 0x40

87 
	#ZCL_CMD_ZLL_COMMISSIONING_GET_GROUP_IDENTIFIERS_RSP
 0x41

88 
	#ZCL_CMD_ZLL_COMMISSIONING_GET_ENDPOINT_LIST_RSP
 0x42

89 

	)

98 
	mZCL_ZLL_COMMISSION_STATE_IDLE
,

99 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DISCOVERY
,

100 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_DEVICE_INFO_EXCHANGE
,

101 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_IDENTIFY
,

102 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_STARTORJOIN
 = 0x80,

103 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_START
 = 0x81,

104 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ED
 = 0x82,

105 
	mZCL_ZLL_COMMISSION_STATE_TOUCHLINK_JOIN_ROUTE
 = 0x83,

116 
	mZCL_ZLL_TOUCH_LINK_STA_SUCC
,

117 
	mZCL_ZLL_TOUCH_LINK_FAIL
,

118 
	mZCL_ZLL_TOUCH_LINK_STA_NO_SERVER
,

119 
	mZCL_ZLL_TOUCH_LINK_STA_EXIST
,

120 
	mZCL_ZLL_TOUCH_LINK_STA_NOT_PERMITTED
,

121 
	mZCL_ZLL_TOUCH_LINK_STA_TIMEOUT
,

122 
	mZCL_ZLL_TOUCH_LINK_STA_STARTORJOIN_TIMEOUT
,

123 
	mZCL_ZLL_TOUCH_LINK_STA_TARGET_START
,

124 
	mZCL_ZLL_TOUCH_LINK_STA_NO_CAPACITY
,

125 
	mZCL_ZLL_TOUCH_LINK_BUSY
,

135 
	mZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_START
,

136 
	mZCL_ZLL_COMMISSIONING_TOUCH_LICK_MODE_JOIN


154 
u8
 
	mlogicDevTy≥
:2;

155 
u8
 
	mrxOnWihÀIdÀ
: 1;

156 
u8
 
	mªsv
:5;

157 }
	mbf
;

158 
u8
 
	mbyã
;

160 }
	tzŒ_éZbInfo_t
;

169 
u8
 
	mÁ˘‹yNew
:1;

170 
u8
 
	maddrAssign
:1;

171 
u8
 
	mªsv0
:2;

172 
u8
 
	mlökInôüt‹
:1;

173 
u8
 
	m¥i‹ôyReq
:1;

174 
u8
 
	mªsv1
:1;

175 
u8
 
	m¥ofûeI¡î›
:1;

176 }
	mbf
;

177 
u8
 
	mbyã
;

179 }
	tzŒ_éZŒInfo_t
;

186 
u8
 
	mïId
;

187 
u16
 
	m¥ofûeId
;

188 
u16
 
	mdevi˚Id
;

189 
u8
 
	mvîsi⁄
;

190 
u8
 
	mgroupIdC¡
;

191 }
	tz˛_zŒSubdevi˚Info_t
;

198 
addrExt_t
 
	mdevi˚Addr
;

199 
u8
 
	mïId
;

200 
u16
 
	m¥ofûeId
;

201 
u16
 
	mdevi˚Id
;

202 
u8
 
	mvîsi⁄
;

203 
u8
 
	mgroupIdC¡
;

204 
u8
 
	ms‹t
;

205 } 
	tz˛_Devi˚Info
;

212 
u32
 
	mª•Id
;

213 
addrExt_t
 
	mï™Id
;

214 
u16
 
	m∑nId
;

215 
u16
 
	mnwkAddr
;

216 
zŒ_éZbInfo_t
 
	mzbInfo
;

217 
zŒ_éZŒInfo_t
 
	mzŒInfo
;

218 
u8
 
	mlogiˇlCh™√l
;

219 
u8
 
	mnumOfSubdevi˚s
;

220 
ïInfo_t
 
	md°Ep
;

221 
u8
 
	mtŸÆGroupIds
;

222 
u8
 
	mkeyIdx
;

223 
u8
 
	mnwkUpd©eId
;

224 
z˛_zŒSubdevi˚Info_t
 
	mdevInfo
;

225 }
	tzŒ_touchLökSˇnInfo
;

231 
u32
 
	munsˇ¬edCh™√lMask
;

232 
u8
 
	mèrgëNum
;

233 
boﬁ
 
	m¥im¨yCh™√lSˇnCom∂ëe
;

234 
u8
 
	mcuºítSˇ¬Ch™√l
;

235 
u8
 
	msˇnC¡
;

236 
zŒ_touchLökSˇnInfo
 
	msˇnLi°
[1];

237 } 
	tz˛_zŒTouckLökDisc_t
;

244 
u32
 
	må™sId
;

245 
zŒ_éZbInfo_t
 
	mzbInfo
;

246 
zŒ_éZŒInfo_t
 
	mzŒInfo
;

247 } 
	tz˛_zŒTouchLökSˇnReq_t
;

254 
u32
 
	må™sId
;

255 
u8
 
	mrssiC‹ª˘i⁄
;

256 
zŒ_éZbInfo_t
 
	mzbInfo
;

257 
zŒ_éZŒInfo_t
 
	mzŒInfo
;

258 
u16
 
	mkeyBômask
;

259 
u32
 
	mª•Id
;

260 
addrExt_t
 
	mï™Id
;

261 
u8
 
	mnwkUpd©eId
;

262 
u8
 
	mlogiˇlCh™√l
;

263 
u16
 
	m∑nId
;

264 
u16
 
	mnwkAddr
;

265 
u8
 
	mnumOfSubdevi˚s
;

266 
u8
 
	mtŸÆGroupIds
;

267 
z˛_zŒSubdevi˚Info_t
 
	msubDevInfo
;

268 } 
	tz˛_zŒTouchLökSˇnRe•_t
;

275 
u32
 
	må™sId
;

276 
addrExt_t
 
	mï™Id
;

277 
u8
 
	mkeyIdx
;

278 
u8
 
	mí¸y±edNwkKey
[16];

279 
u8
 
	mlogiˇlCh™√l
;

280 
u16
 
	m∑nId
;

281 
u16
 
	mnwkAddr
;

282 
u16
 
	mgroupIdbegö
;

283 
u16
 
	mgroupIdEnd
;

284 
u16
 
	m‰ìNwkAddrR™geBegö
;

285 
u16
 
	m‰ìNwkAddrR™geEnd
;

286 
u16
 
	m‰ìGroupIdR™geBegö
;

287 
u16
 
	m‰ìGroupIdR™geEnd
;

288 
addrExt_t
 
	möôüt‹IìeAddr
;

289 
u16
 
	möôüt‹NwkAddr
;

290 } 
	tz˛_zŒTouchLökNëw‹kSèπReq_t
;

297 
u32
 
	må™sId
;

298 
u8
 
	m°©us
;

299 
addrExt_t
 
	mï™Id
;

300 
u8
 
	mnwkUpd©eId
;

301 
u8
 
	mlogiˇlCh™√l
;

302 
u16
 
	m∑nId
;

303 } 
	tz˛_zŒTouchLökNëw‹kSèπRe•_t
;

310 
u32
 
	må™sId
;

311 
addrExt_t
 
	mï™Id
;

312 
u8
 
	mkeyIdx
;

313 
u8
 
	mí¸y±edNwkKey
[16];

314 
u8
 
	mnwkUpd©eId
;

315 
u8
 
	mlogiˇlCh™√l
;

316 
u16
 
	m∑nId
;

317 
u16
 
	mnwkAddr
;

318 
u16
 
	mgroupIdBegö
;

319 
u16
 
	mgroupIdEnd
;

320 
u16
 
	m‰ìNwkAddrR™geBegö
;

321 
u16
 
	m‰ìNwkAddrR™geEnd
;

322 
u16
 
	m‰ìGroupIdR™geBegö
;

323 
u16
 
	m‰ìGroupIdR™geEnd
;

324 } 
	tz˛_zŒTouchLökNëw‹kJoöReq_t
;

331 
u32
 
	må™sId
;

332 
u8
 
	m°©us
;

333 } 
	tz˛_zŒTouchLökNëw‹kJoöRe•_t
;

341 
z˛_zŒTouchLökNëw‹kSèπReq_t
 
	m√tw‹kSèπCmd
;

342 
z˛_zŒTouchLökNëw‹kJoöReq_t
 
	m√tw‹kJoöCmd
;

343 }
	m∑øms
;

344 
u8
 
	m£qNo
;

345 
u8
 
	mjoöNëw‹kMode
;

346 
ïInfo_t
 
	möôüt‹EpInfo
;

347 } 
	tz˛_zŒTouckLökNëw‹kSèπP¨ams
;

355 
addrExt_t
 
	mõìAddr
;

356 
u8
 
	mïId
;

357 
u16
 
	m¥ofûeId
;

358 
u16
 
	mdevi˚Id
;

359 
u8
 
	mvîsi⁄
;

360 
u8
 
	mgroupIdC¡
;

361 
u8
 
	ms‹t
;

362 } 
	tz˛_zŒDevi˚InfoRec_t
;

369 
u32
 
	må™sId
;

370 
u8
 
	m°¨tIdx
;

371 } 
	tz˛_zŒTouchLökDevi˚InfoReq_t
;

379 
u32
 
	må™sId
;

380 
u8
 
	mnumOfSubdevi˚s
;

381 
u8
 
	m°¨tIdx
;

382 
u8
 
	mdevi˚InfoRec‹dC¡
;

383 
z˛_zŒDevi˚InfoRec_t
 
	mªc
[];

384 } 
	tz˛_zŒTouchLökDevi˚InfoRe•_t
;

393 
u32
 
	må™sId
;

394 
u16
 
	midítifyDuøti⁄
;

395 } 
	tz˛_zŒTouchLökIdítifyReq_t
;

402 
u32
 
	må™sId
;

403 } 
	tz˛_zŒTouchLökRe£tFa˘‹yReq_t
;

410 
u32
 
	må™sId
;

411 
addrExt_t
 
	mï™Id
;

412 
u8
 
	mnwkUpd©eId
;

413 
u8
 
	mlogiˇlCh™√l
;

414 
u16
 
	m∑nId
;

415 
u16
 
	mnwkAddr
;

416 } 
	tz˛_zŒTouchLökNëw‹kUpd©eReq_t
;

420 (*
	tz˛_zŒTouchLökAµCÆlbacks_t
)(
	tu8
 
	t°©us
, *
	t¨g
);

434 
u16
 
nwkAddr
;

435 
u8
 
ïId
;

436 
u16
 
¥ofûeId
;

437 
u16
 
devi˚Id
;

438 
u8
 
vîsi⁄
;

439 } 
	tz˛_zŒEndpoötInfo_t
;

446 
addrExt_t
 
õìAddr
;

447 
z˛_zŒEndpoötInfo_t
 
öfo
;

448 } 
	tz˛_zŒUtûôyEndpoötInfo_t
;

453 
u16
 
groupId
;

454 
u8
 
groupTy≥
;

455 } 
	tz˛_groupInfo
;

462 
u8
 
°¨tIdx
;

463 } 
	tz˛_zŒUtûôyGëGroupIdsReq_t
;

471 
u8
 
tŸÆ
;

472 
u8
 
°¨tIdx
;

473 
u8
 
cou¡
;

474 
z˛_groupInfo
 *
groupInfoRec‹d
;

475 } 
	tz˛_zŒUtûôyGëGroupIdsRe•_t
;

483 
u8
 
°¨tIdx
;

484 } 
	tz˛_zŒUtûôyGëEpLi°Req_t
;

492 
u8
 
tŸÆ
;

493 
u8
 
°¨tIdx
;

494 
u8
 
cou¡
;

495 
z˛_zŒEndpoötInfo_t
 *
ïInfoRec‹d
;

496 } 
	tz˛_zŒUtûôyGëEpLi°Re•_t
;

498 (*
	tz˛_zŒCommissi⁄UtûôyAµCÆlbacks_t
)(
	tu8
 
	tcmd
, *
	t¨g
);

508 
z˛_zŒTouchLökAµCÆlbacks_t
 
touchLökCÆlback
;

509 
z˛_zŒCommissi⁄UtûôyAµCÆlbacks_t
 
utûôyAµCÆlback
;

510 }
	tz˛_touchlökAµCÆlbacks_t
;

518 c⁄° 
z˛_touchlökAµCÆlbacks_t
 *
≠pCb
;

519 }
	tz˛_zŒCommissi⁄_t
;

538 
°©us_t
 
	`z˛_touchlök_ªgi°î
(
u8
 
ídpoöt
, c⁄° 
z˛_touchlökAµCÆlbacks_t
 *
cb
);

548 
s32
 
	`z˛_touchLökDevSèπIndiˇã
(*
¨g
);

557 
	`z˛_zŒTouchLökDiscoveySèπ
();

569 
	`z˛_zŒGëGroupIdítifõrsReque°
(
ïInfo_t
* 
pD°EpInfo
, 
u8
 
°¨tIdx
);

581 
	`z˛_zŒGëEndpoötLi°Reque°
(
ïInfo_t
* 
pD°EpInfo
, 
u8
 
°¨tIdx
);

591 
	`z˛_zŒEndpoötInf‹m©i⁄
(
ïInfo_t
 *
d°Ep
);

601 
	`touchlök_lqiThªshﬁdSë
(
u8
 
lqi
);

611 
	`touchlök_commissi⁄TxPowîSë
(
u8
 
powî
);

620 
	`touchlök_keyModeSë
(
u8
 
keyTy≥
, u8 *
key
);

629 
u8
 
	`z˛_touchLökInô
();

638 
	`z˛_touchLökSèπ
();

	@zigbee/zcl/zll_commissioning/zcl_zll_commissioning_internal.h

24 #i‚de‡
ZCL_ZLL_COMMOSSIONING_INTERNAL_H


25 
	#ZCL_ZLL_COMMOSSIONING_INTERNAL_H


	)

34 
z˛_zŒTouckLökDisc_t
 *
	mdisc
;

35 
z˛_zŒTouckLökNëw‹kSèπP¨ams
 *
	m√tw‹kSèπInfo
;

36 
ev_timî_evít_t
 *
	må™sIdLi„Timî
;

37 
ev_timî_evít_t
 *
	mrunTimî
;

38 
u32
 
	må™sId
;

39 
u32
 
	mª•Id
;

40 
u32
 
	msˇnCh™Mask
;

41 
u8
 
	mtouchLökCh™
;

42 
zŒ_éZbInfo_t
 
	mzbInfo
;

43 
zŒ_éZŒInfo_t
 
	mzŒInfo
;

44 
u8
 
	m£qNo
;

45 
u8
 
	msˇnLi°Num
;

46 
u8
 
	m›Idx
;

47 
z˛_Devi˚Info
 
	md°DevInfo
;

48 
z˛_Devi˚Info
 
	mdevInfo
;

49 
u8
 
	m°©e
;

50 
u8
 
	m°©us
;

51 
u8
 
	mw‹kögCh™√lBackUp
;

52 
u8
 
	mlqiThªshﬁd
;

53 
u8
 
	mcommissi⁄TxPowî
;

54 
u8
 
	mkeyTy≥
;

55 
u8
 
	mvDoPrim¨ySˇn
:1;

56 
u8
 
	mIsFú°Ch™√l
:1;

57 
u8
 
	m°¨tNëw‹kAŒowed
:1;

58 
u8
 
	mªsved
:5;

59 }
	tz˛_zŒTouckLök_t
;

62 
z˛_zŒTouckLök_t
 
g_zŒTouchLök
;

64 
Œ_√tw‹k_gíî©e
(
u8
 *
nwkKey
);

66 
Œ_√tw‹k_°‹e
(
u8
 *
nwkKey
);

68 
z˛_zŒTouchLökSˇnReque°H™dÀr
(
ïInfo_t
 *
d°Ep
, 
u8
 
£qNo
);

70 
z˛_zŒTouchLökSˇnRe•⁄£H™dÀr
(
z˛_zŒTouchLökSˇnRe•_t
 *
ª•
, 
ïInfo_t
 *
d°Ep
);

72 
z˛_zŒTouchLökNëw‹kSèπOrJoö
(*
¨g
);

74 
z˛_zŒTouchLökRe£tFa˘‹yReq
(*
¨g
);

76 
z˛_zŒTouchLökNëw‹kSèπRequ°H™dÀr
(
u8
 
logicCh™√l
);

78 
s32
 
z˛_zŒTouchLökNëw‹kSèπRe•⁄£H™dÀr
(*
¨g
);

80 
z˛_zŒTouchLökNëw‹kSèπDúe˘Joö
(*
¨g
);

82 
z˛_zŒTouchLökNëw‹kJoöReque°H™dÀr
(
u8
 
cmd
);

84 
s32
 
z˛_zŒTouchLökNëwokJoöRe•⁄£H™dÀr
(*
¨g
);

86 
s32
 
z˛_zŒTouchLökTimeout
(*
¨g
);

88 
z˛_zŒTouchLökFöish
(
u8
 
°©us
);

90 
boﬁ
 
z˛_zŒTouchLökLóveCnfCb
(
∆me_Àave_˙f_t
 *
pLóveCnf
);

92 
z˛_zŒTouchLökDevi˚Inf‹m©i⁄Reque°H™dÀr
(
ïInfo_t
 *
d°Ep
,
u8
 
°¨tEpIdx
);

94 
z˛_zŒTouchLökDevi˚Inf‹m©i⁄Re•⁄£H™dÀr
(
z˛_zŒTouchLökDevi˚InfoRe•_t
 *
devInfoRe•
);

96 
s32
 
z˛_zŒTouchLökSèπNëw‹kSèπOrJoöTimîSt›
();

98 
Œ_zŒAârCÃ
();

100 
é_zbNwkZŒCommissi⁄SˇnC⁄fúm
(*
¨g
);

	@zigbee/zdo/zdo_api.h

24 #i‚de‡
ZDO_API_H


25 
	#ZDO_API_H


	)

37 
	#MAC_HEADER_MAX_SIZE
 23

	)

38 
	#NWK_HEADER_MAX_SIZE
 25

	)

39 
	#SECURE_HEADER_SIZE
 14

	)

40 
	#APS_HEADER_MAX_SIZE
 8

	)

41 
	#APS_MAXPACKET_LENGTH
 (127 - 
MAC_HEADER_MAX_SIZE
 - 
NWK_HEADER_MAX_SIZE
 - 
SECURE_HEADER_SIZE
 - 
APS_HEADER_MAX_SIZE
)

	)

48 
	mZDO_SUCCESS
 = 0x00,

50 
	mZDO_NETWORK_LOST
 = 0x60,

52 
	mZDO_INVALID_REQUEST
 = 0x80,

53 
	mZDO_DEVICE_NOT_FOUND
 = 0x81,

54 
	mZDO_INVALID_EP
 = 0x82,

55 
	mZDO_NOT_ACTIVE
 = 0x83,

56 
	mZDO_NOT_SUPPORTED
 = 0x84,

57 
	mZDO_TIMEOUT
 = 0x85,

58 
	mZDO_NO_MATCH
 = 0x86,

60 
	mZDO_NO_ENTRY
 = 0x88,

61 
	mZDO_NO_DESCRIPTOR
 = 0x89,

62 
	mZDO_INSUFFICIENT_SPACE
 = 0x8A,

63 
	mZDO_NOT_PERMITTED
 = 0x8B,

64 
	mZDO_TABLE_FULL
 = 0x8C,

65 
	mZDO_NOT_AUTHORIZED
 = 0x8D,

66 
	mZDO_DEVICE_BINDING_TABLE_FALL
 = 0x8E,

67 
	mZDO_INVALID_INDEX
 = 0x8F,

68 }
	tzdo_°©us_t
;

72 
extPANId_t
 
	mnwkExãndedPANID
;

73 
extPANId_t
 
	m≠sU£ExãndedPANID
;

74 
u32
 
	m≠sCh™√lMask
;

75 
u8
 
	m≠sDesig«ãdCo‹dö©‹
;

76 
u8
 
	m≠sU£In£cuªJoö
;

77 }
	tzdo_°¨tup_©å_t
;

83 
u32
 
	mc⁄fig_nwk_ödúe˘PﬁlR©e
;

84 
u16
 
	mc⁄fig_nwk_time_btwn_sˇns
;

91 
u8
 
	mc⁄fig_nwk_sˇn_©ãm±s
;

92 
u8
 
	mc⁄fig_≥rmô_joö_duøti⁄
;

93 
u8
 
	mc⁄fig_∑ª¡_lök_ªåy_thªshﬁd
;

98 
u8
 
	mc⁄fig_ªjoö_times
;

101 
u16
 
	mc⁄fig_ªjoö_duøti⁄
;

103 
u16
 
	mc⁄fig_ªjoö_backoff_time
;

105 
u16
 
	mc⁄fig_max_ªjoö_backoff_time
;

106 
u16
 
	mc⁄fig_ªjoö_backoff_ôî©i⁄
;

109 
u16
 
	mc⁄fig_ac˚±_nwk_upd©e_∑n_id
;

110 
u8
 
	mc⁄fig_ac˚±_nwk_upd©e_ch™√l
;

111 
boﬁ
 
	mc⁄fig_mgmt_Àave_u£_≠s_£c
;

112 
boﬁ
 
	mc⁄fig_u£_tc_£c_⁄_nwk_key_rŸ©i⁄
;

113 }
	tzdo_©åCfg_t
;

121 
zdo_°©us_t
 
	m°©us
;

122 
u8
 
	mch™√l_num
;

123 
u16
 
	m∑n_id
;

124 
u16
 
	msh‹t_addr
;

125 }
	tzdo_°¨t_devi˚_c⁄fúm_t
;

128 
addrExt_t
 
	m∑ª¡IìeAddr
;

129 
addrExt_t
 
	mdevIìeAddr
;

130 
u16
 
	mdevSh‹tAddr
;

131 }
	tzdo_tc_joö_öd_t
;

133 (*
	tzdo_°¨tDveCnfCb_t
)(
	tzdo_°¨t_devi˚_c⁄fúm_t
 *
	tp
);

134 (*
	tzdo_∆meRe£tCnfCb_t
)(
	t∆me_ª£t_˙f_t
 *
	tp
);

135 (*
	tzdo_dveA¬˚IndCb_t
)(
	tzdo_devi˚_™n˚_ªq_t
 *
	tp
);

136 (*
	tzdo_ÀaveIndCb_t
)(
	t∆me_Àave_öd_t
 *
	tp
);

137 (*
	tzdo_ÀaveCnfCb_t
)(
	t∆me_Àave_˙f_t
 *
	tp
);

138 
	$boﬁ
 (*
	tzdo_nwkUpd©eCb_t
)(
	tnwkCmd_nwkUpd©e_t
 *
	tp
);

139 (*
	tzdo_≥rmôJoöIndCb_t
)(
	t∆me_≥rmôJoöög_ªq_t
 *
	tp
);

140 (*
	tzdo_∆meSyncCnfCb_t
)(
	t∆me_sync_˙f_t
 *
	tp
);

141 
	$boﬁ
 (*
	tzdo_tcJoöIndCb_t
)(
	tzdo_tc_joö_öd_t
 *
	tp
);

142 (*
	tzdo_tcFømeC¡RóchedCb_t
)();

145 
zdo_°¨tDveCnfCb_t
 
zdpSèπDevCnfCb
;

146 
zdo_∆meRe£tCnfCb_t
 
zdpRe£tCnfCb
;

147 
zdo_dveA¬˚IndCb_t
 
zdpDevA¬oun˚IndCb
;

148 
zdo_ÀaveIndCb_t
 
zdpLóveIndCb
;

149 
zdo_ÀaveCnfCb_t
 
zdpLóveCnfCb
;

150 
zdo_nwkUpd©eCb_t
 
zdpNwkUpd©eIndCb
;

151 
zdo_≥rmôJoöIndCb_t
 
zdpPîmôJoöIndCb
;

152 
zdo_∆meSyncCnfCb_t
 
zdoNlmeSyncCnfCb
;

153 
zdo_tcJoöIndCb_t
 
zdoTcJoöIndCb
;

154 
zdo_tcFømeC¡RóchedCb_t
 
ssTcFømeC¡RóchedCb
;

155 }
	tzdo_≠pIndCb_t
;

158 
	$boﬁ
 (*
	tzdo_touchLökÀaveCnfCb_t
)(
	t∆me_Àave_˙f_t
 *
	tp
);

161 
zdo_touchLökÀaveCnfCb_t
 
zdpLóveCnfCb
;

162 }
	tzdo_touchLökCb_t
;

165 
zdo_©åCfg_t
 
zdo_cfg_©åibuãs
;

166 
u32
 
TRANSPORT_NETWORK_KEY_WAIT_TIME
;

171 
	`zdo_zdpCbTblRegi°î
(
zdo_≠pIndCb_t
 *
cbTbl
);

173 
	`zdo_touchLökCbRegi°î
(
zdo_touchLökCb_t
 *
cb
);

184 
u8
 
	`zdo_af_gë_lök_ªåy_thªshﬁd
();

185 
	`zdo_af_£t_lök_ªåy_thªshﬁd
(
u8
 
thªshﬁd
);

195 
u32
 
	`zdo_af_gë_syn_øã
();

196 
	`zdo_af_£t_syn_øã
(
u32
 
√wR©e
);

206 
u8
 
	`zdo_af_gë_ªjoö_times
();

207 
	`zdo_af_£t_ªjoö_times
(
u8
 
times
);

209 
u16
 
	`zdo_af_gë_ªjoö_duøti⁄
();

210 
	`zdo_af_£t_ªjoö_duøti⁄
(
u16
 
duøti⁄
);

212 
u16
 
	`zdo_af_gë_ªjoö_backoff_time
();

213 
	`zdo_af_£t_ªjoö_backoff_time
(
u16
 
öãrvÆ
);

215 
u16
 
	`zdo_af_gë_max_ªjoö_backoff_time
();

216 
	`zdo_af_£t_max_ªjoö_backoff_time
(
u16
 
öãrvÆ
);

218 
u16
 
	`zdo_af_gë_ªjoö_backoff_ôî©i⁄
();

219 
	`zdo_af_£t_ªjoö_backoff_ôî©i⁄
(
u16
 
ôî©i⁄
);

230 
u8
 
	`zdo_af_gë_sˇn_©ãm±s
();

231 
	`zdo_af_£t_sˇn_©ãm±s
(
u8
 
©ãm±s
);

240 
u16
 
	`zdo_af_gë_nwk_time_btwn_sˇns
();

250 
u8
 
	`zdo_af_gë_≥rmô_joö_duøti⁄
();

253 
	`zdo_af_£t_ac˚±_nwk_upd©e_∑n_id
(
u16
 
∑nId
);

254 
u16
 
	`zdo_af_gë_ac˚±_nwk_upd©e_∑n_id
();

256 
	`zdo_af_£t_ac˚±_nwk_upd©e_ch™√l
(
u8
 
ch™√l
);

257 
u8
 
	`zdo_af_gë_ac˚±_nwk_upd©e_ch™√l
();

259 
	`zdo_af_£t_mgmtLóve_u£_≠s_£c
(
boﬁ
 
íabÀ
);

260 
boﬁ
 
	`zdo_af_gë_mgmtLóve_u£_≠s_£c
();

262 
	`zdo_af_£t_u£_tc_£c_⁄_nwk_key_rŸ©i⁄
(
boﬁ
 
íabÀ
);

263 
boﬁ
 
	`zdo_af_gë_u£_tc_£c_⁄_nwk_key_rŸ©i⁄
();

273 
u8
 
	`zdo_ch™√l_∑ge2num
(
u32
 
chp
);

282 
	`zdo_öô
();

291 
	`zdo_nwk_discovîy_Sèπ
(
∆me_nwkDisc_ªq_t
 *
pReq
, 
nwkDiscovîyU£rCb_t
 
cb
);

302 
zdo_°©us_t
 
	`zdo_nwk_ªjoö_ªq
(
ªjoöNwk_mëhod_t
 
mëhod
, 
u32
 
chm
);

312 
	`zdo_∆meF‹gëDev
(
addrExt_t
 
nodeIìeAddr
, 
boﬁ
 
ªjoö
);

321 
	`zdo_ªjoö_backoff_timî_°¨t
();

330 
	`zdo_ªjoö_backoff_timî_°›
();

	@zigbee/zdo/zdp.c

24 
	~"../comm⁄/ö˛udes/zb_comm⁄.h
"

27 (*
	tzdp_funcCb
)(*
	töd
);

30 
zdp_˛u°îId_e
 
˛u°îId
;

31 
u16
 
ª°ri˘ed
;

32 
zdp_funcCb
 
func
;

33 }
	tzdp_funcLi°_t
;

35 c⁄° 
zdp_funcLi°_t
 
g_zdpClõ¡Func
[] = {

36 {
NWK_ADDR_REQ_CLID
, 
FALSE
, 
zdo_nwkAddrIndiˇã
},

37 {
IEEE_ADDR_REQ_CLID
, 
FALSE
, 
zdo_õìAddrIndiˇã
},

38 {
NODE_DESC_REQ_CLID
, 
FALSE
, 
zdo_des¸ùt‹sIndiˇã
},

39 {
POWER_DESC_REQ_CLID
, 
FALSE
, 
zdo_des¸ùt‹sIndiˇã
},

40 {
SIMPLE_DESC_REQ_CLID
, 
FALSE
, 
zdo_des¸ùt‹sIndiˇã
},

41 {
ACTIVE_EP_REQ_CLID
, 
FALSE
, 
zdo_a˘iveEpIndiˇã
},

42 {
MATCH_DESC_REQ_CLID
, 
FALSE
, 
zdo_m©chDes¸ùt‹Indiˇã
},

45 #ifde‡
ZB_ROUTER_ROLE


46 {
DEVICE_ANNCE_CLID
, 
FALSE
, 
zdo_devi˚A¬oun˚Indiˇã
},

47 {
PARENT_ANNCE_CLID
, 
FALSE
, 
zdo_∑ª¡A¬oun˚Indiˇã
},

49 {
SYSTEM_SERVER_DISCOVERY_REQ_CLID
, 
FALSE
, 
zdo_SysSîvîDiscovîyIndüã
},

50 {
END_DEVICE_BIND_REQ_CLID
, 
FALSE
, 
zdo_ídDevi˚BödIndiˇã
},

51 {
BIND_REQ_CLID
, 
TRUE
, 
zdo_bödOrUnbödIndiˇã
},

52 {
UNBIND_REQ_CLID
, 
TRUE
, 
zdo_bödOrUnbödIndiˇã
},

53 {
MGMT_LQI_REQ_CLID
, 
FALSE
, 
zdo_mgmtLqiIndi˘©e
},

54 {
MGMT_BIND_REQ_CLID
, 
FALSE
, 
zdo_mgmtBödIndiˇã
},

55 {
MGMT_LEAVE_REQ_CLID
, 
TRUE
, 
zdo_mgmtLóveIndiˇã
},

56 #ifde‡
ZB_ROUTER_ROLE


57 {
MGMT_PERMIT_JOINING_REQ_CLID
, 
FALSE
, 
zdo_mgmtPîmôJoöIndiˇã
},

59 {
MGMT_NWK_UPDATE_REQ_CLID
, 
FALSE
, 
zdo_mgmNwkUpd©eIndiˇã
}

60 
	}
};

63 c⁄° 
u16
 
	gzdoIn˛u°î
[7] = {

64 
NWK_ADDR_RSP_CLID
,

65 
IEEE_ADDR_RSP_CLID
,

66 
NODE_DESC_RSP_CLID
,

67 
POWER_DESC_RSP_CLID
,

68 
SIMPLE_DESC_RSP_CLID
,

69 
ACTIVE_EP_RSP_CLID
,

70 
MATCH_DESC_RSP_CLID


73 c⁄° 
u16
 
	gzdoOutClu°î
[8] = {

74 
NWK_ADDR_REQ_CLID
,

75 
IEEE_ADDR_REQ_CLID
,

76 
NODE_DESC_REQ_CLID
,

77 
POWER_DESC_REQ_CLID
,

78 
SIMPLE_DESC_REQ_CLID
,

79 
ACTIVE_EP_REQ_CLID
,

80 
MATCH_DESC_REQ_CLID
,

81 
DEVICE_ANNCE_CLID


84 c⁄° 
af_sim∂e_des¸ùt‹_t
 
	gzdoSd
 = {

85 
ZDO_PROFILE_ID
,

87 
ZDO_EP
,

92 (
u16
 *)
zdoIn˛u°î
,

93 (
u16
 *)
zdoOutClu°î
,

98 
_CODE_ZDO_
 
	$zdp_txCnfCb
(*
¨g
){

101 
	}
}

103 
_CODE_ZDO_
 
	$zdp_£rvîCmdH™dÀr
(*
öd
){

104 
≠s_d©a_öd_t
 *
p
 = (≠s_d©a_öd_à*)
öd
;

106 #ifde‡
ZB_ROUTER_ROLE


107 if(
p
->
˛u°î_id
 =
PARENT_ANNCE_RSP_CLID
){

108 
	`zdo_∑ª¡A¬oun˚NŸify
(
öd
);

109 
	`zb_buf_‰ì
((
zb_buf_t
 *)
öd
);

111 }if(
p
->
˛u°î_id
 =
NWK_ADDR_RSP_CLID
 ||Ö->˛u°î_id =
IEEE_ADDR_RSP_CLID
){

112 
	`zdo_ªmŸeAddrNŸify
(
öd
);

116 
zdo_zdpD©aInd_t
 
zdpInd
;

117 
	`TL_SETSTRUCTCONTENT
(
zdpInd
, 0);

119 
zdpInd
.
§c_addr
 = 
p
->
§c_sh‹t_addr
;

120 
zdpInd
.
˛u°îId
 = 
p
->
˛u°î_id
;

121 
zdpInd
.
£q_num
 = 
p
->
asdu
[0];

122 
zdpInd
.
°©us
 = 
p
->
asdu
[1];

123 
zdpInd
.
Àngth
 = 
p
->
asduLígth
;

124 
zdpInd
.
zpdu
 = 
p
->
asdu
;

126 
zdo_zdpD©aInd_t
 *
pZdpInd
 = (zdo_zdpD©aInd_à*)
öd
;

127 
	`mem˝y
((
u8
 *)
pZdpInd
, (u8 *)&
zdpInd
, (
zdo_zdpD©aInd_t
));

129 
	`zdp_cb_¥o˚ss
(
pZdpInd
->
£q_num
, 
öd
);

130 
	`zb_buf_‰ì
((
zb_buf_t
 *)
öd
);

131 
	}
}

133 
_CODE_ZDO_
 
	$zdp_˛õ¡CmdH™dÀr
(*
öd
){

134 
≠s_d©a_öd_t
 *
p
 = (≠s_d©a_öd_à*)
öd
;

135 
zdo_°©us_t
 
°a
 = 
ZDO_NOT_SUPPORTED
;

137 
u32
 
i
 = 0; i < (
g_zdpClõ¡Func
)/(
zdp_funcLi°_t
); i++){

138 if((
g_zdpClõ¡Func
[
i
].
˛u°îId
 =
p
->
˛u°î_id
Ë&& g_zdpClõ¡Func[i].
func
){

140 if((
g_zdpClõ¡Func
[
i
].
ª°ri˘ed
 =
TRUE
Ë&& (
	`APS_IB
().
≠s_zdo_ª°ri˘ed_mode
 == TRUE) &&

141 ((
p
->
§c_sh‹t_addr
 !
	`NWK_NIB
().
m™agîAddr
Ë|| !’->
£curôy_°©us
 & 
SECURITY_IN_APSLAYER
))){

142 
°a
 = 
ZDO_NOT_AUTHORIZED
;

146 
g_zdpClõ¡Func
[
i
].
	`func
(
öd
);

151 if((
p
->
d°_addr_mode
 =
APS_SHORT_DSTADDR_WITHEP
Ë&& 
	`ZB_NWK_IS_ADDRESS_BROADCAST
’->
d°_addr
)){

152 
	`zb_buf_‰ì
((
zb_buf_t
 *)
öd
);

156 
zdo_zdp_ªq_t
 
zzr
;

157 
	`TL_SETSTRUCTCONTENT
(
zzr
, 0);

159 
	`TL_BUF_INITIAL_ALLOC
((
zb_buf_t
 *)
öd
, 2, 
zzr
.
zdu
, 
u8
 *);

160 
u8
 *
±r
 = 
zzr
.
zdu
;

161 *
±r
++ = 
p
->
asdu
[0];

162 *
±r
++ = 
°a
;

164 
zzr
.
˛u°î_id
 = (
p
->cluster_id | 0x8000);

165 
zzr
.
zduLí
 = 
±r
 - zzr.
zdu
;

166 
zzr
.
buff_addr
 = 
öd
;

167 
zzr
.
d°_addr_mode
 = 
SHORT_ADDR_MODE
;

168 
zzr
.
d°_nwk_addr
 = 
p
->
§c_sh‹t_addr
;

169 
zzr
.
zdoR•Re˚ivedIndCb
 = 
NULL
;

171 
	`zdo_£nd_ªq
(&
zzr
);

172 
	`zb_buf_‰ì
((
zb_buf_t
 *)
öd
);

173 
	}
}

175 
_CODE_ZDO_
 
	$zdp_rxD©aIndiˇti⁄
(*
öd
){

176 
≠s_d©a_öd_t
 *
p
 = (≠s_d©a_öd_à*)
öd
;

178 if(
p
->
˛u°î_id
 & 
	`BIT
(15)){

179 
	`zdp_£rvîCmdH™dÀr
(
öd
);

181 
	`zdp_˛õ¡CmdH™dÀr
(
öd
);

183 
	}
}

185 
_CODE_ZDO_
 
	$zdp_öô
(){

186 
	`af_ídpoötRegi°î
(
ZDO_EP
, (
af_sim∂e_des¸ùt‹_t
 *)&
zdoSd
, 
zdp_rxD©aIndiˇti⁄
, 
zdp_txCnfCb
);

187 
	}
}

190 
_CODE_ZDO_
 
	$zdo_com∂exDescIndiˇã
(*
buf
){

191 
zb_buf_t
 *
zbuff
 = 
buf
;

192 
≠s_d©a_öd_t
 *
ad
 = 
buf
;

193 
u8
 *
∑ylﬂd
 = 
ad
->
asdu
;

194 
u8
 
£qNum
 = *
∑ylﬂd
++;

196 
u16
 
nwkAddrReq
;

197 
	`COPY_BUFFERTOU16
(
nwkAddrReq
, 
∑ylﬂd
);

198 
∑ylﬂd
 += 2;

200 
zdo_zdp_ªq_t
 
zzr
;

201 
	`TL_SETSTRUCTCONTENT
(
zzr
, 0);

203 
u8
 
off£t
 = 
	`OFFSETOF
(
zdo_com∂ex_des¸ùt‹_ª•_t
, 
compDesc
);

204 
	`TL_BUF_INITIAL_ALLOC
(
zbuff
, 
off£t
, 
zzr
.
zdu
, 
u8
 *);

206 
u8
 *
±r
 = 
zzr
.
zdu
;

207 *
±r
++ = 
£qNum
;

208 *
±r
++ = 
ZDO_NOT_SUPPORTED
;

209 
	`COPY_U16TOBUFFER
(
±r
, 
nwkAddrReq
);

210 
±r
 += 2;

211 *
±r
++ = 0;

213 
zzr
.
˛u°î_id
 = 
COMPLEX_DESC_RSP_CLID
;

214 
zzr
.
zduLí
 = 
±r
 - zzr.
zdu
;

215 
zzr
.
buff_addr
 = 
buf
;

216 
zzr
.
d°_addr_mode
 = 
SHORT_ADDR_MODE
;

217 
zzr
.
d°_nwk_addr
 = 
ad
->
§c_sh‹t_addr
;

218 
zzr
.
zdoR•Re˚ivedIndCb
 = 
NULL
;

220 
	`zdo_£nd_ªq
(&
zzr
);

221 
	`zb_buf_‰ì
((
zb_buf_t
 *)
zzr
.
buff_addr
);

222 
	}
}

224 
_CODE_ZDO_
 
	$zdo_u£rDescIndiˇã
(*
buf
){

225 
zb_buf_t
 *
zbuff
 = 
buf
;

226 
≠s_d©a_öd_t
 *
ad
 = 
buf
;

227 
u8
 *
∑ylﬂd
 = 
ad
->
asdu
;

228 
u8
 
£qNum
 = *
∑ylﬂd
++;

230 
u16
 
nwkAddrReq
;

231 
	`COPY_BUFFERTOU16
(
nwkAddrReq
, 
∑ylﬂd
);

232 
∑ylﬂd
 += 2;

234 
zdo_zdp_ªq_t
 
zzr
;

235 
	`TL_SETSTRUCTCONTENT
(
zzr
, 0);

237 
u8
 
off£t
 = 
	`OFFSETOF
(
zdo_u£r_des¸ùt‹_ª•_t
, 
u£r_desc
);

238 
	`TL_BUF_INITIAL_ALLOC
(
zbuff
, 
off£t
, 
zzr
.
zdu
, 
u8
 *);

240 
u8
 *
±r
 = 
zzr
.
zdu
;

241 *
±r
++ = 
£qNum
;

242 *
±r
++ = 
ZDO_NOT_SUPPORTED
;

243 
	`COPY_U16TOBUFFER
(
±r
, 
nwkAddrReq
);

244 
±r
 += 2;

245 *
±r
++ = 0;

247 
zzr
.
˛u°î_id
 = 
USER_DESC_RSP_CLID
;

248 
zzr
.
zduLí
 = 
±r
 - zzr.
zdu
;

249 
zzr
.
buff_addr
 = 
buf
;

250 
zzr
.
d°_addr_mode
 = 
SHORT_ADDR_MODE
;

251 
zzr
.
d°_nwk_addr
 = 
ad
->
§c_sh‹t_addr
;

252 
zzr
.
zdoR•Re˚ivedIndCb
 = 
NULL
;

254 
	`zdo_£nd_ªq
(&
zzr
);

255 
	`zb_buf_‰ì
((
zb_buf_t
 *)
zzr
.
buff_addr
);

256 
	}
}

	@zigbee/zdo/zdp.h

24 #i‚de‡
ZDP_H


25 
	#ZDP_H


	)

28 
	#MAX_REQUESTED_CLUSTER_NUMBER
 8

	)

29 
	#MAX_USER_DESC_LEN
 16

	)

31 
	#ZDO_CMD_PAYLOAD_MAX
 52

	)

34 
	#ZDO_NWK_MANAGER_MAX_SCAN_DURATION
 5

	)

35 
	#ZDO_NWK_MANAGER_CHANNEL_CHANGE
 0xFE

	)

36 
	#ZDO_NWK_MANAGER_ATTRIBUTES_CHANGE
 0xFF

	)

43 
	mNWK_ADDR_REQ_CLID
 = 0x0000,

44 
	mIEEE_ADDR_REQ_CLID
 = 0x0001,

45 
	mNODE_DESC_REQ_CLID
 = 0x0002,

46 
	mPOWER_DESC_REQ_CLID
 = 0x0003,

47 
	mSIMPLE_DESC_REQ_CLID
 = 0x0004,

48 
	mACTIVE_EP_REQ_CLID
 = 0x0005,

49 
	mMATCH_DESC_REQ_CLID
 = 0x0006,

50 
	mCOMPLEX_DESC_REQ_CLID
 = 0x0010,

51 
	mUSER_DESC_REQ_CLID
 = 0x0011,

52 
	mDISCOVERY_CACHE_REQ_CLID
 = 0x0012,

53 
	mDEVICE_ANNCE_CLID
 = 0x0013,

54 
	mUSER_DESC_SET_CLID
 = 0x0014,

55 
	mSYSTEM_SERVER_DISCOVERY_REQ_CLID
 = 0x0015,

56 
	mDISCOVERY_STORE_REQ_CLID
 = 0x0016,

57 
	mNODE_DESC_STORE_REQ_CLID
 = 0x0017,

58 
	mPOWER_DESC_STORE_REQ_CLID
 = 0x0018,

59 
	mACTIVE_EP_STORE_REQ_CLID
 = 0x0019,

60 
	mSIMPLE_DESC_STORE_REQ_CLID
 = 0x001A,

61 
	mREMOVE_NODE_CACHE_REQ_CLID
 = 0x001B,

62 
	mFIND_NODE_CACHE_REQ_CLID
 = 0x001C,

63 
	mEXTENDED_SIMPLE_DESC_REQ_CLID
 = 0x001D,

64 
	mEXTENDED_ACTIVE_EP_REQ_CLID
 = 0x001E,

65 
	mPARENT_ANNCE_CLID
 = 0x001F,

66 
	mEND_DEVICE_BIND_REQ_CLID
 = 0x0020,

67 
	mBIND_REQ_CLID
 = 0x0021,

68 
	mUNBIND_REQ_CLID
 = 0x0022,

69 
	mBIND_REGISTER_REQ_CLID
 = 0x0023,

70 
	mREPLACE_DEVICE_REQ_CLID
 = 0x0024,

71 
	mSTORE_BCKUP_BIND_ENTRY_REQ_CLID
 = 0x0025,

72 
	mREMOVE_BCKUP_BIND_ENTRY_REQ_CLID
 = 0x0026,

73 
	mBACKUP_BIND_TABLE_REQ_CLID
 = 0x0027,

74 
	mRECOVER_BIND_TABLE_REQ_CLID
 = 0x0028,

75 
	mBACKUP_SOURCE_BIND_REQ_CLID
 = 0x0029,

76 
	mRECOVER_SOURCE_BIND_REQ_CLID
 = 0x002A,

77 
	mCLEAR_ALL_BINDINGS_REQ_CLID
 = 0x002B,

78 
	mMGMT_NWK_DISC_REQ_CLID
 = 0x0030,

79 
	mMGMT_LQI_REQ_CLID
 = 0x0031,

80 
	mMGMT_RTG_REQ_CLID
 = 0x0032,

81 
	mMGMT_BIND_REQ_CLID
 = 0x0033,

82 
	mMGMT_LEAVE_REQ_CLID
 = 0x0034,

83 
	mMGMT_DIRECT_JOIN_REQ_CLID
 = 0x0035,

84 
	mMGMT_PERMIT_JOINING_REQ_CLID
 = 0x0036,

85 
	mMGMT_CACHE_REQ_CLID
 = 0x0037,

86 
	mMGMT_NWK_UPDATE_REQ_CLID
 = 0x0038,

87 
	mMGMT_NWK_ENHANCED_UPDATE_REQ_CLID
 = 0x0039,

88 
	mMGMT_NWK_IEEE_JOINING_LIST_REQ_CLID
 = 0x003A,

89 
	mMGMT_NWK_BEACON_SURVEY_REQ_CLID
 = 0x003C,

90 
	mSEC_START_KEY_NEGOTIATION_REQ_CLID
 = 0x0040,

91 
	mSEC_GET_AUTH_TOKEN_REQ_CLID
 = 0x0041,

92 
	mSEC_GET_AUTH_LEVEL_REQ_CLID
 = 0x0042,

93 
	mSEC_SET_CFG_REQ_CLID
 = 0x0043,

94 
	mSEC_GET_CFG_REQ_CLID
 = 0x0044,

95 
	mSEC_START_KEY_UPDATE_REQ_CLID
 = 0x0045,

96 
	mSEC_DECOMMISSION_REQ_CLID
 = 0x0046,

97 
	mSEC_CHALLENGE_REQ_CLID
 = 0x0047,

100 
	mNWK_ADDR_RSP_CLID
 = 0x8000,

101 
	mIEEE_ADDR_RSP_CLID
 = 0x8001,

102 
	mNODE_DESC_RSP_CLID
 = 0x8002,

103 
	mPOWER_DESC_RSP_CLID
 = 0x8003,

104 
	mSIMPLE_DESC_RSP_CLID
 = 0x8004,

105 
	mACTIVE_EP_RSP_CLID
 = 0x8005,

106 
	mMATCH_DESC_RSP_CLID
 = 0x8006,

107 
	mCOMPLEX_DESC_RSP_CLID
 = 0x8010,

108 
	mUSER_DESC_RSP_CLID
 = 0x8011,

109 
	mDISCOVERY_CACHE_RSP_CLID
 = 0x8012,

110 
	mUSER_DESC_CONF_RSP_CLID
 = 0x8014,

111 
	mSYSTEM_SERVER_DISCOVERY_RSP_CLID
 = 0x8015,

112 
	mDISCOVERY_STORE_RSP_CLID
 = 0x8016,

113 
	mNODE_DESC_STORE_RSP_CLID
 = 0x8017,

114 
	mPOWER_DESC_STORE_RSP_CLID
 = 0x8018,

115 
	mACTIVE_EP_STORE_RSP_CLID
 = 0x8019,

116 
	mSIMPLE_DESC_STORE_RSP_CLID
 = 0x801A,

117 
	mREMOVE_NODE_CACHE_RSP_CLID
 = 0x801B,

118 
	mFIND_NODE_CACHE_RSP_CLID
 = 0x801C,

119 
	mEXTENDED_SIMPLE_DESC_RSP_CLID
 = 0x801D,

120 
	mEXTENDED_ACTIVE_EP_RSP_CLID
 = 0x801E,

121 
	mPARENT_ANNCE_RSP_CLID
 = 0x801F,

122 
	mEND_DEVICE_BIND_RSP_CLID
 = 0x8020,

123 
	mBIND_RSP_CLID
 = 0x8021,

124 
	mUNBIND_RSP_CLID
 = 0x8022,

125 
	mBIND_REGISTER_RSP_CLID
 = 0x8023,

126 
	mREPLACE_DEVICE_RSP_CLID
 = 0x8024,

127 
	mSTORE_BCKUP_BIND_ENTRY_RSP_CLID
 = 0x8025,

128 
	mREMOVE_BCKUP_BIND_ENTRY_RSP_CLID
 = 0x8026,

129 
	mBACKUP_BIND_TABLE_RSP_CLID
 = 0x8027,

130 
	mRECOVER_BIND_TABLE_RSP_CLID
 = 0x8028,

131 
	mBACKUP_SOURCE_BIND_RSP_CLID
 = 0x8029,

132 
	mRECOVER_SOURCE_BIND_RSP_CLID
 = 0x802A,

133 
	mCLEAR_ALL_BINDINGS_RSP_CLID
 = 0x802B,

134 
	mMGMT_NWK_DISC_RSP_CLID
 = 0x8030,

135 
	mMGMT_LQI_RSP_CLID
 = 0x8031,

136 
	mMGMT_RTG_RSP_CLID
 = 0x8032,

137 
	mMGMT_BIND_RSP_CLID
 = 0x8033,

138 
	mMGMT_LEAVE_RSP_CLID
 = 0x8034,

139 
	mMGMT_DIRECT_JOIN_RSP_CLID
 = 0x8035,

140 
	mMGMT_PERMIT_JOINING_RSP_CLID
 = 0x8036,

141 
	mMGMT_CACHE_RSP_CLID
 = 0x8037,

142 
	mMGMT_NWK_UPDATE_NOTIFY_CLID
 = 0x8038,

143 
	mMGMT_NWK_ENHANCED_UPDATE_NOTIFY_CLID
 = 0x8039,

144 
	mMGMT_NWK_IEEE_JOINING_LIST_RSP_CLID
 = 0x803A,

145 
	mMGMT_NWK_UNSOLICITED_ENHANCED_UPDATE_NOTIFY_CLID
 = 0x803B,

146 
	mMGMT_NWK_BEACON_SURVEY_RSP_CLID
 = 0x803C,

147 
	mSEC_START_KEY_NEGOTIATION_RSP_CLID
 = 0x8040,

148 
	mSEC_GET_AUTH_TOKEN_RSP_CLID
 = 0x8041,

149 
	mSEC_GET_AUTH_LEVEL_RSP_CLID
 = 0x8042,

150 
	mSEC_SET_CFG_RSP_CLID
 = 0x8043,

151 
	mSEC_GET_CFG_RSP_CLID
 = 0x8044,

152 
	mSEC_START_KEY_UPDATE_RSP_CLID
 = 0x8045,

153 
	mSEC_DECOMMISSION_RSP_CLID
 = 0x8046,

154 
	mSEC_CHALLENGE_RSP_CLID
 = 0x8047,

155 }
	tzdp_˛u°îId_e
;

159 
	mZDO_ADDR_REQ_SINGLE_REQ
, 
	mZDO_ADDR_REQ_SINGLE_RESP
 = 
ZDO_ADDR_REQ_SINGLE_REQ
,

160 
	mZDO_ADDR_REQ_EXTENDED_REQ
, 
	mZDO_ADDR_REQ_EXTENDED_RESP
 = 
ZDO_ADDR_REQ_EXTENDED_REQ
,

161 }
	tzdo_addr_ªq_ty≥
;

168 
addrExt_t
 
	mõì_addr_öãª°
;

169 
zdo_addr_ªq_ty≥
 
	mªq_ty≥
;

173 
u8
 
	m°¨t_ödex
;

176 }
	tzdo_nwk_addr_ªq_t
;

183 
u16
 
	mnwk_addr_öãª°
;

184 
zdo_addr_ªq_ty≥
 
	mªq_ty≥
;

188 
u8
 
	m°¨t_ödex
;

191 }
	tzdo_õì_addr_ªq_t
;

198 
u16
 
	mnwk_addr_öãª°
;

199 }
	tzdo_node_des¸ùt‹_ªq_t
;

205 
zdo_node_des¸ùt‹_ªq_t
 
	tzdo_powî_des¸ùt‹_ªq_t
;

212 
u16
 
	mnwk_addr_öãª°
;

213 
u8
 
	mídpoöt
;

214 }
	tzdo_sim∂e_des¸ùt‹_ªq_t
;

220 
zdo_node_des¸ùt‹_ªq_t
 
	tzdo_a˘ive_ï_ªq_t
;

227 
u16
 
	mnwk_addr_öãª°
;

228 
u16
 
	m¥ofûe_id
;

229 
u8
 
	mnum_ö_˛u°îs
;

230 
u8
 
	mnum_out_˛u°îs
;

231 
u16
 
	m˛u°î_li°
[2 * 
MAX_REQUESTED_CLUSTER_NUMBER
];

232 }
	tzdo_m©ch_des¸ùt‹_ªq_t
;

238 
zdo_node_des¸ùt‹_ªq_t
 
	tzdo_com∂ex_des¸ùt‹_ªq_t
;

244 
zdo_node_des¸ùt‹_ªq_t
 
	tzdo_u£r_des¸ùt‹_ªq_t
;

251 
u16
 
	mnwk_addr_loˇl
;

252 
addrExt_t
 
	mõì_addr_loˇl
;

253 
ˇ∑bûôy_öfo_t
 
	mmac_ˇ∑bûôy
;

254 }
	tzdo_devi˚_™n˚_ªq_t
;

261 
u8
 
	mnumbîOfChûdªn
;

262 
u8
 *
	mchûdInfo
;

263 }
	tzdo_∑ª¡_™n˚_ªq_t
;

272 
u8
 
	mÀn
;

273 
u8
 
	möfo
[
MAX_USER_DESC_LEN
];

274 }
	tu£r_des¸ùt‹_t
;

277 
u16
 
	mnwk_addr_öãª°
;

278 
u£r_des¸ùt‹_t
 
	mu£r_desc
;

279 }
	tzdo_u£r_des¸ùt‹_£t_ªq_t
;

282 
u16
 
	m£rvî_mask
;

283 }
	tzdo_sy°em_£rvî_discovîy_ªq_t
;

290 
u16
 
	mbödög_èrgë_addr
;

292 
u16
 
	m¥ofûe_id
;

297 
addrExt_t
 
	m§c_ext_addr
;

298 
u16
 
	mö_˛u°î_l°
[
MAX_REQUESTED_CLUSTER_NUMBER
];

299 
u16
 
	mout_˛u°î_l°
[
MAX_REQUESTED_CLUSTER_NUMBER
];

301 
u8
 
	m§c_ídpoöt
;

302 
u8
 
	mnum_ö_˛u°îs
;

303 
u8
 
	mnum_out_˛u°îs
;

304 }
	tzdo_edBödReq_t
;

307 
	mSHORT_GROUPADDR_NODSTENDPOINT
 = 0x01,

308 
	mLONG_EXADDR_DSTENDPOINT
 = 0x03

309 }
	tböd_ªq_d°_addr_mode
;

312 
addrExt_t
 
	m§c_addr
;

314 
u8
 
	m§c_ídpoöt
;

315 
u8
 
	mcid16_l
;

316 
u8
 
	mcid16_h
;

317 
böd_ªq_d°_addr_mode
 
	md°_addr_mode
;

323 
addrExt_t
 
	md°_ext_addr
;

324 
u8
 
	md°_ídpoöt
;

326 
u16
 
	md°_group_addr
;

328 }
	tzdo_böd_ªq_t
;

330 
zdo_böd_ªq_t
 
	tzdo_unböd_ªq_t
;

331 
zdo_böd_ªq_t
 
	tzdo_bödTabLi°Rec_t
;

337 
u8
 
	m°¨t_ödex
;

338 }
	tzdo_mgmt_lqi_ªq_t
;

345 
u8
 
	m°¨t_ödex
;

346 }
	tzdo_mgmt_böd_ªq_t
;

353 
addrExt_t
 
	mdevi˚_addr
;

355 
u8
 
	mª£rved
:6;

356 
u8
 
	mªmove_chûdªn
:1;

358 
u8
 
	mªjoö
:1;

360 }
	mÃ_bôfõlds
;

361 }
	tzdo_mgmt_Àave_ªq_t
;

368 
u8
 
	m≥rmô_duøti⁄
;

370 
u8
 
	måu°_˚¡î_signifiˇn˚
;

372 }
	tzdo_mgmt_≥rmô_joö_ªq_t
;

379 
u32
 
	msˇn_ch
;

380 
u8
 
	msˇn_duøti⁄
;

383 
u8
 
	msˇn_˙t
;

384 
u8
 
	mnwk_upd©e_id
;

389 
u16
 
	mnwk_m™agî_addr
;

391 }
	tzdo_mgmt_nwk_upd©e_ªq_t
;

397 
	#MAX_RSPNUM
 6

	)

400 
u8
 
	m£q_num
;

401 
u8
 
	m°©us
;

402 
addrExt_t
 
	mõì_addr_ªmŸe
;

403 
u16
 
	mnwk_addr_ªmŸe
;

404 
u8
 
	mnum_assoc_dev
;

409 
u8
 
	m°¨t_ödex
;

414 
u16
 
	mnwk_addr_assoc_dev_l°
[
MAX_RSPNUM
];

420 }
	tzdo_nwk_addr_ª•_t
;

426 
zdo_nwk_addr_ª•_t
 
	tzdo_õì_addr_ª•_t
;

429 
u8
 
	m£q_num
;

430 
u8
 
	m°©us
;

431 
u16
 
	mnwk_addr_öãª°
;

432 
node_des¸ùt‹_t
 
	mnode_des¸ùt‹
;

433 }
	tzdo_node_des¸ùt_ª•_t
;

436 
u8
 
	m£q_num
;

437 
u8
 
	m°©us
;

438 
u16
 
	mnwk_addr_öãª°
;

439 
powî_des¸ùt‹_t
 
	mpowî_des¸ùt‹
;

440 }
	tzdo_powî_des¸ùt‹_ª•_t
;

443 
u8
 
	mídpoöt
;

444 
u16
 
	m≠p_¥ofûe_id
;

445 
u16
 
	m≠p_dev_id
;

446 
u8
 
	m≠p_dev_vî
:4;

447 
u8
 
	mª£rved
:4;

448 
u8
 
	mli°Info
[1];

449 }
	tsim∂e_des¸ùt‹_fõld_t
;

452 
u8
 
	m£q_num
;

453 
u8
 
	m°©us
;

454 
u16
 
	mnwk_addr_öãª°
;

455 
u8
 
	mÀngth
;

456 
sim∂e_des¸ùt‹_fõld_t
 
	msim∂e_des¸ùt‹
;

457 }
	tzdo_sim∂e_des¸ùt‹_ª•_t
;

464 
u8
 
	m£q_num
;

465 
u8
 
	m°©us
;

466 
u16
 
	mnwk_addr_öãª°
;

467 
u8
 
	ma˘ive_ï_cou¡
;

468 
u8
 
	ma˘ive_ï_l°
[
MAX_REQUESTED_CLUSTER_NUMBER
];

469 }
	tzdo_a˘ive_ï_ª•_t
;

475 
u8
 
	m£q_num
;

476 
u8
 
	m°©us
;

477 
u16
 
	mnwk_addr_öãª°
;

478 
u8
 
	mm©chLí
;

479 
u8
 
	mm©chLi°
[
MAX_REQUESTED_CLUSTER_NUMBER
];

480 }
	tzdo_m©ch_des¸ùt‹_ª•_t
;

487 
u8
 
	m£q_num
;

488 
u8
 
	m°©us
;

489 
u16
 
	mnwk_addr_öãª°
;

490 
u8
 
	mÀngth
;

491 
u8
 
	mcompDesc
[1];

492 }
	tzdo_com∂ex_des¸ùt‹_ª•_t
;

499 
u8
 
	m£q_num
;

500 
u8
 
	m°©us
;

501 
u16
 
	mnwk_addr_öãª°
;

502 
u8
 
	mÀngth
;

503 
u8
 
	mu£r_desc
[
MAX_USER_DESC_LEN
];

504 }
	tzdo_u£r_des¸ùt‹_ª•_t
;

511 
u8
 
	m£q_num
;

512 
u8
 
	m°©us
;

513 
u16
 
	m£rvî_mask
;

514 }
	tzdo_sy°em_£rvî_discovîy_ª•_t
;

517 
u8
 
	m£q_num
;

518 
u8
 
	m°©us
;

519 
u16
 
	mnwk_addr_öãª°
;

520 }
	tzdo_u£r_des¸ùt‹_c⁄f_ª•_t
;

523 
u8
 
	m£q_num
;

524 
u8
 
	m°©us
;

525 
u8
 
	mnumbîOfChûdªn
;

526 
u8
 *
	mchûdInfo
;

527 } 
	tzdo_∑ª¡_™n˚_r•_t
;

530 
u8
 
	m£q_num
;

531 
u8
 
	m°©us
;

532 }
	tzdo_böd_ª•_t
;

534 
zdo_böd_ª•_t
 
	tzdo_íd_dev_böd_ª•_t
;

535 
zdo_böd_ª•_t
 
	tzdo_unböd_ª•_t
;

538 
addrExt_t
 
	mext_∑n_id
;

539 
addrExt_t
 
	mext_addr
;

540 
u16
 
	m√tw‹k_addr
;

541 
u8
 
	mdevi˚Ty≥
:2;

542 
u8
 
	mrxOnWhíIdÀ
:2;

543 
u8
 
	mªœti⁄shù
:3;

544 
u8
 
	mª£rved1
:1;

545 
u8
 
	m≥rmôJoöög
:2;

546 
u8
 
	mª£rved2
:6;

547 
u8
 
	mdïth
;

548 
u8
 
	mlqi
;

549 }
	t√ighb‹_tbl_l°_t
;

552 
u8
 
	m£q_num
;

553 
u8
 
	m°©us
;

554 
u8
 
	m√ighb‹_tbl_íåõs
;

555 
u8
 
	m°¨t_ödex
;

556 
u8
 
	m√ighb‹_tbl_l°_˙t
;

557 
√ighb‹_tbl_l°_t
 
	m√ighb‹_tbl_l°
[1];

558 }
	tzdo_mgmt_lqi_ª•_t
;

561 
u8
 
	m£q_num
;

562 
u8
 
	m°©us
;

563 
u8
 
	mböd_tbl_íåõs
;

564 
u8
 
	m°¨t_ödex
;

565 
u8
 
	mböd_tbl_l°_˙t
;

566 
zdo_bödTabLi°Rec_t
 
	mböd_tbl_l°
[1];

567 }
	tzdo_mgmt_böd_ª•_t
;

570 
u8
 
	m£q_num
;

571 
u8
 
	m°©us
;

572 }
	tzdo_mgmt_Àave_ª•_t
;

574 
zdo_böd_ª•_t
 
	tzdo_mgmt_≥rmô_joöög_ª•_t
;

577 
u32
 
	msˇ¬ed_ch™√ls
;

578 
u16
 
	mtŸÆ_å™smissi⁄s
;

579 
u16
 
	må™smissi⁄s_Áû
;

580 
u8
 
	msize
;

581 
u8
 
	míîgyVÆues
[1];

582 }
	ted_sˇn_t
;

591 
u8
 
	m£q_num
;

592 
u8
 
	m°©us
;

593 
ed_sˇn_t
 
	msˇn_ªsu…
;

594 }
	tzdo_mgmt_nwk_upd©e_nŸi_t
;

599 
u8
 
	m£q_num
;

601 
zdo_nwk_addr_ªq_t
 
	mnwk_addr_ªq
;

602 
zdo_õì_addr_ªq_t
 
	mõì_addr_ªq
;

603 
zdo_node_des¸ùt‹_ªq_t
 
	mnode_desc_ªq
;

604 
zdo_powî_des¸ùt‹_ªq_t
 
	mpowî_desc_ªq
;

605 
zdo_sim∂e_des¸ùt‹_ªq_t
 
	msim∂e_desc_ªq
;

606 
zdo_a˘ive_ï_ªq_t
 
	ma˘ive_ï_ªq
;

607 
zdo_m©ch_des¸ùt‹_ªq_t
 
	mm©ch_desc_ªq
;

608 
zdo_com∂ex_des¸ùt‹_ªq_t
 
	mcom∂ex_desc_ªq
;

609 
zdo_u£r_des¸ùt‹_ªq_t
 
	mu£r_desc_ªq
;

610 
zdo_devi˚_™n˚_ªq_t
 
	mdevi˚_™n˚
;

611 
zdo_∑ª¡_™n˚_ªq_t
 
	m∑ª¡_™n˚
;

612 
zdo_u£r_des¸ùt‹_£t_ªq_t
 
	mu£r_desc_£t_ªq
;

613 
zdo_sy°em_£rvî_discovîy_ªq_t
 
	msy°em_£rvî_discovîy_ªq
;

615 
zdo_edBödReq_t
 
	míd_devi˚_böd_ªq
;

616 
zdo_böd_ªq_t
 
	mböd_ªq
;

617 
zdo_unböd_ªq_t
 
	munböd_ªq
;

619 
zdo_mgmt_lqi_ªq_t
 
	mmgmt_lqi_ªq
;

620 
zdo_mgmt_böd_ªq_t
 
	mmgmt_böd_ªq
;

621 
zdo_mgmt_Àave_ªq_t
 
	mmgmt_Àave_ªq
;

622 
zdo_mgmt_≥rmô_joö_ªq_t
 
	mmgmt_≥rmô_joö_ªq
;

623 
zdo_mgmt_nwk_upd©e_ªq_t
 
	mmgmt_nwk_upd©e_ªq
;

625 }
	tzdo_zdp_ªq_‰ame_t
;

629 
zdo_nwk_addr_ª•_t
 
	mnwk_addr_ª•
;

630 
zdo_õì_addr_ª•_t
 
	mõì_addr_ª•
;

631 
zdo_node_des¸ùt_ª•_t
 
	mnode_desc_ª•
;

632 
zdo_powî_des¸ùt‹_ª•_t
 
	mpowî_desc_ª•
;

633 
zdo_sim∂e_des¸ùt‹_ª•_t
 
	msim∂e_desc_ª•
;

634 
zdo_a˘ive_ï_ª•_t
 
	ma˘ive_ï_ª•
;

635 
zdo_m©ch_des¸ùt‹_ª•_t
 
	mm©ch_desc_ª•
;

636 
zdo_com∂ex_des¸ùt‹_ª•_t
 
	mcom∂ex_desc_ª•
;

637 
zdo_u£r_des¸ùt‹_ª•_t
 
	mu£r_desc_ª•
;

638 
zdo_sy°em_£rvî_discovîy_ª•_t
 
	msy°em_£rvî_discovîy_ª•
;

639 
zdo_u£r_des¸ùt‹_c⁄f_ª•_t
 
	mu£r_desc_C⁄f_ª•
;

640 
zdo_∑ª¡_™n˚_r•_t
 
	m∑ª¡_™n˚_ª•
;

642 
zdo_íd_dev_böd_ª•_t
 
	míd_devi˚_böd_ª•
;

643 
zdo_böd_ª•_t
 
	mböd_ª•
;

644 
zdo_unböd_ª•_t
 
	munböd_ª•
;

646 
zdo_mgmt_lqi_ª•_t
 
	mmgmt_lqi_ª•
;

647 
zdo_mgmt_böd_ª•_t
 
	mmgmt_böd_ª•
;

648 
zdo_mgmt_Àave_ª•_t
 
	mmgmt_Àave_ª•
;

649 
zdo_mgmt_≥rmô_joöög_ª•_t
 
	mmgmt_≥rmô_joöög_ª•
;

650 
zdo_mgmt_nwk_upd©e_nŸi_t
 
	mmgmt_nwk_upd©e_nŸify
;

652 }
	tzdo_zdp_ª•_‰ame_t
;

657 
u8
 *
	mzpdu
;

658 
u16
 
	m§c_addr
;

659 
u16
 
	m˛u°îId
;

660 
u8
 
	m£q_num
;

661 
u8
 
	m°©us
;

662 
u8
 
	mÀngth
;

663 }
	tzdo_zdpD©aInd_t
;

666 (*
	tzdo_ˇŒback
)(*
	tp
);

669 
SHORT_ADDR_MODE
,

670 
EXT_ADDR_MODE


671 }
	taddr_mode_t
;

674 
u8
 *
zdu
;

675 
u8
 *
buff_addr
;

677 
u16
 
d°_nwk_addr
;

678 
addrExt_t
 
°_ext_addr
;

680 
u16
 
˛u°î_id
;

681 
u8
 
zduLí
;

682 
addr_mode_t
 
d°_addr_mode
;

683 
zdo_ˇŒback
 
zdoR•Re˚ivedIndCb
;

684 
u8
 
zdpSeqNum
;

685 }
	tzdo_zdp_ªq_t
;

696 
	`zdo_£nd_ªq
(
zdo_zdp_ªq_t
 *
ªq
);

705 
	`zdo_nwkAddrIndiˇã
(*
buf
);

714 
	`zdo_õìAddrIndiˇã
(*
buf
);

723 
	`zdo_des¸ùt‹sIndiˇã
(*
buf
);

732 
	`zdo_a˘iveEpIndiˇã
(*
buf
);

741 
	`zdo_m©chDes¸ùt‹Indiˇã
(*
buf
);

750 
	`zdo_devi˚A¬oun˚Indiˇã
(*
buf
);

759 
	`zdo_∑ª¡A¬oun˚Indiˇã
(*
buf
);

768 
	`zdo_SysSîvîDiscovîyIndüã
(*
buf
);

777 
	`zdo_ídDevi˚BödIndiˇã
(*
buf
);

786 
	`zdo_bödOrUnbödIndiˇã
(*
buf
);

795 
	`zdo_mgmtLqiIndi˘©e
(*
buf
);

804 
	`zdo_mgmtBödIndiˇã
(*
buf
);

816 
	`zdo_mgmtLóveIndiˇã
(*
buf
);

825 
	`zdo_mgmtPîmôJoöIndiˇã
(*
buf
);

835 
	`zdo_mgmNwkUpd©eIndiˇã
(*
buf
);

844 
	`zdo_∑ª¡A¬oun˚NŸify
(*
buf
);

853 
	`zdo_ªmŸeAddrNŸify
(*
buf
);

862 
	`zdo_nwkUpd©eNŸifyRe•Síd
(*
buf
);

871 
	`zdo_com∂exDescIndiˇã
(*
buf
);

880 
	`zdo_u£rDescIndiˇã
(*
buf
);

891 
	`zdp_cb_¥o˚ss
(
u16
 
t¢
, *
buf
);

900 
	`zdp_öô
();

	@
1
.
0
436
13598
apps/bootLoader/app_cfg.h
apps/bootLoader/board_8258_dongle.h
apps/bootLoader/board_8258_evk.h
apps/bootLoader/board_8258_evk_v1p2.h
apps/bootLoader/board_826x_dongle.h
apps/bootLoader/board_826x_evk.h
apps/bootLoader/board_8278_dongle.h
apps/bootLoader/board_8278_evk.h
apps/bootLoader/board_9518_dongle.h
apps/bootLoader/board_9518_evk.h
apps/bootLoader/bootloader.c
apps/bootLoader/bootloader.h
apps/bootLoader/main.c
apps/bootLoader/version_cfg.h
apps/common/comm_cfg.h
apps/common/factory_reset.c
apps/common/factory_reset.h
apps/common/firmwareEncryptChk.c
apps/common/firmwareEncryptChk.h
apps/common/main.c
apps/common/module_test.c
apps/sampleLight/app_cfg.h
apps/sampleLight/app_ui.c
apps/sampleLight/app_ui.h
apps/sampleLight/board_8258_dongle.h
apps/sampleLight/board_8258_evk.h
apps/sampleLight/board_826x_dongle.h
apps/sampleLight/board_826x_evk.h
apps/sampleLight/board_8278_dongle.h
apps/sampleLight/board_8278_evk.h
apps/sampleLight/board_9518_dongle.h
apps/sampleLight/board_9518_evk.h
apps/sampleLight/sampleLight.c
apps/sampleLight/sampleLight.h
apps/sampleLight/sampleLightCtrl.c
apps/sampleLight/sampleLightCtrl.h
apps/sampleLight/sampleLightEpCfg.c
apps/sampleLight/stack_cfg.h
apps/sampleLight/version_cfg.h
apps/sampleLight/zb_afTestCb.c
apps/sampleLight/zb_appCb.c
apps/sampleLight/zcl_colorCtrlCb.c
apps/sampleLight/zcl_levelCb.c
apps/sampleLight/zcl_onOffCb.c
apps/sampleLight/zcl_sampleLightCb.c
apps/sampleLight/zcl_sceneCb.c
platform/boot/8258/cstartup_8258.S
platform/boot/826x/cstartup_826x.S
platform/boot/8278/cstartup_8278.S
platform/boot/b91/cstartup_b91.S
platform/boot/link_cfg.S
platform/chip_8258/adc.h
platform/chip_8258/aes.h
platform/chip_8258/analog.h
platform/chip_8258/audio.h
platform/chip_8258/bsp.h
platform/chip_8258/clock.h
platform/chip_8258/dfifo.h
platform/chip_8258/dma.h
platform/chip_8258/driver_8258.h
platform/chip_8258/emi.h
platform/chip_8258/flash.c
platform/chip_8258/flash.h
platform/chip_8258/gpio.h
platform/chip_8258/gpio_default.h
platform/chip_8258/i2c.h
platform/chip_8258/irq.h
platform/chip_8258/pga.h
platform/chip_8258/pm.h
platform/chip_8258/pwm.h
platform/chip_8258/random.h
platform/chip_8258/register.h
platform/chip_8258/rf_drv.h
platform/chip_8258/spi.h
platform/chip_8258/spi_i.h
platform/chip_8258/timer.h
platform/chip_8258/uart.h
platform/chip_8258/usbhw.h
platform/chip_8258/usbhw_i.h
platform/chip_8258/watchdog.h
platform/chip_826x/adc.h
platform/chip_826x/aes.h
platform/chip_826x/bsp.h
platform/chip_826x/clock.h
platform/chip_826x/driver_826x.h
platform/chip_826x/flash.c
platform/chip_826x/flash.h
platform/chip_826x/gpio.h
platform/chip_826x/gpio_default.h
platform/chip_826x/i2c.h
platform/chip_826x/irq.h
platform/chip_826x/pm.h
platform/chip_826x/pwm.h
platform/chip_826x/register.h
platform/chip_826x/rf_drv.h
platform/chip_826x/spi.h
platform/chip_826x/timer.h
platform/chip_826x/uart.h
platform/chip_826x/usbhw.h
platform/chip_826x/usbhw_i.h
platform/chip_826x/watchdog.h
platform/chip_8278/adc.h
platform/chip_8278/aes.h
platform/chip_8278/analog.h
platform/chip_8278/audio.h
platform/chip_8278/bsp.h
platform/chip_8278/clock.h
platform/chip_8278/dfifo.h
platform/chip_8278/dma.h
platform/chip_8278/driver_8278.h
platform/chip_8278/emi.h
platform/chip_8278/flash.c
platform/chip_8278/flash.h
platform/chip_8278/gpio.h
platform/chip_8278/gpio_default.h
platform/chip_8278/i2c.h
platform/chip_8278/irq.h
platform/chip_8278/pga.h
platform/chip_8278/pke.h
platform/chip_8278/pm.h
platform/chip_8278/pwm.h
platform/chip_8278/random.h
platform/chip_8278/register.h
platform/chip_8278/rf_drv.h
platform/chip_8278/spi.h
platform/chip_8278/spi_i.h
platform/chip_8278/timer.h
platform/chip_8278/uart.h
platform/chip_8278/usbhw.h
platform/chip_8278/usbhw_i.h
platform/chip_8278/watchdog.h
platform/chip_b91/adc.h
platform/chip_b91/aes.h
platform/chip_b91/analog.h
platform/chip_b91/audio.h
platform/chip_b91/clock.h
platform/chip_b91/core.h
platform/chip_b91/dma.h
platform/chip_b91/driver_b91.h
platform/chip_b91/emi.h
platform/chip_b91/flash.c
platform/chip_b91/flash.h
platform/chip_b91/gpio.h
platform/chip_b91/gpio_default.h
platform/chip_b91/i2c.h
platform/chip_b91/lpc.h
platform/chip_b91/mdec.h
platform/chip_b91/mspi.h
platform/chip_b91/npe.h
platform/chip_b91/pke.h
platform/chip_b91/plic.c
platform/chip_b91/plic.h
platform/chip_b91/pm.h
platform/chip_b91/pwm.h
platform/chip_b91/reg_include/adc_reg.h
platform/chip_b91/reg_include/aes_reg.h
platform/chip_b91/reg_include/analog_reg.h
platform/chip_b91/reg_include/audio_reg.h
platform/chip_b91/reg_include/dma_reg.h
platform/chip_b91/reg_include/gpio_reg.h
platform/chip_b91/reg_include/i2c_reg.h
platform/chip_b91/reg_include/mdec_reg.h
platform/chip_b91/reg_include/mspi_reg.h
platform/chip_b91/reg_include/npe_reg.h
platform/chip_b91/reg_include/pke_reg.h
platform/chip_b91/reg_include/plic_reg.h
platform/chip_b91/reg_include/pwm_reg.h
platform/chip_b91/reg_include/register_b91.h
platform/chip_b91/reg_include/rf_reg.h
platform/chip_b91/reg_include/soc.h
platform/chip_b91/reg_include/spi_reg.h
platform/chip_b91/reg_include/stimer_reg.h
platform/chip_b91/reg_include/swire_reg.h
platform/chip_b91/reg_include/timer_reg.h
platform/chip_b91/reg_include/trng_reg.h
platform/chip_b91/reg_include/uart_reg.h
platform/chip_b91/reg_include/usb_reg.h
platform/chip_b91/rf.h
platform/chip_b91/s7816.h
platform/chip_b91/spi.h
platform/chip_b91/stimer.h
platform/chip_b91/swire.h
platform/chip_b91/sys.h
platform/chip_b91/timer.h
platform/chip_b91/trng.h
platform/chip_b91/uart.h
platform/chip_b91/usbhw.h
platform/chip_b91/watchdog.h
platform/platform.h
platform/riscv/firmware_encrypt.h
platform/services/b85m/irq_handler.c
platform/services/b91m/irq_handler.c
platform/tc32/div_mod.S
platform/tc32/firmware_encrypt.h
proj/common/assert.h
proj/common/bit.h
proj/common/compiler.h
proj/common/list.c
proj/common/list.h
proj/common/macro_trick.h
proj/common/mempool.c
proj/common/mempool.h
proj/common/static_assert.h
proj/common/string.c
proj/common/string.h
proj/common/tlPrintf.c
proj/common/tlPrintf.h
proj/common/types.h
proj/common/utility.h
proj/common/utlist.h
proj/drivers/drv_adc.c
proj/drivers/drv_adc.h
proj/drivers/drv_flash.c
proj/drivers/drv_flash.h
proj/drivers/drv_gpio.c
proj/drivers/drv_gpio.h
proj/drivers/drv_hw.c
proj/drivers/drv_hw.h
proj/drivers/drv_i2c.c
proj/drivers/drv_i2c.h
proj/drivers/drv_keyboard.c
proj/drivers/drv_keyboard.h
proj/drivers/drv_nv.c
proj/drivers/drv_nv.h
proj/drivers/drv_pm.c
proj/drivers/drv_pm.h
proj/drivers/drv_putchar.c
proj/drivers/drv_putchar.h
proj/drivers/drv_pwm.c
proj/drivers/drv_pwm.h
proj/drivers/drv_radio.h
proj/drivers/drv_spi.c
proj/drivers/drv_spi.h
proj/drivers/drv_timer.c
proj/drivers/drv_timer.h
proj/drivers/drv_uart.c
proj/drivers/drv_uart.h
proj/drivers/drv_usb.h
proj/drivers/usb/app/usbcdc.c
proj/drivers/usb/app/usbcdc.h
proj/drivers/usb/app/usbkb.c
proj/drivers/usb/app/usbkb.h
proj/drivers/usb/app/usbkb_i.h
proj/drivers/usb/app/usbmouse.c
proj/drivers/usb/app/usbmouse.h
proj/drivers/usb/app/usbmouse_i.h
proj/drivers/usb/app/usbvendor.c
proj/drivers/usb/app/usbvendor.h
proj/drivers/usb/app/usbvendor_i.h
proj/drivers/usb/usb.c
proj/drivers/usb/usb.h
proj/drivers/usb/usb_common.h
proj/drivers/usb/usbdesc.c
proj/drivers/usb/usbdesc.h
proj/drivers/usb/usbstd/AudioClassCommon.h
proj/drivers/usb/usbstd/CDCClassCommon.h
proj/drivers/usb/usbstd/CDCClassDevice.h
proj/drivers/usb/usbstd/HIDClassCommon.h
proj/drivers/usb/usbstd/HIDClassDevice.h
proj/drivers/usb/usbstd/HIDReportData.h
proj/drivers/usb/usbstd/MassStorageClassCommon.h
proj/drivers/usb/usbstd/PrinterClassCommon.h
proj/drivers/usb/usbstd/StdDescriptors.h
proj/drivers/usb/usbstd/StdRequestType.h
proj/drivers/usb/usbstd/USBController.h
proj/drivers/usb/usbstd/usbstd.h
proj/os/ev.c
proj/os/ev.h
proj/os/ev_buffer.c
proj/os/ev_buffer.h
proj/os/ev_poll.c
proj/os/ev_poll.h
proj/os/ev_queue.c
proj/os/ev_queue.h
proj/os/ev_timer.c
proj/os/ev_timer.h
proj/tl_common.h
zbhci/uart/hci_uart.c
zbhci/usbCDC/zbhci_usb_cdc.c
zbhci/usbHID/zbhci_usb_hid.c
zbhci/usbPrint/hci_usbPrint.c
zbhci/zbhci.c
zbhci/zbhci.h
zbhci/zbhciCmdProcess.c
zbhci/zbhci_zclHandler.c
zigbee/af/zb_af.c
zigbee/af/zb_af.h
zigbee/aps/aps_api.h
zigbee/aps/aps_group.c
zigbee/bdb/bdb.c
zigbee/bdb/includes/bdb.h
zigbee/common/includes/zb_buffer.h
zigbee/common/includes/zb_common.h
zigbee/common/includes/zb_config.h
zigbee/common/includes/zb_list.h
zigbee/common/includes/zb_task_queue.h
zigbee/common/zb_config.c
zigbee/gp/cGP_stub.h
zigbee/gp/dGP_stub.h
zigbee/gp/gp.c
zigbee/gp/gp.h
zigbee/gp/gpEpCfg.c
zigbee/gp/gp_proxyTab.c
zigbee/mac/includes/mac_phy.h
zigbee/mac/includes/mac_trx_api.h
zigbee/mac/includes/tl_zb_mac.h
zigbee/mac/includes/tl_zb_mac_pib.h
zigbee/mac/mac_phy.c
zigbee/mac/mac_pib.c
zigbee/nwk/includes/nwk.h
zigbee/nwk/includes/nwk_addr_map.h
zigbee/nwk/includes/nwk_ctx.h
zigbee/nwk/includes/nwk_neighbor.h
zigbee/nwk/includes/nwk_nib.h
zigbee/ota/ota.c
zigbee/ota/ota.h
zigbee/ota/otaCRC.c
zigbee/ota/otaEpCfg.c
zigbee/ss/security_service.h
zigbee/ss/ss_nv.c
zigbee/wwah/wwah.c
zigbee/wwah/wwah.h
zigbee/wwah/wwahEpCfg.c
zigbee/zbapi/zb_api.h
zigbee/zcl/closures/zcl_door_lock.c
zigbee/zcl/closures/zcl_door_lock.h
zigbee/zcl/closures/zcl_door_lock_attr.c
zigbee/zcl/closures/zcl_window_covering.c
zigbee/zcl/closures/zcl_window_covering.h
zigbee/zcl/closures/zcl_window_covering_attr.c
zigbee/zcl/commissioning/zcl_commissioning.c
zigbee/zcl/commissioning/zcl_commissioning.h
zigbee/zcl/commissioning/zcl_commissioning_attr.c
zigbee/zcl/general/zcl_alarm.c
zigbee/zcl/general/zcl_alarm.h
zigbee/zcl/general/zcl_alarm_attr.c
zigbee/zcl/general/zcl_basic.c
zigbee/zcl/general/zcl_basic.h
zigbee/zcl/general/zcl_basic_attr.c
zigbee/zcl/general/zcl_binary_input.c
zigbee/zcl/general/zcl_binary_input.h
zigbee/zcl/general/zcl_binary_input_attr.c
zigbee/zcl/general/zcl_binary_output.c
zigbee/zcl/general/zcl_binary_output.h
zigbee/zcl/general/zcl_binary_output_attr.c
zigbee/zcl/general/zcl_devTemperatureCfg.c
zigbee/zcl/general/zcl_devTemperatureCfg.h
zigbee/zcl/general/zcl_devTemperatureCfg_attr.c
zigbee/zcl/general/zcl_diagnostics.c
zigbee/zcl/general/zcl_diagnostics.h
zigbee/zcl/general/zcl_diagnostics_attr.c
zigbee/zcl/general/zcl_greenPower.c
zigbee/zcl/general/zcl_greenPower.h
zigbee/zcl/general/zcl_greenPower_attr.c
zigbee/zcl/general/zcl_group.c
zigbee/zcl/general/zcl_group.h
zigbee/zcl/general/zcl_group_attr.c
zigbee/zcl/general/zcl_identify.c
zigbee/zcl/general/zcl_identify.h
zigbee/zcl/general/zcl_identify_attr.c
zigbee/zcl/general/zcl_level.c
zigbee/zcl/general/zcl_level.h
zigbee/zcl/general/zcl_level_attr.c
zigbee/zcl/general/zcl_multistate_input.c
zigbee/zcl/general/zcl_multistate_input.h
zigbee/zcl/general/zcl_multistate_input_attr.c
zigbee/zcl/general/zcl_multistate_output.c
zigbee/zcl/general/zcl_multistate_output.h
zigbee/zcl/general/zcl_multistate_output_attr.c
zigbee/zcl/general/zcl_onoff.c
zigbee/zcl/general/zcl_onoff.h
zigbee/zcl/general/zcl_onoff_attr.c
zigbee/zcl/general/zcl_pollCtrl.c
zigbee/zcl/general/zcl_pollCtrl.h
zigbee/zcl/general/zcl_pollCtrl_attr.c
zigbee/zcl/general/zcl_powerCfg.c
zigbee/zcl/general/zcl_powerCfg.h
zigbee/zcl/general/zcl_powerCfg_attr.c
zigbee/zcl/general/zcl_scene.c
zigbee/zcl/general/zcl_scene.h
zigbee/zcl/general/zcl_scene_attr.c
zigbee/zcl/general/zcl_time.c
zigbee/zcl/general/zcl_time.h
zigbee/zcl/general/zcl_time_attr.c
zigbee/zcl/hvac/zcl_thermostat.c
zigbee/zcl/hvac/zcl_thermostat.h
zigbee/zcl/light_color_control/zcl_light_colorCtrl.c
zigbee/zcl/light_color_control/zcl_light_colorCtrl.h
zigbee/zcl/light_color_control/zcl_light_colorCtrl_attr.c
zigbee/zcl/measument_sensing/zcl_electrical_measurement.c
zigbee/zcl/measument_sensing/zcl_electrical_measurement.h
zigbee/zcl/measument_sensing/zcl_electrical_measurement_attr.c
zigbee/zcl/measument_sensing/zcl_illuminance_measurement.c
zigbee/zcl/measument_sensing/zcl_illuminance_measurement.h
zigbee/zcl/measument_sensing/zcl_illuminance_measurement_attr.c
zigbee/zcl/measument_sensing/zcl_occupancy_sensing.c
zigbee/zcl/measument_sensing/zcl_occupancy_sensing.h
zigbee/zcl/measument_sensing/zcl_occupancy_sensing_attr.c
zigbee/zcl/measument_sensing/zcl_temperature_measurement.c
zigbee/zcl/measument_sensing/zcl_temperature_measurement.h
zigbee/zcl/measument_sensing/zcl_temperature_measurement_attr.c
zigbee/zcl/ota_upgrading/zcl_ota.c
zigbee/zcl/ota_upgrading/zcl_ota.h
zigbee/zcl/ota_upgrading/zcl_ota_attr.c
zigbee/zcl/security_safety/zcl_ias_ace.c
zigbee/zcl/security_safety/zcl_ias_ace.h
zigbee/zcl/security_safety/zcl_ias_wd.c
zigbee/zcl/security_safety/zcl_ias_wd.h
zigbee/zcl/security_safety/zcl_ias_wd_attr.c
zigbee/zcl/security_safety/zcl_ias_zone.c
zigbee/zcl/security_safety/zcl_ias_zone.h
zigbee/zcl/security_safety/zcl_ias_zone_attr.c
zigbee/zcl/smart_energy/zcl_metering.c
zigbee/zcl/smart_energy/zcl_metering.h
zigbee/zcl/smart_energy/zcl_metering_attr.c
zigbee/zcl/zcl.c
zigbee/zcl/zcl.h
zigbee/zcl/zcl_config.h
zigbee/zcl/zcl_const.h
zigbee/zcl/zcl_include.h
zigbee/zcl/zcl_nv.c
zigbee/zcl/zcl_nv.h
zigbee/zcl/zcl_reporting.c
zigbee/zcl/zcl_wwah/zcl_wwah.c
zigbee/zcl/zcl_wwah/zcl_wwah.h
zigbee/zcl/zcl_wwah/zcl_wwah_attr.c
zigbee/zcl/zll_commissioning/zcl_touchlink_attr.h
zigbee/zcl/zll_commissioning/zcl_toucklink_security.c
zigbee/zcl/zll_commissioning/zcl_zllTouchLinkDiscovery.c
zigbee/zcl/zll_commissioning/zcl_zllTouchLinkJoinOrStart.c
zigbee/zcl/zll_commissioning/zcl_zll_commissioning.c
zigbee/zcl/zll_commissioning/zcl_zll_commissioning.h
zigbee/zcl/zll_commissioning/zcl_zll_commissioning_internal.h
zigbee/zdo/zdo_api.h
zigbee/zdo/zdp.c
zigbee/zdo/zdp.h
